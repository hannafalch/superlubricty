LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.74                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.2609688417216
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.84
  ghost atom cutoff = 3.84
  binsize = 1.92, bins = 9375 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 229.6 | 229.6 | 229.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -4.9110539e-06  1.1840271e-40  0             -1.4733162e-05  1412419.1      0              6.8200666e+10  1.1971759e-13  0              3.3810645    
    200000   18000          200            200           -0.00024446611  3.5902031e-35  0             -0.00073339833  74964.367      0              3.619761e+09   1.1971759e-13  0              3.5085513    
    300000   18000          200            200            1.4699259e-05  1.7951047e-35  0              4.4097776e-05  171.29327      0              8271138.8      1.1971759e-13  0              3.4157326    
    400000   18000          200            200           -9.8910313e-05  1.7951035e-35  0             -0.00029673094  9537.3055      0              4.6052235e+08  1.1971759e-13  0              3.3752113    
    500000   18000          200            200            0.010186817    1.0770585e-34  0              0.030560451    1802.0984      0              87016881       1.1971759e-13  0              3.3678731    
    600000   18000          200            200            0.0039965633  -1.7950946e-35  0              0.01198969     596.28798      0              28792613       1.1971759e-13  0              3.368869     
    700000   18000          200            200            0.003993021    8.9754938e-36  0              0.011979063    37.508003      0              1811127.2      1.1971759e-13  0              3.3688631    
    800000   18000          200            200            0.0029451542  -8.975474e-36   0              0.0088354626   9.126472       0              440684.67      1.1971759e-13  0              3.3690737    
    900000   18000          200            200            0.0030886408  -4.4877343e-36  0              0.0092659223   1.4114929      0              68155.94       1.1971759e-13  0              3.3690429    
   1000000   18000          200            200            0.003163018    1.7950975e-35  0              0.009489054    0.079347473    0              3831.4055      1.1971759e-13  0              3.3690279    
   1100000   18000          200            200            0.0031013664  -3.1414191e-35  0              0.0093040991   8.0008497e-06  0              0.3863324      1.1971759e-13  0              3.3690405    
   1200000   18000          200            200            0.0031266738   9.3071194e-43  0              0.0093800214   0.0012548188   0              60.590709      1.1971759e-13  0              3.3690353    
   1300000   18000          200            200            0.0031204346  -5.609677e-37   0              0.0093613039   0.00041773472  0              20.170915      1.1971759e-13  0              3.3690366    
   1400000   18000          200            200            0.0031206383   4.2072582e-37  0              0.0093619149   4.7894249e-05  0              2.3126419      1.1971759e-13  0              3.3690366    
   1500000   18000          200            200            0.0031213437   5.6096776e-37  0              0.0093640312   1.5181678e-06  0              0.073306889    1.1971759e-13  0              3.3690364    
   1600000   18000          200            200            0.0031209173  -2.8048387e-37  0              0.0093627519   4.5095877e-08  0              0.0021775185   1.1971759e-13  0              3.3690365    
   1700000   18000          200            200            0.0031210661   2.8048389e-37  0              0.0093631983   7.974793e-08   0              0.0038507421   1.1971759e-13  0              3.3690365    
   1800000   18000          200            200            0.0031210379   2.8048389e-37  0              0.0093631137   1.7438553e-08  0              0.00084204531  1.1971759e-13  0              3.3690365    
   1900000   18000          200            200            0.0031210343  -1.9633871e-36  0              0.0093631029   1.4187399e-09  0              6.8505871e-05  1.1971759e-13  0              3.3690365    
   2000000   18000          200            200            0.00312104    -1.9633871e-36  0              0.0093631201   1.5746081e-11  0              7.6032192e-07  1.1971759e-13  0              3.3690365    
   2100000   18000          200            200            0.0031210373  -2.8048387e-37  0              0.0093631118   7.3251963e-12  0              3.5370752e-07  1.1971759e-13  0              3.3690365    
   2200000   18000          200            200            0.0031210381   5.6096777e-37  0              0.0093631142   4.222878e-12   0              2.0390766e-07  1.1971759e-13  0              3.3690365    
   2300000   18000          200            200            0.003121038   -2.5243549e-36  0              0.0093631139   6.531481e-13   0              3.1538184e-08  1.1971759e-13  0              3.3690365    
   2400000   18000          200            200            0.0031210379  -5.6096774e-37  0              0.0093631138   3.5321331e-14  0              1.7055406e-09  1.1971759e-13  0              3.3690365    
   2500000   18000          200            200            0.003121038    2.8048389e-37  0              0.0093631139   1.4591073e-18  0              7.0455071e-14  1.1971759e-13  0              3.3690365    
   2600000   18000          200            200            0.003121038    1.1219355e-36  0              0.0093631139   5.2495392e-16  0              2.5348146e-11  1.1971759e-13  0              3.3690365    
   2700000   18000          200            200            0.003121038    1.4024194e-36  0              0.0093631139   2.0392361e-16  0              9.8467412e-12  1.1971759e-13  0              3.3690365    
   2800000   18000          200            200            0.003121038   -1.1219355e-36  0              0.0093631139   2.0707846e-18  0              9.9990776e-14  1.1971759e-13  0              3.3690365    
   2900000   18000          200            200            0.003121038   -2.8048387e-37  0              0.0093631139   7.0050997e-18  0              3.382512e-13   1.1971759e-13  0              3.3690365    
   3000000   18000          200            200            0.003121038    2.8048389e-37  0              0.0093631139   2.9041006e-20  0              1.4022863e-15  1.1971759e-13  0              3.3690365    
Loop time of 841.393 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3080604.807 ns/day, 0.000 hours/ns, 3565.515 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 295.24     | 296.67     | 298.1      |   8.3 | 35.26
Neigh   | 10.67      | 10.671     | 10.671     |   0.0 |  1.27
Comm    | 34.287     | 35.952     | 37.616     |  27.8 |  4.27
Output  | 0.62684    | 0.62687    | 0.62691    |   0.0 |  0.07
Modify  | 436.57     | 436.59     | 436.62     |   0.1 | 51.89
Other   |            | 60.88      |            |       |  7.24

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.75                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.7456392002713
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.85
  ghost atom cutoff = 3.85
  binsize = 1.925, bins = 9351 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 225.1 | 225.1 | 225.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -1.6688146e-05 -2.3336252e-34  0             -5.0064437e-05  1395587.4      0              6.7387923e+10  1.1971759e-13  0              3.3915245    
    200000   18000          200            200           -0.00024037521  3.5902038e-35  0             -0.00072112563  71053.005      0              3.4308953e+09  1.1971759e-13  0              3.5152554    
    300000   18000          200            200            2.3337139e-05 -5.385282e-35   0              7.0011416e-05  423.95612      0              20471324       1.1971759e-13  0              3.420595     
    400000   18000          200            200           -9.1295825e-05  3.590201e-35   0             -0.00027388748  7972.0482      0              3.8494167e+08  1.1971759e-13  0              3.380968     
    500000   18000          200            200            0.0072346549  -1.7950926e-35  0              0.021703965    3338.5765      0              1.6120791e+08  1.1971759e-13  0              3.3733049    
    600000   18000          200            200            0.0051342513  -8.9754646e-36  0              0.015402754    406.8978       0              19647638       1.1971759e-13  0              3.3736631    
    700000   18000          200            200            0.003606304    2.6926463e-35  0              0.010818912    70.06241       0              3383063        1.1971759e-13  0              3.3739387    
    800000   18000          200            200            0.0031265901   1.7950978e-35  0              0.0093797703   11.20254       0              540930.56      1.1971759e-13  0              3.3740374    
    900000   18000          200            200            0.003028567    7.9684471e-42  0              0.0090857011   0.85590686     0              41328.679      1.1971759e-13  0              3.3740567    
   1000000   18000          200            200            0.0031794398   6.8407931e-42  0              0.0095383195   0.0046929149   0              226.60407      1.1971759e-13  0              3.3740259    
   1100000   18000          200            200            0.0031090654  -8.9754806e-36  0              0.0093271961   0.0072425602   0              349.71731      1.1971759e-13  0              3.3740403    
   1200000   18000          200            200            0.0031276779   4.4877429e-36  0              0.0093830337   0.0030818181   0              148.80997      1.1971759e-13  0              3.3740364    
   1300000   18000          200            200            0.0031267585  -5.609677e-37   0              0.0093802754   0.00036500059  0              17.624572      1.1971759e-13  0              3.3740366    
   1400000   18000          200            200            0.0031248118  -7.0120969e-37  0              0.0093744354   9.7795583e-06  0              0.47221987     1.1971759e-13  0              3.374037     
   1500000   18000          200            200            0.0031259958   1.1219355e-36  0              0.0093779873   6.4938568e-07  0              0.03135651     1.1971759e-13  0              3.3740368    
   1600000   18000          200            200            0.0031256055   5.6096777e-37  0              0.0093768165   7.2475121e-07  0              0.034995642    1.1971759e-13  0              3.3740369    
   1700000   18000          200            200            0.0031256628  -3.6462904e-36  0              0.0093769884   1.2870607e-07  0              0.0062147556   1.1971759e-13  0              3.3740369    
   1800000   18000          200            200            0.0031256828  -8.4145162e-37  0              0.0093770485   7.0333412e-09  0              0.00033961487  1.1971759e-13  0              3.3740369    
   1900000   18000          200            200            0.0031256644  -5.6096774e-37  0              0.0093769931   1.9887207e-12  0              9.6028205e-08  1.1971759e-13  0              3.3740369    
   2000000   18000          200            200            0.0031256718   1.0338959e-44  0              0.0093770154   1.3929532e-10  0              6.7260724e-06  1.1971759e-13  0              3.3740369    
   2100000   18000          200            200            0.0031256702   5.6096777e-37  0              0.0093770105   3.9155603e-11  0              1.8906839e-06  1.1971759e-13  0              3.3740369    
   2200000   18000          200            200            0.0031256701  -1.4024194e-36  0              0.0093770103   3.4748901e-12  0              1.6779001e-07  1.1971759e-13  0              3.3740369    
   2300000   18000          200            200            0.0031256704   1.020157e-44   0              0.0093770111   3.8070526e-14  0              1.8382895e-09  1.1971759e-13  0              3.3740369    
   2400000   18000          200            200            0.0031256702  -2.8048387e-37  0              0.0093770107   1.9039623e-14  0              9.1935524e-10  1.1971759e-13  0              3.3740369    
   2500000   18000          200            200            0.0031256703   1.1219355e-36  0              0.0093770108   1.0240861e-14  0              4.9449451e-10  1.1971759e-13  0              3.3740369    
   2600000   18000          200            200            0.0031256703  -5.6096774e-37  0              0.0093770108   1.4024345e-15  0              6.7718543e-11  1.1971759e-13  0              3.3740369    
   2700000   18000          200            200            0.0031256703   5.6096777e-37  0              0.0093770108   1.0478602e-17  0              5.0597421e-13  1.1971759e-13  0              3.3740369    
   2800000   18000          200            200            0.0031256703   1.0438282e-44  0              0.0093770108   2.4418283e-17  0              1.1790715e-12  1.1971759e-13  0              3.3740369    
   2900000   18000          200            200            0.0031256703  -2.8048387e-37  0              0.0093770108   6.2806029e-19  0              3.0326784e-14  1.1971759e-13  0              3.3740369    
   3000000   18000          200            200            0.0031256703  -5.6096774e-37  0              0.0093770108   3.4761135e-18  0              1.6784908e-13  1.1971759e-13  0              3.3740369    
Loop time of 783.57 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3307935.520 ns/day, 0.000 hours/ns, 3828.629 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 245.97     | 246.78     | 247.58     |   5.1 | 31.49
Neigh   | 10.497     | 10.498     | 10.498     |   0.0 |  1.34
Comm    | 34.113     | 35.103     | 36.092     |  16.7 |  4.48
Output  | 0.62549    | 0.62551    | 0.62553    |   0.0 |  0.08
Modify  | 430.57     | 430.71     | 430.85     |   0.7 | 54.97
Other   |            | 59.85      |            |       |  7.64

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.76                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.2329013727605
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.86
  ghost atom cutoff = 3.86
  binsize = 1.93, bins = 9327 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 224.6 | 224.6 | 224.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -2.8307493e-05  1.9746075e-34  0             -8.4922479e-05  1378866.5      0              6.6580529e+10  1.1971759e-13  0              3.401955     
    200000   18000          200            200           -0.00023615591  5.3852977e-35  0             -0.00070846773  67249.678      0              3.2472463e+09  1.1971759e-13  0              3.5219141    
    300000   18000          200            200            3.2093367e-05 -1.7950962e-34  0              9.6280101e-05  788.74655      0              38085748       1.1971759e-13  0              3.4254004    
    400000   18000          200            200           -8.3528323e-05  1.7951032e-35  0             -0.00025058497  6548.7014      0              3.1621335e+08  1.1971759e-13  0              3.386658     
    500000   18000          200            200            0.0041132103   3.5901982e-35  0              0.012339631    4179.9234      0              2.0183354e+08  1.1971759e-13  0              3.3788321    
    600000   18000          200            200            0.0060399232   8.9754858e-35  0              0.018119769    166.11529      0              8021112.7      1.1971759e-13  0              3.3785101    
    700000   18000          200            200            0.0031546056   8.9754947e-36  0              0.0094638169   84.745696      0              4092066.4      1.1971759e-13  0              3.3790302    
    800000   18000          200            200            0.0033113418   7.1803882e-35  0              0.0099340253   9.0870918      0              438783.14      1.1971759e-13  0              3.3790011    
    900000   18000          200            200            0.0029915456  -3.1414186e-35  0              0.0089746368   0.19921223     0              9619.2457      1.1971759e-13  0              3.3790658    
   1000000   18000          200            200            0.0031807205  -1.3463219e-35  0              0.0095421616   0.026656795    0              1287.1612      1.1971759e-13  0              3.3790269    
   1100000   18000          200            200            0.0031221885   8.9754876e-36  0              0.0093665655   0.021024556    0              1015.2006      1.1971759e-13  0              3.3790389    
   1200000   18000          200            200            0.0031279276   8.7958552e-43  0              0.0093837827   0.0029848789   0              144.12912      1.1971759e-13  0              3.3790377    
   1300000   18000          200            200            0.0031326136   5.6096781e-37  0              0.0093978407   9.1597403e-05  0              4.4229108      1.1971759e-13  0              3.3790368    
   1400000   18000          200            200            0.0031294031  -4.2072581e-37  0              0.0093882094   4.7077593e-06  0              0.22732085     1.1971759e-13  0              3.3790374    
   1500000   18000          200            200            0.0031304702   5.6096776e-37  0              0.0093914105   5.7436711e-06  0              0.27734132     1.1971759e-13  0              3.3790372    
   1600000   18000          200            200            0.003130333   -1.4024194e-36  0              0.009390999    9.4317329e-07  0              0.045542463    1.1971759e-13  0              3.3790372    
   1700000   18000          200            200            0.0031302645   5.6096777e-37  0              0.0093907936   3.7616799e-08  0              0.0018163806   1.1971759e-13  0              3.3790372    
   1800000   18000          200            200            0.0031303185   1.9633872e-36  0              0.0093909554   6.7909981e-10  0              3.27913e-05    1.1971759e-13  0              3.3790372    
   1900000   18000          200            200            0.0031302992  -8.4145162e-37  0              0.0093908976   1.5348174e-09  0              7.4110841e-05  1.1971759e-13  0              3.3790372    
   2000000   18000          200            200            0.0031303022  -8.4145162e-37  0              0.0093909066   2.9286115e-10  0              1.4141217e-05  1.1971759e-13  0              3.3790372    
   2100000   18000          200            200            0.0031303032   1.0262151e-44  0              0.0093909095   1.459558e-11   0              7.047683e-07   1.1971759e-13  0              3.3790372    
   2200000   18000          200            200            0.0031303023   5.6096777e-37  0              0.0093909068   6.1093012e-14  0              2.9499629e-09  1.1971759e-13  0              3.3790372    
   2300000   18000          200            200            0.0031303026  -5.6096774e-37  0              0.0093909078   4.0084629e-13  0              1.9355433e-08  1.1971759e-13  0              3.3790372    
   2400000   18000          200            200            0.0031303026   3.3658065e-36  0              0.0093909077   8.9360239e-14  0              4.3148862e-09  1.1971759e-13  0              3.3790372    
   2500000   18000          200            200            0.0031303025   1.017522e-44   0              0.0093909076   5.2415213e-15  0              2.530943e-10   1.1971759e-13  0              3.3790372    
   2600000   18000          200            200            0.0031303026   1.1219355e-36  0              0.0093909077   2.293081e-19   0              1.1072467e-14  1.1971759e-13  0              3.3790372    
   2700000   18000          200            200            0.0031303026   2.8048389e-37  0              0.0093909077   1.5530015e-16  0              7.4988885e-12  1.1971759e-13  0              3.3790372    
   2800000   18000          200            200            0.0031303026  -2.8048387e-37  0              0.0093909077   1.0170071e-18  0              4.9107631e-14  1.1971759e-13  0              3.3790372    
   2900000   18000          200            200            0.0031303026   2.8048389e-37  0              0.0093909077   1.3059956e-17  0              6.3061854e-13  1.1971759e-13  0              3.3790372    
   3000000   18000          200            200            0.0031303026   1.1219355e-36  0              0.0093909077   3.8489285e-18  0              1.8585098e-13  1.1971759e-13  0              3.3790372    
Loop time of 777.238 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3334887.147 ns/day, 0.000 hours/ns, 3859.823 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.85     | 244.32     | 244.79     |   3.0 | 31.43
Neigh   | 10.481     | 10.481     | 10.481     |   0.0 |  1.35
Comm    | 33.286     | 33.924     | 34.562     |  11.0 |  4.36
Output  | 0.62017    | 0.62018    | 0.6202     |   0.0 |  0.08
Modify  | 428.7      | 428.86     | 429.02     |   0.8 | 55.18
Other   |            | 59.03      |            |       |  7.60

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.77                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.7227622706926
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.87
  ghost atom cutoff = 3.87
  binsize = 1.935, bins = 9303 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 224.1 | 224.1 | 224.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -3.9769513e-05  1.1309916e-40  0             -0.00011930854  1362256.1      0              6.5778471e+10  1.1971759e-13  0              3.4123559    
    200000   18000          200            200           -0.00023180876  9.1925255e-41  0             -0.00069542628  63554.071      0              3.0687987e+09  1.1971759e-13  0              3.5285272    
    300000   18000          200            200            4.0966956e-05  1.7951042e-35  0              0.00012290087  1265.2992      0              61096769       1.1971759e-13  0              3.4301488    
    400000   18000          200            200           -7.5608727e-05  1.7951034e-35  0             -0.00022682618  5266.7116      0              2.5431065e+08  1.1971759e-13  0              3.3922812    
    500000   18000          200            200            0.0015380101   5.3852962e-35  0              0.0046140303   4047.2397      0              1.9542672e+08  1.1971759e-13  0              3.384384     
    600000   18000          200            200            0.0065097756   1.7950986e-35  0              0.019529327    12.680531      0              612297.48      1.1971759e-13  0              3.3834341    
    700000   18000          200            200            0.0027192288  -1.1668128e-34  0              0.0081576865   73.181968      0              3533695.3      1.1971759e-13  0              3.3841227    
    800000   18000          200            200            0.0034626268  -8.0779347e-35  0              0.01038788     4.3234433      0              208763.6       1.1971759e-13  0              3.3839721    
    900000   18000          200            200            0.002986992    7.1803881e-35  0              0.0089609759   0.018289088    0              883.1146       1.1971759e-13  0              3.3840682    
   1000000   18000          200            200            0.0031678204   3.5901943e-35  0              0.0095034611   0.1214111      0              5862.5075      1.1971759e-13  0              3.3840308    
   1100000   18000          200            200            0.0031379697   2.2438714e-35  0              0.009413909    0.024788114    0              1196.9293      1.1971759e-13  0              3.384037     
   1200000   18000          200            200            0.0031290738   4.4877429e-36  0              0.0093872214   0.0011041472   0              53.315318      1.1971759e-13  0              3.3840388    
   1300000   18000          200            200            0.0031374757   1.1219356e-36  0              0.0094124271   1.6251307e-05  0              0.78471743     1.1971759e-13  0              3.3840371    
   1400000   18000          200            200            0.003134431   -1.4024194e-37  0              0.009403293    4.0892051e-05  0              1.9745308      1.1971759e-13  0              3.3840377    
   1500000   18000          200            200            0.0031348535   3.0853227e-36  0              0.0094045604   7.1752569e-06  0              0.34646748     1.1971759e-13  0              3.3840376    
   1600000   18000          200            200            0.003135042    1.1219355e-36  0              0.0094051259   2.5296526e-07  0              0.012214787    1.1971759e-13  0              3.3840376    
   1700000   18000          200            200            0.0031348918   2.8048389e-37  0              0.0094046754   9.9968274e-09  0              0.00048271102  1.1971759e-13  0              3.3840376    
   1800000   18000          200            200            0.0031349424  -8.4145162e-37  0              0.0094048271   1.3533558e-08  0              0.00065348707  1.1971759e-13  0              3.3840376    
   1900000   18000          200            200            0.0031349367   1.0466395e-44  0              0.0094048102   2.0453031e-09  0              9.8760366e-05  1.1971759e-13  0              3.3840376    
   2000000   18000          200            200            0.0031349329  -5.6096774e-37  0              0.0094047987   5.4608945e-11  0              2.6368705e-06  1.1971759e-13  0              3.3840376    
   2100000   18000          200            200            0.0031349356  -2.8048387e-37  0              0.0094048067   5.0239985e-12  0              2.4259091e-07  1.1971759e-13  0              3.3840376    
   2200000   18000          200            200            0.0031349347   8.4145164e-37  0              0.0094048042   4.4011061e-12  0              2.1251366e-07  1.1971759e-13  0              3.3840376    
   2300000   18000          200            200            0.0031349348  -2.8048387e-37  0              0.0094048044   5.7448401e-13  0              2.7739777e-08  1.1971759e-13  0              3.3840376    
   2400000   18000          200            200            0.0031349349   3.3658065e-36  0              0.0094048046   1.0815352e-14  0              5.2223465e-10  1.1971759e-13  0              3.3840376    
   2500000   18000          200            200            0.0031349348   5.0487098e-36  0              0.0094048045   2.3345815e-15  0              1.1272859e-10  1.1971759e-13  0              3.3840376    
   2600000   18000          200            200            0.0031349348  -2.8048387e-37  0              0.0094048045   1.3658959e-15  0              6.5954223e-11  1.1971759e-13  0              3.3840376    
   2700000   18000          200            200            0.0031349348   2.8048389e-37  0              0.0094048045   1.1786594e-16  0              5.6913242e-12  1.1971759e-13  0              3.3840376    
   2800000   18000          200            200            0.0031349348   1.0321113e-44  0              0.0094048045   8.5182979e-18  0              4.1131812e-13  1.1971759e-13  0              3.3840376    
   2900000   18000          200            200            0.0031349348   8.8855165e-45  0              0.0094048045   9.1135013e-22  0              4.4005836e-17  1.1971759e-13  0              3.3840376    
   3000000   18000          200            200            0.0031349348   1.0011741e-44  0              0.0094048045   1.2652769e-17  0              6.1095693e-13  1.1971759e-13  0              3.3840376    
Loop time of 783.163 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3309656.245 ns/day, 0.000 hours/ns, 3830.621 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 246.2      | 246.93     | 247.66     |   4.6 | 31.53
Neigh   | 10.71      | 10.71      | 10.711     |   0.0 |  1.37
Comm    | 33.989     | 34.535     | 35.082     |   9.3 |  4.41
Output  | 0.62467    | 0.62468    | 0.6247     |   0.0 |  0.08
Modify  | 430.93     | 431.13     | 431.34     |   1.0 | 55.05
Other   |            | 59.23      |            |       |  7.56

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.78                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.2152288055716
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.88
  ghost atom cutoff = 3.88
  binsize = 1.94, bins = 9279 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 223.5 | 223.5 | 223.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -5.1074315e-05  3.5902116e-35  0             -0.00015322295  1345756.6      0              6.4981772e+10  1.1971759e-13  0              3.4227272    
    200000   18000          200            200           -0.00022733514  7.1119785e-41  0             -0.00068200543  59966.471      0              2.8955663e+09  1.1971759e-13  0              3.5350945    
    300000   18000          200            200            4.9955665e-05 -1.79509e-35    0              0.000149867    1853.1497      0              89481966       1.1971759e-13  0              3.4348402    
    400000   18000          200            200           -6.7539396e-05 -1.7950904e-35  0             -0.00020261819  4125.7262      0              1.9921655e+08  1.1971759e-13  0              3.3978373    
    500000   18000          200            200            4.2330835e-05  3.5901988e-35  0              0.0001269925   3239.8892      0              1.5644266e+08  1.1971759e-13  0              3.3899016    
    600000   18000          200            200            0.0064290644   8.9754999e-36  0              0.019287193    40.14104       0              1938267.2      1.1971759e-13  0              3.3884474    
    700000   18000          200            200            0.0023665276   2.0643614e-34  0              0.0070995829   43.380184      0              2094673.8      1.1971759e-13  0              3.3892016    
    800000   18000          200            200            0.003548625    1.7950977e-35  0              0.010645875    0.52440037     0              25321.417      1.1971759e-13  0              3.3889563    
    900000   18000          200            200            0.0030169733  -5.3852896e-35  0              0.0090509199   0.46730387     0              22564.432      1.1971759e-13  0              3.3890634    
   1000000   18000          200            200            0.0031457319   8.9754907e-36  0              0.0094371958   0.1895061      0              9150.5715      1.1971759e-13  0              3.3890366    
   1100000   18000          200            200            0.0031527707  -8.9754806e-36  0              0.0094583121   0.014052021    0              678.5218       1.1971759e-13  0              3.3890353    
   1200000   18000          200            200            0.0031324236  -6.7316121e-36  0              0.0093972707   3.1400182e-07  0              0.015162024    1.1971759e-13  0              3.3890395    
   1300000   18000          200            200            0.0031412485  -1.1219355e-35  0              0.0094237456   0.00025141006  0              12.139692      1.1971759e-13  0              3.3890376    
   1400000   18000          200            200            0.0031397026  -4.2072581e-37  0              0.0094191079   5.6421205e-05  0              2.7243781      1.1971759e-13  0              3.389038     
   1500000   18000          200            200            0.0031392811   9.0033603e-45  0              0.0094178434   2.2734294e-06  0              0.10977577     1.1971759e-13  0              3.389038     
   1600000   18000          200            200            0.0031396861   8.4145164e-37  0              0.0094190584   7.1152791e-08  0              0.0034357136   1.1971759e-13  0              3.389038     
   1700000   18000          200            200            0.0031395478  -1.6829033e-36  0              0.0094186435   1.0624555e-07  0              0.0051302176   1.1971759e-13  0              3.389038     
   1800000   18000          200            200            0.0031395607   5.6096776e-37  0              0.0094186822   1.460382e-08   0              0.00070516618  1.1971759e-13  0              3.389038     
   1900000   18000          200            200            0.0031395727   1.0075601e-44  0              0.0094187182   2.2309088e-10  0              1.077226e-05   1.1971759e-13  0              3.389038     
   2000000   18000          200            200            0.0031395653   1.9633872e-36  0              0.0094186959   7.6587368e-11  0              3.6981299e-06  1.1971759e-13  0              3.389038     
   2100000   18000          200            200            0.0031395673  -8.4145162e-37  0              0.0094187018   3.7833754e-11  0              1.8268566e-06  1.1971759e-13  0              3.389038     
   2200000   18000          200            200            0.0031395673   5.6096777e-37  0              0.0094187019   3.2052468e-12  0              1.5476989e-07  1.1971759e-13  0              3.389038     
   2300000   18000          200            200            0.003139567    2.8048389e-37  0              0.0094187011   2.1632344e-15  0              1.0445485e-10  1.1971759e-13  0              3.389038     
   2400000   18000          200            200            0.0031395672  -2.8048387e-37  0              0.0094187015   4.5402853e-14  0              2.1923413e-09  1.1971759e-13  0              3.389038     
   2500000   18000          200            200            0.0031395671   5.6096777e-37  0              0.0094187014   1.1714489e-14  0              5.6565076e-10  1.1971759e-13  0              3.389038     
   2600000   18000          200            200            0.0031395671   2.8048389e-37  0              0.0094187014   6.1008399e-16  0              2.9458772e-11  1.1971759e-13  0              3.389038     
   2700000   18000          200            200            0.0031395671  -2.9731291e-35  0              0.0094187014   4.1942055e-17  0              2.0252318e-12  1.1971759e-13  0              3.389038     
   2800000   18000          200            200            0.0031395671  -1.1219355e-36  0              0.0094187014   1.1255514e-17  0              5.434885e-13   1.1971759e-13  0              3.389038     
   2900000   18000          200            200            0.0031395671  -4.2072581e-36  0              0.0094187014   7.5919314e-20  0              3.665872e-15   1.1971759e-13  0              3.389038     
   3000000   18000          200            200            0.0031395671  -5.6096774e-37  0              0.0094187014   4.7754653e-18  0              2.3059013e-13  1.1971759e-13  0              3.389038     
Loop time of 779.435 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3325485.602 ns/day, 0.000 hours/ns, 3848.942 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.93     | 245.05     | 247.17     |  13.6 | 31.44
Neigh   | 10.738     | 10.738     | 10.738     |   0.0 |  1.38
Comm    | 33.684     | 35.784     | 37.884     |  35.1 |  4.59
Output  | 0.62992    | 0.62994    | 0.62996    |   0.0 |  0.08
Modify  | 427.75     | 427.82     | 427.88     |   0.3 | 54.89
Other   |            | 59.42      |            |       |  7.62

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.79                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.7103078889014
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.89
  ghost atom cutoff = 3.89
  binsize = 1.945, bins = 9255 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 219.1 | 219.1 | 219.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -6.2222935e-05  5.3852989e-35  0             -0.0001866688   1329366.7      0              6.4190361e+10  1.1971759e-13  0              3.433069     
    200000   18000          200            200           -0.0002227346  -5.3852811e-35  0             -0.0006682038   56485.808      0              2.7274975e+09  1.1971759e-13  0              3.5416162    
    300000   18000          200            200            5.9061059e-05 -1.7950912e-35  0              0.00017718318  2552.0841      0              1.2323101e+08  1.1971759e-13  0              3.4394742    
    400000   18000          200            200           -5.9319073e-05  3.5901994e-35  0             -0.00017795722  3124.8961      0              1.5089005e+08  1.1971759e-13  0              3.4033265    
    500000   18000          200            200           -5.1406866e-05  4.4240737e-41  0             -0.0001542206   2326.3421      0              1.1233074e+08  1.1971759e-13  0              3.3953515    
    600000   18000          200            200            0.0058154632   1.7950982e-35  0              0.017446389    230.5263       0              11131290       1.1971759e-13  0              3.3935481    
    700000   18000          200            200            0.0021396143  -8.0779346e-35  0              0.0064188429   13.311381      0              642758.94      1.1971759e-13  0              3.3942551    
    800000   18000          200            200            0.0035509348   8.9020322e-42  0              0.010652804    0.60248397     0              29091.795      1.1971759e-13  0              3.3939569    
    900000   18000          200            200            0.0030758369  -1.795096e-35   0              0.0092275106   1.1464239      0              55356.705      1.1971759e-13  0              3.3940526    
   1000000   18000          200            200            0.0031219869   3.1414201e-35  0              0.0093659608   0.16018662     0              7734.8384      1.1971759e-13  0              3.3940428    
   1100000   18000          200            200            0.0031632688  -4.4877386e-36  0              0.0094898065   0.0016922665   0              81.713495      1.1971759e-13  0              3.3940345    
   1200000   18000          200            200            0.0031384533  -8.9754832e-36  0              0.00941536     0.0011574231   0              55.887819      1.1971759e-13  0              3.3940395    
   1300000   18000          200            200            0.0031443024   5.6096781e-37  0              0.0094329071   0.00043528948  0              21.018571      1.1971759e-13  0              3.3940383    
   1400000   18000          200            200            0.0031449085   8.4145163e-37  0              0.0094347255   2.4998179e-05  0              1.2070726      1.1971759e-13  0              3.3940382    
   1500000   18000          200            200            0.0031438638   2.8048389e-37  0              0.0094315914   2.2438396e-07  0              0.010834699    1.1971759e-13  0              3.3940384    
   1600000   18000          200            200            0.0031442586  -2.8048387e-37  0              0.0094327758   7.6181054e-07  0              0.036785104    1.1971759e-13  0              3.3940384    
   1700000   18000          200            200            0.0031442167   1.7950968e-35  0              0.0094326501   1.1162305e-07  0              0.0053898777   1.1971759e-13  0              3.3940384    
   1800000   18000          200            200            0.0031441838   1.0450481e-44  0              0.0094325514   1.3636036e-09  0              6.5843537e-05  1.1971759e-13  0              3.3940384    
   1900000   18000          200            200            0.0031442043   2.243871e-36   0              0.0094326128   7.3856566e-10  0              3.5662692e-05  1.1971759e-13  0              3.3940384    
   2000000   18000          200            200            0.0031441993   2.8048389e-37  0              0.0094325979   2.9581509e-10  0              1.4283852e-05  1.1971759e-13  0              3.3940384    
   2100000   18000          200            200            0.0031441989  -2.8048387e-37  0              0.0094325966   1.7948145e-11  0              8.666517e-07   1.1971759e-13  0              3.3940384    
   2200000   18000          200            200            0.0031441997   1.1219355e-36  0              0.0094325991   1.146996e-13   0              5.5384332e-09  1.1971759e-13  0              3.3940384    
   2300000   18000          200            200            0.0031441994   1.9633872e-36  0              0.0094325981   5.0411433e-13  0              2.4341877e-08  1.1971759e-13  0              3.3940384    
   2400000   18000          200            200            0.0031441994   1.4024194e-36  0              0.0094325982   7.7868095e-14  0              3.7599716e-09  1.1971759e-13  0              3.3940384    
   2500000   18000          200            200            0.0031441994   5.6096777e-37  0              0.0094325983   1.076592e-15   0              5.1984776e-11  1.1971759e-13  0              3.3940384    
   2600000   18000          200            200            0.0031441994   1.04377e-44    0              0.0094325983   4.2471083e-16  0              2.0507766e-11  1.1971759e-13  0              3.3940384    
   2700000   18000          200            200            0.0031441994   5.6096777e-37  0              0.0094325983   1.9153693e-16  0              9.2486329e-12  1.1971759e-13  0              3.3940384    
   2800000   18000          200            200            0.0031441994   1.0275992e-44  0              0.0094325983   6.7604236e-18  0              3.2643666e-13  1.1971759e-13  0              3.3940384    
   2900000   18000          200            200            0.0031441994  -3.0853226e-36  0              0.0094325983   8.3761787e-18  0              4.0445569e-13  1.1971759e-13  0              3.3940384    
   3000000   18000          200            200            0.0031441994  -5.6096775e-37  0              0.0094325983   5.7942033e-18  0              2.7978134e-13  1.1971759e-13  0              3.3940384    
Loop time of 780.141 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3322474.539 ns/day, 0.000 hours/ns, 3845.457 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.23     | 244.66     | 246.08     |   9.1 | 31.36
Neigh   | 10.705     | 10.705     | 10.706     |   0.0 |  1.37
Comm    | 33.698     | 34.897     | 36.097     |  20.3 |  4.47
Output  | 0.62228    | 0.6223     | 0.62231    |   0.0 |  0.08
Modify  | 428.56     | 428.79     | 429.03     |   1.2 | 54.96
Other   |            | 60.47      |            |       |  7.75

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.8                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.2080064321856
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.9
  ghost atom cutoff = 3.9
  binsize = 1.95, bins = 9231 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 218.6 | 218.6 | 218.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -7.3214747e-05  2.1541179e-34  0             -0.00021964424  1313088        0              6.3404321e+10  1.1971759e-13  0              3.4433808    
    200000   18000          200            200           -0.0002180085   5.3853001e-35  0             -0.00065402549  53112.339      0              2.5646048e+09  1.1971759e-13  0              3.5480919    
    300000   18000          200            200            6.828069e-05  -5.3852846e-35  0              0.00020484207  3361.6183      0              1.6232052e+08  1.1971759e-13  0              3.4440509    
    400000   18000          200            200           -5.0951032e-05  1.2565684e-34  0             -0.0001528531   2263.9677      0              1.093189e+08   1.1971759e-13  0              3.4087484    
    500000   18000          200            200           -4.2537553e-05 -5.3852858e-35  0             -0.00012761266  1563.0972      0              75476370       1.1971759e-13  0              3.4007275    
    600000   18000          200            200            0.0048137299   3.5901952e-35  0              0.01444119     466.68507      0              22534552       1.1971759e-13  0              3.3987201    
    700000   18000          200            200            0.0020604576   1.0770582e-34  0              0.0061813728   0.037688603    0              1819.8477      1.1971759e-13  0              3.3992755    
    800000   18000          200            200            0.0034699017  -2.6926444e-35  0              0.010409705    4.4671941      0              215704.81      1.1971759e-13  0              3.398974     
    900000   18000          200            200            0.0031512237   8.7282711e-42  0              0.0094536712   1.4521905      0              70121.081      1.1971759e-13  0              3.3990385    
   1000000   18000          200            200            0.0031045065  -2.2438704e-35  0              0.0093135195   0.064375476    0              3108.4614      1.1971759e-13  0              3.3990477    
   1100000   18000          200            200            0.0031675451  -4.4877386e-36  0              0.0095026353   0.0024399932   0              117.81854      1.1971759e-13  0              3.3990349    
   1200000   18000          200            200            0.0031466357  -2.2438701e-36  0              0.0094399072   0.0029849321   0              144.13169      1.1971759e-13  0              3.3990392    
   1300000   18000          200            200            0.0031473134   1.1219356e-36  0              0.0094419401   0.00028755966  0              13.885227      1.1971759e-13  0              3.399039     
   1400000   18000          200            200            0.0031497721   2.8048388e-37  0              0.0094493162   8.3232612e-09  0              0.00040190049  1.1971759e-13  0              3.3990385    
   1500000   18000          200            200            0.0031486279   9.2776035e-45  0              0.0094458836   4.8029916e-06  0              0.23191928     1.1971759e-13  0              3.3990388    
   1600000   18000          200            200            0.0031487955   1.1219355e-36  0              0.0094463866   9.0746921e-07  0              0.043818441    1.1971759e-13  0              3.3990387    
   1700000   18000          200            200            0.0031488741  -5.6096774e-37  0              0.0094466222   1.4536719e-08  0              0.00070192615  1.1971759e-13  0              3.3990387    
   1800000   18000          200            200            0.0031488183   1.0494591e-44  0              0.0094464549   5.4111929e-09  0              0.00026128714  1.1971759e-13  0              3.3990387    
   1900000   18000          200            200            0.0031488319  -2.8048387e-37  0              0.0094464957   2.2497549e-09  0              0.00010863261  1.1971759e-13  0              3.3990387    
   2000000   18000          200            200            0.0031488334   2.8048389e-37  0              0.0094465002   1.1407878e-10  0              5.5084561e-06  1.1971759e-13  0              3.3990387    
   2100000   18000          200            200            0.003148831   -2.8048387e-37  0              0.0094464929   2.7401679e-12  0              1.323129e-07   1.1971759e-13  0              3.3990387    
   2200000   18000          200            200            0.0031488318  -2.8048387e-37  0              0.0094464955   4.4793284e-12  0              2.1629074e-07  1.1971759e-13  0              3.3990387    
   2300000   18000          200            200            0.0031488318   5.6096777e-37  0              0.0094464953   4.7479374e-13  0              2.292609e-08   1.1971759e-13  0              3.3990387    
   2400000   18000          200            200            0.0031488317  -2.8048387e-37  0              0.009446495    3.1822257e-16  0              1.5365829e-11  1.1971759e-13  0              3.3990387    
   2500000   18000          200            200            0.0031488317   4.7682259e-36  0              0.0094464952   6.9852156e-15  0              3.3729106e-10  1.1971759e-13  0              3.3990387    
   2600000   18000          200            200            0.0031488317  -8.4145162e-37  0              0.0094464952   1.4636761e-15  0              7.0675683e-11  1.1971759e-13  0              3.3990387    
   2700000   18000          200            200            0.0031488317   2.7206936e-35  0              0.0094464952   2.1853736e-18  0              1.0552387e-13  1.1971759e-13  0              3.3990387    
   2800000   18000          200            200            0.0031488317   5.6096777e-37  0              0.0094464952   2.3359672e-17  0              1.1279549e-12  1.1971759e-13  0              3.3990387    
   2900000   18000          200            200            0.0031488317   5.6096777e-37  0              0.0094464952   7.0196993e-18  0              3.3895616e-13  1.1971759e-13  0              3.3990387    
   3000000   18000          200            200            0.0031488317  -2.8048386e-37  0              0.0094464952   6.214834e-18   0              3.0009209e-13  1.1971759e-13  0              3.3990387    
Loop time of 781.087 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3318450.313 ns/day, 0.000 hours/ns, 3840.799 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.51     | 242.58     | 246.66     |  26.2 | 31.06
Neigh   | 10.939     | 10.939     | 10.94      |   0.0 |  1.40
Comm    | 33.544     | 37.51      | 41.476     |  64.8 |  4.80
Output  | 0.62085    | 0.6209     | 0.62095    |   0.0 |  0.08
Modify  | 428.43     | 428.44     | 428.45     |   0.1 | 54.85
Other   |            | 60.99      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.81                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.7083313469284
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.91
  ghost atom cutoff = 3.91
  binsize = 1.955, bins = 9208 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 218.1 | 218.1 | 218.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -8.4051594e-05  3.5902077e-35  0             -0.00025215478  1296917.8      0              6.2623517e+10  1.1971759e-13  0              3.4536633    
    200000   18000          200            200           -0.00021315677 -3.590187e-35   0             -0.0006394703   49845.344      0              2.4068533e+09  1.1971759e-13  0              3.5545219    
    300000   18000          200            200            7.7615058e-05  8.9959689e-41  0              0.00023284517  4281.5045      0              2.0673853e+08  1.1971759e-13  0              3.4485701    
    400000   18000          200            200           -4.2434053e-05 -2.6926446e-34  0             -0.00012730216  1542.1922      0              74466942       1.1971759e-13  0              3.414103     
    500000   18000          200            200           -3.3507984e-05 -1.7950918e-35  0             -0.00010052395  951.74558      0              45956388       1.1971759e-13  0              3.4060296    
    600000   18000          200            200            0.0036423635  -1.7950954e-35  0              0.010927091    613.65198      0              29631058       1.1971759e-13  0              3.4039369    
    700000   18000          200            200            0.0021358019   8.9754941e-36  0              0.0064074057   10.768961      0              519994.6       1.1971759e-13  0              3.4042598    
    800000   18000          200            200            0.0033245595  -1.795096e-35   0              0.0099736786   9.1046886      0              439632.83      1.1971759e-13  0              3.404004     
    900000   18000          200            200            0.0032266115   7.1803881e-35  0              0.0096798344   1.1104097      0              53617.712      1.1971759e-13  0              3.4040245    
   1000000   18000          200            200            0.0030993889  -4.4877353e-36  0              0.0092981666   0.0013766932   0              66.475588      1.1971759e-13  0              3.4040501    
   1100000   18000          200            200            0.0031657215   1.3463229e-35  0              0.0094971644   0.015267249    0              737.20084      1.1971759e-13  0              3.4040366    
   1200000   18000          200            200            0.0031556412  -1.1219354e-35  0              0.0094669237   0.0029988991   0              144.8061       1.1971759e-13  0              3.4040387    
   1300000   18000          200            200            0.0031509722   1.1219356e-36  0              0.0094529167   3.4213456e-05  0              1.6520454      1.1971759e-13  0              3.4040396    
   1400000   18000          200            200            0.0031541829   2.3225461e-45  0              0.0094625488   2.345093e-05   0              1.1323615      1.1971759e-13  0              3.404039     
   1500000   18000          200            200            0.0031535017   8.4145164e-37  0              0.0094605051   7.4170679e-06  0              0.35814366     1.1971759e-13  0              3.4040391    
   1600000   18000          200            200            0.0031533542  -2.8048387e-37  0              0.0094600627   2.1336898e-07  0              0.010302824    1.1971759e-13  0              3.4040391    
   1700000   18000          200            200            0.0031535033  -2.8048387e-37  0              0.00946051     2.9534029e-08  0              0.0014260926   1.1971759e-13  0              3.4040391    
   1800000   18000          200            200            0.0031534626   1.0281036e-44  0              0.0094603877   1.6926946e-08  0              0.00081734165  1.1971759e-13  0              3.4040391    
   1900000   18000          200            200            0.0031534594  -5.6096774e-37  0              0.0094603782   8.9338779e-10  0              4.3138499e-05  1.1971759e-13  0              3.4040391    
   2000000   18000          200            200            0.0031534661  -1.6829033e-36  0              0.0094603982   2.5536832e-11  0              1.2330822e-06  1.1971759e-13  0              3.4040391    
   2100000   18000          200            200            0.0031534638  -8.4145162e-37  0              0.0094603914   3.5640241e-11  0              1.7209397e-06  1.1971759e-13  0              3.4040391    
   2200000   18000          200            200            0.0031534638  -1.9633871e-36  0              0.0094603915   3.0413093e-12  0              1.4685394e-07  1.1971759e-13  0              3.4040391    
   2300000   18000          200            200            0.0031534641  -8.4145162e-37  0              0.0094603923   6.5967411e-15  0              3.1853302e-10  1.1971759e-13  0              3.4040391    
   2400000   18000          200            200            0.003153464   -2.8048387e-37  0              0.009460392    6.8986702e-14  0              3.3311209e-09  1.1971759e-13  0              3.4040391    
   2500000   18000          200            200            0.003153464    5.6096777e-37  0              0.009460392    8.95425e-15    0              4.3236869e-10  1.1971759e-13  0              3.4040391    
   2600000   18000          200            200            0.003153464   -5.6096774e-37  0              0.009460392    2.2778399e-17  0              1.0998874e-12  1.1971759e-13  0              3.4040391    
   2700000   18000          200            200            0.003153464    5.6096777e-37  0              0.009460392    1.7684166e-16  0              8.539051e-12   1.1971759e-13  0              3.4040391    
   2800000   18000          200            200            0.003153464    2.8048389e-37  0              0.009460392    6.5149269e-19  0              3.145825e-14   1.1971759e-13  0              3.4040391    
   2900000   18000          200            200            0.003153464    2.243871e-36   0              0.009460392    6.3770512e-18  0              3.0792498e-13  1.1971759e-13  0              3.4040391    
   3000000   18000          200            200            0.003153464    1.1219355e-36  0              0.009460392    1.5181689e-17  0              7.3306941e-13  1.1971759e-13  0              3.4040391    
Loop time of 780.142 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3322474.006 ns/day, 0.000 hours/ns, 3845.456 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.09     | 244.59     | 246.09     |   9.6 | 31.35
Neigh   | 10.985     | 10.986     | 10.986     |   0.0 |  1.41
Comm    | 34.195     | 35.678     | 37.161     |  24.8 |  4.57
Output  | 0.62299    | 0.62301    | 0.62303    |   0.0 |  0.08
Modify  | 428.95     | 429.04     | 429.14     |   0.5 | 55.00
Other   |            | 59.22      |            |       |  7.59

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.82                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.2112895446332
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.92
  ghost atom cutoff = 3.92
  binsize = 1.96, bins = 9184 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 217.5 | 217.5 | 217.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -9.4732005e-05  8.9754915e-35  0             -0.00028419602  1280859.2      0              6.1848107e+10  1.1971759e-13  0              3.4639155    
    200000   18000          200            200           -0.00020818126  3.5901973e-35  0             -0.00062454379  46685.298      0              2.2542659e+09  1.1971759e-13  0              3.5609056    
    300000   18000          200            200            8.7061387e-05  8.9754917e-35  0              0.00026118416  5311.1725      0              2.5645751e+08  1.1971759e-13  0              3.4530318    
    400000   18000          200            200           -3.3772039e-05 -5.3852835e-35  0             -0.00010131612  959.28012      0              46320204       1.1971759e-13  0              3.4193901    
    500000   18000          200            200           -2.4323902e-05 -8.9754789e-35  0             -7.2971705e-05  491.92858      0              23753470       1.1971759e-13  0              3.4112576    
    600000   18000          200            200            0.0025220399   1.5900927e-41  0              0.0075661198   601.42731      0              29040773       1.1971759e-13  0              3.4091673    
    700000   18000          200            200            0.0023606143  -1.7950957e-35  0              0.007081843    39.422995      0              1903595.3      1.1971759e-13  0              3.4092105    
    800000   18000          200            200            0.0031473443  -2.6926443e-35  0              0.0094420329   10.969003      0              529653.9       1.1971759e-13  0              3.4090409    
    900000   18000          200            200            0.0032849507   8.530338e-42   0              0.0098548521   0.42465521     0              20505.08       1.1971759e-13  0              3.4090141    
   1000000   18000          200            200            0.0031093092   3.1414201e-35  0              0.0093279275   0.035763075    0              1726.8709      1.1971759e-13  0              3.4090494    
   1100000   18000          200            200            0.0031599163   2.6926456e-35  0              0.0094797489   0.024747299    0              1194.9585      1.1971759e-13  0              3.4090391    
   1200000   18000          200            200            0.0031638327  -2.2438701e-36  0              0.009491498    0.0011866562   0              57.299381      1.1971759e-13  0              3.4090383    
   1300000   18000          200            200            0.0031556918   1.1219356e-36  0              0.0094670754   5.9301196e-05  0              2.8634425      1.1971759e-13  0              3.40904      
   1400000   18000          200            200            0.0031582487  -2.8048388e-37  0              0.0094747462   5.527935e-05   0              2.669242       1.1971759e-13  0              3.4090394    
   1500000   18000          200            200            0.0031583551  -2.8048387e-37  0              0.0094750653   3.2082181e-06  0              0.15491337     1.1971759e-13  0              3.4090394    
   1600000   18000          200            200            0.0031579786  -5.6096774e-37  0              0.0094739359   9.1471045e-08  0              0.0044168094   1.1971759e-13  0              3.4090395    
   1700000   18000          200            200            0.0031581066  -2.8048387e-37  0              0.0094743199   1.2227021e-07  0              0.005903991    1.1971759e-13  0              3.4090395    
   1800000   18000          200            200            0.0031581079   1.0299736e-44  0              0.0094743236   8.4820205e-09  0              0.00040956642  1.1971759e-13  0              3.4090395    
   1900000   18000          200            200            0.0031580906   2.8048389e-37  0              0.0094742717   1.2680301e-10  0              6.1228634e-06  1.1971759e-13  0              3.4090395    
   2000000   18000          200            200            0.0031580969   5.6096777e-37  0              0.0094742908   2.6765755e-10  0              1.2924225e-05  1.1971759e-13  0              3.4090395    
   2100000   18000          200            200            0.0031580968   1.0270597e-44  0              0.0094742904   2.1988248e-11  0              1.0617338e-06  1.1971759e-13  0              3.4090395    
   2200000   18000          200            200            0.003158096   -8.4145162e-37  0              0.0094742881   1.467737e-13   0              7.0871765e-09  1.1971759e-13  0              3.4090395    
   2300000   18000          200            200            0.0031580963   1.0319013e-44  0              0.009474289    5.7946787e-13  0              2.798043e-08   1.1971759e-13  0              3.4090395    
   2400000   18000          200            200            0.0031580963  -8.4145162e-37  0              0.009474289    5.6055264e-14  0              2.7067081e-09  1.1971759e-13  0              3.4090395    
   2500000   18000          200            200            0.0031580963   1.4024194e-36  0              0.0094742888   9.014722e-17   0              4.3528866e-12  1.1971759e-13  0              3.4090395    
   2600000   18000          200            200            0.0031580963  -1.9633871e-36  0              0.0094742889   1.2095239e-15  0              5.840358e-11   1.1971759e-13  0              3.4090395    
   2700000   18000          200            200            0.0031580963   1.0208137e-44  0              0.0094742889   7.4886324e-17  0              3.6159926e-12  1.1971759e-13  0              3.4090395    
   2800000   18000          200            200            0.0031580963  -1.9633871e-36  0              0.0094742889   2.4737857e-17  0              1.1945026e-12  1.1971759e-13  0              3.4090395    
   2900000   18000          200            200            0.0031580963  -1.1219355e-36  0              0.0094742889   1.2505847e-17  0              6.038626e-13   1.1971759e-13  0              3.4090395    
   3000000   18000          200            200            0.0031580963   2.8048389e-37  0              0.0094742889   3.330009e-19   0              1.6079422e-14  1.1971759e-13  0              3.4090395    
Loop time of 777.785 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3332541.501 ns/day, 0.000 hours/ns, 3857.108 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.88     | 242.38     | 246.87     |  28.9 | 31.16
Neigh   | 10.373     | 10.373     | 10.373     |   0.0 |  1.33
Comm    | 32.341     | 36.581     | 40.821     |  70.1 |  4.70
Output  | 0.62061    | 0.62063    | 0.62065    |   0.0 |  0.08
Modify  | 427.89     | 427.98     | 428.06     |   0.4 | 55.02
Other   |            | 59.85      |            |       |  7.70

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.83                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.7168879368044
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.93
  ghost atom cutoff = 3.93
  binsize = 1.965, bins = 9161 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 213.3 | 213.3 | 213.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00010525858 -3.5901821e-35  0             -0.00031577575  1264908        0              6.1077883e+10  1.1971759e-13  0              3.4741385    
    200000   18000          200            200           -0.00020308082 -1.7950885e-35  0             -0.00060924247  43630.879      0              2.106779e+09   1.1971759e-13  0              3.5672434    
    300000   18000          200            200            9.6621426e-05  7.1803938e-35  0              0.00028986428  6450.5392      0              3.1147345e+08  1.1971759e-13  0              3.4574356    
    400000   18000          200            200           -2.4963743e-05 -1.795091e-35   0             -7.4891228e-05  514.5372       0              24845160       1.1971759e-13  0              3.4246096    
    500000   18000          200            200           -1.4983854e-05  1.0770586e-34  0             -4.4951562e-05  182.8083       0              8827158.8      1.1971759e-13  0              3.4164115    
    600000   18000          200            200            0.0016121888  -4.4877405e-35  0              0.0048365665   452.10575      0              21830569       1.1971759e-13  0              3.4143814    
    700000   18000          200            200            0.002715133   -1.5258322e-34  0              0.0081453991   69.544187      0              3358039.9      1.1971759e-13  0              3.4141348    
    800000   18000          200            200            0.0029754275  -7.1803864e-35  0              0.0089262826   8.7052592      0              420345.81      1.1971759e-13  0              3.4140775    
    900000   18000          200            200            0.0033130114  -1.795096e-35   0              0.0099390342   0.008920719    0              430.74959      1.1971759e-13  0              3.4140097    
   1000000   18000          200            200            0.0031328149   2.2438717e-35  0              0.0093984447   0.1311298      0              6331.789       1.1971759e-13  0              3.414046     
   1100000   18000          200            200            0.0031535318  -6.2828385e-35  0              0.0094605954   0.019579166    0              945.40787      1.1971759e-13  0              3.4140417    
   1200000   18000          200            200            0.0031698812   2.243872e-36   0              0.0095096437   1.8494584e-06  0              0.089303725    1.1971759e-13  0              3.4140384    
   1300000   18000          200            200            0.0031614326  -5.609677e-37   0              0.0094842977   0.0003216636   0              15.531984      1.1971759e-13  0              3.4140401    
   1400000   18000          200            200            0.0031622418  -2.8048388e-37  0              0.0094867254   4.1735229e-05  0              2.0152449      1.1971759e-13  0              3.4140399    
   1500000   18000          200            200            0.0031630695  -1.1219355e-36  0              0.0094892085   9.3414067e-09  0              0.0004510631   1.1971759e-13  0              3.4140398    
   1600000   18000          200            200            0.0031626732  -1.9633871e-36  0              0.0094880196   7.8079804e-07  0              0.037701943    1.1971759e-13  0              3.4140399    
   1700000   18000          200            200            0.0031627031  -2.8048387e-37  0              0.0094881094   8.806184e-08   0              0.0042521911   1.1971759e-13  0              3.4140399    
   1800000   18000          200            200            0.0031627448  -1.6829033e-36  0              0.0094882343   1.512869e-10   0              7.3051028e-06  1.1971759e-13  0              3.4140398    
   1900000   18000          200            200            0.0031627263   1.9633872e-36  0              0.0094881788   1.87857e-09    0              9.0709424e-05  1.1971759e-13  0              3.4140398    
   2000000   18000          200            200            0.0031627273  -2.2999678e-35  0              0.0094881818   1.839247e-10   0              8.8810655e-06  1.1971759e-13  0              3.4140398    
   2100000   18000          200            200            0.0031627293   2.8048389e-37  0              0.009488188    9.0666987e-13  0              4.3779843e-08  1.1971759e-13  0              3.4140398    
   2200000   18000          200            200            0.0031627285  -5.6096774e-37  0              0.0094881855   4.483004e-12   0              2.1646822e-07  1.1971759e-13  0              3.4140398    
   2300000   18000          200            200            0.0031627285  -2.8048387e-37  0              0.0094881855   3.7952812e-13  0              1.8326055e-08  1.1971759e-13  0              3.4140398    
   2400000   18000          200            200            0.0031627286   1.0377903e-35  0              0.0094881858   3.8430939e-15  0              1.8556925e-10  1.1971759e-13  0              3.4140398    
   2500000   18000          200            200            0.0031627286   5.6096777e-37  0              0.0094881857   1.0671981e-14  0              5.1531178e-10  1.1971759e-13  0              3.4140398    
   2600000   18000          200            200            0.0031627286  -2.8048387e-37  0              0.0094881857   8.486572e-16   0              4.0978619e-11  1.1971759e-13  0              3.4140398    
   2700000   18000          200            200            0.0031627286   1.0191986e-44  0              0.0094881857   5.7545075e-17  0              2.7786457e-12  1.1971759e-13  0              3.4140398    
   2800000   18000          200            200            0.0031627286   1.4024194e-36  0              0.0094881857   3.4542357e-18  0              1.6679268e-13  1.1971759e-13  0              3.4140398    
   2900000   18000          200            200            0.0031627286  -5.6096775e-37  0              0.0094881857   8.7161765e-18  0              4.2087297e-13  1.1971759e-13  0              3.4140398    
   3000000   18000          200            200            0.0031627286   7.7278014e-45  0              0.0094881857   1.3135329e-19  0              6.3425804e-15  1.1971759e-13  0              3.4140398    
Loop time of 774.555 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3346438.676 ns/day, 0.000 hours/ns, 3873.193 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.74     | 242.71     | 243.67     |   6.2 | 31.34
Neigh   | 9.6131     | 9.6132     | 9.6134     |   0.0 |  1.24
Comm    | 32.033     | 32.821     | 33.609     |  13.8 |  4.24
Output  | 0.63569    | 0.63571    | 0.63573    |   0.0 |  0.08
Modify  | 428.64     | 428.69     | 428.74     |   0.2 | 55.35
Other   |            | 60.09      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.84                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.2251334349452
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.94
  ghost atom cutoff = 3.94
  binsize = 1.97, bins = 9138 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 212.7 | 212.7 | 212.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00011562954 -3.5901827e-35  0             -0.00034688862  1249068.3      0              6.0313036e+10  1.1971759e-13  0              3.484331     
    200000   18000          200            200           -0.00019785812  3.5901995e-35  0             -0.00059357436  40682.953      0              1.9644342e+09  1.1971759e-13  0              3.5735347    
    300000   18000          200            200            0.00010629097  2.5131363e-34  0              0.00031887291  7698.8175      0              3.7174834e+08  1.1971759e-13  0              3.4617817    
    400000   18000          200            200           -1.601264e-05   1.7951028e-35  0             -4.803792e-05   207.54651      0              10021678       1.1971759e-13  0              3.4297614    
    500000   18000          200            200           -5.4912756e-06  1.7951015e-35  0             -1.6473827e-05  23.774615      0              1147991.1      1.1971759e-13  0              3.4214911    
    600000   18000          200            200            0.00098460812 -2.6926435e-35  0              0.0029538244   247.51042      0              11951392       1.1971759e-13  0              3.4195544    
    700000   18000          200            200            0.0031582032  -1.7950955e-35  0              0.0094746095   82.849128      0              4000487.9      1.1971759e-13  0              3.4190442    
    800000   18000          200            200            0.0028425799   1.6155872e-34  0              0.0085277397   4.0639369      0              196232.97      1.1971759e-13  0              3.4191065    
    900000   18000          200            200            0.0033049122  -1.795096e-35   0              0.0099147365   0.23411352     0              11304.504      1.1971759e-13  0              3.4190125    
   1000000   18000          200            200            0.0031647095   8.9754911e-36  0              0.0094941284   0.18825379     0              9090.1019      1.1971759e-13  0              3.4190408    
   1100000   18000          200            200            0.0031501402   2.2438714e-35  0              0.0094504205   0.0059752773   0              288.52475      1.1971759e-13  0              3.4190437    
   1200000   18000          200            200            0.003173261   -1.5707096e-35  0              0.009519783    0.0010313336   0              49.799407      1.1971759e-13  0              3.419039     
   1300000   18000          200            200            0.0031677225   3.9267743e-36  0              0.0095031676   0.00042181985  0              20.368171      1.1971759e-13  0              3.4190401    
   1400000   18000          200            200            0.0031664681  -4.2072581e-37  0              0.0094994043   5.7853848e-06  0              0.27935553     1.1971759e-13  0              3.4190404    
   1500000   18000          200            200            0.0031676014  -2.8048387e-37  0              0.0095028042   3.706257e-06   0              0.17896189     1.1971759e-13  0              3.4190402    
   1600000   18000          200            200            0.0031674007  -2.8048387e-37  0              0.009502202    8.7933877e-07  0              0.042460122    1.1971759e-13  0              3.4190402    
   1700000   18000          200            200            0.0031673164  -8.4145162e-37  0              0.0095019491   2.4428842e-09  0              0.00011795814  1.1971759e-13  0              3.4190402    
   1800000   18000          200            200            0.00316737    -5.6096774e-37  0              0.00950211     1.1533167e-08  0              0.00055689534  1.1971759e-13  0              3.4190402    
   1900000   18000          200            200            0.0031673638   1.4024194e-36  0              0.0095020913   1.6942739e-09  0              8.1810423e-05  1.1971759e-13  0              3.4190402    
   2000000   18000          200            200            0.0031673587   5.6096777e-37  0              0.0095020762   7.0745204e-13  0              3.4160327e-08  1.1971759e-13  0              3.4190402    
   2100000   18000          200            200            0.0031673612   8.4145164e-37  0              0.0095020835   3.231912e-11   0              1.5605746e-06  1.1971759e-13  0              3.4190402    
   2200000   18000          200            200            0.003167361    1.9633872e-36  0              0.0095020831   2.9701627e-12  0              1.4341853e-07  1.1971759e-13  0              3.4190402    
   2300000   18000          200            200            0.0031673608  -8.4145162e-37  0              0.0095020823   3.7156292e-14  0              1.7941444e-09  1.1971759e-13  0              3.4190402    
   2400000   18000          200            200            0.0031673609   8.4145164e-37  0              0.0095020826   8.316612e-14   0              4.0157943e-09  1.1971759e-13  0              3.4190402    
   2500000   18000          200            200            0.0031673609  -4.487742e-36   0              0.0095020826   4.3793927e-15  0              2.114652e-10   1.1971759e-13  0              3.4190402    
   2600000   18000          200            200            0.0031673609   2.8048389e-37  0              0.0095020826   2.2368136e-16  0              1.0800772e-11  1.1971759e-13  0              3.4190402    
   2700000   18000          200            200            0.0031673609   1.0434899e-44  0              0.0095020826   1.7964689e-16  0              8.6745052e-12  1.1971759e-13  0              3.4190402    
   2800000   18000          200            200            0.0031673609  -8.4145162e-37  0              0.0095020826   1.2548691e-17  0              6.0593137e-13  1.1971759e-13  0              3.4190402    
   2900000   18000          200            200            0.0031673609   2.8048389e-37  0              0.0095020826   1.4409076e-17  0              6.9576274e-13  1.1971759e-13  0              3.4190402    
   3000000   18000          200            200            0.0031673609   1.1219355e-36  0              0.0095020826   4.7247328e-18  0              2.2814044e-13  1.1971759e-13  0              3.4190402    
Loop time of 778.632 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3328915.120 ns/day, 0.000 hours/ns, 3852.911 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.17     | 244.07     | 246.96     |  18.6 | 31.35
Neigh   | 9.7729     | 9.773      | 9.773      |   0.0 |  1.26
Comm    | 31.573     | 34.369     | 37.165     |  47.7 |  4.41
Output  | 0.62768    | 0.62771    | 0.62773    |   0.0 |  0.08
Modify  | 428.94     | 429        | 429.06     |   0.3 | 55.10
Other   |            | 60.8       |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.85                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.7360329505601
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.95
  ghost atom cutoff = 3.95
  binsize = 1.975, bins = 9114 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 212.2 | 212.2 | 212.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00012584685  1.100645e-40   0             -0.00037754054  1233336.6      0              5.9553411e+10  1.1971759e-13  0              3.4944939    
    200000   18000          200            200           -0.00019251219  6.3268401e-41  0             -0.00057753656  37840.385      0              1.8271767e+09  1.1971759e-13  0              3.5797799    
    300000   18000          200            200            0.00011607247  3.5902011e-35  0              0.00034821742  9056.0541      0              4.3728444e+08  1.1971759e-13  0              3.4660698    
    400000   18000          200            200           -6.9171111e-06  1.7951039e-35  0             -2.0751333e-05  37.68651       0              1819746.7      1.1971759e-13  0              3.4348453    
    500000   18000          200            200            4.1552706e-06  1.7951021e-35  0              1.2465812e-05  14.116958      0              681657.38      1.1971759e-13  0              3.4264963    
    600000   18000          200            200            0.00063277006  1.0770583e-34  0              0.0018983102   76.803731      0              3708577.3      1.1971759e-13  0              3.4246691    
    700000   18000          200            200            0.0036245472   5.3852915e-35  0              0.010873642    70.230912      0              3391199.4      1.1971759e-13  0              3.4239532    
    800000   18000          200            200            0.0027733303  -8.9754749e-36  0              0.008319991    0.48535943     0              23436.27       1.1971759e-13  0              3.4241226    
    900000   18000          200            200            0.003263802    1.3463234e-35  0              0.0097914061   0.8918769      0              43065.543      1.1971759e-13  0              3.4240219    
   1000000   18000          200            200            0.0031974302   8.9754848e-35  0              0.0095922905   0.14783179     0              7138.2682      1.1971759e-13  0              3.4240355    
   1100000   18000          200            200            0.003152327    1.7950972e-35  0              0.0094569809   0.00010213312  0              4.9316428      1.1971759e-13  0              3.4240446    
   1200000   18000          200            200            0.0031744434   4.4877429e-36  0              0.0095233302   0.0028650777   0              138.34435      1.1971759e-13  0              3.4240401    
   1300000   18000          200            200            0.003173859   -1.1219355e-36  0              0.0095215769   0.00020881685  0              10.083018      1.1971759e-13  0              3.4240402    
   1400000   18000          200            200            0.0031711207  -1.4024194e-37  0              0.009513362    7.7292611e-06  0              0.37321836     1.1971759e-13  0              3.4240408    
   1500000   18000          200            200            0.0031720049   8.4145164e-37  0              0.0095160148   7.3995633e-06  0              0.35729843     1.1971759e-13  0              3.4240406    
   1600000   18000          200            200            0.0031721044   1.1219355e-36  0              0.0095163133   1.9028321e-07  0              0.009188095    1.1971759e-13  0              3.4240406    
   1700000   18000          200            200            0.0031719588   1.1219355e-36  0              0.0095158764   5.2535762e-08  0              0.0025367639   1.1971759e-13  0              3.4240406    
   1800000   18000          200            200            0.0031719886  -2.8048387e-37  0              0.0095159659   1.5611575e-08  0              0.00075382711  1.1971759e-13  0              3.4240406    
   1900000   18000          200            200            0.003171999    2.8048389e-37  0              0.009515997    4.4683384e-11  0              2.1576007e-06  1.1971759e-13  0              3.4240406    
   2000000   18000          200            200            0.003171992    1.4024194e-36  0              0.009515976    2.0915878e-10  0              1.0099529e-05  1.1971759e-13  0              3.4240406    
   2100000   18000          200            200            0.0031719927   1.6829033e-36  0              0.0095159781   2.645275e-11   0              1.2773086e-06  1.1971759e-13  0              3.4240406    
   2200000   18000          200            200            0.0031719934  -1.1219355e-36  0              0.0095159803   1.4873381e-13  0              7.1818235e-09  1.1971759e-13  0              3.4240406    
   2300000   18000          200            200            0.0031719931  -2.243871e-36   0              0.0095159794   6.2448087e-13  0              3.0153946e-08  1.1971759e-13  0              3.4240406    
   2400000   18000          200            200            0.0031719931   1.4024194e-36  0              0.0095159793   3.2894006e-14  0              1.5883338e-09  1.1971759e-13  0              3.4240406    
   2500000   18000          200            200            0.0031719932  -8.4145162e-37  0              0.0095159795   2.5845435e-15  0              1.2479836e-10  1.1971759e-13  0              3.4240406    
   2600000   18000          200            200            0.0031719931   1.0316077e-44  0              0.0095159794   1.4929925e-15  0              7.2091267e-11  1.1971759e-13  0              3.4240406    
   2700000   18000          200            200            0.0031719931   3.0853227e-36  0              0.0095159794   1.1424216e-19  0              5.5163448e-15  1.1971759e-13  0              3.4240406    
   2800000   18000          200            200            0.0031719931   2.8048389e-37  0              0.0095159794   1.0465486e-17  0              5.0534084e-13  1.1971759e-13  0              3.4240406    
   2900000   18000          200            200            0.0031719931  -1.1219355e-36  0              0.0095159794   3.8247746e-20  0              1.8468468e-15  1.1971759e-13  0              3.4240406    
   3000000   18000          200            200            0.0031719931  -8.4145162e-37  0              0.0095159794   7.7664288e-18  0              3.7501305e-13  1.1971759e-13  0              3.4240406    
Loop time of 773.91 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3349224.660 ns/day, 0.000 hours/ns, 3876.417 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.37     | 244.08     | 245.8      |  11.0 | 31.54
Neigh   | 9.5561     | 9.5563     | 9.5565     |   0.0 |  1.23
Comm    | 31.201     | 32.704     | 34.206     |  26.3 |  4.23
Output  | 0.62322    | 0.62324    | 0.62325    |   0.0 |  0.08
Modify  | 428.5      | 428.58     | 428.66     |   0.4 | 55.38
Other   |            | 58.37      |            |       |  7.54

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.86                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.2495933951522
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.96
  ghost atom cutoff = 3.96
  binsize = 1.98, bins = 9091 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 211.7 | 211.7 | 211.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00013591067  7.1803953e-35  0             -0.00040773202  1217713.4      0              5.879902e+10   1.1971759e-13  0              3.504627     
    200000   18000          200            200           -0.00018704345 -7.1803792e-35  0             -0.00056113034  35102.846      0              1.6949908e+09  1.1971759e-13  0              3.5859788    
    300000   18000          200            200            0.00012596554  5.3852981e-35  0              0.00037789662  10521.983      0              5.0806891e+08  1.1971759e-13  0              3.4702996    
    400000   18000          200            200            2.3223655e-06 -3.5901874e-35  0              6.9670965e-06  4.4931153      0              216956.46      1.1971759e-13  0              3.4398612    
    500000   18000          200            200            1.395518e-05  -3.5901887e-35  0              4.1865539e-05  153.2501       0              7399898.9      1.1971759e-13  0              3.4314269    
    600000   18000          200            200            0.0005119728  -4.4877404e-35  0              0.0015359184   1.2103479      0              58443.369      1.1971759e-13  0              3.4297155    
    700000   18000          200            200            0.0040314822   1.0870874e-41  0              0.012094447    38.820843      0              1874519.6      1.1971759e-13  0              3.4288771    
    800000   18000          200            200            0.0027802818   9.3326518e-42  0              0.0083408455   0.56601093     0              27330.642      1.1971759e-13  0              3.4291227    
    900000   18000          200            200            0.0032009766  -4.4877341e-36  0              0.0096029297   1.3870578      0              66976.056      1.1971759e-13  0              3.4290358    
   1000000   18000          200            200            0.0032231007  -1.3463219e-35  0              0.0096693021   0.051886166    0              2505.3973      1.1971759e-13  0              3.4290317    
   1100000   18000          200            200            0.003160876   -5.026271e-34   0              0.0094826279   0.008829363    0              426.33834      1.1971759e-13  0              3.4290441    
   1200000   18000          200            200            0.0031747163  -4.4877412e-36  0              0.0095241489   0.003023049    0              145.97222      1.1971759e-13  0              3.4290413    
   1300000   18000          200            200            0.0031792061  -1.1219355e-36  0              0.0095376182   5.2201163e-06  0              0.25206073     1.1971759e-13  0              3.4290404    
   1400000   18000          200            200            0.0031761888   4.3475001e-36  0              0.0095285665   4.3873525e-05  0              2.1184955      1.1971759e-13  0              3.429041     
   1500000   18000          200            200            0.0031764023  -2.8048387e-37  0              0.009529207    4.2650257e-06  0              0.20594283     1.1971759e-13  0              3.429041     
   1600000   18000          200            200            0.0031767423   5.6096776e-37  0              0.0095302269   1.0306336e-07  0              0.004976561    1.1971759e-13  0              3.4290409    
   1700000   18000          200            200            0.0031766236  -2.8048387e-37  0              0.0095298709   1.2757213e-07  0              0.0061600016   1.1971759e-13  0              3.4290409    
   1800000   18000          200            200            0.0031766105   1.6829033e-36  0              0.0095298316   2.8015775e-09  0              0.00013527815  1.1971759e-13  0              3.4290409    
   1900000   18000          200            200            0.0031766296   5.6096777e-37  0              0.0095298889   1.0810189e-09  0              5.2198532e-05  1.1971759e-13  0              3.4290409    
   2000000   18000          200            200            0.0031766263  -8.4145162e-37  0              0.0095298788   2.4720052e-10  0              1.1936428e-05  1.1971759e-13  0              3.4290409    
   2100000   18000          200            200            0.0031766247   1.0089676e-44  0              0.009529874    1.836749e-14   0              8.8690035e-10  1.1971759e-13  0              3.4290409    
   2200000   18000          200            200            0.0031766255   1.1219355e-36  0              0.0095298766   4.430391e-12   0              2.1392772e-07  1.1971759e-13  0              3.4290409    
   2300000   18000          200            200            0.0031766255   2.8048389e-37  0              0.0095298765   2.9405628e-13  0              1.4198926e-08  1.1971759e-13  0              3.4290409    
   2400000   18000          200            200            0.0031766254   8.4145164e-37  0              0.0095298762   1.7334207e-14  0              8.3700683e-10  1.1971759e-13  0              3.4290409    
   2500000   18000          200            200            0.0031766254  -5.6096774e-37  0              0.0095298763   1.138406e-14   0              5.4969553e-10  1.1971759e-13  0              3.4290409    
   2600000   18000          200            200            0.0031766254  -5.6096774e-37  0              0.0095298763   1.4754675e-16  0              7.1245043e-12  1.1971759e-13  0              3.4290409    
   2700000   18000          200            200            0.0031766254   5.6096777e-37  0              0.0095298763   1.7630269e-16  0              8.5130259e-12  1.1971759e-13  0              3.4290409    
   2800000   18000          200            200            0.0031766254  -1.1219355e-36  0              0.0095298763   2.8240477e-18  0              1.3636315e-13  1.1971759e-13  0              3.4290409    
   2900000   18000          200            200            0.0031766254   2.8048389e-37  0              0.0095298763   5.8650878e-18  0              2.832041e-13   1.1971759e-13  0              3.4290409    
   3000000   18000          200            200            0.0031766254   8.4145164e-37  0              0.0095298763   1.0034783e-19  0              4.8454376e-15  1.1971759e-13  0              3.4290409    
Loop time of 775.743 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3341310.825 ns/day, 0.000 hours/ns, 3867.258 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.9      | 243.63     | 245.36     |  11.1 | 31.41
Neigh   | 9.7167     | 9.7169     | 9.7171     |   0.0 |  1.25
Comm    | 31.492     | 33.049     | 34.607     |  27.1 |  4.26
Output  | 0.6265     | 0.62651    | 0.62652    |   0.0 |  0.08
Modify  | 429.49     | 429.53     | 429.56     |   0.2 | 55.37
Other   |            | 59.2       |            |       |  7.63

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.87                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.765821680226
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.97
  ghost atom cutoff = 3.97
  binsize = 1.985, bins = 9069 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 207.6 | 207.6 | 207.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00014582031  1.1069824e-40  0             -0.00043746094  1202200.6      0              5.8049963e+10  1.1971759e-13  0              3.5147298    
    200000   18000          200            200           -0.00018145461  1.0770586e-34  0             -0.00054436383  32471.022      0              1.5679095e+09  1.1971759e-13  0              3.5921309    
    300000   18000          200            200            0.0001359647   5.9314139e-41  0              0.0004078941   12095.514      0              5.8404908e+08  1.1971759e-13  0              3.4744715    
    400000   18000          200            200            1.169967e-05  -5.3852848e-35  0              3.5099009e-05  107.43214      0              5187513.7      1.1971759e-13  0              3.444809     
    500000   18000          200            200            2.3901815e-05  1.7951014e-35  0              7.1705446e-05  440.40851      0              21265751       1.1971759e-13  0              3.4362829    
    600000   18000          200            200            0.00059248269  4.4877437e-35  0              0.0017774481   43.982497      0              2123757.4      1.1971759e-13  0              3.43469      
    700000   18000          200            200            0.0042968068   1.7950979e-35  0              0.01289042     8.9097424      0              430219.57      1.1971759e-13  0              3.4338292    
    800000   18000          200            200            0.0028631652   8.9754937e-36  0              0.0085894955   4.2186212      0              203702.12      1.1971759e-13  0              3.4341068    
    900000   18000          200            200            0.0031328318   1.3463234e-35  0              0.0093984953   1.2776233      0              61691.855      1.1971759e-13  0              3.4340508    
   1000000   18000          200            200            0.0032357628  -8.9754774e-36  0              0.0097072884   6.1426919e-05  0              2.9660861      1.1971759e-13  0              3.4340304    
   1100000   18000          200            200            0.0031745203   8.9754876e-36  0              0.0095235608   0.021667129    0              1046.2281      1.1971759e-13  0              3.4340427    
   1200000   18000          200            200            0.0031757017  -4.4877412e-36  0              0.0095271051   0.0012993801   0              62.742415      1.1971759e-13  0              3.4340424    
   1300000   18000          200            200            0.0031834634   1.1219356e-36  0              0.0095503903   0.00011656699  0              5.6286028      1.1971759e-13  0              3.4340409    
   1400000   18000          200            200            0.0031814643   2.8048388e-37  0              0.0095443928   5.3410477e-05  0              2.5790008      1.1971759e-13  0              3.4340413    
   1500000   18000          200            200            0.0031809185   2.8048389e-37  0              0.0095427555   1.0049157e-07  0              0.0048523784   1.1971759e-13  0              3.4340414    
   1600000   18000          200            200            0.0031813112  -1.6829033e-36  0              0.0095439335   7.8484376e-07  0              0.037897296    1.1971759e-13  0              3.4340413    
   1700000   18000          200            200            0.0031812896   8.4145164e-37  0              0.0095438689   6.3632502e-08  0              0.0030725858   1.1971759e-13  0              3.4340413    
   1800000   18000          200            200            0.0031812431  -2.243871e-36   0              0.0095437293   3.2001175e-09  0              0.00015452222  1.1971759e-13  0              3.4340413    
   1900000   18000          200            200            0.003181257    1.4024194e-36  0              0.0095437709   2.1741089e-09  0              0.00010497994  1.1971759e-13  0              3.4340413    
   2000000   18000          200            200            0.0031812598  -8.4145162e-37  0              0.0095437794   1.3265588e-11  0              6.4054779e-07  1.1971759e-13  0              3.4340413    
   2100000   18000          200            200            0.0031812573   2.243871e-36   0              0.0095437719   2.7738607e-11  0              1.3393981e-06  1.1971759e-13  0              3.4340413    
   2200000   18000          200            200            0.0031812575   1.4024194e-36  0              0.0095437726   2.9890864e-12  0              1.4433228e-07  1.1971759e-13  0              3.4340413    
   2300000   18000          200            200            0.0031812578   8.4145164e-37  0              0.0095437734   7.9635581e-14  0              3.8453172e-09  1.1971759e-13  0              3.4340413    
   2400000   18000          200            200            0.0031812577  -5.6096774e-37  0              0.0095437731   8.6942606e-14  0              4.1981473e-09  1.1971759e-13  0              3.4340413    
   2500000   18000          200            200            0.0031812577   1.0258072e-44  0              0.0095437731   9.6591241e-16  0              4.6640454e-11  1.1971759e-13  0              3.4340413    
   2600000   18000          200            200            0.0031812577  -5.6096774e-37  0              0.0095437731   9.3362107e-16  0              4.508122e-11   1.1971759e-13  0              3.4340413    
   2700000   18000          200            200            0.0031812577  -1.9633871e-36  0              0.0095437731   5.9550377e-17  0              2.8754746e-12  1.1971759e-13  0              3.4340413    
   2800000   18000          200            200            0.0031812577  -5.6096774e-37  0              0.0095437731   2.6503358e-17  0              1.2797523e-12  1.1971759e-13  0              3.4340413    
   2900000   18000          200            200            0.0031812577  -5.6096774e-37  0              0.0095437731   1.3633641e-19  0              6.5831974e-15  1.1971759e-13  0              3.4340413    
   3000000   18000          200            200            0.0031812577  -8.4145162e-37  0              0.0095437731   2.9357504e-19  0              1.4175688e-14  1.1971759e-13  0              3.4340413    
Loop time of 777.333 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3334479.682 ns/day, 0.000 hours/ns, 3859.351 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.38     | 242.7      | 244.03     |   8.5 | 31.22
Neigh   | 9.6489     | 9.6501     | 9.6513     |   0.0 |  1.24
Comm    | 30.86      | 32.36      | 33.86      |  26.4 |  4.16
Output  | 0.62243    | 0.62244    | 0.62245    |   0.0 |  0.08
Modify  | 432.2      | 432.22     | 432.24     |   0.1 | 55.60
Other   |            | 59.77      |            |       |  7.69

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.88                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.284724717285
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.98
  ghost atom cutoff = 3.98
  binsize = 1.99, bins = 9046 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 207.1 | 207.1 | 207.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00015557764  1.0770594e-34  0             -0.00046673293  1186795        0              5.7306084e+10  1.1971759e-13  0              3.5248027    
    200000   18000          200            200           -0.00017574376  9.5273148e-41  0             -0.00052723129  29943.498      0              1.4458644e+09  1.1971759e-13  0              3.5982367    
    300000   18000          200            200            0.00014607472 -5.3852851e-35  0              0.00043822415  13777.165      0              6.6525001e+08  1.1971759e-13  0              3.4785849    
    400000   18000          200            200            2.1219478e-05  3.5902002e-35  0              6.3658434e-05  346.03082      0              16708590       1.1971759e-13  0              3.4496884    
    500000   18000          200            200            3.39996e-05   -3.5901887e-35  0              0.0001019988   875.07753      0              42254362       1.1971759e-13  0              3.441064     
    600000   18000          200            200            0.00089288387  2.6926472e-35  0              0.0026786516   191.35169      0              9239688.2      1.1971759e-13  0              3.4395945    
    700000   18000          200            200            0.00436279    -2.2438709e-34  0              0.01308837     0.63086196     0              30462.066      1.1971759e-13  0              3.438818     
    800000   18000          200            200            0.0030088648  -2.6926442e-35  0              0.0090265944   8.7428506      0              422160.97      1.1971759e-13  0              3.4390782    
    900000   18000          200            200            0.0030765651   1.7950976e-35  0              0.0092296952   0.66585296     0              32151.656      1.1971759e-13  0              3.4390635    
   1000000   18000          200            200            0.0032331359  -1.7950962e-35  0              0.0096994077   0.045648903    0              2204.2222      1.1971759e-13  0              3.4390322    
   1100000   18000          200            200            0.0031903542   1.705342e-34   0              0.0095710626   0.02332865     0              1126.457       1.1971759e-13  0              3.4390408    
   1200000   18000          200            200            0.0031787488   1.1219356e-35  0              0.0095362463   1.467616e-05   0              0.70865925     1.1971759e-13  0              3.4390431    
   1300000   18000          200            200            0.0031867914  -5.6096771e-37  0              0.0095603742   0.00037201923  0              17.963477      1.1971759e-13  0              3.4390415    
   1400000   18000          200            200            0.0031866414   2.2462551e-45  0              0.0095599242   2.0502497e-05  0              0.98999219     1.1971759e-13  0              3.4390415    
   1500000   18000          200            200            0.0031856146   5.6096776e-37  0              0.0095568439   2.5351447e-06  0              0.12241307     1.1971759e-13  0              3.4390417    
   1600000   18000          200            200            0.0031858486  -1.4024194e-36  0              0.0095575458   8.60666e-07    0              0.041558481    1.1971759e-13  0              3.4390417    
   1700000   18000          200            200            0.0031859348   1.6829033e-36  0              0.0095578045   2.5224788e-10  0              1.2180148e-05  1.1971759e-13  0              3.4390417    
   1800000   18000          200            200            0.0031858861  -5.6096774e-37  0              0.0095576582   1.5708968e-08  0              0.00075852982  1.1971759e-13  0              3.4390417    
   1900000   18000          200            200            0.0031858849  -8.4145162e-37  0              0.0095576547   5.787772e-10   0              2.794708e-05   1.1971759e-13  0              3.4390417    
   2000000   18000          200            200            0.0031858916  -1.1219355e-36  0              0.0095576747   1.3147798e-10  0              6.3486012e-06  1.1971759e-13  0              3.4390417    
   2100000   18000          200            200            0.0031858903   2.4963065e-35  0              0.009557671    3.0865291e-11  0              1.4903744e-06  1.1971759e-13  0              3.4390417    
   2200000   18000          200            200            0.0031858897  -5.6096774e-37  0              0.0095576691   1.21253e-13    0              5.8548735e-09  1.1971759e-13  0              3.4390417    
   2300000   18000          200            200            0.00318589     1.4024194e-36  0              0.00955767     6.4587462e-13  0              3.1186974e-08  1.1971759e-13  0              3.4390417    
   2400000   18000          200            200            0.00318589     1.0387016e-44  0              0.0095576701   1.4863153e-14  0              7.1768848e-10  1.1971759e-13  0              3.4390417    
   2500000   18000          200            200            0.00318589    -5.6096774e-37  0              0.0095576699   6.6054179e-15  0              3.1895199e-10  1.1971759e-13  0              3.4390417    
   2600000   18000          200            200            0.00318589     2.8048389e-37  0              0.0095576699   1.0949426e-15  0              5.287086e-11   1.1971759e-13  0              3.4390417    
   2700000   18000          200            200            0.00318589     1.0261813e-44  0              0.00955767     6.6713422e-17  0              3.2213524e-12  1.1971759e-13  0              3.4390417    
   2800000   18000          200            200            0.00318589    -2.8048387e-37  0              0.00955767     5.3222083e-20  0              2.5699039e-15  1.1971759e-13  0              3.4390417    
   2900000   18000          200            200            0.00318589     2.8048389e-37  0              0.00955767     1.1042049e-17  0              5.3318101e-13  1.1971759e-13  0              3.4390417    
   3000000   18000          200            200            0.00318589     1.1219355e-36  0              0.00955767     2.0155294e-18  0              9.7322703e-14  1.1971759e-13  0              3.4390417    
Loop time of 781.11 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3318353.693 ns/day, 0.000 hours/ns, 3840.687 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 244.86     | 246.52     | 248.17     |  10.5 | 31.56
Neigh   | 9.7145     | 9.7147     | 9.7149     |   0.0 |  1.24
Comm    | 31.653     | 33.167     | 34.681     |  26.3 |  4.25
Output  | 0.62276    | 0.62276    | 0.62277    |   0.0 |  0.08
Modify  | 429.4      | 429.45     | 429.5      |   0.2 | 54.98
Other   |            | 61.64      |            |       |  7.89

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.89                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.8063094178331
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.99
  ghost atom cutoff = 3.99
  binsize = 1.995, bins = 9023 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 206.6 | 206.6 | 206.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00016518219  1.0770595e-34  0             -0.00049554656  1171498.4      0              5.6567465e+10  1.1971759e-13  0              3.5348455    
    200000   18000          200            200           -0.00016991331  7.1803963e-35  0             -0.00050973992  27520.765      0              1.3288792e+09  1.1971759e-13  0              3.6042957    
    300000   18000          200            200            0.00015629072  6.1615307e-41  0              0.00046887216  15565.897      0              7.5162143e+08  1.1971759e-13  0              3.4826399    
    400000   18000          200            200            3.0876243e-05  7.1803938e-35  0              9.262873e-05   719.67083      0              34750329       1.1971759e-13  0              3.4544995    
    500000   18000          200            200            4.4242773e-05  3.5901982e-35  0              0.00013272832  1456.4141      0              70325025       1.1971759e-13  0              3.4457704    
    600000   18000          200            200            0.0014607358  -8.9754632e-36  0              0.0043822074   391.6051       0              18909209       1.1971759e-13  0              3.4444369    
    700000   18000          200            200            0.004214655    8.9754938e-36  0              0.012643965    19.5453        0              943772.59      1.1971759e-13  0              3.4438457    
    800000   18000          200            200            0.0031921303   1.7950979e-35  0              0.0095763909   10.749006      0              519031.03      1.1971759e-13  0              3.4440424    
    900000   18000          200            200            0.0030462447  -4.4877338e-36  0              0.009138734    0.096672561    0              4667.972       1.1971759e-13  0              3.4440711    
   1000000   18000          200            200            0.0032172851   1.3463233e-35  0              0.0096518554   0.14036414     0              6777.6821      1.1971759e-13  0              3.4440366    
   1100000   18000          200            200            0.0032047534   1.346323e-35   0              0.0096142602   0.011867119    0              573.02069      1.1971759e-13  0              3.4440392    
   1200000   18000          200            200            0.0031844409  -1.1219354e-35  0              0.0095533228   0.00088112509  0              42.546377      1.1971759e-13  0              3.4440432    
   1300000   18000          200            200            0.0031897411  -2.8048387e-36  0              0.0095692232   0.00038593993  0              18.635658      1.1971759e-13  0              3.4440422    
   1400000   18000          200            200            0.0031914623  -4.2072581e-37  0              0.0095743869   1.4613065e-07  0              0.0070561262   1.1971759e-13  0              3.4440418    
   1500000   18000          200            200            0.0031904564   5.6096776e-37  0              0.0095713693   7.0359182e-06  0              0.33973931     1.1971759e-13  0              3.444042     
   1600000   18000          200            200            0.0031904104   2.8048389e-37  0              0.0095712313   1.8092494e-07  0              0.0087362181   1.1971759e-13  0              3.444042     
   1700000   18000          200            200            0.003190551   -1.4024194e-36  0              0.0095716529   7.4318635e-08  0              0.0035885809   1.1971759e-13  0              3.444042     
   1800000   18000          200            200            0.0031905318   2.8048389e-37  0              0.0095715955   1.0989353e-08  0              0.00053063651  1.1971759e-13  0              3.444042     
   1900000   18000          200            200            0.0031905168  -8.4145162e-37  0              0.0095715503   2.9104054e-10  0              1.4053306e-05  1.1971759e-13  0              3.444042     
   2000000   18000          200            200            0.003190522    5.6096777e-37  0              0.009571566    2.8387566e-10  0              1.370734e-05   1.1971759e-13  0              3.444042     
   2100000   18000          200            200            0.003190523    1.023685e-44   0              0.0095715691   6.054412e-13   0              2.9234589e-08  1.1971759e-13  0              3.444042     
   2200000   18000          200            200            0.0031905222  -1.6829033e-36  0              0.0095715665   4.3107423e-12  0              2.0815032e-07  1.1971759e-13  0              3.444042     
   2300000   18000          200            200            0.0031905222  -1.4024194e-36  0              0.0095715665   2.2495537e-13  0              1.086229e-08   1.1971759e-13  0              3.444042     
   2400000   18000          200            200            0.0031905223  -2.8048387e-37  0              0.0095715669   3.5567813e-14  0              1.7174424e-09  1.1971759e-13  0              3.444042     
   2500000   18000          200            200            0.0031905223  -5.6096774e-37  0              0.0095715668   9.0331382e-15  0              4.3617792e-10  1.1971759e-13  0              3.444042     
   2600000   18000          200            200            0.0031905223   1.4024194e-36  0              0.0095715668   6.0187425e-17  0              2.9062354e-12  1.1971759e-13  0              3.444042     
   2700000   18000          200            200            0.0031905223   8.4145164e-37  0              0.0095715668   1.6005444e-16  0              7.7284562e-12  1.1971759e-13  0              3.444042     
   2800000   18000          200            200            0.0031905223  -2.8048387e-37  0              0.0095715668   2.2407944e-17  0              1.0819994e-12  1.1971759e-13  0              3.444042     
   2900000   18000          200            200            0.0031905223  -1.4024194e-36  0              0.0095715668   1.7058603e-19  0              8.2369891e-15  1.1971759e-13  0              3.444042     
   3000000   18000          200            200            0.0031905223  -1.1219355e-36  0              0.0095715668   1.4886591e-18  0              7.1882022e-14  1.1971759e-13  0              3.444042     
Loop time of 776.972 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3336027.454 ns/day, 0.000 hours/ns, 3861.143 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.26     | 244.1      | 245.94     |  11.8 | 31.42
Neigh   | 9.8697     | 9.8699     | 9.8701     |   0.0 |  1.27
Comm    | 32.225     | 33.913     | 35.601     |  29.0 |  4.36
Output  | 0.62099    | 0.62099    | 0.621      |   0.0 |  0.08
Modify  | 429.06     | 429.19     | 429.32     |   0.6 | 55.24
Other   |            | 59.28      |            |       |  7.63

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.9                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.3305826933741
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4
  ghost atom cutoff = 4
  binsize = 2, bins = 9000 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 213.5 | 213.5 | 213.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00017463468 -1.0770572e-34  0             -0.00052390404  1156309.7      0              5.5834056e+10  1.1971759e-13  0              3.5448582    
    200000   18000          200            200           -0.00016396265  1.7951045e-35  0             -0.00049188796  25202.064      0              1.2169175e+09  1.1971759e-13  0              3.6103079    
    300000   18000          200            200            0.00016661475  3.5902001e-35  0              0.00049984425  17461.845      0              8.4317002e+08  1.1971759e-13  0              3.4866362    
    400000   18000          200            200            4.0672778e-05  6.6794218e-41  0              0.00012201833  1227.9846      0              59294980       1.1971759e-13  0              3.4592419    
    500000   18000          200            200            5.4634678e-05  4.8959443e-41  0              0.00016390403  2184.0358      0              1.0545927e+08  1.1971759e-13  0              3.4504015    
    600000   18000          200            200            0.0023201111   8.9755046e-36  0              0.0069603334   560.40006      0              27059713       1.1971759e-13  0              3.4492325    
    700000   18000          200            200            0.0038859999   3.5901947e-35  0              0.011658       52.481933      0              2534164.7      1.1971759e-13  0              3.4489073    
    800000   18000          200            200            0.0033785956   1.7950978e-35  0              0.010135787    8.6743722      0              418854.39      1.1971759e-13  0              3.4490067    
    900000   18000          200            200            0.0030497857   8.9754923e-36  0              0.0091493572   0.070571447    0              3407.6426      1.1971759e-13  0              3.4490717    
   1000000   18000          200            200            0.0031939991   2.6926459e-35  0              0.0095819972   0.18536189     0              8950.4625      1.1971759e-13  0              3.4490425    
   1100000   18000          200            200            0.0032145544   8.9754875e-36  0              0.0096436631   0.00090509158  0              43.703633      1.1971759e-13  0              3.4490385    
   1200000   18000          200            200            0.0031923834  -6.7316121e-36  0              0.0095771501   0.0027164484   0              131.16757      1.1971759e-13  0              3.4490429    
   1300000   18000          200            200            0.0031930196  -5.609677e-37   0              0.0095790589   0.00013836957  0              6.6813711      1.1971759e-13  0              3.4490428    
   1400000   18000          200            200            0.0031958387  -2.8048388e-37  0              0.0095875161   2.5945108e-05  0              1.2527964      1.1971759e-13  0              3.4490422    
   1500000   18000          200            200            0.0031953329   9.096345e-45   0              0.0095859986   5.3375062e-06  0              0.25772907     1.1971759e-13  0              3.4490423    
   1600000   18000          200            200            0.0031950378  -5.6096774e-37  0              0.0095851135   1.0487902e-07  0              0.0050642325   1.1971759e-13  0              3.4490424    
   1700000   18000          200            200            0.0031951486  -3.6462904e-36  0              0.0095854457   1.2417028e-07  0              0.0059957386   1.1971759e-13  0              3.4490424    
   1800000   18000          200            200            0.0031951708   2.8048389e-37  0              0.0095855123   1.0384996e-10  0              5.014543e-06   1.1971759e-13  0              3.4490424    
   1900000   18000          200            200            0.0031951529   1.9633872e-36  0              0.0095854587   2.0089002e-09  0              9.70026e-05    1.1971759e-13  0              3.4490424    
   2000000   18000          200            200            0.0031951526   5.6096777e-37  0              0.0095854579   6.4869245e-11  0              3.1323037e-06  1.1971759e-13  0              3.4490424    
   2100000   18000          200            200            0.003195155    5.6096777e-37  0              0.0095854651   2.1986478e-11  0              1.0616483e-06  1.1971759e-13  0              3.4490424    
   2200000   18000          200            200            0.0031951547  -1.4024194e-36  0              0.0095854641   3.1044515e-12  0              1.4990285e-07  1.1971759e-13  0              3.4490424    
   2300000   18000          200            200            0.0031951544  -1.009742e-35   0              0.0095854633   1.2437739e-13  0              6.0057389e-09  1.1971759e-13  0              3.4490424    
   2400000   18000          200            200            0.0031951545  -5.6096774e-37  0              0.0095854636   8.099621e-14   0              3.9110171e-09  1.1971759e-13  0              3.4490424    
   2500000   18000          200            200            0.0031951545   2.8048389e-37  0              0.0095854636   8.1781428e-18  0              3.9489325e-13  1.1971759e-13  0              3.4490424    
   2600000   18000          200            200            0.0031951545   1.1219355e-36  0              0.0095854636   1.4152498e-15  0              6.8337347e-11  1.1971759e-13  0              3.4490424    
   2700000   18000          200            200            0.0031951545   1.4024194e-36  0              0.0095854636   1.0223914e-18  0              4.9367622e-14  1.1971759e-13  0              3.4490424    
   2800000   18000          200            200            0.0031951545  -1.2902258e-35  0              0.0095854636   3.3578726e-18  0              1.6213965e-13  1.1971759e-13  0              3.4490424    
   2900000   18000          200            200            0.0031951545   9.9871182e-45  0              0.0095854636   2.2920123e-18  0              1.1067307e-13  1.1971759e-13  0              3.4490424    
   3000000   18000          200            200            0.0031951545   3.6462904e-36  0              0.0095854636   1.6200945e-18  0              7.8228566e-14  1.1971759e-13  0              3.4490424    
Loop time of 776.87 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3336465.745 ns/day, 0.000 hours/ns, 3861.650 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.17     | 240.84     | 243.52     |  17.2 | 31.00
Neigh   | 10.47      | 10.47      | 10.471     |   0.0 |  1.35
Comm    | 31.956     | 34.411     | 36.866     |  41.8 |  4.43
Output  | 0.61986    | 0.61987    | 0.61989    |   0.0 |  0.08
Modify  | 428.44     | 428.45     | 428.45     |   0.0 | 55.15
Other   |            | 62.08      |            |       |  7.99

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.91                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.8575514554118
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.01
  ghost atom cutoff = 4.01
  binsize = 2.005, bins = 8978 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 202 | 202 | 202 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00018393536  1.6155883e-34  0             -0.00055180609  1141229.1      0              5.5105871e+10  1.1971759e-13  0              3.5548407    
    200000   18000          200            200           -0.00015789314  1.7951058e-35  0             -0.00047367941  22987.402      0              1.1099794e+09  1.1971759e-13  0              3.6162733    
    300000   18000          200            200            0.00017704435  5.385297e-35   0              0.00053113304  19464.349      0              9.3986376e+08  1.1971759e-13  0              3.4905738    
    400000   18000          200            200            5.0605211e-05  2.1541167e-34  0              0.00015181563  1870.3308      0              90311583       1.1971759e-13  0              3.4639157    
    500000   18000          200            200            9.5185468e-05  7.1803917e-35  0              0.00028555641  3056.7213      0              1.4759813e+08  1.1971759e-13  0              3.4549576    
    600000   18000          200            200            0.0034224486   2.0630179e-41  0              0.010267346    609.04085      0              29408403       1.1971759e-13  0              3.4540044    
    700000   18000          200            200            0.0034479347  -1.7950959e-35  0              0.010343804    77.207359      0              3728067.1      1.1971759e-13  0              3.4539919    
    800000   18000          200            200            0.0035304957  -8.9754747e-36  0              0.010591487    4.0559941      0              195849.44      1.1971759e-13  0              3.4539783    
    900000   18000          200            200            0.0030874656   8.2509949e-42  0              0.0092623967   0.60579967     0              29251.898      1.1971759e-13  0              3.4540654    
   1000000   18000          200            200            0.0031711105  -3.1862968e-34  0              0.0095133316   0.13420095     0              6480.0834      1.1971759e-13  0              3.4540484    
   1100000   18000          200            200            0.0032180793   3.3734951e-42  0              0.009654238    0.0033889554   0              163.64053      1.1971759e-13  0              3.4540391    
   1200000   18000          200            200            0.0032013505   1.3463227e-35  0              0.0096040516   0.0030513844   0              147.34043      1.1971759e-13  0              3.4540424    
   1300000   18000          200            200            0.0031971943   5.6096781e-37  0              0.0095915828   1.0287151e-06  0              0.04967297     1.1971759e-13  0              3.4540432    
   1400000   18000          200            200            0.0031998924   2.3308903e-45  0              0.0095996772   5.4566343e-05  0              2.6348134      1.1971759e-13  0              3.4540427    
   1500000   18000          200            200            0.0032001151   1.4024194e-36  0              0.0096003454   5.6863315e-07  0              0.02745726     1.1971759e-13  0              3.4540427    
   1600000   18000          200            200            0.0031997335  -5.6096774e-37  0              0.0095992004   7.7610069e-07  0              0.037475125    1.1971759e-13  0              3.4540427    
   1700000   18000          200            200            0.00319975     8.4145164e-37  0              0.0095992501   4.2033324e-08  0              0.0020296388   1.1971759e-13  0              3.4540427    
   1800000   18000          200            200            0.0031997982   5.6096777e-37  0              0.0095993947   8.3242409e-09  0              0.0004019478   1.1971759e-13  0              3.4540427    
   1900000   18000          200            200            0.0031997903  -1.1219355e-36  0              0.0095993708   1.4385273e-09  0              6.9461336e-05  1.1971759e-13  0              3.4540427    
   2000000   18000          200            200            0.0031997849  -5.6096774e-37  0              0.0095993547   5.5426079e-11  0              2.676327e-06   1.1971759e-13  0              3.4540427    
   2100000   18000          200            200            0.0031997866   3.6462904e-36  0              0.0095993597   3.4609089e-11  0              1.6711491e-06  1.1971759e-13  0              3.4540427    
   2200000   18000          200            200            0.0031997871  -8.4145162e-37  0              0.0095993613   7.3930401e-14  0              3.5698345e-09  1.1971759e-13  0              3.4540427    
   2300000   18000          200            200            0.0031997868  -2.8048387e-37  0              0.0095993604   6.5011386e-13  0              3.1391672e-08  1.1971759e-13  0              3.4540427    
   2400000   18000          200            200            0.0031997868  -1.4024194e-36  0              0.0095993603   3.8162619e-15  0              1.8427363e-10  1.1971759e-13  0              3.4540427    
   2500000   18000          200            200            0.0031997868   1.026592e-44   0              0.0095993604   9.6456096e-15  0              4.6575197e-10  1.1971759e-13  0              3.4540427    
   2600000   18000          200            200            0.0031997868  -5.6096774e-37  0              0.0095993604   4.5446335e-16  0              2.1944409e-11  1.1971759e-13  0              3.4540427    
   2700000   18000          200            200            0.0031997868  -8.4145162e-37  0              0.0095993604   1.6339899e-16  0              7.8899526e-12  1.1971759e-13  0              3.4540427    
   2800000   18000          200            200            0.0031997868   2.8048388e-36  0              0.0095993604   8.8207232e-18  0              4.2592115e-13  1.1971759e-13  0              3.4540427    
   2900000   18000          200            200            0.0031997868  -2.8048387e-37  0              0.0095993604   1.461128e-17   0              7.0552643e-13  1.1971759e-13  0              3.4540427    
   3000000   18000          200            200            0.0031997868   1.2543869e-44  0              0.0095993604   2.8461864e-18  0              1.3743216e-13  1.1971759e-13  0              3.4540427    
Loop time of 774.86 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3345120.978 ns/day, 0.000 hours/ns, 3871.668 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.2      | 241.06     | 241.91     |   5.5 | 31.11
Neigh   | 9.9777     | 9.9778     | 9.9779     |   0.0 |  1.29
Comm    | 31.877     | 32.806     | 33.735     |  16.2 |  4.23
Output  | 0.62377    | 0.62379    | 0.62382    |   0.0 |  0.08
Modify  | 429.96     | 429.97     | 429.97     |   0.0 | 55.49
Other   |            | 60.43      |            |       |  7.80

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.92                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.3872226154503
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.02
  ghost atom cutoff = 4.02
  binsize = 2.01, bins = 8956 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 201.5 | 201.5 | 201.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00019308471 -1.7950882e-35  0             -0.00057925414  1126256.4      0              5.4382892e+10  1.1971759e-13  0              3.564793     
    200000   18000          200            200           -0.00015170543  3.7783801e-41  0             -0.00045511628  20876.508      0              1.0080519e+09  1.1971759e-13  0              3.6221918    
    300000   18000          200            200            0.00018757848  6.4581901e-41  0              0.00056273544  21572.985      0              1.0416823e+09  1.1971759e-13  0              3.4944526    
    400000   18000          200            200            6.0672898e-05  1.7951033e-35  0              0.00018201869  2646.197       0              1.2777538e+08  1.1971759e-13  0              3.4685207    
    500000   18000          200            200            0.001498784    3.5901983e-35  0              0.004496352    3868.0996      0              1.8677668e+08  1.1971759e-13  0              3.4594427    
    600000   18000          200            200            0.0046254907   1.7950987e-35  0              0.013876472    496.44513      0              23971559       1.1971759e-13  0              3.4587823    
    700000   18000          200            200            0.0029867643   8.9754939e-36  0              0.0089602928   78.037592      0              3768156        1.1971759e-13  0              3.4590849    
    800000   18000          200            200            0.0036154211  -8.9754746e-36  0              0.010846263    0.44816152     0              21640.116      1.1971759e-13  0              3.4589631    
    900000   18000          200            200            0.0031518411   1.7950977e-35  0              0.0094555232   1.224478       0              59125.661      1.1971759e-13  0              3.4590538    
   1000000   18000          200            200            0.0031562513   1.3463233e-35  0              0.0094687539   0.040233779    0              1942.7452      1.1971759e-13  0              3.4590527    
   1100000   18000          200            200            0.0032156931   8.9754874e-36  0              0.0096470792   0.01623949     0              784.14685      1.1971759e-13  0              3.4590408    
   1200000   18000          200            200            0.0032097406   9.4015379e-43  0              0.0096292217   0.0014422284   0              69.640049      1.1971759e-13  0              3.459042     
   1300000   18000          200            200            0.0032024546  -5.0487097e-36  0              0.0096073637   0.00017742955  0              8.5674381      1.1971759e-13  0              3.4590435    
   1400000   18000          200            200            0.0032038968  -1.4024194e-37  0              0.0096116903   3.8414815e-05  0              1.8549139      1.1971759e-13  0              3.4590432    
   1500000   18000          200            200            0.0032047247   1.6829033e-36  0              0.009614174    1.420437e-06   0              0.068587818    1.1971759e-13  0              3.459043     
   1600000   18000          200            200            0.0032044602   1.0232633e-44  0              0.0096133805   8.5179675e-07  0              0.041130217    1.1971759e-13  0              3.4590431    
   1700000   18000          200            200            0.0032043752   2.8048389e-37  0              0.0096131255   5.3771712e-09  0              0.00025964435  1.1971759e-13  0              3.4590431    
   1800000   18000          200            200            0.0032044176   5.6096777e-37  0              0.0096132529   1.6388169e-08  0              0.00079132602  1.1971759e-13  0              3.4590431    
   1900000   18000          200            200            0.003204425   -2.8048387e-37  0              0.009613275    3.7100115e-12  0              1.7914318e-07  1.1971759e-13  0              3.4590431    
   2000000   18000          200            200            0.0032044187  -2.243871e-36   0              0.0096132562   2.7770775e-10  0              1.3409514e-05  1.1971759e-13  0              3.4590431    
   2100000   18000          200            200            0.0032044183   1.0219403e-44  0              0.009613255    3.0950768e-12  0              1.4945018e-07  1.1971759e-13  0              3.4590431    
   2200000   18000          200            200            0.0032044192  -1.1219355e-36  0              0.0096132576   4.1277158e-12  0              1.9931262e-07  1.1971759e-13  0              3.4590431    
   2300000   18000          200            200            0.0032044192   2.8048389e-37  0              0.0096132575   1.7289328e-13  0              8.3483976e-09  1.1971759e-13  0              3.4590431    
   2400000   18000          200            200            0.0032044191  -2.8048387e-37  0              0.0096132572   5.2300529e-14  0              2.5254054e-09  1.1971759e-13  0              3.4590431    
   2500000   18000          200            200            0.0032044191  -1.4024194e-36  0              0.0096132572   5.5031921e-15  0              2.6572945e-10  1.1971759e-13  0              3.4590431    
   2600000   18000          200            200            0.0032044191  -1.6829033e-36  0              0.0096132573   5.2210335e-16  0              2.5210502e-11  1.1971759e-13  0              3.4590431    
   2700000   18000          200            200            0.0032044191   1.6829033e-36  0              0.0096132572   6.5328762e-17  0              3.1544921e-12  1.1971759e-13  0              3.4590431    
   2800000   18000          200            200            0.0032044191   2.8048389e-37  0              0.0096132572   1.9467368e-17  0              9.4000952e-13  1.1971759e-13  0              3.4590431    
   2900000   18000          200            200            0.0032044191   2.8048389e-37  0              0.0096132572   9.9178969e-18  0              4.7889975e-13  1.1971759e-13  0              3.4590431    
   3000000   18000          200            200            0.0032044191  -6.7316131e-36  0              0.0096132572   1.1116316e-19  0              5.3676712e-15  1.1971759e-13  0              3.4590431    
Loop time of 774.174 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3348083.593 ns/day, 0.000 hours/ns, 3875.097 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.15     | 241.52     | 243.89     |  15.3 | 31.20
Neigh   | 9.1315     | 9.1319     | 9.1323     |   0.0 |  1.18
Comm    | 30.489     | 32.685     | 34.881     |  38.4 |  4.22
Output  | 0.62147    | 0.62149    | 0.6215     |   0.0 |  0.08
Modify  | 429.02     | 429.09     | 429.15     |   0.3 | 55.43
Other   |            | 61.13      |            |       |  7.90

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.93                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.9196030849932
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.03
  ghost atom cutoff = 4.03
  binsize = 2.015, bins = 8934 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 201.1 | 201.1 | 201.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00020208313  1.795106e-35   0             -0.0006062494   1111391.3      0              5.3665108e+10  1.1971759e-13  0              3.5747151    
    200000   18000          200            200           -0.00014539952  1.7950976e-34  0             -0.00043619856  18868.908      0              9.1111204e+08  1.1971759e-13  0              3.6280632    
    300000   18000          200            200            0.0001982179   3.590199e-35   0              0.00059465371  23787.714      0              1.1486236e+09  1.1971759e-13  0              3.4982724    
    400000   18000          200            200            7.0876199e-05  7.1803927e-35  0              0.0002126286   3555.1902      0              1.7166741e+08  1.1971759e-13  0              3.4730566    
    500000   18000          200            200            0.0040954567  -5.3852862e-35  0              0.01228637     4036.6329      0              1.9491455e+08  1.1971759e-13  0              3.4638886    
    600000   18000          200            200            0.0057095952   6.282841e-35   0              0.017128786    271.94618      0              13131308       1.1971759e-13  0              3.4635985    
    700000   18000          200            200            0.0025813821  -1.1668128e-34  0              0.0077441462   55.416878      0              2675882.7      1.1971759e-13  0              3.4641708    
    800000   18000          200            200            0.0036149134  -1.7950959e-35  0              0.01084474     0.65809682     0              31777.14       1.1971759e-13  0              3.4639642    
    900000   18000          200            200            0.0032291662  -3.5901928e-35  0              0.0096874985   1.3735854      0              66325.525      1.1971759e-13  0              3.4640397    
   1000000   18000          200            200            0.0031547795  -8.9754773e-36  0              0.0094643384   0.00041116478  0              19.853676      1.1971759e-13  0              3.4640543    
   1100000   18000          200            200            0.0032096745   4.4877453e-36  0              0.0096290236   0.024133923    0              1165.3408      1.1971759e-13  0              3.4640433    
   1200000   18000          200            200            0.0032161661   1.5707098e-35  0              0.0096484983   4.5933037e-05  0              2.217942       1.1971759e-13  0              3.464042     
   1300000   18000          200            200            0.0032085362   3.3658066e-36  0              0.0096256085   0.00040082827  0              19.354562      1.1971759e-13  0              3.4640435    
   1400000   18000          200            200            0.0032081471   2.8048388e-37  0              0.0096244412   4.4283511e-06  0              0.21382923     1.1971759e-13  0              3.4640436    
   1500000   18000          200            200            0.0032091739   5.6096776e-37  0              0.0096275216   6.278607e-06   0              0.30317146     1.1971759e-13  0              3.4640434    
   1600000   18000          200            200            0.0032091629   2.8048389e-37  0              0.0096274886   1.8371722e-07  0              0.0088710471   1.1971759e-13  0              3.4640434    
   1700000   18000          200            200            0.0032090285  -1.1219355e-36  0              0.0096270854   9.2162617e-08  0              0.004450203    1.1971759e-13  0              3.4640434    
   1800000   18000          200            200            0.0032090381   1.1219355e-36  0              0.0096271142   5.5904404e-09  0              0.00026994236  1.1971759e-13  0              3.4640434    
   1900000   18000          200            200            0.0032090552   2.8048388e-36  0              0.0096271655   1.2529283e-09  0              6.0499425e-05  1.1971759e-13  0              3.4640434    
   2000000   18000          200            200            0.0032090529   8.4145164e-37  0              0.0096271586   1.4348739e-10  0              6.9284924e-06  1.1971759e-13  0              3.4640434    
   2100000   18000          200            200            0.0032090508   1.0256e-44     0              0.0096271523   1.5439664e-11  0              7.4552612e-07  1.1971759e-13  0              3.4640434    
   2200000   18000          200            200            0.0032090512   2.243871e-36   0              0.0096271536   3.2862069e-12  0              1.5867917e-07  1.1971759e-13  0              3.4640434    
   2300000   18000          200            200            0.0032090514   2.8048389e-37  0              0.0096271543   1.6628282e-13  0              8.0292021e-09  1.1971759e-13  0              3.4640434    
   2400000   18000          200            200            0.0032090514  -8.4145162e-37  0              0.0096271541   6.8948912e-14  0              3.3292962e-09  1.1971759e-13  0              3.4640434    
   2500000   18000          200            200            0.0032090513  -2.243871e-36   0              0.009627154    1.4977618e-15  0              7.2321555e-11  1.1971759e-13  0              3.4640434    
   2600000   18000          200            200            0.0032090513   1.0431986e-44  0              0.009627154    1.3396979e-15  0              6.4689216e-11  1.1971759e-13  0              3.4640434    
   2700000   18000          200            200            0.0032090514  -2.8048387e-37  0              0.0096271541   6.6332646e-17  0              3.2029661e-12  1.1971759e-13  0              3.4640434    
   2800000   18000          200            200            0.0032090514   1.6829033e-36  0              0.0096271541   4.1557314e-19  0              2.006654e-14   1.1971759e-13  0              3.4640434    
   2900000   18000          200            200            0.0032090514  -8.4145162e-37  0              0.0096271541   9.0763541e-18  0              4.3826466e-13  1.1971759e-13  0              3.4640434    
   3000000   18000          200            200            0.0032090514   1.1219355e-36  0              0.0096271541   6.3421033e-18  0              3.0623747e-13  1.1971759e-13  0              3.4640434    
Loop time of 772.876 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3353707.442 ns/day, 0.000 hours/ns, 3881.606 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.71     | 241.91     | 244.11     |  14.1 | 31.30
Neigh   | 8.9447     | 8.9447     | 8.9447     |   0.0 |  1.16
Comm    | 29.082     | 31.319     | 33.557     |  40.0 |  4.05
Output  | 0.62279    | 0.62282    | 0.62284    |   0.0 |  0.08
Modify  | 429.77     | 429.88     | 429.98     |   0.5 | 55.62
Other   |            | 60.2       |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.94                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.4546997755443
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.04
  ghost atom cutoff = 4.04
  binsize = 2.02, bins = 8911 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 200.6 | 200.6 | 200.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00021093095 -1.7950877e-35  0             -0.00063279285  1096633.7      0              5.2952517e+10  1.1971759e-13  0              3.5846068    
    200000   18000          200            200           -0.00013897663  7.5426793e-41  0             -0.0004169299   16964.516      0              8.1915579e+08  1.1971759e-13  0              3.6338874    
    300000   18000          200            200            0.00020896069  2.6926458e-34  0              0.00062688207  26107.94       0              1.260659e+09   1.1971759e-13  0              3.502033     
    400000   18000          200            200            8.1212738e-05  1.0770587e-34  0              0.00024363821  4596.692       0              2.2195781e+08  1.1971759e-13  0              3.4775234    
    500000   18000          200            200            0.0073124036   1.795101e-35   0              0.021937211    3227.2219      0              1.55831e+08    1.1971759e-13  0              3.4683559    
    600000   18000          200            200            0.0064348852   1.7950988e-35  0              0.019304655    64.181344      0              3099087.4      1.1971759e-13  0              3.4684822    
    700000   18000          200            200            0.002289055    1.7950979e-35  0              0.0068671649   24.001861      0              1158964        1.1971759e-13  0              3.4692361    
    800000   18000          200            200            0.0035299481  -8.9754755e-36  0              0.010589844    4.4916141      0              216883.97      1.1971759e-13  0              3.4689816    
    900000   18000          200            200            0.0033022217   8.3235874e-42  0              0.0099066652   0.91732701     0              44294.438      1.1971759e-13  0              3.4690265    
   1000000   18000          200            200            0.0031683664   2.6926459e-35  0              0.0095050993   0.05514593     0              2662.7996      1.1971759e-13  0              3.4690529    
   1100000   18000          200            200            0.0032034679  -8.9754809e-36  0              0.0096104038   0.017736379    0              856.42628      1.1971759e-13  0              3.4690458    
   1200000   18000          200            200            0.0032199671  -2.2438701e-36  0              0.0096599013   0.00071857578  0              34.697453      1.1971759e-13  0              3.4690425    
   1300000   18000          200            200            0.0032148324  -1.6829032e-36  0              0.0096444973   0.00033669833  0              16.257957      1.1971759e-13  0              3.4690436    
   1400000   18000          200            200            0.0032128219   2.8048388e-37  0              0.0096384658   8.7574109e-06  0              0.42286403     1.1971759e-13  0              3.469044     
   1500000   18000          200            200            0.0032135591   8.4145164e-37  0              0.0096406772   6.2721228e-06  0              0.30285836     1.1971759e-13  0              3.4690438    
   1600000   18000          200            200            0.0032138008  -1.9633871e-36  0              0.0096414024   9.7374667e-08  0              0.0047018742   1.1971759e-13  0              3.4690438    
   1700000   18000          200            200            0.0032136964   1.0370673e-44  0              0.0096410892   1.1492192e-07  0              0.0055491683   1.1971759e-13  0              3.4690438    
   1800000   18000          200            200            0.0032136678   5.6096777e-37  0              0.0096410034   9.3612302e-10  0              4.520203e-05   1.1971759e-13  0              3.4690438    
   1900000   18000          200            200            0.0032136824   8.4145164e-37  0              0.0096410473   2.072827e-09   0              0.0001000894   1.1971759e-13  0              3.4690438    
   2000000   18000          200            200            0.0032136857   5.6096777e-37  0              0.0096410572   6.8712686e-12  0              3.3178897e-07  1.1971759e-13  0              3.4690438    
   2100000   18000          200            200            0.0032136837  -1.9633871e-36  0              0.0096410511   3.6819506e-11  0              1.7778822e-06  1.1971759e-13  0              3.4690438    
   2200000   18000          200            200            0.0032136833   5.6096777e-37  0              0.00964105     2.4504692e-14  0              1.1832439e-09  1.1971759e-13  0              3.4690438    
   2300000   18000          200            200            0.0032136836  -8.4145162e-37  0              0.0096410508   6.4344198e-13  0              3.1069511e-08  1.1971759e-13  0              3.4690438    
   2400000   18000          200            200            0.0032136837   5.8901614e-36  0              0.009641051    1.7201259e-17  0              8.3058723e-13  1.1971759e-13  0              3.4690438    
   2500000   18000          200            200            0.0032136836   5.6096777e-37  0              0.0096410509   1.1054e-14     0              5.3375809e-10  1.1971759e-13  0              3.4690438    
   2600000   18000          200            200            0.0032136836   5.6096777e-37  0              0.0096410508   1.4793174e-17  0              7.1430942e-13  1.1971759e-13  0              3.4690438    
   2700000   18000          200            200            0.0032136836  -2.8048387e-37  0              0.0096410509   1.6625676e-16  0              8.0279438e-12  1.1971759e-13  0              3.4690438    
   2800000   18000          200            200            0.0032136836  -5.6096774e-37  0              0.0096410509   2.5315529e-17  0              1.2223963e-12  1.1971759e-13  0              3.4690438    
   2900000   18000          200            200            0.0032136836  -5.6096774e-37  0              0.0096410509   9.0733413e-18  0              4.3811918e-13  1.1971759e-13  0              3.4690438    
   3000000   18000          200            200            0.0032136836   1.6829033e-36  0              0.0096410509   9.695393e-18   0              4.6815583e-13  1.1971759e-13  0              3.4690438    
Loop time of 779.197 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3326499.583 ns/day, 0.000 hours/ns, 3850.115 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.18     | 243.39     | 243.61     |   1.4 | 31.24
Neigh   | 8.9904     | 8.9905     | 8.9906     |   0.0 |  1.15
Comm    | 31.277     | 31.326     | 31.374     |   0.9 |  4.02
Output  | 0.62871    | 0.62872    | 0.62873    |   0.0 |  0.08
Modify  | 433.87     | 435.1      | 436.32     |   5.9 | 55.84
Other   |            | 59.76      |            |       |  7.67

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.95                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.9925195986076
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.05
  ghost atom cutoff = 4.05
  binsize = 2.025, bins = 8889 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 196.6 | 196.6 | 196.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00021962858  1.4284652e-40  0             -0.00065888573  1081983.5      0              5.2245111e+10  1.1971759e-13  0              3.5944681    
    200000   18000          200            200           -0.00013243726  1.795107e-35   0             -0.00039731177  15163.014      0              7.3216768e+08  1.1971759e-13  0              3.6396644    
    300000   18000          200            200            0.00021980585  1.7951037e-35  0              0.00065941754  28533.252      0              1.3777686e+09  1.1971759e-13  0              3.5057345    
    400000   18000          200            200            9.1681318e-05  8.9754901e-35  0              0.00027504395  5770.164       0              2.7862057e+08  1.1971759e-13  0              3.4819209    
    500000   18000          200            200            0.010376412   -1.7950921e-35  0              0.031129237    1707.4032      0              82444391       1.1971759e-13  0              3.4729201    
    600000   18000          200            200            0.0066224954   2.6926469e-35  0              0.019867486    3.3214476      0              160380.82      1.1971759e-13  0              3.4734531    
    700000   18000          200            200            0.0021424742   8.9754948e-36  0              0.0064274226   2.6372564      0              127343.67      1.1971759e-13  0              3.4742708    
    800000   18000          200            200            0.0033807317  -8.9754757e-36  0              0.010142195    8.9151652      0              430481.42      1.1971759e-13  0              3.4740116    
    900000   18000          200            200            0.0033543502   3.5901945e-35  0              0.010063051    0.26432832     0              12763.469      1.1971759e-13  0              3.4740175    
   1000000   18000          200            200            0.0031945629  -1.3463219e-35  0              0.0095836887   0.14716813     0              7106.2225      1.1971759e-13  0              3.4740489    
   1100000   18000          200            200            0.0032005583   8.9754874e-36  0              0.009601675    0.0046630384   0              225.16143      1.1971759e-13  0              3.4740476    
   1200000   18000          200            200            0.0032214538   1.1219356e-35  0              0.0096643614   0.0025414054   0              122.71537      1.1971759e-13  0              3.4740435    
   1300000   18000          200            200            0.0032206491   5.0487098e-36  0              0.0096619472   8.1792813e-05  0              3.9494822      1.1971759e-13  0              3.4740437    
   1400000   18000          200            200            0.0032179005  -4.2072581e-37  0              0.0096537014   4.3817833e-05  0              2.1158063      1.1971759e-13  0              3.4740442    
   1500000   18000          200            200            0.0032180095   5.6096776e-37  0              0.0096540285   1.4318322e-06  0              0.069138055    1.1971759e-13  0              3.4740442    
   1600000   18000          200            200            0.0032183709  -2.8048387e-37  0              0.0096551126   7.5568883e-07  0              0.036489509    1.1971759e-13  0              3.4740441    
   1700000   18000          200            200            0.0032183561   8.4145164e-37  0              0.0096550684   2.5068077e-08  0              0.0012104477   1.1971759e-13  0              3.4740441    
   1800000   18000          200            200            0.0032183086  -2.8048387e-37  0              0.0096549258   1.3031875e-08  0              0.00062926261  1.1971759e-13  0              3.4740441    
   1900000   18000          200            200            0.0032183106   1.0421358e-44  0              0.0096549318   4.3884105e-10  0              2.1190064e-05  1.1971759e-13  0              3.4740441    
   2000000   18000          200            200            0.0032183168   8.4145164e-37  0              0.0096549505   2.2475498e-10  0              1.0852614e-05  1.1971759e-13  0              3.4740441    
   2100000   18000          200            200            0.0032183166  -5.6096774e-37  0              0.0096549497   7.6837711e-12  0              3.7102181e-07  1.1971759e-13  0              3.4740441    
   2200000   18000          200            200            0.0032183158   1.0188112e-44  0              0.0096549473   3.8742818e-12  0              1.870752e-07   1.1971759e-13  0              3.4740441    
   2300000   18000          200            200            0.0032183158   5.6096777e-37  0              0.0096549474   1.3456918e-13  0              6.4978639e-09  1.1971759e-13  0              3.4740441    
   2400000   18000          200            200            0.0032183159   2.8048389e-37  0              0.0096549477   6.6871704e-14  0              3.2289953e-09  1.1971759e-13  0              3.4740441    
   2500000   18000          200            200            0.0032183159   2.8048389e-37  0              0.0096549477   2.2810024e-15  0              1.1014144e-10  1.1971759e-13  0              3.4740441    
   2600000   18000          200            200            0.0032183159   7.8535486e-36  0              0.0096549477   1.1396691e-15  0              5.5030544e-11  1.1971759e-13  0              3.4740441    
   2700000   18000          200            200            0.0032183159  -3.9267743e-36  0              0.0096549477   1.140886e-19   0              5.5089304e-15  1.1971759e-13  0              3.4740441    
   2800000   18000          200            200            0.0032183159   1.0238373e-44  0              0.0096549477   2.6634576e-18  0              1.2860884e-13  1.1971759e-13  0              3.4740441    
   2900000   18000          200            200            0.0032183159  -5.6096774e-37  0              0.0096549477   3.2475742e-21  0              1.5681373e-16  1.1971759e-13  0              3.4740441    
   3000000   18000          200            200            0.0032183159   2.8048389e-37  0              0.0096549477   1.9877049e-18  0              9.5979158e-14  1.1971759e-13  0              3.4740441    
Loop time of 771.459 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3359866.528 ns/day, 0.000 hours/ns, 3888.734 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.27     | 241.43     | 244.59     |  20.3 | 31.29
Neigh   | 8.8578     | 8.858      | 8.8581     |   0.0 |  1.15
Comm    | 29.091     | 32.417     | 35.742     |  58.4 |  4.20
Output  | 0.65495    | 0.65497    | 0.65499    |   0.0 |  0.08
Modify  | 427.87     | 427.97     | 428.06     |   0.5 | 55.48
Other   |            | 60.13      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.96                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 71.5330694656869
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.06
  ghost atom cutoff = 4.06
  binsize = 2.03, bins = 8867 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 196.1 | 196.1 | 196.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00022817649  7.1804021e-35  0             -0.00068452946  1067440.3      0              5.154287e+10   1.1971759e-13  0              3.6042991    
    200000   18000          200            200           -0.00012578159  7.8459066e-41  0             -0.00037734476  13464.021      0              6.5012939e+08  1.1971759e-13  0              3.6453941    
    300000   18000          200            200            0.00023075378  6.045536e-41   0              0.00069226133  31063.567      0              1.4999485e+09  1.1971759e-13  0              3.5093766    
    400000   18000          200            200            0.00010228219 -7.1803806e-35  0              0.00030684656  7075.252       0              3.416386e+08   1.1971759e-13  0              3.486249     
    500000   18000          200            200            0.012423975   -1.795092e-35   0              0.037271925    348.52988      0              16829260       1.1971759e-13  0              3.477653     
    600000   18000          200            200            0.0062222581  -8.9754652e-36  0              0.018666774    128.315        0              6195872.3      1.1971759e-13  0              3.4785163    
    700000   18000          200            200            0.0021551411   5.3852916e-35  0              0.0064654233   3.5487929      0              171358.51      1.1971759e-13  0              3.4792699    
    800000   18000          200            200            0.0032009032   8.4408944e-42  0              0.0096027097   10.49824       0              506922.46      1.1971759e-13  0              3.4790481    
    900000   18000          200            200            0.0033737134   8.3084175e-42  0              0.01012114     0.0027456153   0              132.57593      1.1971759e-13  0              3.4790149    
   1000000   18000          200            200            0.0032274362   6.9493624e-42  0              0.0096823085   0.18095684     0              8737.7582      1.1971759e-13  0              3.4790437    
   1100000   18000          200            200            0.0032033594   1.3463229e-35  0              0.0096100781   0.00033514605  0              16.183003      1.1971759e-13  0              3.4790484    
   1200000   18000          200            200            0.0032217881   1.3463227e-35  0              0.0096653642   0.0030710121   0              148.28818      1.1971759e-13  0              3.4790447    
   1300000   18000          200            200            0.0032254934  -5.0487097e-36  0              0.0096764801   1.5906967e-05  0              0.76809052     1.1971759e-13  0              3.479044     
   1400000   18000          200            200            0.003223173    2.2093649e-45  0              0.0096695191   5.1480125e-05  0              2.485791       1.1971759e-13  0              3.4790444    
   1500000   18000          200            200            0.0032226199   2.8048389e-37  0              0.0096678596   5.3157925e-07  0              0.02566806     1.1971759e-13  0              3.4790445    
   1600000   18000          200            200            0.0032229092  -5.6096774e-37  0              0.0096687276   8.5163896e-07  0              0.041122597    1.1971759e-13  0              3.4790445    
   1700000   18000          200            200            0.0032229902  -5.6096774e-37  0              0.0096689707   1.4934553e-08  0              0.00072113613  1.1971759e-13  0              3.4790445    
   1800000   18000          200            200            0.0032229545  -2.243871e-36   0              0.0096688634   1.3897016e-08  0              0.00067103715  1.1971759e-13  0              3.4790445    
   1900000   18000          200            200            0.0032229428   5.6096776e-37  0              0.0096688284   3.7767569e-10  0              1.8236607e-05  1.1971759e-13  0              3.4790445    
   2000000   18000          200            200            0.0032229472  -3.9267743e-36  0              0.0096688415   2.2348038e-10  0              1.0791068e-05  1.1971759e-13  0              3.4790445    
   2100000   18000          200            200            0.0032229488   5.6096777e-37  0              0.0096688465   8.8996825e-12  0              4.2973382e-07  1.1971759e-13  0              3.4790445    
   2200000   18000          200            200            0.0032229483   1.0130656e-44  0              0.0096688449   3.5393938e-12  0              1.7090466e-07  1.1971759e-13  0              3.4790445    
   2300000   18000          200            200            0.0032229481  -1.1219355e-36  0              0.0096688442   1.9855627e-13  0              9.5875719e-09  1.1971759e-13  0              3.4790445    
   2400000   18000          200            200            0.0032229481   8.4145164e-37  0              0.0096688444   5.55758e-14    0              2.6835565e-09  1.1971759e-13  0              3.4790445    
   2500000   18000          200            200            0.0032229482   1.9633872e-36  0              0.0096688445   4.3780015e-15  0              2.1139802e-10  1.1971759e-13  0              3.4790445    
   2600000   18000          200            200            0.0032229482   2.8048389e-37  0              0.0096688445   8.0549912e-16  0              3.889467e-11   1.1971759e-13  0              3.4790445    
   2700000   18000          200            200            0.0032229482  -1.1219355e-36  0              0.0096688445   1.7157897e-16  0              8.2849342e-12  1.1971759e-13  0              3.4790445    
   2800000   18000          200            200            0.0032229482   8.4145164e-37  0              0.0096688445   1.9233069e-17  0              9.2869608e-13  1.1971759e-13  0              3.4790445    
   2900000   18000          200            200            0.0032229482  -5.6096774e-37  0              0.0096688445   1.3516934e-19  0              6.5268435e-15  1.1971759e-13  0              3.4790445    
   3000000   18000          200            200            0.0032229482   8.4145165e-37  0              0.0096688445   3.0757569e-18  0              1.485173e-13   1.1971759e-13  0              3.4790445    
Loop time of 774.191 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3348010.788 ns/day, 0.000 hours/ns, 3875.012 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.02     | 242.6      | 243.18     |   3.7 | 31.34
Neigh   | 9.0682     | 9.0683     | 9.0685     |   0.0 |  1.17
Comm    | 31.136     | 31.49      | 31.843     |   6.3 |  4.07
Output  | 0.62021    | 0.62024    | 0.62028    |   0.0 |  0.08
Modify  | 429.03     | 429.05     | 429.08     |   0.1 | 55.42
Other   |            | 61.36      |            |       |  7.93

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.97                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.076356288286
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.07
  ghost atom cutoff = 4.07
  binsize = 2.035, bins = 8846 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 195.7 | 195.7 | 195.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0002365751   1.7951089e-35  0             -0.00070972529  1053003.8      0              5.0845784e+10  1.1971759e-13  0              3.6140996    
    200000   18000          200            200           -0.00011901041  3.5902057e-35  0             -0.00035703122  11867.318      0              5.7303031e+08  1.1971759e-13  0              3.6510763    
    300000   18000          200            200            0.00024180311  6.641859e-34   0              0.00072540932  33698.402      0              1.6271752e+09  1.1971759e-13  0              3.5129591    
    400000   18000          200            200            0.0001130137  -3.5901881e-35  0              0.00033904111  8511.3934      0              4.1098472e+08  1.1971759e-13  0              3.4905075    
    500000   18000          200            200            0.012814715   -7.1803826e-35  0              0.038444146    54.924301      0              2652097.9      1.1971759e-13  0              3.4826033    
    600000   18000          200            200            0.005333743   -2.6926437e-35  0              0.016001229    357.01446      0              17238951       1.1971759e-13  0              3.4836612    
    700000   18000          200            200            0.0023268266   2.6926463e-35  0              0.0069804799   26.077792      0              1259203.2      1.1971759e-13  0              3.4842334    
    800000   18000          200            200            0.0030286858   8.9754928e-36  0              0.0090860574   8.0777705      0              390046.63      1.1971759e-13  0              3.4840838    
    900000   18000          200            200            0.0033565614   4.4877502e-36  0              0.010069684    0.36568303     0              17657.525      1.1971759e-13  0              3.4840194    
   1000000   18000          200            200            0.0032591403   2.6926459e-35  0              0.0097774209   0.1214704      0              5865.3709      1.1971759e-13  0              3.4840387    
   1100000   18000          200            200            0.0032124534  -1.3463223e-35  0              0.0096373602   0.0097507678   0              470.82968      1.1971759e-13  0              3.4840478    
   1200000   18000          200            200            0.0032225514   4.4877429e-36  0              0.0096676541   0.0016057889   0              77.537801      1.1971759e-13  0              3.4840458    
   1300000   18000          200            200            0.0032292788  -2.8048387e-36  0              0.0096878364   0.00023459679  0              11.327839      1.1971759e-13  0              3.4840445    
   1400000   18000          200            200            0.0032283403   4.2072582e-37  0              0.0096850208   1.9214859e-05  0              0.92781679     1.1971759e-13  0              3.4840447    
   1500000   18000          200            200            0.0032274011   2.8048389e-37  0              0.0096822033   5.1454328e-06  0              0.24845454     1.1971759e-13  0              3.4840449    
   1600000   18000          200            200            0.0032274701   2.8048389e-37  0              0.0096824103   1.9801974e-07  0              0.0095616644   1.1971759e-13  0              3.4840449    
   1700000   18000          200            200            0.0032275976  -3.0853226e-36  0              0.0096827928   1.050574e-07   0              0.0050728457   1.1971759e-13  0              3.4840448    
   1800000   18000          200            200            0.0032275959   5.6096777e-37  0              0.0096827878   1.5788418e-09  0              7.623662e-05   1.1971759e-13  0              3.4840448    
   1900000   18000          200            200            0.0032275791  -8.4145162e-37  0              0.0096827372   2.0188053e-09  0              9.7480884e-05  1.1971759e-13  0              3.4840448    
   2000000   18000          200            200            0.0032275783  -5.6096774e-37  0              0.0096827349   6.8751866e-12  0              3.3197815e-07  1.1971759e-13  0              3.4840448    
   2100000   18000          200            200            0.0032275805   1.1219355e-36  0              0.0096827414   3.6731294e-11  0              1.7736227e-06  1.1971759e-13  0              3.4840448    
   2200000   18000          200            200            0.0032275807  -5.6096774e-37  0              0.0096827421   6.5040912e-17  0              3.1405929e-12  1.1971759e-13  0              3.4840448    
   2300000   18000          200            200            0.0032275804  -5.6096774e-37  0              0.0096827413   6.3455691e-13  0              3.0640482e-08  1.1971759e-13  0              3.4840448    
   2400000   18000          200            200            0.0032275804  -2.8048387e-37  0              0.0096827411   2.2424024e-15  0              1.0827759e-10  1.1971759e-13  0              3.4840448    
   2500000   18000          200            200            0.0032275804  -2.8048387e-37  0              0.0096827412   1.0414908e-14  0              5.0289865e-10  1.1971759e-13  0              3.4840448    
   2600000   18000          200            200            0.0032275804  -2.8048388e-36  0              0.0096827413   1.5792012e-16  0              7.6253972e-12  1.1971759e-13  0              3.4840448    
   2700000   18000          200            200            0.0032275804  -5.6096774e-37  0              0.0096827413   7.897925e-17   0              3.8136253e-12  1.1971759e-13  0              3.4840448    
   2800000   18000          200            200            0.0032275804  -5.6096774e-37  0              0.0096827413   1.9513837e-17  0              9.4225335e-13  1.1971759e-13  0              3.4840448    
   2900000   18000          200            200            0.0032275804   5.6096777e-37  0              0.0096827413   4.4768373e-20  0              2.1617045e-15  1.1971759e-13  0              3.4840448    
   3000000   18000          200            200            0.0032275804   8.4145164e-37  0              0.0096827413   7.9454237e-18  0              3.8365608e-13  1.1971759e-13  0              3.4840448    
Loop time of 773.408 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3351400.307 ns/day, 0.000 hours/ns, 3878.936 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.85     | 242.2      | 242.54     |   2.2 | 31.32
Neigh   | 9.0449     | 9.0449     | 9.045      |   0.0 |  1.17
Comm    | 30.709     | 31.319     | 31.929     |  10.9 |  4.05
Output  | 0.62038    | 0.62039    | 0.6204     |   0.0 |  0.08
Modify  | 429.25     | 429.36     | 429.47     |   0.5 | 55.52
Other   |            | 60.87      |            |       |  7.87

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.98                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.6223869779087
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.08
  ghost atom cutoff = 4.08
  binsize = 2.04, bins = 8824 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 195.2 | 195.2 | 195.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00024482463 -1.7950844e-35  0             -0.00073447388  1038674.4      0              5.0153868e+10  1.1971759e-13  0              3.6238696    
    200000   18000          200            200           -0.00011212501 -5.3852852e-35  0             -0.00033637504  10372.777      0              5.0086428e+08  1.1971759e-13  0              3.656711     
    300000   18000          200            200            0.0002529518   7.1803941e-35  0              0.00075885539  36437.081      0              1.7594162e+09  1.1971759e-13  0              3.5164821    
    400000   18000          200            200            0.00012387303  6.6424738e-41  0              0.00037161909  10077.821      0              4.8662189e+08  1.1971759e-13  0              3.4946963    
    500000   18000          200            200            0.011412491   -1.7950926e-35  0              0.034237473    1028.2297      0              49649532       1.1971759e-13  0              3.4877808    
    600000   18000          200            200            0.0041685155   1.484505e-41   0              0.012505546    546.84016      0              26404954       1.1971759e-13  0              3.4888639    
    700000   18000          200            200            0.0026430911   2.6926464e-35  0              0.0079292733   56.997757      0              2752217.7      1.1971759e-13  0              3.4891669    
    800000   18000          200            200            0.0028983729   8.659525e-42   0              0.0086951187   3.545161       0              171183.14      1.1971759e-13  0              3.4891117    
    900000   18000          200            200            0.00330833     8.0824107e-42  0              0.0099249901   1.0189377      0              49200.855      1.1971759e-13  0              3.48903      
   1000000   18000          200            200            0.0032820717  -1.3463219e-35  0              0.009846215    0.030473529    0              1471.4577      1.1971759e-13  0              3.4890354    
   1100000   18000          200            200            0.0032264103   1.7950972e-35  0              0.0096792308   0.021682715    0              1046.9807      1.1971759e-13  0              3.4890464    
   1200000   18000          200            200            0.0032251623   6.7316139e-36  0              0.009675487    0.00010201765  0              4.926067       1.1971759e-13  0              3.4890466    
   1300000   18000          200            200            0.0032323593  -5.6096771e-37  0              0.0096970779   0.00041008246  0              19.801414      1.1971759e-13  0              3.4890451    
   1400000   18000          200            200            0.003233153   -1.4024194e-37  0              0.0096994589   1.9125233e-07  0              0.0092348904   1.1971759e-13  0              3.489045     
   1500000   18000          200            200            0.0032322754   5.6096776e-37  0              0.0096968261   6.8912442e-06  0              0.33275352     1.1971759e-13  0              3.4890452    
   1600000   18000          200            200            0.0032320945  -1.1219355e-36  0              0.0096962835   8.205634e-08   0              0.003962207    1.1971759e-13  0              3.4890452    
   1700000   18000          200            200            0.0032321941  -2.8048387e-37  0              0.0096965824   1.0256777e-07  0              0.0049526308   1.1971759e-13  0              3.4890452    
   1800000   18000          200            200            0.0032322266  -2.8048387e-37  0              0.0096966798   4.3039763e-09  0              0.00020782361  1.1971759e-13  0              3.4890452    
   1900000   18000          200            200            0.0032322163  -5.6096774e-37  0              0.009696649    1.3247916e-09  0              6.3969446e-05  1.1971759e-13  0              3.4890452    
   2000000   18000          200            200            0.0032322112   1.6829033e-36  0              0.0096966335   1.3929272e-10  0              6.7259471e-06  1.1971759e-13  0              3.4890452    
   2100000   18000          200            200            0.0032322121  -8.4145162e-37  0              0.0096966362   1.4123778e-11  0              6.8198667e-07  1.1971759e-13  0              3.4890452    
   2200000   18000          200            200            0.0032322128  -2.8048387e-37  0              0.0096966385   3.5334992e-12  0              1.7062003e-07  1.1971759e-13  0              3.4890452    
   2300000   18000          200            200            0.0032322128   1.0521854e-44  0              0.0096966383   1.1004232e-13  0              5.3135497e-09  1.1971759e-13  0              3.4890452    
   2400000   18000          200            200            0.0032322127   8.4145164e-37  0              0.009696638    7.6202032e-14  0              3.6795234e-09  1.1971759e-13  0              3.4890452    
   2500000   18000          200            200            0.0032322127  -8.4145162e-37  0              0.009696638    4.6042052e-16  0              2.2232059e-11  1.1971759e-13  0              3.4890452    
   2600000   18000          200            200            0.0032322127   5.6096777e-37  0              0.009696638    1.4451709e-15  0              6.9782132e-11  1.1971759e-13  0              3.4890452    
   2700000   18000          200            200            0.0032322127  -2.8048387e-37  0              0.0096966381   3.8702173e-17  0              1.8687894e-12  1.1971759e-13  0              3.4890452    
   2800000   18000          200            200            0.0032322127   5.6096777e-37  0              0.009696638    4.8001851e-19  0              2.3178376e-14  1.1971759e-13  0              3.4890452    
   2900000   18000          200            200            0.0032322127  -1.6829033e-36  0              0.009696638    2.3547932e-18  0              1.1370454e-13  1.1971759e-13  0              3.4890452    
   3000000   18000          200            200            0.0032322127  -2.8048387e-37  0              0.009696638    1.4296057e-18  0              6.9030543e-14  1.1971759e-13  0              3.4890452    
Loop time of 774.636 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3346089.256 ns/day, 0.000 hours/ns, 3872.788 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.27     | 241.6      | 245.94     |  27.9 | 31.19
Neigh   | 8.9989     | 8.999      | 8.9991     |   0.0 |  1.16
Comm    | 30.104     | 34.304     | 38.504     |  71.7 |  4.43
Output  | 0.62253    | 0.62256    | 0.62258    |   0.0 |  0.08
Modify  | 428.86     | 428.91     | 428.96     |   0.2 | 55.37
Other   |            | 60.2       |            |       |  7.77

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.99                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 73.171168446059
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.09
  ghost atom cutoff = 4.09
  binsize = 2.045, bins = 8802 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 191.3 | 191.3 | 191.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0002529255   1.1664037e-40  0             -0.00075877651  1024451.6      0              4.9467103e+10  1.1971759e-13  0              3.6336089    
    200000   18000          200            200           -0.00010512517 -1.7950907e-35  0             -0.00031537552  8979.9406      0              4.3360919e+08  1.1971759e-13  0              3.662298     
    300000   18000          200            200            0.00026420138  5.5270508e-41  0              0.00079260413  39279.835      0              1.8966826e+09  1.1971759e-13  0              3.5199451    
    400000   18000          200            200            0.00013486248  5.3852961e-35  0              0.00040458744  11774.526      0              5.6854974e+08  1.1971759e-13  0              3.4988152    
    500000   18000          200            200            0.008652291    1.7951015e-35  0              0.025956873    2587.9821      0              1.2496439e+08  1.1971759e-13  0              3.4931533    
    600000   18000          200            200            0.0029722977   3.5901952e-35  0              0.0089168931   592.88934      0              28628505       1.1971759e-13  0              3.4940927    
    700000   18000          200            200            0.0030692898   2.6926463e-35  0              0.0092078694   77.381044      0              3736453.7      1.1971759e-13  0              3.4940808    
    800000   18000          200            200            0.0028344353  -1.7950959e-35  0              0.0085033058   0.31139058     0              15035.937      1.1971759e-13  0              3.4941262    
    900000   18000          200            200            0.0032421063   2.2438718e-35  0              0.0097263188   1.3694448      0              66125.591      1.1971759e-13  0              3.4940442    
   1000000   18000          200            200            0.0032910485  -8.9754774e-36  0              0.0098731456   0.0022766172   0              109.9297       1.1971759e-13  0              3.4940349    
   1100000   18000          200            200            0.003242242   -4.9365159e-35  0              0.0097267261   0.022009986    0              1062.7835      1.1971759e-13  0              3.4940445    
   1200000   18000          200            200            0.0032303584   2.2438711e-35  0              0.0096910752   0.00055060014  0              26.58651       1.1971759e-13  0              3.4940468    
   1300000   18000          200            200            0.0032353798  -2.243871e-36   0              0.0097061395   0.00028156539  0              13.595785      1.1971759e-13  0              3.4940458    
   1400000   18000          200            200            0.0032375279   2.8048388e-37  0              0.0097125838   2.5368368e-05  0              1.2249477      1.1971759e-13  0              3.4940454    
   1500000   18000          200            200            0.003237117   -2.8048387e-37  0              0.0097113509   2.629775e-06   0              0.12698242     1.1971759e-13  0              3.4940455    
   1600000   18000          200            200            0.0032367867   2.8048389e-37  0              0.0097103602   7.2390336e-07  0              0.034954703    1.1971759e-13  0              3.4940455    
   1700000   18000          200            200            0.0032368024   2.8048389e-37  0              0.0097104072   1.3087488e-08  0              0.00063194796  1.1971759e-13  0              3.4940455    
   1800000   18000          200            200            0.0032368477   8.4145164e-37  0              0.009710543    1.567233e-08   0              0.00075676071  1.1971759e-13  0              3.4940455    
   1900000   18000          200            200            0.0032368509  -8.4145162e-37  0              0.0097105526   2.4730204e-13  0              1.194133e-08   1.1971759e-13  0              3.4940455    
   2000000   18000          200            200            0.0032368453   5.6096776e-37  0              0.0097105358   2.7296158e-10  0              1.3180338e-05  1.1971759e-13  0              3.4940455    
   2100000   18000          200            200            0.0032368442  -5.6096774e-37  0              0.0097105326   3.4416916e-12  0              1.6618697e-07  1.1971759e-13  0              3.4940455    
   2200000   18000          200            200            0.0032368448  -2.8048387e-37  0              0.0097105344   3.8242071e-12  0              1.8465728e-07  1.1971759e-13  0              3.4940455    
   2300000   18000          200            200            0.003236845    2.8048389e-37  0              0.0097105351   2.2150701e-13  0              1.0695781e-08  1.1971759e-13  0              3.4940455    
   2400000   18000          200            200            0.003236845   -2.8048388e-36  0              0.0097105349   4.0732339e-14  0              1.9668189e-09  1.1971759e-13  0              3.4940455    
   2500000   18000          200            200            0.0032368449   5.6096777e-37  0              0.0097105348   7.1160403e-15  0              3.4360812e-10  1.1971759e-13  0              3.4940455    
   2600000   18000          200            200            0.0032368449   8.4145164e-37  0              0.0097105348   2.42204e-16    0              1.1695165e-11  1.1971759e-13  0              3.4940455    
   2700000   18000          200            200            0.0032368449   1.9633872e-36  0              0.0097105348   1.674551e-16   0              8.0858074e-12  1.1971759e-13  0              3.4940455    
   2800000   18000          200            200            0.0032368449  -5.6096774e-37  0              0.0097105348   2.3149623e-17  0              1.1178125e-12  1.1971759e-13  0              3.4940455    
   2900000   18000          200            200            0.0032368449  -5.6096774e-37  0              0.0097105348   8.6817418e-18  0              4.1921024e-13  1.1971759e-13  0              3.4940455    
   3000000   18000          200            200            0.0032368449  -1.4024194e-36  0              0.0097105348   9.0198428e-19  0              4.3553593e-14  1.1971759e-13  0              3.4940455    
Loop time of 773.836 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3349547.570 ns/day, 0.000 hours/ns, 3876.791 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.87     | 242.82     | 244.78     |  12.5 | 31.38
Neigh   | 8.978      | 8.9781     | 8.9781     |   0.0 |  1.16
Comm    | 30.336     | 32         | 33.663     |  29.4 |  4.14
Output  | 0.62218    | 0.62221    | 0.62223    |   0.0 |  0.08
Modify  | 429.27     | 429.3      | 429.32     |   0.1 | 55.48
Other   |            | 60.12      |            |       |  7.77

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 73.7227076042404
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.1
  ghost atom cutoff = 4.1
  binsize = 2.05, bins = 8781 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 190.9 | 190.9 | 190.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00026087813 -3.590184e-35   0             -0.00078263439  1010335.5      0              4.8785486e+10  1.1971759e-13  0              3.6433176    
    200000   18000          200            200           -9.8012238e-05  5.3852966e-35  0             -0.00029403671  7688.6759      0              3.7125864e+08  1.1971759e-13  0              3.6678373    
    300000   18000          200            200            0.00027554854  6.1537057e-41  0              0.00082664561  42225.653      0              2.0389256e+09  1.1971759e-13  0              3.5233485    
    400000   18000          200            200            0.00014597722  5.5690717e-41  0              0.00043793167  13600.416      0              6.567154e+08   1.1971759e-13  0              3.5028642    
    500000   18000          200            200            0.0053499606  -7.1803823e-35  0              0.016049882    3741.9564      0              1.8068568e+08  1.1971759e-13  0              3.4986561    
    600000   18000          200            200            0.001947243   -1.7950956e-35  0              0.005841729    484.53076      0              23396256       1.1971759e-13  0              3.4993149    
    700000   18000          200            200            0.0035450675  -8.9754731e-36  0              0.010635202    73.678494      0              3557670.8      1.1971759e-13  0              3.4989891    
    800000   18000          200            200            0.0028488022   2.6926461e-35  0              0.0085464067   0.76012086     0              36703.516      1.1971759e-13  0              3.4991248    
    900000   18000          200            200            0.0031751039   8.0071868e-42  0              0.0095253117   1.1041434      0              53315.134      1.1971759e-13  0              3.4990587    
   1000000   18000          200            200            0.003284831   -4.4877355e-36  0              0.009854493    0.065510611    0              3163.2729      1.1971759e-13  0              3.4990373    
   1100000   18000          200            200            0.0032563479   3.4065263e-42  0              0.0097690436   0.010371503    0              500.80277      1.1971759e-13  0              3.499043     
   1200000   18000          200            200            0.0032379303  -4.4877411e-36  0              0.009713791    0.0023358534   0              112.79         1.1971759e-13  0              3.4990466    
   1300000   18000          200            200            0.0032390082  -1.1219355e-36  0              0.0097170246   4.0744944e-05  0              1.9674275      1.1971759e-13  0              3.4990463    
   1400000   18000          200            200            0.0032415857   7.012097e-37   0              0.0097247572   5.3025966e-05  0              2.5604341      1.1971759e-13  0              3.4990458    
   1500000   18000          200            200            0.0032418177  -5.6096775e-37  0              0.009725453    4.6479302e-08  0              0.0022443192   1.1971759e-13  0              3.4990458    
   1600000   18000          200            200            0.0032415123   5.0487098e-36  0              0.0097245368   8.5826199e-07  0              0.0414424      1.1971759e-13  0              3.4990459    
   1700000   18000          200            200            0.0032414375   1.1219355e-36  0              0.0097243125   2.6435454e-08  0              0.0012764734   1.1971759e-13  0              3.4990459    
   1800000   18000          200            200            0.0032414668   2.8048389e-37  0              0.0097244005   9.658569e-09   0              0.00046637773  1.1971759e-13  0              3.4990459    
   1900000   18000          200            200            0.0032414809   5.6096776e-37  0              0.0097244428   1.2690321e-09  0              6.127702e-05   1.1971759e-13  0              3.4990459    
   2000000   18000          200            200            0.0032414791   1.057557e-44   0              0.0097244373   6.0280352e-11  0              2.9107225e-06  1.1971759e-13  0              3.4990459    
   2100000   18000          200            200            0.003241477   -1.6829033e-36  0              0.009724431    3.3767077e-11  0              1.6304913e-06  1.1971759e-13  0              3.4990459    
   2200000   18000          200            200            0.0032414769  -2.8048387e-37  0              0.0097244308   3.227486e-14   0              1.5584375e-09  1.1971759e-13  0              3.4990459    
   2300000   18000          200            200            0.0032414772   5.6096776e-36  0              0.0097244316   6.2493893e-13  0              3.0176065e-08  1.1971759e-13  0              3.4990459    
   2400000   18000          200            200            0.0032414772   3.6462904e-36  0              0.0097244317   8.1975713e-15  0              3.9583138e-10  1.1971759e-13  0              3.4990459    
   2500000   18000          200            200            0.0032414772  -1.6829033e-36  0              0.0097244316   8.1758684e-15  0              3.9478342e-10  1.1971759e-13  0              3.4990459    
   2600000   18000          200            200            0.0032414772  -8.4145162e-37  0              0.0097244316   6.2739442e-16  0              3.0294631e-11  1.1971759e-13  0              3.4990459    
   2700000   18000          200            200            0.0032414772  -5.6096774e-37  0              0.0097244316   4.5020402e-18  0              2.1738741e-13  1.1971759e-13  0              3.4990459    
   2800000   18000          200            200            0.0032414772   8.4145164e-37  0              0.0097244316   6.0845069e-19  0              2.9379906e-14  1.1971759e-13  0              3.4990459    
   2900000   18000          200            200            0.0032414772  -8.4145162e-37  0              0.0097244316   1.1483994e-17  0              5.5452096e-13  1.1971759e-13  0              3.4990459    
   3000000   18000          200            200            0.0032414772   1.6829033e-36  0              0.0097244316   1.2443803e-17  0              6.0086673e-13  1.1971759e-13  0              3.4990459    
Loop time of 777.672 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3333024.659 ns/day, 0.000 hours/ns, 3857.667 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.04     | 245.1      | 247.15     |  13.1 | 31.52
Neigh   | 8.9521     | 8.9526     | 8.953      |   0.0 |  1.15
Comm    | 29.535     | 31.712     | 33.889     |  38.7 |  4.08
Output  | 0.6203     | 0.62031    | 0.62033    |   0.0 |  0.08
Modify  | 430.67     | 430.74     | 430.8      |   0.3 | 55.39
Other   |            | 60.55      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.01                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 74.2770113639572
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.11
  ghost atom cutoff = 4.11
  binsize = 2.055, bins = 8760 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 190.4 | 190.4 | 190.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00026868317 -7.1803807e-35  0             -0.0008060495   996325.11      0              4.8108974e+10  1.1971759e-13  0              3.6529957    
    200000   18000          200            200           -9.0785908e-05  6.4840977e-41  0             -0.00027235772  6498.5492      0              3.1379169e+08  1.1971759e-13  0              3.6733287    
    300000   18000          200            200            0.00028699479  5.6854635e-41  0              0.00086098437  45274.791      0              2.1861576e+09  1.1971759e-13  0              3.5266916    
    400000   18000          200            200            0.00015721981 -1.0411561e-33  0              0.00047165942  15555.583      0              7.5112341e+08  1.1971759e-13  0              3.5068429    
    500000   18000          200            200            0.0023701777   1.7951018e-35  0              0.0071105331   3929.9016      0              1.8976088e+08  1.1971759e-13  0              3.5042117    
    600000   18000          200            200            0.0012042935  -1.7950952e-35  0              0.0036128806   291.02335      0              14052476       1.1971759e-13  0              3.5045023    
    700000   18000          200            200            0.0039880729   1.1216333e-41  0              0.011964219    47.328805      0              2285338.6      1.1971759e-13  0              3.5039073    
    800000   18000          200            200            0.0029399786  -2.6926442e-35  0              0.0088199359   4.5317471      0              218821.85      1.1971759e-13  0              3.5041077    
    900000   18000          200            200            0.003124276   -4.4877341e-36  0              0.0093728281   0.46499961     0              22453.167      1.1971759e-13  0              3.5040701    
   1000000   18000          200            200            0.0032664934  -4.4877355e-36  0              0.0097994803   0.15365676     0              7419.5351      1.1971759e-13  0              3.5040421    
   1100000   18000          200            200            0.0032656754  -1.3463223e-35  0              0.0097970262   0.00051820182  0              25.022111      1.1971759e-13  0              3.5040424    
   1200000   18000          200            200            0.0032468014   6.731614e-36   0              0.0097404042   0.0030744349   0              148.45346      1.1971759e-13  0              3.5040461    
   1300000   18000          200            200            0.0032436584  -1.1219355e-36  0              0.0097309751   4.3727229e-05  0              2.1114314      1.1971759e-13  0              3.5040467    
   1400000   18000          200            200            0.0032455935  -3.0853226e-36  0              0.0097367806   3.7773302e-05  0              1.8239376      1.1971759e-13  0              3.5040463    
   1500000   18000          200            200            0.0032463425  -2.8048387e-37  0              0.0097390274   3.7425272e-06  0              0.18071324     1.1971759e-13  0              3.5040462    
   1600000   18000          200            200            0.0032462177   1.6829033e-36  0              0.009738653    2.2384459e-07  0              0.010808654    1.1971759e-13  0              3.5040462    
   1700000   18000          200            200            0.0032460976  -2.8048387e-37  0              0.0097382927   1.1315563e-07  0              0.0054638802   1.1971759e-13  0              3.5040462    
   1800000   18000          200            200            0.0032460932   1.0444131e-44  0              0.0097382795   1.5529296e-11  0              7.498541e-07   1.1971759e-13  0              3.5040462    
   1900000   18000          200            200            0.0032461082   2.8048389e-37  0              0.0097383246   2.0179029e-09  0              9.7437309e-05  1.1971759e-13  0              3.5040462    
   2000000   18000          200            200            0.0032461114  -2.8048387e-37  0              0.0097383342   5.2762789e-11  0              2.5477263e-06  1.1971759e-13  0              3.5040462    
   2100000   18000          200            200            0.00324611     2.8048389e-37  0              0.0097383299   2.1611702e-11  0              1.0435517e-06  1.1971759e-13  0              3.5040462    
   2200000   18000          200            200            0.0032461093   2.5243549e-36  0              0.0097383279   3.1031247e-12  0              1.4983878e-07  1.1971759e-13  0              3.5040462    
   2300000   18000          200            200            0.0032461094  -5.6096774e-37  0              0.0097383281   9.4445014e-14  0              4.5604117e-09  1.1971759e-13  0              3.5040462    
   2400000   18000          200            200            0.0032461095  -1.3463226e-35  0              0.0097383284   8.1072709e-14  0              3.9147109e-09  1.1971759e-13  0              3.5040462    
   2500000   18000          200            200            0.0032461095  -5.6096774e-37  0              0.0097383284   8.2444269e-17  0              3.9809387e-12  1.1971759e-13  0              3.5040462    
   2600000   18000          200            200            0.0032461095   8.4145164e-37  0              0.0097383284   1.2425014e-15  0              5.9995944e-11  1.1971759e-13  0              3.5040462    
   2700000   18000          200            200            0.0032461095  -8.4145162e-37  0              0.0097383284   1.5640587e-16  0              7.5522798e-12  1.1971759e-13  0              3.5040462    
   2800000   18000          200            200            0.0032461095   2.8048389e-37  0              0.0097383284   2.2868971e-17  0              1.1042608e-12  1.1971759e-13  0              3.5040462    
   2900000   18000          200            200            0.0032461095  -8.4145162e-37  0              0.0097383284   3.2052533e-18  0              1.5477021e-13  1.1971759e-13  0              3.5040462    
   3000000   18000          200            200            0.0032461095   2.8048389e-37  0              0.0097383284   5.5287517e-18  0              2.6696363e-13  1.1971759e-13  0              3.5040462    
Loop time of 776.677 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3337293.199 ns/day, 0.000 hours/ns, 3862.608 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.48     | 244.72     | 247.96     |  20.7 | 31.51
Neigh   | 9.3481     | 9.3483     | 9.3485     |   0.0 |  1.20
Comm    | 30.089     | 33.51      | 36.931     |  59.1 |  4.31
Output  | 0.61966    | 0.61967    | 0.61968    |   0.0 |  0.08
Modify  | 428.9      | 429        | 429.09     |   0.5 | 55.23
Other   |            | 59.48      |            |       |  7.66

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.02                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 74.8340866367129
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.12
  ghost atom cutoff = 4.12
  binsize = 2.06, bins = 8738 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 190 | 190 | 190 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00027634111  3.5902018e-35  0             -0.00082902332  982420.03      0              4.7437547e+10  1.1971759e-13  0              3.6626434    
    200000   18000          200            200           -8.3446924e-05 -7.1803794e-35  0             -0.00025034077  5409.3291      0              2.6119714e+08  1.1971759e-13  0              3.6787723    
    300000   18000          200            200            0.00029853889 -5.3852839e-35  0              0.00089561667  48426.787      0              2.3383562e+09  1.1971759e-13  0              3.5299745    
    400000   18000          200            200            0.00016858807 -5.3852838e-35  0              0.00050576421  17639.365      0              8.5174181e+08  1.1971759e-13  0              3.5107511    
    500000   18000          200            200            0.00037650512 -8.9754789e-35  0              0.0011295154   3279.5273      0              1.5835664e+08  1.1971759e-13  0              3.5097488    
    600000   18000          200            200            0.00076163594 -1.7950966e-34  0              0.0022849078   107.38989      0              5185473.4      1.1971759e-13  0              3.5096339    
    700000   18000          200            200            0.004309388    1.7950979e-35  0              0.012928164    15.487778      0              747849.36      1.1971759e-13  0              3.5088502    
    800000   18000          200            200            0.0030930535   5.3852914e-35  0              0.0092791604   8.785366       0              424213.88      1.1971759e-13  0              3.5090783    
    900000   18000          200            200            0.0031024676   1.3463234e-35  0              0.0093074028   0.023318641    0              1125.9737      1.1971759e-13  0              3.5090757    
   1000000   18000          200            200            0.0032425172   1.3463233e-35  0              0.0097275515   0.17488652     0              8444.644       1.1971759e-13  0              3.5090481    
   1100000   18000          200            200            0.0032687081   4.4877454e-36  0              0.0098061243   0.0040155472   0              193.8964       1.1971759e-13  0              3.509043     
   1200000   18000          200            200            0.0032554199   2.2438719e-36  0              0.0097662596   0.0017877472   0              86.323913      1.1971759e-13  0              3.5090456    
   1300000   18000          200            200            0.0032493213   3.9267743e-36  0              0.009747964    0.00028335915  0              13.682399      1.1971759e-13  0              3.5090468    
   1400000   18000          200            200            0.0032498407   2.5400422e-45  0              0.0097495221   4.7182497e-06  0              0.22782739     1.1971759e-13  0              3.5090467    
   1500000   18000          200            200            0.0032507472  -2.8048387e-37  0              0.0097522416   7.0276157e-06  0              0.33933841     1.1971759e-13  0              3.5090465    
   1600000   18000          200            200            0.0032508613   3.9267743e-36  0              0.009752584    6.1389793e-08  0              0.0029642934   1.1971759e-13  0              3.5090465    
   1700000   18000          200            200            0.0032507651  -5.6096774e-37  0              0.0097522952   8.9264963e-08  0              0.0043102856   1.1971759e-13  0              3.5090465    
   1800000   18000          200            200            0.0032507307   1.6829033e-36  0              0.0097521921   8.5941259e-09  0              0.00041497958  1.1971759e-13  0              3.5090465    
   1900000   18000          200            200            0.0032507364  -1.3182742e-35  0              0.0097522093   4.2588858e-10  0              2.0564635e-05  1.1971759e-13  0              3.5090465    
   2000000   18000          200            200            0.0032507421  -8.4145162e-37  0              0.0097522263   2.6719016e-10  0              1.2901657e-05  1.1971759e-13  0              3.5090465    
   2100000   18000          200            200            0.0032507425  -5.6096774e-37  0              0.0097522275   3.312574e-13   0              1.5995234e-08  1.1971759e-13  0              3.5090465    
   2200000   18000          200            200            0.0032507418   2.8048389e-37  0              0.0097522255   4.1364084e-12  0              1.9973236e-07  1.1971759e-13  0              3.5090465    
   2300000   18000          200            200            0.0032507416   2.8048389e-37  0              0.0097522249   2.3635857e-13  0              1.1412909e-08  1.1971759e-13  0              3.5090465    
   2400000   18000          200            200            0.0032507417  -2.8048387e-37  0              0.0097522251   2.8504209e-14  0              1.3763662e-09  1.1971759e-13  0              3.5090465    
   2500000   18000          200            200            0.0032507417   2.8048389e-37  0              0.0097522252   9.65718e-15    0              4.6631066e-10  1.1971759e-13  0              3.5090465    
   2600000   18000          200            200            0.0032507417   1.6829033e-36  0              0.0097522252   1.2937588e-17  0              6.2470983e-13  1.1971759e-13  0              3.5090465    
   2700000   18000          200            200            0.0032507417   5.6096776e-37  0              0.0097522252   1.0647851e-16  0              5.1414661e-12  1.1971759e-13  0              3.5090465    
   2800000   18000          200            200            0.0032507417   8.4145164e-37  0              0.0097522252   1.0499703e-17  0              5.0699307e-13  1.1971759e-13  0              3.5090465    
   2900000   18000          200            200            0.0032507417  -5.6096774e-37  0              0.0097522252   1.497706e-17   0              7.231886e-13   1.1971759e-13  0              3.5090465    
   3000000   18000          200            200            0.0032507417  -8.4145162e-37  0              0.0097522252   6.1510078e-18  0              2.9701015e-13  1.1971759e-13  0              3.5090465    
Loop time of 777.969 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3331751.900 ns/day, 0.000 hours/ns, 3856.194 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 244.9      | 246.73     | 248.57     |  11.7 | 31.72
Neigh   | 8.55       | 8.5506     | 8.5512     |   0.0 |  1.10
Comm    | 28.2       | 30.175     | 32.149     |  35.9 |  3.88
Output  | 0.62161    | 0.62162    | 0.62162    |   0.0 |  0.08
Modify  | 430.33     | 430.57     | 430.8      |   1.1 | 55.34
Other   |            | 61.32      |            |       |  7.88

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.03                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 75.3939403340114
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.13
  ghost atom cutoff = 4.13
  binsize = 2.065, bins = 8717 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 186.2 | 186.2 | 186.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00028385194  1.4360791e-34  0             -0.00085155583  968621.09      0              4.6771246e+10  1.1971759e-13  0              3.6722602    
    200000   18000          200            200           -7.5996383e-05  9.1080046e-41  0             -0.00022798915  4420.8189      0              2.1346552e+08  1.1971759e-13  0              3.6841678    
    300000   18000          200            200            0.00031017895  3.5902006e-35  0              0.00093053685  51680.976      0              2.4954894e+09  1.1971759e-13  0              3.5331972    
    400000   18000          200            200            0.0011018465  -5.3852837e-35  0              0.0033055394   19757.147      0              9.5400194e+08  1.1971759e-13  0              3.5145894    
    500000   18000          200            200           -5.3520936e-05  1.7951014e-35  0             -0.00016056281  2346.7185      0              1.1331464e+08  1.1971759e-13  0              3.51522      
    600000   18000          200            200            0.00058025236 -1.7053418e-34  0              0.0017407571   7.5772374      0              365877.68      1.1971759e-13  0              3.514697     
    700000   18000          200            200            0.0044381648  -8.9754735e-36  0              0.013314495    0.071359923    0              3445.7153      1.1971759e-13  0              3.5138281    
    800000   18000          200            200            0.0032806984  -8.9754742e-36  0              0.0098420951   10.26799       0              495804.5       1.1971759e-13  0              3.5140427    
    900000   18000          200            200            0.0031157226   4.9365171e-35  0              0.0093471679   0.16895479     0              8158.2221      1.1971759e-13  0              3.5140744    
   1000000   18000          200            200            0.0032209079   5.3852911e-35  0              0.0096627238   0.10750592     0              5191.0761      1.1971759e-13  0              3.5140535    
   1100000   18000          200            200            0.0032659665  -5.3852901e-35  0              0.0097978994   0.016607238    0              801.90407      1.1971759e-13  0              3.5140448    
   1200000   18000          200            200            0.0032623269  -4.4877411e-36  0              0.0097869808   0.00018834529  0              9.0945201      1.1971759e-13  0              3.5140455    
   1300000   18000          200            200            0.0032555701  -2.8048387e-36  0              0.0097667104   0.0004031936   0              19.468776      1.1971759e-13  0              3.5140468    
   1400000   18000          200            200            0.0032545048  -1.4024194e-37  0              0.0097635143   7.7792387e-06  0              0.3756316      1.1971759e-13  0              3.514047     
   1500000   18000          200            200            0.0032551493   8.4145164e-37  0              0.0097654479   4.0101592e-06  0              0.19363624     1.1971759e-13  0              3.5140469    
   1600000   18000          200            200            0.0032554369  -2.8048387e-37  0              0.0097663107   6.805217e-07   0              0.032859957    1.1971759e-13  0              3.5140469    
   1700000   18000          200            200            0.0032554179  -5.6096774e-37  0              0.0097662538   5.5698688e-09  0              0.00026894903  1.1971759e-13  0              3.5140469    
   1800000   18000          200            200            0.0032553758  -8.4145162e-37  0              0.0097661273   1.5765782e-08  0              0.00076127321  1.1971759e-13  0              3.5140469    
   1900000   18000          200            200            0.0032553686  -3.6462904e-36  0              0.0097661058   3.5761025e-10  0              1.7267719e-05  1.1971759e-13  0              3.5140469    
   2000000   18000          200            200            0.0032553725  -1.2060807e-35  0              0.0097661175   1.4851523e-10  0              7.1712688e-06  1.1971759e-13  0              3.5140469    
   2100000   18000          200            200            0.0032553744   5.6096777e-37  0              0.0097661231   2.7831841e-11  0              1.3439e-06     1.1971759e-13  0              3.5140469    
   2200000   18000          200            200            0.0032553743  -5.6096774e-37  0              0.0097661228   1.5675463e-13  0              7.5691199e-09  1.1971759e-13  0              3.5140469    
   2300000   18000          200            200            0.003255374   -2.5243549e-36  0              0.009766122    6.1617439e-13  0              2.9752856e-08  1.1971759e-13  0              3.5140469    
   2400000   18000          200            200            0.0032553739  -3.0853226e-36  0              0.0097661218   1.607707e-14   0              7.7630419e-10  1.1971759e-13  0              3.5140469    
   2500000   18000          200            200            0.003255374   -1.1219355e-36  0              0.0097661219   5.7620354e-15  0              2.7822807e-10  1.1971759e-13  0              3.5140469    
   2600000   18000          200            200            0.003255374    4.7682259e-36  0              0.0097661219   1.1340341e-15  0              5.4758448e-11  1.1971759e-13  0              3.5140469    
   2700000   18000          200            200            0.003255374    2.5243549e-36  0              0.0097661219   3.6973283e-17  0              1.7853075e-12  1.1971759e-13  0              3.5140469    
   2800000   18000          200            200            0.003255374   -2.8048387e-37  0              0.0097661219   7.1839473e-18  0              3.468871e-13   1.1971759e-13  0              3.5140469    
   2900000   18000          200            200            0.003255374   -5.6096774e-37  0              0.0097661219   1.5237304e-18  0              7.3575486e-14  1.1971759e-13  0              3.5140469    
   3000000   18000          200            200            0.003255374   -5.6096774e-37  0              0.0097661219   3.5275939e-18  0              1.7033489e-13  1.1971759e-13  0              3.5140469    
Loop time of 772.402 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3355765.677 ns/day, 0.000 hours/ns, 3883.988 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 245.31     | 245.53     | 245.74     |   1.4 | 31.79
Neigh   | 8.1569     | 8.1574     | 8.1579     |   0.0 |  1.06
Comm    | 29.332     | 29.68      | 30.028     |   6.4 |  3.84
Output  | 0.62249    | 0.6225     | 0.6225     |   0.0 |  0.08
Modify  | 428.73     | 428.82     | 428.9      |   0.4 | 55.52
Other   |            | 59.59      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.04                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 75.9565793673566
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.14
  ghost atom cutoff = 4.14
  binsize = 2.07, bins = 8696 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 185.7 | 185.7 | 185.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00029121594  1.171506e-40   0             -0.00087364783  954928.4       0              4.6110075e+10  1.1971759e-13  0              3.6818461    
    200000   18000          200            200           -6.8435182e-05  3.5901992e-35  0             -0.00020530555  3532.7718      0              1.7058491e+08  1.1971759e-13  0              3.6895151    
    300000   18000          200            200            0.00032191431 -1.7950919e-35  0              0.00096574294  55037.033      0              2.6575414e+09  1.1971759e-13  0              3.5363594    
    400000   18000          200            200            0.0073454241  -1.7950922e-35  0              0.022036272    19294.689      0              9.3167149e+08  1.1971759e-13  0              3.5183892    
    500000   18000          200            200           -4.3930201e-05  4.5584147e-41  0             -0.0001317906   1551.5239      0              74917535       1.1971759e-13  0              3.5206117    
    600000   18000          200            200            0.0006219922  -8.975469e-36   0              0.0018659766   25.729581      0              1242389.4      1.1971759e-13  0              3.5196862    
    700000   18000          200            200            0.0043447565  -8.9754751e-36  0              0.01303427     11.864197      0              572879.63      1.1971759e-13  0              3.5188454    
    800000   18000          200            200            0.0034666495   8.9754941e-36  0              0.010399949    7.7886841      0              376087.68      1.1971759e-13  0              3.519008     
    900000   18000          200            200            0.0031621231   8.9754924e-36  0              0.0094863694   0.767511       0              37060.359      1.1971759e-13  0              3.5190666    
   1000000   18000          200            200            0.0032089291   4.4877487e-36  0              0.0096267874   0.021536733    0              1039.9318      1.1971759e-13  0              3.5190572    
   1100000   18000          200            200            0.0032598308  -8.9754809e-36  0              0.0097794923   0.023357678    0              1127.8587      1.1971759e-13  0              3.5190472    
   1200000   18000          200            200            0.0032666921  -1.1219354e-35  0              0.0098000763   0.00038984138  0              18.824045      1.1971759e-13  0              3.5190459    
   1300000   18000          200            200            0.0032617376   1.1219356e-36  0              0.0097852129   0.00022647563  0              10.935698      1.1971759e-13  0              3.5190469    
   1400000   18000          200            200            0.0032595701   1.4024194e-37  0              0.0097787104   4.1551141e-05  0              2.0063559      1.1971759e-13  0              3.5190473    
   1500000   18000          200            200            0.003259667    9.5117792e-45  0              0.0097790009   1.0868152e-07  0              0.0052478414   1.1971759e-13  0              3.5190473    
   1600000   18000          200            200            0.0032599768   8.4145164e-37  0              0.0097799303   8.6874229e-07  0              0.041948456    1.1971759e-13  0              3.5190472    
   1700000   18000          200            200            0.0032600433   2.8048388e-36  0              0.0097801299   3.8071975e-08  0              0.0018383594   1.1971759e-13  0              3.5190472    
   1800000   18000          200            200            0.0032600196  -2.8048387e-37  0              0.0097800588   5.2782967e-09  0              0.00025487006  1.1971759e-13  0              3.5190472    
   1900000   18000          200            200            0.0032600048   1.0201275e-44  0              0.0097800143   1.9579559e-09  0              9.4542684e-05  1.1971759e-13  0              3.5190472    
   2000000   18000          200            200            0.0032600041  -2.8048387e-37  0              0.0097800123   3.1257495e-12  0              1.5093126e-07  1.1971759e-13  0              3.5190472    
   2100000   18000          200            200            0.0032600059  -2.8048387e-37  0              0.0097800176   2.8810442e-11  0              1.3911531e-06  1.1971759e-13  0              3.5190472    
   2200000   18000          200            200            0.0032600064   1.0453468e-44  0              0.0097800193   2.5775064e-12  0              1.2445856e-07  1.1971759e-13  0              3.5190472    
   2300000   18000          200            200            0.0032600063  -2.8048387e-37  0              0.009780019    8.6779174e-14  0              4.1902557e-09  1.1971759e-13  0              3.5190472    
   2400000   18000          200            200            0.0032600062  -5.6096774e-37  0              0.0097800187   8.2017318e-14  0              3.9603228e-09  1.1971759e-13  0              3.5190472    
   2500000   18000          200            200            0.0032600062   2.8048389e-37  0              0.0097800187   1.2685578e-15  0              6.1254116e-11  1.1971759e-13  0              3.5190472    
   2600000   18000          200            200            0.0032600062   2.8048389e-37  0              0.0097800187   7.9311411e-16  0              3.8296642e-11  1.1971759e-13  0              3.5190472    
   2700000   18000          200            200            0.0032600062   1.0010363e-44  0              0.0097800187   1.8521873e-16  0              8.9435496e-12  1.1971759e-13  0              3.5190472    
   2800000   18000          200            200            0.0032600062  -5.6096774e-37  0              0.0097800187   1.9885148e-17  0              9.6018264e-13  1.1971759e-13  0              3.5190472    
   2900000   18000          200            200            0.0032600062   2.8048389e-37  0              0.0097800187   1.4529912e-17  0              7.0159747e-13  1.1971759e-13  0              3.5190472    
   3000000   18000          200            200            0.0032600062  -2.8048387e-37  0              0.0097800187   4.1350003e-18  0              1.9966436e-13  1.1971759e-13  0              3.5190472    
Loop time of 779.363 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3325794.819 ns/day, 0.000 hours/ns, 3849.300 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.49     | 246.11     | 248.73     |  16.7 | 31.58
Neigh   | 8.282      | 8.2823     | 8.2826     |   0.0 |  1.06
Comm    | 27.997     | 30.827     | 33.656     |  51.0 |  3.96
Output  | 0.62619    | 0.62622    | 0.62626    |   0.0 |  0.08
Modify  | 431.16     | 431.26     | 431.36     |   0.5 | 55.33
Other   |            | 62.26      |            |       |  7.99

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.05                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 76.5220106482522
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.15
  ghost atom cutoff = 4.15
  binsize = 2.075, bins = 8675 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 185.3 | 185.3 | 185.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00029843387  1.5809207e-40  0             -0.00089530162  941340.89      0              4.5453983e+10  1.1971759e-13  0              3.6914012    
    200000   18000          200            200           -6.0763523e-05  4.2796305e-41  0             -0.00018229057  2744.8599      0              1.3253946e+08  1.1971759e-13  0              3.6948142    
    300000   18000          200            200            0.00033374427 -1.7950922e-35  0              0.0010012328   58494.624      0              2.824496e+09   1.1971759e-13  0              3.5394611    
    400000   18000          200            200            0.015880401   -3.5901882e-35  0              0.047641202    13752.007      0              6.6403521e+08  1.1971759e-13  0              3.5222821    
    500000   18000          200            200           -3.4170344e-05 -1.7950923e-35  0             -0.00010251103  921.11346      0              44477273       1.1971759e-13  0              3.5259232    
    600000   18000          200            200            0.00089541249 -1.7950951e-35  0              0.0026862375   155.24712      0              7496327.8      1.1971759e-13  0              3.5246023    
    700000   18000          200            200            0.0040511716  -4.487741e-35   0              0.012153515    42.314134      0              2043198.1      1.1971759e-13  0              3.5238987    
    800000   18000          200            200            0.0036122468   1.7950978e-35  0              0.01083674     3.2355572      0              156233.48      1.1971759e-13  0              3.5239815    
    900000   18000          200            200            0.0032321286   1.3463234e-35  0              0.0096963857   1.2806628      0              61838.625      1.1971759e-13  0              3.5240541    
   1000000   18000          200            200            0.0032111489   5.3852911e-35  0              0.0096334466   0.0055546133   0              268.2124       1.1971759e-13  0              3.524058     
   1100000   18000          200            200            0.0032537639  -9.424258e-35   0              0.0097612918   0.016325125    0              788.28186      1.1971759e-13  0              3.5240496    
   1200000   18000          200            200            0.0032686157   8.4845827e-43  0              0.0098058472   0.0021064456   0              101.71272      1.1971759e-13  0              3.5240468    
   1300000   18000          200            200            0.0032671914   8.4145168e-37  0              0.0098015743   1.4813382e-05  0              0.7152852      1.1971759e-13  0              3.524047     
   1400000   18000          200            200            0.0032648363   8.4145163e-37  0              0.009794509    5.0720113e-05  0              2.4490927      1.1971759e-13  0              3.5240475    
   1500000   18000          200            200            0.0032643587  -3.3658065e-36  0              0.009793076    2.2661467e-06  0              0.10942411     1.1971759e-13  0              3.5240476    
   1600000   18000          200            200            0.0032645334   1.0263764e-44  0              0.0097936003   2.6150074e-07  0              0.012626935    1.1971759e-13  0              3.5240476    
   1700000   18000          200            200            0.0032646456  -8.4145162e-37  0              0.0097939368   1.1723933e-07  0              0.0056610675   1.1971759e-13  0              3.5240475    
   1800000   18000          200            200            0.0032646543   2.8048389e-37  0              0.009793963    8.6786156e-10  0              4.1905929e-05  1.1971759e-13  0              3.5240475    
   1900000   18000          200            200            0.003264642    1.4024194e-36  0              0.0097939261   1.3474456e-09  0              6.5063328e-05  1.1971759e-13  0              3.5240475    
   2000000   18000          200            200            0.0032646374   3.9267743e-36  0              0.0097939122   2.0281357e-10  0              9.7931414e-06  1.1971759e-13  0              3.5240475    
   2100000   18000          200            200            0.0032646377  -2.8048387e-37  0              0.0097939132   6.492973e-13   0              3.1352243e-08  1.1971759e-13  0              3.5240475    
   2200000   18000          200            200            0.0032646384  -1.6829033e-36  0              0.0097939152   4.4148216e-12  0              2.1317594e-07  1.1971759e-13  0              3.5240475    
   2300000   18000          200            200            0.0032646386   5.8901614e-36  0              0.0097939157   2.3783185e-13  0              1.1484049e-08  1.1971759e-13  0              3.5240475    
   2400000   18000          200            200            0.0032646385   1.0441973e-44  0              0.0097939156   1.9328024e-14  0              9.3328111e-10  1.1971759e-13  0              3.5240475    
   2500000   18000          200            200            0.0032646385   2.8048389e-37  0              0.0097939155   1.0670614e-14  0              5.1524574e-10  1.1971759e-13  0              3.5240475    
   2600000   18000          200            200            0.0032646385   5.6096776e-37  0              0.0097939155   1.514742e-16   0              7.3141471e-12  1.1971759e-13  0              3.5240475    
   2700000   18000          200            200            0.0032646385  -1.4024194e-36  0              0.0097939155   1.3193427e-17  0              6.3706336e-13  1.1971759e-13  0              3.5240475    
   2800000   18000          200            200            0.0032646385  -1.1219355e-36  0              0.0097939155   3.9870465e-19  0              1.9252021e-14  1.1971759e-13  0              3.5240475    
   2900000   18000          200            200            0.0032646385   4.7682259e-36  0              0.0097939155   1.3418e-17     0              6.4790721e-13  1.1971759e-13  0              3.5240475    
   3000000   18000          200            200            0.0032646385  -5.0487098e-36  0              0.0097939155   1.0652523e-17  0              5.1437219e-13  1.1971759e-13  0              3.5240475    
Loop time of 772.349 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3355994.031 ns/day, 0.000 hours/ns, 3884.252 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.8      | 243.47     | 246.15     |  17.1 | 31.52
Neigh   | 8.139      | 8.1392     | 8.1394     |   0.0 |  1.05
Comm    | 28.763     | 31.251     | 33.739     |  44.5 |  4.05
Output  | 0.63731    | 0.63733    | 0.63735    |   0.0 |  0.08
Modify  | 428.26     | 428.37     | 428.47     |   0.5 | 55.46
Other   |            | 60.49      |            |       |  7.83

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.06                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 77.0902410882023
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.16
  ghost atom cutoff = 4.16
  binsize = 2.08, bins = 8654 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 184.9 | 184.9 | 184.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00030550616 -1.7950892e-35  0             -0.00091651847  927858.26      0              4.4802955e+10  1.1971759e-13  0              3.7009255    
    200000   18000          200            200           -5.2981352e-05 -1.7950892e-35  0             -0.00015894406  2056.7587      0              99313517       1.1971759e-13  0              3.7000649    
    300000   18000          200            200            0.00034566992 -1.7950895e-35  0              0.0010370098   62053.974      0              2.9963643e+09  1.1971759e-13  0              3.5425018    
    400000   18000          200            200            0.023581528   -3.5901875e-35  0              0.070744585    5424.4244      0              2.6192604e+08  1.1971759e-13  0              3.5264531    
    500000   18000          200            200           -2.4240417e-05  5.385295e-35   0             -7.272125e-05   454.63392      0              21952645       1.1971759e-13  0              3.5311545    
    600000   18000          200            200            0.0014470041   2.6926471e-35  0              0.0043410123   348.53507      0              16829511       1.1971759e-13  0              3.5294527    
    700000   18000          200            200            0.003623696    4.4877431e-35  0              0.010871088    70.022478      0              3381134.8      1.1971759e-13  0              3.5289784    
    800000   18000          200            200            0.0036856754   1.7950978e-35  0              0.011057026    0.1849705      0              8931.5634      1.1971759e-13  0              3.5289687    
    900000   18000          200            200            0.0033104511   8.9754927e-36  0              0.0099313533   1.2448805      0              60110.826      1.1971759e-13  0              3.5290401    
   1000000   18000          200            200            0.0032282338   6.7549988e-42  0              0.0096847014   0.075346283    0              3638.2024      1.1971759e-13  0              3.5290559    
   1100000   18000          200            200            0.0032511891   8.9754873e-36  0              0.0097535674   0.0038332149   0              185.09223      1.1971759e-13  0              3.5290514    
   1200000   18000          200            200            0.0032690897   4.4877429e-36  0              0.009807269    0.0030512334   0              147.33314      1.1971759e-13  0              3.5290479    
   1300000   18000          200            200            0.0032715945   4.5765657e-44  0              0.0098147835   7.9082658e-05  0              3.8186185      1.1971759e-13  0              3.5290474    
   1400000   18000          200            200            0.0032700111   1.6829033e-36  0              0.0098100334   2.0440308e-05  0              0.98698931     1.1971759e-13  0              3.5290477    
   1500000   18000          200            200            0.0032691936   9.1044314e-45  0              0.0098075807   6.5743081e-06  0              0.31744981     1.1971759e-13  0              3.5290479    
   1600000   18000          200            200            0.0032691496   2.8048389e-37  0              0.0098074487   3.8593436e-08  0              0.0018635389   1.1971759e-13  0              3.5290479    
   1700000   18000          200            200            0.0032692435   1.0270615e-44  0              0.0098077305   7.6497248e-08  0              0.0036937783   1.1971759e-13  0              3.5290479    
   1800000   18000          200            200            0.0032692783   1.0423249e-44  0              0.0098078348   1.2356215e-08  0              0.00059663739  1.1971759e-13  0              3.5290479    
   1900000   18000          200            200            0.0032692766   8.4145164e-37  0              0.0098078299   4.3241924e-12  0              2.0879977e-07  1.1971759e-13  0              3.5290479    
   2000000   18000          200            200            0.0032692716   1.4024194e-36  0              0.0098078147   2.3283055e-10  0              1.1242554e-05  1.1971759e-13  0              3.5290479    
   2100000   18000          200            200            0.0032692702   2.8048389e-37  0              0.0098078107   1.9659619e-11  0              9.4929263e-07  1.1971759e-13  0              3.5290479    
   2200000   18000          200            200            0.0032692705  -8.4145162e-37  0              0.0098078114   4.0709118e-13  0              1.9656976e-08  1.1971759e-13  0              3.5290479    
   2300000   18000          200            200            0.0032692707  -1.6829033e-36  0              0.0098078122   6.0830865e-13  0              2.9373048e-08  1.1971759e-13  0              3.5290479    
   2400000   18000          200            200            0.0032692708   8.4145164e-37  0              0.0098078123   2.4849133e-14  0              1.1998757e-09  1.1971759e-13  0              3.5290479    
   2500000   18000          200            200            0.0032692708   1.0406103e-44  0              0.0098078123   3.0329696e-15  0              1.4645125e-10  1.1971759e-13  0              3.5290479    
   2600000   18000          200            200            0.0032692707  -5.6096774e-37  0              0.0098078122   1.3953876e-15  0              6.7378275e-11  1.1971759e-13  0              3.5290479    
   2700000   18000          200            200            0.0032692707  -2.8048387e-37  0              0.0098078122   1.0904852e-16  0              5.2655626e-12  1.1971759e-13  0              3.5290479    
   2800000   18000          200            200            0.0032692707  -2.8048387e-37  0              0.0098078122   1.8494865e-17  0              8.9305086e-13  1.1971759e-13  0              3.5290479    
   2900000   18000          200            200            0.0032692707  -5.6096775e-37  0              0.0098078122   3.3391091e-18  0              1.6123363e-13  1.1971759e-13  0              3.5290479    
   3000000   18000          200            200            0.0032692707  -1.1219355e-36  0              0.0098078122   3.6036884e-19  0              1.7400922e-14  1.1971759e-13  0              3.5290479    
Loop time of 772.814 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3353975.864 ns/day, 0.000 hours/ns, 3881.917 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.04     | 242.65     | 243.25     |   3.9 | 31.40
Neigh   | 8.2026     | 8.2026     | 8.2026     |   0.0 |  1.06
Comm    | 28.99      | 29.881     | 30.771     |  16.3 |  3.87
Output  | 0.61992    | 0.61994    | 0.61996    |   0.0 |  0.08
Modify  | 431.2      | 431.47     | 431.74     |   1.3 | 55.83
Other   |            | 59.99      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.07                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 77.6612775987105
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.17
  ghost atom cutoff = 4.17
  binsize = 2.085, bins = 8634 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 181.2 | 181.2 | 181.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00031243299  1.3269322e-40  0             -0.00093729897  914480.83      0              4.4157006e+10  1.1971759e-13  0              3.7104187    
    200000   18000          200            200           -4.5090133e-05 -3.5901869e-35  0             -0.0001352704   1468.2818      0              70898074       1.1971759e-13  0              3.7052672    
    300000   18000          200            200            0.00035768812  1.795102e-35   0              0.0010730644   65714.017      0              3.1730947e+09  1.1971759e-13  0              3.5454818    
    400000   18000          200            200            0.027456884   -1.7950909e-35  0              0.082370652    204.21358      0              9860742.9      1.1971759e-13  0              3.5310706    
    500000   18000          200            200           -1.4145121e-05 -3.5901888e-35  0             -4.2435364e-05  151.51696      0              7316211.5      1.1971759e-13  0              3.5363054    
    600000   18000          200            200            0.0023058164   8.0779376e-35  0              0.0069174493   521.20123      0              25166942       1.1971759e-13  0              3.5342525    
    700000   18000          200            200            0.0031515637   1.015813e-41   0              0.009454691    76.451593      0              3691573.8      1.1971759e-13  0              3.5340701    
    800000   18000          200            200            0.003670722   -1.7950959e-35  0              0.011012166    1.0536749      0              50878.188      1.1971759e-13  0              3.5339725    
    900000   18000          200            200            0.003379324    1.7950977e-35  0              0.010137972    0.6901895      0              33326.781      1.1971759e-13  0              3.5340281    
   1000000   18000          200            200            0.0032567707   6.8428225e-42  0              0.009770312    0.15807313     0              7632.7857      1.1971759e-13  0              3.5340516    
   1100000   18000          200            200            0.003254405   -2.2438707e-35  0              0.0097632151   0.00055275534  0              26.690577      1.1971759e-13  0              3.534052     
   1200000   18000          200            200            0.0032696327   8.2399949e-43  0              0.0098088982   0.0019753418   0              95.382184      1.1971759e-13  0              3.534049     
   1300000   18000          200            200            0.0032750427  -8.4145159e-37  0              0.009825128    0.0003217838   0              15.537788      1.1971759e-13  0              3.534048     
   1400000   18000          200            200            0.0032748452   1.4024194e-36  0              0.0098245355   2.1037899e-08  0              0.0010158449   1.1971759e-13  0              3.534048     
   1500000   18000          200            200            0.0032740677   9.2626962e-45  0              0.0098222032   5.3381531e-06  0              0.25776031     1.1971759e-13  0              3.5340482    
   1600000   18000          200            200            0.0032738341  -5.6096774e-37  0              0.0098215024   6.2517963e-07  0              0.030187687    1.1971759e-13  0              3.5340482    
   1700000   18000          200            200            0.0032738583  -2.8048387e-37  0              0.009821575    1.5813334e-09  0              7.6356931e-05  1.1971759e-13  0              3.5340482    
   1800000   18000          200            200            0.0032738971   1.0477657e-44  0              0.0098216914   1.374943e-08   0              0.00066391076  1.1971759e-13  0              3.5340482    
   1900000   18000          200            200            0.0032739069  -8.4145162e-37  0              0.0098217207   1.1513778e-09  0              5.5595914e-05  1.1971759e-13  0              3.5340482    
   2000000   18000          200            200            0.0032739051   8.4145164e-37  0              0.0098217152   1.6709075e-11  0              8.0682145e-07  1.1971759e-13  0              3.5340482    
   2100000   18000          200            200            0.0032739032   8.6950002e-36  0              0.0098217095   3.3966806e-11  0              1.6401355e-06  1.1971759e-13  0              3.5340482    
   2200000   18000          200            200            0.0032739028   1.0262238e-44  0              0.0098217083   1.9866827e-12  0              9.5929797e-08  1.1971759e-13  0              3.5340482    
   2300000   18000          200            200            0.0032739029  -5.6096774e-37  0              0.0098217087   8.7257952e-14  0              4.2133742e-09  1.1971759e-13  0              3.5340482    
   2400000   18000          200            200            0.003273903   -1.6829033e-36  0              0.009821709    8.0598987e-14  0              3.8918366e-09  1.1971759e-13  0              3.5340482    
   2500000   18000          200            200            0.003273903    2.8048389e-37  0              0.009821709    3.0255159e-15  0              1.4609134e-10  1.1971759e-13  0              3.5340482    
   2600000   18000          200            200            0.003273903   -5.6096774e-37  0              0.009821709    3.2802929e-16  0              1.583936e-11   1.1971759e-13  0              3.5340482    
   2700000   18000          200            200            0.003273903    1.031625e-44   0              0.009821709    1.2556439e-16  0              6.0630552e-12  1.1971759e-13  0              3.5340482    
   2800000   18000          200            200            0.003273903    2.243871e-36   0              0.009821709    4.6107291e-18  0              2.2263561e-13  1.1971759e-13  0              3.5340482    
   2900000   18000          200            200            0.003273903    8.4145164e-37  0              0.009821709    6.3730196e-18  0              3.0773031e-13  1.1971759e-13  0              3.5340482    
   3000000   18000          200            200            0.003273903    8.9754841e-36  0              0.009821709    1.8762747e-19  0              9.059859e-15   1.1971759e-13  0              3.5340482    
Loop time of 766.64 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3380985.637 ns/day, 0.000 hours/ns, 3913.178 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.58     | 240.77     | 242.97     |  14.2 | 31.41
Neigh   | 8.124      | 8.1245     | 8.125      |   0.0 |  1.06
Comm    | 28.834     | 30.756     | 32.678     |  34.7 |  4.01
Output  | 0.62209    | 0.6221     | 0.62212    |   0.0 |  0.08
Modify  | 427.75     | 427.87     | 427.99     |   0.6 | 55.81
Other   |            | 58.5       |            |       |  7.63

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.08                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 78.235127091281
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.18
  ghost atom cutoff = 4.18
  binsize = 2.09, bins = 8613 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 180.8 | 180.8 | 180.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00031921481 -1.7950885e-35  0             -0.00095764444  901208.37      0              4.3516127e+10  1.1971759e-13  0              3.7198811    
    200000   18000          200            200           -3.7090601e-05  7.7112865e-41  0             -0.0001112718   979.1579       0              47280031       1.1971759e-13  0              3.710421     
    300000   18000          200            200            0.00036979804 -1.7950909e-35  0              0.0011093941   69474.37       0              3.3546687e+09  1.1971759e-13  0              3.5484009    
    400000   18000          200            200            0.025884336   -7.1803819e-35  0              0.077653009    2326.0227      0              1.1231531e+08  1.1971759e-13  0              3.5362202    
    500000   18000          200            200           -3.8848763e-06  1.7951013e-35  0             -1.1654629e-05  10.95688       0              529068.54      1.1971759e-13  0              3.5413757    
    600000   18000          200            200            0.0034271951   2.6926474e-35  0              0.010281585    580.08389      0              28010175       1.1971759e-13  0              3.5390255    
    700000   18000          200            200            0.0027212631  -3.5901926e-35  0              0.0081637893   58.251348      0              2812749.1      1.1971759e-13  0              3.5391579    
    800000   18000          200            200            0.003571765    1.7950977e-35  0              0.010715295    5.1156607      0              247016.95      1.1971759e-13  0              3.5389921    
    900000   18000          200            200            0.0034228493  -4.4877337e-36  0              0.010268548    0.11894845     0              5743.5948      1.1971759e-13  0              3.5390209    
   1000000   18000          200            200            0.0032901579  -1.7950961e-35  0              0.0098704738   0.16776431     0              8100.738       1.1971759e-13  0              3.5390464    
   1100000   18000          200            200            0.0032638594  -8.9754807e-36  0              0.0097915783   0.010230232    0              493.98127      1.1971759e-13  0              3.5390514    
   1200000   18000          200            200            0.0032717329   4.4877429e-36  0              0.0098151986   0.00030741864  0              14.844146      1.1971759e-13  0              3.5390499    
   1300000   18000          200            200            0.0032780238   5.6096776e-36  0              0.0098340714   0.00038413204  0              18.548361      1.1971759e-13  0              3.5390486    
   1400000   18000          200            200            0.0032792465  -5.6096775e-37  0              0.0098377395   2.2344364e-05  0              1.0789294      1.1971759e-13  0              3.5390484    
   1500000   18000          200            200            0.0032788577  -3.0853226e-36  0              0.0098365731   7.7653845e-07  0              0.037496263    1.1971759e-13  0              3.5390485    
   1600000   18000          200            200            0.0032785574   5.6096777e-37  0              0.0098356723   8.794894e-07   0              0.042467395    1.1971759e-13  0              3.5390485    
   1700000   18000          200            200            0.0032785008   2.8048388e-36  0              0.0098355024   4.8683875e-08  0              0.0023507701   1.1971759e-13  0              3.5390485    
   1800000   18000          200            200            0.00327852     1.4024194e-36  0              0.0098355599   1.9489747e-09  0              9.4109015e-05  1.1971759e-13  0              3.5390485    
   1900000   18000          200            200            0.0032785343   1.1219355e-36  0              0.0098356029   2.0122755e-09  0              9.7165583e-05  1.1971759e-13  0              3.5390485    
   2000000   18000          200            200            0.0032785369   1.1219355e-36  0              0.0098356107   1.0590973e-10  0              5.1140019e-06  1.1971759e-13  0              3.5390485    
   2100000   18000          200            200            0.003278536    2.8048389e-37  0              0.0098356079   4.8658698e-12  0              2.3495544e-07  1.1971759e-13  0              3.5390485    
   2200000   18000          200            200            0.0032785353   5.6096776e-37  0              0.0098356059   4.5976673e-12  0              2.220049e-07   1.1971759e-13  0              3.5390485    
   2300000   18000          200            200            0.0032785352   8.4145164e-37  0              0.0098356055   2.2926593e-13  0              1.1070431e-08  1.1971759e-13  0              3.5390485    
   2400000   18000          200            200            0.0032785352   1.6829033e-36  0              0.0098356056   1.2188165e-14  0              5.8852289e-10  1.1971759e-13  0              3.5390485    
   2500000   18000          200            200            0.0032785352   1.0300393e-44  0              0.0098356057   1.0480745e-14  0              5.0607766e-10  1.1971759e-13  0              3.5390485    
   2600000   18000          200            200            0.0032785352   8.4145164e-37  0              0.0098356057   5.4329095e-16  0              2.6233576e-11  1.1971759e-13  0              3.5390485    
   2700000   18000          200            200            0.0032785352   1.1219355e-36  0              0.0098356057   9.8647138e-18  0              4.7633172e-13  1.1971759e-13  0              3.5390485    
   2800000   18000          200            200            0.0032785352  -8.4145162e-37  0              0.0098356057   8.1569253e-18  0              3.9386873e-13  1.1971759e-13  0              3.5390485    
   2900000   18000          200            200            0.0032785352   8.4145164e-37  0              0.0098356057   1.3250717e-17  0              6.3982971e-13  1.1971759e-13  0              3.5390485    
   3000000   18000          200            200            0.0032785352  -5.6096775e-37  0              0.0098356057   7.1836534e-18  0              3.4687291e-13  1.1971759e-13  0              3.5390485    
Loop time of 773.597 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3350581.477 ns/day, 0.000 hours/ns, 3877.988 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.73     | 243.64     | 245.56     |  12.3 | 31.49
Neigh   | 8.0908     | 8.0913     | 8.0917     |   0.0 |  1.05
Comm    | 27.855     | 29.812     | 31.769     |  35.8 |  3.85
Output  | 0.62484    | 0.62487    | 0.62489    |   0.0 |  0.08
Modify  | 431.13     | 431.14     | 431.15     |   0.0 | 55.73
Other   |            | 60.28      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.09                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 78.8117964774169
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.19
  ghost atom cutoff = 4.19
  binsize = 2.095, bins = 8592 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 180.3 | 180.3 | 180.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00032585205  1.795108e-35   0             -0.00097755615  888040.56      0              4.2880301e+10  1.1971759e-13  0              3.7293123    
    200000   18000          200            200           -2.8982561e-05 -7.1803808e-35  0             -8.6947683e-05  589.07167      0              28444163       1.1971759e-13  0              3.715526     
    300000   18000          200            200            0.00038200127  5.3852951e-35  0              0.0011460038   73335.456      0              3.5411067e+09  1.1971759e-13  0              3.5512585    
    400000   18000          200            200            0.019481958   -5.3852839e-35  0              0.058445874    9983.2479      0              4.8205531e+08  1.1971759e-13  0              3.5418696    
    500000   18000          200            200            6.5413228e-06 -1.7950921e-35  0              1.9623968e-05  32.231557      0              1556346.5      1.1971759e-13  0              3.5463654    
    600000   18000          200            200            0.0046641941   4.4877439e-35  0              0.013992582    477.57735      0              23060501       1.1971759e-13  0              3.5438025    
    700000   18000          200            200            0.0023985275  -3.5901926e-35  0              0.0071955826   27.890203      0              1346718.1      1.1971759e-13  0              3.5442272    
    800000   18000          200            200            0.0034124686  -1.7950959e-35  0              0.010237406    9.1073638      0              439762         1.1971759e-13  0              3.5440234    
    900000   18000          200            200            0.0034311873   2.2438718e-35  0              0.010293562    0.050119339    0              2420.0835      1.1971759e-13  0              3.5440204    
   1000000   18000          200            200            0.0033203749   2.2438717e-35  0              0.0099611248   0.094341634    0              4555.4199      1.1971759e-13  0              3.5440418    
   1100000   18000          200            200            0.0032780161  -2.6926449e-35  0              0.0098340484   0.021378811    0              1032.3063      1.1971759e-13  0              3.5440499    
   1200000   18000          200            200            0.0032763084  -1.3463225e-35  0              0.0098289252   0.00024513667  0              11.836773      1.1971759e-13  0              3.5440502    
   1300000   18000          200            200            0.0032812155  -9.5364518e-36  0              0.0098436464   0.00017504873  0              8.4524766      1.1971759e-13  0              3.5440492    
   1400000   18000          200            200            0.0032833219  -2.8048387e-37  0              0.0098499656   5.0809043e-05  0              2.4533868      1.1971759e-13  0              3.5440488    
   1500000   18000          200            200            0.0032834833   5.6096776e-37  0              0.00985045     9.8137576e-07  0              0.047387123    1.1971759e-13  0              3.5440488    
   1600000   18000          200            200            0.0032832682  -5.6096774e-37  0              0.0098498045   3.1120188e-07  0              0.015026825    1.1971759e-13  0              3.5440488    
   1700000   18000          200            200            0.0032831645   2.243871e-36   0              0.0098494936   1.1831719e-07  0              0.0057131136   1.1971759e-13  0              3.5440489    
   1800000   18000          200            200            0.0032831531   2.5243549e-36  0              0.0098494594   3.4117069e-09  0              0.00016473912  1.1971759e-13  0              3.5440489    
   1900000   18000          200            200            0.0032831624  -8.4145162e-37  0              0.0098494871   5.2246177e-10  0              2.5227809e-05  1.1971759e-13  0              3.5440489    
   2000000   18000          200            200            0.0032831674   1.0173616e-44  0              0.0098495023   2.701887e-10   0              1.3046445e-05  1.1971759e-13  0              3.5440489    
   2100000   18000          200            200            0.0032831681   1.0385519e-44  0              0.0098495044   1.0830325e-11  0              5.2295764e-07  1.1971759e-13  0              3.5440489    
   2200000   18000          200            200            0.0032831677   2.8048389e-37  0              0.0098495032   8.1316484e-13  0              3.926482e-08   1.1971759e-13  0              3.5440489    
   2300000   18000          200            200            0.0032831675   1.4024194e-36  0              0.0098495025   6.0463741e-13  0              2.9195777e-08  1.1971759e-13  0              3.5440489    
   2400000   18000          200            200            0.0032831675  -2.8048387e-37  0              0.0098495024   3.1955824e-14  0              1.5430324e-09  1.1971759e-13  0              3.5440489    
   2500000   18000          200            200            0.0032831675   1.0430061e-44  0              0.0098495024   1.1176123e-15  0              5.3965497e-11  1.1971759e-13  0              3.5440489    
   2600000   18000          200            200            0.0032831675   1.4024194e-36  0              0.0098495025   1.2760014e-15  0              6.1613543e-11  1.1971759e-13  0              3.5440489    
   2700000   18000          200            200            0.0032831675   5.6096777e-37  0              0.0098495025   1.801958e-16   0              8.7010101e-12  1.1971759e-13  0              3.5440489    
   2800000   18000          200            200            0.0032831675  -1.6829033e-36  0              0.0098495025   2.3631535e-17  0              1.1410823e-12  1.1971759e-13  0              3.5440489    
   2900000   18000          200            200            0.0032831675   1.4024194e-36  0              0.0098495025   4.2753058e-18  0              2.0643922e-13  1.1971759e-13  0              3.5440489    
   3000000   18000          200            200            0.0032831675  -2.8048387e-37  0              0.0098495025   1.0692499e-18  0              5.163025e-14   1.1971759e-13  0              3.5440489    
Loop time of 777.157 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3335233.759 ns/day, 0.000 hours/ns, 3860.224 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.14     | 245.91     | 252.68     |  43.2 | 31.64
Neigh   | 8.2562     | 8.2567     | 8.2572     |   0.0 |  1.06
Comm    | 28.734     | 35.109     | 41.483     | 107.6 |  4.52
Output  | 0.62336    | 0.62339    | 0.62341    |   0.0 |  0.08
Modify  | 428.54     | 428.6      | 428.67     |   0.3 | 55.15
Other   |            | 58.65      |            |       |  7.55

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.1                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 79.3912926686227
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.2
  ghost atom cutoff = 4.2
  binsize = 2.1, bins = 8572 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 180 | 180 | 180 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00033234497  8.6254757e-41  0             -0.00099703491  874977.59      0              4.2249536e+10  1.1971759e-13  0              3.7387124    
    200000   18000          200            200           -2.0767583e-05 -1.7950924e-35  0             -6.2302749e-05  297.80013      0              14379702       1.1971759e-13  0              3.7205823    
    300000   18000          200            200            0.00039429427 -4.6133988e-33  0              0.0011828828   77296.025      0              3.7323484e+09  1.1971759e-13  0              3.5540551    
    400000   18000          200            200            0.01079587    -3.590188e-35   0              0.032387609    17189.023      0              8.2999641e+08  1.1971759e-13  0              3.547881     
    500000   18000          200            200            1.7128592e-05 -1.7950917e-35  0              5.1385776e-05  214.6228       0              10363367       1.1971759e-13  0              3.5512742    
    600000   18000          200            200            0.0057820189   2.6926473e-35  0              0.017346057    259.97497      0              12553261       1.1971759e-13  0              3.5486177    
    700000   18000          200            200            0.0022229731   1.7950979e-35  0              0.0066689192   4.4420747      0              214491.89      1.1971759e-13  0              3.549267     
    800000   18000          200            200            0.0032290943   1.7950977e-35  0              0.0096872829   9.8876798      0              477440.67      1.1971759e-13  0              3.5490598    
    900000   18000          200            200            0.0034033413  -1.3463218e-35  0              0.010210024    0.54223742     0              26182.704      1.1971759e-13  0              3.5490269    
   1000000   18000          200            200            0.0033401985   2.6926459e-35  0              0.010020596    0.014163227    0              683.89154      1.1971759e-13  0              3.5490391    
   1100000   18000          200            200            0.0032938315   3.3992929e-42  0              0.0098814944   0.020847044    0              1006.6291      1.1971759e-13  0              3.5490481    
   1200000   18000          200            200            0.0032833777  -4.4877412e-36  0              0.0098501331   0.0018530423   0              89.47678       1.1971759e-13  0              3.5490501    
   1300000   18000          200            200            0.0032852075  -1.1219355e-36  0              0.0098556224   2.1770723e-06  0              0.10512303     1.1971759e-13  0              3.5490497    
   1400000   18000          200            200            0.0032873269  -5.6096775e-37  0              0.0098619808   3.9205902e-05  0              1.8931127      1.1971759e-13  0              3.5490493    
   1500000   18000          200            200            0.0032879484   8.4145164e-37  0              0.0098638452   5.5330111e-06  0              0.26716931     1.1971759e-13  0              3.5490492    
   1600000   18000          200            200            0.0032879224   2.8048389e-37  0              0.0098637671   1.7726072e-08  0              0.00085592859  1.1971759e-13  0              3.5490492    
   1700000   18000          200            200            0.0032878301  -1.4024194e-36  0              0.0098634902   6.5115058e-08  0              0.0031441731   1.1971759e-13  0              3.5490492    
   1800000   18000          200            200            0.0032877959   2.8048389e-37  0              0.0098633878   1.4707788e-08  0              0.00071018645  1.1971759e-13  0              3.5490492    
   1900000   18000          200            200            0.0032877942   1.0094811e-44  0              0.0098633826   2.4837855e-10  0              1.1993311e-05  1.1971759e-13  0              3.5490492    
   2000000   18000          200            200            0.003287798   -1.1219355e-36  0              0.009863394    9.1004041e-11  0              4.3942594e-06  1.1971759e-13  0              3.5490492    
   2100000   18000          200            200            0.0032877998   5.6096777e-37  0              0.0098633993   3.5408251e-11  0              1.7097377e-06  1.1971759e-13  0              3.5490492    
   2200000   18000          200            200            0.0032878      8.4145163e-36  0              0.0098633999   1.3576633e-12  0              6.5556704e-08  1.1971759e-13  0              3.5490492    
   2300000   18000          200            200            0.0032877998  -5.6096774e-37  0              0.0098633995   9.53897e-14    0              4.6060272e-09  1.1971759e-13  0              3.5490492    
   2400000   18000          200            200            0.0032877997  -3.0853226e-36  0              0.0098633992   7.741004e-14   0              3.7378538e-09  1.1971759e-13  0              3.5490492    
   2500000   18000          200            200            0.0032877997  -8.4145162e-37  0              0.0098633992   5.1723459e-15  0              2.4975407e-10  1.1971759e-13  0              3.5490492    
   2600000   18000          200            200            0.0032877997   1.4024194e-36  0              0.0098633992   2.7165768e-17  0              1.3117377e-12  1.1971759e-13  0              3.5490492    
   2700000   18000          200            200            0.0032877997   1.0481375e-44  0              0.0098633992   3.9359734e-17  0              1.9005407e-12  1.1971759e-13  0              3.5490492    
   2800000   18000          200            200            0.0032877997   1.0623424e-44  0              0.0098633992   1.7755131e-19  0              8.5733175e-15  1.1971759e-13  0              3.5490492    
   2900000   18000          200            200            0.0032877997   2.5243549e-36  0              0.0098633992   1.9162072e-18  0              9.2526786e-14  1.1971759e-13  0              3.5490492    
   3000000   18000          200            200            0.0032877997  -2.8048387e-37  0              0.0098633992   1.1180633e-17  0              5.3987274e-13  1.1971759e-13  0              3.5490492    
Loop time of 769.662 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3367710.184 ns/day, 0.000 hours/ns, 3897.813 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.93     | 241.85     | 243.77     |  12.3 | 31.42
Neigh   | 8.4554     | 8.4559     | 8.4563     |   0.0 |  1.10
Comm    | 29.102     | 31.22      | 33.338     |  37.9 |  4.06
Output  | 0.62265    | 0.62266    | 0.62267    |   0.0 |  0.08
Modify  | 428.92     | 428.99     | 429.06     |   0.3 | 55.74
Other   |            | 58.52      |            |       |  7.60

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.11                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 79.9736225764021
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.21
  ghost atom cutoff = 4.21
  binsize = 2.105, bins = 8552 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 179.6 | 179.6 | 179.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00033869434 -1.7950854e-35  0             -0.001016083    862018.18      0              4.1623773e+10  1.1971759e-13  0              3.7480815    
    200000   18000          200            200           -1.2444926e-05 -3.5901864e-35  0             -3.7334779e-05  105.03413      0              5071722.1      1.1971759e-13  0              3.7255897    
    300000   18000          200            200            0.00040667856  1.7951038e-35  0              0.0012200357   81356.497      0              3.9284141e+09  1.1971759e-13  0              3.55679      
    400000   18000          200            200            0.0030638233   7.1803936e-35  0              0.00919147     19614.151      0              9.4709717e+08  1.1971759e-13  0              3.5540653    
    500000   18000          200            200            2.787763e-05   3.5901981e-35  0              8.3632889e-05  557.42712      0              26916161       1.1971759e-13  0              3.556102     
    600000   18000          200            200            0.0065225824   2.1099662e-41  0              0.019567747    58.130195      0              2806899.1      1.1971759e-13  0              3.553502     
    700000   18000          200            200            0.0022120715   1.1579026e-41  0              0.0066362144   1.9117332      0              92310.754      1.1971759e-13  0              3.5542713    
    800000   18000          200            200            0.0030608899   1.7950977e-35  0              0.0091826697   6.9024778      0              333295.95      1.1971759e-13  0              3.554094     
    900000   18000          200            200            0.0033474789  -1.795096e-35   0              0.010042437    1.1406721      0              55078.973      1.1971759e-13  0              3.5540387    
   1000000   18000          200            200            0.0033453084  -8.9754775e-36  0              0.010035925    0.010396525    0              502.01101      1.1971759e-13  0              3.5540393    
   1100000   18000          200            200            0.0033077234  -2.2438707e-35  0              0.0099231701   0.0092846543   0              448.32273      1.1971759e-13  0              3.5540466    
   1200000   18000          200            200            0.0032920544  -4.487742e-35   0              0.0098761632   0.0029948188   0              144.60908      1.1971759e-13  0              3.5540496    
   1300000   18000          200            200            0.0032902602  -1.6829032e-36  0              0.0098707807   0.00011750902  0              5.6740899      1.1971759e-13  0              3.5540499    
   1400000   18000          200            200            0.0032915486  -2.8048387e-37  0              0.0098746457   6.4505137e-06  0              0.31147222     1.1971759e-13  0              3.5540497    
   1500000   18000          200            200            0.0032923381  -2.8048387e-37  0              0.0098770144   6.3328142e-06  0              0.30578893     1.1971759e-13  0              3.5540495    
   1600000   18000          200            200            0.0032925078   1.0339736e-44  0              0.0098775235   5.5790471e-07  0              0.026939222    1.1971759e-13  0              3.5540495    
   1700000   18000          200            200            0.0032924769   1.1219355e-36  0              0.0098774307   1.0181739e-10  0              4.9163976e-06  1.1971759e-13  0              3.5540495    
   1800000   18000          200            200            0.0032924413   1.0592487e-44  0              0.0098773239   1.0517355e-08  0              0.00050784542  1.1971759e-13  0              3.5540495    
   1900000   18000          200            200            0.0032924301   1.4024194e-36  0              0.0098772902   1.8252995e-09  0              8.8137179e-05  1.1971759e-13  0              3.5540495    
   2000000   18000          200            200            0.0032924299   2.8048389e-37  0              0.0098772898   2.3660941e-11  0              1.1425022e-06  1.1971759e-13  0              3.5540495    
   2100000   18000          200            200            0.0032924314  -2.8048387e-37  0              0.0098772941   1.2445026e-11  0              6.0092577e-07  1.1971759e-13  0              3.5540495    
   2200000   18000          200            200            0.003292432   -5.6096774e-37  0              0.009877296    4.6470103e-12  0              2.2438749e-07  1.1971759e-13  0              3.5540495    
   2300000   18000          200            200            0.0032924321   8.4145164e-37  0              0.0098772962   2.1349919e-13  0              1.0309112e-08  1.1971759e-13  0              3.5540495    
   2400000   18000          200            200            0.003292432   -2.8048387e-37  0              0.0098772961   7.074685e-15   0              3.4161122e-10  1.1971759e-13  0              3.5540495    
   2500000   18000          200            200            0.003292432    5.6096777e-37  0              0.009877296    9.4906639e-15  0              4.5827019e-10  1.1971759e-13  0              3.5540495    
   2600000   18000          200            200            0.003292432    5.6096777e-37  0              0.009877296    9.4214729e-16  0              4.5492921e-11  1.1971759e-13  0              3.5540495    
   2700000   18000          200            200            0.003292432    1.1219355e-36  0              0.009877296    5.8014105e-17  0              2.8012935e-12  1.1971759e-13  0              3.5540495    
   2800000   18000          200            200            0.003292432   -8.4145162e-37  0              0.009877296    1.776976e-17   0              8.5803811e-13  1.1971759e-13  0              3.5540495    
   2900000   18000          200            200            0.003292432   -1.4024194e-36  0              0.009877296    6.6419381e-19  0              3.2071542e-14  1.1971759e-13  0              3.5540495    
   3000000   18000          200            200            0.003292432    5.6096777e-37  0              0.009877296    9.6256159e-18  0              4.6478654e-13  1.1971759e-13  0              3.5540495    
Loop time of 770.19 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3365405.308 ns/day, 0.000 hours/ns, 3895.145 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.15     | 242.43     | 243.71     |   8.2 | 31.48
Neigh   | 8.7113     | 8.7119     | 8.7124     |   0.0 |  1.13
Comm    | 29.789     | 31.233     | 32.678     |  25.8 |  4.06
Output  | 0.63358    | 0.6336     | 0.63362    |   0.0 |  0.08
Modify  | 427.56     | 427.79     | 428.02     |   1.1 | 55.54
Other   |            | 59.39      |            |       |  7.71

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.12                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 80.5587931122588
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.22
  ghost atom cutoff = 4.22
  binsize = 2.11, bins = 8531 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 175.9 | 175.9 | 175.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00034489996 -1.7950905e-35  0             -0.0010346999   849163.96      0              4.1003088e+10  1.1971759e-13  0              3.7574192    
    200000   18000          200            200           -4.0171416e-06 -5.3852862e-35  0             -1.2051425e-05  10.546967      0              509275.29      1.1971759e-13  0              3.7305481    
    300000   18000          200            200            0.0018211254  -1.7950916e-35  0              0.0054633761   85332.653      0              4.1204084e+09  1.1971759e-13  0              3.5594636    
    400000   18000          200            200           -0.00013891678  5.3852978e-35  0             -0.00041675034  17847.447      0              8.6178934e+08  1.1971759e-13  0              3.560254     
    500000   18000          200            200            3.8787139e-05 -3.590189e-35   0              0.00011636142  1059.9604      0              51181696       1.1971759e-13  0              3.5608486    
    600000   18000          200            200            0.0066942292   2.6926471e-35  0              0.020082688    4.9882821      0              240866.29      1.1971759e-13  0              3.5584759    
    700000   18000          200            200            0.0023675933  -9.8730314e-35  0              0.0071027799   21.663606      0              1046058        1.1971759e-13  0              3.5592393    
    800000   18000          200            200            0.002941632    8.9754929e-36  0              0.0088248961   2.5018109      0              120803.5       1.1971759e-13  0              3.5591191    
    900000   18000          200            200            0.0032786418   8.9754921e-36  0              0.0098359254   1.2987696      0              62712.937      1.1971759e-13  0              3.5590531    
   1000000   18000          200            200            0.0033355578  -1.346322e-35   0              0.010006673    0.086241807    0              4164.3082      1.1971759e-13  0              3.5590424    
   1100000   18000          200            200            0.0033167147  -1.3463223e-35  0              0.0099501442   0.00031052897  0              14.994333      1.1971759e-13  0              3.5590461    
   1200000   18000          200            200            0.003300869    8.7065253e-43  0              0.009902607    0.0021631783   0              104.45214      1.1971759e-13  0              3.5590491    
   1300000   18000          200            200            0.0032962007  -1.6829032e-36  0              0.009888602    0.00034923423  0              16.863271      1.1971759e-13  0              3.55905      
   1400000   18000          200            200            0.0032961739  -8.4145163e-37  0              0.0098885216   5.4102945e-06  0              0.26124376     1.1971759e-13  0              3.55905      
   1500000   18000          200            200            0.0032967756   9.1957134e-45  0              0.0098903268   1.9790966e-06  0              0.095563493    1.1971759e-13  0              3.5590499    
   1600000   18000          200            200            0.0032970509  -2.8048387e-37  0              0.0098911528   8.8606935e-07  0              0.042785118    1.1971759e-13  0              3.5590498    
   1700000   18000          200            200            0.0032970962  -1.4024194e-36  0              0.0098912886   5.7688906e-08  0              0.0027855908   1.1971759e-13  0              3.5590498    
   1800000   18000          200            200            0.0032970804  -5.6096774e-37  0              0.0098912412   2.3381586e-10  0              1.1290131e-05  1.1971759e-13  0              3.5590498    
   1900000   18000          200            200            0.0032970673  -2.8048387e-37  0              0.009891202    1.481509e-09   0              7.1536768e-05  1.1971759e-13  0              3.5590498    
   2000000   18000          200            200            0.0032970635  -5.6096774e-37  0              0.0098911905   2.3636844e-10  0              1.1413386e-05  1.1971759e-13  0              3.5590498    
   2100000   18000          200            200            0.0032970635  -1.3182742e-35  0              0.0098911905   3.5462592e-12  0              1.7123616e-07  1.1971759e-13  0              3.5590498    
   2200000   18000          200            200            0.003297064   -2.8048387e-37  0              0.009891192    1.3676788e-12  0              6.6040312e-08  1.1971759e-13  0              3.5590498    
   2300000   18000          200            200            0.0032970642  -5.6096775e-36  0              0.0098911927   6.0209961e-13  0              2.9073235e-08  1.1971759e-13  0              3.5590498    
   2400000   18000          200            200            0.0032970643   2.8048389e-37  0              0.0098911928   3.8874456e-14  0              1.8771084e-09  1.1971759e-13  0              3.5590498    
   2500000   18000          200            200            0.0032970642   1.4024194e-36  0              0.0098911927   1.7770727e-16  0              8.5808483e-12  1.1971759e-13  0              3.5590498    
   2600000   18000          200            200            0.0032970642  -1.6829033e-36  0              0.0098911927   9.5878068e-16  0              4.6296087e-11  1.1971759e-13  0              3.5590498    
   2700000   18000          200            200            0.0032970642  -1.4024194e-36  0              0.0098911927   1.5683604e-16  0              7.573051e-12   1.1971759e-13  0              3.5590498    
   2800000   18000          200            200            0.0032970642  -8.4145162e-37  0              0.0098911927   2.4580267e-18  0              1.1868931e-13  1.1971759e-13  0              3.5590498    
   2900000   18000          200            200            0.0032970642   9.8840351e-45  0              0.0098911927   1.2722541e-17  0              6.1432599e-13  1.1971759e-13  0              3.5590498    
   3000000   18000          200            200            0.0032970642   1.3182742e-35  0              0.0098911927   1.2813849e-17  0              6.187349e-13   1.1971759e-13  0              3.5590498    
Loop time of 772.236 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3356488.760 ns/day, 0.000 hours/ns, 3884.825 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.7      | 244.55     | 248.41     |  24.7 | 31.67
Neigh   | 7.8255     | 7.8256     | 7.8257     |   0.0 |  1.01
Comm    | 28.009     | 31.699     | 35.389     |  65.5 |  4.10
Output  | 0.62397    | 0.62399    | 0.62401    |   0.0 |  0.08
Modify  | 427.49     | 427.58     | 427.66     |   0.4 | 55.37
Other   |            | 59.96      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.13                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 81.1468111876968
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.23
  ghost atom cutoff = 4.23
  binsize = 2.115, bins = 8511 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 175.5 | 175.5 | 175.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00035096286  8.975494e-35   0             -0.0010528886   836412.85      0              4.0387383e+10  1.1971759e-13  0              3.7667259    
    200000   18000          200            200            4.5166497e-06 -1.7950922e-35  0              1.3549949e-05  14.042868      0              678079.85      1.1971759e-13  0              3.7354575    
    300000   18000          200            200            0.017693158    4.7991227e-41  0              0.053079474    77654.475      0              3.7496567e+09  1.1971759e-13  0              3.5621348    
    400000   18000          200            200           -0.00013079468 -1.7950903e-35  0             -0.00039238405  15508.988      0              7.4887354e+08  1.1971759e-13  0              3.566371     
    500000   18000          200            200            4.9852322e-05 -5.3852867e-35  0              0.00014955697  1721.3117      0              83115984       1.1971759e-13  0              3.565514     
    600000   18000          200            200            0.0062487143  -8.9754652e-36  0              0.018746143    136.14634      0              6574019.4      1.1971759e-13  0              3.5635445    
    700000   18000          200            200            0.0026760142   2.6926464e-35  0              0.0080280427   51.6914        0              2495992.7      1.1971759e-13  0              3.5641761    
    800000   18000          200            200            0.0028941051  -8.9754752e-36  0              0.0086823152   0.050043005    0              2416.3976      1.1971759e-13  0              3.56413      
    900000   18000          200            200            0.0032147366   1.7950976e-35  0              0.0096442098   0.87641843     0              42319.109      1.1971759e-13  0              3.5640667    
   1000000   18000          200            200            0.0033150355   1.3463232e-35  0              0.0099451065   0.16195508     0              7820.2311      1.1971759e-13  0              3.5640475    
   1100000   18000          200            200            0.0033194017   4.4877454e-36  0              0.009958205    0.0044211146   0              213.4798       1.1971759e-13  0              3.5640468    
   1200000   18000          200            200            0.0033083011   8.5496734e-43  0              0.0099249033   0.00046043425  0              22.232722      1.1971759e-13  0              3.5640489    
   1300000   18000          200            200            0.0033024931   5.609678e-37   0              0.0099074794   0.00035671847  0              17.224658      1.1971759e-13  0              3.56405      
   1400000   18000          200            200            0.0033012051  -8.4145163e-37  0              0.0099036154   3.7381216e-05  0              1.8050051      1.1971759e-13  0              3.5640503    
   1500000   18000          200            200            0.0033013592   4.487742e-36   0              0.0099040777   1.6733374e-07  0              0.0080799473   1.1971759e-13  0              3.5640502    
   1600000   18000          200            200            0.0033016015  -5.6096774e-37  0              0.0099048046   3.7265072e-07  0              0.017993969    1.1971759e-13  0              3.5640502    
   1700000   18000          200            200            0.0033016959   2.8048389e-37  0              0.0099050877   1.1737175e-07  0              0.0056674618   1.1971759e-13  0              3.5640502    
   1800000   18000          200            200            0.0033017087  -4.7682259e-36  0              0.0099051261   6.6926443e-09  0              0.00032316384  1.1971759e-13  0              3.5640502    
   1900000   18000          200            200            0.0033017023  -2.8048387e-37  0              0.009905107    4.0288047e-11  0              1.9453656e-06  1.1971759e-13  0              3.5640502    
   2000000   18000          200            200            0.0033016976  -5.6096774e-37  0              0.0099050929   1.8935477e-10  0              9.1432641e-06  1.1971759e-13  0              3.5640502    
   2100000   18000          200            200            0.0033016963  -1.6829033e-36  0              0.0099050888   3.2205685e-11  0              1.5550973e-06  1.1971759e-13  0              3.5640502    
   2200000   18000          200            200            0.0033016962   8.4145164e-37  0              0.0099050887   7.6681102e-13  0              3.702656e-08   1.1971759e-13  0              3.5640502    
   2300000   18000          200            200            0.0033016964  -2.5243549e-36  0              0.0099050891   1.1040471e-13  0              5.3310482e-09  1.1971759e-13  0              3.5640502    
   2400000   18000          200            200            0.0033016965  -1.4024194e-36  0              0.0099050894   7.4196898e-14  0              3.5827027e-09  1.1971759e-13  0              3.5640502    
   2500000   18000          200            200            0.0033016965  -2.8048387e-37  0              0.0099050894   7.2738453e-15  0              3.5122796e-10  1.1971759e-13  0              3.5640502    
   2600000   18000          200            200            0.0033016965   2.8048389e-37  0              0.0099050894   4.8313906e-17  0              2.3329056e-12  1.1971759e-13  0              3.5640502    
   2700000   18000          200            200            0.0033016965  -5.6096774e-37  0              0.0099050894   2.1988479e-19  0              1.0617449e-14  1.1971759e-13  0              3.5640502    
   2800000   18000          200            200            0.0033016965  -3.0853226e-36  0              0.0099050894   4.5117892e-18  0              2.1785815e-13  1.1971759e-13  0              3.5640502    
   2900000   18000          200            200            0.0033016965   1.9633872e-36  0              0.0099050894   3.7529071e-18  0              1.8121445e-13  1.1971759e-13  0              3.5640502    
   3000000   18000          200            200            0.0033016965  -5.6096774e-37  0              0.0099050894   6.3715605e-18  0              3.0765985e-13  1.1971759e-13  0              3.5640502    
Loop time of 766.214 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3382868.905 ns/day, 0.000 hours/ns, 3915.358 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.63     | 239.99     | 241.34     |   8.7 | 31.32
Neigh   | 7.672      | 7.6722     | 7.6724     |   0.0 |  1.00
Comm    | 27.717     | 28.942     | 30.167     |  22.8 |  3.78
Output  | 0.62329    | 0.62331    | 0.62334    |   0.0 |  0.08
Modify  | 428.84     | 428.88     | 428.92     |   0.2 | 55.97
Other   |            | 60.11      |            |       |  7.85

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 138
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.14                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 81.7376837142197
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.24
  ghost atom cutoff = 4.24
  binsize = 2.12, bins = 8491 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 175.1 | 175.1 | 175.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00035688302  3.5901997e-35  0             -0.0010706491   823765.81      0              3.9776703e+10  1.1971759e-13  0              3.7760012    
    200000   18000          200            200            1.3155702e-05 -3.5901883e-35  0              3.9467106e-05  115.26684      0              5565823.2      1.1971759e-13  0              3.7403176    
    300000   18000          200            200            0.039082915    3.5901994e-35  0              0.11724875     47257.807      0              2.2819104e+09  1.1971759e-13  0              3.565095     
    400000   18000          200            200           -0.00012249099 -8.9754776e-35  0             -0.00036747298  13336.965      0              6.4399433e+08  1.1971759e-13  0              3.5724116    
    500000   18000          200            200            6.107711e-05   1.7951015e-35  0              0.00018323133  2541.0907      0              1.2270017e+08  1.1971759e-13  0              3.5700978    
    600000   18000          200            200            0.0053020212  -1.7950951e-35  0              0.015906064    361.30963      0              17446349       1.1971759e-13  0              3.5686954    
    700000   18000          200            200            0.0031029206   1.7053421e-34  0              0.0093087617   73.06272       0              3527937.3      1.1971759e-13  0              3.5690918    
    800000   18000          200            200            0.0029275812  -1.7950967e-34  0              0.0087827437   1.3823724      0              66749.815      1.1971759e-13  0              3.5691248    
    900000   18000          200            200            0.0031720268   1.7950976e-35  0              0.0095160803   0.25870167     0              12491.778      1.1971759e-13  0              3.5690763    
   1000000   18000          200            200            0.003290837    2.2438717e-35  0              0.0098725111   0.15861062     0              7658.739       1.1971759e-13  0              3.5690534    
   1100000   18000          200            200            0.0033164118   3.590194e-35   0              0.0099492355   0.016654605    0              804.19125      1.1971759e-13  0              3.5690485    
   1200000   18000          200            200            0.0033133345  -2.2438702e-36  0              0.0099400035   0.00012751628  0              6.157305       1.1971759e-13  0              3.5690491    
   1300000   18000          200            200            0.0033084602  -2.8048383e-37  0              0.0099253806   0.00012973557  0              6.2644665      1.1971759e-13  0              3.5690501    
   1400000   18000          200            200            0.00330646     2.8048388e-37  0              0.0099193801   5.0521913e-05  0              2.4395224      1.1971759e-13  0              3.5690505    
   1500000   18000          200            200            0.0033061133   9.1126715e-45  0              0.0099183399   4.0471885e-06  0              0.19542425     1.1971759e-13  0              3.5690505    
   1600000   18000          200            200            0.0033062051   5.6096777e-37  0              0.0099186153   3.439473e-09   0              0.00016607984  1.1971759e-13  0              3.5690505    
   1700000   18000          200            200            0.003306296   -8.4145162e-37  0              0.009918888    5.5498548e-08  0              0.0026798263   1.1971759e-13  0              3.5690505    
   1800000   18000          200            200            0.0033063288  -5.6096774e-37  0              0.0099189865   1.5382621e-08  0              0.00074277173  1.1971759e-13  0              3.5690505    
   1900000   18000          200            200            0.0033063331   1.1219355e-36  0              0.0099189992   9.1560124e-10  0              4.4211107e-05  1.1971759e-13  0              3.5690505    
   2000000   18000          200            200            0.0033063309   8.4145164e-37  0              0.0099189926   1.8703555e-12  0              9.0312772e-08  1.1971759e-13  0              3.5690505    
   2100000   18000          200            200            0.0033063292   1.1219355e-36  0              0.0099189876   2.1657116e-11  0              1.0457446e-06  1.1971759e-13  0              3.5690505    
   2200000   18000          200            200            0.0033063287  -1.4024194e-36  0              0.009918986    4.4913851e-12  0              2.1687291e-07  1.1971759e-13  0              3.5690505    
   2300000   18000          200            200            0.0033063286   2.8048389e-37  0              0.0099189859   1.8910724e-13  0              9.131312e-09   1.1971759e-13  0              3.5690505    
   2400000   18000          200            200            0.0033063287   5.6096777e-37  0              0.009918986    4.2192839e-15  0              2.0373412e-10  1.1971759e-13  0              3.5690505    
   2500000   18000          200            200            0.0033063287   1.0500908e-44  0              0.0099189861   7.9893262e-15  0              3.8577597e-10  1.1971759e-13  0              3.5690505    
   2600000   18000          200            200            0.0033063287  -8.4145162e-37  0              0.0099189862   1.2826591e-15  0              6.1935016e-11  1.1971759e-13  0              3.5690505    
   2700000   18000          200            200            0.0033063287   1.1219355e-36  0              0.0099189862   1.5874101e-16  0              7.6650354e-12  1.1971759e-13  0              3.5690505    
   2800000   18000          200            200            0.0033063287   2.243871e-36   0              0.0099189862   2.0992322e-17  0              1.0136441e-12  1.1971759e-13  0              3.5690505    
   2900000   18000          200            200            0.0033063287  -2.8048387e-37  0              0.0099189862   2.2443304e-18  0              1.0837068e-13  1.1971759e-13  0              3.5690505    
   3000000   18000          200            200            0.0033063287   2.8048389e-37  0              0.0099189862   9.6281283e-18  0              4.6490786e-13  1.1971759e-13  0              3.5690505    
Loop time of 772.687 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3354526.485 ns/day, 0.000 hours/ns, 3882.554 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.94     | 246.22     | 249.49     |  20.9 | 31.87
Neigh   | 7.7229     | 7.7229     | 7.7229     |   0.0 |  1.00
Comm    | 26.61      | 30.07      | 33.531     |  63.1 |  3.89
Output  | 0.62082    | 0.62084    | 0.62086    |   0.0 |  0.08
Modify  | 428.69     | 428.71     | 428.72     |   0.1 | 55.48
Other   |            | 59.35      |            |       |  7.68

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.15                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 82.3314176033318
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.25
  ghost atom cutoff = 4.25
  binsize = 2.125, bins = 8471 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 174.8 | 174.8 | 174.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00036266077 -5.3852785e-35  0             -0.0010879823   811222.92      0              3.9171051e+10  1.1971759e-13  0              3.785245     
    200000   18000          200            200            2.189862e-05  -1.795091e-35   0              6.5695859e-05  313.9394       0              15159010       1.1971759e-13  0              3.7451285    
    300000   18000          200            200            0.055941649    6.8571546e-41  0              0.16782495     11471.503      0              5.5391784e+08  1.1971759e-13  0              3.5687544    
    400000   18000          200            200           -0.00011400966 -1.7950908e-35  0             -0.00034202897  11331.438      0              5.4715459e+08  1.1971759e-13  0              3.5783754    
    500000   18000          200            200            0.00097244042 -3.5901891e-35  0              0.0029173212   3428.581       0              1.6555391e+08  1.1971759e-13  0              3.5746017    
    600000   18000          200            200            0.0040886867  -8.9754712e-36  0              0.01226606     533.861        0              25778237       1.1971759e-13  0              3.5739026    
    700000   18000          200            200            0.0035865781   1.0483375e-41  0              0.010759734    71.225249      0              3439212.4      1.1971759e-13  0              3.5740007    
    800000   18000          200            200            0.0030372045   9.8402017e-42  0              0.0091116135   5.4629876      0              263788.12      1.1971759e-13  0              3.5741044    
    900000   18000          200            200            0.0031615574  -4.4877339e-36  0              0.0094846721   0.0015456656   0              74.634661      1.1971759e-13  0              3.5740796    
   1000000   18000          200            200            0.0032710393   4.4877486e-36  0              0.0098131178   0.080019568    0              3863.8585      1.1971759e-13  0              3.5740584    
   1100000   18000          200            200            0.0033101998  -4.0389675e-35  0              0.0099305995   0.02253387     0              1088.08        1.1971759e-13  0              3.5740509    
   1200000   18000          200            200            0.0033158249   1.3463227e-35  0              0.0099474747   0.0015868949   0              76.625476      1.1971759e-13  0              3.5740499    
   1300000   18000          200            200            0.0033135575   8.4145168e-37  0              0.0099406725   5.1324461e-07  0              0.024782745    1.1971759e-13  0              3.5740503    
   1400000   18000          200            200            0.0033116548   4.2072582e-37  0              0.0099349644   2.3711788e-05  0              1.1449574      1.1971759e-13  0              3.5740507    
   1500000   18000          200            200            0.0033109759   5.6096776e-37  0              0.0099329277   6.7342637e-06  0              0.32517349     1.1971759e-13  0              3.5740508    
   1600000   18000          200            200            0.0033108774  -5.6096774e-37  0              0.0099326322   4.7954754e-07  0              0.023155635    1.1971759e-13  0              3.5740508    
   1700000   18000          200            200            0.0033109161  -2.8048387e-37  0              0.0099327482   2.0807634e-10  0              1.0047262e-05  1.1971759e-13  0              3.5740508    
   1800000   18000          200            200            0.0033109489   1.0358398e-44  0              0.0099328467   6.9972729e-09  0              0.00033787327  1.1971759e-13  0              3.5740508    
   1900000   18000          200            200            0.0033109607  -2.8048387e-37  0              0.009932882    2.0122731e-09  0              9.7165466e-05  1.1971759e-13  0              3.5740508    
   2000000   18000          200            200            0.0033109624  -5.6096774e-37  0              0.0099328872   1.4493495e-10  0              6.9983899e-06  1.1971759e-13  0              3.5740508    
   2100000   18000          200            200            0.0033109617   4.7682259e-36  0              0.0099328852   8.0812133e-14  0              3.9021287e-09  1.1971759e-13  0              3.5740508    
   2200000   18000          200            200            0.0033109612  -5.6096774e-37  0              0.0099328835   2.0630256e-12  0              9.9616124e-08  1.1971759e-13  0              3.5740508    
   2300000   18000          200            200            0.003310961   -5.6096774e-37  0              0.0099328829   6.0189823e-13  0              2.9063511e-08  1.1971759e-13  0              3.5740508    
   2400000   18000          200            200            0.0033109609   1.0636303e-44  0              0.0099328828   4.4193185e-14  0              2.1339308e-09  1.1971759e-13  0              3.5740508    
   2500000   18000          200            200            0.0033109609  -1.1219355e-36  0              0.0099328828   2.538545e-17   0              1.2257726e-12  1.1971759e-13  0              3.5740508    
   2600000   18000          200            200            0.003310961    1.1219355e-36  0              0.0099328829   5.7911587e-16  0              2.7963433e-11  1.1971759e-13  0              3.5740508    
   2700000   18000          200            200            0.003310961    2.8048389e-37  0              0.0099328829   9.7068015e-17  0              4.687067e-12   1.1971759e-13  0              3.5740508    
   2800000   18000          200            200            0.003310961    5.6096777e-37  0              0.0099328829   5.5424273e-20  0              2.6762398e-15  1.1971759e-13  0              3.5740508    
   2900000   18000          200            200            0.003310961    9.2781085e-45  0              0.0099328829   8.7549468e-19  0              4.2274505e-14  1.1971759e-13  0              3.5740508    
   3000000   18000          200            200            0.003310961   -5.6096774e-37  0              0.0099328829   7.0608596e-18  0              3.4094364e-13  1.1971759e-13  0              3.5740508    
Loop time of 768.432 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3373101.591 ns/day, 0.000 hours/ns, 3904.053 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.07     | 242.16     | 242.25     |   0.6 | 31.51
Neigh   | 7.589      | 7.5892     | 7.5894     |   0.0 |  0.99
Comm    | 28.758     | 28.762     | 28.766     |   0.1 |  3.74
Output  | 0.61933    | 0.61936    | 0.61938    |   0.0 |  0.08
Modify  | 429.46     | 429.6      | 429.74     |   0.7 | 55.91
Other   |            | 59.7       |            |       |  7.77

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 138
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.16                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 82.9280197665364
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.26
  ghost atom cutoff = 4.26
  binsize = 2.13, bins = 8451 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 171.2 | 171.2 | 171.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00036829681  5.3853021e-35  0             -0.0011048904   798783.08      0              3.8570376e+10  1.1971759e-13  0              3.7944575    
    200000   18000          200            200            3.0745721e-05 -1.795088e-35   0              9.2237164e-05  609.81423      0              29445747       1.1971759e-13  0              3.7498899    
    300000   18000          200            200            0.060167921   -7.1803808e-35  0              0.18050376     922.10969      0              44525377       1.1971759e-13  0              3.5734381    
    400000   18000          200            200           -0.00010535042 -6.1033286e-34  0             -0.00031605126  9491.3883      0              4.5830517e+08  1.1971759e-13  0              3.5842622    
    500000   18000          200            200            0.0034032866   3.7997666e-41  0              0.01020986     3833.9417      0              1.8512733e+08  1.1971759e-13  0              3.5790491    
    600000   18000          200            200            0.0028719254   1.4802943e-41  0              0.0086157762   555.48019      0              26822151       1.1971759e-13  0              3.5791323    
    700000   18000          200            200            0.0040412548   4.4877432e-35  0              0.012123764    46.456885      0              2243236.7      1.1971759e-13  0              3.5789187    
    800000   18000          200            200            0.0032041752  -3.5901927e-35  0              0.0096125256   9.1460366      0              441629.38      1.1971759e-13  0              3.5790732    
    900000   18000          200            200            0.003186837   -8.9754832e-35  0              0.009560511    0.33226441     0              16043.859      1.1971759e-13  0              3.579076     
   1000000   18000          200            200            0.0032624182   4.4877485e-36  0              0.0097872545   0.0079162604   0              382.24788      1.1971759e-13  0              3.5790613    
   1100000   18000          200            200            0.003304243    3.2133967e-42  0              0.009912729    0.015158197    0              731.93508      1.1971759e-13  0              3.5790533    
   1200000   18000          200            200            0.0033165523   4.4877429e-36  0              0.0099496569   0.0029004292   0              140.05135      1.1971759e-13  0              3.5790509    
   1300000   18000          200            200            0.0033175967   2.8048392e-37  0              0.0099527901   0.00015596657  0              7.5310673      1.1971759e-13  0              3.5790507    
   1400000   18000          200            200            0.003316534   -1.4024194e-37  0              0.009949602    1.849293e-07   0              0.0089295741   1.1971759e-13  0              3.579051     
   1500000   18000          200            200            0.0033158308  -1.1219355e-36  0              0.0099474925   3.5010427e-06  0              0.16905282     1.1971759e-13  0              3.5790511    
   1600000   18000          200            200            0.0033155961   1.0195531e-44  0              0.0099467882   8.8369567e-07  0              0.042670502    1.1971759e-13  0              3.5790511    
   1700000   18000          200            200            0.0033155635   1.1219355e-36  0              0.0099466904   6.4852731e-08  0              0.0031315063   1.1971759e-13  0              3.5790511    
   1800000   18000          200            200            0.003315577    5.6096777e-37  0              0.009946731    1.4476655e-10  0              6.9902587e-06  1.1971759e-13  0              3.5790511    
   1900000   18000          200            200            0.0033155885  -2.8048387e-37  0              0.0099467654   7.3322547e-10  0              3.5404834e-05  1.1971759e-13  0              3.5790511    
   2000000   18000          200            200            0.0033155928  -1.4024194e-36  0              0.0099467784   2.5614267e-10  0              1.2368213e-05  1.1971759e-13  0              3.5790511    
   2100000   18000          200            200            0.0033155936   1.6829033e-36  0              0.0099467808   2.4643576e-11  0              1.1899501e-06  1.1971759e-13  0              3.5790511    
   2200000   18000          200            200            0.0033155935   1.4024194e-36  0              0.0099467804   2.922485e-13   0              1.4111634e-08  1.1971759e-13  0              3.5790511    
   2300000   18000          200            200            0.0033155933  -8.4145162e-37  0              0.0099467799   1.33391e-13    0              6.440974e-09   1.1971759e-13  0              3.5790511    
   2400000   18000          200            200            0.0033155932  -8.4145162e-37  0              0.0099467796   7.0117367e-14  0              3.3857167e-09  1.1971759e-13  0              3.5790511    
   2500000   18000          200            200            0.0033155932   1.4024194e-36  0              0.0099467796   8.7371791e-15  0              4.2188711e-10  1.1971759e-13  0              3.5790511    
   2600000   18000          200            200            0.0033155932   1.4024194e-36  0              0.0099467796   2.6651614e-16  0              1.2869111e-11  1.1971759e-13  0              3.5790511    
   2700000   18000          200            200            0.0033155932  -2.243871e-36   0              0.0099467796   2.9060927e-17  0              1.4032482e-12  1.1971759e-13  0              3.5790511    
   2800000   18000          200            200            0.0033155932   1.1219355e-36  0              0.0099467796   2.3525752e-17  0              1.1359744e-12  1.1971759e-13  0              3.5790511    
   2900000   18000          200            200            0.0033155932   2.8048389e-37  0              0.0099467796   3.2842912e-18  0              1.5858667e-13  1.1971759e-13  0              3.5790511    
   3000000   18000          200            200            0.0033155932  -5.6096774e-37  0              0.0099467796   4.7786266e-18  0              2.3074278e-13  1.1971759e-13  0              3.5790511    
Loop time of 771.889 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3357994.287 ns/day, 0.000 hours/ns, 3886.567 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.7      | 246.18     | 248.66     |  15.8 | 31.89
Neigh   | 7.5297     | 7.53       | 7.5304     |   0.0 |  0.98
Comm    | 26.768     | 29.407     | 32.046     |  48.7 |  3.81
Output  | 0.64071    | 0.64074    | 0.64077    |   0.0 |  0.08
Modify  | 428.2      | 428.2      | 428.2      |   0.0 | 55.47
Other   |            | 59.93      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.17                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 83.5274971153375
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.27
  ghost atom cutoff = 4.27
  binsize = 2.135, bins = 8431 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 170.8 | 170.8 | 170.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00037379164  1.7950978e-34  0             -0.0011213749   786445.74      0              3.797465e+10   1.1971759e-13  0              3.8036388    
    200000   18000          200            200            3.9696556e-05  5.5536932e-41  0              0.00011908967  1002.647       0              48414235       1.1971759e-13  0              3.7546017    
    300000   18000          200            200            0.04956723    -5.3852848e-35  0              0.14870169     25500.194      0              1.2313131e+09  1.1971759e-13  0              3.5792307    
    400000   18000          200            200           -9.6515084e-05  5.3852971e-35  0             -0.00028954525  7816.3063      0              3.7742146e+08  1.1971759e-13  0              3.590072     
    500000   18000          200            200            0.0066765805   3.5901983e-35  0              0.020029742    3284.3928      0              1.5859157e+08  1.1971759e-13  0              3.5834995    
    600000   18000          200            200            0.0018583899   3.5901949e-35  0              0.0055751697   428.94061      0              20712007       1.1971759e-13  0              3.5843502    
    700000   18000          200            200            0.0043732178  -1.7950958e-35  0              0.013119654    15.378225      0              742559.43      1.1971759e-13  0              3.583861     
    800000   18000          200            200            0.0033973387  -2.6926443e-35  0              0.010192016    9.5350136      0              460411.68      1.1971759e-13  0              3.5840375    
    900000   18000          200            200            0.0032431652   4.4877505e-36  0              0.0097294956   0.94855772     0              45802.457      1.1971759e-13  0              3.5840664    
   1000000   18000          200            200            0.0032686347   3.5901943e-35  0              0.009805904    0.016677685    0              805.30571      1.1971759e-13  0              3.5840613    
   1100000   18000          200            200            0.0033019252  -8.9754808e-36  0              0.0099057757   0.0032363587   0              156.27218      1.1971759e-13  0              3.5840549    
   1200000   18000          200            200            0.0033169348   7.9909903e-43  0              0.0099508043   0.0023364728   0              112.81991      1.1971759e-13  0              3.5840521    
   1300000   18000          200            200            0.0033208207   5.609678e-37   0              0.009962462    0.00036644478  0              17.694307      1.1971759e-13  0              3.5840513    
   1400000   18000          200            200            0.003320986    2.8048388e-37  0              0.009962958    1.7537253e-05  0              0.8468112      1.1971759e-13  0              3.5840513    
   1500000   18000          200            200            0.0033205661   2.8048389e-37  0              0.0099616982   4.424873e-08   0              0.0021366128   1.1971759e-13  0              3.5840514    
   1600000   18000          200            200            0.0033203131   1.0319147e-44  0              0.0099609392   4.4423426e-07  0              0.021450483    1.1971759e-13  0              3.5840514    
   1700000   18000          200            200            0.0033202289   8.4145164e-37  0              0.0099606868   1.1524461e-07  0              0.00556475     1.1971759e-13  0              3.5840514    
   1800000   18000          200            200            0.0033202158   5.6096777e-37  0              0.0099606475   9.8713801e-09  0              0.00047665362  1.1971759e-13  0              3.5840515    
   1900000   18000          200            200            0.0033202197   1.0256809e-44  0              0.0099606591   1.017871e-10   0              4.9149347e-06  1.1971759e-13  0              3.5840514    
   2000000   18000          200            200            0.0033202235  -2.8048387e-37  0              0.0099606706   5.6354525e-11  0              2.7211583e-06  1.1971759e-13  0              3.5840514    
   2100000   18000          200            200            0.0033202251  -5.6096774e-37  0              0.0099606754   2.9830034e-11  0              1.4403856e-06  1.1971759e-13  0              3.5840514    
   2200000   18000          200            200            0.0033202255  -5.6096774e-37  0              0.0099606766   4.0866292e-12  0              1.973287e-07   1.1971759e-13  0              3.5840514    
   2300000   18000          200            200            0.0033202255   5.6096777e-37  0              0.0099606766   1.5690062e-13  0              7.5761692e-09  1.1971759e-13  0              3.5840514    
   2400000   18000          200            200            0.0033202255   2.8048389e-37  0              0.0099606764   2.3057374e-15  0              1.1133581e-10  1.1971759e-13  0              3.5840514    
   2500000   18000          200            200            0.0033202254  -8.6950002e-36  0              0.0099606763   6.0711882e-15  0              2.9315595e-10  1.1971759e-13  0              3.5840514    
   2600000   18000          200            200            0.0033202254  -5.6096774e-37  0              0.0099606763   1.356495e-15   0              6.550029e-11   1.1971759e-13  0              3.5840514    
   2700000   18000          200            200            0.0033202254   2.8048389e-37  0              0.0099606763   1.7953421e-16  0              8.6690647e-12  1.1971759e-13  0              3.5840514    
   2800000   18000          200            200            0.0033202254  -8.4145162e-37  0              0.0099606763   1.0108846e-17  0              4.8811997e-13  1.1971759e-13  0              3.5840514    
   2900000   18000          200            200            0.0033202254  -1.4024194e-36  0              0.0099606763   3.4243602e-19  0              1.653501e-14   1.1971759e-13  0              3.5840514    
   3000000   18000          200            200            0.0033202254   2.8048389e-37  0              0.0099606763   5.8542811e-18  0              2.8268228e-13  1.1971759e-13  0              3.5840514    
Loop time of 774.386 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3347169.684 ns/day, 0.000 hours/ns, 3874.039 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.81     | 245.74     | 247.67     |  12.3 | 31.73
Neigh   | 7.5578     | 7.5581     | 7.5584     |   0.0 |  0.98
Comm    | 27.431     | 29.243     | 31.055     |  33.5 |  3.78
Output  | 0.6281     | 0.62813    | 0.62815    |   0.0 |  0.08
Modify  | 429.8      | 431.11     | 432.42     |   6.3 | 55.67
Other   |            | 60.11      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.18                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 84.1298565612391
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.28
  ghost atom cutoff = 4.28
  binsize = 2.14, bins = 8412 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 170.4 | 170.4 | 170.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00037914519 -1.6155864e-34  0             -0.0011374356   774212.13      0              3.7383933e+10  1.1971759e-13  0              3.8127883    
    200000   18000          200            200            4.8749591e-05  5.3852973e-35  0              0.00014624877  1492.1352      0              72049870       1.1971759e-13  0              3.7592639    
    300000   18000          200            200            0.029268476    1.7951037e-35  0              0.087805427    62155.053      0              3.0012451e+09  1.1971759e-13  0              3.5859327    
    400000   18000          200            200           -8.7505143e-05  5.3852979e-35  0             -0.00026251543  6305.591       0              3.0447442e+08  1.1971759e-13  0              3.5958045    
    500000   18000          200            200            0.0099838817  -5.38529e-34    0              0.029951645    1887.3629      0              91134001       1.1971759e-13  0              3.5880331    
    600000   18000          200            200            0.0011515875   8.9754994e-36  0              0.0034547625   234.25826      0              11311493       1.1971759e-13  0              3.5895275    
    700000   18000          200            200            0.00450709    -8.9754736e-36  0              0.01352127     0.078118709    0              3772.0729      1.1971759e-13  0              3.5888386    
    800000   18000          200            200            0.003577666   -3.5901926e-35  0              0.010732998    6.2705889      0              302784.3       1.1971759e-13  0              3.5890048    
    900000   18000          200            200            0.0033184972   4.4877505e-36  0              0.0099554917   1.2894958      0              62265.139      1.1971759e-13  0              3.5890532    
   1000000   18000          200            200            0.0032892617   4.4877488e-36  0              0.0098677852   0.096479379    0              4658.6439      1.1971759e-13  0              3.5890586    
   1100000   18000          200            200            0.0033054598  -2.6926449e-35  0              0.0099163794   0.00074448924  0              35.948721      1.1971759e-13  0              3.5890555    
   1200000   18000          200            200            0.0033185116  -2.2438702e-36  0              0.0099555347   0.00064304251  0              31.050221      1.1971759e-13  0              3.589053     
   1300000   18000          200            200            0.0033238034   2.8048392e-37  0              0.0099714103   0.00032398913  0              15.644276      1.1971759e-13  0              3.589052     
   1400000   18000          200            200            0.0033250933  -1.1219355e-36  0              0.0099752799   4.7508036e-05  0              2.293993       1.1971759e-13  0              3.5890517    
   1500000   18000          200            200            0.0033251302   2.8048389e-37  0              0.0099753905   2.4008295e-06  0              0.11592746     1.1971759e-13  0              3.5890517    
   1600000   18000          200            200            0.0033249815   1.4024194e-36  0              0.0099749446   6.7164588e-10  0              3.2431376e-05  1.1971759e-13  0              3.5890517    
   1700000   18000          200            200            0.0033248922  -8.4145162e-37  0              0.0099746766   4.7725479e-08  0              0.0023044926   1.1971759e-13  0              3.5890518    
   1800000   18000          200            200            0.003324861    1.4024194e-36  0              0.009974583    1.4573471e-08  0              0.00070370076  1.1971759e-13  0              3.5890518    
   1900000   18000          200            200            0.003324855    1.4024194e-36  0              0.0099745651   1.5894049e-09  0              7.6746673e-05  1.1971759e-13  0              3.5890518    
   2000000   18000          200            200            0.0033248557  -8.4145162e-37  0              0.0099745672   4.5942629e-11  0              2.2184052e-06  1.1971759e-13  0              3.5890518    
   2100000   18000          200            200            0.0033248569   4.2072582e-36  0              0.0099745708   1.931847e-12   0              9.3281979e-08  1.1971759e-13  0              3.5890518    
   2200000   18000          200            200            0.0033248575   6.1706453e-36  0              0.0099745725   2.8227961e-12  0              1.3630272e-07  1.1971759e-13  0              3.5890518    
   2300000   18000          200            200            0.0033248577   1.1219355e-36  0              0.009974573    5.9621556e-13  0              2.8789115e-08  1.1971759e-13  0              3.5890518    
   2400000   18000          200            200            0.0033248577  -1.6829033e-36  0              0.0099745731   4.7056687e-14  0              2.272199e-09   1.1971759e-13  0              3.5890518    
   2500000   18000          200            200            0.0033248577   1.1219355e-36  0              0.0099745731   4.6730368e-16  0              2.2564422e-11  1.1971759e-13  0              3.5890518    
   2600000   18000          200            200            0.0033248577  -5.6096774e-37  0              0.009974573    2.0009941e-16  0              9.6620843e-12  1.1971759e-13  0              3.5890518    
   2700000   18000          200            200            0.0033248577  -8.4145162e-37  0              0.009974573    2.9805159e-17  0              1.4391845e-12  1.1971759e-13  0              3.5890518    
   2800000   18000          200            200            0.0033248577  -5.6096774e-37  0              0.009974573    1.6459678e-18  0              7.9477896e-14  1.1971759e-13  0              3.5890518    
   2900000   18000          200            200            0.0033248577  -8.4145162e-37  0              0.009974573    2.7813573e-18  0              1.3430179e-13  1.1971759e-13  0              3.5890518    
   3000000   18000          200            200            0.0033248577  -1.4024194e-36  0              0.009974573    6.3046228e-20  0              3.0442767e-15  1.1971759e-13  0              3.5890518    
Loop time of 768.578 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3372462.107 ns/day, 0.000 hours/ns, 3903.313 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.81     | 243.67     | 245.53     |  11.9 | 31.70
Neigh   | 7.5282     | 7.5283     | 7.5284     |   0.0 |  0.98
Comm    | 27.34      | 29.325     | 31.31      |  36.7 |  3.82
Output  | 0.6229     | 0.62292    | 0.62294    |   0.0 |  0.08
Modify  | 428.78     | 428.78     | 428.79     |   0.0 | 55.79
Other   |            | 58.65      |            |       |  7.63

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.19                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 84.7351050157449
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.29
  ghost atom cutoff = 4.29
  binsize = 2.145, bins = 8392 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 170 | 170 | 170 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00038435798 -3.5901844e-35  0             -0.0011530739   762081.85      0              3.6798205e+10  1.1971759e-13  0              3.8219062    
    200000   18000          200            200            5.7903639e-05  6.6928819e-41  0              0.00017371092  2077.9636      0              1.0033743e+08  1.1971759e-13  0              3.7638764    
    300000   18000          200            200            0.0087694687   5.3853006e-35  0              0.026308406    82160.121      0              3.9672182e+09  1.1971759e-13  0              3.5931553    
    400000   18000          200            200           -7.8323058e-05  7.080813e-41   0             -0.00023496917  4958.7601      0              2.3944078e+08  1.1971759e-13  0              3.6014595    
    500000   18000          200            200            0.012348812   -8.9754802e-35  0              0.037046436    464.6896       0              22438198       1.1971759e-13  0              3.5927314    
    600000   18000          200            200            0.00075742096  8.9754989e-36  0              0.0022722629   68.547677      0              3309922        1.1971759e-13  0              3.5946438    
    700000   18000          200            200            0.0044110067  -8.9754746e-36  0              0.01323302     11.625399      0              561348.92      1.1971759e-13  0              3.5938558    
    800000   18000          200            200            0.0037062011  -1.7950959e-35  0              0.011118603    1.9255119      0              92976.08       1.1971759e-13  0              3.5939822    
    900000   18000          200            200            0.0033959102  -1.795096e-35   0              0.010187731    1.0421477      0              50321.581      1.1971759e-13  0              3.5940397    
   1000000   18000          200            200            0.0033198903   4.4877488e-36  0              0.0099596709   0.16385565     0              7912.0031      1.1971759e-13  0              3.594054     
   1100000   18000          200            200            0.003315195   -1.7950965e-35  0              0.0099455849   0.010502157    0              507.11157      1.1971759e-13  0              3.5940548    
   1200000   18000          200            200            0.0033223864  -4.4877412e-36  0              0.0099671592   4.4951899e-05  0              2.1705663      1.1971759e-13  0              3.5940534    
   1300000   18000          200            200            0.0033272156   4.5538517e-44  0              0.0099816467   9.137192e-05   0              4.412023       1.1971759e-13  0              3.5940525    
   1400000   18000          200            200            0.0033290943  -5.6096775e-37  0              0.0099872828   4.1874407e-05  0              2.0219653      1.1971759e-13  0              3.5940522    
   1500000   18000          200            200            0.0033295577  -1.6829033e-36  0              0.009988673    6.3838836e-06  0              0.30825489     1.1971759e-13  0              3.5940521    
   1600000   18000          200            200            0.0033295815  -1.1219355e-36  0              0.0099887446   3.9240218e-07  0              0.018947697    1.1971759e-13  0              3.5940521    
   1700000   18000          200            200            0.0033295346   1.0365014e-44  0              0.0099886037   1.1585561e-09  0              5.5942526e-05  1.1971759e-13  0              3.5940521    
   1800000   18000          200            200            0.003329504    5.6096777e-37  0              0.0099885119   3.9021705e-09  0              0.00018842185  1.1971759e-13  0              3.5940521    
   1900000   18000          200            200            0.0033294923  -1.1219355e-36  0              0.0099884768   1.6809025e-09  0              8.1164765e-05  1.1971759e-13  0              3.5940521    
   2000000   18000          200            200            0.0033294894   2.243871e-36   0              0.0099884683   2.4828407e-10  0              1.1988749e-05  1.1971759e-13  0              3.5940521    
   2100000   18000          200            200            0.0033294893   2.8048389e-37  0              0.009988468    1.4614448e-11  0              7.056794e-07   1.1971759e-13  0              3.5940521    
   2200000   18000          200            200            0.0033294896  -5.6096774e-37  0              0.0099884689   2.6368759e-14  0              1.273253e-09   1.1971759e-13  0              3.5940521    
   2300000   18000          200            200            0.0033294898  -5.6096774e-37  0              0.0099884695   1.651851e-13   0              7.9761971e-09  1.1971759e-13  0              3.5940521    
   2400000   18000          200            200            0.0033294899  -1.0938871e-35  0              0.0099884697   6.7578024e-14  0              3.2631009e-09  1.1971759e-13  0              3.5940521    
   2500000   18000          200            200            0.0033294899   1.1219355e-36  0              0.0099884697   9.5734601e-15  0              4.6226812e-10  1.1971759e-13  0              3.5940521    
   2600000   18000          200            200            0.0033294899  -2.8048387e-37  0              0.0099884698   5.7335779e-16  0              2.7685395e-11  1.1971759e-13  0              3.5940521    
   2700000   18000          200            200            0.0033294899  -8.4145162e-37  0              0.0099884697   8.7916616e-17  0              4.2451787e-12  1.1971759e-13  0              3.5940521    
   2800000   18000          200            200            0.0033294899   4.487742e-36   0              0.0099884697   2.3671363e-17  0              1.1430054e-12  1.1971759e-13  0              3.5940521    
   2900000   18000          200            200            0.0033294899  -3.3658065e-36  0              0.0099884697   6.9972835e-18  0              3.3787378e-13  1.1971759e-13  0              3.5940521    
   3000000   18000          200            200            0.0033294899   2.8048388e-37  0              0.0099884697   1.5244778e-20  0              7.3611579e-16  1.1971759e-13  0              3.5940521    
Loop time of 766.645 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3380964.906 ns/day, 0.000 hours/ns, 3913.154 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.17     | 242.02     | 243.88     |  12.0 | 31.57
Neigh   | 7.598      | 7.5985     | 7.599      |   0.0 |  0.99
Comm    | 27.652     | 29.61      | 31.568     |  36.0 |  3.86
Output  | 0.63593    | 0.63597    | 0.63601    |   0.0 |  0.08
Modify  | 427.83     | 427.96     | 428.08     |   0.6 | 55.82
Other   |            | 58.82      |            |       |  7.67

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.2                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 85.343249390359
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.3
  ghost atom cutoff = 4.3
  binsize = 2.15, bins = 8373 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 169.7 | 169.7 | 169.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00038943055  8.9755148e-36  0             -0.0011682916   750053.96      0              3.6217422e+10  1.1971759e-13  0              3.8309925    
    200000   18000          200            200            6.7159851e-05  3.5902003e-35  0              0.00020147955  2759.98        0              1.3326956e+08  1.1971759e-13  0              3.768439     
    300000   18000          200            200           -0.00025977114  1.077059e-34   0             -0.00077931343  80959.657      0              3.9092521e+09  1.1971759e-13  0              3.6005067    
    400000   18000          200            200           -6.8968357e-05 -1.7950895e-35  0             -0.00020690507  3774.9055      0              1.8227668e+08  1.1971759e-13  0              3.6070368    
    500000   18000          200            200            0.012986289    4.6398357e-41  0              0.038958866    21.11056       0              1019353.4      1.1971759e-13  0              3.5976529    
    600000   18000          200            200            0.00063187446  4.4877437e-35  0              0.0018956234   0.2380049      0              11492.405      1.1971759e-13  0              3.5996872    
    700000   18000          200            200            0.0041082975   5.3852914e-35  0              0.012324892    41.365644      0              1997398.9      1.1971759e-13  0              3.5989095    
    800000   18000          200            200            0.0037539905   8.9754935e-36  0              0.011261971    0.00067002708  0              32.35321       1.1971759e-13  0              3.5989744    
    900000   18000          200            200            0.0034574733   4.4877504e-36  0              0.01037242     0.43102378     0              20812.596      1.1971759e-13  0              3.5990293    
   1000000   18000          200            200            0.0033532883   1.7950975e-35  0              0.010059865    0.14847072     0              7169.1198      1.1971759e-13  0              3.5990489    
   1100000   18000          200            200            0.0033295059   4.4877454e-36  0              0.0099885178   0.020942167    0              1011.2223      1.1971759e-13  0              3.5990533    
   1200000   18000          200            200            0.003328831    6.7316139e-36  0              0.0099864929   0.0013130882   0              63.404331      1.1971759e-13  0              3.5990534    
   1300000   18000          200            200            0.0033315515   2.8048392e-37  0              0.0099946546   7.4302318e-06  0              0.3587793      1.1971759e-13  0              3.5990529    
   1400000   18000          200            200            0.0033332746  -2.8048387e-37  0              0.0099998239   9.7898589e-06  0              0.47271725     1.1971759e-13  0              3.5990526    
   1500000   18000          200            200            0.0033339514  -3.3658065e-36  0              0.010001854    5.0031666e-06  0              0.24158501     1.1971759e-13  0              3.5990524    
   1600000   18000          200            200            0.0033341311  -2.8048387e-37  0              0.010002393    8.6740307e-07  0              0.04188379     1.1971759e-13  0              3.5990524    
   1700000   18000          200            200            0.00333415    -1.9633871e-36  0              0.01000245     7.021748e-08   0              0.0033905508   1.1971759e-13  0              3.5990524    
   1800000   18000          200            200            0.0033341377   1.1219355e-36  0              0.010002413    1.3404841e-09  0              6.4727179e-05  1.1971759e-13  0              3.5990524    
   1900000   18000          200            200            0.0033341278  -8.4145162e-37  0              0.010002383    1.6545119e-10  0              7.9890458e-06  1.1971759e-13  0              3.5990524    
   2000000   18000          200            200            0.0033341235   8.4145164e-37  0              0.010002371    1.5716614e-10  0              7.5889904e-06  1.1971759e-13  0              3.5990524    
   2100000   18000          200            200            0.0033341222  -8.4145162e-37  0              0.010002367    3.4031867e-11  0              1.6432771e-06  1.1971759e-13  0              3.5990524    
   2200000   18000          200            200            0.003334122   -5.6096774e-37  0              0.010002366    3.4346036e-12  0              1.6584472e-07  1.1971759e-13  0              3.5990524    
   2300000   18000          200            200            0.0033341221  -5.6096774e-37  0              0.010002366    1.1897928e-13  0              5.7450836e-09  1.1971759e-13  0              3.5990524    
   2400000   18000          200            200            0.0033341221  -2.8048387e-37  0              0.010002366    1.2576316e-15  0              6.0726528e-11  1.1971759e-13  0              3.5990524    
   2500000   18000          200            200            0.0033341221   1.6829033e-36  0              0.010002366    4.5723182e-15  0              2.2078088e-10  1.1971759e-13  0              3.5990524    
   2600000   18000          200            200            0.0033341221   2.8048389e-37  0              0.010002366    1.2372793e-15  0              5.9743791e-11  1.1971759e-13  0              3.5990524    
   2700000   18000          200            200            0.0033341221   2.8048389e-37  0              0.010002366    1.5404102e-16  0              7.4380897e-12  1.1971759e-13  0              3.5990524    
   2800000   18000          200            200            0.0033341221  -2.8048387e-37  0              0.010002366    3.1345264e-18  0              1.5135506e-13  1.1971759e-13  0              3.5990524    
   2900000   18000          200            200            0.0033341221   2.243871e-36   0              0.010002366    5.1076839e-18  0              2.4663178e-13  1.1971759e-13  0              3.5990524    
   3000000   18000          200            200            0.0033341221  -5.6096774e-37  0              0.010002366    1.0535324e-19  0              5.087131e-15   1.1971759e-13  0              3.5990524    
Loop time of 768.82 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3371399.803 ns/day, 0.000 hours/ns, 3902.083 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.9      | 244.56     | 247.22     |  17.0 | 31.81
Neigh   | 7.6663     | 7.6669     | 7.6674     |   0.0 |  1.00
Comm    | 27.307     | 30.214     | 33.121     |  52.9 |  3.93
Output  | 0.62172    | 0.62174    | 0.62176    |   0.0 |  0.08
Modify  | 427.39     | 427.5      | 427.61     |   0.5 | 55.60
Other   |            | 58.26      |            |       |  7.58

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.21                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 85.9542965965847
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.31
  ghost atom cutoff = 4.31
  binsize = 2.155, bins = 8353 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 166.2 | 166.2 | 166.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00039436321 -7.1803736e-35  0             -0.0011830896   738128.85      0              3.5641601e+10  1.1971759e-13  0              3.8400471    
    200000   18000          200            200            7.6516277e-05  1.2565683e-34  0              0.00022954883  3537.8264      0              1.7082897e+08  1.1971759e-13  0              3.7729516    
    300000   18000          200            200           -0.00025448054  3.590201e-35   0             -0.00076344163  75895.34       0              3.6647143e+09  1.1971759e-13  0              3.6078003    
    400000   18000          200            200           -5.9443698e-05  3.5902007e-35  0             -0.00017833109  2753.5628      0              1.3295969e+08  1.1971759e-13  0              3.6125364    
    500000   18000          200            200            0.011664687    1.7951012e-35  0              0.03499406     886.70558      0              42815839       1.1971759e-13  0              3.6028141    
    600000   18000          200            200            0.00074662842  5.3852921e-35  0              0.0022398853   53.796058      0              2597619.1      1.1971759e-13  0              3.6046538    
    700000   18000          200            200            0.0036694694  -1.7950959e-35  0              0.011008408    67.694725      0              3268736        1.1971759e-13  0              3.6039893    
    800000   18000          200            200            0.0037105051   2.6926461e-35  0              0.011131515    2.0462644      0              98806.782      1.1971759e-13  0              3.6039833    
    900000   18000          200            200            0.0034887929   8.9754923e-36  0              0.010466379    0.017270804    0              833.94534      1.1971759e-13  0              3.6040246    
   1000000   18000          200            200            0.0033813637   4.4877488e-36  0              0.010144091    0.066381151    0              3205.3082      1.1971759e-13  0              3.6040447    
   1100000   18000          200            200            0.003345304    1.3463229e-35  0              0.010035912    0.019759262    0              954.10405      1.1971759e-13  0              3.6040515    
   1200000   18000          200            200            0.0033371893  -4.4877412e-36  0              0.010011568    0.0027650654   0              133.51511      1.1971759e-13  0              3.604053     
   1300000   18000          200            200            0.0033369303  -2.8048383e-37  0              0.010010791    0.00019217704  0              9.2795413      1.1971759e-13  0              3.6040531    
   1400000   18000          200            200            0.0033378381  -5.6096775e-37  0              0.010013514    2.5992223e-06  0              0.12550714     1.1971759e-13  0              3.6040529    
   1500000   18000          200            200            0.0033384307   8.4145164e-37  0              0.010015292    6.9099965e-07  0              0.0333659      1.1971759e-13  0              3.6040528    
   1600000   18000          200            200            0.0033386758  -5.6096774e-37  0              0.010016027    5.2309329e-07  0              0.025258303    1.1971759e-13  0              3.6040527    
   1700000   18000          200            200            0.0033387486   1.1219355e-36  0              0.010016246    1.1257877e-07  0              0.0054360258   1.1971759e-13  0              3.6040527    
   1800000   18000          200            200            0.0033387612  -1.6829033e-36  0              0.010016283    1.2379775e-08  0              0.00059777504  1.1971759e-13  0              3.6040527    
   1900000   18000          200            200            0.0033387593   5.6096777e-37  0              0.010016278    5.911676e-10   0              2.8545368e-05  1.1971759e-13  0              3.6040527    
   2000000   18000          200            200            0.0033387565  -2.8048387e-37  0              0.01001627     1.0503014e-13  0              5.0715295e-09  1.1971759e-13  0              3.6040527    
   2100000   18000          200            200            0.0033387551   2.5243549e-36  0              0.010016265    8.9832859e-12  0              4.3377073e-07  1.1971759e-13  0              3.6040527    
   2200000   18000          200            200            0.0033387545  -1.1219355e-36  0              0.010016264    3.5507367e-12  0              1.7145237e-07  1.1971759e-13  0              3.6040527    
   2300000   18000          200            200            0.0033387544  -3.9267743e-36  0              0.010016263    5.8618878e-13  0              2.8304958e-08  1.1971759e-13  0              3.6040527    
   2400000   18000          200            200            0.0033387544   5.6096777e-37  0              0.010016263    4.9824274e-14  0              2.4058359e-09  1.1971759e-13  0              3.6040527    
   2500000   18000          200            200            0.0033387544  -1.9633871e-36  0              0.010016263    1.3246809e-15  0              6.39641e-11    1.1971759e-13  0              3.6040527    
   2600000   18000          200            200            0.0033387544   2.8048389e-37  0              0.010016263    1.5585355e-17  0              7.5256099e-13  1.1971759e-13  0              3.6040527    
   2700000   18000          200            200            0.0033387544   5.6096777e-37  0              0.010016263    7.6601265e-20  0              3.6988009e-15  1.1971759e-13  0              3.6040527    
   2800000   18000          200            200            0.0033387544  -2.8048387e-37  0              0.010016263    1.429275e-17   0              6.9014577e-13  1.1971759e-13  0              3.6040527    
   2900000   18000          200            200            0.0033387544  -5.6096774e-37  0              0.010016263    1.5533511e-17  0              7.5005764e-13  1.1971759e-13  0              3.6040527    
   3000000   18000          200            200            0.0033387544  -8.4145162e-37  0              0.010016263    4.0114788e-19  0              1.9369995e-14  1.1971759e-13  0              3.6040527    
Loop time of 768.311 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3373631.892 ns/day, 0.000 hours/ns, 3904.667 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240        | 242.51     | 245.02     |  16.1 | 31.56
Neigh   | 7.6419     | 7.6421     | 7.6422     |   0.0 |  0.99
Comm    | 27.258     | 30.017     | 32.775     |  50.3 |  3.91
Output  | 0.62183    | 0.62186    | 0.62188    |   0.0 |  0.08
Modify  | 428.81     | 428.81     | 428.82     |   0.0 | 55.81
Other   |            | 58.71      |            |       |  7.64

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.22                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 86.5682535459263
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.32
  ghost atom cutoff = 4.32
  binsize = 2.16, bins = 8334 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 165.8 | 165.8 | 165.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0003991564  -3.5901799e-35  0             -0.0011974692   726305.98      0              3.5070716e+10  1.1971759e-13  0              3.8490701    
    200000   18000          200            200            8.5972752e-05 -3.5901874e-35  0              0.00025791825  4411.2687      0              2.1300438e+08  1.1971759e-13  0              3.7774142    
    300000   18000          200            200           -0.00024899624  3.5902019e-35  0             -0.00074698873  70999.972      0              3.4283346e+09  1.1971759e-13  0              3.6150235    
    400000   18000          200            200           -4.9749684e-05  5.385297e-35   0             -0.00014924905  1894.0076      0              91454847       1.1971759e-13  0              3.617958     
    500000   18000          200            200            0.0088261318  -1.2565674e-34  0              0.026478395    2406.4493      0              1.1619882e+08  1.1971759e-13  0              3.6081831    
    600000   18000          200            200            0.0011257382   3.590195e-35   0              0.0033772146   209.11066      0              10097205       1.1971759e-13  0              3.6095464    
    700000   18000          200            200            0.0031886725  -8.9754749e-36  0              0.0095660175   72.425551      0              3497170.6      1.1971759e-13  0              3.6090805    
    800000   18000          200            200            0.0035869813  -4.4877411e-35  0              0.010760944    6.3596061      0              307082.62      1.1971759e-13  0              3.609007     
    900000   18000          200            200            0.0034829776  -4.4877338e-36  0              0.010448933    0.18044134     0              8712.8664      1.1971759e-13  0              3.6090267    
   1000000   18000          200            200            0.0033974499  -8.9754774e-36  0              0.01019235     0.0033365318   0              161.10918      1.1971759e-13  0              3.6090428    
   1100000   18000          200            200            0.0033590126  -4.4877387e-36  0              0.010077038    0.008365738    0              403.95155      1.1971759e-13  0              3.6090501    
   1200000   18000          200            200            0.003346114    8.4033206e-43  0              0.010038342    0.0024889036   0              120.18025      1.1971759e-13  0              3.6090525    
   1300000   18000          200            200            0.0033430483   5.609678e-37   0              0.010029145    0.00037440527  0              18.078691      1.1971759e-13  0              3.6090531    
   1400000   18000          200            200            0.0033428152   2.8048388e-37  0              0.010028446    3.1463673e-05  0              1.5192682      1.1971759e-13  0              3.6090531    
   1500000   18000          200            200            0.0033430717   1.9633872e-36  0              0.010029215    9.6692345e-07  0              0.046689273    1.1971759e-13  0              3.6090531    
   1600000   18000          200            200            0.0033432637   2.8048389e-37  0              0.010029791    1.4199076e-08  0              0.00068562257  1.1971759e-13  0              3.609053     
   1700000   18000          200            200            0.0033433507  -6.1706453e-36  0              0.010030052    4.1709797e-08  0              0.0020140168   1.1971759e-13  0              3.609053     
   1800000   18000          200            200            0.0033433802   1.1219355e-36  0              0.010030141    1.2716317e-08  0              0.00061402542  1.1971759e-13  0              3.609053     
   1900000   18000          200            200            0.0033433873   2.8048389e-37  0              0.010030162    1.9414695e-09  0              9.3746614e-05  1.1971759e-13  0              3.609053     
   2000000   18000          200            200            0.0033433879   2.8048389e-37  0              0.010030164    1.6594674e-10  0              8.012974e-06   1.1971759e-13  0              3.609053     
   2100000   18000          200            200            0.0033433873  -4.7682259e-36  0              0.010030162    5.3246835e-12  0              2.5710991e-07  1.1971759e-13  0              3.609053     
   2200000   18000          200            200            0.0033433869  -1.6829033e-36  0              0.010030161    5.8672076e-14  0              2.8330646e-09  1.1971759e-13  0              3.609053     
   2300000   18000          200            200            0.0033433867  -2.8048387e-37  0              0.01003016     2.0800475e-13  0              1.0043805e-08  1.1971759e-13  0              3.609053     
   2400000   18000          200            200            0.0033433866   6.4511292e-36  0              0.01003016     6.5077971e-14  0              3.1423823e-09  1.1971759e-13  0              3.609053     
   2500000   18000          200            200            0.0033433866   8.4145164e-37  0              0.01003016     1.0068169e-14  0              4.8615587e-10  1.1971759e-13  0              3.609053     
   2600000   18000          200            200            0.0033433866   2.8048389e-37  0              0.01003016     9.8245131e-16  0              4.7439058e-11  1.1971759e-13  0              3.609053     
   2700000   18000          200            200            0.0033433866   1.0342139e-44  0              0.01003016     1.5236245e-16  0              7.3570372e-12  1.1971759e-13  0              3.609053     
   2800000   18000          200            200            0.0033433866   5.6096777e-37  0              0.01003016     8.4050131e-18  0              4.05848e-13    1.1971759e-13  0              3.609053     
   2900000   18000          200            200            0.0033433866  -2.8048386e-37  0              0.01003016     6.4771895e-18  0              3.127603e-13   1.1971759e-13  0              3.609053     
   3000000   18000          200            200            0.0033433866   7.3427354e-45  0              0.01003016     1.5276523e-18  0              7.376486e-14   1.1971759e-13  0              3.609053     
Loop time of 770.825 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3362630.235 ns/day, 0.000 hours/ns, 3891.933 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.48     | 243.79     | 246.11     |  14.8 | 31.63
Neigh   | 7.2447     | 7.2448     | 7.245      |   0.0 |  0.94
Comm    | 26.153     | 28.645     | 31.138     |  46.6 |  3.72
Output  | 0.6247     | 0.62472    | 0.62473    |   0.0 |  0.08
Modify  | 428.69     | 428.77     | 428.85     |   0.4 | 55.62
Other   |            | 61.75      |            |       |  8.01

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.23                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 87.1851271498876
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.33
  ghost atom cutoff = 4.33
  binsize = 2.165, bins = 8315 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 165.5 | 165.5 | 165.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00040381053  5.3853e-35     0             -0.0012114316   714585.1       0              3.4504757e+10  1.1971759e-13  0              3.8580612    
    200000   18000          200            200            9.5529652e-05  3.5902005e-35  0              0.00028658896  5380.1486      0              2.5978812e+08  1.1971759e-13  0              3.7818264    
    300000   18000          200            200           -0.00024331879  1.7951056e-35  0             -0.00072995637  66272.52       0              3.2000628e+09  1.1971759e-13  0              3.6221763    
    400000   18000          200            200           -3.9885857e-05  1.7951028e-35  0             -0.00011965757  1195.5037      0              57726594       1.1971759e-13  0              3.6233015    
    500000   18000          200            200            0.0053758749  -1.7950924e-35  0              0.016127625    3531.4636      0              1.7052174e+08  1.1971759e-13  0              3.6136909    
    600000   18000          200            200            0.0018168301   1.6931808e-41  0              0.0054504902   401.76084      0              19399593       1.1971759e-13  0              3.6143758    
    700000   18000          200            200            0.0027563234  -6.2828379e-35  0              0.0082689701   53.204709      0              2569065        1.1971759e-13  0              3.6141667    
    800000   18000          200            200            0.0034130769   8.482256e-42   0              0.010239231    9.4192524      0              454821.99      1.1971759e-13  0              3.6140404    
    900000   18000          200            200            0.0034426427   2.2438718e-35  0              0.010327928    0.76473848     0              36926.484      1.1971759e-13  0              3.6140354    
   1000000   18000          200            200            0.0033982584  -4.4877356e-36  0              0.010194775    0.024918838    0              1203.2415      1.1971759e-13  0              3.6140438    
   1100000   18000          200            200            0.0033677133  -1.3463223e-35  0              0.01010314     0.00017474733  0              8.4379233      1.1971759e-13  0              3.6140496    
   1200000   18000          200            200            0.0033540528  -1.5707096e-35  0              0.010062158    0.00085176138  0              41.128509      1.1971759e-13  0              3.6140522    
   1300000   18000          200            200            0.003349303   -1.6829032e-36  0              0.010047909    0.00028863923  0              13.937355      1.1971759e-13  0              3.6140531    
   1400000   18000          200            200            0.0033480497   5.6096776e-37  0              0.010044149    4.9934606e-05  0              2.4111634      1.1971759e-13  0              3.6140533    
   1500000   18000          200            200            0.0033478698  -8.4145162e-37  0              0.01004361     5.296351e-06   0              0.25574184     1.1971759e-13  0              3.6140534    
   1600000   18000          200            200            0.0033479191   1.0036654e-44  0              0.010043757    3.0016538e-07  0              0.014493912    1.1971759e-13  0              3.6140533    
   1700000   18000          200            200            0.0033479745   2.8048389e-37  0              0.010043923    2.4031698e-09  0              0.00011604047  1.1971759e-13  0              3.6140533    
   1800000   18000          200            200            0.0033480035   8.4145164e-37  0              0.01004401     1.6462977e-09  0              7.9493825e-05  1.1971759e-13  0              3.6140533    
   1900000   18000          200            200            0.0033480148   8.4145164e-37  0              0.010044044    1.0553442e-09  0              5.0958793e-05  1.1971759e-13  0              3.6140533    
   2000000   18000          200            200            0.0033480183   3.3658065e-36  0              0.010044055    2.4069393e-10  0              1.1622248e-05  1.1971759e-13  0              3.6140533    
   2100000   18000          200            200            0.003348019    5.6096777e-37  0              0.010044057    3.2340995e-11  0              1.5616309e-06  1.1971759e-13  0              3.6140533    
   2200000   18000          200            200            0.003348019    1.1499839e-35  0              0.010044057    2.5920788e-12  0              1.2516221e-07  1.1971759e-13  0              3.6140533    
   2300000   18000          200            200            0.0033480189  -2.8048387e-37  0              0.010044057    8.1053463e-14  0              3.9137817e-09  1.1971759e-13  0              3.6140533    
   2400000   18000          200            200            0.0033480189   1.1219355e-36  0              0.010044057    8.9011038e-16  0              4.2980245e-11  1.1971759e-13  0              3.6140533    
   2500000   18000          200            200            0.0033480189   1.0174298e-44  0              0.010044057    3.175016e-15   0              1.5331016e-10  1.1971759e-13  0              3.6140533    
   2600000   18000          200            200            0.0033480188   5.6096777e-37  0              0.010044057    9.1507966e-16  0              4.4185922e-11  1.1971759e-13  0              3.6140533    
   2700000   18000          200            200            0.0033480188   2.8048389e-37  0              0.010044057    7.6808861e-17  0              3.708825e-12   1.1971759e-13  0              3.6140533    
   2800000   18000          200            200            0.0033480188   1.0408976e-44  0              0.010044057    2.1711937e-18  0              1.0483917e-13  1.1971759e-13  0              3.6140533    
   2900000   18000          200            200            0.0033480188   2.8048389e-37  0              0.010044057    1.8668272e-18  0              9.0142405e-14  1.1971759e-13  0              3.6140533    
   3000000   18000          200            200            0.0033480188   1.2360426e-44  0              0.010044057    2.2131766e-18  0              1.0686638e-13  1.1971759e-13  0              3.6140533    
Loop time of 773.39 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3351477.062 ns/day, 0.000 hours/ns, 3879.024 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.25     | 243.05     | 243.84     |   5.1 | 31.43
Neigh   | 7.0751     | 7.0765     | 7.0778     |   0.1 |  0.91
Comm    | 26.376     | 27.543     | 28.709     |  22.2 |  3.56
Output  | 0.62194    | 0.62195    | 0.62196    |   0.0 |  0.08
Modify  | 432.14     | 433.7      | 435.26     |   7.5 | 56.08
Other   |            | 61.4       |            |       |  7.94

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.24                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 87.804924319972
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.34
  ghost atom cutoff = 4.34
  binsize = 2.17, bins = 8295 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 165.1 | 165.1 | 165.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00040832596  3.5902073e-35  0             -0.0012249779   702966.22      0              3.3943723e+10  1.1971759e-13  0              3.8670205    
    200000   18000          200            200            0.00010518506 -1.7950959e-34  0              0.00031555519  6444.077       0              3.1116141e+08  1.1971759e-13  0              3.7861884    
    300000   18000          200            200           -0.00023745068 -5.3852823e-35  0             -0.00071235204  61713.446      0              2.9799215e+09  1.1971759e-13  0              3.6292582    
    400000   18000          200            200           -2.9856454e-05  5.3852976e-35  0             -8.9569363e-05  657.64636      0              31755389       1.1971759e-13  0              3.6285666    
    500000   18000          200            200            0.0022877702   1.9566556e-33  0              0.0068633106   3668.183       0              1.7712343e+08  1.1971759e-13  0              3.6192518    
    600000   18000          200            200            0.0028240376  -1.7950952e-35  0              0.0084721128   535.53894      0              25859259       1.1971759e-13  0              3.6191616    
    700000   18000          200            200            0.0024403196  -8.9754748e-36  0              0.0073209587   23.532219      0              1136286.6      1.1971759e-13  0              3.619233     
    800000   18000          200            200            0.0032284896   8.7554754e-42  0              0.0096854687   8.7907449      0              424473.61      1.1971759e-13  0              3.6190765    
    900000   18000          200            200            0.0033792155   8.0304566e-42  0              0.010137647    1.2259959      0              59198.955      1.1971759e-13  0              3.6190484    
   1000000   18000          200            200            0.0033848729   2.6926459e-35  0              0.010154619    0.10775482     0              5203.0946      1.1971759e-13  0              3.6190475    
   1100000   18000          200            200            0.0033700933  -4.4877388e-36  0              0.01011028     0.0047619437   0              229.93722      1.1971759e-13  0              3.6190503    
   1200000   18000          200            200            0.0033598084   8.1846761e-43  0              0.010079425    3.9495809e-06  0              0.19071113     1.1971759e-13  0              3.6190523    
   1300000   18000          200            200            0.003355037    5.609678e-37   0              0.010065111    6.0352322e-05  0              2.9141976      1.1971759e-13  0              3.6190532    
   1400000   18000          200            200            0.00335327     4.2072582e-37  0              0.01005981     2.8514847e-05  0              1.3768799      1.1971759e-13  0              3.6190535    
   1500000   18000          200            200            0.003352742   -5.6096775e-37  0              0.010058226    6.0995312e-06  0              0.29452453     1.1971759e-13  0              3.6190536    
   1600000   18000          200            200            0.0033526292   5.6096777e-37  0              0.010057887    8.3277369e-07  0              0.040211661    1.1971759e-13  0              3.6190536    
   1700000   18000          200            200            0.0033526248  -2.5243549e-36  0              0.010057874    7.3926392e-08  0              0.0035696409   1.1971759e-13  0              3.6190536    
   1800000   18000          200            200            0.0033526368  -2.8048387e-37  0              0.01005791     3.3378155e-09  0              0.00016117116  1.1971759e-13  0              3.6190536    
   1900000   18000          200            200            0.0033526452   2.8048389e-37  0              0.010057936    4.0857215e-12  0              1.9728487e-07  1.1971759e-13  0              3.6190536    
   2000000   18000          200            200            0.0033526491   2.8048389e-37  0              0.010057947    3.936382e-11   0              1.900738e-06   1.1971759e-13  0              3.6190536    
   2100000   18000          200            200            0.0033526506  -5.6096774e-37  0              0.010057952    1.9082935e-11  0              9.2144662e-07  1.1971759e-13  0              3.6190536    
   2200000   18000          200            200            0.003352651    1.0291162e-44  0              0.010057953    4.121284e-12   0              1.9900206e-07  1.1971759e-13  0              3.6190536    
   2300000   18000          200            200            0.0033526511   2.8048388e-36  0              0.010057953    5.6737762e-13  0              2.7396634e-08  1.1971759e-13  0              3.6190536    
   2400000   18000          200            200            0.0033526511   1.4024194e-36  0              0.010057953    5.0620796e-14  0              2.4442971e-09  1.1971759e-13  0              3.6190536    
   2500000   18000          200            200            0.0033526511   1.0067456e-44  0              0.010057953    2.2461959e-15  0              1.0846076e-10  1.1971759e-13  0              3.6190536    
   2600000   18000          200            200            0.0033526511   5.6096777e-37  0              0.010057953    1.2623005e-17  0              6.0951971e-13  1.1971759e-13  0              3.6190536    
   2700000   18000          200            200            0.0033526511   8.4145164e-37  0              0.010057953    2.4559041e-17  0              1.1858682e-12  1.1971759e-13  0              3.6190536    
   2800000   18000          200            200            0.0033526511  -5.6096774e-37  0              0.010057953    2.3858499e-17  0              1.1520415e-12  1.1971759e-13  0              3.6190536    
   2900000   18000          200            200            0.0033526511  -5.6096774e-37  0              0.010057953    7.7561294e-18  0              3.7451573e-13  1.1971759e-13  0              3.6190536    
   3000000   18000          200            200            0.0033526511  -2.8048387e-37  0              0.010057953    1.3684984e-18  0              6.6079892e-14  1.1971759e-13  0              3.6190536    
Loop time of 770.669 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3363313.326 ns/day, 0.000 hours/ns, 3892.724 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.98     | 245.37     | 248.76     |  21.6 | 31.84
Neigh   | 7.0304     | 7.031      | 7.0315     |   0.0 |  0.91
Comm    | 25.717     | 29.368     | 33.02      |  67.4 |  3.81
Output  | 0.6243     | 0.62432    | 0.62434    |   0.0 |  0.08
Modify  | 428.56     | 428.76     | 428.97     |   1.0 | 55.64
Other   |            | 59.51      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.25                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 88.427651967684
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.35
  ghost atom cutoff = 4.35
  binsize = 2.175, bins = 8276 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 161.7 | 161.7 | 161.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00041270306  7.1803967e-35  0             -0.0012381092   691449.15      0              3.3387605e+10  1.1971759e-13  0              3.875948     
    200000   18000          200            200            0.00011493875 -1.7950904e-35  0              0.00034481625  7602.8287      0              3.6711339e+08  1.1971759e-13  0              3.7904999    
    300000   18000          200            200           -0.00023139266  8.8920738e-41  0             -0.00069417799  57321.822      0              2.7678656e+09  1.1971759e-13  0              3.636269     
    400000   18000          200            200           -1.9661617e-05 -3.590187e-35   0             -5.8984851e-05  279.71914      0              13506636       1.1971759e-13  0              3.6337532    
    500000   18000          200            200            0.00029180348  1.0770586e-34  0              0.00087541044  2975.0792      0              1.4365593e+08  1.1971759e-13  0              3.6247888    
    600000   18000          200            200            0.0040537026   5.3852923e-35  0              0.012161108    525.97753      0              25397573       1.1971759e-13  0              3.6239322    
    700000   18000          200            200            0.0022803626  -3.5901925e-35  0              0.0068410879   2.6369343      0              127328.12      1.1971759e-13  0              3.6242686    
    800000   18000          200            200            0.0030727751  -4.4877412e-35  0              0.0092183253   5.0302742      0              242893.94      1.1971759e-13  0              3.6241077    
    900000   18000          200            200            0.0033097139  -8.975476e-36   0              0.0099291416   1.1397409      0              55034.01       1.1971759e-13  0              3.6240627    
   1000000   18000          200            200            0.003362431    3.5901943e-35  0              0.010087293    0.16449833     0              7943.0359      1.1971759e-13  0              3.6240529    
   1100000   18000          200            200            0.0033668789   4.4877452e-36  0              0.010100637    0.01660584     0              801.83658      1.1971759e-13  0              3.6240521    
   1200000   18000          200            200            0.0033629754   4.4877428e-36  0              0.010088926    0.0010456968   0              50.492958      1.1971759e-13  0              3.6240529    
   1300000   18000          200            200            0.0033598049   5.6096779e-37  0              0.010079415    2.0781129e-05  0              1.0034463      1.1971759e-13  0              3.6240535    
   1400000   18000          200            200            0.0033582114  -2.8048387e-37  0              0.010074634    1.4892673e-06  0              0.071911389    1.1971759e-13  0              3.6240538    
   1500000   18000          200            200            0.0033575688   1.1219355e-36  0              0.010072706    1.9899967e-06  0              0.09608982     1.1971759e-13  0              3.6240539    
   1600000   18000          200            200            0.0033573511   1.9633872e-36  0              0.010072053    6.0440932e-07  0              0.029184763    1.1971759e-13  0              3.6240539    
   1700000   18000          200            200            0.0033572908  -2.8048388e-35  0              0.010071873    1.0983105e-07  0              0.0053033483   1.1971759e-13  0              3.6240539    
   1800000   18000          200            200            0.0033572794   5.6096777e-37  0              0.010071838    1.3952173e-08  0              0.00067370052  1.1971759e-13  0              3.6240539    
   1900000   18000          200            200            0.0033572797   1.0488878e-44  0              0.010071839    1.2220922e-09  0              5.9010459e-05  1.1971759e-13  0              3.6240539    
   2000000   18000          200            200            0.0033572814   1.4024194e-36  0              0.010071844    5.9471777e-11  0              2.8716793e-06  1.1971759e-13  0              3.6240539    
   2100000   18000          200            200            0.0033572825   1.0365003e-44  0              0.010071848    2.8145633e-13  0              1.3590519e-08  1.1971759e-13  0              3.6240539    
   2200000   18000          200            200            0.003357283   -2.8048387e-37  0              0.010071849    4.3652945e-13  0              2.1078445e-08  1.1971759e-13  0              3.6240539    
   2300000   18000          200            200            0.0033572832   2.8048389e-37  0              0.01007185     2.5949854e-13  0              1.2530256e-08  1.1971759e-13  0              3.6240539    
   2400000   18000          200            200            0.0033572833   1.0467683e-44  0              0.01007185     6.2926466e-14  0              3.0384938e-09  1.1971759e-13  0              3.6240539    
   2500000   18000          200            200            0.0033572833   1.0658387e-35  0              0.01007185     9.9983225e-15  0              4.8278321e-10  1.1971759e-13  0              3.6240539    
   2600000   18000          200            200            0.0033572833   1.0389368e-44  0              0.01007185     1.1804968e-15  0              5.7001964e-11  1.1971759e-13  0              3.6240539    
   2700000   18000          200            200            0.0033572833   1.0301955e-44  0              0.01007185     1.7240825e-16  0              8.3249773e-12  1.1971759e-13  0              3.6240539    
   2800000   18000          200            200            0.0033572833   7.8535486e-36  0              0.01007185     9.9916081e-19  0              4.82459e-14    1.1971759e-13  0              3.6240539    
   2900000   18000          200            200            0.0033572833  -5.6096774e-37  0              0.01007185     7.6469849e-19  0              3.6924553e-14  1.1971759e-13  0              3.6240539    
   3000000   18000          200            200            0.0033572833  -5.6096774e-37  0              0.01007185     4.9398212e-19  0              2.3852629e-14  1.1971759e-13  0              3.6240539    
Loop time of 771.013 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3361812.540 ns/day, 0.000 hours/ns, 3890.987 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 247.71     | 248.08     | 248.45     |   2.3 | 32.18
Neigh   | 6.8627     | 6.8627     | 6.8628     |   0.0 |  0.89
Comm    | 26.717     | 27.371     | 28.024     |  12.5 |  3.55
Output  | 0.62328    | 0.6233     | 0.62332    |   0.0 |  0.08
Modify  | 428.72     | 428.77     | 428.82     |   0.2 | 55.61
Other   |            | 59.31      |            |       |  7.69

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.26                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 89.0533170045268
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.36
  ghost atom cutoff = 4.36
  binsize = 2.18, bins = 8257 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 161.3 | 161.3 | 161.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00041694222  6.6268169e-41  0             -0.0012508267   680033.79      0              3.2836398e+10  1.1971759e-13  0              3.8848435    
    200000   18000          200            200            0.00012479009  7.4432002e-41  0              0.00037437027  8856.1411      0              4.2763136e+08  1.1971759e-13  0              3.7947608    
    300000   18000          200            200           -0.00022514586 -1.7950879e-35  0             -0.00067543757  53097.027      0              2.5638654e+09  1.1971759e-13  0              3.6432088    
    400000   18000          200            200           -9.3025838e-06  6.6007608e-41  0             -2.7907751e-05  61.098523      0              2950229        1.1971759e-13  0              3.6388612    
    500000   18000          200            200           -5.1860894e-05  1.795102e-35   0             -0.00015558268  2049.7788      0              98976483       1.1971759e-13  0              3.6302522    
    600000   18000          200            200            0.0053000975   3.5901954e-35  0              0.015900293    362.61266      0              17509268       1.1971759e-13  0              3.6287226    
    700000   18000          200            200            0.0022931749  -2.6926442e-35  0              0.0068795246   3.4441631      0              166306.31      1.1971759e-13  0              3.6292677    
    800000   18000          200            200            0.0029773424   8.975493e-36   0              0.0089320271   1.126294       0              54384.708      1.1971759e-13  0              3.6291276    
    900000   18000          200            200            0.0032522693   1.7950976e-35  0              0.009756808    0.5889299      0              28437.317      1.1971759e-13  0              3.6290748    
   1000000   18000          200            200            0.0033386081   8.9754905e-36  0              0.010015824    0.13578412     0              6556.5291      1.1971759e-13  0              3.6290585    
   1100000   18000          200            200            0.0033605961   4.4877452e-36  0              0.010081788    0.02168658     0              1047.1674      1.1971759e-13  0              3.6290545    
   1200000   18000          200            200            0.0033640857  -2.2438702e-36  0              0.010092257    0.0025921046   0              125.16345      1.1971759e-13  0              3.6290538    
   1300000   18000          200            200            0.0033635529  -1.6829032e-36  0              0.010090659    0.00022503495  0              10.866132      1.1971759e-13  0              3.6290539    
   1400000   18000          200            200            0.0033627353  -2.8048387e-37  0              0.010088206    1.1777333e-05  0              0.56868525     1.1971759e-13  0              3.6290541    
   1500000   18000          200            200            0.0033622536   2.8048389e-37  0              0.010086761    1.1845053e-07  0              0.0057195521   1.1971759e-13  0              3.6290542    
   1600000   18000          200            200            0.0033620359   3.3658065e-36  0              0.010086108    4.79148e-08    0              0.0023136342   1.1971759e-13  0              3.6290542    
   1700000   18000          200            200            0.0033619524   5.6096777e-37  0              0.010085857    3.7250565e-08  0              0.0017986965   1.1971759e-13  0              3.6290542    
   1800000   18000          200            200            0.0033619246  -1.6829033e-36  0              0.010085774    1.0301805e-08  0              0.00049743729  1.1971759e-13  0              3.6290542    
   1900000   18000          200            200            0.0033619168  -2.8048387e-37  0              0.01008575     1.8606228e-09  0              8.9842819e-05  1.1971759e-13  0              3.6290543    
   2000000   18000          200            200            0.0033619152   5.6096777e-37  0              0.010085746    2.4872344e-10  0              1.2009965e-05  1.1971759e-13  0              3.6290543    
   2100000   18000          200            200            0.0033619151  -8.4145162e-37  0              0.010085745    2.4733909e-11  0              1.194312e-06   1.1971759e-13  0              3.6290543    
   2200000   18000          200            200            0.0033619153   8.4145164e-37  0              0.010085746    1.6491694e-12  0              7.9632486e-08  1.1971759e-13  0              3.6290543    
   2300000   18000          200            200            0.0033619154  -2.8048387e-37  0              0.010085746    4.5427359e-14  0              2.1935246e-09  1.1971759e-13  0              3.6290543    
   2400000   18000          200            200            0.0033619155  -1.4024194e-36  0              0.010085746    6.1836893e-16  0              2.9858822e-11  1.1971759e-13  0              3.6290543    
   2500000   18000          200            200            0.0033619155  -2.8048387e-37  0              0.010085747    1.8894971e-15  0              9.1237053e-11  1.1971759e-13  0              3.6290543    
   2600000   18000          200            200            0.0033619155   1.019154e-44   0              0.010085747    5.8330184e-16  0              2.8165558e-11  1.1971759e-13  0              3.6290543    
   2700000   18000          200            200            0.0033619155   5.6096777e-37  0              0.010085747    1.8829418e-17  0              9.0920518e-13  1.1971759e-13  0              3.6290543    
   2800000   18000          200            200            0.0033619155   1.1219355e-36  0              0.010085747    1.7140552e-17  0              8.2765592e-13  1.1971759e-13  0              3.6290543    
   2900000   18000          200            200            0.0033619155  -3.5340969e-35  0              0.010085747    2.2063855e-18  0              1.0653846e-13  1.1971759e-13  0              3.6290543    
   3000000   18000          200            200            0.0033619155   1.6829033e-36  0              0.010085747    8.1335513e-19  0              3.9274008e-14  1.1971759e-13  0              3.6290543    
Loop time of 765.851 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3384468.249 ns/day, 0.000 hours/ns, 3917.209 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.3      | 241.9      | 242.5      |   3.9 | 31.59
Neigh   | 6.9473     | 6.9474     | 6.9476     |   0.0 |  0.91
Comm    | 27.555     | 27.977     | 28.399     |   8.0 |  3.65
Output  | 0.62444    | 0.62446    | 0.62447    |   0.0 |  0.08
Modify  | 429.2      | 429.27     | 429.34     |   0.3 | 56.05
Other   |            | 59.13      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.27                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 89.6819263420049
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.37
  ghost atom cutoff = 4.37
  binsize = 2.185, bins = 8238 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 161 | 161 | 161 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00042104375  1.7951086e-35  0             -0.0012631313   668720.24      0              3.2290107e+10  1.1971759e-13  0              3.8937068    
    200000   18000          200            200            0.00013473845  1.7951021e-35  0              0.00040421534  10203.748      0              4.9270246e+08  1.1971759e-13  0              3.798971     
    300000   18000          200            200           -0.00021871152  6.919336e-41   0             -0.00065613457  49038.543      0              2.3678957e+09  1.1971759e-13  0              3.6500773    
    400000   18000          200            200            1.2192584e-06  7.2516157e-41  0              3.6577753e-06  1.1665728      0              56329.624      1.1971759e-13  0              3.6438902    
    500000   18000          200            200           -4.1457622e-05  3.5901986e-35  0             -0.00012437286  1285.3724      0              62066033       1.1971759e-13  0              3.6356291    
    600000   18000          200            200            0.0062876552   1.6746896e-41  0              0.018862966    139.49191      0              6735565.2      1.1971759e-13  0              3.6335682    
    700000   18000          200            200            0.0024784997   8.9754942e-36  0              0.0074354992   25.319097      0              1222568.6      1.1971759e-13  0              3.6342304    
    800000   18000          200            200            0.0029607862   2.4233808e-34  0              0.0088823587   0.11152799     0              5385.2874      1.1971759e-13  0              3.6341322    
    900000   18000          200            200            0.0032217234  -8.975476e-36   0              0.0096651702   0.079265391    0              3827.4421      1.1971759e-13  0              3.6340818    
   1000000   18000          200            200            0.0033214024   6.4802711e-42  0              0.0099642071   0.051958281    0              2508.8794      1.1971759e-13  0              3.634063     
   1100000   18000          200            200            0.0033547479   1.7950971e-35  0              0.010064244    0.014037609    0              677.8259       1.1971759e-13  0              3.6340567    
   1200000   18000          200            200            0.0033644143  -8.9754833e-36  0              0.010093243    0.0026069622   0              125.88088      1.1971759e-13  0              3.6340549    
   1300000   18000          200            200            0.0033666396  -2.8048384e-37  0              0.010099919    0.00037452382  0              18.084415      1.1971759e-13  0              3.6340545    
   1400000   18000          200            200            0.003366891    5.6096776e-37  0              0.010100673    4.2610363e-05  0              2.0575019      1.1971759e-13  0              3.6340545    
   1500000   18000          200            200            0.0033667705   9.36948e-45    0              0.010100312    3.6932816e-06  0              0.17833535     1.1971759e-13  0              3.6340545    
   1600000   18000          200            200            0.0033666551   2.8048389e-37  0              0.010099965    2.0853739e-07  0              0.010069524    1.1971759e-13  0              3.6340545    
   1700000   18000          200            200            0.0033665919   5.6096776e-37  0              0.010099776    3.5731661e-09  0              0.0001725354   1.1971759e-13  0              3.6340545    
   1800000   18000          200            200            0.0033665638  -2.8048388e-36  0              0.010099692    3.663615e-10   0              1.7690286e-05  1.1971759e-13  0              3.6340546    
   1900000   18000          200            200            0.003366553    5.6096777e-37  0              0.010099659    4.3915029e-10  0              2.1204996e-05  1.1971759e-13  0              3.6340546    
   2000000   18000          200            200            0.0033665492  -1.9633871e-36  0              0.010099648    1.3975297e-10  0              6.7481705e-06  1.1971759e-13  0              3.6340546    
   2100000   18000          200            200            0.0033665481   5.6096777e-37  0              0.010099644    2.8454045e-11  0              1.373944e-06   1.1971759e-13  0              3.6340546    
   2200000   18000          200            200            0.0033665478  -5.6096774e-37  0              0.010099643    4.3904637e-12  0              2.1199978e-07  1.1971759e-13  0              3.6340546    
   2300000   18000          200            200            0.0033665477   1.0039259e-44  0              0.010099643    5.3668303e-13  0              2.5914503e-08  1.1971759e-13  0              3.6340546    
   2400000   18000          200            200            0.0033665477   1.0254003e-44  0              0.010099643    5.0811741e-14  0              2.4535171e-09  1.1971759e-13  0              3.6340546    
   2500000   18000          200            200            0.0033665478  -2.748742e-35   0              0.010099643    3.3368617e-15  0              1.6112511e-10  1.1971759e-13  0              3.6340546    
   2600000   18000          200            200            0.0033665478   1.1219355e-36  0              0.010099643    1.5298481e-16  0              7.3870891e-12  1.1971759e-13  0              3.6340546    
   2700000   18000          200            200            0.0033665478  -2.243871e-36   0              0.010099643    7.9121154e-17  0              3.8204773e-12  1.1971759e-13  0              3.6340546    
   2800000   18000          200            200            0.0033665478   1.1219355e-36  0              0.010099643    1.6885674e-17  0              8.1534875e-13  1.1971759e-13  0              3.6340546    
   2900000   18000          200            200            0.0033665478  -2.8048387e-37  0              0.010099643    1.6955128e-19  0              8.1870243e-15  1.1971759e-13  0              3.6340546    
   3000000   18000          200            200            0.0033665478  -1.6829033e-36  0              0.010099643    3.1116078e-21  0              1.502484e-16   1.1971759e-13  0              3.6340546    
Loop time of 769.728 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3367423.690 ns/day, 0.000 hours/ns, 3897.481 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.63     | 244.26     | 245.89     |  10.4 | 31.73
Neigh   | 7.0128     | 7.013      | 7.0132     |   0.0 |  0.91
Comm    | 26.519     | 28.307     | 30.095     |  33.6 |  3.68
Output  | 0.62668    | 0.62669    | 0.62671    |   0.0 |  0.08
Modify  | 430.25     | 430.37     | 430.5      |   0.6 | 55.91
Other   |            | 59.15      |            |       |  7.68

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.28                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 90.3134868916216
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.38
  ghost atom cutoff = 4.38
  binsize = 2.19, bins = 8220 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 160.7 | 160.7 | 160.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00042500813 -1.7950858e-35  0             -0.0012750244   657508.06      0              3.1748711e+10  1.1971759e-13  0              3.9025381    
    200000   18000          200            200            0.00014478305  1.7951053e-35  0              0.00043434916  11645.364      0              5.6231294e+08  1.1971759e-13  0              3.8031305    
    300000   18000          200            200           -0.00021209126 -3.5901855e-35  0             -0.00063627378  45146.019      0              2.1799397e+09  1.1971759e-13  0              3.6568742    
    400000   18000          200            200            1.1901865e-05  6.5411605e-41  0              3.5705595e-05  99.291225      0              4794417.9      1.1971759e-13  0              3.6488402    
    500000   18000          200            200           -3.0872787e-05 -1.7950917e-35  0             -9.2618361e-05  699.30333      0              33766855       1.1971759e-13  0              3.640919     
    600000   18000          200            200            0.0067612298  -2.5131353e-34  0              0.020283689    5.7158532      0              275998.09      1.1971759e-13  0              3.6384972    
    700000   18000          200            200            0.0028185832  -1.7950956e-35  0              0.0084557496   54.389916      0              2626294.4      1.1971759e-13  0              3.639163     
    800000   18000          200            200            0.0030270882  -1.615587e-34   0              0.0090812645   2.7482673      0              132703.99      1.1971759e-13  0              3.6391207    
    900000   18000          200            200            0.0032263718   4.4877504e-36  0              0.0096791155   0.073602748    0              3554.0133      1.1971759e-13  0              3.6390822    
   1000000   18000          200            200            0.0033169085  -3.590193e-35   0              0.0099507255   0.00056830911  0              27.441613      1.1971759e-13  0              3.639065     
   1100000   18000          200            200            0.0033526872  -1.7950965e-35  0              0.010058062    0.0026938694   0              130.07731      1.1971759e-13  0              3.6390583    
   1200000   18000          200            200            0.0033655162   2.2438718e-36  0              0.010096549    0.0010754782   0              51.930992      1.1971759e-13  0              3.6390559    
   1300000   18000          200            200            0.0033696902   2.8048392e-37  0              0.010109071    0.00025229268  0              12.182311      1.1971759e-13  0              3.6390551    
   1400000   18000          200            200            0.0033708931   5.0487098e-36  0              0.010112679    4.4716657e-05  0              2.1592073      1.1971759e-13  0              3.6390549    
   1500000   18000          200            200            0.0033711772   1.9633872e-36  0              0.010113532    6.4629757e-06  0              0.31207397     1.1971759e-13  0              3.6390549    
   1600000   18000          200            200            0.0033712158   2.8048389e-37  0              0.010113647    7.7659325e-07  0              0.037498909    1.1971759e-13  0              3.6390549    
   1700000   18000          200            200            0.0033712051  -5.6096774e-37  0              0.010113615    7.6175745e-08  0              0.0036782541   1.1971759e-13  0              3.6390549    
   1800000   18000          200            200            0.0033711927  -2.8048387e-37  0              0.010113578    5.6640376e-09  0              0.00027349611  1.1971759e-13  0              3.6390549    
   1900000   18000          200            200            0.0033711855   1.1219355e-36  0              0.010113556    2.5056974e-10  0              1.2099116e-05  1.1971759e-13  0              3.6390549    
   2000000   18000          200            200            0.0033711821   2.8048389e-37  0              0.010113546    1.1400202e-12  0              5.5047497e-08  1.1971759e-13  0              3.6390549    
   2100000   18000          200            200            0.0033711807   1.0317438e-44  0              0.010113542    1.8066587e-12  0              8.7237081e-08  1.1971759e-13  0              3.6390549    
   2200000   18000          200            200            0.0033711802  -8.4145162e-37  0              0.010113541    1.1474147e-12  0              5.5404551e-08  1.1971759e-13  0              3.6390549    
   2300000   18000          200            200            0.0033711801   1.1219355e-36  0              0.01011354     3.1894802e-13  0              1.5400859e-08  1.1971759e-13  0              3.6390549    
   2400000   18000          200            200            0.00337118     5.6096777e-37  0              0.01011354     6.2280928e-14  0              3.0073231e-09  1.1971759e-13  0              3.6390549    
   2500000   18000          200            200            0.00337118    -3.0853226e-36  0              0.01011354     9.6489866e-15  0              4.6591503e-10  1.1971759e-13  0              3.6390549    
   2600000   18000          200            200            0.00337118     1.0472155e-44  0              0.01011354     1.2928233e-15  0              6.242581e-11   1.1971759e-13  0              3.6390549    
   2700000   18000          200            200            0.00337118     2.8048388e-36  0              0.01011354     1.270526e-16   0              6.1349154e-12  1.1971759e-13  0              3.6390549    
   2800000   18000          200            200            0.00337118     8.4145164e-37  0              0.01011354     3.5885221e-18  0              1.7327689e-13  1.1971759e-13  0              3.6390549    
   2900000   18000          200            200            0.00337118     8.4145164e-37  0              0.01011354     5.2367971e-18  0              2.5286619e-13  1.1971759e-13  0              3.6390549    
   3000000   18000          200            200            0.00337118    -2.243871e-36   0              0.01011354     5.6451316e-18  0              2.725832e-13   1.1971759e-13  0              3.6390549    
Loop time of 766.242 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3382745.156 ns/day, 0.000 hours/ns, 3915.214 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.39     | 241.63     | 242.86     |   8.0 | 31.53
Neigh   | 7.0135     | 7.0136     | 7.0137     |   0.0 |  0.92
Comm    | 26.186     | 27.613     | 29.04      |  27.2 |  3.60
Output  | 0.62053    | 0.62056    | 0.62059    |   0.0 |  0.08
Modify  | 428.72     | 428.75     | 428.78     |   0.2 | 55.95
Other   |            | 60.62      |            |       |  7.91

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.29                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 90.9480055648809
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.39
  ghost atom cutoff = 4.39
  binsize = 2.195, bins = 8201 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 160.3 | 160.3 | 160.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00042883573  1.4360783e-34  0             -0.0012865072   646397.02      0              3.1212199e+10  1.1971759e-13  0              3.9113373    
    200000   18000          200            200            0.0001549232   9.723642e-41   0              0.00046476961  13180.709      0              6.3644927e+08  1.1971759e-13  0              3.8072391    
    300000   18000          200            200           -0.0002052862   1.795104e-35   0             -0.00061585861  41418.821      0              1.9999666e+09  1.1971759e-13  0              3.6635994    
    400000   18000          200            200            2.2743582e-05  5.3852955e-35  0              6.8230745e-05  354.81199      0              17132601       1.1971759e-13  0              3.653711     
    500000   18000          200            200           -2.0109224e-05 -8.9754797e-35  0             -6.0327673e-05  290.77996      0              14040723       1.1971759e-13  0              3.6461219    
    600000   18000          200            200            0.006587512   -1.7950952e-35  0              0.019762536    55.807105      0              2694725.4      1.1971759e-13  0              3.6435231    
    700000   18000          200            200            0.0032713223  -8.9754725e-36  0              0.0098139669   71.404492      0              3447867.4      1.1971759e-13  0              3.6440767    
    800000   18000          200            200            0.0031652291  -1.7950958e-35  0              0.0094956874   6.9577582      0              335965.25      1.1971759e-13  0              3.6440955    
    900000   18000          200            200            0.0032662572  -1.795096e-35   0              0.0097987715   0.57265366     0              27651.396      1.1971759e-13  0              3.6440759    
   1000000   18000          200            200            0.0033276655   6.6052451e-42  0              0.0099829966   0.034719585    0              1676.4845      1.1971759e-13  0              3.6440642    
   1100000   18000          200            200            0.0033565487   2.2438713e-35  0              0.010069646    0.00096383437  0              46.540112      1.1971759e-13  0              3.6440588    
   1200000   18000          200            200            0.003368664    3.5901937e-35  0              0.010105992    7.7147279e-06  0              0.3725166      1.1971759e-13  0              3.6440565    
   1300000   18000          200            200            0.0033733431   1.4024194e-36  0              0.010120029    3.6325119e-05  0              1.75401        1.1971759e-13  0              3.6440556    
   1400000   18000          200            200            0.0033750242  -5.6096775e-37  0              0.010125073    1.4843499e-05  0              0.71673942     1.1971759e-13  0              3.6440553    
   1500000   18000          200            200            0.0033755854  -5.6096775e-37  0              0.010126756    3.6243484e-06  0              0.17500681     1.1971759e-13  0              3.6440552    
   1600000   18000          200            200            0.0033757571   1.6829033e-36  0              0.010127271    6.8184809e-07  0              0.032924004    1.1971759e-13  0              3.6440552    
   1700000   18000          200            200            0.0033758035  -2.8048387e-37  0              0.01012741     1.0729911e-07  0              0.0051810902   1.1971759e-13  0              3.6440552    
   1800000   18000          200            200            0.0033758133   1.0135455e-44  0              0.01012744     1.4561112e-08  0              0.00070310397  1.1971759e-13  0              3.6440552    
   1900000   18000          200            200            0.0033758141   1.1219355e-36  0              0.010127442    1.7122354e-09  0              8.2677721e-05  1.1971759e-13  0              3.6440552    
   2000000   18000          200            200            0.0033758134  -8.4145162e-37  0              0.01012744     1.7140099e-10  0              8.2763403e-06  1.1971759e-13  0              3.6440552    
   2100000   18000          200            200            0.0033758128   1.0413318e-44  0              0.010127438    1.3853791e-11  0              6.6894999e-07  1.1971759e-13  0              3.6440552    
   2200000   18000          200            200            0.0033758125   1.0165712e-44  0              0.010127437    7.7876199e-13  0              3.760363e-08   1.1971759e-13  0              3.6440552    
   2300000   18000          200            200            0.0033758123   1.1219355e-36  0              0.010127437    1.6740837e-14  0              8.0835511e-10  1.1971759e-13  0              3.6440552    
   2400000   18000          200            200            0.0033758123  -2.8048387e-37  0              0.010127437    7.0393943e-16  0              3.3990716e-11  1.1971759e-13  0              3.6440552    
   2500000   18000          200            200            0.0033758122  -2.243871e-36   0              0.010127437    1.2514836e-15  0              6.0429662e-11  1.1971759e-13  0              3.6440552    
   2600000   18000          200            200            0.0033758122  -2.8048387e-37  0              0.010127437    3.7327027e-16  0              1.8023885e-11  1.1971759e-13  0              3.6440552    
   2700000   18000          200            200            0.0033758122   2.8048389e-37  0              0.010127437    7.5030576e-19  0              3.622958e-14   1.1971759e-13  0              3.6440552    
   2800000   18000          200            200            0.0033758122  -8.4145162e-37  0              0.010127437    2.1121371e-17  0              1.0198754e-12  1.1971759e-13  0              3.6440552    
   2900000   18000          200            200            0.0033758122  -1.4024194e-36  0              0.010127437    2.7158745e-19  0              1.3113986e-14  1.1971759e-13  0              3.6440552    
   3000000   18000          200            200            0.0033758122  -8.4145162e-37  0              0.010127437    1.5915408e-19  0              7.6849812e-15  1.1971759e-13  0              3.6440552    
Loop time of 768.726 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3371813.994 ns/day, 0.000 hours/ns, 3902.562 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.22     | 242.97     | 245.73     |  17.7 | 31.61
Neigh   | 7.0755     | 7.0762     | 7.0769     |   0.0 |  0.92
Comm    | 26.802     | 29.391     | 31.979     |  47.7 |  3.82
Output  | 0.62193    | 0.62195    | 0.62198    |   0.0 |  0.08
Modify  | 428.78     | 428.78     | 428.78     |   0.0 | 55.78
Other   |            | 59.88      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 91.5854892732866
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.4
  ghost atom cutoff = 4.4
  binsize = 2.2, bins = 8182 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 157 | 157 | 157 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00043252708  1.0231857e-40  0             -0.0012975812   635386.33      0              3.0680532e+10  1.1971759e-13  0              3.9201045    
    200000   18000          200            200            0.00016515964  6.1869756e-41  0              0.00049547893  14809.743      0              7.1510948e+08  1.1971759e-13  0              3.8112965    
    300000   18000          200            200           -0.00019829645 -1.7950878e-35  0             -0.00059488935  37855.837      0              1.8279229e+09  1.1971759e-13  0              3.670253     
    400000   18000          200            200            3.3745694e-05  1.7951032e-35  0              0.00010123708  767.18326      0              37044534       1.1971759e-13  0              3.6585023    
    500000   18000          200            200           -9.1643324e-06 -3.5901888e-35  0             -2.7492997e-05  58.863015      0              2842284.3      1.1971759e-13  0              3.6512375    
    600000   18000          200            200            0.0058127632   4.4877438e-35  0              0.01743829     252.68876      0              12201436       1.1971759e-13  0              3.6486413    
    700000   18000          200            200            0.0037655197   4.4877432e-35  0              0.011296559    64.054258      0              3092950.9      1.1971759e-13  0              3.6489868    
    800000   18000          200            200            0.0033500063   2.6926462e-35  0              0.010050019    9.3959293      0              453695.8       1.1971759e-13  0              3.6490618    
    900000   18000          200            200            0.0033331602  -1.795096e-35   0              0.0099994807   1.115962       0              53885.812      1.1971759e-13  0              3.6490645    
   1000000   18000          200            200            0.00335199     4.4877487e-36  0              0.01005597     0.11803562     0              5699.5175      1.1971759e-13  0              3.6490609    
   1100000   18000          200            200            0.003366579    2.6926455e-35  0              0.010099737    0.010778185    0              520.43999      1.1971759e-13  0              3.6490581    
   1200000   18000          200            200            0.0033743912  -6.7316123e-36  0              0.010123174    0.00079204343  0              38.244943      1.1971759e-13  0              3.6490566    
   1300000   18000          200            200            0.0033779923   8.4145167e-37  0              0.010133977    3.873268e-05   0              1.8702625      1.1971759e-13  0              3.6490559    
   1400000   18000          200            200            0.0033795086   5.6096776e-37  0              0.010138526    4.8254755e-07  0              0.023300494    1.1971759e-13  0              3.6490556    
   1500000   18000          200            200            0.0033801059   1.4024194e-36  0              0.010140318    1.0739525e-07  0              0.0051857321   1.1971759e-13  0              3.6490555    
   1600000   18000          200            200            0.0033803284  -2.8048387e-37  0              0.010140985    1.041797e-07   0              0.0050304646   1.1971759e-13  0              3.6490555    
   1700000   18000          200            200            0.003380407   -1.1219355e-36  0              0.010141221    3.4172518e-08  0              0.0016500686   1.1971759e-13  0              3.6490555    
   1800000   18000          200            200            0.0033804333  -1.9633871e-36  0              0.0101413      7.7636211e-09  0              0.00037487748  1.1971759e-13  0              3.6490555    
   1900000   18000          200            200            0.0033804415  -5.6096774e-37  0              0.010141324    1.4381413e-09  0              6.9442696e-05  1.1971759e-13  0              3.6490555    
   2000000   18000          200            200            0.0033804438   1.4024194e-36  0              0.010141331    2.3094379e-10  0              1.1151449e-05  1.1971759e-13  0              3.6490555    
   2100000   18000          200            200            0.0033804444   2.8048389e-37  0              0.010141333    3.3030975e-11  0              1.5949475e-06  1.1971759e-13  0              3.6490555    
   2200000   18000          200            200            0.0033804445  -2.8048387e-37  0              0.010141333    4.2487144e-12  0              2.0515521e-07  1.1971759e-13  0              3.6490555    
   2300000   18000          200            200            0.0033804445   1.0400159e-44  0              0.010141333    4.8950128e-13  0              2.3636265e-08  1.1971759e-13  0              3.6490555    
   2400000   18000          200            200            0.0033804445  -2.8048387e-37  0              0.010141333    4.9807773e-14  0              2.4050391e-09  1.1971759e-13  0              3.6490555    
   2500000   18000          200            200            0.0033804444  -1.6829033e-36  0              0.010141333    4.3390575e-15  0              2.0951756e-10  1.1971759e-13  0              3.6490555    
   2600000   18000          200            200            0.0033804444   1.0350006e-44  0              0.010141333    4.0176118e-16  0              1.939961e-11   1.1971759e-13  0              3.6490555    
   2700000   18000          200            200            0.0033804444   5.6096777e-37  0              0.010141333    1.4043977e-16  0              6.7813341e-12  1.1971759e-13  0              3.6490555    
   2800000   18000          200            200            0.0033804444   1.4024194e-36  0              0.010141333    3.1027013e-18  0              1.4981834e-13  1.1971759e-13  0              3.6490555    
   2900000   18000          200            200            0.0033804444  -5.6096775e-37  0              0.010141333    1.113751e-17   0              5.3779048e-13  1.1971759e-13  0              3.6490555    
   3000000   18000          200            200            0.0033804444  -5.6096775e-37  0              0.010141333    1.4344206e-19  0              6.9263038e-15  1.1971759e-13  0              3.6490555    
Loop time of 765.607 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3385547.770 ns/day, 0.000 hours/ns, 3918.458 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.56     | 241.86     | 246.17     |  27.7 | 31.59
Neigh   | 6.9854     | 6.9856     | 6.9858     |   0.0 |  0.91
Comm    | 25.689     | 30.157     | 34.625     |  81.4 |  3.94
Output  | 0.62247    | 0.62249    | 0.6225     |   0.0 |  0.08
Modify  | 427.62     | 427.69     | 427.75     |   0.3 | 55.86
Other   |            | 58.29      |            |       |  7.61

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.31                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 92.2259449283427
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.41
  ghost atom cutoff = 4.41
  binsize = 2.205, bins = 8164 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 156.6 | 156.6 | 156.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00043608229 -1.7950867e-35  0             -0.0013082469   624477.19      0              3.0153769e+10  1.1971759e-13  0              3.9288392    
    200000   18000          200            200            0.00017548977 -3.5901898e-35  0              0.00052646932  16531.884      0              7.982655e+08   1.1971759e-13  0              3.8153029    
    300000   18000          200            200           -0.00019112453 -7.1803791e-35  0             -0.0005733736   34457.173      0              1.6638135e+09  1.1971759e-13  0              3.6768345    
    400000   18000          200            200            4.4904667e-05  1.7951036e-35  0              0.000134714    1335.7233      0              64497296       1.1971759e-13  0              3.663214     
    500000   18000          200            200            1.9573272e-06  4.5201178e-41  0              5.8719816e-06  2.8670392      0              138439.06      1.1971759e-13  0              3.6562657    
    600000   18000          200            200            0.0046446814   2.6926468e-35  0              0.013934044    457.48735      0              22090427       1.1971759e-13  0              3.6538298    
    700000   18000          200            200            0.0042065101   1.7950979e-35  0              0.01261953     36.592522      0              1766921.9      1.1971759e-13  0              3.6539099    
    800000   18000          200            200            0.0035447306  -2.6926443e-35  0              0.010634192    8.0650395      0              389431.9       1.1971759e-13  0              3.6540269    
    900000   18000          200            200            0.0034121737   8.4574968e-42  0              0.010236521    1.2006043      0              57972.883      1.1971759e-13  0              3.654051     
   1000000   18000          200            200            0.003384399   -6.7316124e-35  0              0.010153197    0.16284434     0              7863.1702      1.1971759e-13  0              3.654056     
   1100000   18000          200            200            0.0033810575  -1.3463223e-35  0              0.010143172    0.020488745    0              989.32817      1.1971759e-13  0              3.6540565    
   1200000   18000          200            200            0.0033823027  -6.7316123e-36  0              0.010146908    0.0023834053   0              115.08611      1.1971759e-13  0              3.6540563    
   1300000   18000          200            200            0.0033836303   4.4576207e-44  0              0.010150891    0.00025360761  0              12.245804      1.1971759e-13  0              3.654056     
   1400000   18000          200            200            0.0033844119   2.243871e-36   0              0.010153236    2.4154699e-05  0              1.166344       1.1971759e-13  0              3.6540559    
   1500000   18000          200            200            0.0033847937  -1.4024194e-36  0              0.010154381    1.971024e-06   0              0.095173697    1.1971759e-13  0              3.6540558    
   1600000   18000          200            200            0.0033849627   1.6829033e-36  0              0.010154888    1.2459203e-07  0              0.0060161034   1.1971759e-13  0              3.6540558    
   1700000   18000          200            200            0.0033850328   2.8048389e-37  0              0.010155098    4.4386217e-09  0              0.00021432516  1.1971759e-13  0              3.6540558    
   1800000   18000          200            200            0.0033850604   2.8048389e-37  0              0.010155181    1.0123049e-12  0              4.888058e-08   1.1971759e-13  0              3.6540558    
   1900000   18000          200            200            0.0033850709  -1.1219355e-36  0              0.010155213    6.4703304e-11  0              3.124291e-06   1.1971759e-13  0              3.6540558    
   2000000   18000          200            200            0.0033850747   5.6096776e-37  0              0.010155224    3.4294621e-11  0              1.6559645e-06  1.1971759e-13  0              3.6540558    
   2100000   18000          200            200            0.003385076   -1.6829033e-36  0              0.010155228    9.6712661e-12  0              4.6699083e-07  1.1971759e-13  0              3.6540558    
   2200000   18000          200            200            0.0033850765  -3.6462904e-36  0              0.010155229    2.0826543e-12  0              1.0056392e-07  1.1971759e-13  0              3.6540558    
   2300000   18000          200            200            0.0033850766  -8.4145162e-37  0              0.01015523     3.8170466e-13  0              1.8431152e-08  1.1971759e-13  0              3.6540558    
   2400000   18000          200            200            0.0033850766  -2.8048387e-37  0              0.01015523     6.2520795e-14  0              3.0189054e-09  1.1971759e-13  0              3.6540558    
   2500000   18000          200            200            0.0033850767  -2.243871e-36   0              0.01015523     9.3233123e-15  0              4.5018938e-10  1.1971759e-13  0              3.6540558    
   2600000   18000          200            200            0.0033850767  -2.8048387e-37  0              0.01015523     1.2905153e-15  0              6.2314363e-11  1.1971759e-13  0              3.6540558    
   2700000   18000          200            200            0.0033850767  -2.8048387e-37  0              0.01015523     8.7354926e-17  0              4.2180567e-12  1.1971759e-13  0              3.6540558    
   2800000   18000          200            200            0.0033850767   1.0969017e-44  0              0.01015523     4.0762508e-18  0              1.9682756e-13  1.1971759e-13  0              3.6540558    
   2900000   18000          200            200            0.0033850767  -5.6096774e-37  0              0.01015523     3.1682367e-18  0              1.5298281e-13  1.1971759e-13  0              3.6540558    
   3000000   18000          200            200            0.0033850767  -1.1219355e-36  0              0.01015523     8.78476e-18    0              4.2418462e-13  1.1971759e-13  0              3.6540558    
Loop time of 767.685 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3376384.763 ns/day, 0.000 hours/ns, 3907.853 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.41     | 243.04     | 243.66     |   4.0 | 31.66
Neigh   | 7.0357     | 7.0359     | 7.0361     |   0.0 |  0.92
Comm    | 27.429     | 27.781     | 28.133     |   6.7 |  3.62
Output  | 0.62351    | 0.62352    | 0.62354    |   0.0 |  0.08
Modify  | 428.39     | 428.44     | 428.49     |   0.2 | 55.81
Other   |            | 60.77      |            |       |  7.92

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.32                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 92.869379441553
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.42
  ghost atom cutoff = 4.42
  binsize = 2.21, bins = 8145 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 156.3 | 156.3 | 156.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00043950191  5.569569e-41   0             -0.0013185057   613668.62      0              2.9631861e+10  1.1971759e-13  0              3.9375416    
    200000   18000          200            200            0.00018591383  3.5901982e-35  0              0.00055774148  18347.005      0              8.8591123e+08  1.1971759e-13  0              3.819258     
    300000   18000          200            200           -0.00018377148 -3.5901856e-35  0             -0.00055131445  31222.148      0              1.5076058e+09  1.1971759e-13  0              3.6833439    
    400000   18000          200            200            5.6218913e-05 -1.7950916e-35  0              0.00016865674  2059.7701      0              99458926       1.1971759e-13  0              3.667846     
    500000   18000          200            200            1.3253466e-05  8.9754893e-35  0              3.9760397e-05  121.96025      0              5889023.8      1.1971759e-13  0              3.6612062    
    600000   18000          200            200            0.0033668566  -2.6926438e-35  0              0.01010057     538.32454      0              25993765       1.1971759e-13  0              3.6590552    
    700000   18000          200            200            0.0044975081  -4.487741e-35   0              0.013492524    8.5012486      0              410494.87      1.1971759e-13  0              3.6588608    
    800000   18000          200            200            0.0037077468  -1.7950958e-35  0              0.01112324     3.9982396      0              193060.68      1.1971759e-13  0              3.6589983    
    900000   18000          200            200            0.0034849773   1.7950977e-35  0              0.010454932    0.7458347      0              36013.688      1.1971759e-13  0              3.6590386    
   1000000   18000          200            200            0.0034170759  -4.9365156e-35  0              0.010251228    0.12200532     0              5891.2002      1.1971759e-13  0              3.6590511    
   1100000   18000          200            200            0.0033968341   2.6926456e-35  0              0.010190502    0.018627772    0              899.46846      1.1971759e-13  0              3.6590548    
   1200000   18000          200            200            0.0033912152   8.2067246e-43  0              0.010173646    0.0026870604   0              129.74853      1.1971759e-13  0              3.6590558    
   1300000   18000          200            200            0.0033898507  -1.4024193e-36  0              0.010169552    0.00036802086  0              17.77041       1.1971759e-13  0              3.659056     
   1400000   18000          200            200            0.0033896124   2.8048388e-37  0              0.010168837    4.7950675e-05  0              2.3153665      1.1971759e-13  0              3.6590561    
   1500000   18000          200            200            0.0033896211  -1.1219355e-36  0              0.010168863    5.9404945e-06  0              0.28684522     1.1971759e-13  0              3.6590561    
   1600000   18000          200            200            0.0033896587  -1.1219355e-36  0              0.010168976    6.9757231e-07  0              0.03368327     1.1971759e-13  0              3.6590561    
   1700000   18000          200            200            0.0033896845   2.8048389e-37  0              0.010169053    7.7138808e-08  0              0.003724757    1.1971759e-13  0              3.6590561    
   1800000   18000          200            200            0.003389698    5.6096777e-37  0              0.010169094    7.9404573e-09  0              0.00038341627  1.1971759e-13  0              3.6590561    
   1900000   18000          200            200            0.0033897043  -1.1219355e-36  0              0.010169113    7.4564686e-10  0              3.6004618e-05  1.1971759e-13  0              3.6590561    
   2000000   18000          200            200            0.003389707    1.0231149e-44  0              0.010169121    6.1491891e-11  0              2.9692234e-06  1.1971759e-13  0              3.6590561    
   2100000   18000          200            200            0.0033897082  -5.6096774e-37  0              0.010169124    4.1034722e-12  0              1.9814199e-07  1.1971759e-13  0              3.6590561    
   2200000   18000          200            200            0.0033897086  -8.4145162e-37  0              0.010169126    1.7621331e-13  0              8.5087099e-09  1.1971759e-13  0              3.6590561    
   2300000   18000          200            200            0.0033897088  -2.8048387e-37  0              0.010169126    1.2211167e-15  0              5.8963356e-11  1.1971759e-13  0              3.6590561    
   2400000   18000          200            200            0.0033897088  -1.6829033e-36  0              0.010169127    9.1251606e-16  0              4.4062135e-11  1.1971759e-13  0              3.6590561    
   2500000   18000          200            200            0.0033897089  -5.6096774e-37  0              0.010169127    6.9830835e-16  0              3.3718811e-11  1.1971759e-13  0              3.6590561    
   2600000   18000          200            200            0.0033897089  -5.6096774e-37  0              0.010169127    1.8162111e-16  0              8.7698333e-12  1.1971759e-13  0              3.6590561    
   2700000   18000          200            200            0.0033897089  -2.8048387e-37  0              0.010169127    1.5375622e-17  0              7.4243376e-13  1.1971759e-13  0              3.6590561    
   2800000   18000          200            200            0.0033897089  -8.4145162e-37  0              0.010169127    2.3218316e-17  0              1.1211294e-12  1.1971759e-13  0              3.6590561    
   2900000   18000          200            200            0.0033897089   9.5341462e-45  0              0.010169127    5.2485337e-19  0              2.5343291e-14  1.1971759e-13  0              3.6590561    
   3000000   18000          200            200            0.0033897089   2.8048389e-37  0              0.010169127    6.4947471e-19  0              3.1360809e-14  1.1971759e-13  0              3.6590561    
Loop time of 766.921 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3379747.035 ns/day, 0.000 hours/ns, 3911.744 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.61     | 243.26     | 244.91     |  10.6 | 31.72
Neigh   | 6.4995     | 6.4997     | 6.4999     |   0.0 |  0.85
Comm    | 25.302     | 27.118     | 28.933     |  34.9 |  3.54
Output  | 0.62573    | 0.62574    | 0.62576    |   0.0 |  0.08
Modify  | 428.18     | 428.22     | 428.26     |   0.2 | 55.84
Other   |            | 61.2       |            |       |  7.98

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.33                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 93.5157997244211
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.43
  ghost atom cutoff = 4.43
  binsize = 2.215, bins = 8127 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 156 | 156 | 156 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00044278637  1.1963953e-40  0             -0.0013283591   602960.16      0              2.9114788e+10  1.1971759e-13  0              3.9462118    
    200000   18000          200            200            0.00019643169  3.5901998e-35  0              0.00058929507  20254.94       0              9.7803858e+08  1.1971759e-13  0              3.8231616    
    300000   18000          200            200           -0.00017623748  1.7951057e-35  0             -0.00052871244  28149.787      0              1.3592525e+09  1.1971759e-13  0              3.689781     
    400000   18000          200            200            6.7689408e-05  6.0517063e-41  0              0.00020306822  2938.8644      0              1.4190725e+08  1.1971759e-13  0              3.6723979    
    500000   18000          200            200            2.472554e-05  -1.0770576e-34  0              7.4176621e-05  415.39684      0              20058027       1.1971759e-13  0              3.666059     
    600000   18000          200            200            0.0022335411  -8.9754825e-35  0              0.0067006234   458.06837      0              22118482       1.1971759e-13  0              3.6642807    
    700000   18000          200            200            0.0045690193   8.9754942e-36  0              0.013707058    0.63398991     0              30613.104      1.1971759e-13  0              3.6638494    
    800000   18000          200            200            0.0038021535  -4.4877411e-35  0              0.01140646     0.51953006     0              25086.247      1.1971759e-13  0              3.6639824    
    900000   18000          200            200            0.0035343115   8.9754924e-36  0              0.010602935    0.17357042     0              8381.0945      1.1971759e-13  0              3.6640307    
   1000000   18000          200            200            0.0034420428   1.3463233e-35  0              0.010326128    0.038472113    0              1857.6806      1.1971759e-13  0              3.6640476    
   1100000   18000          200            200            0.0034103312  -8.9754808e-36  0              0.010230993    0.0074076673   0              357.68974      1.1971759e-13  0              3.6640534    
   1200000   18000          200            200            0.0033995846  -2.0194838e-35  0              0.010198754    0.0013075387   0              63.136366      1.1971759e-13  0              3.6640554    
   1300000   18000          200            200            0.0033960136   4.3052771e-44  0              0.010188041    0.00021650075  0              10.454046      1.1971759e-13  0              3.6640561    
   1400000   18000          200            200            0.0033948556   2.9940757e-45  0              0.010184567    3.4075758e-05  0              1.6453964      1.1971759e-13  0              3.6640563    
   1500000   18000          200            200            0.0033944916   1.4024194e-36  0              0.010183475    5.1410184e-06  0              0.24824138     1.1971759e-13  0              3.6640563    
   1600000   18000          200            200            0.0033943818  -5.6096774e-37  0              0.010183145    7.4755862e-07  0              0.03609693     1.1971759e-13  0              3.6640564    
   1700000   18000          200            200            0.0033943506   1.4024194e-36  0              0.010183052    1.0514214e-07  0              0.0050769378   1.1971759e-13  0              3.6640564    
   1800000   18000          200            200            0.0033943426   1.0489244e-44  0              0.010183028    1.4334677e-08  0              0.00069217023  1.1971759e-13  0              3.6640564    
   1900000   18000          200            200            0.0033943409   2.8048389e-37  0              0.010183023    1.8966153e-09  0              9.1580766e-05  1.1971759e-13  0              3.6640564    
   2000000   18000          200            200            0.0033943408   8.4145164e-37  0              0.010183022    2.4356999e-10  0              1.1761123e-05  1.1971759e-13  0              3.6640564    
   2100000   18000          200            200            0.0033943409  -4.2072582e-36  0              0.010183023    3.0324874e-11  0              1.4642796e-06  1.1971759e-13  0              3.6640564    
   2200000   18000          200            200            0.003394341    1.0295502e-44  0              0.010183023    3.6618139e-12  0              1.7681589e-07  1.1971759e-13  0              3.6640564    
   2300000   18000          200            200            0.0033943411  -8.4145162e-37  0              0.010183023    4.2541451e-13  0              2.0541744e-08  1.1971759e-13  0              3.6640564    
   2400000   18000          200            200            0.0033943411   1.9633872e-36  0              0.010183023    4.7226009e-14  0              2.2803749e-09  1.1971759e-13  0              3.6640564    
   2500000   18000          200            200            0.0033943411  -1.1219355e-36  0              0.010183023    5.0795478e-15  0              2.4527319e-10  1.1971759e-13  0              3.6640564    
   2600000   18000          200            200            0.0033943411   1.0352258e-44  0              0.010183023    6.4081811e-16  0              3.0942813e-11  1.1971759e-13  0              3.6640564    
   2700000   18000          200            200            0.0033943411   5.0487098e-36  0              0.010183023    1.6847626e-16  0              8.1351155e-12  1.1971759e-13  0              3.6640564    
   2800000   18000          200            200            0.0033943411  -1.6829033e-36  0              0.010183023    3.7851656e-19  0              1.827721e-14   1.1971759e-13  0              3.6640564    
   2900000   18000          200            200            0.0033943411  -2.8048387e-37  0              0.010183023    1.145867e-17   0              5.5329817e-13  1.1971759e-13  0              3.6640564    
   3000000   18000          200            200            0.0033943411  -5.6096775e-37  0              0.010183023    1.4091763e-18  0              6.8044079e-14  1.1971759e-13  0              3.6640564    
Loop time of 761.54 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3403629.472 ns/day, 0.000 hours/ns, 3939.386 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.02     | 241.6      | 243.17     |  10.1 | 31.72
Neigh   | 6.3822     | 6.3823     | 6.3825     |   0.0 |  0.84
Comm    | 25.618     | 26.966     | 28.313     |  25.9 |  3.54
Output  | 0.6448     | 0.64482    | 0.64484    |   0.0 |  0.08
Modify  | 427.75     | 427.82     | 427.9      |   0.4 | 56.18
Other   |            | 58.13      |            |       |  7.63

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.34                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 94.1652126884511
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.44
  ghost atom cutoff = 4.44
  binsize = 2.22, bins = 8109 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 155.7 | 155.7 | 155.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00044593596 -3.5901827e-35  0             -0.0013378079   592352.17      0              2.8602566e+10  1.1971759e-13  0              3.9548495    
    200000   18000          200            200            0.00020704218 -5.3852843e-35  0              0.00062112654  22255.329      0              1.0746302e+09  1.1971759e-13  0              3.8270137    
    300000   18000          200            200           -0.00016852489 -1.256567e-34   0             -0.00050557468  25240.002      0              1.2187494e+09  1.1971759e-13  0              3.6961456    
    400000   18000          200            200            7.9312177e-05 -1.7950913e-35  0              0.00023793653  3972.1883      0              1.9180276e+08  1.1971759e-13  0              3.6768697    
    500000   18000          200            200            3.6368597e-05 -3.5901889e-35  0              0.00010910579  882.30798      0              42603495       1.1971759e-13  0              3.6708238    
    600000   18000          200            200            0.0013985461   1.7950983e-35  0              0.0041956383   277.90516      0              13419046       1.1971759e-13  0              3.6694732    
    700000   18000          200            200            0.004403344   -5.3852895e-35  0              0.013210032    18.833347      0              909394.92      1.1971759e-13  0              3.668878     
    800000   18000          200            200            0.0038060141   9.8730334e-35  0              0.011418042    0.51135156     0              24691.337      1.1971759e-13  0              3.6689826    
    900000   18000          200            200            0.0035485689  -6.7316122e-35  0              0.010645707    0.017862381    0              862.51044      1.1971759e-13  0              3.6690291    
   1000000   18000          200            200            0.0034534453   8.9754906e-36  0              0.010360336    0.00015157286  0              7.318911       1.1971759e-13  0              3.6690466    
   1100000   18000          200            200            0.0034186878  -1.3463223e-35  0              0.010256063    6.6867084e-05  0              3.2287722      1.1971759e-13  0              3.669053     
   1200000   18000          200            200            0.0034060601   7.7889969e-43  0              0.01021818     5.6263263e-05  0              2.7167516      1.1971759e-13  0              3.6690553    
   1300000   18000          200            200            0.0034015022  -1.1219355e-36  0              0.010204507    1.8861688e-05  0              0.91076341     1.1971759e-13  0              3.6690562    
   1400000   18000          200            200            0.0033998688   8.4145164e-37  0              0.010199606    4.6292626e-06  0              0.22353052     1.1971759e-13  0              3.6690565    
   1500000   18000          200            200            0.0033992878   5.6096776e-37  0              0.010197863    9.672622e-07   0              0.04670563     1.1971759e-13  0              3.6690566    
   1600000   18000          200            200            0.0033990828   2.8048389e-37  0              0.010197248    1.8291594e-07  0              0.0088323563   1.1971759e-13  0              3.6690566    
   1700000   18000          200            200            0.0033990111  -9.5364518e-36  0              0.010197033    3.2289768e-08  0              0.0015591574   1.1971759e-13  0              3.6690567    
   1800000   18000          200            200            0.0033989862  -2.8048387e-37  0              0.010196959    5.4164205e-09  0              0.00026153956  1.1971759e-13  0              3.6690567    
   1900000   18000          200            200            0.0033989777   1.1219355e-36  0              0.010196933    8.7305877e-10  0              4.2156883e-05  1.1971759e-13  0              3.6690567    
   2000000   18000          200            200            0.0033989748  -1.1219355e-36  0              0.010196924    1.3621033e-10  0              6.5771093e-06  1.1971759e-13  0              3.6690567    
   2100000   18000          200            200            0.0033989738  -8.4145162e-37  0              0.010196921    2.0686955e-11  0              9.9889901e-07  1.1971759e-13  0              3.6690567    
   2200000   18000          200            200            0.0033989735   8.4145164e-37  0              0.01019692     3.0632416e-12  0              1.4791297e-07  1.1971759e-13  0              3.6690567    
   2300000   18000          200            200            0.0033989734  -2.8048387e-37  0              0.01019692     4.4419195e-13  0              2.144844e-08   1.1971759e-13  0              3.6690567    
   2400000   18000          200            200            0.0033989733  -5.6096774e-37  0              0.01019692     6.3265173e-14  0              3.0548488e-09  1.1971759e-13  0              3.6690567    
   2500000   18000          200            200            0.0033989733  -8.4145162e-37  0              0.01019692     8.8504448e-15  0              4.2735631e-10  1.1971759e-13  0              3.6690567    
   2600000   18000          200            200            0.0033989733  -3.9267743e-36  0              0.01019692     1.1549851e-15  0              5.5770096e-11  1.1971759e-13  0              3.6690567    
   2700000   18000          200            200            0.0033989733   1.6829033e-36  0              0.01019692     3.8991819e-17  0              1.8827754e-12  1.1971759e-13  0              3.6690567    
   2800000   18000          200            200            0.0033989733   5.6096777e-37  0              0.01019692     1.4441447e-17  0              6.9732579e-13  1.1971759e-13  0              3.6690567    
   2900000   18000          200            200            0.0033989733   8.4145164e-37  0              0.01019692     5.1511472e-19  0              2.4873046e-14  1.1971759e-13  0              3.6690567    
   3000000   18000          200            200            0.0033989733  -1.6829033e-36  0              0.01019692     4.7946686e-22  0              2.3151739e-17  1.1971759e-13  0              3.6690567    
Loop time of 762.949 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3397343.077 ns/day, 0.000 hours/ns, 3932.110 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.53     | 244.11     | 245.68     |  10.1 | 31.99
Neigh   | 6.4117     | 6.4125     | 6.4134     |   0.0 |  0.84
Comm    | 25.96      | 27.405     | 28.851     |  27.6 |  3.59
Output  | 0.6229     | 0.62292    | 0.62294    |   0.0 |  0.08
Modify  | 426.94     | 426.97     | 427        |   0.1 | 55.96
Other   |            | 57.43      |            |       |  7.53

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 134
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.35                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 94.8176252451468
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.45
  ghost atom cutoff = 4.45
  binsize = 2.225, bins = 8090 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 152.4 | 152.4 | 152.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0004489511   7.3913119e-41  0             -0.0013468533   581844.33      0              2.809518e+10   1.1971759e-13  0              3.9634547    
    200000   18000          200            200            0.00021774511 -1.7950921e-35  0              0.00065323532  24347.995      0              1.1756775e+09  1.1971759e-13  0              3.8308141    
    300000   18000          200            200           -0.00016063405  1.7951036e-35  0             -0.00048190216  22491.912      0              1.0860539e+09  1.1971759e-13  0              3.7024377    
    400000   18000          200            200            9.1087631e-05 -5.385285e-35   0              0.00027326289  5159.2669      0              2.4912254e+08  1.1971759e-13  0              3.6812611    
    500000   18000          200            200            4.8183327e-05  1.7951012e-35  0              0.00014454998  1521.9805      0              73490991       1.1971759e-13  0              3.6755004    
    600000   18000          200            200            0.00090026747 -1.7950952e-35  0              0.0027008024   99.261442      0              4792979.8      1.1971759e-13  0              3.674608     
    700000   18000          200            200            0.0040416351  -8.9754751e-36  0              0.012124905    49.117342      0              2371700.7      1.1971759e-13  0              3.673941     
    800000   18000          200            200            0.003719249    1.7950977e-35  0              0.011157747    3.953838       0              190916.69      1.1971759e-13  0              3.6739991    
    900000   18000          200            200            0.0035251725   3.5901945e-35  0              0.010575517    0.42106507     0              20331.725      1.1971759e-13  0              3.6740345    
   1000000   18000          200            200            0.0034493152  -4.4877356e-36  0              0.010347946    0.046943304    0              2266.7241      1.1971759e-13  0              3.6740485    
   1100000   18000          200            200            0.0034206993   1.7950971e-35  0              0.010262098    0.0051983902   0              251.01166      1.1971759e-13  0              3.6740538    
   1200000   18000          200            200            0.0034099761   8.9754849e-36  0              0.010229928    0.00056491889  0              27.277912      1.1971759e-13  0              3.6740558    
   1300000   18000          200            200            0.0034059722   8.4145167e-37  0              0.010217917    5.9874342e-05  0              2.8911177      1.1971759e-13  0              3.6740565    
   1400000   18000          200            200            0.0034044821   5.6096776e-37  0              0.010213446    6.1483378e-06  0              0.29688123     1.1971759e-13  0              3.6740568    
   1500000   18000          200            200            0.0034039292   5.6096776e-37  0              0.010211788    6.0613969e-07  0              0.029268316    1.1971759e-13  0              3.6740569    
   1600000   18000          200            200            0.0034037247   1.0164569e-44  0              0.010211174    5.6582005e-08  0              0.0027321425   1.1971759e-13  0              3.6740569    
   1700000   18000          200            200            0.0034036493   1.0505776e-44  0              0.010210948    4.8885036e-09  0              0.00023604834  1.1971759e-13  0              3.6740569    
   1800000   18000          200            200            0.0034036216   1.6829033e-36  0              0.010210865    3.7501569e-10  0              1.8108165e-05  1.1971759e-13  0              3.674057     
   1900000   18000          200            200            0.0034036114   1.0416946e-44  0              0.010210834    2.3359055e-11  0              1.1279251e-06  1.1971759e-13  0              3.674057     
   2000000   18000          200            200            0.0034036077  -5.6096774e-37  0              0.010210823    9.0724695e-13  0              4.3807708e-08  1.1971759e-13  0              3.674057     
   2100000   18000          200            200            0.0034036063  -2.8048387e-37  0              0.010210819    3.1500313e-15  0              1.5210374e-10  1.1971759e-13  0              3.674057     
   2200000   18000          200            200            0.0034036058  -8.4145162e-37  0              0.010210817    7.0211007e-15  0              3.3902382e-10  1.1971759e-13  0              3.674057     
   2300000   18000          200            200            0.0034036056  -5.6096774e-37  0              0.010210817    4.8088761e-15  0              2.3220342e-10  1.1971759e-13  0              3.674057     
   2400000   18000          200            200            0.0034036056   2.8048388e-36  0              0.010210817    1.4476106e-15  0              6.9899937e-11  1.1971759e-13  0              3.674057     
   2500000   18000          200            200            0.0034036056   1.4024194e-36  0              0.010210817    2.808887e-16   0              1.356311e-11   1.1971759e-13  0              3.674057     
   2600000   18000          200            200            0.0034036055   1.0257886e-44  0              0.010210817    2.0802274e-17  0              1.0044673e-12  1.1971759e-13  0              3.674057     
   2700000   18000          200            200            0.0034036055   5.6096777e-37  0              0.010210817    6.3860858e-17  0              3.0836123e-12  1.1971759e-13  0              3.674057     
   2800000   18000          200            200            0.0034036055  -3.3658065e-36  0              0.010210817    9.63864e-18    0              4.6541543e-13  1.1971759e-13  0              3.674057     
   2900000   18000          200            200            0.0034036055   1.1219355e-36  0              0.010210817    1.1082649e-17  0              5.3514147e-13  1.1971759e-13  0              3.674057     
   3000000   18000          200            200            0.0034036055   1.4024194e-36  0              0.010210817    1.3000105e-18  0              6.2772853e-14  1.1971759e-13  0              3.674057     
Loop time of 762.448 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3399576.344 ns/day, 0.000 hours/ns, 3934.695 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.23     | 242.75     | 245.27     |  16.1 | 31.84
Neigh   | 6.294      | 6.2944     | 6.2947     |   0.0 |  0.83
Comm    | 24.29      | 26.919     | 29.547     |  50.7 |  3.53
Output  | 0.62439    | 0.62441    | 0.62442    |   0.0 |  0.08
Modify  | 427.1      | 427.13     | 427.16     |   0.1 | 56.02
Other   |            | 58.73      |            |       |  7.70

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 134
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.36                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 95.4730443060119
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.46
  ghost atom cutoff = 4.46
  binsize = 2.23, bins = 8072 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 152.1 | 152.1 | 152.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00045183219  8.9754887e-35  0             -0.0013554966   571436.25      0              2.7592611e+10  1.1971759e-13  0              3.9720273    
    200000   18000          200            200            0.00022853975  1.7951028e-35  0              0.00068561926  26532.664      0              1.2811674e+09  1.1971759e-13  0              3.8345627    
    300000   18000          200            200           -0.00015256606 -3.5901838e-35  0             -0.00045769819  19904.963      0              9.6113941e+08  1.1971759e-13  0              3.7086569    
    400000   18000          200            200            0.00010301539  3.5901987e-35  0              0.00030904618  6499.6154      0              3.1384317e+08  1.1971759e-13  0              3.6855718    
    500000   18000          200            200            6.0169223e-05  3.9817947e-41  0              0.00018050767  2333.7403      0              1.1268797e+08  1.1971759e-13  0              3.6800886    
    600000   18000          200            200            0.00070357055  2.6926467e-35  0              0.0021107117   4.9618015      0              239587.64      1.1971759e-13  0              3.6796699    
    700000   18000          200            200            0.0035691983  -8.9754748e-36  0              0.010707595    68.946286      0              3329169.4      1.1971759e-13  0              3.679026     
    800000   18000          200            200            0.0035637397   4.4877502e-36  0              0.010691219    7.9428755      0              383533.03      1.1971759e-13  0              3.6790282    
    900000   18000          200            200            0.0034713473  -3.1414186e-35  0              0.010414042    0.99964622     0              48269.338      1.1971759e-13  0              3.6790454    
   1000000   18000          200            200            0.0034321654  -4.4877357e-36  0              0.010296496    0.12868653     0              6213.812       1.1971759e-13  0              3.6790528    
   1100000   18000          200            200            0.00341721     2.6926455e-35  0              0.01025163     0.016629118    0              802.96062      1.1971759e-13  0              3.6790556    
   1200000   18000          200            200            0.0034115919   2.2438718e-36  0              0.010234776    0.0021496673   0              103.79974      1.1971759e-13  0              3.6790566    
   1300000   18000          200            200            0.0034094897   3.5230091e-44  0              0.010228469    0.00027779494  0              13.413724      1.1971759e-13  0              3.679057     
   1400000   18000          200            200            0.0034087045   5.6096776e-37  0              0.010226113    3.5879091e-05  0              1.7324729      1.1971759e-13  0              3.6790572    
   1500000   18000          200            200            0.0034084116   2.8048389e-37  0              0.010225235    4.6311797e-06  0              0.22362309     1.1971759e-13  0              3.6790572    
   1600000   18000          200            200            0.0034083024  -2.8048387e-37  0              0.010224907    5.9739547e-07  0              0.028846089    1.1971759e-13  0              3.6790572    
   1700000   18000          200            200            0.0034082618  -8.4145162e-37  0              0.010224785    7.7008131e-08  0              0.003718447    1.1971759e-13  0              3.6790572    
   1800000   18000          200            200            0.0034082467  -5.6096774e-37  0              0.01022474     9.9202586e-09  0              0.00047901378  1.1971759e-13  0              3.6790572    
   1900000   18000          200            200            0.0034082411   5.6096777e-37  0              0.010224723    1.2770618e-09  0              6.1664743e-05  1.1971759e-13  0              3.6790572    
   2000000   18000          200            200            0.003408239    8.4145164e-37  0              0.010224717    1.6430581e-10  0              7.9337394e-06  1.1971759e-13  0              3.6790572    
   2100000   18000          200            200            0.0034082382   1.0145394e-44  0              0.010224715    2.112653e-11   0              1.0201245e-06  1.1971759e-13  0              3.6790572    
   2200000   18000          200            200            0.0034082379   5.6096777e-37  0              0.010224714    2.7158771e-12  0              1.3113999e-07  1.1971759e-13  0              3.6790572    
   2300000   18000          200            200            0.0034082378   1.1219355e-36  0              0.010224713    3.5059263e-13  0              1.6928864e-08  1.1971759e-13  0              3.6790572    
   2400000   18000          200            200            0.0034082378   2.243871e-36   0              0.010224713    4.5081523e-14  0              2.1768254e-09  1.1971759e-13  0              3.6790572    
   2500000   18000          200            200            0.0034082378  -1.9633871e-36  0              0.010224713    5.8364659e-15  0              2.8182205e-10  1.1971759e-13  0              3.6790572    
   2600000   18000          200            200            0.0034082378   8.4145164e-37  0              0.010224713    8.3701529e-16  0              4.0416473e-11  1.1971759e-13  0              3.6790572    
   2700000   18000          200            200            0.0034082378   8.4145164e-37  0              0.010224713    1.6705329e-16  0              8.0664055e-12  1.1971759e-13  0              3.6790572    
   2800000   18000          200            200            0.0034082378  -8.4145162e-37  0              0.010224713    8.8939741e-20  0              4.2945818e-15  1.1971759e-13  0              3.6790572    
   2900000   18000          200            200            0.0034082378   2.8048388e-37  0              0.010224713    7.7678904e-19  0              3.7508363e-14  1.1971759e-13  0              3.6790572    
   3000000   18000          200            200            0.0034082378   1.3562047e-44  0              0.010224713    5.828236e-18   0              2.8142466e-13  1.1971759e-13  0              3.6790572    
Loop time of 765.799 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3384698.115 ns/day, 0.000 hours/ns, 3917.475 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.35     | 243.69     | 244.02     |   2.1 | 31.82
Neigh   | 6.4279     | 6.428      | 6.428      |   0.0 |  0.84
Comm    | 26.337     | 26.388     | 26.438     |   1.0 |  3.45
Output  | 0.62196    | 0.62198    | 0.622      |   0.0 |  0.08
Modify  | 428.91     | 429.11     | 429.31     |   1.0 | 56.03
Other   |            | 59.56      |            |       |  7.78

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.37                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 96.1314767825505
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.47
  ghost atom cutoff = 4.47
  binsize = 2.235, bins = 8054 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 151.8 | 151.8 | 151.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00045457959 -1.7950866e-35  0             -0.0013637388   561128.17      0              2.7094871e+10  1.1971759e-13  0              3.9805673    
    200000   18000          200            200            0.0002394252   1.7951024e-35  0              0.0007182756   28809.016      0              1.3910843e+09  1.1971759e-13  0              3.8382594    
    300000   18000          200            200           -0.00014432263  3.5902005e-35  0             -0.00043296789  17478.771      0              8.439873e+08   1.1971759e-13  0              3.7148032    
    400000   18000          200            200            0.0001150924  -1.7950915e-35  0              0.00034527721  7992.4404      0              3.8592634e+08  1.1971759e-13  0              3.6898018    
    500000   18000          200            200            0.0010508572   1.7951013e-35  0              0.0031525717   3218.9541      0              1.5543177e+08  1.1971759e-13  0              3.6845901    
    600000   18000          200            200            0.00077102933  2.6926469e-35  0              0.002313088    32.612682      0              1574749.7      1.1971759e-13  0              3.6846525    
    700000   18000          200            200            0.0030872403  -8.9754749e-36  0              0.0092617208   64.513941      0              3115147.3      1.1971759e-13  0              3.6841166    
    800000   18000          200            200            0.0033768353  -3.8594581e-34  0              0.010130506    9.1736606      0              442963.24      1.1971759e-13  0              3.6840635    
    900000   18000          200            200            0.0034020893   8.9754921e-36  0              0.010206268    1.2090084      0              58378.689      1.1971759e-13  0              3.6840593    
   1000000   18000          200            200            0.0034082541  -1.7950962e-35  0              0.010224762    0.15864185     0              7660.2472      1.1971759e-13  0              3.6840583    
   1100000   18000          200            200            0.0034108424   2.2438713e-35  0              0.010232527    0.020788881    0              1003.8207      1.1971759e-13  0              3.6840579    
   1200000   18000          200            200            0.0034119989   6.7316138e-36  0              0.010235997    0.0027217229   0              131.42226      1.1971759e-13  0              3.6840577    
   1300000   18000          200            200            0.0034125041  -8.414516e-37   0              0.010237512    0.00035603801  0              17.191801      1.1971759e-13  0              3.6840576    
   1400000   18000          200            200            0.0034127192  -5.6096775e-37  0              0.010238157    4.6537159e-05  0              2.2471129      1.1971759e-13  0              3.6840576    
   1500000   18000          200            200            0.0034128087   9.255968e-36   0              0.010238426    6.0779605e-06  0              0.29348296     1.1971759e-13  0              3.6840576    
   1600000   18000          200            200            0.0034128454   1.9633872e-36  0              0.010238536    7.9317736e-07  0              0.038299696    1.1971759e-13  0              3.6840575    
   1700000   18000          200            200            0.0034128602  -2.8048387e-37  0              0.010238581    1.0342731e-07  0              0.0049941348   1.1971759e-13  0              3.6840575    
   1800000   18000          200            200            0.0034128661   5.6096777e-37  0              0.010238598    1.347583e-08   0              0.00065069958  1.1971759e-13  0              3.6840575    
   1900000   18000          200            200            0.0034128685  -2.1316775e-35  0              0.010238605    1.7543636e-09  0              8.4711939e-05  1.1971759e-13  0              3.6840575    
   2000000   18000          200            200            0.0034128694  -2.8048387e-37  0              0.010238608    2.2820493e-10  0              1.1019199e-05  1.1971759e-13  0              3.6840575    
   2100000   18000          200            200            0.0034128697   2.8048389e-37  0              0.010238609    2.9647789e-11  0              1.4315856e-06  1.1971759e-13  0              3.6840575    
   2200000   18000          200            200            0.0034128699  -2.8048387e-37  0              0.01023861     3.8537699e-12  0              1.8608476e-07  1.1971759e-13  0              3.6840575    
   2300000   18000          200            200            0.0034128699   1.0278025e-44  0              0.01023861     5.0071266e-13  0              2.4177622e-08  1.1971759e-13  0              3.6840575    
   2400000   18000          200            200            0.00341287    -1.4024194e-36  0              0.01023861     6.4976752e-14  0              3.1374948e-09  1.1971759e-13  0              3.6840575    
   2500000   18000          200            200            0.00341287    -5.6096774e-37  0              0.01023861     8.4245013e-15  0              4.0678902e-10  1.1971759e-13  0              3.6840575    
   2600000   18000          200            200            0.00341287     1.0447459e-44  0              0.01023861     1.0169828e-15  0              4.910646e-11   1.1971759e-13  0              3.6840575    
   2700000   18000          200            200            0.00341287    -5.0487098e-36  0              0.01023861     6.3074269e-18  0              3.0456307e-13  1.1971759e-13  0              3.6840575    
   2800000   18000          200            200            0.00341287     2.8048389e-37  0              0.01023861     2.2950676e-17  0              1.108206e-12   1.1971759e-13  0              3.6840575    
   2900000   18000          200            200            0.00341287     2.5243549e-36  0              0.01023861     1.5182472e-17  0              7.3310723e-13  1.1971759e-13  0              3.6840575    
   3000000   18000          200            200            0.00341287     1.1219355e-36  0              0.01023861     3.7277741e-18  0              1.8000087e-13  1.1971759e-13  0              3.6840575    
Loop time of 772.275 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3356319.417 ns/day, 0.000 hours/ns, 3884.629 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.13     | 245.63     | 251.13     |  35.1 | 31.81
Neigh   | 6.5865     | 6.587      | 6.5875     |   0.0 |  0.85
Comm    | 24.695     | 30.393     | 36.09      | 103.3 |  3.94
Output  | 0.62358    | 0.62359    | 0.6236     |   0.0 |  0.08
Modify  | 429.2      | 429.45     | 429.7      |   1.2 | 55.61
Other   |            | 59.59      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.38                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 96.7929295862661
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.48
  ghost atom cutoff = 4.48
  binsize = 2.24, bins = 8036 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 151.5 | 151.5 | 151.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00045719371 -5.3852856e-35  0             -0.0013715811   550919.74      0              2.6601943e+10  1.1971759e-13  0              3.9890748    
    200000   18000          200            200            0.00025040034 -7.1803815e-35  0              0.00075120102  31176.68       0              1.5054103e+09  1.1971759e-13  0              3.8419042    
    300000   18000          200            200           -0.00013590598  8.5397645e-41  0             -0.00040771795  15213.04       0              7.3458324e+08  1.1971759e-13  0              3.7208762    
    400000   18000          200            200            0.00012731556  4.9420453e-41  0              0.00038194669  9636.8645      0              4.653297e+08   1.1971759e-13  0              3.6939509    
    500000   18000          200            200            0.0036357008  -7.1803831e-35  0              0.010907102    3599.9231      0              1.738274e+08   1.1971759e-13  0              3.689032     
    600000   18000          200            200            0.0011158469   3.5901954e-35  0              0.0033475407   170.7537       0              8245085        1.1971759e-13  0              3.6895576    
    700000   18000          200            200            0.0026847419  -1.7950959e-35  0              0.0080542258   39.848531      0              1924143        1.1971759e-13  0              3.6891963    
    800000   18000          200            200            0.0032009627   3.5901945e-35  0              0.0096028882   6.683533       0              322723.89      1.1971759e-13  0              3.6890975    
    900000   18000          200            200            0.0033360034  -3.1414186e-35  0              0.01000801     0.85606171     0              41336.156      1.1971759e-13  0              3.6890727    
   1000000   18000          200            200            0.0033857305   6.3778766e-42  0              0.010157192    0.10537546     0              5088.2039      1.1971759e-13  0              3.6890636    
   1100000   18000          200            200            0.0034051405  -1.3463223e-35  0              0.010215422    0.012782011    0              617.19757      1.1971759e-13  0              3.6890601    
   1200000   18000          200            200            0.0034127236   6.7316138e-36  0              0.010238171    0.0015333362   0              74.039316      1.1971759e-13  0              3.6890587    
   1300000   18000          200            200            0.0034156669   6.1706453e-36  0              0.010247001    0.00018190624  0              8.7836012      1.1971759e-13  0              3.6890582    
   1400000   18000          200            200            0.0034168015  -1.4024194e-36  0              0.010250404    2.1322256e-05  0              1.0295754      1.1971759e-13  0              3.689058     
   1500000   18000          200            200            0.0034172361  -8.4145162e-37  0              0.010251708    2.4660336e-06  0              0.11907594     1.1971759e-13  0              3.6890579    
   1600000   18000          200            200            0.0034174016   1.1219355e-36  0              0.010252205    2.8090443e-07  0              0.01356387     1.1971759e-13  0              3.6890579    
   1700000   18000          200            200            0.0034174644   5.6096777e-37  0              0.010252393    3.1441304e-08  0              0.0015181881   1.1971759e-13  0              3.6890578    
   1800000   18000          200            200            0.003417488   -1.1219355e-36  0              0.010252464    3.4474045e-09  0              0.00016646283  1.1971759e-13  0              3.6890578    
   1900000   18000          200            200            0.0034174969  -5.6096774e-37  0              0.010252491    3.6874061e-10  0              1.7805164e-05  1.1971759e-13  0              3.6890578    
   2000000   18000          200            200            0.0034175002   5.6096777e-37  0              0.010252501    3.8270857e-11  0              1.8479627e-06  1.1971759e-13  0              3.6890578    
   2100000   18000          200            200            0.0034175015  -2.8048387e-37  0              0.010252504    3.8229844e-12  0              1.8459824e-07  1.1971759e-13  0              3.6890578    
   2200000   18000          200            200            0.0034175019  -1.9633871e-36  0              0.010252506    3.6152851e-13  0              1.7456918e-08  1.1971759e-13  0              3.6890578    
   2300000   18000          200            200            0.0034175021   2.8048389e-37  0              0.010252506    3.2069062e-14  0              1.5485002e-09  1.1971759e-13  0              3.6890578    
   2400000   18000          200            200            0.0034175022  -2.8048387e-37  0              0.010252506    2.656595e-15   0              1.2827747e-10  1.1971759e-13  0              3.6890578    
   2500000   18000          200            200            0.0034175022   4.487742e-36   0              0.010252507    1.7156847e-16  0              8.2844275e-12  1.1971759e-13  0              3.6890578    
   2600000   18000          200            200            0.0034175022  -5.6096774e-37  0              0.010252507    3.6524634e-19  0              1.7636439e-14  1.1971759e-13  0              3.6890578    
   2700000   18000          200            200            0.0034175022   2.5243549e-36  0              0.010252507    1.051186e-16   0              5.0758009e-12  1.1971759e-13  0              3.6890578    
   2800000   18000          200            200            0.0034175022   1.6829033e-36  0              0.010252507    2.4162523e-18  0              1.1667218e-13  1.1971759e-13  0              3.6890578    
   2900000   18000          200            200            0.0034175022  -5.6096774e-37  0              0.010252507    2.8627946e-18  0              1.3823411e-13  1.1971759e-13  0              3.6890578    
   3000000   18000          200            200            0.0034175022   1.2029196e-44  0              0.010252507    9.6238576e-18  0              4.6470164e-13  1.1971759e-13  0              3.6890578    
Loop time of 766.929 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3379711.184 ns/day, 0.000 hours/ns, 3911.703 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.57     | 242.31     | 244.06     |  11.2 | 31.60
Neigh   | 6.6059     | 6.606      | 6.606      |   0.0 |  0.86
Comm    | 25.438     | 27.423     | 29.407     |  37.9 |  3.58
Output  | 0.62722    | 0.62723    | 0.62724    |   0.0 |  0.08
Modify  | 429.86     | 430.09     | 430.32     |   1.1 | 56.08
Other   |            | 59.87      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.39                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 97.4574096286626
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.49
  ghost atom cutoff = 4.49
  binsize = 2.245, bins = 8018 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 151.2 | 151.2 | 151.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00045967493  7.1803975e-35  0             -0.0013790248   540810.49      0              2.6113803e+10  1.1971759e-13  0              3.9975494    
    200000   18000          200            200            0.00026146607 -5.3852863e-35  0              0.00078439822  33635.738      0              1.6241494e+09  1.1971759e-13  0              3.8454967    
    300000   18000          200            200           -0.00012731547 -3.5901852e-35  0             -0.00038194642  13106.718      0              6.328765e+08   1.1971759e-13  0              3.7268759    
    400000   18000          200            200            0.00013968706  3.5901994e-35  0              0.00041906119  11432.742      0              5.520462e+08   1.1971759e-13  0              3.6980188    
    500000   18000          200            200            0.00708211    -8.9754795e-35  0              0.02124633     2995.3883      0              1.4463658e+08  1.1971759e-13  0              3.6934804    
    600000   18000          200            200            0.0017856657  -9.8730308e-35  0              0.005356997    359.40666      0              17354461       1.1971759e-13  0              3.6943949    
    700000   18000          200            200            0.0024225089  -8.9754747e-36  0              0.0072675266   12.274874      0              592709.72      1.1971759e-13  0              3.694251     
    800000   18000          200            200            0.0030735458  -8.9754752e-36  0              0.0092206375   2.5378213      0              122542.31      1.1971759e-13  0              3.6941229    
    900000   18000          200            200            0.0032904651  -8.975476e-36   0              0.0098713952   0.27260902     0              13163.314      1.1971759e-13  0              3.6940823    
   1000000   18000          200            200            0.0033722761  -1.346322e-35   0              0.010116828    0.0253018      0              1221.7334      1.1971759e-13  0              3.6940673    
   1100000   18000          200            200            0.0034034202   1.7950971e-35  0              0.010210261    0.0020912455   0              100.97876      1.1971759e-13  0              3.6940616    
   1200000   18000          200            200            0.0034151742   6.7316138e-36  0              0.010245523    0.00014596446  0              7.0481014      1.1971759e-13  0              3.6940594    
   1300000   18000          200            200            0.0034195681  -5.6096772e-37  0              0.010258704    7.3504366e-06  0              0.35492628     1.1971759e-13  0              3.6940586    
   1400000   18000          200            200            0.003421196    8.4145164e-37  0              0.010263588    1.3659728e-07  0              0.0065957939   1.1971759e-13  0              3.6940583    
   1500000   18000          200            200            0.003421794   -2.8048387e-37  0              0.010265382    8.0118577e-09  0              0.00038686394  1.1971759e-13  0              3.6940582    
   1600000   18000          200            200            0.0034220119  -2.8048387e-37  0              0.010266036    1.2822838e-08  0              0.00061916898  1.1971759e-13  0              3.6940581    
   1700000   18000          200            200            0.0034220907   1.0345229e-44  0              0.010266272    4.9025674e-09  0              0.00023672743  1.1971759e-13  0              3.6940581    
   1800000   18000          200            200            0.0034221189   1.1219355e-36  0              0.010266357    1.2734179e-09  0              6.1488795e-05  1.1971759e-13  0              3.6940581    
   1900000   18000          200            200            0.003422129    1.0332138e-44  0              0.010266387    2.7448324e-10  0              1.3253813e-05  1.1971759e-13  0              3.6940581    
   2000000   18000          200            200            0.0034221325  -5.6096774e-37  0              0.010266398    5.2918792e-11  0              2.5552591e-06  1.1971759e-13  0              3.6940581    
   2100000   18000          200            200            0.0034221338   8.4145164e-37  0              0.010266401    9.4608621e-12  0              4.5683117e-07  1.1971759e-13  0              3.6940581    
   2200000   18000          200            200            0.0034221342   1.9633872e-36  0              0.010266403    1.601022e-12   0              7.7307622e-08  1.1971759e-13  0              3.6940581    
   2300000   18000          200            200            0.0034221343   1.1219355e-36  0              0.010266403    2.613602e-13   0              1.2620149e-08  1.1971759e-13  0              3.6940581    
   2400000   18000          200            200            0.0034221344   8.4145164e-37  0              0.010266403    4.1259077e-14  0              1.9922532e-09  1.1971759e-13  0              3.6940581    
   2500000   18000          200            200            0.0034221344   2.8048389e-37  0              0.010266403    6.3972245e-15  0              3.0889908e-10  1.1971759e-13  0              3.6940581    
   2600000   18000          200            200            0.0034221344   1.036442e-44   0              0.010266403    1.0373121e-15  0              5.008809e-11   1.1971759e-13  0              3.6940581    
   2700000   18000          200            200            0.0034221344  -4.2072582e-36  0              0.010266403    1.0794072e-16  0              5.2120711e-12  1.1971759e-13  0              3.6940581    
   2800000   18000          200            200            0.0034221344   8.4145164e-37  0              0.010266403    9.1040673e-18  0              4.3960283e-13  1.1971759e-13  0              3.6940581    
   2900000   18000          200            200            0.0034221344   1.0454465e-44  0              0.010266403    1.1108322e-17  0              5.3638113e-13  1.1971759e-13  0              3.6940581    
   3000000   18000          200            200            0.0034221344   1.0568103e-44  0              0.010266403    1.2511732e-17  0              6.0414676e-13  1.1971759e-13  0              3.6940581    
Loop time of 769.457 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3368607.598 ns/day, 0.000 hours/ns, 3898.851 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 245.45     | 245.82     | 246.18     |   2.3 | 31.95
Neigh   | 6.6592     | 6.6594     | 6.6595     |   0.0 |  0.87
Comm    | 26.898     | 27.096     | 27.294     |   3.8 |  3.52
Output  | 0.6234     | 0.62342    | 0.62343    |   0.0 |  0.08
Modify  | 429.4      | 429.5      | 429.6      |   0.5 | 55.82
Other   |            | 59.76      |            |       |  7.77

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.4                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 98.1249238212441
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.5
  ghost atom cutoff = 4.5
  binsize = 2.25, bins = 8000 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 148 | 148 | 148 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00046202361  1.7950994e-35  0             -0.0013860708   530800.87      0              2.5630475e+10  1.1971759e-13  0              4.0059912    
    200000   18000          200            200            0.00027262037  7.030089e-41   0              0.00081786111  36185.611      0              1.7472737e+09  1.1971759e-13  0              3.8490369    
    300000   18000          200            200           -0.00011855328 -1.7950895e-35  0             -0.00035565985  11159.511      0              5.3885283e+08  1.1971759e-13  0              3.732802     
    400000   18000          200            200            0.00015220447 -8.9754794e-35  0              0.00045661341  13379.325      0              6.460397e+08   1.1971759e-13  0              3.7020053    
    500000   18000          200            200            0.010463804   -1.7950925e-35  0              0.031391412    1578.4121      0              76215873       1.1971759e-13  0              3.6980242    
    600000   18000          200            200            0.002791931    1.6643107e-41  0              0.008375793    501.20388      0              24201342       1.1971759e-13  0              3.6991841    
    700000   18000          200            200            0.0023326334   8.9754948e-36  0              0.0069979002   0.012384755    0              598.01549      1.1971759e-13  0              3.6992714    
    800000   18000          200            200            0.0030204275   2.6926461e-35  0              0.0090612825   0.071874934    0              3470.5833      1.1971759e-13  0              3.6991344    
    900000   18000          200            200            0.003277596   -8.9754757e-36  0              0.0098327881   7.9527785e-05  0              3.8401121      1.1971759e-13  0              3.6990859    
   1000000   18000          200            200            0.0033729865   1.7950975e-35  0              0.01011896     0.0026113834   0              126.09436      1.1971759e-13  0              3.6990683    
   1100000   18000          200            200            0.0034077188  -4.4877389e-36  0              0.010223157    0.0013010478   0              62.822944      1.1971759e-13  0              3.6990619    
   1200000   18000          200            200            0.0034201366  -8.9754833e-36  0              0.01026041     0.00037084779  0              17.906913      1.1971759e-13  0              3.6990596    
   1300000   18000          200            200            0.0034245008  -8.4145159e-37  0              0.010273502    8.3087241e-05  0              4.0119855      1.1971759e-13  0              3.6990588    
   1400000   18000          200            200            0.0034260079   5.8901614e-36  0              0.010278024    1.6217742e-05  0              0.78309671     1.1971759e-13  0              3.6990586    
   1500000   18000          200            200            0.0034265186   5.6096776e-37  0              0.010279556    2.8879023e-06  0              0.13944647     1.1971759e-13  0              3.6990585    
   1600000   18000          200            200            0.0034266879   9.255968e-36   0              0.010280064    4.8076346e-07  0              0.023214347    1.1971759e-13  0              3.6990584    
   1700000   18000          200            200            0.0034267426   2.8048389e-37  0              0.010280228    7.5905644e-08  0              0.0036652119   1.1971759e-13  0              3.6990584    
   1800000   18000          200            200            0.0034267597  -2.8048387e-37  0              0.010280279    1.1468465e-08  0              0.00055377113  1.1971759e-13  0              3.6990584    
   1900000   18000          200            200            0.0034267648  -1.1219355e-36  0              0.010280294    1.6677865e-09  0              8.0531442e-05  1.1971759e-13  0              3.6990584    
   2000000   18000          200            200            0.0034267662  -6.1706453e-36  0              0.010280299    2.3426286e-10  0              1.1311715e-05  1.1971759e-13  0              3.6990584    
   2100000   18000          200            200            0.0034267666   5.6096777e-37  0              0.0102803      3.1871703e-11  0              1.5389705e-06  1.1971759e-13  0              3.6990584    
   2200000   18000          200            200            0.0034267666  -1.9633871e-36  0              0.0102803      4.2063309e-12  0              2.0310867e-07  1.1971759e-13  0              3.6990584    
   2300000   18000          200            200            0.0034267666  -2.8048387e-37  0              0.0102803      5.3826343e-13  0              2.5990815e-08  1.1971759e-13  0              3.6990584    
   2400000   18000          200            200            0.0034267666  -5.6096774e-37  0              0.0102803      6.6613912e-14  0              3.2165474e-09  1.1971759e-13  0              3.6990584    
   2500000   18000          200            200            0.0034267666   1.035821e-44   0              0.0102803      7.9256772e-15  0              3.8270258e-10  1.1971759e-13  0              3.6990584    
   2600000   18000          200            200            0.0034267666   2.8048389e-37  0              0.0102803      8.1618988e-16  0              3.9410889e-11  1.1971759e-13  0              3.6990584    
   2700000   18000          200            200            0.0034267666  -2.8048387e-37  0              0.0102803      8.1669553e-19  0              3.9435304e-14  1.1971759e-13  0              3.6990584    
   2800000   18000          200            200            0.0034267666   1.0360679e-44  0              0.0102803      1.9827164e-17  0              9.5738277e-13  1.1971759e-13  0              3.6990584    
   2900000   18000          200            200            0.0034267666  -5.6096774e-37  0              0.0102803      2.6768423e-18  0              1.2925513e-13  1.1971759e-13  0              3.6990584    
   3000000   18000          200            200            0.0034267666  -5.6096775e-37  0              0.0102803      1.7199681e-18  0              8.3051103e-14  1.1971759e-13  0              3.6990584    
Loop time of 771.4 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3360122.903 ns/day, 0.000 hours/ns, 3889.031 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 244.25     | 245.91     | 247.57     |  10.6 | 31.88
Neigh   | 6.6416     | 6.6419     | 6.6422     |   0.0 |  0.86
Comm    | 26.622     | 28.152     | 29.682     |  28.8 |  3.65
Output  | 0.6205     | 0.62051    | 0.62052    |   0.0 |  0.08
Modify  | 429.85     | 429.96     | 430.06     |   0.5 | 55.74
Other   |            | 60.12      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.41                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 98.7954790755143
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.51
  ghost atom cutoff = 4.51
  binsize = 2.255, bins = 7983 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 147.7 | 147.7 | 147.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00046424018 -1.041156e-33   0             -0.0013927205   520890.25      0              2.5151926e+10  1.1971759e-13  0              4.0144003    
    200000   18000          200            200            0.00028386272  1.795103e-35   0              0.00085158816  38826.059      0              1.8747714e+09  1.1971759e-13  0              3.8525249    
    300000   18000          200            200           -0.00010962103  1.7951015e-35  0             -0.0003288631   9370.9305      0              4.5248869e+08  1.1971759e-13  0              3.7386544    
    400000   18000          200            200            0.00016486474  1.795101e-35   0              0.00049459422  15475.711      0              7.4726668e+08  1.1971759e-13  0              3.7059103    
    500000   18000          200            200            0.01268913    -1.7950928e-35  0              0.03806739     278.57802      0              13451536       1.1971759e-13  0              3.702751     
    600000   18000          200            200            0.0040437777  -2.6926435e-35  0              0.012131333    504.65117      0              24367799       1.1971759e-13  0              3.7039547    
    700000   18000          200            200            0.0024250154  -8.9754731e-36  0              0.0072750462   10.839846      0              523417.36      1.1971759e-13  0              3.704254     
    800000   18000          200            200            0.0030525603  -1.7950959e-35  0              0.009157681    1.2316662      0              59472.753      1.1971759e-13  0              3.7041296    
    900000   18000          200            200            0.0033016165  -4.4877412e-35  0              0.0099048494   0.28762318     0              13888.294      1.1971759e-13  0              3.7040827    
   1000000   18000          200            200            0.0033889747   1.7950975e-35  0              0.010166924    0.060588914    0              2925.6218      1.1971759e-13  0              3.7040665    
   1100000   18000          200            200            0.0034181451   8.9754873e-36  0              0.010254435    0.011240958    0              542.78561      1.1971759e-13  0              3.7040612    
   1200000   18000          200            200            0.0034274911   6.507226e-35   0              0.010282473    0.0018968243   0              91.590856      1.1971759e-13  0              3.7040594    
   1300000   18000          200            200            0.0034303436  -2.8048384e-37  0              0.010291031    0.00029733596  0              14.357289      1.1971759e-13  0              3.7040589    
   1400000   18000          200            200            0.003431157    8.4145164e-37  0              0.010293471    4.3829308e-05  0              2.1163604      1.1971759e-13  0              3.7040587    
   1500000   18000          200            200            0.0034313644  -1.6829033e-36  0              0.010294093    6.1169654e-06  0              0.29536637     1.1971759e-13  0              3.7040587    
   1600000   18000          200            200            0.003431406    8.4145164e-37  0              0.010294218    8.1090175e-07  0              0.039155543    1.1971759e-13  0              3.7040587    
   1700000   18000          200            200            0.0034314085   1.0471021e-44  0              0.010294225    1.0215412e-07  0              0.004932657    1.1971759e-13  0              3.7040587    
   1800000   18000          200            200            0.0034314048   1.0327618e-44  0              0.010294214    1.2201678e-08  0              0.00058917537  1.1971759e-13  0              3.7040587    
   1900000   18000          200            200            0.0034314018  -2.8048387e-37  0              0.010294205    1.3743234e-09  0              6.6361159e-05  1.1971759e-13  0              3.7040587    
   2000000   18000          200            200            0.0034314002   5.6096777e-37  0              0.010294201    1.4454387e-10  0              6.9795061e-06  1.1971759e-13  0              3.7040587    
   2100000   18000          200            200            0.0034313994  -1.1219355e-36  0              0.010294198    1.3935799e-11  0              6.7290986e-07  1.1971759e-13  0              3.7040587    
   2200000   18000          200            200            0.0034313991   1.4024194e-36  0              0.010294197    1.1905417e-12  0              5.7486997e-08  1.1971759e-13  0              3.7040587    
   2300000   18000          200            200            0.0034313989  -8.4145162e-37  0              0.010294197    8.4991829e-14  0              4.1039513e-09  1.1971759e-13  0              3.7040587    
   2400000   18000          200            200            0.0034313989  -1.1219355e-36  0              0.010294197    4.1124071e-15  0              1.9857342e-10  1.1971759e-13  0              3.7040587    
   2500000   18000          200            200            0.0034313988  -9.5364518e-36  0              0.010294197    5.3696595e-17  0              2.5928164e-12  1.1971759e-13  0              3.7040587    
   2600000   18000          200            200            0.0034313988   2.8048388e-36  0              0.010294196    3.2218618e-17  0              1.5557218e-12  1.1971759e-13  0              3.7040587    
   2700000   18000          200            200            0.0034313988   5.3291937e-36  0              0.010294196    1.4134024e-16  0              6.8248144e-12  1.1971759e-13  0              3.7040587    
   2800000   18000          200            200            0.0034313988   1.0213836e-44  0              0.010294196    4.0525996e-19  0              1.9568553e-14  1.1971759e-13  0              3.7040587    
   2900000   18000          200            200            0.0034313988  -2.8048387e-37  0              0.010294196    5.4820818e-18  0              2.6471011e-13  1.1971759e-13  0              3.7040587    
   3000000   18000          200            200            0.0034313988  -5.6096774e-37  0              0.010294196    8.9362888e-18  0              4.3150141e-13  1.1971759e-13  0              3.7040587    
Loop time of 766.9 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3379838.921 ns/day, 0.000 hours/ns, 3911.851 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.5      | 243.64     | 243.79     |   0.9 | 31.77
Neigh   | 6.6316     | 6.6319     | 6.6322     |   0.0 |  0.86
Comm    | 26.773     | 26.948     | 27.123     |   3.4 |  3.51
Output  | 0.62444    | 0.62447    | 0.62449    |   0.0 |  0.08
Modify  | 428.24     | 428.35     | 428.46     |   0.5 | 55.85
Other   |            | 60.7       |            |       |  7.92

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.42                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 99.4690823029768
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.52
  ghost atom cutoff = 4.52
  binsize = 2.26, bins = 7965 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 147.4 | 147.4 | 147.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.000466325   -3.5901891e-35  0             -0.001398975    511078.32      0              2.4678143e+10  1.1971759e-13  0              4.0227764    
    200000   18000          200            200            0.00029519423 -2.1541155e-34  0              0.00088558268  41557.251      0              2.0066509e+09  1.1971759e-13  0              3.85596      
    300000   18000          200            200           -0.00010051837 -7.1803791e-35  0             -0.00030155512  7740.1321      0              3.7374328e+08  1.1971759e-13  0              3.744433     
    400000   18000          200            200            0.00069651814 -7.1803817e-35  0              0.0020895544   17689.369      0              8.5415634e+08  1.1971759e-13  0              3.7097336    
    500000   18000          200            200            0.012953146    4.0318418e-41  0              0.038859438    98.786663      0              4770054.4      1.1971759e-13  0              3.7077187    
    600000   18000          200            200            0.0053271614  -4.6672515e-34  0              0.015981484    351.47927      0              16971676       1.1971759e-13  0              3.7087431    
    700000   18000          200            200            0.0026914857   1.7950979e-35  0              0.0080744571   37.627863      0              1816914.8      1.1971759e-13  0              3.7092019    
    800000   18000          200            200            0.0031650648  -1.7950959e-35  0              0.0094951944   5.0669189      0              244663.38      1.1971759e-13  0              3.7091097    
    900000   18000          200            200            0.0033579757  -4.9365154e-35  0              0.010073927    0.86389033     0              41714.172      1.1971759e-13  0              3.7090735    
   1000000   18000          200            200            0.0034170698   4.4877488e-36  0              0.010251209    0.13740693     0              6634.8889      1.1971759e-13  0              3.7090625    
   1100000   18000          200            200            0.003432845   -1.3463223e-35  0              0.010298535    0.020071283    0              969.17042      1.1971759e-13  0              3.7090596    
   1200000   18000          200            200            0.0034362565   7.8339214e-43  0              0.01030877     0.0027115104   0              130.92914      1.1971759e-13  0              3.709059     
   1300000   18000          200            200            0.0034366099  -1.1219355e-36  0              0.01030983     0.00033959192  0              16.397678      1.1971759e-13  0              3.7090589    
   1400000   18000          200            200            0.0034364132   5.6096776e-37  0              0.01030924     3.9283541e-05  0              1.8968616      1.1971759e-13  0              3.7090589    
   1500000   18000          200            200            0.0034362269   9.4839713e-45  0              0.010308681    4.1512223e-06  0              0.20044767     1.1971759e-13  0              3.709059     
   1600000   18000          200            200            0.0034361202   1.1219355e-36  0              0.01030836     3.917352e-07   0              0.018915491    1.1971759e-13  0              3.709059     
   1700000   18000          200            200            0.0034360687  -7.0120969e-36  0              0.010308206    3.1518243e-08  0              0.0015219032   1.1971759e-13  0              3.709059     
   1800000   18000          200            200            0.0034360461  -1.4024194e-36  0              0.010308138    1.9405892e-09  0              9.3704105e-05  1.1971759e-13  0              3.709059     
   1900000   18000          200            200            0.0034360368   5.6096776e-37  0              0.01030811     6.4136474e-11  0              3.0969208e-06  1.1971759e-13  0              3.709059     
   2000000   18000          200            200            0.0034360332   8.4145164e-37  0              0.0103081      8.5475777e-15  0              4.1273194e-10  1.1971759e-13  0              3.709059     
   2100000   18000          200            200            0.0034360318  -2.243871e-36   0              0.010308095    1.2507179e-12  0              6.0392692e-08  1.1971759e-13  0              3.709059     
   2200000   18000          200            200            0.0034360313   1.6829033e-36  0              0.010308094    6.1402712e-13  0              2.9649172e-08  1.1971759e-13  0              3.709059     
   2300000   18000          200            200            0.0034360311   2.8048388e-36  0              0.010308093    1.6861721e-13  0              8.1419216e-09  1.1971759e-13  0              3.709059     
   2400000   18000          200            200            0.0034360311  -8.4145162e-37  0              0.010308093    3.6019767e-14  0              1.7392656e-09  1.1971759e-13  0              3.709059     
   2500000   18000          200            200            0.003436031    1.0371646e-44  0              0.010308093    6.5120025e-15  0              3.1444129e-10  1.1971759e-13  0              3.709059     
   2600000   18000          200            200            0.003436031    8.4145164e-37  0              0.010308093    1.102073e-15   0              5.321516e-11   1.1971759e-13  0              3.709059     
   2700000   18000          200            200            0.003436031    1.6829033e-36  0              0.010308093    7.6898516e-17  0              3.7131541e-12  1.1971759e-13  0              3.709059     
   2800000   18000          200            200            0.003436031   -4.487742e-36   0              0.010308093    1.8849362e-17  0              9.1016821e-13  1.1971759e-13  0              3.709059     
   2900000   18000          200            200            0.003436031    2.8048389e-37  0              0.010308093    5.707224e-18   0              2.7558142e-13  1.1971759e-13  0              3.709059     
   3000000   18000          200            200            0.003436031   -5.6096774e-37  0              0.010308093    2.9936267e-18  0              1.4455152e-13  1.1971759e-13  0              3.709059     
Loop time of 766.294 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3382512.913 ns/day, 0.000 hours/ns, 3914.946 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.03     | 242.36     | 243.7      |   8.6 | 31.63
Neigh   | 6.0904     | 6.0904     | 6.0904     |   0.0 |  0.79
Comm    | 25.455     | 26.657     | 27.859     |  23.3 |  3.48
Output  | 0.62498    | 0.625      | 0.62502    |   0.0 |  0.08
Modify  | 428.92     | 428.97     | 429.02     |   0.2 | 55.98
Other   |            | 61.59      |            |       |  8.04

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.43                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 100.145740415136
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.53
  ghost atom cutoff = 4.53
  binsize = 2.265, bins = 7948 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 147.1 | 147.1 | 147.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00046827845  7.1803999e-35  0             -0.0014048354   501365.31      0              2.4209137e+10  1.1971759e-13  0              4.0311195    
    200000   18000          200            200            0.00030661206 -7.1803812e-35  0              0.00091983617  44378.383      0              2.1428733e+09  1.1971759e-13  0              3.8593426    
    300000   18000          200            200           -9.1247899e-05  5.3852997e-35  0             -0.0002737437   6266.8275      0              3.0260267e+08  1.1971759e-13  0              3.7501375    
    400000   18000          200            200            0.0070852861   8.97549e-35    0              0.021255858    17658.747      0              8.5267769e+08  1.1971759e-13  0              3.7135032    
    500000   18000          200            200            0.01114428     1.7951011e-35  0              0.03343284     1180.0252      0              56979192       1.1971759e-13  0              3.7129351    
    600000   18000          200            200            0.006346643   -8.9754654e-36  0              0.019039929    133.79623      0              6460541.1      1.1971759e-13  0              3.7135871    
    700000   18000          200            200            0.0031016408  -1.7950957e-35  0              0.0093049225   62.392382      0              3012704.8      1.1971759e-13  0              3.714124     
    800000   18000          200            200            0.0033374372   3.5901946e-35  0              0.010012312    8.4650397      0              408746.47      1.1971759e-13  0              3.7140789    
    900000   18000          200            200            0.0034342121   8.5527524e-42  0              0.010302636    1.1876544      0              57347.58       1.1971759e-13  0              3.7140607    
   1000000   18000          200            200            0.0034506462  -1.7950961e-35  0              0.010351939    0.15145308     0              7313.1273      1.1971759e-13  0              3.7140575    
   1100000   18000          200            200            0.0034485815   4.4877453e-36  0              0.010345744    0.017316194    0              836.13702      1.1971759e-13  0              3.7140579    
   1200000   18000          200            200            0.0034449407   2.2438718e-36  0              0.010334822    0.0017460901   0              84.312442      1.1971759e-13  0              3.7140585    
   1300000   18000          200            200            0.0034426431   1.4024194e-35  0              0.010327929    0.00014927773  0              7.2080875      1.1971759e-13  0              3.7140589    
   1400000   18000          200            200            0.0034414993   2.9912991e-45  0              0.010324498    9.8426156e-06  0              0.47526468     1.1971759e-13  0              3.7140591    
   1500000   18000          200            200            0.0034409936  -5.6096775e-37  0              0.010322981    3.7202271e-07  0              0.017963645    1.1971759e-13  0              3.7140592    
   1600000   18000          200            200            0.0034407867   1.6829033e-36  0              0.01032236     3.3900821e-10  0              1.6369493e-05  1.1971759e-13  0              3.7140593    
   1700000   18000          200            200            0.003440707    5.6096777e-37  0              0.010322121    4.5124911e-09  0              0.00021789204  1.1971759e-13  0              3.7140593    
   1800000   18000          200            200            0.0034406779  -5.6096774e-37  0              0.010322034    2.4870275e-09  0              0.00012008966  1.1971759e-13  0              3.7140593    
   1900000   18000          200            200            0.0034406679  -5.6096774e-37  0              0.010322004    6.9670142e-10  0              3.3641218e-05  1.1971759e-13  0              3.7140593    
   2000000   18000          200            200            0.0034406646   8.4145164e-37  0              0.010321994    1.4617177e-10  0              7.0581117e-06  1.1971759e-13  0              3.7140593    
   2100000   18000          200            200            0.0034406636   8.4145164e-37  0              0.010321991    2.5709354e-11  0              1.2414127e-06  1.1971759e-13  0              3.7140593    
   2200000   18000          200            200            0.0034406633   1.1219355e-36  0              0.01032199     3.9672299e-12  0              1.9156333e-07  1.1971759e-13  0              3.7140593    
   2300000   18000          200            200            0.0034406632  -8.4145162e-37  0              0.01032199     5.4883688e-13  0              2.6501369e-08  1.1971759e-13  0              3.7140593    
   2400000   18000          200            200            0.0034406632  -7.0120969e-36  0              0.01032199     6.8764773e-14  0              3.3204048e-09  1.1971759e-13  0              3.7140593    
   2500000   18000          200            200            0.0034406632  -2.8048387e-37  0              0.01032199     7.6447641e-15  0              3.691383e-10   1.1971759e-13  0              3.7140593    
   2600000   18000          200            200            0.0034406632   1.0447145e-44  0              0.01032199     6.4380317e-16  0              3.1086951e-11  1.1971759e-13  0              3.7140593    
   2700000   18000          200            200            0.0034406632   1.0413444e-44  0              0.01032199     1.8988234e-17  0              9.1687387e-13  1.1971759e-13  0              3.7140593    
   2800000   18000          200            200            0.0034406632  -8.4145162e-37  0              0.01032199     1.0024634e-17  0              4.8405372e-13  1.1971759e-13  0              3.7140593    
   2900000   18000          200            200            0.0034406632  -1.9633871e-36  0              0.01032199     4.1058664e-19  0              1.9825759e-14  1.1971759e-13  0              3.7140593    
   3000000   18000          200            200            0.0034406632   7.0442016e-45  0              0.01032199     7.3220503e-19  0              3.535556e-14   1.1971759e-13  0              3.7140593    
Loop time of 763.659 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3394183.645 ns/day, 0.000 hours/ns, 3928.453 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.87     | 242.42     | 242.96     |   3.5 | 31.74
Neigh   | 5.8389     | 5.8391     | 5.8394     |   0.0 |  0.76
Comm    | 24.679     | 25.463     | 26.248     |  15.5 |  3.33
Output  | 0.63879    | 0.6388     | 0.63881    |   0.0 |  0.08
Modify  | 429.34     | 429.37     | 429.41     |   0.2 | 56.23
Other   |            | 59.93      |            |       |  7.85

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.44                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 100.825460323495
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.54
  ghost atom cutoff = 4.54
  binsize = 2.27, bins = 7930 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 146.8 | 146.8 | 146.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047010092 -3.5901854e-35  0             -0.0014103028   491751.05      0              2.3744898e+10  1.1971759e-13  0              4.0394295    
    200000   18000          200            200            0.00031811676  1.7951043e-35  0              0.00095435029  47289.492      0              2.2834403e+09  1.1971759e-13  0              3.8626724    
    300000   18000          200            200           -8.1810006e-05 -3.5901865e-35  0             -0.00024543002  4950.3367      0              2.3903404e+08  1.1971759e-13  0              3.7557678    
    400000   18000          200            200            0.016299654   -1.7950961e-34  0              0.048898963    12346.54       0              5.9617021e+08  1.1971759e-13  0              3.7173652    
    500000   18000          200            200            0.0079121176  -3.5901891e-35  0              0.023736353    2654.0196      0              1.2815311e+08  1.1971759e-13  0              3.7183544    
    600000   18000          200            200            0.0068264823   1.7496846e-41  0              0.020479447    4.5157616      0              218049.97      1.1971759e-13  0              3.7185167    
    700000   18000          200            200            0.0035952987  -8.9754716e-36  0              0.010785896    67.483062      0              3258515.6      1.1971759e-13  0              3.7190343    
    800000   18000          200            200            0.0035355477   9.473525e-42   0              0.010606643    8.6123168      0              415857.96      1.1971759e-13  0              3.7190439    
    900000   18000          200            200            0.0035125996   4.4877504e-36  0              0.010537799    0.9521215      0              45974.54       1.1971759e-13  0              3.7190476    
   1000000   18000          200            200            0.0034814364   3.1414201e-35  0              0.010444309    0.087758971    0              4237.5666      1.1971759e-13  0              3.7190531    
   1100000   18000          200            200            0.0034617682  -1.7950965e-35  0              0.010385305    0.0062569019   0              302.1234       1.1971759e-13  0              3.7190566    
   1200000   18000          200            200            0.003452079    4.4877428e-36  0              0.010356237    0.00027087767  0              13.079713      1.1971759e-13  0              3.7190583    
   1300000   18000          200            200            0.0034478806  -2.8048384e-37  0              0.010343642    1.2765007e-06  0              0.061637653    1.1971759e-13  0              3.7190591    
   1400000   18000          200            200            0.0034462141   8.4145164e-37  0              0.010338642    1.8824794e-06  0              0.090898193    1.1971759e-13  0              3.7190594    
   1500000   18000          200            200            0.003445599    2.8048389e-37  0              0.010336797    1.2306456e-06  0              0.059423473    1.1971759e-13  0              3.7190595    
   1600000   18000          200            200            0.0034453873   8.4145164e-37  0              0.010336162    3.5583209e-07  0              0.017181858    1.1971759e-13  0              3.7190595    
   1700000   18000          200            200            0.0034453198  -2.8048387e-37  0              0.01033596     7.3937918e-08  0              0.0035701974   1.1971759e-13  0              3.7190596    
   1800000   18000          200            200            0.0034453005  -1.9633871e-36  0              0.010335901    1.2545415e-08  0              0.00060577317  1.1971759e-13  0              3.7190596    
   1900000   18000          200            200            0.0034452958  -2.8048387e-37  0              0.010335887    1.8227086e-09  0              8.8012073e-05  1.1971759e-13  0              3.7190596    
   2000000   18000          200            200            0.003445295   -1.4304678e-35  0              0.010335885    2.30251e-10    0              1.1117997e-05  1.1971759e-13  0              3.7190596    
   2100000   18000          200            200            0.0034452951   1.1219355e-36  0              0.010335885    2.5133169e-11  0              1.2135908e-06  1.1971759e-13  0              3.7190596    
   2200000   18000          200            200            0.0034452953  -1.4024194e-36  0              0.010335886    2.3024923e-12  0              1.1117911e-07  1.1971759e-13  0              3.7190596    
   2300000   18000          200            200            0.0034452954   5.6096777e-37  0              0.010335886    1.6226572e-13  0              7.8352307e-09  1.1971759e-13  0              3.7190596    
   2400000   18000          200            200            0.0034452954   1.0207815e-44  0              0.010335886    6.898677e-15   0              3.3311242e-10  1.1971759e-13  0              3.7190596    
   2500000   18000          200            200            0.0034452954  -2.8048388e-36  0              0.010335886    2.8799473e-17  0              1.3906235e-12  1.1971759e-13  0              3.7190596    
   2600000   18000          200            200            0.0034452955  -8.4145162e-37  0              0.010335886    1.0730295e-16  0              5.1812753e-12  1.1971759e-13  0              3.7190596    
   2700000   18000          200            200            0.0034452955   2.8048389e-37  0              0.010335886    1.6221272e-16  0              7.8326719e-12  1.1971759e-13  0              3.7190596    
   2800000   18000          200            200            0.0034452955   1.0638085e-44  0              0.010335886    2.5368393e-18  0              1.2249489e-13  1.1971759e-13  0              3.7190596    
   2900000   18000          200            200            0.0034452955  -8.4145162e-37  0              0.010335886    4.50276e-18    0              2.1742217e-13  1.1971759e-13  0              3.7190596    
   3000000   18000          200            200            0.0034452955   5.6096776e-37  0              0.010335886    1.1590364e-17  0              5.5965718e-13  1.1971759e-13  0              3.7190596    
Loop time of 763.307 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3395751.066 ns/day, 0.000 hours/ns, 3930.267 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.59     | 242.68     | 244.77     |  13.4 | 31.79
Neigh   | 5.9904     | 5.9907     | 5.991      |   0.0 |  0.78
Comm    | 23.76      | 26.023     | 28.285     |  44.3 |  3.41
Output  | 0.61684    | 0.61685    | 0.61687    |   0.0 |  0.08
Modify  | 428.27     | 428.38     | 428.49     |   0.5 | 56.12
Other   |            | 59.61      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.45                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 101.508248939558
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.55
  ghost atom cutoff = 4.55
  binsize = 2.275, bins = 7913 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 143.7 | 143.7 | 143.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047179279 -5.3852816e-35  0             -0.0014153784   482235.19      0              2.3285412e+10  1.1971759e-13  0              4.0477065    
    200000   18000          200            200            0.00032970753  8.7476003e-41  0              0.00098912258  50290.271      0              2.4283372e+09  1.1971759e-13  0              3.8659492    
    300000   18000          200            200           -7.2206535e-05 -3.5901867e-35  0             -0.0002166196   3790.2012      0              1.8301525e+08  1.1971759e-13  0              3.7613236    
    400000   18000          200            200            0.024445005   -1.0770576e-34  0              0.073335014    4257.1592      0              2.0556298e+08  1.1971759e-13  0              3.7215382    
    500000   18000          200            200            0.0043371884  -7.1803824e-35  0              0.013011565    3471.8331      0              1.676424e+08   1.1971759e-13  0              3.7238932    
    600000   18000          200            200            0.006624729    8.9755005e-36  0              0.019874187    59.761871      0              2885686.8      1.1971759e-13  0              3.723546     
    700000   18000          200            200            0.0040822619   8.9754959e-36  0              0.012246786    48.329903      0              2333678.1      1.1971759e-13  0              3.7239497    
    800000   18000          200            200            0.003716951    2.6926462e-35  0              0.011150853    5.3359836      0              257655.55      1.1971759e-13  0              3.7240124    
    900000   18000          200            200            0.0035743307   1.7950977e-35  0              0.010722992    0.3779465      0              18249.684      1.1971759e-13  0              3.7240375    
   1000000   18000          200            200            0.0035018784  -4.4877355e-36  0              0.010505635    0.014050144    0              678.43118      1.1971759e-13  0              3.7240505    
   1100000   18000          200            200            0.0034696293  -2.6926449e-35  0              0.010408888    1.5147147e-06  0              0.07314015     1.1971759e-13  0              3.7240563    
   1200000   18000          200            200            0.0034567646   6.7316138e-36  0              0.010370294    0.00021683142  0              10.470013      1.1971759e-13  0              3.7240586    
   1300000   18000          200            200            0.0034520796   1.4024194e-36  0              0.010356239    0.00010758637  0              5.1949608      1.1971759e-13  0              3.7240595    
   1400000   18000          200            200            0.0034505213  -5.6096775e-37  0              0.010351564    2.7637608e-05  0              1.3345212      1.1971759e-13  0              3.7240597    
   1500000   18000          200            200            0.0034500565   5.6096776e-37  0              0.010350169    5.208089e-06   0              0.25147998     1.1971759e-13  0              3.7240598    
   1600000   18000          200            200            0.0034499389  -8.4145162e-37  0              0.010349817    7.9472537e-07  0              0.038374444    1.1971759e-13  0              3.7240598    
   1700000   18000          200            200            0.0034499186  -5.6096774e-37  0              0.010349756    1.0125084e-07  0              0.0048890408   1.1971759e-13  0              3.7240598    
   1800000   18000          200            200            0.0034499199  -1.1219355e-36  0              0.01034976     1.0705319e-08  0              0.00051692152  1.1971759e-13  0              3.7240598    
   1900000   18000          200            200            0.0034499235  -2.8048388e-36  0              0.01034977     8.9529889e-10  0              4.3230779e-05  1.1971759e-13  0              3.7240598    
   2000000   18000          200            200            0.0034499258  -8.4145162e-37  0              0.010349777    5.1091872e-11  0              2.4670437e-06  1.1971759e-13  0              3.7240598    
   2100000   18000          200            200            0.0034499269   5.6096777e-37  0              0.010349781    1.0483527e-12  0              5.0621201e-08  1.1971759e-13  0              3.7240598    
   2200000   18000          200            200            0.0034499274   1.0321399e-44  0              0.010349782    5.2892749e-14  0              2.5540016e-09  1.1971759e-13  0              3.7240598    
   2300000   18000          200            200            0.0034499276   2.8048389e-37  0              0.010349783    8.6044601e-14  0              4.1547858e-09  1.1971759e-13  0              3.7240598    
   2400000   18000          200            200            0.0034499276  -5.6096774e-37  0              0.010349783    3.027752e-14   0              1.4619931e-09  1.1971759e-13  0              3.7240598    
   2500000   18000          200            200            0.0034499277  -5.6096774e-37  0              0.010349783    6.8063942e-15  0              3.2865642e-10  1.1971759e-13  0              3.7240598    
   2600000   18000          200            200            0.0034499277   1.0383249e-44  0              0.010349783    1.1883108e-15  0              5.7379278e-11  1.1971759e-13  0              3.7240598    
   2700000   18000          200            200            0.0034499277  -2.8048387e-37  0              0.010349783    4.2365305e-17  0              2.0456689e-12  1.1971759e-13  0              3.7240598    
   2800000   18000          200            200            0.0034499277  -2.5243549e-36  0              0.010349783    2.3192306e-17  0              1.1198734e-12  1.1971759e-13  0              3.7240598    
   2900000   18000          200            200            0.0034499277   5.6096777e-37  0              0.010349783    3.6561669e-18  0              1.7654322e-13  1.1971759e-13  0              3.7240598    
   3000000   18000          200            200            0.0034499277  -5.6096774e-37  0              0.010349783    9.7634304e-18  0              4.7144111e-13  1.1971759e-13  0              3.7240598    
Loop time of 764.214 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3391721.071 ns/day, 0.000 hours/ns, 3925.603 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.55     | 243.04     | 244.53     |   9.6 | 31.80
Neigh   | 5.8887     | 5.889      | 5.8892     |   0.0 |  0.77
Comm    | 25.221     | 26.518     | 27.816     |  25.2 |  3.47
Output  | 0.62154    | 0.62157    | 0.62159    |   0.0 |  0.08
Modify  | 428.19     | 428.35     | 428.51     |   0.8 | 56.05
Other   |            | 59.8       |            |       |  7.82

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.46                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 102.194113174829
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.56
  ghost atom cutoff = 4.56
  binsize = 2.28, bins = 7895 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 143.4 | 143.4 | 143.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047335445  3.5902026e-35  0             -0.0014200633   472817.61      0              2.283067e+10   1.1971759e-13  0              4.0559502    
    200000   18000          200            200            0.00034138352  3.8859205e-41  0              0.0010241506   53380.41       0              2.577549e+09   1.1971759e-13  0              3.869173     
    300000   18000          200            200           -6.2438609e-05  6.1562448e-41  0             -0.00018731583  2785.8505      0              1.3451875e+08  1.1971759e-13  0              3.7668047    
    400000   18000          200            200            0.027882332    5.3852963e-35  0              0.083646997    10.224525      0              493705.7       1.1971759e-13  0              3.7262167    
    500000   18000          200            200            0.0014448041  -5.3852854e-35  0              0.0043344122   3259.7986      0              1.5740401e+08  1.1971759e-13  0              3.7294582    
    600000   18000          200            200            0.0057983731   2.6926468e-35  0              0.017395119    256.59877      0              12390236       1.1971759e-13  0              3.7286695    
    700000   18000          200            200            0.0044577239  -2.6926442e-35  0              0.013373172    18.475126      0              892097.73      1.1971759e-13  0              3.7288869    
    800000   18000          200            200            0.0038401661  -1.7950959e-35  0              0.011520498    1.3602866      0              65683.372      1.1971759e-13  0              3.7289917    
    900000   18000          200            200            0.0036044611  -1.3463218e-35  0              0.010813383    0.0095911723   0              463.12338      1.1971759e-13  0              3.7290332    
   1000000   18000          200            200            0.0035073549   8.9754905e-36  0              0.010522065    0.0086060053   0              415.5532       1.1971759e-13  0              3.7290506    
   1100000   18000          200            200            0.0034711126   1.7950971e-35  0              0.010413338    0.0058969934   0              284.74471      1.1971759e-13  0              3.7290571    
   1200000   18000          200            200            0.0034589786   4.4877428e-36  0              0.010376936    0.0016393571   0              79.158688      1.1971759e-13  0              3.7290593    
   1300000   18000          200            200            0.0034554151  -5.6096772e-37  0              0.010366245    0.00031245055  0              15.087119      1.1971759e-13  0              3.72906      
   1400000   18000          200            200            0.0034545656   1.4024194e-36  0              0.010363697    4.6250082e-05  0              2.2332509      1.1971759e-13  0              3.7290601    
   1500000   18000          200            200            0.0034544513   2.8048389e-37  0              0.010363354    5.4780053e-06  0              0.26451327     1.1971759e-13  0              3.7290601    
   1600000   18000          200            200            0.0034544847  -1.4024194e-36  0              0.010363454    5.057866e-07   0              0.024422625    1.1971759e-13  0              3.7290601    
   1700000   18000          200            200            0.0034545226  -5.6096774e-37  0              0.010363568    3.242658e-08   0              0.0015657635   1.1971759e-13  0              3.7290601    
   1800000   18000          200            200            0.0034545442   8.4145164e-37  0              0.010363633    9.0062681e-10  0              4.3488045e-05  1.1971759e-13  0              3.7290601    
   1900000   18000          200            200            0.003454554    1.0135228e-44  0              0.010363662    9.5493344e-12  0              4.6110318e-07  1.1971759e-13  0              3.7290601    
   2000000   18000          200            200            0.0034545579   1.0409944e-44  0              0.010363674    3.6786187e-11  0              1.7762733e-06  1.1971759e-13  0              3.7290601    
   2100000   18000          200            200            0.0034545593   8.4145164e-37  0              0.010363678    1.4084029e-11  0              6.8006735e-07  1.1971759e-13  0              3.7290601    
   2200000   18000          200            200            0.0034545597   5.6096777e-37  0              0.010363679    3.156335e-12   0              1.5240812e-07  1.1971759e-13  0              3.7290601    
   2300000   18000          200            200            0.0034545599   1.0272595e-44  0              0.01036368     5.2476111e-13  0              2.5338836e-08  1.1971759e-13  0              3.7290601    
   2400000   18000          200            200            0.0034545599  -3.6462904e-36  0              0.01036368     6.9507803e-14  0              3.3562831e-09  1.1971759e-13  0              3.7290601    
   2500000   18000          200            200            0.0034545599  -5.6096774e-37  0              0.01036368     7.3040382e-15  0              3.5268586e-10  1.1971759e-13  0              3.7290601    
   2600000   18000          200            200            0.0034545599   2.8048389e-37  0              0.01036368     5.2713104e-16  0              2.5453271e-11  1.1971759e-13  0              3.7290601    
   2700000   18000          200            200            0.0034545599  -3.3658065e-36  0              0.01036368     5.2666841e-17  0              2.5430933e-12  1.1971759e-13  0              3.7290601    
   2800000   18000          200            200            0.0034545599   1.1219355e-36  0              0.01036368     7.036091e-19   0              3.3974765e-14  1.1971759e-13  0              3.7290601    
   2900000   18000          200            200            0.0034545599  -1.4024194e-36  0              0.01036368     5.8976719e-18  0              2.8477747e-13  1.1971759e-13  0              3.7290601    
   3000000   18000          200            200            0.0034545599  -1.6829033e-36  0              0.01036368     2.02588e-18    0              9.7822496e-14  1.1971759e-13  0              3.7290601    
Loop time of 773.806 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3349678.312 ns/day, 0.000 hours/ns, 3876.942 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 246.12     | 246.69     | 247.27     |   3.6 | 31.88
Neigh   | 5.8937     | 5.8937     | 5.8937     |   0.0 |  0.76
Comm    | 25.225     | 25.821     | 26.416     |  11.7 |  3.34
Output  | 0.623      | 0.62301    | 0.62302    |   0.0 |  0.08
Modify  | 431.54     | 433.24     | 434.95     |   8.2 | 55.99
Other   |            | 61.53      |            |       |  7.95

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.47                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 102.883059940812
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.57
  ghost atom cutoff = 4.57
  binsize = 2.285, bins = 7878 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 143.1 | 143.1 | 143.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047478628 -3.5901891e-35  0             -0.0014243589   463498.07      0              2.2380663e+10  1.1971759e-13  0              4.0641608    
    200000   18000          200            200            0.00035314461 -1.7950906e-35  0              0.0010594338   56559.785      0              2.7310696e+09  1.1971759e-13  0              3.8723435    
    300000   18000          200            200           -5.2506962e-05  3.5901985e-35  0             -0.00015752089  1936.6911      0              93515883       1.1971759e-13  0              3.7722111    
    400000   18000          200            200            0.024949718   -3.5901885e-35  0              0.074849154    3552.3609      0              1.7153079e+08  1.1971759e-13  0              3.7314842    
    500000   18000          200            200           -4.1210191e-05  5.3852954e-35  0             -0.00012363057  2399.5843      0              1.1586734e+08  1.1971759e-13  0              3.7349733    
    600000   18000          200            200            0.0045787523   8.9754986e-36  0              0.013736257    449.47439      0              21703509       1.1971759e-13  0              3.733863     
    700000   18000          200            200            0.0046315858   7.1803883e-35  0              0.013894757    0.57940793     0              27977.535      1.1971759e-13  0              3.7338587    
    800000   18000          200            200            0.0038758953  -5.3852896e-35  0              0.011627686    0.057998378    0              2800.5341      1.1971759e-13  0              3.7339863    
    900000   18000          200            200            0.0035961629   1.3463234e-35  0              0.010788489    0.19596875     0              9462.6297      1.1971759e-13  0              3.7340357    
   1000000   18000          200            200            0.0034975984   8.9754904e-36  0              0.010492795    0.076589154    0              3698.2162      1.1971759e-13  0              3.7340534    
   1100000   18000          200            200            0.0034672384  -4.4877389e-36  0              0.010401715    0.016834022    0              812.85468      1.1971759e-13  0              3.7340589    
   1200000   18000          200            200            0.0034595964   7.2607692e-43  0              0.010378789    0.002657548    0              128.32348      1.1971759e-13  0              3.7340603    
   1300000   18000          200            200            0.003458408   -1.1219355e-36  0              0.010375224    0.00031934829  0              15.420186      1.1971759e-13  0              3.7340605    
   1400000   18000          200            200            0.0034586076   8.4145164e-37  0              0.010375823    2.8402216e-05  0              1.3714414      1.1971759e-13  0              3.7340605    
   1500000   18000          200            200            0.0034588992   3.0853227e-36  0              0.010376698    1.5903539e-06  0              0.076792499    1.1971759e-13  0              3.7340605    
   1600000   18000          200            200            0.0034590705   1.0305745e-44  0              0.010377212    2.362831e-08   0              0.0011409265   1.1971759e-13  0              3.7340604    
   1700000   18000          200            200            0.0034591482  -2.8048387e-37  0              0.010377445    3.8004964e-09  0              0.00018351237  1.1971759e-13  0              3.7340604    
   1800000   18000          200            200            0.0034591784   5.6096777e-37  0              0.010377535    3.8400093e-09  0              0.00018542031  1.1971759e-13  0              3.7340604    
   1900000   18000          200            200            0.0034591885  -1.1219355e-36  0              0.010377566    1.1474847e-09  0              5.5407929e-05  1.1971759e-13  0              3.7340604    
   2000000   18000          200            200            0.0034591915  -2.8048387e-37  0              0.010377574    2.1908014e-10  0              1.0578596e-05  1.1971759e-13  0              3.7340604    
   2100000   18000          200            200            0.0034591921  -8.4145162e-37  0              0.010377576    3.1059066e-11  0              1.4997312e-06  1.1971759e-13  0              3.7340604    
   2200000   18000          200            200            0.0034591922   1.0227509e-44  0              0.010377577    3.3531725e-12  0              1.619127e-07   1.1971759e-13  0              3.7340604    
   2300000   18000          200            200            0.0034591921   1.1219355e-36  0              0.010377576    2.5731761e-13  0              1.2424947e-08  1.1971759e-13  0              3.7340604    
   2400000   18000          200            200            0.0034591921   1.0210777e-44  0              0.010377576    1.0560377e-14  0              5.0992282e-10  1.1971759e-13  0              3.7340604    
   2500000   18000          200            200            0.0034591921   2.6085001e-35  0              0.010377576    1.5612983e-17  0              7.5389509e-13  1.1971759e-13  0              3.7340604    
   2600000   18000          200            200            0.0034591921   2.8048389e-37  0              0.010377576    1.922547e-16   0              9.2832914e-12  1.1971759e-13  0              3.7340604    
   2700000   18000          200            200            0.0034591921   8.4145164e-37  0              0.010377576    1.5899586e-16  0              7.6773408e-12  1.1971759e-13  0              3.7340604    
   2800000   18000          200            200            0.0034591921  -1.1219355e-36  0              0.010377576    3.9468564e-18  0              1.9057957e-13  1.1971759e-13  0              3.7340604    
   2900000   18000          200            200            0.0034591921   2.8048389e-37  0              0.010377576    1.6342765e-18  0              7.8913365e-14  1.1971759e-13  0              3.7340604    
   3000000   18000          200            200            0.0034591921   2.5243549e-36  0              0.010377576    1.1316802e-17  0              5.4644785e-13  1.1971759e-13  0              3.7340604    
Loop time of 765.68 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3385228.133 ns/day, 0.000 hours/ns, 3918.088 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.91     | 244.52     | 246.13     |  10.3 | 31.94
Neigh   | 6.0486     | 6.0487     | 6.0489     |   0.0 |  0.79
Comm    | 25.721     | 27.135     | 28.55      |  27.2 |  3.54
Output  | 0.62367    | 0.62369    | 0.6237     |   0.0 |  0.08
Modify  | 429.06     | 429.09     | 429.12     |   0.2 | 56.04
Other   |            | 58.25      |            |       |  7.61

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.48                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 103.57509614901
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.58
  ghost atom cutoff = 4.58
  binsize = 2.29, bins = 7861 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 142.8 | 142.8 | 142.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047608868 -1.4360766e-34  0             -0.001428266    454276.46      0              2.1935385e+10  1.1971759e-13  0              4.072338     
    200000   18000          200            200            0.00036498996 -1.7950914e-35  0              0.0010949699   59828.086      0              2.8888842e+09  1.1971759e-13  0              3.8754606    
    300000   18000          200            200           -4.2412782e-05 -3.5901867e-35  0             -0.00012723835  1242.1886      0              59980844       1.1971759e-13  0              3.7775425    
    400000   18000          200            200            0.016998413   -1.0770575e-34  0              0.050995238    11497.278      0              5.5516239e+08  1.1971759e-13  0              3.7372735    
    500000   18000          200            200           -4.6509576e-05 -1.7950912e-35  0             -0.00013952873  1534.2403      0              74082975       1.1971759e-13  0              3.7403994    
    600000   18000          200            200            0.0032728074  -2.6926434e-35  0              0.0098184222   508.96297      0              24576001       1.1971759e-13  0              3.7390905    
    700000   18000          200            200            0.0045595324  -8.9754739e-36  0              0.013678597    8.5761724      0              414112.67      1.1971759e-13  0              3.7388712    
    800000   18000          200            200            0.0038160229   2.6926462e-35  0              0.011448069    2.5264521      0              121993.33      1.1971759e-13  0              3.7389977    
    900000   18000          200            200            0.0035527917   4.48775e-36    0              0.010658375    0.75417798     0              36416.556      1.1971759e-13  0              3.7390445    
   1000000   18000          200            200            0.0034767936  -8.9754778e-36  0              0.010430381    0.14473736     0              6988.849       1.1971759e-13  0              3.7390583    
   1100000   18000          200            200            0.0034607686  -1.3463223e-35  0              0.010382306    0.01976228     0              954.24979      1.1971759e-13  0              3.7390612    
   1200000   18000          200            200            0.003460071    4.4877428e-36  0              0.010380213    0.0019329787   0              93.336621      1.1971759e-13  0              3.7390614    
   1300000   18000          200            200            0.0034617166   1.6829033e-36  0              0.01038515     0.00011886253  0              5.7394461      1.1971759e-13  0              3.7390611    
   1400000   18000          200            200            0.003462909   -5.6096775e-37  0              0.010388727    2.2681992e-06  0              0.10952322     1.1971759e-13  0              3.7390609    
   1500000   18000          200            200            0.0034634897   2.8048389e-37  0              0.010390469    1.8213526e-07  0              0.0087946599   1.1971759e-13  0              3.7390608    
   1600000   18000          200            200            0.003463721    2.8048389e-37  0              0.010391163    2.3346729e-07  0              0.0112733      1.1971759e-13  0              3.7390607    
   1700000   18000          200            200            0.0034637992  -8.4145163e-36  0              0.010391398    7.1181457e-08  0              0.0034370978   1.1971759e-13  0              3.7390607    
   1800000   18000          200            200            0.0034638211  -2.8048387e-37  0              0.010391463    1.3173802e-08  0              0.00063611575  1.1971759e-13  0              3.7390607    
   1900000   18000          200            200            0.0034638255   8.4145164e-37  0              0.010391476    1.7330249e-09  0              8.3681571e-05  1.1971759e-13  0              3.7390607    
   2000000   18000          200            200            0.0034638255  -8.4145162e-37  0              0.010391476    1.6215919e-10  0              7.8300868e-06  1.1971759e-13  0              3.7390607    
   2100000   18000          200            200            0.0034638249  -1.4024194e-36  0              0.010391475    9.2252486e-12  0              4.4545424e-07  1.1971759e-13  0              3.7390607    
   2200000   18000          200            200            0.0034638246  -1.9633871e-36  0              0.010391474    1.2690051e-13  0              6.1275715e-09  1.1971759e-13  0              3.7390607    
   2300000   18000          200            200            0.0034638244  -1.1219355e-36  0              0.010391473    2.6062604e-14  0              1.2584699e-09  1.1971759e-13  0              3.7390607    
   2400000   18000          200            200            0.0034638243   1.0341002e-44  0              0.010391473    2.3563447e-14  0              1.1377945e-09  1.1971759e-13  0              3.7390607    
   2500000   18000          200            200            0.0034638243   2.8048389e-37  0              0.010391473    6.6319107e-15  0              3.2023123e-10  1.1971759e-13  0              3.7390607    
   2600000   18000          200            200            0.0034638243   8.4145164e-37  0              0.010391473    1.2178781e-15  0              5.8806975e-11  1.1971759e-13  0              3.7390607    
   2700000   18000          200            200            0.0034638243  -1.9633871e-36  0              0.010391473    1.2816814e-17  0              6.1887806e-13  1.1971759e-13  0              3.7390607    
   2800000   18000          200            200            0.0034638243  -1.9633871e-36  0              0.010391473    2.2202058e-17  0              1.0720579e-12  1.1971759e-13  0              3.7390607    
   2900000   18000          200            200            0.0034638243  -1.4024194e-36  0              0.010391473    2.4974459e-21  0              1.2059273e-16  1.1971759e-13  0              3.7390607    
   3000000   18000          200            200            0.0034638243   5.6096777e-37  0              0.010391473    1.1964478e-18  0              5.7772182e-14  1.1971759e-13  0              3.7390607    
Loop time of 761.847 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3402256.457 ns/day, 0.000 hours/ns, 3937.797 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.67     | 241.91     | 242.16     |   1.6 | 31.75
Neigh   | 6.0609     | 6.061      | 6.0611     |   0.0 |  0.80
Comm    | 25.94      | 26.022     | 26.104     |   1.6 |  3.42
Output  | 0.62361    | 0.62362    | 0.62364    |   0.0 |  0.08
Modify  | 428.06     | 428.13     | 428.21     |   0.4 | 56.20
Other   |            | 59.09      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.49                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 104.270228710928
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.59
  ghost atom cutoff = 4.59
  binsize = 2.295, bins = 7844 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 142.5 | 142.5 | 142.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047726202  1.7951046e-35  0             -0.001431786    445152.63      0              2.1494827e+10  1.1971759e-13  0              4.0804819    
    200000   18000          200            200            0.00037691848  3.5901965e-35  0              0.0011307554   63184.922      0              3.0509738e+09  1.1971759e-13  0              3.8785243    
    300000   18000          200            200           -3.2158015e-05 -3.5901864e-35  0             -9.6474046e-05  701.84341      0              33889507       1.1971759e-13  0              3.7827986    
    400000   18000          200            200            0.007589689   -5.3852827e-35  0              0.022769067    17078.871      0              8.2467756e+08  1.1971759e-13  0              3.7433967    
    500000   18000          200            200           -3.5205814e-05  2.5131361e-34  0             -0.00010561744  862.44121      0              41644200       1.1971759e-13  0              3.7457313    
    600000   18000          200            200            0.002145485    4.4877437e-35  0              0.006436455    410.18863      0              19806541       1.1971759e-13  0              3.7443131    
    700000   18000          200            200            0.0042603087  -1.5258322e-34  0              0.012780926    35.974746      0              1737091.7      1.1971759e-13  0              3.7439217    
    800000   18000          200            200            0.0036764223  -2.6926443e-35  0              0.011029267    6.6138095      0              319357.19      1.1971759e-13  0              3.7440232    
    900000   18000          200            200            0.0034869461  -4.4877339e-36  0              0.010460838    1.1471696      0              55392.714      1.1971759e-13  0              3.7440574    
   1000000   18000          200            200            0.0034523168   4.9365169e-35  0              0.010356951    0.1401188      0              6765.8353      1.1971759e-13  0              3.7440638    
   1100000   18000          200            200            0.0034553002   3.0754631e-42  0              0.010365901    0.011221194    0              541.83129      1.1971759e-13  0              3.7440633    
   1200000   18000          200            200            0.0034619051  -1.5707096e-35  0              0.010385715    0.0004216195   0              20.358497      1.1971759e-13  0              3.7440622    
   1300000   18000          200            200            0.0034658717   1.4024194e-36  0              0.010397615    1.6761515e-07  0              0.0080935359   1.1971759e-13  0              3.7440614    
   1400000   18000          200            200            0.0034676159   5.6096776e-37  0              0.010402848    8.8165908e-06  0              0.42572162     1.1971759e-13  0              3.7440611    
   1500000   18000          200            200            0.0034682429   9.4055587e-45  0              0.010404729    3.6144132e-06  0              0.17452708     1.1971759e-13  0              3.744061     
   1600000   18000          200            200            0.0034684263   2.8048389e-37  0              0.010405279    7.4197944e-07  0              0.035827532    1.1971759e-13  0              3.744061     
   1700000   18000          200            200            0.0034684647  -5.6096774e-37  0              0.010405394    1.0062348e-07  0              0.0048587479   1.1971759e-13  0              3.744061     
   1800000   18000          200            200            0.0034684659  -2.243871e-36   0              0.010405398    9.142791e-09   0              0.00044147266  1.1971759e-13  0              3.744061     
   1900000   18000          200            200            0.0034684616   4.7682259e-36  0              0.010405385    4.5174227e-10  0              2.1813017e-05  1.1971759e-13  0              3.744061     
   2000000   18000          200            200            0.0034684586   1.1219355e-36  0              0.010405376    2.0331647e-12  0              9.8174246e-08  1.1971759e-13  0              3.744061     
   2100000   18000          200            200            0.0034684572   2.8048389e-37  0              0.010405372    3.4464953e-12  0              1.6641892e-07  1.1971759e-13  0              3.744061     
   2200000   18000          200            200            0.0034684567   5.6096777e-37  0              0.01040537     1.9849401e-12  0              9.5845656e-08  1.1971759e-13  0              3.744061     
   2300000   18000          200            200            0.0034684565   1.0340862e-44  0              0.01040537     4.6755511e-13  0              2.2576563e-08  1.1971759e-13  0              3.744061     
   2400000   18000          200            200            0.0034684565   2.8048389e-37  0              0.010405369    7.0373738e-14  0              3.398096e-09   1.1971759e-13  0              3.744061     
   2500000   18000          200            200            0.0034684565  -3.9267743e-36  0              0.010405369    7.23089e-15    0              3.491538e-10   1.1971759e-13  0              3.744061     
   2600000   18000          200            200            0.0034684565  -5.6096774e-37  0              0.010405369    4.0527455e-16  0              1.9569258e-11  1.1971759e-13  0              3.744061     
   2700000   18000          200            200            0.0034684565   2.8048389e-37  0              0.010405369    7.5377551e-17  0              3.6397122e-12  1.1971759e-13  0              3.744061     
   2800000   18000          200            200            0.0034684565   5.6096777e-37  0              0.010405369    1.2105682e-18  0              5.8454005e-14  1.1971759e-13  0              3.744061     
   2900000   18000          200            200            0.0034684565   3.0853227e-36  0              0.010405369    1.5204844e-17  0              7.3418749e-13  1.1971759e-13  0              3.744061     
   3000000   18000          200            200            0.0034684565   1.1219355e-36  0              0.010405369    7.6457413e-18  0              3.6918548e-13  1.1971759e-13  0              3.744061     
Loop time of 763.879 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3393205.513 ns/day, 0.000 hours/ns, 3927.321 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.33     | 241.9      | 244.47     |  16.5 | 31.67
Neigh   | 6.121      | 6.1214     | 6.1218     |   0.0 |  0.80
Comm    | 25.3       | 27.751     | 30.202     |  46.5 |  3.63
Output  | 0.6191     | 0.61914    | 0.61918    |   0.0 |  0.08
Modify  | 428.06     | 428.19     | 428.32     |   0.6 | 56.05
Other   |            | 59.3       |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.5                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 104.968464538069
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.6
  ghost atom cutoff = 4.6
  binsize = 2.3, bins = 7827 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 139.5 | 139.5 | 139.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047830666  1.7951076e-35  0             -0.00143492     436126.27      0              2.1058977e+10  1.1971759e-13  0              4.0885924    
    200000   18000          200            200            0.00038893067 -5.3852853e-35  0              0.001166792    66630.367      0              3.217342e+09   1.1971759e-13  0              3.8815343    
    300000   18000          200            200           -2.1742863e-05  3.5902009e-35  0             -6.5228588e-05  315.05875      0              15213060       1.1971759e-13  0              3.7879794    
    400000   18000          200            200            0.00071519859  1.2565685e-34  0              0.0021455958   17282.849      0              8.345269e+08   1.1971759e-13  0              3.7496294    
    500000   18000          200            200           -2.3707688e-05 -8.9754792e-35  0             -7.1123064e-05  383.4046       0              18513236       1.1971759e-13  0              3.7509688    
    600000   18000          200            200            0.0013451362   2.6926468e-35  0              0.0040354086   226.74475      0              10948692       1.1971759e-13  0              3.7494967    
    700000   18000          200            200            0.0038090034   1.7950976e-35  0              0.01142701     61.285714      0              2959267.8      1.1971759e-13  0              3.749        
    800000   18000          200            200            0.0034920509   1.7950977e-35  0              0.010476153    8.8179908      0              425789.22      1.1971759e-13  0              3.7490572    
    900000   18000          200            200            0.0034168577  -8.975476e-36   0              0.010250573    1.0011108      0              48340.059      1.1971759e-13  0              3.7490712    
   1000000   18000          200            200            0.0034325525  -4.4877414e-35  0              0.010297658    0.067922788    0              3279.7484      1.1971759e-13  0              3.7490685    
   1100000   18000          200            200            0.0034540982  -1.3463223e-35  0              0.010362295    0.0013802682   0              66.648211      1.1971759e-13  0              3.7490647    
   1200000   18000          200            200            0.003466109    2.6926453e-35  0              0.010398327    0.0001047257   0              5.0568294      1.1971759e-13  0              3.7490625    
   1300000   18000          200            200            0.0034710641  -8.4145159e-37  0              0.010413192    0.0001326556   0              6.4054642      1.1971759e-13  0              3.7490616    
   1400000   18000          200            200            0.0034726948  -5.6096775e-37  0              0.010418084    3.7405526e-05  0              1.806179       1.1971759e-13  0              3.7490613    
   1500000   18000          200            200            0.0034730997   2.8048389e-37  0              0.010419299    5.992048e-06   0              0.28933455     1.1971759e-13  0              3.7490612    
   1600000   18000          200            200            0.0034731476  -2.8048387e-37  0              0.010419443    6.1112844e-07  0              0.029509205    1.1971759e-13  0              3.7490612    
   1700000   18000          200            200            0.0034731254   1.0147337e-44  0              0.010419376    3.4090264e-08  0              0.0016460968   1.1971759e-13  0              3.7490612    
   1800000   18000          200            200            0.0034731047  -1.1219355e-36  0              0.010419314    2.837533e-10   0              1.3701431e-05  1.1971759e-13  0              3.7490612    
   1900000   18000          200            200            0.0034730942  -8.4145162e-37  0              0.010419283    1.7844196e-10  0              8.6163234e-06  1.1971759e-13  0              3.7490612    
   2000000   18000          200            200            0.0034730902   1.0156834e-44  0              0.010419271    1.1812614e-10  0              5.7038885e-06  1.1971759e-13  0              3.7490613    
   2100000   18000          200            200            0.0034730889   2.5243549e-36  0              0.010419267    2.7921555e-11  0              1.3482319e-06  1.1971759e-13  0              3.7490613    
   2200000   18000          200            200            0.0034730886   5.6096776e-37  0              0.010419266    3.9836005e-12  0              1.9235381e-07  1.1971759e-13  0              3.7490613    
   2300000   18000          200            200            0.0034730886   1.0146021e-44  0              0.010419266    3.5544452e-13  0              1.7163144e-08  1.1971759e-13  0              3.7490613    
   2400000   18000          200            200            0.0034730887   8.6950002e-36  0              0.010419266    1.5299015e-14  0              7.387347e-10   1.1971759e-13  0              3.7490613    
   2500000   18000          200            200            0.0034730887   2.8048389e-37  0              0.010419266    1.9593741e-18  0              9.4611162e-14  1.1971759e-13  0              3.7490613    
   2600000   18000          200            200            0.0034730887  -2.5243549e-36  0              0.010419266    2.7334529e-16  0              1.3198866e-11  1.1971759e-13  0              3.7490613    
   2700000   18000          200            200            0.0034730887   8.4145164e-37  0              0.010419266    1.3775112e-16  0              6.6515084e-12  1.1971759e-13  0              3.7490613    
   2800000   18000          200            200            0.0034730887   1.0392161e-44  0              0.010419266    1.0669283e-17  0              5.1518149e-13  1.1971759e-13  0              3.7490613    
   2900000   18000          200            200            0.0034730887   1.0548113e-44  0              0.010419266    9.4763279e-18  0              4.5757796e-13  1.1971759e-13  0              3.7490613    
   3000000   18000          200            200            0.0034730887   2.8048389e-37  0              0.010419266    1.290554e-18   0              6.2316234e-14  1.1971759e-13  0              3.7490613    
Loop time of 764.506 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3390425.851 ns/day, 0.000 hours/ns, 3924.104 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.11     | 241.17     | 241.23     |   0.4 | 31.55
Neigh   | 6.1273     | 6.1275     | 6.1277     |   0.0 |  0.80
Comm    | 25.776     | 25.911     | 26.047     |   2.7 |  3.39
Output  | 0.61569    | 0.61571    | 0.61573    |   0.0 |  0.08
Modify  | 430.02     | 430.04     | 430.07     |   0.1 | 56.25
Other   |            | 60.64      |            |       |  7.93

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.51                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 105.669810541937
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.61
  ghost atom cutoff = 4.61
  binsize = 2.305, bins = 7810 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 139.2 | 139.2 | 139.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047922301 -3.231173e-34   0             -0.001437669    427197.47      0              2.0627837e+10  1.1971759e-13  0              4.0966693    
    200000   18000          200            200            0.00040102501 -5.385284e-35   0              0.001203075    70163.906      0              3.3879639e+09  1.1971759e-13  0              3.8844905    
    300000   18000          200            200           -1.1168671e-05  3.5902009e-35  0             -3.3506012e-05  81.31596       0              3926456.7      1.1971759e-13  0              3.7930846    
    400000   18000          200            200           -0.00013597737 -5.3852847e-35  0             -0.0004079321   14884.968      0              7.1874183e+08  1.1971759e-13  0              3.7558106    
    500000   18000          200            200           -1.2014879e-05 -1.7950924e-35  0             -3.6044637e-05  96.191432      0              4644740        1.1971759e-13  0              3.7561118    
    600000   18000          200            200            0.00089784925  1.4290414e-41  0              0.0026935477   64.061872      0              3093318.5      1.1971759e-13  0              3.7546167    
    700000   18000          200            200            0.0033100901   2.6926461e-35  0              0.0099302704   65.573039      0              3166287.4      1.1971759e-13  0              3.7540901    
    800000   18000          200            200            0.0033066526   1.7950977e-35  0              0.0099199577   7.3083788      0              352895.46      1.1971759e-13  0              3.754092     
    900000   18000          200            200            0.0033614345   1.3463234e-35  0              0.010084303    0.45803482     0              22116.862      1.1971759e-13  0              3.7540824    
   1000000   18000          200            200            0.0034244772   8.9754904e-36  0              0.010273432    0.0052380294   0              252.92569      1.1971759e-13  0              3.7540711    
   1100000   18000          200            200            0.0034590467   3.1123825e-42  0              0.01037714     0.0018863138   0              91.083341      1.1971759e-13  0              3.7540649    
   1200000   18000          200            200            0.0034728377   7.6251877e-43  0              0.010418513    0.0013842642   0              66.841163      1.1971759e-13  0              3.7540624    
   1300000   18000          200            200            0.0034770686  -8.4145159e-37  0              0.010431206    0.00032304957  0              15.598908      1.1971759e-13  0              3.7540616    
   1400000   18000          200            200            0.0034779477   1.6829033e-36  0              0.010433843    4.2891793e-05  0              2.0710912      1.1971759e-13  0              3.7540615    
   1500000   18000          200            200            0.003477951    2.8048389e-37  0              0.010433853    3.2612893e-06  0              0.15747599     1.1971759e-13  0              3.7540615    
   1600000   18000          200            200            0.0034778375   3.3658065e-36  0              0.010433513    8.3277082e-08  0              0.0040211523   1.1971759e-13  0              3.7540615    
   1700000   18000          200            200            0.0034777649  -1.4024194e-36  0              0.010433295    2.8841364e-09  0              0.00013926463  1.1971759e-13  0              3.7540615    
   1800000   18000          200            200            0.0034777336  -2.243871e-36   0              0.010433201    5.2006946e-09  0              0.00025112293  1.1971759e-13  0              3.7540615    
   1900000   18000          200            200            0.0034777232  -8.4145162e-37  0              0.01043317     1.5087441e-09  0              7.2851853e-05  1.1971759e-13  0              3.7540615    
   2000000   18000          200            200            0.0034777207   1.4024194e-36  0              0.010433162    2.3241822e-10  0              1.1222644e-05  1.1971759e-13  0              3.7540615    
   2100000   18000          200            200            0.0034777205   2.8048389e-37  0              0.010433161    2.1132964e-11  0              1.0204352e-06  1.1971759e-13  0              3.7540615    
   2200000   18000          200            200            0.0034777206  -5.6096774e-37  0              0.010433162    8.5125675e-13  0              4.1104142e-08  1.1971759e-13  0              3.7540615    
   2300000   18000          200            200            0.0034777208  -1.1219355e-36  0              0.010433162    2.83665e-16    0              1.3697168e-11  1.1971759e-13  0              3.7540615    
   2400000   18000          200            200            0.0034777209  -2.8048387e-37  0              0.010433163    1.7722916e-14  0              8.5577617e-10  1.1971759e-13  0              3.7540615    
   2500000   18000          200            200            0.0034777209  -8.4145162e-37  0              0.010433163    6.6717638e-15  0              3.221556e-10   1.1971759e-13  0              3.7540615    
   2600000   18000          200            200            0.0034777209   1.0422776e-44  0              0.010433163    1.2113483e-15  0              5.8491675e-11  1.1971759e-13  0              3.7540615    
   2700000   18000          200            200            0.0034777209   3.9267743e-36  0              0.010433163    3.1489507e-19  0              1.5205156e-14  1.1971759e-13  0              3.7540615    
   2800000   18000          200            200            0.0034777209   1.6829033e-36  0              0.010433163    8.0180567e-18  0              3.8716326e-13  1.1971759e-13  0              3.7540615    
   2900000   18000          200            200            0.0034777209   2.8048389e-37  0              0.010433163    8.8290162e-18  0              4.263216e-13   1.1971759e-13  0              3.7540615    
   3000000   18000          200            200            0.0034777209   2.8048388e-37  0              0.010433163    1.1296676e-18  0              5.4547606e-14  1.1971759e-13  0              3.7540615    
Loop time of 763.57 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3394581.783 ns/day, 0.000 hours/ns, 3928.914 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.87     | 242.96     | 245.04     |  13.4 | 31.82
Neigh   | 6.2441     | 6.2443     | 6.2446     |   0.0 |  0.82
Comm    | 25.258     | 27.168     | 29.077     |  36.6 |  3.56
Output  | 0.61489    | 0.61492    | 0.61495    |   0.0 |  0.08
Modify  | 427.16     | 427.16     | 427.16     |   0.0 | 55.94
Other   |            | 59.43      |            |       |  7.78

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.52                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 106.374273634036
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.62
  ghost atom cutoff = 4.62
  binsize = 2.31, bins = 7793 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 138.9 | 138.9 | 138.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048001147 -1.7950869e-35  0             -0.0014400344   418366.45      0              2.0201419e+10  1.1971759e-13  0              4.1047125    
    200000   18000          200            200            0.00041320012  1.7951021e-35  0              0.0012396004   73785.047      0              3.5628159e+09  1.1971759e-13  0              3.887393     
    300000   18000          200            200           -4.3830656e-07  1.7951028e-35  0             -1.3149197e-06  0.087976239    0              4248.0577      1.1971759e-13  0              3.7981141    
    400000   18000          200            200           -0.00012637735  1.795103e-35   0             -0.00037913206  12606.267      0              6.0871154e+08  1.1971759e-13  0              3.7619033    
    500000   18000          200            200           -1.3269388e-07  1.795101e-35   0             -3.9808163e-07  0.0026298397   0              126.98555      1.1971759e-13  0              3.76116      
    600000   18000          200            200            0.00076292857 -5.3852887e-35  0              0.0022887857   0.0069167725   0              333.98619      1.1971759e-13  0              3.759659     
    700000   18000          200            200            0.002865189   -1.7950959e-35  0              0.0085955669   46.509628      0              2245783.5      1.1971759e-13  0              3.7591746    
    800000   18000          200            200            0.0031616848  -8.9754753e-36  0              0.0094850543   3.3979591      0              164075.28      1.1971759e-13  0              3.7591199    
    900000   18000          200            200            0.0033355865   4.4877504e-36  0              0.01000676     0.033530341    0              1619.0602      1.1971759e-13  0              3.7590883    
   1000000   18000          200            200            0.0034317204   1.705342e-34   0              0.010295161    0.018522656    0              894.39278      1.1971759e-13  0              3.759071     
   1100000   18000          200            200            0.0034700473  -4.4877389e-36  0              0.010410142    0.0120352      0              581.13675      1.1971759e-13  0              3.759064     
   1200000   18000          200            200            0.0034813332   6.7316138e-36  0              0.010444       0.0025647539   0              123.84279      1.1971759e-13  0              3.759062     
   1300000   18000          200            200            0.0034833343   3.0853227e-36  0              0.010450003    0.00029601884  0              14.29369       1.1971759e-13  0              3.7590616    
   1400000   18000          200            200            0.0034830999  -2.8048387e-37  0              0.0104493      1.6711486e-05  0              0.80693785     1.1971759e-13  0              3.7590617    
   1500000   18000          200            200            0.0034826905   1.4024194e-36  0              0.010448071    8.4988982e-08  0              0.0041038138   1.1971759e-13  0              3.7590617    
   1600000   18000          200            200            0.0034824656  -1.1219355e-36  0              0.010447397    1.262219e-07   0              0.0060948039   1.1971759e-13  0              3.7590618    
   1700000   18000          200            200            0.003482379   -5.6096774e-37  0              0.010447137    6.7708191e-08  0              0.0032693862   1.1971759e-13  0              3.7590618    
   1800000   18000          200            200            0.0034823545  -1.1219355e-36  0              0.010447063    1.3412246e-08  0              0.00064762935  1.1971759e-13  0              3.7590618    
   1900000   18000          200            200            0.0034823506  -2.243871e-36   0              0.010447052    1.4536491e-09  0              7.019151e-05   1.1971759e-13  0              3.7590618    
   2000000   18000          200            200            0.0034823513   1.0199522e-44  0              0.010447054    7.3736928e-11  0              3.5604923e-06  1.1971759e-13  0              3.7590618    
   2100000   18000          200            200            0.0034823523  -5.6096774e-37  0              0.010447057    1.2417605e-13  0              5.9960169e-09  1.1971759e-13  0              3.7590618    
   2200000   18000          200            200            0.0034823528   1.0306638e-44  0              0.010447059    8.2762778e-13  0              3.9963184e-08  1.1971759e-13  0              3.7590618    
   2300000   18000          200            200            0.003482353    5.6096777e-37  0              0.010447059    3.7630151e-13  0              1.8170253e-08  1.1971759e-13  0              3.7590618    
   2400000   18000          200            200            0.0034823531   1.4024194e-36  0              0.010447059    6.9761529e-14  0              3.3685346e-09  1.1971759e-13  0              3.7590618    
   2500000   18000          200            200            0.0034823531  -1.1219355e-36  0              0.010447059    7.1886262e-15  0              3.4711303e-10  1.1971759e-13  0              3.7590618    
   2600000   18000          200            200            0.0034823531   2.8048389e-37  0              0.010447059    2.7639287e-16  0              1.3346023e-11  1.1971759e-13  0              3.7590618    
   2700000   18000          200            200            0.0034823531  -2.8048387e-37  0              0.010447059    1.2420156e-16  0              5.9972487e-12  1.1971759e-13  0              3.7590618    
   2800000   18000          200            200            0.0034823531  -2.8048387e-37  0              0.010447059    3.7670057e-19  0              1.8189523e-14  1.1971759e-13  0              3.7590618    
   2900000   18000          200            200            0.0034823531   1.0760733e-44  0              0.010447059    1.4717356e-17  0              7.1064843e-13  1.1971759e-13  0              3.7590618    
   3000000   18000          200            200            0.0034823531  -2.8048387e-37  0              0.010447059    1.3684678e-18  0              6.6078414e-14  1.1971759e-13  0              3.7590618    
Loop time of 762.061 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3401301.214 ns/day, 0.000 hours/ns, 3936.691 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.69     | 240.37     | 243.04     |  17.3 | 31.54
Neigh   | 5.6087     | 5.6087     | 5.6088     |   0.0 |  0.74
Comm    | 23.221     | 26.227     | 29.233     |  58.7 |  3.44
Output  | 0.61171    | 0.61172    | 0.61174    |   0.0 |  0.08
Modify  | 429.4      | 429.57     | 429.73     |   0.8 | 56.37
Other   |            | 59.68      |            |       |  7.83

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.53                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 107.081860725869
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.63
  ghost atom cutoff = 4.63
  binsize = 2.315, bins = 7776 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 138.7 | 138.7 | 138.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0004806724   1.7951061e-35  0             -0.0014420172   409632.13      0              1.9779669e+10  1.1971759e-13  0              4.1127223    
    200000   18000          200            200            0.00042545674 -5.3852862e-35  0              0.0012763702   77493.95       0              3.7419055e+09  1.1971759e-13  0              3.8902414    
    300000   18000          200            200            1.044891e-05   8.1163205e-41  0              3.1346729e-05  70.802651      0              3418806.6      1.1971759e-13  0              3.8030675    
    400000   18000          200            200           -0.00011657366  1.2565685e-34  0             -0.00034972097  10519.371      0              5.0794276e+08  1.1971759e-13  0              3.7679072    
    500000   18000          200            200            1.1939456e-05  3.5901979e-35  0              3.5818369e-05  93.907467      0              4534455.5      1.1971759e-13  0              3.7661132    
    600000   18000          200            200            0.00091289891 -6.2828374e-35  0              0.0027386967   61.36303       0              2963001.1      1.1971759e-13  0              3.7646189    
    700000   18000          200            200            0.0025497376  -2.6926442e-35  0              0.0076492127   18.454779      0              891115.23      1.1971759e-13  0              3.7642377    
    800000   18000          200            200            0.0030877643  -3.5901927e-35  0              0.009263293    0.34186137     0              16507.262      1.1971759e-13  0              3.764135     
    900000   18000          200            200            0.003346794    8.4072371e-42  0              0.010040382    0.12633175     0              6100.1079      1.1971759e-13  0              3.7640875    
   1000000   18000          200            200            0.0034535582  -8.9754775e-36  0              0.010360675    0.092920348    0              4486.7911      1.1971759e-13  0              3.7640682    
   1100000   18000          200            200            0.0034850462   1.7950971e-35  0              0.010455139    0.01966499     0              949.55198      1.1971759e-13  0              3.7640625    
   1200000   18000          200            200            0.0034901984  -8.9754833e-36  0              0.010470595    0.0020908749   0              100.96086      1.1971759e-13  0              3.7640615    
   1300000   18000          200            200            0.0034892056  -1.4024194e-36  0              0.010467617    9.1106357e-05  0              4.3991999      1.1971759e-13  0              3.7640617    
   1400000   18000          200            200            0.0034879215   5.6096776e-37  0              0.010463764    2.8748822e-08  0              0.0013881777   1.1971759e-13  0              3.7640619    
   1500000   18000          200            200            0.0034872663  -2.243871e-36   0              0.010461799    1.8451091e-06  0              0.089093714    1.1971759e-13  0              3.764062     
   1600000   18000          200            200            0.0034870342   2.8048389e-37  0              0.010461103    6.543585e-07   0              0.03159663     1.1971759e-13  0              3.7640621    
   1700000   18000          200            200            0.0034869783   2.8048389e-37  0              0.010460935    1.0014555e-07  0              0.0048356702   1.1971759e-13  0              3.7640621    
   1800000   18000          200            200            0.0034869746  -1.9633871e-36  0              0.010460924    7.6244776e-09  0              0.00036815874  1.1971759e-13  0              3.7640621    
   1900000   18000          200            200            0.0034869797  -2.8048387e-37  0              0.010460939    1.4007601e-10  0              6.7637691e-06  1.1971759e-13  0              3.7640621    
   2000000   18000          200            200            0.0034869832  -8.4145162e-37  0              0.01046095     1.7940883e-11  0              8.6630105e-07  1.1971759e-13  0              3.7640621    
   2100000   18000          200            200            0.0034869848   1.0134594e-44  0              0.010460954    1.7203313e-11  0              8.3068642e-07  1.1971759e-13  0              3.7640621    
   2200000   18000          200            200            0.0034869852   5.6096777e-37  0              0.010460956    3.9273156e-12  0              1.8963601e-07  1.1971759e-13  0              3.7640621    
   2300000   18000          200            200            0.0034869853   5.6096777e-37  0              0.010460956    4.4450611e-13  0              2.1463609e-08  1.1971759e-13  0              3.7640621    
   2400000   18000          200            200            0.0034869853   5.6096777e-37  0              0.010460956    2.1795479e-14  0              1.0524257e-09  1.1971759e-13  0              3.7640621    
   2500000   18000          200            200            0.0034869853   2.8048389e-37  0              0.010460956    1.6059215e-17  0              7.7544203e-13  1.1971759e-13  0              3.7640621    
   2600000   18000          200            200            0.0034869853   5.6096777e-37  0              0.010460956    3.4576582e-16  0              1.6695794e-11  1.1971759e-13  0              3.7640621    
   2700000   18000          200            200            0.0034869853   2.8048389e-37  0              0.010460956    9.692898e-17   0              4.6803535e-12  1.1971759e-13  0              3.7640621    
   2800000   18000          200            200            0.0034869853  -5.6096774e-37  0              0.010460956    2.1699366e-17  0              1.0477847e-12  1.1971759e-13  0              3.7640621    
   2900000   18000          200            200            0.0034869853  -5.6096774e-37  0              0.010460956    6.721216e-18   0              3.2454347e-13  1.1971759e-13  0              3.7640621    
   3000000   18000          200            200            0.0034869853   2.8048389e-37  0              0.010460956    4.7048365e-19  0              2.2717972e-14  1.1971759e-13  0              3.7640621    
Loop time of 757.501 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3421776.159 ns/day, 0.000 hours/ns, 3960.389 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.04     | 240.28     | 241.52     |   8.0 | 31.72
Neigh   | 5.3601     | 5.361      | 5.3619     |   0.0 |  0.71
Comm    | 23.408     | 24.794     | 26.181     |  27.8 |  3.27
Output  | 0.61785    | 0.61788    | 0.61791    |   0.0 |  0.08
Modify  | 428.18     | 428.23     | 428.28     |   0.2 | 56.53
Other   |            | 58.21      |            |       |  7.68

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 126
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.54                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 107.792578728941
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.64
  ghost atom cutoff = 4.64
  binsize = 2.32, bins = 7759 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 138.4 | 138.4 | 138.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048120616  3.5902e-35     0             -0.0014436185   400994.48      0              1.9362588e+10  1.1971759e-13  0              4.1206984    
    200000   18000          200            200            0.00043779442  4.9284077e-41  0              0.0013133832   81290.423      0              3.9252236e+09  1.1971759e-13  0              3.8930355    
    300000   18000          200            200            2.1491333e-05  6.6347842e-41  0              6.4473999e-05  292.93052      0              14144567       1.1971759e-13  0              3.8079449    
    400000   18000          200            200           -0.00010656806  3.5901997e-35  0             -0.00031970418  8623.5716      0              4.1640141e+08  1.1971759e-13  0              3.7738222    
    500000   18000          200            200            2.4199817e-05  1.7951013e-35  0              7.2599452e-05  377.05456      0              18206615       1.1971759e-13  0              3.7709711    
    600000   18000          200            200            0.0013758975  -1.795095e-35   0              0.0041276925   221.18755      0              10680355       1.1971759e-13  0              3.7695006    
    700000   18000          200            200            0.0024070703   1.009665e-41   0              0.007221211    1.0334287      0              49900.572      1.1971759e-13  0              3.769268     
    800000   18000          200            200            0.0031003557  -3.5901927e-35  0              0.009301067    0.63595843     0              30708.157      1.1971759e-13  0              3.769134     
    900000   18000          200            200            0.0033935357   8.5385189e-42  0              0.010180607    0.64444294     0              31117.843      1.1971759e-13  0              3.7690802    
   1000000   18000          200            200            0.0034850992   1.7950975e-35  0              0.010455298    0.14834182     0              7162.8955      1.1971759e-13  0              3.7690636    
   1100000   18000          200            200            0.0035006848  -1.3463223e-35  0              0.010502054    0.015663199    0              756.3198       1.1971759e-13  0              3.7690608    
   1200000   18000          200            200            0.003497899   -8.9754833e-36  0              0.010493697    0.00058943073  0              28.461501      1.1971759e-13  0              3.7690612    
   1300000   18000          200            200            0.0034941851  -5.6096772e-37  0              0.010482555    3.6657127e-06  0              0.17700415     1.1971759e-13  0              3.7690619    
   1400000   18000          200            200            0.003492329    3.1933997e-45  0              0.010476987    1.8809157e-05  0              0.90822689     1.1971759e-13  0              3.7690622    
   1500000   18000          200            200            0.003491706    5.8901614e-36  0              0.010475118    5.497988e-06   0              0.26547816     1.1971759e-13  0              3.7690623    
   1600000   18000          200            200            0.0034915769  -5.6096774e-37  0              0.010474731    6.9508547e-07  0              0.03356319     1.1971759e-13  0              3.7690624    
   1700000   18000          200            200            0.0034915816  -1.1219355e-36  0              0.010474745    3.645181e-08   0              0.0017601275   1.1971759e-13  0              3.7690624    
   1800000   18000          200            200            0.0034916013  -5.6096774e-37  0              0.010474804    2.2217967e-11  0              1.0728261e-06  1.1971759e-13  0              3.7690624    
   1900000   18000          200            200            0.0034916125  -8.4145162e-37  0              0.010474838    4.9614931e-10  0              2.3957274e-05  1.1971759e-13  0              3.7690624    
   2000000   18000          200            200            0.0034916166  -5.6096774e-37  0              0.01047485     1.9473537e-10  0              9.4030739e-06  1.1971759e-13  0              3.7690624    
   2100000   18000          200            200            0.0034916176   7.2925808e-36  0              0.010474853    2.9442963e-11  0              1.4216953e-06  1.1971759e-13  0              3.7690624    
   2200000   18000          200            200            0.0034916177   1.1219355e-36  0              0.010474853    2.0022409e-12  0              9.6681049e-08  1.1971759e-13  0              3.7690624    
   2300000   18000          200            200            0.0034916176   8.4145164e-37  0              0.010474853    1.8096577e-14  0              8.7381896e-10  1.1971759e-13  0              3.7690624    
   2400000   18000          200            200            0.0034916175  -2.8048387e-37  0              0.010474853    1.0913873e-14  0              5.2699185e-10  1.1971759e-13  0              3.7690624    
   2500000   18000          200            200            0.0034916175  -2.8048387e-37  0              0.010474852    6.5438385e-15  0              3.1597854e-10  1.1971759e-13  0              3.7690624    
   2600000   18000          200            200            0.0034916175  -1.1219355e-36  0              0.010474852    1.2024619e-15  0              5.8062583e-11  1.1971759e-13  0              3.7690624    
   2700000   18000          200            200            0.0034916175   2.8048389e-37  0              0.010474852    2.3463157e-18  0              1.1329519e-13  1.1971759e-13  0              3.7690624    
   2800000   18000          200            200            0.0034916175   1.4024194e-36  0              0.010474852    4.0954595e-18  0              1.9775508e-13  1.1971759e-13  0              3.7690624    
   2900000   18000          200            200            0.0034916175  -8.4145162e-37  0              0.010474852    1.2893522e-18  0              6.2258204e-14  1.1971759e-13  0              3.7690624    
   3000000   18000          200            200            0.0034916175  -1.3182742e-35  0              0.010474852    8.6112566e-19  0              4.1580676e-14  1.1971759e-13  0              3.7690624    
Loop time of 760.18 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3409716.856 ns/day, 0.000 hours/ns, 3946.432 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.4      | 240.89     | 243.37     |  16.0 | 31.69
Neigh   | 5.5342     | 5.535      | 5.5358     |   0.0 |  0.73
Comm    | 23.956     | 26.162     | 28.368     |  43.1 |  3.44
Output  | 0.6243     | 0.62432    | 0.62434    |   0.0 |  0.08
Modify  | 427.99     | 428.15     | 428.31     |   0.8 | 56.32
Other   |            | 58.82      |            |       |  7.74

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 130
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.55                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 108.506434554756
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.65
  ghost atom cutoff = 4.65
  binsize = 2.325, bins = 7742 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 138.1 | 138.1 | 138.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048161315  1.7951049e-35  0             -0.0014448394   392453.88      0              1.8950193e+10  1.1971759e-13  0              4.1286405    
    200000   18000          200            200            0.00045021217 -5.3852861e-35  0              0.0013506365   85174.108      0              4.1127529e+09  1.1971759e-13  0              3.8957753    
    300000   18000          200            200            3.2688174e-05  1.7951035e-35  0              9.8064523e-05  665.95238      0              32156457       1.1971759e-13  0              3.8127458    
    400000   18000          200            200           -9.6362132e-05  6.635199e-41   0             -0.0002890864   6918.1158      0              3.3405105e+08  1.1971759e-13  0              3.7796479    
    500000   18000          200            200            3.6646938e-05  1.795101e-35   0              0.00010994081  848.60828      0              40976257       1.1971759e-13  0              3.7757336    
    600000   18000          200            200            0.0021952814  -8.9754664e-36  0              0.0065858441   401.3541       0              19379953       1.1971759e-13  0              3.774318     
    700000   18000          200            200            0.0024539754  -2.6926441e-35  0              0.0073619261   5.9221381      0              285958.86      1.1971759e-13  0              3.7742603    
    800000   18000          200            200            0.0031981776  -1.7950959e-35  0              0.0095945328   4.0142491      0              193833.72      1.1971759e-13  0              3.7741172    
    900000   18000          200            200            0.0034655378   8.9754927e-36  0              0.010396614    1.0919514      0              52726.427      1.1971759e-13  0              3.7740684    
   1000000   18000          200            200            0.0035186056   4.4877487e-36  0              0.010555817    0.12513098     0              6042.1271      1.1971759e-13  0              3.7740587    
   1100000   18000          200            200            0.003513378    1.7950971e-35  0              0.010540134    0.0048198926   0              232.73537      1.1971759e-13  0              3.7740596    
   1200000   18000          200            200            0.0035033208   4.4877427e-36  0              0.010509962    3.4718425e-05  0              1.6764285      1.1971759e-13  0              3.7740614    
   1300000   18000          200            200            0.0034981337  -2.8048384e-37  0              0.010494401    0.00015794115  0              7.6264129      1.1971759e-13  0              3.7740623    
   1400000   18000          200            200            0.0034964222   5.6096776e-37  0              0.010489267    4.3232439e-05  0              2.0875397      1.1971759e-13  0              3.7740626    
   1500000   18000          200            200            0.0034961029  -1.1219355e-36  0              0.010488309    4.8113128e-06  0              0.23232108     1.1971759e-13  0              3.7740627    
   1600000   18000          200            200            0.0034961412  -5.0487098e-36  0              0.010488424    1.7517795e-07  0              0.0084587162   1.1971759e-13  0              3.7740626    
   1700000   18000          200            200            0.0034962055   1.4304678e-35  0              0.010488617    1.8963561e-09  0              9.1568249e-05  1.1971759e-13  0              3.7740626    
   1800000   18000          200            200            0.0034962381  -1.4024194e-36  0              0.010488714    6.4774539e-09  0              0.00031277307  1.1971759e-13  0              3.7740626    
   1900000   18000          200            200            0.0034962487   5.6096777e-37  0              0.010488746    1.7094132e-09  0              8.2541448e-05  1.1971759e-13  0              3.7740626    
   2000000   18000          200            200            0.0034962506  -2.243871e-36   0              0.010488752    1.8496665e-10  0              8.9313773e-06  1.1971759e-13  0              3.7740626    
   2100000   18000          200            200            0.0034962504  -2.8048387e-37  0              0.010488751    6.3496784e-12  0              3.0660325e-07  1.1971759e-13  0              3.7740626    
   2200000   18000          200            200            0.00349625     6.7316131e-36  0              0.01048875     9.8596649e-14  0              4.7608793e-09  1.1971759e-13  0              3.7740626    
   2300000   18000          200            200            0.0034962498  -5.6096774e-37  0              0.010488749    2.6466932e-13  0              1.2779934e-08  1.1971759e-13  0              3.7740626    
   2400000   18000          200            200            0.0034962497   5.6096777e-37  0              0.010488749    6.7479619e-14  0              3.2583493e-09  1.1971759e-13  0              3.7740626    
   2500000   18000          200            200            0.0034962497   2.8048389e-37  0              0.010488749    7.1054788e-15  0              3.4309814e-10  1.1971759e-13  0              3.7740626    
   2600000   18000          200            200            0.0034962497  -2.8048387e-37  0              0.010488749    2.4482789e-16  0              1.1821863e-11  1.1971759e-13  0              3.7740626    
   2700000   18000          200            200            0.0034962497   2.8048389e-37  0              0.010488749    1.4066397e-16  0              6.7921597e-12  1.1971759e-13  0              3.7740626    
   2800000   18000          200            200            0.0034962497  -3.6462904e-36  0              0.010488749    4.6172185e-18  0              2.2294896e-13  1.1971759e-13  0              3.7740626    
   2900000   18000          200            200            0.0034962497   5.6096776e-37  0              0.010488749    1.3172424e-17  0              6.3604921e-13  1.1971759e-13  0              3.7740626    
   3000000   18000          200            200            0.0034962497   8.4145164e-37  0              0.010488749    1.3638488e-17  0              6.5855378e-13  1.1971759e-13  0              3.7740626    
Loop time of 763.179 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3396318.380 ns/day, 0.000 hours/ns, 3930.924 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.42     | 242.09     | 244.75     |  17.1 | 31.72
Neigh   | 5.5463     | 5.5464     | 5.5464     |   0.0 |  0.73
Comm    | 24.146     | 26.678     | 29.209     |  49.0 |  3.50
Output  | 0.61176    | 0.61177    | 0.61178    |   0.0 |  0.08
Modify  | 428.73     | 428.86     | 429        |   0.7 | 56.19
Other   |            | 59.39      |            |       |  7.78

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.56                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 109.223435114817
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.66
  ghost atom cutoff = 4.66
  binsize = 2.33, bins = 7726 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 135.1 | 135.1 | 135.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048189381 -1.7950875e-35  0             -0.0014456814   384010.22      0              1.8542479e+10  1.1971759e-13  0              4.1365489    
    200000   18000          200            200            0.00046270808 -1.4360768e-34  0              0.0013881242   89144.325      0              4.3044604e+09  1.1971759e-13  0              3.8984608    
    300000   18000          200            200            4.4036411e-05  5.3852973e-35  0              0.00013210923  1189.2528      0              57424762       1.1971759e-13  0              3.8174702    
    400000   18000          200            200           -8.5959262e-05 -1.7950908e-35  0             -0.00025787779  5402.4969      0              2.6086724e+08  1.1971759e-13  0              3.785384     
    500000   18000          200            200            4.9276199e-05 -1.974606e-34   0              0.0001478286   1507.5638      0              72794859       1.1971759e-13  0              3.7804005    
    600000   18000          200            200            0.00334631    -1.7950951e-35  0              0.01003893     495.8329       0              23941996       1.1971759e-13  0              3.7790958    
    700000   18000          200            200            0.0026865645   2.6926464e-35  0              0.0080596934   29.689389      0              1433594.3      1.1971759e-13  0              3.7792159    
    800000   18000          200            200            0.0033631121   2.6926462e-35  0              0.010089336    7.6580798      0              369781.27      1.1971759e-13  0              3.7790883    
    900000   18000          200            200            0.0035459085  -3.5901928e-35  0              0.010637725    1.0381927      0              50130.609      1.1971759e-13  0              3.7790551    
   1000000   18000          200            200            0.0035456661  -4.4877355e-36  0              0.010636998    0.048237419    0              2329.2123      1.1971759e-13  0              3.779055     
   1100000   18000          200            200            0.0035204863   3.5901939e-35  0              0.010561459    7.6206035e-05  0              3.6797167      1.1971759e-13  0              3.7790594    
   1200000   18000          200            200            0.0035061768   4.4877427e-36  0              0.010518531    0.0011441984   0              55.249245      1.1971759e-13  0              3.7790619    
   1300000   18000          200            200            0.0035013264   1.1219355e-36  0              0.010503979    0.00032924178  0              15.897907      1.1971759e-13  0              3.7790628    
   1400000   18000          200            200            0.0035004396  -5.6096775e-37  0              0.010501319    3.4856461e-05  0              1.6830938      1.1971759e-13  0              3.779063     
   1500000   18000          200            200            0.0035005711   8.4145164e-37  0              0.010501713    9.6533848e-07  0              0.046612741    1.1971759e-13  0              3.779063     
   1600000   18000          200            200            0.0035007628   8.4145164e-37  0              0.010502288    4.6498468e-08  0              0.0022452446   1.1971759e-13  0              3.7790629    
   1700000   18000          200            200            0.0035008548   5.6096777e-37  0              0.010502564    6.3575693e-08  0              0.0030698427   1.1971759e-13  0              3.7790629    
   1800000   18000          200            200            0.0035008821   5.6096777e-37  0              0.010502646    1.3334577e-08  0              0.00064387902  1.1971759e-13  0              3.7790629    
   1900000   18000          200            200            0.0035008856  -1.4024194e-36  0              0.010502657    1.070782e-09   0              5.1704229e-05  1.1971759e-13  0              3.7790629    
   2000000   18000          200            200            0.003500884   -8.4145162e-37  0              0.010502652    1.2154076e-11  0              5.8687684e-07  1.1971759e-13  0              3.7790629    
   2100000   18000          200            200            0.0035008826   2.8048389e-37  0              0.010502648    5.3467566e-12  0              2.5817574e-07  1.1971759e-13  0              3.7790629    
   2200000   18000          200            200            0.003500882   -1.1219355e-36  0              0.010502646    3.1545251e-12  0              1.5232073e-07  1.1971759e-13  0              3.7790629    
   2300000   18000          200            200            0.0035008819   5.6096777e-37  0              0.010502646    5.0323107e-13  0              2.4299228e-08  1.1971759e-13  0              3.7790629    
   2400000   18000          200            200            0.0035008819  -2.8048387e-37  0              0.010502646    2.8875456e-14  0              1.3942924e-09  1.1971759e-13  0              3.7790629    
   2500000   18000          200            200            0.0035008819  -5.3291937e-36  0              0.010502646    1.7712304e-17  0              8.5526375e-13  1.1971759e-13  0              3.7790629    
   2600000   18000          200            200            0.0035008819   1.0373509e-44  0              0.010502646    4.0394047e-16  0              1.9504839e-11  1.1971759e-13  0              3.7790629    
   2700000   18000          200            200            0.0035008819   5.6096777e-37  0              0.010502646    7.1855329e-17  0              3.4696367e-12  1.1971759e-13  0              3.7790629    
   2800000   18000          200            200            0.0035008819   1.1219355e-36  0              0.010502646    2.1166041e-17  0              1.0220324e-12  1.1971759e-13  0              3.7790629    
   2900000   18000          200            200            0.0035008819  -5.6096775e-37  0              0.010502646    1.4510056e-17  0              7.0063867e-13  1.1971759e-13  0              3.7790629    
   3000000   18000          200            200            0.0035008819  -5.6096774e-37  0              0.010502646    6.2096496e-18  0              2.9984175e-13  1.1971759e-13  0              3.7790629    
Loop time of 760.51 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3408239.001 ns/day, 0.000 hours/ns, 3944.721 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.58     | 241.17     | 241.75     |   3.8 | 31.71
Neigh   | 5.4229     | 5.423      | 5.4232     |   0.0 |  0.71
Comm    | 24.474     | 24.922     | 25.369     |   9.0 |  3.28
Output  | 0.61679    | 0.61679    | 0.61679    |   0.0 |  0.08
Modify  | 428.93     | 428.95     | 428.97     |   0.1 | 56.40
Other   |            | 59.43      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.57                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 109.943587320628
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.67
  ghost atom cutoff = 4.67
  binsize = 2.335, bins = 7709 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 134.9 | 134.9 | 134.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048204836  1.7951027e-35  0             -0.0014461451   375662.27      0              1.8139387e+10  1.1971759e-13  0              4.1444235    
    200000   18000          200            200            0.00047528452 -3.5901899e-35  0              0.0014258536   93201.817      0              4.5003822e+09  1.1971759e-13  0              3.9010913    
    300000   18000          200            200            5.5538319e-05  7.9232834e-41  0              0.00016661496  1862.4702      0              89932019       1.1971759e-13  0              3.8221178    
    400000   18000          200            200           -7.53572e-05    1.7951032e-35  0             -0.0002260716   4075.4254      0              1.9678771e+08  1.1971759e-13  0              3.7910306    
    500000   18000          200            200            8.1003452e-05  2.3336263e-34  0              0.00024301036  2353.2285      0              1.1362898e+08  1.1971759e-13  0              3.7849713    
    600000   18000          200            200            0.0046769284  -8.975467e-36   0              0.014030785    431.62961      0              20841849       1.1971759e-13  0              3.7838689    
    700000   18000          200            200            0.0030782624   1.2329289e-41  0              0.0092347871   55.828715      0              2695768.8      1.1971759e-13  0              3.7841427    
    800000   18000          200            200            0.0035619999  -3.5901927e-35  0              0.010686       8.4786201      0              409402.22      1.1971759e-13  0              3.7840538    
    900000   18000          200            200            0.0036151245   8.3071576e-42  0              0.010845374    0.53254567     0              25714.724      1.1971759e-13  0              3.7840439    
   1000000   18000          200            200            0.0035596779   2.2438717e-35  0              0.010679034    0.00047708643  0              23.036796      1.1971759e-13  0              3.7840536    
   1100000   18000          200            200            0.0035211937  -4.4877389e-36  0              0.010563581    0.0070240339   0              339.16546      1.1971759e-13  0              3.7840604    
   1200000   18000          200            200            0.0035071118  -1.5707096e-35  0              0.010521335    0.0024414762   0              117.89015      1.1971759e-13  0              3.7840629    
   1300000   18000          200            200            0.0035043415  -8.414516e-37   0              0.010513024    0.00026993244  0              13.034071      1.1971759e-13  0              3.7840634    
   1400000   18000          200            200            0.0035046527  -2.8048387e-37  0              0.010513958    6.9186816e-06  0              0.33407837     1.1971759e-13  0              3.7840633    
   1500000   18000          200            200            0.0035051898  -5.6096775e-37  0              0.010515569    4.8831031e-07  0              0.023578757    1.1971759e-13  0              3.7840632    
   1600000   18000          200            200            0.0035054472  -1.1219355e-36  0              0.010516342    5.38524e-07    0              0.026003397    1.1971759e-13  0              3.7840632    
   1700000   18000          200            200            0.0035055196   5.6096777e-37  0              0.010516559    9.9668733e-08  0              0.0048126464   1.1971759e-13  0              3.7840632    
   1800000   18000          200            200            0.0035055259  -3.3658065e-36  0              0.010516578    6.2211011e-09  0              0.00030039471  1.1971759e-13  0              3.7840632    
   1900000   18000          200            200            0.0035055199  -2.8048387e-37  0              0.01051656     5.3229354e-12  0              2.570255e-07   1.1971759e-13  0              3.7840632    
   2000000   18000          200            200            0.0035055158   4.487742e-36   0              0.010516547    8.2531583e-11  0              3.9851548e-06  1.1971759e-13  0              3.7840632    
   2100000   18000          200            200            0.0035055142   1.1219355e-36  0              0.010516543    2.8597175e-11  0              1.3808553e-06  1.1971759e-13  0              3.7840632    
   2200000   18000          200            200            0.003505514    2.8048389e-37  0              0.010516542    3.1543734e-12  0              1.523134e-07   1.1971759e-13  0              3.7840632    
   2300000   18000          200            200            0.003505514   -8.4145162e-37  0              0.010516542    8.044254e-14   0              3.8842824e-09  1.1971759e-13  0              3.7840632    
   2400000   18000          200            200            0.003505514   -1.1219355e-36  0              0.010516542    5.9535415e-15  0              2.8747521e-10  1.1971759e-13  0              3.7840632    
   2500000   18000          200            200            0.0035055141   1.6829033e-36  0              0.010516542    6.2875778e-15  0              3.0360463e-10  1.1971759e-13  0              3.7840632    
   2600000   18000          200            200            0.0035055141   5.0487098e-36  0              0.010516542    1.1872915e-15  0              5.7330056e-11  1.1971759e-13  0              3.7840632    
   2700000   18000          200            200            0.0035055141  -5.6096774e-37  0              0.010516542    1.7488904e-17  0              8.4447659e-13  1.1971759e-13  0              3.7840632    
   2800000   18000          200            200            0.0035055141   8.4145164e-37  0              0.010516542    8.1417432e-19  0              3.9313564e-14  1.1971759e-13  0              3.7840632    
   2900000   18000          200            200            0.0035055141   9.8855368e-45  0              0.010516542    5.1909313e-19  0              2.506515e-14   1.1971759e-13  0              3.7840632    
   3000000   18000          200            200            0.0035055141   5.6096777e-37  0              0.010516542    8.2197151e-18  0              3.9690063e-13  1.1971759e-13  0              3.7840632    
Loop time of 765.971 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3383940.337 ns/day, 0.000 hours/ns, 3916.598 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.09     | 243.61     | 247.13     |  22.6 | 31.80
Neigh   | 5.5931     | 5.5932     | 5.5933     |   0.0 |  0.73
Comm    | 24.513     | 27.756     | 30.998     |  61.5 |  3.62
Output  | 0.61726    | 0.61728    | 0.6173     |   0.0 |  0.08
Modify  | 428.93     | 428.96     | 429        |   0.2 | 56.00
Other   |            | 59.43      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.58                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 110.666898083693
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.68
  ghost atom cutoff = 4.68
  binsize = 2.34, bins = 7693 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 134.6 | 134.6 | 134.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048207744 -1.7950888e-35  0             -0.0014462323   367411.62      0              1.7740992e+10  1.1971759e-13  0              4.1522639    
    200000   18000          200            200            0.00048793651  3.5901981e-35  0              0.0014638095   97344.862      0              4.700435e+09   1.1971759e-13  0              3.9036675    
    300000   18000          200            200            6.7187804e-05 -7.1803816e-35  0              0.00020156341  2684.7688      0              1.2963788e+08  1.1971759e-13  0              3.8266885    
    400000   18000          200            200           -6.4562908e-05  1.7951018e-35  0             -0.00019368872  2936.7896      0              1.4180706e+08  1.1971759e-13  0              3.7965871    
    500000   18000          200            200            0.0016467761   3.5901978e-35  0              0.0049403282   3177.6029      0              1.5343507e+08  1.1971759e-13  0              3.7894515    
    600000   18000          200            200            0.0059086282   1.6076701e-41  0              0.017725885    237.48141      0              11467127       1.1971759e-13  0              3.7886776    
    700000   18000          200            200            0.0035713871   3.5901948e-35  0              0.010714161    65.215745      0              3149034.9      1.1971759e-13  0              3.7890544    
    800000   18000          200            200            0.0037513954   8.975485e-35   0              0.011254186    5.7274182      0              276556.52      1.1971759e-13  0              3.7890215    
    900000   18000          200            200            0.0036560243  -4.4877337e-36  0              0.010968073    0.063281083    0              3055.617       1.1971759e-13  0              3.7890377    
   1000000   18000          200            200            0.0035578411   6.3761576e-42  0              0.010673523    0.033024224    0              1594.6216      1.1971759e-13  0              3.7890549    
   1100000   18000          200            200            0.0035167846   1.3463229e-35  0              0.010550354    0.017242252    0              832.56664      1.1971759e-13  0              3.7890622    
   1200000   18000          200            200            0.0035074701   4.4877427e-36  0              0.01052241     0.0022120464   0              106.8118       1.1971759e-13  0              3.7890639    
   1300000   18000          200            200            0.0035078285   1.1219355e-36  0              0.010523486    6.6170984e-05  0              3.19516        1.1971759e-13  0              3.7890639    
   1400000   18000          200            200            0.0035092467  -1.4024194e-36  0              0.01052774     3.2080274e-06  0              0.15490416     1.1971759e-13  0              3.7890636    
   1500000   18000          200            200            0.0035099653   2.8048389e-37  0              0.010529896    4.1460308e-06  0              0.20019699     1.1971759e-13  0              3.7890635    
   1600000   18000          200            200            0.0035101668  -8.4145162e-37  0              0.010530501    7.4602246e-07  0              0.036022755    1.1971759e-13  0              3.7890634    
   1700000   18000          200            200            0.0035101812  -8.4145162e-37  0              0.010530543    3.9444205e-08  0              0.0019046195   1.1971759e-13  0              3.7890634    
   1800000   18000          200            200            0.0035101624  -6.731613e-36   0              0.010530487    3.9954952e-11  0              1.9292817e-06  1.1971759e-13  0              3.7890634    
   1900000   18000          200            200            0.0035101504  -2.8048387e-37  0              0.010530451    8.7123073e-10  0              4.2068614e-05  1.1971759e-13  0              3.7890634    
   2000000   18000          200            200            0.0035101464   5.6096777e-37  0              0.010530439    2.2807811e-10  0              1.1013076e-05  1.1971759e-13  0              3.7890634    
   2100000   18000          200            200            0.0035101458   1.042874e-44   0              0.010530437    1.8252792e-11  0              8.8136198e-07  1.1971759e-13  0              3.7890634    
   2200000   18000          200            200            0.003510146    5.6096777e-37  0              0.010530438    1.0262692e-13  0              4.9554868e-09  1.1971759e-13  0              3.7890634    
   2300000   18000          200            200            0.0035101462  -2.8048387e-37  0              0.010530439    1.523459e-13   0              7.3562384e-09  1.1971759e-13  0              3.7890634    
   2400000   18000          200            200            0.0035101463  -2.8048387e-37  0              0.010530439    6.355289e-14   0              3.0687416e-09  1.1971759e-13  0              3.7890634    
   2500000   18000          200            200            0.0035101463   1.1219355e-36  0              0.010530439    7.3539972e-15  0              3.550982e-10   1.1971759e-13  0              3.7890634    
   2600000   18000          200            200            0.0035101463  -5.6096774e-37  0              0.010530439    1.8407105e-16  0              8.888132e-12   1.1971759e-13  0              3.7890634    
   2700000   18000          200            200            0.0035101463   8.4145164e-37  0              0.010530439    1.5476837e-16  0              7.4732105e-12  1.1971759e-13  0              3.7890634    
   2800000   18000          200            200            0.0035101463  -5.6096774e-37  0              0.010530439    7.0938774e-18  0              3.4253795e-13  1.1971759e-13  0              3.7890634    
   2900000   18000          200            200            0.0035101463  -1.4024194e-36  0              0.010530439    1.5484946e-17  0              7.4771262e-13  1.1971759e-13  0              3.7890634    
   3000000   18000          200            200            0.0035101463  -1.6829033e-36  0              0.010530439    1.06065e-17    0              5.1214993e-13  1.1971759e-13  0              3.7890634    
Loop time of 765.521 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3385931.146 ns/day, 0.000 hours/ns, 3918.902 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.63     | 244.04     | 244.44     |   2.6 | 31.88
Neigh   | 5.5842     | 5.5847     | 5.5852     |   0.0 |  0.73
Comm    | 25.341     | 25.363     | 25.385     |   0.4 |  3.31
Output  | 0.64606    | 0.64608    | 0.64611    |   0.0 |  0.08
Modify  | 429.53     | 429.71     | 429.89     |   0.9 | 56.13
Other   |            | 60.18      |            |       |  7.86

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.59                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 111.393374315515
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.69
  ghost atom cutoff = 4.69
  binsize = 2.345, bins = 7676 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 134.4 | 134.4 | 134.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048198115 -1.7950841e-35  0             -0.0014459434   359256.21      0              1.7347197e+10  1.1971759e-13  0              4.1600704    
    200000   18000          200            200            0.00050066768 -1.7950872e-35  0              0.001502003    101574.66      0              4.9046769e+09  1.1971759e-13  0              3.9061885    
    300000   18000          200            200            7.8988218e-05  6.1891345e-41  0              0.00023696465  3655.9183      0              1.7653121e+08  1.1971759e-13  0              3.831182     
    400000   18000          200            200           -5.3573165e-05  6.2096686e-41  0             -0.00016071949  1985.2954      0              95862812       1.1971759e-13  0              3.8020535    
    500000   18000          200            200            0.0046606632   8.9754885e-35  0              0.013981989    3323.3088      0              1.6047069e+08  1.1971759e-13  0              3.7938822    
    600000   18000          200            200            0.0067179594   2.6926466e-35  0              0.020153878    48.202489      0              2327525.7      1.1971759e-13  0              3.7935591    
    700000   18000          200            200            0.0040753536  -1.2565677e-34  0              0.012226061    50.014189      0              2415006.2      1.1971759e-13  0              3.7939681    
    800000   18000          200            200            0.0038871379  -8.9754748e-36  0              0.011661414    1.7450243      0              84260.979      1.1971759e-13  0              3.793999     
    900000   18000          200            200            0.0036587687   4.4877502e-36  0              0.010976306    0.084823712    0              4095.8335      1.1971759e-13  0              3.7940382    
   1000000   18000          200            200            0.0035420505  -6.2828382e-35  0              0.010626152    0.10995473     0              5309.3203      1.1971759e-13  0              3.7940588    
   1100000   18000          200            200            0.0035102161   3.0594628e-42  0              0.010530648    0.018449626    0              890.86642      1.1971759e-13  0              3.7940645    
   1200000   18000          200            200            0.0035088025  -2.2438703e-36  0              0.010526407    0.00076220412  0              36.804109      1.1971759e-13  0              3.7940648    
   1300000   18000          200            200            0.0035122466  -8.414516e-37   0              0.01053674     1.1520195e-05  0              0.556269       1.1971759e-13  0              3.7940642    
   1400000   18000          200            200            0.0035142379   3.5366296e-45  0              0.010542714    2.9238101e-05  0              1.4118032      1.1971759e-13  0              3.7940638    
   1500000   18000          200            200            0.0035148282   5.6096776e-37  0              0.010544485    5.6920761e-06  0              0.27484998     1.1971759e-13  0              3.7940637    
   1600000   18000          200            200            0.0035148756  -8.4145162e-37  0              0.010544627    2.9027079e-07  0              0.014016138    1.1971759e-13  0              3.7940637    
   1700000   18000          200            200            0.0035148228   1.0541766e-44  0              0.010544468    9.8763881e-10  0              4.7689543e-05  1.1971759e-13  0              3.7940637    
   1800000   18000          200            200            0.0035147889   5.6096777e-37  0              0.010544367    7.6169733e-09  0              0.00036779638  1.1971759e-13  0              3.7940637    
   1900000   18000          200            200            0.0035147781  -1.6829033e-36  0              0.010544334    1.7287844e-09  0              8.3476814e-05  1.1971759e-13  0              3.7940637    
   2000000   18000          200            200            0.0035147769  -5.6096774e-37  0              0.010544331    1.0617715e-10  0              5.1269143e-06  1.1971759e-13  0              3.7940637    
   2100000   18000          200            200            0.0035147777  -2.8048387e-37  0              0.010544333    4.7933011e-15  0              2.3145135e-10  1.1971759e-13  0              3.7940637    
   2200000   18000          200            200            0.0035147783   8.4145164e-37  0              0.010544335    1.9313456e-12  0              9.3257769e-08  1.1971759e-13  0              3.7940637    
   2300000   18000          200            200            0.0035147785   2.8048389e-37  0              0.010544335    5.1769552e-13  0              2.4997664e-08  1.1971759e-13  0              3.7940637    
   2400000   18000          200            200            0.0035147785  -2.243871e-36   0              0.010544335    3.8533083e-14  0              1.8606247e-09  1.1971759e-13  0              3.7940637    
   2500000   18000          200            200            0.0035147785  -2.8048387e-37  0              0.010544335    6.5916825e-17  0              3.1828876e-12  1.1971759e-13  0              3.7940637    
   2600000   18000          200            200            0.0035147785   5.6096777e-37  0              0.010544335    4.5147914e-16  0              2.1800312e-11  1.1971759e-13  0              3.7940637    
   2700000   18000          200            200            0.0035147785   8.4145164e-37  0              0.010544335    4.6783071e-17  0              2.258987e-12   1.1971759e-13  0              3.7940637    
   2800000   18000          200            200            0.0035147785   2.8048389e-37  0              0.010544335    1.7174748e-17  0              8.2930713e-13  1.1971759e-13  0              3.7940637    
   2900000   18000          200            200            0.0035147785  -1.1219355e-36  0              0.010544335    3.6628541e-18  0              1.7686611e-13  1.1971759e-13  0              3.7940637    
   3000000   18000          200            200            0.0035147785  -1.6829033e-36  0              0.010544335    4.2140737e-18  0              2.0348254e-13  1.1971759e-13  0              3.7940637    
Loop time of 763.137 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3396505.398 ns/day, 0.000 hours/ns, 3931.141 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.24     | 242.6      | 243.96     |   8.7 | 31.79
Neigh   | 5.5542     | 5.5544     | 5.5545     |   0.0 |  0.73
Comm    | 23.705     | 25.355     | 27.004     |  32.8 |  3.32
Output  | 0.61437    | 0.61439    | 0.61441    |   0.0 |  0.08
Modify  | 428.74     | 428.8      | 428.86     |   0.3 | 56.19
Other   |            | 60.22      |            |       |  7.89

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.6                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 112.123022927599
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.7
  ghost atom cutoff = 4.7
  binsize = 2.35, bins = 7660 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 134.1 | 134.1 | 134.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0004817601  -3.5901864e-35  0             -0.0014452803   351197.52      0              1.6958071e+10  1.1971759e-13  0              4.1678427    
    200000   18000          200            200            0.00051347426  1.7951007e-35  0              0.0015404228   105889.87      0              5.1130431e+09  1.1971759e-13  0              3.9086547    
    300000   18000          200            200            9.0934806e-05  3.5901996e-35  0              0.00027280442  4775.0901      0              2.3057201e+08  1.1971759e-13  0              3.8355982    
    400000   18000          200            200           -4.2393704e-05  3.5901994e-35  0             -0.00012718111  1220.5334      0              58935190       1.1971759e-13  0              3.8074294    
    500000   18000          200            200            0.0083362578   4.2339699e-41  0              0.025008773    2430.8149      0              1.1737535e+08  1.1971759e-13  0              3.7983452    
    600000   18000          200            200            0.0068632601  -1.615587e-34   0              0.02058978     8.8474904      0              427213.65      1.1971759e-13  0              3.7985383    
    700000   18000          200            200            0.0044796111  -8.9754725e-36  0              0.013438833    21.168015      0              1022127.7      1.1971759e-13  0              3.7989016    
    800000   18000          200            200            0.003936042   -8.9754748e-36  0              0.011808126    0.0034523444   0              166.70135      1.1971759e-13  0              3.7989915    
    900000   18000          200            200            0.0036237824  -1.3463218e-35  0              0.010871347    0.57194248     0              27617.055      1.1971759e-13  0              3.7990454    
   1000000   18000          200            200            0.0035183323   6.1779649e-42  0              0.010554997    0.14752071     0              7123.2471      1.1971759e-13  0              3.7990641    
   1100000   18000          200            200            0.0035051515  -7.6291612e-35  0              0.010515455    0.0092209168   0              445.24507      1.1971759e-13  0              3.7990665    
   1200000   18000          200            200            0.0035123071  -1.1219354e-35  0              0.010536921    3.1042004e-06  0              0.14989073     1.1971759e-13  0              3.7990652    
   1300000   18000          200            200            0.0035176815   1.6829033e-36  0              0.010553044    0.00018281661  0              8.8275598      1.1971759e-13  0              3.7990643    
   1400000   18000          200            200            0.0035194676   5.6096776e-37  0              0.010558403    4.3902548e-05  0              2.1198969      1.1971759e-13  0              3.799064     
   1500000   18000          200            200            0.0035196668   2.8048389e-37  0              0.010559001    2.5058808e-06  0              0.12100001     1.1971759e-13  0              3.7990639    
   1600000   18000          200            200            0.0035195331  -2.5243549e-36  0              0.010558599    4.6385583e-09  0              0.00022397938  1.1971759e-13  0              3.799064     
   1700000   18000          200            200            0.0035194391   1.0316842e-44  0              0.010558317    5.8859018e-08  0              0.0028420913   1.1971759e-13  0              3.799064     
   1800000   18000          200            200            0.003519409   -3.0853226e-36  0              0.010558227    1.3015581e-08  0              0.00062847583  1.1971759e-13  0              3.799064     
   1900000   18000          200            200            0.0035194061   6.4511292e-36  0              0.010558218    6.7433287e-10  0              3.2561121e-05  1.1971759e-13  0              3.799064     
   2000000   18000          200            200            0.0035194086   5.6096777e-37  0              0.010558226    3.3311385e-12  0              1.6084876e-07  1.1971759e-13  0              3.799064     
   2100000   18000          200            200            0.0035194102  -1.1219355e-36  0              0.010558231    1.8830811e-11  0              9.0927246e-07  1.1971759e-13  0              3.799064     
   2200000   18000          200            200            0.0035194107   6.7316131e-36  0              0.010558232    3.8404187e-12  0              1.8544007e-07  1.1971759e-13  0              3.799064     
   2300000   18000          200            200            0.0035194107   2.243871e-36   0              0.010558232    1.7969441e-13  0              8.6767999e-09  1.1971759e-13  0              3.799064     
   2400000   18000          200            200            0.0035194107   2.8048389e-37  0              0.010558232    1.6188875e-15  0              7.8170282e-11  1.1971759e-13  0              3.799064     
   2500000   18000          200            200            0.0035194107   1.0193699e-44  0              0.010558232    5.9449618e-15  0              2.8706093e-10  1.1971759e-13  0              3.799064     
   2600000   18000          200            200            0.0035194107   1.1219355e-36  0              0.010558232    1.1555929e-15  0              5.5799447e-11  1.1971759e-13  0              3.799064     
   2700000   18000          200            200            0.0035194107  -1.9633871e-36  0              0.010558232    3.7376768e-17  0              1.8047903e-12  1.1971759e-13  0              3.799064     
   2800000   18000          200            200            0.0035194107   1.1219355e-36  0              0.010558232    4.6802039e-20  0              2.259903e-15   1.1971759e-13  0              3.799064     
   2900000   18000          200            200            0.0035194107   5.6096777e-37  0              0.010558232    3.8947827e-19  0              1.8806512e-14  1.1971759e-13  0              3.799064     
   3000000   18000          200            200            0.0035194107   1.1219355e-36  0              0.010558232    3.5808688e-18  0              1.7290734e-13  1.1971759e-13  0              3.799064     
Loop time of 764.204 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3391765.680 ns/day, 0.000 hours/ns, 3925.655 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.16     | 245.54     | 247.92     |  15.2 | 32.13
Neigh   | 5.5862     | 5.5865     | 5.5868     |   0.0 |  0.73
Comm    | 23.503     | 26.199     | 28.894     |  52.7 |  3.43
Output  | 0.62347    | 0.62348    | 0.6235     |   0.0 |  0.08
Modify  | 426.61     | 426.63     | 426.64     |   0.1 | 55.83
Other   |            | 59.63      |            |       |  7.80

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 138
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.61                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 112.855850831449
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.71
  ghost atom cutoff = 4.71
  binsize = 2.355, bins = 7644 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 131.2 | 131.2 | 131.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048141449  5.3852968e-35  0             -0.0014442435   343234.09      0              1.6573546e+10  1.1971759e-13  0              4.1755808    
    200000   18000          200            200            0.0005263584   4.2151776e-41  0              0.0015790752   110291.22      0              5.3255685e+09  1.1971759e-13  0              3.9110655    
    300000   18000          200            200            0.00010302933  3.590199e-35   0              0.000309088    6042.0204      0              2.9174754e+08  1.1971759e-13  0              3.8399367    
    400000   18000          200            200           -3.1022409e-05 -3.5901869e-35  0             -9.3067226e-05  641.4762       0              30974590       1.1971759e-13  0              3.8127148    
    500000   18000          200            200            0.011544915   -1.0770577e-34  0              0.034634746    959.24611      0              46318562       1.1971759e-13  0              3.8029403    
    600000   18000          200            200            0.0062967148   8.9754989e-36  0              0.018890145    149.877        0              7237024        1.1971759e-13  0              3.8036198    
    700000   18000          200            200            0.0046846491  -5.3852892e-35  0              0.014053947    1.3138026      0              63438.827      1.1971759e-13  0              3.8038689    
    800000   18000          200            200            0.0038863954   8.0779366e-35  0              0.011659186    2.0209651      0              97585.171      1.1971759e-13  0              3.8040008    
    900000   18000          200            200            0.0035616891   8.975492e-36   0              0.010685067    1.0451114      0              50464.687      1.1971759e-13  0              3.8040574    
   1000000   18000          200            200            0.0034949977  -1.346322e-35   0              0.010484993    0.10514377     0              5077.0165      1.1971759e-13  0              3.8040693    
   1100000   18000          200            200            0.0035047519   3.5901939e-35  0              0.010514256    0.00062541903  0              30.199247      1.1971759e-13  0              3.8040677    
   1200000   18000          200            200            0.0035183932   8.9754848e-36  0              0.01055518     0.00092411691  0              44.622298      1.1971759e-13  0              3.8040653    
   1300000   18000          200            200            0.0035238107  -2.8048384e-37  0              0.010571432    0.00033090705  0              15.978317      1.1971759e-13  0              3.8040643    
   1400000   18000          200            200            0.0035246718   2.8048388e-37  0              0.010574015    2.4195183e-05  0              1.1682988      1.1971759e-13  0              3.8040641    
   1500000   18000          200            200            0.0035243816   5.6096776e-37  0              0.010573145    3.8365658e-10  0              1.8525403e-05  1.1971759e-13  0              3.8040642    
   1600000   18000          200            200            0.0035241262  -2.5243549e-36  0              0.010572379    4.0566902e-07  0              0.019588305    1.1971759e-13  0              3.8040642    
   1700000   18000          200            200            0.0035240392  -5.6096774e-37  0              0.010572118    9.9046618e-08  0              0.0047826067   1.1971759e-13  0              3.8040642    
   1800000   18000          200            200            0.0035240301   2.8048389e-37  0              0.01057209     4.9733388e-09  0              0.00024014473  1.1971759e-13  0              3.8040642    
   1900000   18000          200            200            0.0035240371   8.4145164e-37  0              0.010572111    4.6332839e-11  0              2.237247e-06   1.1971759e-13  0              3.8040642    
   2000000   18000          200            200            0.0035240417  -8.4145162e-37  0              0.010572125    1.5888833e-10  0              7.6721487e-06  1.1971759e-13  0              3.8040642    
   2100000   18000          200            200            0.003524043    2.8048389e-37  0              0.010572129    2.7912725e-11  0              1.3478056e-06  1.1971759e-13  0              3.8040642    
   2200000   18000          200            200            0.0035240431   1.1219355e-36  0              0.010572129    8.6807014e-13  0              4.1916e-08     1.1971759e-13  0              3.8040642    
   2300000   18000          200            200            0.0035240429   2.8048389e-37  0              0.010572129    5.7009749e-14  0              2.7527967e-09  1.1971759e-13  0              3.8040642    
   2400000   18000          200            200            0.0035240429  -5.6096774e-37  0              0.010572129    5.7773714e-14  0              2.7896859e-09  1.1971759e-13  0              3.8040642    
   2500000   18000          200            200            0.0035240428   1.0384807e-44  0              0.010572129    7.3633155e-15  0              3.5554815e-10  1.1971759e-13  0              3.8040642    
   2600000   18000          200            200            0.0035240428  -2.5243549e-36  0              0.010572129    1.6120777e-16  0              7.7841464e-12  1.1971759e-13  0              3.8040642    
   2700000   18000          200            200            0.0035240429  -1.4024194e-36  0              0.010572129    1.5395717e-16  0              7.4340407e-12  1.1971759e-13  0              3.8040642    
   2800000   18000          200            200            0.0035240429   2.8048389e-37  0              0.010572129    2.1152811e-17  0              1.0213936e-12  1.1971759e-13  0              3.8040642    
   2900000   18000          200            200            0.0035240429   5.6096776e-37  0              0.010572129    3.3331995e-18  0              1.6094827e-13  1.1971759e-13  0              3.8040642    
   3000000   18000          200            200            0.0035240429  -5.6096775e-37  0              0.010572129    1.6567799e-18  0              7.9999974e-14  1.1971759e-13  0              3.8040642    
Loop time of 759.871 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3411103.983 ns/day, 0.000 hours/ns, 3948.037 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.38     | 241.48     | 241.57     |   0.6 | 31.78
Neigh   | 5.6158     | 5.6159     | 5.616      |   0.0 |  0.74
Comm    | 24.717     | 25.051     | 25.385     |   6.7 |  3.30
Output  | 0.6793     | 0.67931    | 0.67933    |   0.0 |  0.09
Modify  | 427.91     | 427.91     | 427.91     |   0.0 | 56.31
Other   |            | 59.13      |            |       |  7.78

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.62                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 113.591864938568
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.72
  ghost atom cutoff = 4.72
  binsize = 2.36, bins = 7628 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 131 | 131 | 131 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0004809448   5.3853013e-35  0             -0.0014428344   335366.49      0              1.6193648e+10  1.1971759e-13  0              4.1832847    
    200000   18000          200            200            0.00053931792 -5.3852855e-35  0              0.0016179537   114777.92      0              5.5422149e+09  1.1971759e-13  0              3.9134209    
    300000   18000          200            200            0.00011527001  3.5901984e-35  0              0.00034581003  7456.1432      0              3.6003047e+08  1.1971759e-13  0              3.8441975    
    400000   18000          200            200           -1.9461616e-05 -1.7950906e-35  0             -5.8384847e-05  247.46592      0              11949244       1.1971759e-13  0              3.8179093    
    500000   18000          200            200            0.013119396   -1.7950928e-35  0              0.039358187    31.980047      0              1544202        1.1971759e-13  0              3.8077552    
    600000   18000          200            200            0.0051885415   1.7950983e-35  0              0.015565625    358.85629      0              17327886       1.1971759e-13  0              3.8087866    
    700000   18000          200            200            0.0046363941  -4.1287226e-34  0              0.013909182    6.5138441      0              314530.22      1.1971759e-13  0              3.8088772    
    800000   18000          200            200            0.0037518772   1.7950977e-35  0              0.011255631    5.9827752      0              288886.8       1.1971759e-13  0              3.8090249    
    900000   18000          200            200            0.0034902094  -4.4877413e-35  0              0.010470628    1.0428248      0              50354.276      1.1971759e-13  0              3.8090711    
   1000000   18000          200            200            0.0034802008   1.3463232e-35  0              0.010440602    0.028893027    0              1395.1409      1.1971759e-13  0              3.8090731    
   1100000   18000          200            200            0.0035106612   8.9754872e-36  0              0.010531984    0.0029115978   0              140.59064      1.1971759e-13  0              3.8090677    
   1200000   18000          200            200            0.003526534    7.3546747e-43  0              0.010579602    0.0022949028   0              110.81264      1.1971759e-13  0              3.8090649    
   1300000   18000          200            200            0.0035300326   5.6096779e-37  0              0.010590098    0.00024165615  0              11.66871       1.1971759e-13  0              3.8090643    
   1400000   18000          200            200            0.0035295979   2.243871e-36   0              0.010588794    1.1002191e-06  0              0.053125644    1.1971759e-13  0              3.8090644    
   1500000   18000          200            200            0.0035289327   5.6096776e-37  0              0.010586798    2.3947781e-06  0              0.11563526     1.1971759e-13  0              3.8090645    
   1600000   18000          200            200            0.0035286755   1.9633872e-36  0              0.010586027    7.5543122e-07  0              0.03647707     1.1971759e-13  0              3.8090645    
   1700000   18000          200            200            0.0035286414  -1.4024194e-36  0              0.010585924    4.2986233e-08  0              0.0020756514   1.1971759e-13  0              3.8090645    
   1800000   18000          200            200            0.0035286591   1.1219355e-36  0              0.010585977    2.644823e-10   0              1.2770904e-05  1.1971759e-13  0              3.8090645    
   1900000   18000          200            200            0.0035286719  -5.6096774e-37  0              0.010586016    1.2205693e-09  0              5.8936922e-05  1.1971759e-13  0              3.8090645    
   2000000   18000          200            200            0.0035286757   2.8048389e-37  0              0.010586027    2.0656207e-10  0              9.9741433e-06  1.1971759e-13  0              3.8090645    
   2100000   18000          200            200            0.0035286757   1.0473016e-44  0              0.010586027    4.8401735e-12  0              2.3371466e-07  1.1971759e-13  0              3.8090645    
   2200000   18000          200            200            0.0035286753   1.0203545e-44  0              0.010586026    7.2147818e-13  0              3.4837599e-08  1.1971759e-13  0              3.8090645    
   2300000   18000          200            200            0.0035286751  -5.6096774e-37  0              0.010586025    4.7861505e-13  0              2.3110608e-08  1.1971759e-13  0              3.8090645    
   2400000   18000          200            200            0.003528675    2.8048389e-37  0              0.010586025    4.589936e-14   0              2.2163158e-09  1.1971759e-13  0              3.8090645    
   2500000   18000          200            200            0.003528675   -2.5243549e-36  0              0.010586025    1.212427e-16   0              5.8543763e-12  1.1971759e-13  0              3.8090645    
   2600000   18000          200            200            0.003528675   -5.6096774e-37  0              0.010586025    5.3216853e-16  0              2.5696514e-11  1.1971759e-13  0              3.8090645    
   2700000   18000          200            200            0.003528675   -2.8048387e-37  0              0.010586025    1.8552661e-17  0              8.9584162e-13  1.1971759e-13  0              3.8090645    
   2800000   18000          200            200            0.003528675   -1.9633871e-36  0              0.010586025    9.9228918e-18  0              4.7914093e-13  1.1971759e-13  0              3.8090645    
   2900000   18000          200            200            0.003528675   -5.6096775e-37  0              0.010586025    1.2918206e-17  0              6.2377394e-13  1.1971759e-13  0              3.8090645    
   3000000   18000          200            200            0.003528675    8.4145164e-37  0              0.010586025    3.4976276e-19  0              1.6888792e-14  1.1971759e-13  0              3.8090645    
Loop time of 758.217 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3418547.325 ns/day, 0.000 hours/ns, 3956.652 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.11     | 242.26     | 242.4      |   0.9 | 31.95
Neigh   | 5.1072     | 5.1072     | 5.1073     |   0.0 |  0.67
Comm    | 23.502     | 23.96      | 24.417     |   9.3 |  3.16
Output  | 0.61867    | 0.61869    | 0.61871    |   0.0 |  0.08
Modify  | 427.62     | 427.69     | 427.76     |   0.3 | 56.41
Other   |            | 58.58      |            |       |  7.73

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.63                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 114.33107216046
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.73
  ghost atom cutoff = 4.73
  binsize = 2.365, bins = 7611 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.7 | 130.7 | 130.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00048035147 -8.9754782e-35  0             -0.0014410544   327594.75      0              1.5818378e+10  1.1971759e-13  0              4.1909541    
    200000   18000          200            200            0.00055235155  4.8406589e-41  0              0.0016570547   119349.47      0              5.7629587e+09  1.1971759e-13  0              3.915721     
    300000   18000          200            200            0.00012765384  1.0770585e-34  0              0.00038296152  9016.7071      0              4.3538452e+08  1.1971759e-13  0              3.8483802    
    400000   18000          200            200           -7.7149675e-06  3.5901991e-35  0             -2.3144903e-05  37.807841      0              1825605.3      1.1971759e-13  0              3.8230127    
    500000   18000          200            200            0.012427852    3.2311747e-34  0              0.037283556    439.39075      0              21216607       1.1971759e-13  0              3.8128335    
    600000   18000          200            200            0.0038493322  -1.0770579e-34  0              0.011547996    479.76297      0              23166037       1.1971759e-13  0              3.8140051    
    700000   18000          200            200            0.0043479015   8.9754937e-36  0              0.013043705    32.324957      0              1560856.5      1.1971759e-13  0              3.8139249    
    800000   18000          200            200            0.003567347    1.7950977e-35  0              0.010702041    8.3856191      0              404911.54      1.1971759e-13  0              3.8140581    
    900000   18000          200            200            0.0034291757   8.0724385e-42  0              0.010287527    0.57022066     0              27533.915      1.1971759e-13  0              3.8140831    
   1000000   18000          200            200            0.0034795803   6.4213833e-42  0              0.010438741    0.0011179367   0              53.981163      1.1971759e-13  0              3.8140743    
   1100000   18000          200            200            0.0035224683  -4.4877389e-36  0              0.010567405    0.013234719    0              639.05723      1.1971759e-13  0              3.8140667    
   1200000   18000          200            200            0.003535454    1.1219356e-35  0              0.010606362    0.0022984219   0              110.98257      1.1971759e-13  0              3.8140644    
   1300000   18000          200            200            0.0035357081   3.4515094e-44  0              0.010607124    4.4474528e-05  0              2.1475158      1.1971759e-13  0              3.8140644    
   1400000   18000          200            200            0.0035341163   8.4145164e-37  0              0.010602349    1.0689267e-05  0              0.51614646     1.1971759e-13  0              3.8140646    
   1500000   18000          200            200            0.0035333595  -8.4145162e-37  0              0.010600079    5.5827669e-06  0              0.26957183     1.1971759e-13  0              3.8140648    
   1600000   18000          200            200            0.0035332247   1.4024194e-36  0              0.010599674    4.1530727e-07  0              0.020053702    1.1971759e-13  0              3.8140648    
   1700000   18000          200            200            0.0035332628  -8.4145162e-37  0              0.010599788    3.0918189e-10  0              1.4929287e-05  1.1971759e-13  0              3.8140648    
   1800000   18000          200            200            0.0035332979   2.8048389e-37  0              0.010599894    8.5929418e-09  0              0.00041492241  1.1971759e-13  0              3.8140648    
   1900000   18000          200            200            0.0035333088  -2.8048387e-37  0              0.010599926    1.5866213e-09  0              7.6612262e-05  1.1971759e-13  0              3.8140648    
   2000000   18000          200            200            0.0035333092   5.6096777e-37  0              0.010599928    3.5105311e-11  0              1.6951098e-06  1.1971759e-13  0              3.8140648    
   2100000   18000          200            200            0.0035333079   2.8048389e-37  0              0.010599924    6.4633258e-12  0              3.1209087e-07  1.1971759e-13  0              3.8140648    
   2200000   18000          200            200            0.0035333073  -8.4145162e-37  0              0.010599922    3.7422906e-12  0              1.8070182e-07  1.1971759e-13  0              3.8140648    
   2300000   18000          200            200            0.0035333072   1.028878e-44   0              0.010599922    2.9830033e-13  0              1.4403856e-08  1.1971759e-13  0              3.8140648    
   2400000   18000          200            200            0.0035333072   2.5243549e-36  0              0.010599922    4.3404101e-17  0              2.0958287e-12  1.1971759e-13  0              3.8140648    
   2500000   18000          200            200            0.0035333072   2.8048388e-36  0              0.010599922    5.4785386e-15  0              2.6453902e-10  1.1971759e-13  0              3.8140648    
   2600000   18000          200            200            0.0035333072   8.4145164e-37  0              0.010599922    1.1322917e-15  0              5.4674316e-11  1.1971759e-13  0              3.8140648    
   2700000   18000          200            200            0.0035333072  -8.4145162e-37  0              0.010599922    5.9926699e-17  0              2.8936458e-12  1.1971759e-13  0              3.8140648    
   2800000   18000          200            200            0.0035333072  -1.1219355e-36  0              0.010599922    2.1021767e-18  0              1.0150659e-13  1.1971759e-13  0              3.8140648    
   2900000   18000          200            200            0.0035333072  -2.8048387e-37  0              0.010599922    7.516087e-18   0              3.6292494e-13  1.1971759e-13  0              3.8140648    
   3000000   18000          200            200            0.0035333072  -8.4145162e-37  0              0.010599922    1.3834414e-17  0              6.6801435e-13  1.1971759e-13  0              3.8140648    
Loop time of 758.071 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3419202.653 ns/day, 0.000 hours/ns, 3957.410 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.67     | 241.43     | 242.19     |   4.9 | 31.85
Neigh   | 4.9327     | 4.933      | 4.9334     |   0.0 |  0.65
Comm    | 23.425     | 23.863     | 24.3       |   9.0 |  3.15
Output  | 0.62461    | 0.62463    | 0.62466    |   0.0 |  0.08
Modify  | 428.44     | 428.49     | 428.54     |   0.2 | 56.52
Other   |            | 58.73      |            |       |  7.75

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.64                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 115.073479408629
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.74
  ghost atom cutoff = 4.74
  binsize = 2.37, bins = 7595 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.5 | 130.5 | 130.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047963475  1.7951026e-35  0             -0.0014389043   319918.07      0              1.5447699e+10  1.1971759e-13  0              4.1985892    
    200000   18000          200            200            0.00056545977  7.1803916e-35  0              0.0016963793   124006.02      0              5.987807e+09   1.1971759e-13  0              3.9179654    
    300000   18000          200            200            0.00014018076 -1.2565671e-34  0              0.00042054228  10723.304      0              5.1778997e+08  1.1971759e-13  0              3.8524848    
    400000   18000          200            200            4.2167693e-06  3.5901994e-35  0              1.2650308e-05  11.696868      0              564799.9       1.1971759e-13  0              3.8280248    
    500000   18000          200            200            0.0097332063  -1.7950926e-35  0              0.029199619    1817.7043      0              87770434       1.1971759e-13  0              3.8181574    
    600000   18000          200            200            0.0025966457   3.5901952e-35  0              0.0077899372   437.57789      0              21129070       1.1971759e-13  0              3.8192342    
    700000   18000          200            200            0.003894659    8.9754933e-36  0              0.011683977    57.632213      0              2782853.3      1.1971759e-13  0              3.8190016    
    800000   18000          200            200            0.0033781938   8.4537259e-42  0              0.010134581    7.1624591      0              345849.51      1.1971759e-13  0              3.8190928    
    900000   18000          200            200            0.0033953344   8.9754922e-36  0              0.010186003    0.08679677     0              4191.1054      1.1971759e-13  0              3.8190903    
   1000000   18000          200            200            0.0034946713   1.3463233e-35  0              0.010484014    0.051303746    0              2477.2743      1.1971759e-13  0              3.8190727    
   1100000   18000          200            200            0.0035378349   1.3463226e-34  0              0.010613505    0.019119965    0              923.23471      1.1971759e-13  0              3.8190651    
   1200000   18000          200            200            0.0035435916   4.4877427e-36  0              0.010630775    0.00093255344  0              45.029668      1.1971759e-13  0              3.8190641    
   1300000   18000          200            200            0.0035404176   2.8048391e-37  0              0.010621253    2.3568085e-05  0              1.1380185      1.1971759e-13  0              3.8190646    
   1400000   18000          200            200            0.0035382776   1.1219355e-36  0              0.010614833    3.7587733e-05  0              1.8149771      1.1971759e-13  0              3.819065     
   1500000   18000          200            200            0.0035377613   2.8048389e-37  0              0.010613284    4.1476389e-06  0              0.20027464     1.1971759e-13  0              3.8190651    
   1600000   18000          200            200            0.0035378172   2.8048388e-36  0              0.010613452    6.8338673e-09  0              0.00032998299  1.1971759e-13  0              3.8190651    
   1700000   18000          200            200            0.0035379095   8.4145164e-37  0              0.010613729    5.3645924e-08  0              0.0025903697   1.1971759e-13  0              3.819065     
   1800000   18000          200            200            0.0035379424  -5.6096774e-37  0              0.010613827    1.2524121e-08  0              0.000604745    1.1971759e-13  0              3.819065     
   1900000   18000          200            200            0.0035379447   1.1219355e-36  0              0.010613834    3.3783748e-10  0              1.6312963e-05  1.1971759e-13  0              3.819065     
   2000000   18000          200            200            0.0035379413  -1.9633871e-36  0              0.010613824    4.4752806e-11  0              2.1609528e-06  1.1971759e-13  0              3.819065     
   2100000   18000          200            200            0.0035379396   5.6096777e-37  0              0.010613819    2.8467611e-11  0              1.374599e-06   1.1971759e-13  0              3.819065     
   2200000   18000          200            200            0.0035379392  -3.0853226e-36  0              0.010613818    2.0972435e-12  0              1.0126838e-07  1.1971759e-13  0              3.819065     
   2300000   18000          200            200            0.0035379393  -1.6829033e-36  0              0.010613818    4.9452343e-15  0              2.3878767e-10  1.1971759e-13  0              3.819065     
   2400000   18000          200            200            0.0035379394   8.4145164e-37  0              0.010613818    4.8536639e-14  0              2.3436606e-09  1.1971759e-13  0              3.819065     
   2500000   18000          200            200            0.0035379394   1.0400379e-44  0              0.010613818    7.5504632e-15  0              3.6458485e-10  1.1971759e-13  0              3.819065     
   2600000   18000          200            200            0.0035379394  -1.1219355e-36  0              0.010613818    1.0702719e-16  0              5.1679598e-12  1.1971759e-13  0              3.819065     
   2700000   18000          200            200            0.0035379394  -1.9633871e-36  0              0.010613818    1.4827903e-16  0              7.1598636e-12  1.1971759e-13  0              3.819065     
   2800000   18000          200            200            0.0035379394  -2.8048387e-37  0              0.010613818    2.2239339e-17  0              1.0738581e-12  1.1971759e-13  0              3.819065     
   2900000   18000          200            200            0.0035379394  -1.6829033e-36  0              0.010613818    2.2341876e-18  0              1.0788092e-13  1.1971759e-13  0              3.819065     
   3000000   18000          200            200            0.0035379394   2.8048389e-37  0              0.010613818    5.8337294e-18  0              2.8168992e-13  1.1971759e-13  0              3.819065     
Loop time of 767.795 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3375902.116 ns/day, 0.000 hours/ns, 3907.294 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.99     | 247.2      | 252.42     |  33.1 | 32.20
Neigh   | 4.9167     | 4.9169     | 4.917      |   0.0 |  0.64
Comm    | 21.36      | 26.634     | 31.907     | 102.2 |  3.47
Output  | 0.61177    | 0.61178    | 0.61179    |   0.0 |  0.08
Modify  | 428.29     | 428.35     | 428.41     |   0.3 | 55.79
Other   |            | 60.08      |            |       |  7.82

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.65                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 115.819093594578
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.75
  ghost atom cutoff = 4.75
  binsize = 2.375, bins = 7579 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.2 | 130.2 | 130.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047879498  8.5335862e-41  0             -0.0014363849   312336.21      0              1.5081598e+10  1.1971759e-13  0              4.2061899    
    200000   18000          200            200            0.00057864272  8.9754894e-35  0              0.0017359282   128747.63      0              6.2167623e+09  1.1971759e-13  0              3.9201537    
    300000   18000          200            200            0.00015285106 -1.7950904e-35  0              0.00045855319  12575.631      0              6.0723219e+08  1.1971759e-13  0              3.8565109    
    400000   18000          200            200            1.6333735e-05 -7.180381e-35   0              4.9001206e-05  168.40175      0              8131518        1.1971759e-13  0              3.8329452    
    500000   18000          200            200            0.006050577    7.1803916e-35  0              0.018151731    3025.7677      0              1.461035e+08   1.1971759e-13  0              3.8236545    
    600000   18000          200            200            0.0016446706  -3.5901922e-35  0              0.0049340119   275.4064       0              13298390       1.1971759e-13  0              3.8244349    
    700000   18000          200            200            0.0033864707  -8.0779348e-35  0              0.010159412    62.629303      0              3024144.9      1.1971759e-13  0              3.8240912    
    800000   18000          200            200            0.0032282325   4.4877429e-35  0              0.0096846975   3.4169979      0              164994.6       1.1971759e-13  0              3.824121     
    900000   18000          200            200            0.0033983782  -8.9754757e-36  0              0.010195135    0.05797095     0              2799.2097      1.1971759e-13  0              3.8240909    
   1000000   18000          200            200            0.0035224733  -2.6926446e-35  0              0.01056742     0.12441799     0              6007.6996      1.1971759e-13  0              3.8240689    
   1100000   18000          200            200            0.0035532451  -4.4877389e-36  0              0.010659735    0.013473939    0              650.60831      1.1971759e-13  0              3.8240635    
   1200000   18000          200            200            0.0035496674   8.751097e-35   0              0.010649002    4.2787912e-06  0              0.20660751     1.1971759e-13  0              3.8240641    
   1300000   18000          200            200            0.0035441301  -5.6096775e-36  0              0.01063239     0.00020705116  0              9.9977594      1.1971759e-13  0              3.824065     
   1400000   18000          200            200            0.0035422899  -1.4024194e-36  0              0.01062687     3.9428652e-05  0              1.9038685      1.1971759e-13  0              3.8240654    
   1500000   18000          200            200            0.0035422491  -5.6096775e-37  0              0.010626747    5.3365739e-07  0              0.025768406    1.1971759e-13  0              3.8240654    
   1600000   18000          200            200            0.003542474    2.8048389e-37  0              0.010627422    2.707239e-07   0              0.013072288    1.1971759e-13  0              3.8240653    
   1700000   18000          200            200            0.0035425732   2.243871e-36   0              0.01062772     9.8128348e-08  0              0.0047382667   1.1971759e-13  0              3.8240653    
   1800000   18000          200            200            0.0035425851   1.1219355e-36  0              0.010627755    3.8938449e-09  0              0.00018801984  1.1971759e-13  0              3.8240653    
   1900000   18000          200            200            0.003542577    1.0356101e-44  0              0.010627731    2.2860094e-10  0              1.1038321e-05  1.1971759e-13  0              3.8240653    
   2000000   18000          200            200            0.0035425721  -8.4145162e-37  0              0.010627716    2.1068926e-10  0              1.017343e-05   1.1971759e-13  0              3.8240653    
   2100000   18000          200            200            0.0035425711  -5.6096774e-37  0              0.010627713    1.6584018e-11  0              8.0078289e-07  1.1971759e-13  0              3.8240653    
   2200000   18000          200            200            0.0035425713   1.0228606e-44  0              0.010627714    4.261204e-14   0              2.0575829e-09  1.1971759e-13  0              3.8240653    
   2300000   18000          200            200            0.0035425716   1.0342148e-44  0              0.010627715    3.8607478e-13  0              1.8642169e-08  1.1971759e-13  0              3.8240653    
   2400000   18000          200            200            0.0035425716  -2.8048387e-37  0              0.010627715    5.4504152e-14  0              2.6318105e-09  1.1971759e-13  0              3.8240653    
   2500000   18000          200            200            0.0035425716   1.1219355e-36  0              0.010627715    2.440469e-16   0              1.1784152e-11  1.1971759e-13  0              3.8240653    
   2600000   18000          200            200            0.0035425716  -5.6096774e-37  0              0.010627715    5.3554543e-16  0              2.5859572e-11  1.1971759e-13  0              3.8240653    
   2700000   18000          200            200            0.0035425716  -2.8048387e-37  0              0.010627715    6.050355e-18   0              2.9214999e-13  1.1971759e-13  0              3.8240653    
   2800000   18000          200            200            0.0035425716   2.5243549e-36  0              0.010627715    3.1029551e-18  0              1.498306e-13   1.1971759e-13  0              3.8240653    
   2900000   18000          200            200            0.0035425716   3.6462904e-36  0              0.010627715    6.5870362e-18  0              3.180644e-13   1.1971759e-13  0              3.8240653    
   3000000   18000          200            200            0.0035425716  -2.243871e-36   0              0.010627715    5.9405311e-18  0              2.8684699e-13  1.1971759e-13  0              3.8240653    
Loop time of 760.59 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3407881.252 ns/day, 0.000 hours/ns, 3944.307 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.55     | 241.74     | 241.92     |   1.2 | 31.78
Neigh   | 5.0858     | 5.0866     | 5.0874     |   0.0 |  0.67
Comm    | 23.288     | 23.789     | 24.29      |  10.3 |  3.13
Output  | 0.61485    | 0.61486    | 0.61487    |   0.0 |  0.08
Modify  | 430.05     | 430.22     | 430.39     |   0.8 | 56.56
Other   |            | 59.14      |            |       |  7.78

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.66                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 116.567921629813
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.76
  ghost atom cutoff = 4.76
  binsize = 2.38, bins = 7564 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130 | 130 | 130 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047783274  1.7951059e-35  0             -0.0014334982   304849.81      0              1.4720106e+10  1.1971759e-13  0              4.213756     
    200000   18000          200            200            0.00059189794  6.4096954e-41  0              0.0017756938   133573.35      0              6.4497789e+09  1.1971759e-13  0              3.9222863    
    300000   18000          200            200            0.00016566105  6.568713e-41   0              0.00049698316  14572.792      0              7.0366798e+08  1.1971759e-13  0              3.8604584    
    400000   18000          200            200            2.8631772e-05 -1.7950909e-35  0              8.5895316e-05  507.14526      0              24488229       1.1971759e-13  0              3.8377738    
    500000   18000          200            200            0.0026150136   1.4360779e-34  0              0.0078450409   3253.28        0              1.5708925e+08  1.1971759e-13  0              3.829224     
    600000   18000          200            200            0.0010674618   1.3731862e-41  0              0.0032023855   99.451168      0              4802141        1.1971759e-13  0              3.8295771    
    700000   18000          200            200            0.0029318438  -8.9754747e-36  0              0.0087955314   44.273169      0              2137792.9      1.1971759e-13  0              3.8291755    
    800000   18000          200            200            0.0031503786   3.5901945e-35  0              0.0094511357   0.36875824     0              17806.016      1.1971759e-13  0              3.8291365    
    900000   18000          200            200            0.0034387835   3.5901945e-35  0              0.010316351    0.50761724     0              24511.02       1.1971759e-13  0              3.8290849    
   1000000   18000          200            200            0.0035562495   5.3852911e-35  0              0.010668748    0.14060919     0              6789.5146      1.1971759e-13  0              3.8290641    
   1100000   18000          200            200            0.0035651471   1.3463229e-35  0              0.010695441    0.0031132849   0              150.32939      1.1971759e-13  0              3.8290624    
   1200000   18000          200            200            0.0035531529   2.2438717e-36  0              0.010659459    0.00073225508  0              35.357977      1.1971759e-13  0              3.8290645    
   1300000   18000          200            200            0.0035472162  -1.1219355e-36  0              0.010641649    0.00032794704  0              15.835389      1.1971759e-13  0              3.8290656    
   1400000   18000          200            200            0.003546427   -2.8048387e-37  0              0.010639281    1.3387207e-05  0              0.6464203      1.1971759e-13  0              3.8290657    
   1500000   18000          200            200            0.0035468927   1.1219355e-36  0              0.010640678    8.5085628e-07  0              0.041084805    1.1971759e-13  0              3.8290656    
   1600000   18000          200            200            0.0035471819  -1.4024194e-36  0              0.010641546    7.1980081e-07  0              0.034756605    1.1971759e-13  0              3.8290656    
   1700000   18000          200            200            0.003547236   -5.6096774e-37  0              0.010641708    4.6991109e-08  0              0.0022690325   1.1971759e-13  0              3.8290656    
   1800000   18000          200            200            0.0035472195  -8.4145162e-37  0              0.010641658    6.3229524e-10  0              3.0531274e-05  1.1971759e-13  0              3.8290656    
   1900000   18000          200            200            0.0035472058   8.4145164e-37  0              0.010641617    1.4830164e-09  0              7.1609553e-05  1.1971759e-13  0              3.8290656    
   2000000   18000          200            200            0.0035472025  -1.6829033e-36  0              0.010641608    1.4491529e-10  0              6.9974409e-06  1.1971759e-13  0              3.8290656    
   2100000   18000          200            200            0.003547203   -1.9633871e-36  0              0.010641609    7.0438523e-14  0              3.4012242e-09  1.1971759e-13  0              3.8290656    
   2200000   18000          200            200            0.0035472037  -2.8048387e-37  0              0.010641611    2.8468255e-12  0              1.3746302e-07  1.1971759e-13  0              3.8290656    
   2300000   18000          200            200            0.0035472038   1.0391168e-44  0              0.010641612    4.0776933e-13  0              1.9689722e-08  1.1971759e-13  0              3.8290656    
   2400000   18000          200            200            0.0035472038   1.0525932e-44  0              0.010641612    9.7359289e-16  0              4.7011316e-11  1.1971759e-13  0              3.8290656    
   2500000   18000          200            200            0.0035472038   1.6829033e-36  0              0.010641611    5.0803584e-15  0              2.4531232e-10  1.1971759e-13  0              3.8290656    
   2600000   18000          200            200            0.0035472038   1.4024194e-36  0              0.010641611    1.0971116e-15  0              5.2975592e-11  1.1971759e-13  0              3.8290656    
   2700000   18000          200            200            0.0035472038  -5.6096774e-37  0              0.010641611    7.9415107e-17  0              3.8346713e-12  1.1971759e-13  0              3.8290656    
   2800000   18000          200            200            0.0035472038   8.4145164e-37  0              0.010641611    1.9595268e-18  0              9.4618535e-14  1.1971759e-13  0              3.8290656    
   2900000   18000          200            200            0.0035472038   5.6096776e-37  0              0.010641611    1.9231471e-18  0              9.2861889e-14  1.1971759e-13  0              3.8290656    
   3000000   18000          200            200            0.0035472038   8.4145164e-37  0              0.010641611    9.8598951e-18  0              4.7609905e-13  1.1971759e-13  0              3.8290656    
Loop time of 760.44 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3408554.342 ns/day, 0.000 hours/ns, 3945.086 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 244.32     | 245.66     | 247        |   8.6 | 32.30
Neigh   | 5.1379     | 5.138      | 5.1381     |   0.0 |  0.68
Comm    | 22.663     | 24.162     | 25.662     |  30.5 |  3.18
Output  | 0.64532    | 0.64534    | 0.64537    |   0.0 |  0.08
Modify  | 427.6      | 427.7      | 427.81     |   0.5 | 56.24
Other   |            | 57.13      |            |       |  7.51

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 131
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.67                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 117.319970425835
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77
  ghost atom cutoff = 4.77
  binsize = 2.385, bins = 7548 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 127.1 | 127.1 | 127.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047674831  3.5901975e-35  0             -0.0014302449   297458.31      0              1.4363197e+10  1.1971759e-13  0              4.2212874    
    200000   18000          200            200            0.0006052253   1.7951005e-35  0              0.0018156759   138483.12      0              6.6868541e+09  1.1971759e-13  0              3.9243629    
    300000   18000          200            200            0.00017860979  7.1803934e-35  0              0.00053582937  16714.272      0              8.0707236e+08  1.1971759e-13  0              3.8643271    
    400000   18000          200            200            4.1109793e-05  2.1541168e-34  0              0.00012332938  1027.1549      0              49597636       1.1971759e-13  0              3.8425104    
    500000   18000          200            200            0.00036934241 -3.5901892e-35  0              0.0011080272   2585.6562      0              1.2485209e+08  1.1971759e-13  0              3.834771     
    600000   18000          200            200            0.00083947427 -8.9754699e-36  0              0.0025184228   4.5894744      0              221609.29      1.1971759e-13  0              3.8346421    
    700000   18000          200            200            0.0026118788   2.6926462e-35  0              0.0078356363   16.983477      0              820071.34      1.1971759e-13  0              3.8342379    
    800000   18000          200            200            0.0031614726   3.5901946e-35  0              0.0094844177   0.58804618     0              28394.646      1.1971759e-13  0              3.8341358    
    900000   18000          200            200            0.0035076484   8.9754927e-36  0              0.010522945    0.99557256     0              48072.636      1.1971759e-13  0              3.8340738    
   1000000   18000          200            200            0.0035874259  -1.7950962e-35  0              0.010762278    0.082129591    0              3965.744       1.1971759e-13  0              3.8340597    
   1100000   18000          200            200            0.0035711335   8.9754871e-36  0              0.010713401    0.00051385116  0              24.812034      1.1971759e-13  0              3.8340624    
   1200000   18000          200            200            0.0035544667  -1.1219354e-35  0              0.0106634      0.002136867    0              103.18166      1.1971759e-13  0              3.8340654    
   1300000   18000          200            200            0.0035502984   1.4024194e-36  0              0.010650895    0.00021138745  0              10.207143      1.1971759e-13  0              3.8340661    
   1400000   18000          200            200            0.0035509074   8.4145164e-37  0              0.010652722    3.1929689e-07  0              0.015417704    1.1971759e-13  0              3.834066     
   1500000   18000          200            200            0.0035516862   1.4024194e-36  0              0.010655059    4.5162636e-06  0              0.21807421     1.1971759e-13  0              3.8340659    
   1600000   18000          200            200            0.0035519013   2.243871e-36   0              0.010655704    5.3448565e-07  0              0.025808399    1.1971759e-13  0              3.8340658    
   1700000   18000          200            200            0.0035518804  -1.4024194e-36  0              0.010655641    5.1244269e-12  0              2.4744023e-07  1.1971759e-13  0              3.8340658    
   1800000   18000          200            200            0.0035518442  -8.4145162e-37  0              0.010655533    9.3986509e-09  0              0.00045382721  1.1971759e-13  0              3.8340658    
   1900000   18000          200            200            0.0035518333   3.6462904e-36  0              0.0106555      1.3279327e-09  0              6.4121116e-05  1.1971759e-13  0              3.8340658    
   2000000   18000          200            200            0.0035518339   5.6096777e-37  0              0.010655502    1.1367349e-12  0              5.4888859e-08  1.1971759e-13  0              3.8340658    
   2100000   18000          200            200            0.0035518355  -1.9633871e-36  0              0.010655507    1.9227377e-11  0              9.2842121e-07  1.1971759e-13  0              3.8340658    
   2200000   18000          200            200            0.0035518361   5.6096777e-37  0              0.010655508    3.2435727e-12  0              1.5662052e-07  1.1971759e-13  0              3.8340658    
   2300000   18000          200            200            0.0035518361   5.6096777e-37  0              0.010655508    1.1082294e-14  0              5.3512432e-10  1.1971759e-13  0              3.8340658    
   2400000   18000          200            200            0.003551836    5.6096777e-37  0              0.010655508    3.9254794e-14  0              1.8954735e-09  1.1971759e-13  0              3.8340658    
   2500000   18000          200            200            0.003551836   -2.8048387e-37  0              0.010655508    7.7794965e-15  0              3.7564404e-10  1.1971759e-13  0              3.8340658    
   2600000   18000          200            200            0.003551836    1.045338e-44   0              0.010655508    1.1099937e-16  0              5.3597621e-12  1.1971759e-13  0              3.8340658    
   2700000   18000          200            200            0.003551836   -5.6096774e-37  0              0.010655508    1.3153733e-16  0              6.3514671e-12  1.1971759e-13  0              3.8340658    
   2800000   18000          200            200            0.003551836   -5.6096774e-37  0              0.010655508    2.1508801e-17  0              1.038583e-12   1.1971759e-13  0              3.8340658    
   2900000   18000          200            200            0.003551836   -1.6829033e-36  0              0.010655508    3.6926436e-20  0              1.7830454e-15  1.1971759e-13  0              3.8340658    
   3000000   18000          200            200            0.003551836    8.1994787e-45  0              0.010655508    6.4064777e-18  0              3.0934588e-13  1.1971759e-13  0              3.8340658    
Loop time of 763.137 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3396506.439 ns/day, 0.000 hours/ns, 3931.142 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.6      | 243.71     | 244.82     |   7.1 | 31.94
Neigh   | 5.1821     | 5.1822     | 5.1823     |   0.0 |  0.68
Comm    | 23.326     | 24.612     | 25.898     |  25.9 |  3.23
Output  | 0.61271    | 0.61274    | 0.61277    |   0.0 |  0.08
Modify  | 429.75     | 429.77     | 429.8      |   0.1 | 56.32
Other   |            | 59.25      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.68                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 118.07524689415
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.78
  ghost atom cutoff = 4.78
  binsize = 2.39, bins = 7532 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.9 | 126.9 | 126.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047554206 -1.7950868e-35  0             -0.0014266262   290161.52      0              1.4010861e+10  1.1971759e-13  0              4.2287841    
    200000   18000          200            200            0.00061862491 -5.3852861e-35  0              0.0018558747   143476.97      0              6.9279894e+09  1.1971759e-13  0              3.9263831    
    300000   18000          200            200            0.00019169819  1.7951043e-35  0              0.00057509457  18999.903      0              9.174373e+08   1.1971759e-13  0              3.8681166    
    400000   18000          200            200            5.3768298e-05 -5.3852845e-35  0              0.00016130489  1727.7902      0              83428804       1.1971759e-13  0              3.8471547    
    500000   18000          200            200           -4.9768947e-05 -3.5901893e-35  0             -0.00014930684  1668.4628      0              80564097       1.1971759e-13  0              3.8402331    
    600000   18000          200            200            0.000922845    8.9755014e-36  0              0.002768535    35.041102      0              1692009.4      1.1971759e-13  0              3.8396222    
    700000   18000          200            200            0.0024729667   1.0162585e-41  0              0.0074189001   0.68727583     0              33186.09       1.1971759e-13  0              3.8392668    
    800000   18000          200            200            0.0032604961  -8.9754747e-36  0              0.0097814883   3.864733       0              186614.13      1.1971759e-13  0              3.8391191    
    900000   18000          200            200            0.0035885827  -3.5901928e-35  0              0.010765748    1.042532       0              50340.139      1.1971759e-13  0              3.8390607    
   1000000   18000          200            200            0.0036080948   8.9754905e-36  0              0.010824284    0.01290111     0              622.94843      1.1971759e-13  0              3.8390571    
   1100000   18000          200            200            0.0035707489   3.0377044e-42  0              0.010712247    0.0087283813   0              421.4623       1.1971759e-13  0              3.8390636    
   1200000   18000          200            200            0.0035548216   4.4877427e-36  0              0.010664465    0.0023488597   0              113.41803      1.1971759e-13  0              3.8390664    
   1300000   18000          200            200            0.0035540005   3.0523742e-44  0              0.010662001    2.6380425e-05  0              1.2738163      1.1971759e-13  0              3.8390665    
   1400000   18000          200            200            0.0035557979   5.6096776e-37  0              0.010667394    2.0475846e-05  0              0.98870532     1.1971759e-13  0              3.8390662    
   1500000   18000          200            200            0.0035565518  -2.8048387e-37  0              0.010669655    5.2924704e-06  0              0.25555445     1.1971759e-13  0              3.8390661    
   1600000   18000          200            200            0.0035565863  -1.1219355e-36  0              0.010669759    5.3641155e-08  0              0.0025901394   1.1971759e-13  0              3.8390661    
   1700000   18000          200            200            0.0035564996   1.1219355e-35  0              0.010669499    4.8036124e-08  0              0.0023194925   1.1971759e-13  0              3.8390661    
   1800000   18000          200            200            0.0035564639  -1.1219355e-36  0              0.010669392    1.1917124e-08  0              0.00057543526  1.1971759e-13  0              3.8390661    
   1900000   18000          200            200            0.0035564625  -3.0853226e-36  0              0.010669388    1.0829423e-10  0              5.2291406e-06  1.1971759e-13  0              3.8390661    
   2000000   18000          200            200            0.0035564667   1.1219355e-36  0              0.0106694      1.1258378e-10  0              5.4362678e-06  1.1971759e-13  0              3.8390661    
   2100000   18000          200            200            0.0035564684   1.6829033e-36  0              0.010669405    2.6835276e-11  0              1.2957794e-06  1.1971759e-13  0              3.8390661    
   2200000   18000          200            200            0.0035564684   7.5730647e-36  0              0.010669405    2.1716696e-13  0              1.0486215e-08  1.1971759e-13  0              3.8390661    
   2300000   18000          200            200            0.0035564682   8.4145164e-37  0              0.010669405    2.6343936e-13  0              1.2720544e-08  1.1971759e-13  0              3.8390661    
   2400000   18000          200            200            0.0035564682   1.1219355e-36  0              0.010669404    6.0731446e-14  0              2.9325042e-09  1.1971759e-13  0              3.8390661    
   2500000   18000          200            200            0.0035564682  -7.5730647e-36  0              0.010669404    4.7735826e-16  0              2.3049922e-11  1.1971759e-13  0              3.8390661    
   2600000   18000          200            200            0.0035564682   1.009742e-35   0              0.010669404    5.3870563e-16  0              2.6012167e-11  1.1971759e-13  0              3.8390661    
   2700000   18000          200            200            0.0035564682   5.6096777e-37  0              0.010669405    2.6645047e-18  0              1.2865939e-13  1.1971759e-13  0              3.8390661    
   2800000   18000          200            200            0.0035564682   1.0445216e-44  0              0.010669405    6.8471183e-19  0              3.3062284e-14  1.1971759e-13  0              3.8390661    
   2900000   18000          200            200            0.0035564682  -1.4024194e-36  0              0.010669405    2.9179528e-20  0              1.408975e-15   1.1971759e-13  0              3.8390661    
   3000000   18000          200            200            0.0035564682   8.4145164e-37  0              0.010669405    5.5049375e-18  0              2.6581373e-13  1.1971759e-13  0              3.8390661    
Loop time of 766.58 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3381250.925 ns/day, 0.000 hours/ns, 3913.485 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.81     | 242.84     | 244.87     |  13.0 | 31.68
Neigh   | 5.1948     | 5.1957     | 5.1965     |   0.0 |  0.68
Comm    | 23.048     | 25.231     | 27.414     |  43.5 |  3.29
Output  | 0.61235    | 0.61236    | 0.61237    |   0.0 |  0.08
Modify  | 430.39     | 430.48     | 430.57     |   0.4 | 56.16
Other   |            | 62.22      |            |       |  8.12

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.69                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 118.833757946262
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.79
  ghost atom cutoff = 4.79
  binsize = 2.395, bins = 7516 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.7 | 126.7 | 126.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047421437  3.5902004e-35  0             -0.0014226431   282959.24      0              1.3663089e+10  1.1971759e-13  0              4.236246     
    200000   18000          200            200            0.00063209559  4.7792423e-41  0              0.0018962868   148554.45      0              7.1731628e+09  1.1971759e-13  0              3.9283469    
    300000   18000          200            200            0.000204923    5.3852968e-35  0              0.00061476899  21428.801      0              1.0347201e+09  1.1971759e-13  0              3.8718269    
    400000   18000          200            200            6.6603554e-05  1.7951027e-35  0              0.00019981066  2608.2044      0              1.2594086e+08  1.1971759e-13  0              3.8517063    
    500000   18000          200            200           -3.7689774e-05 -4.1287222e-34  0             -0.00011306932  938.60557      0              45321904       1.1971759e-13  0              3.8455935    
    600000   18000          200            200            0.0013326586   3.5901953e-35  0              0.0039979757   176.20645      0              8508379        1.1971759e-13  0              3.8445193    
    700000   18000          200            200            0.0025325761   1.7950979e-35  0              0.0075977284   6.8007456      0              328383.67      1.1971759e-13  0              3.8442568    
    800000   18000          200            200            0.0034284428   1.7950978e-35  0              0.010285328    7.3771725      0              356217.26      1.1971759e-13  0              3.8440903    
    900000   18000          200            200            0.003661515   -1.3463218e-35  0              0.010984545    0.59985313     0              28964.761      1.1971759e-13  0              3.844049     
   1000000   18000          200            200            0.0036134183   1.7950974e-35  0              0.010840255    0.0085833214   0              414.45787      1.1971759e-13  0              3.8440572    
   1100000   18000          200            200            0.0035656518   3.0424493e-42  0              0.010696956    0.017726573    0              855.95276      1.1971759e-13  0              3.8440655    
   1200000   18000          200            200            0.0035557815   6.7316137e-36  0              0.010667345    0.001089405    0              52.603471      1.1971759e-13  0              3.8440673    
   1300000   18000          200            200            0.0035586969   1.2902258e-35  0              0.010676091    3.9688071e-05  0              1.9163949      1.1971759e-13  0              3.8440668    
   1400000   18000          200            200            0.0035609842  -3.9267743e-36  0              0.010682953    4.1931617e-05  0              2.0247277      1.1971759e-13  0              3.8440664    
   1500000   18000          200            200            0.0035613769   2.8048389e-37  0              0.010684131    1.8716343e-06  0              0.090374521    1.1971759e-13  0              3.8440663    
   1600000   18000          200            200            0.0035612094  -8.4145162e-37  0              0.010683628    1.4985292e-07  0              0.0072358612   1.1971759e-13  0              3.8440663    
   1700000   18000          200            200            0.003561101    1.0222679e-44  0              0.010683303    9.6777371e-08  0              0.0046730329   1.1971759e-13  0              3.8440663    
   1800000   18000          200            200            0.0035610862   2.243871e-36   0              0.010683259    2.9840888e-09  0              0.00014409097  1.1971759e-13  0              3.8440664    
   1900000   18000          200            200            0.0035610955   4.2072582e-36  0              0.010683286    4.9997789e-10  0              2.4142143e-05  1.1971759e-13  0              3.8440663    
   2000000   18000          200            200            0.0035611006   1.029705e-44   0              0.010683302    2.1791739e-10  0              1.0522451e-05  1.1971759e-13  0              3.8440663    
   2100000   18000          200            200            0.0035611011   8.4145164e-37  0              0.010683303    4.2757125e-12  0              2.0645885e-07  1.1971759e-13  0              3.8440663    
   2200000   18000          200            200            0.0035611006  -2.243871e-36   0              0.010683302    1.5364737e-12  0              7.4190818e-08  1.1971759e-13  0              3.8440663    
   2300000   18000          200            200            0.0035611003   2.8048389e-37  0              0.010683301    4.7797289e-13  0              2.30796e-08    1.1971759e-13  0              3.8440663    
   2400000   18000          200            200            0.0035611003  -1.1219355e-36  0              0.010683301    5.166592e-15   0              2.4947624e-10  1.1971759e-13  0              3.8440663    
   2500000   18000          200            200            0.0035611003   8.4145164e-37  0              0.010683301    4.3520273e-15  0              2.1014382e-10  1.1971759e-13  0              3.8440663    
   2600000   18000          200            200            0.0035611004   1.038598e-44   0              0.010683301    1.0631262e-15  0              5.1334557e-11  1.1971759e-13  0              3.8440663    
   2700000   18000          200            200            0.0035611004   8.4145164e-37  0              0.010683301    9.8729666e-17  0              4.7673022e-12  1.1971759e-13  0              3.8440663    
   2800000   18000          200            200            0.0035611004   1.0424577e-44  0              0.010683301    7.6092306e-18  0              3.6742251e-13  1.1971759e-13  0              3.8440663    
   2900000   18000          200            200            0.0035611004   8.4145164e-37  0              0.010683301    1.0603945e-18  0              5.1202654e-14  1.1971759e-13  0              3.8440663    
   3000000   18000          200            200            0.0035611004   1.009742e-35   0              0.010683301    1.5765539e-19  0              7.6126145e-15  1.1971759e-13  0              3.8440663    
Loop time of 767.354 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3377842.252 ns/day, 0.000 hours/ns, 3909.540 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.78     | 245.53     | 250.29     |  30.3 | 32.00
Neigh   | 5.1605     | 5.1607     | 5.1609     |   0.0 |  0.67
Comm    | 22.266     | 27.17      | 32.075     |  94.1 |  3.54
Output  | 0.61489    | 0.61492    | 0.61495    |   0.0 |  0.08
Modify  | 430.11     | 430.27     | 430.42     |   0.7 | 56.07
Other   |            | 58.61      |            |       |  7.64

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.7                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 119.595510493673
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.8
  ghost atom cutoff = 4.8
  binsize = 2.4, bins = 7500 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.4 | 126.4 | 126.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.0004727656  -3.5901824e-35  0             -0.0014182968   275851.31      0              1.3319872e+10  1.1971759e-13  0              4.2436731    
    200000   18000          200            200            0.00064563695 -5.3852852e-35  0              0.0019369109   153715.4       0              7.4223666e+09  1.1971759e-13  0              3.9302541    
    300000   18000          200            200            0.00021828369  1.7951029e-35  0              0.00065485106  24000.554      0              1.1589009e+09  1.1971759e-13  0              3.8754577    
    400000   18000          200            200            7.9614069e-05  3.590199e-35   0              0.00023884221  3667.6384      0              1.7709713e+08  1.1971759e-13  0              3.8561652    
    500000   18000          200            200           -2.5401284e-05  1.7951015e-35  0             -7.6203851e-05  417.91858      0              20179792       1.1971759e-13  0              3.8508515    
    600000   18000          200            200            0.00211434    -8.9754676e-36  0              0.0063430201   356.26542      0              17202782       1.1971759e-13  0              3.8493463    
    700000   18000          200            200            0.0027851048   1.0970198e-41  0              0.0083553144   30.872619      0              1490728.3      1.1971759e-13  0              3.8492097    
    800000   18000          200            200            0.0036302135   8.9754935e-36  0              0.010890641    8.050923       0              388750.26      1.1971759e-13  0              3.849056     
    900000   18000          200            200            0.0037079633   1.3463234e-35  0              0.01112389     0.10394444     0              5019.1052      1.1971759e-13  0              3.849042     
   1000000   18000          200            200            0.0036031635  -6.2828382e-35  0              0.010809491    0.073292525    0              3539.0338      1.1971759e-13  0              3.84906      
   1100000   18000          200            200            0.0035590626  -2.2438707e-35  0              0.010677188    0.016587952    0              800.97283      1.1971759e-13  0              3.8490677    
   1200000   18000          200            200            0.0035586886   1.7950969e-35  0              0.010676066    3.0752717e-05  0              1.4849386      1.1971759e-13  0              3.8490678    
   1300000   18000          200            200            0.0035643615   1.9633872e-36  0              0.010693085    0.00022988831  0              11.100484      1.1971759e-13  0              3.8490669    
   1400000   18000          200            200            0.0035662214  -8.4145163e-37  0              0.010698664    3.0950211e-05  0              1.4944749      1.1971759e-13  0              3.8490665    
   1500000   18000          200            200            0.0035660686   9.5405251e-45  0              0.010698206    4.8041748e-08  0              0.0023197641   1.1971759e-13  0              3.8490665    
   1600000   18000          200            200            0.0035657754   5.6096777e-37  0              0.010697326    6.4168262e-07  0              0.030984557    1.1971759e-13  0              3.8490666    
   1700000   18000          200            200            0.003565702   -3.0853226e-36  0              0.010697106    5.1338625e-08  0              0.0024789585   1.1971759e-13  0              3.8490666    
   1800000   18000          200            200            0.0035657172  -2.8048387e-37  0              0.010697152    1.0918329e-09  0              5.2720703e-05  1.1971759e-13  0              3.8490666    
   1900000   18000          200            200            0.0035657316  -1.1219355e-36  0              0.010697195    1.6252627e-09  0              7.8478118e-05  1.1971759e-13  0              3.8490666    
   2000000   18000          200            200            0.0035657343   2.5243549e-36  0              0.010697203    7.244777e-11   0              3.4982435e-06  1.1971759e-13  0              3.8490666    
   2100000   18000          200            200            0.0035657332   1.4024194e-36  0              0.0106972      6.6740544e-12  0              3.222662e-07   1.1971759e-13  0              3.8490666    
   2200000   18000          200            200            0.0035657325   1.0349522e-44  0              0.010697198    3.7745221e-12  0              1.8225816e-07  1.1971759e-13  0              3.8490666    
   2300000   18000          200            200            0.0035657324   5.6096777e-37  0              0.010697197    7.764577e-14   0              3.7492364e-09  1.1971759e-13  0              3.8490666    
   2400000   18000          200            200            0.0035657325   1.0482111e-44  0              0.010697198    2.720357e-14   0              1.313563e-09   1.1971759e-13  0              3.8490666    
   2500000   18000          200            200            0.0035657325   1.1219355e-36  0              0.010697198    8.0782771e-15  0              3.9007109e-10  1.1971759e-13  0              3.8490666    
   2600000   18000          200            200            0.0035657325  -2.8048387e-37  0              0.010697198    8.906307e-17   0              4.3005369e-12  1.1971759e-13  0              3.8490666    
   2700000   18000          200            200            0.0035657325  -9.2559679e-36  0              0.010697198    1.1468674e-16  0              5.537812e-12   1.1971759e-13  0              3.8490666    
   2800000   18000          200            200            0.0035657325   1.1219355e-36  0              0.010697198    2.0552335e-17  0              9.9239871e-13  1.1971759e-13  0              3.8490666    
   2900000   18000          200            200            0.0035657325   8.4145164e-37  0              0.010697198    7.1493668e-18  0              3.4521733e-13  1.1971759e-13  0              3.8490666    
   3000000   18000          200            200            0.0035657325   3.0853227e-36  0              0.010697198    2.4491533e-18  0              1.1826085e-13  1.1971759e-13  0              3.8490666    
Loop time of 768.468 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3372943.016 ns/day, 0.000 hours/ns, 3903.869 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.1      | 243.77     | 244.45     |   4.3 | 31.72
Neigh   | 5.238      | 5.2385     | 5.2389     |   0.0 |  0.68
Comm    | 24.364     | 24.823     | 25.281     |   9.2 |  3.23
Output  | 0.61356    | 0.61359    | 0.61362    |   0.0 |  0.08
Modify  | 429.95     | 429.96     | 429.96     |   0.0 | 55.95
Other   |            | 64.06      |            |       |  8.34

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.71                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 120.360511447888
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.81
  ghost atom cutoff = 4.81
  binsize = 2.405, bins = 7485 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.2 | 126.2 | 126.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00047119616 -3.5901899e-35  0             -0.0014135885   268837.63      0              1.2981207e+10  1.1971759e-13  0              4.2510652    
    200000   18000          200            200            0.00065924768  3.5901989e-35  0              0.0019777431   158959.3       0              7.6755756e+09  1.1971759e-13  0              3.9321048    
    300000   18000          200            200            0.00023177817 -3.5901868e-35  0              0.00069533451  26714.446      0              1.289945e+09   1.1971759e-13  0              3.8790089    
    400000   18000          200            200            9.2798155e-05  1.795102e-35   0              0.00027839447  4905.3215      0              2.3686042e+08  1.1971759e-13  0              3.8605311    
    500000   18000          200            200           -1.2904773e-05  4.3808747e-41  0             -3.8714318e-05  105.378        0              5088326.4      1.1971759e-13  0              3.856007     
    600000   18000          200            200            0.0032556395   1.1668131e-34  0              0.0097669186   466.5353       0              22527320       1.1971759e-13  0              3.8541276    
    700000   18000          200            200            0.00319906     1.7053421e-34  0              0.00959718     55.358911      0              2673083.7      1.1971759e-13  0              3.8541345    
    800000   18000          200            200            0.0038201861  -8.9754831e-35  0              0.011460558    5.2450952      0              253266.87      1.1971759e-13  0              3.8540243    
    900000   18000          200            200            0.003716336    8.0748492e-42  0              0.011149008    0.046154959    0              2228.6578      1.1971759e-13  0              3.8540416    
   1000000   18000          200            200            0.0035817928  -2.6926446e-35  0              0.010745378    0.13523962     0              6530.2373      1.1971759e-13  0              3.8540648    
   1100000   18000          200            200            0.0035546898  -2.6926449e-35  0              0.010664069    0.0067151296   0              324.24958      1.1971759e-13  0              3.8540696    
   1200000   18000          200            200            0.0035641739   8.9754848e-36  0              0.010692522    0.00056892372  0              27.47129       1.1971759e-13  0              3.8540679    
   1300000   18000          200            200            0.0035705784   3.3929317e-44  0              0.010711735    0.0003201014   0              15.456551      1.1971759e-13  0              3.8540668    
   1400000   18000          200            200            0.0035712423   2.5243549e-36  0              0.010713727    4.8427989e-06  0              0.23384143     1.1971759e-13  0              3.8540667    
   1500000   18000          200            200            0.0035705983   5.6096776e-37  0              0.010711795    2.8734556e-06  0              0.13874889     1.1971759e-13  0              3.8540668    
   1600000   18000          200            200            0.0035703191  -5.6096774e-37  0              0.010710957    6.3166636e-07  0              0.030500908    1.1971759e-13  0              3.8540669    
   1700000   18000          200            200            0.0035703204  -7.0120969e-36  0              0.010710961    2.0313515e-10  0              9.8086692e-06  1.1971759e-13  0              3.8540669    
   1800000   18000          200            200            0.0035703575   5.6096777e-37  0              0.010711073    1.0041141e-08  0              0.00048485078  1.1971759e-13  0              3.8540669    
   1900000   18000          200            200            0.0035703684   8.4145164e-37  0              0.010711105    1.0086799e-09  0              4.8705543e-05  1.1971759e-13  0              3.8540669    
   2000000   18000          200            200            0.0035703668  -5.6096774e-37  0              0.0107111      1.3682871e-11  0              6.6069686e-07  1.1971759e-13  0              3.8540669    
   2100000   18000          200            200            0.0035703648   1.1219355e-36  0              0.010711095    2.7848048e-11  0              1.3446826e-06  1.1971759e-13  0              3.8540669    
   2200000   18000          200            200            0.0035703645   3.6462904e-36  0              0.010711093    1.184404e-12   0              5.7190629e-08  1.1971759e-13  0              3.8540669    
   2300000   18000          200            200            0.0035703646   8.4145164e-37  0              0.010711094    1.3601636e-13  0              6.5677431e-09  1.1971759e-13  0              3.8540669    
   2400000   18000          200            200            0.0035703647   1.032461e-44   0              0.010711094    6.4181932e-14  0              3.0991158e-09  1.1971759e-13  0              3.8540669    
   2500000   18000          200            200            0.0035703647  -2.8048387e-37  0              0.010711094    7.1216203e-16  0              3.4387756e-11  1.1971759e-13  0              3.8540669    
   2600000   18000          200            200            0.0035703647   8.4145164e-37  0              0.010711094    5.8479839e-16  0              2.8237822e-11  1.1971759e-13  0              3.8540669    
   2700000   18000          200            200            0.0035703647   5.6096777e-37  0              0.010711094    1.836869e-19   0              8.869583e-15   1.1971759e-13  0              3.8540669    
   2800000   18000          200            200            0.0035703647   1.0673721e-44  0              0.010711094    4.6152256e-19  0              2.2285273e-14  1.1971759e-13  0              3.8540669    
   2900000   18000          200            200            0.0035703647   4.487742e-36   0              0.010711094    1.246987e-17   0              6.0212539e-13  1.1971759e-13  0              3.8540669    
   3000000   18000          200            200            0.0035703647  -2.8048387e-37  0              0.010711094    1.5218317e-17  0              7.3483806e-13  1.1971759e-13  0              3.8540669    
Loop time of 761.45 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3404032.088 ns/day, 0.000 hours/ns, 3939.852 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.57     | 241.88     | 244.2      |  14.9 | 31.77
Neigh   | 5.4121     | 5.4121     | 5.4122     |   0.0 |  0.71
Comm    | 23.298     | 25.795     | 28.292     |  49.2 |  3.39
Output  | 0.63345    | 0.63348    | 0.63351    |   0.0 |  0.08
Modify  | 428.03     | 428.08     | 428.14     |   0.3 | 56.22
Other   |            | 59.64      |            |       |  7.83

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.72                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 121.12876772041
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.82
  ghost atom cutoff = 4.82
  binsize = 2.41, bins = 7469 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.4 | 123.4 | 123.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00046950639  1.2416504e-40  0             -0.0014085192   261917.99      0              1.2647082e+10  1.1971759e-13  0              4.2584224    
    200000   18000          200            200            0.00067292873 -1.7950962e-34  0              0.0020187862   164286.54      0              7.932809e+09   1.1971759e-13  0              3.9338983    
    300000   18000          200            200            0.00024540773  1.2565685e-34  0              0.00073622319  29570.469      0              1.4278521e+09  1.1971759e-13  0              3.8824799    
    400000   18000          200            200            0.0001061563  -1.7950911e-35  0              0.00031846889  6320.7274      0              3.052053e+08   1.1971759e-13  0              3.8648035    
    500000   18000          200            200           -2.0092263e-07  4.6664558e-41  0             -6.0276789e-07  0.010524072    0              508.16979      1.1971759e-13  0              3.8610597    
    600000   18000          200            200            0.0046106918  -1.7950952e-35  0              0.013832075    422.15432      0              20384321       1.1971759e-13  0              3.8588989    
    700000   18000          200            200            0.0037087005   1.7950979e-35  0              0.011126102    61.417907      0              2965650.9      1.1971759e-13  0              3.8590457    
    800000   18000          200            200            0.0039523996  -8.9754752e-36  0              0.011857199    1.4280131      0              68953.642      1.1971759e-13  0              3.8590028    
    900000   18000          200            200            0.0036854918  -4.487734e-36   0              0.011056475    0.48031501     0              23192.693      1.1971759e-13  0              3.8590478    
   1000000   18000          200            200            0.0035570853   6.2103851e-42  0              0.010671256    0.12611843     0              6089.8077      1.1971759e-13  0              3.8590702    
   1100000   18000          200            200            0.0035555065   8.9754871e-36  0              0.01066652     6.6801059e-05  0              3.2255841      1.1971759e-13  0              3.8590705    
   1200000   18000          200            200            0.0035719268   3.3658066e-35  0              0.01071578     0.0019741945   0              95.326789      1.1971759e-13  0              3.8590677    
   1300000   18000          200            200            0.0035767084   2.2438711e-36  0              0.010730125    0.00017970569  0              8.6773445      1.1971759e-13  0              3.8590668    
   1400000   18000          200            200            0.0035758752  -8.4145163e-37  0              0.010727626    4.4988828e-06  0              0.21723495     1.1971759e-13  0              3.859067     
   1500000   18000          200            200            0.0035750156  -5.6096775e-37  0              0.010725047    5.5235351e-06  0              0.26671174     1.1971759e-13  0              3.8590671    
   1600000   18000          200            200            0.0035748867   2.8048389e-37  0              0.01072466     1.393567e-07   0              0.0067290363   1.1971759e-13  0              3.8590671    
   1700000   18000          200            200            0.0035749639  -2.243871e-36   0              0.010724892    4.2152546e-08  0              0.0020353956   1.1971759e-13  0              3.8590671    
   1800000   18000          200            200            0.0035750022   1.9633872e-36  0              0.010725007    1.1241479e-08  0              0.0005428108   1.1971759e-13  0              3.8590671    
   1900000   18000          200            200            0.0035750027  -8.4145162e-37  0              0.010725008    5.9249061e-12  0              2.8609251e-07  1.1971759e-13  0              3.8590671    
   2000000   18000          200            200            0.0035749978   1.01484e-44    0              0.010724993    1.7580955e-10  0              8.4892139e-06  1.1971759e-13  0              3.8590671    
   2100000   18000          200            200            0.0035749964   8.4145164e-37  0              0.010724989    1.5987924e-11  0              7.7199965e-07  1.1971759e-13  0              3.8590671    
   2200000   18000          200            200            0.0035749966  -8.9754841e-36  0              0.01072499     3.9977078e-13  0              1.93035e-08    1.1971759e-13  0              3.8590671    
   2300000   18000          200            200            0.0035749969  -5.6096774e-37  0              0.010724991    4.9156023e-13  0              2.3735684e-08  1.1971759e-13  0              3.8590671    
   2400000   18000          200            200            0.0035749969   1.1219355e-36  0              0.010724991    1.1984893e-14  0              5.787076e-10   1.1971759e-13  0              3.8590671    
   2500000   18000          200            200            0.0035749969   8.4145164e-37  0              0.010724991    3.8147133e-15  0              1.8419885e-10  1.1971759e-13  0              3.8590671    
   2600000   18000          200            200            0.0035749969  -1.6829033e-36  0              0.010724991    1.0442989e-15  0              5.0425458e-11  1.1971759e-13  0              3.8590671    
   2700000   18000          200            200            0.0035749969   2.0194839e-35  0              0.010724991    1.1927672e-16  0              5.7594457e-12  1.1971759e-13  0              3.8590671    
   2800000   18000          200            200            0.0035749969   2.8048389e-37  0              0.010724991    9.8038601e-18  0              4.7339332e-13  1.1971759e-13  0              3.8590671    
   2900000   18000          200            200            0.0035749969   2.8048389e-37  0              0.010724991    1.4948175e-17  0              7.2179389e-13  1.1971759e-13  0              3.8590671    
   3000000   18000          200            200            0.0035749969   2.8048389e-37  0              0.010724991    5.5271134e-18  0              2.6688453e-13  1.1971759e-13  0              3.8590671    
Loop time of 760.867 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3406639.488 ns/day, 0.000 hours/ns, 3942.870 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.12     | 242.26     | 243.4      |   7.3 | 31.84
Neigh   | 4.7926     | 4.7935     | 4.7944     |   0.0 |  0.63
Comm    | 22.286     | 23.708     | 25.129     |  29.2 |  3.12
Output  | 0.61372    | 0.61373    | 0.61374    |   0.0 |  0.08
Modify  | 429.18     | 429.46     | 429.74     |   1.4 | 56.44
Other   |            | 60.03      |            |       |  7.89

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(74*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.73                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 121.900286222745
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.83
  ghost atom cutoff = 4.83
  binsize = 2.415, bins = 7454 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.2 | 123.2 | 123.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200           -0.00046769669 -2.1541149e-34  0             -0.0014030901   255092.26      0              1.2317492e+10  1.1971759e-13  0              4.2657444    
    200000   18000          200            200            0.00068667833 -3.5901864e-35  0              0.002060035    169696.42      0              8.1940327e+09  1.1971759e-13  0              3.9356348    
    300000   18000          200            200            0.00025916902  8.6507295e-41  0              0.00077750706  32567.65       0              1.5725752e+09  1.1971759e-13  0              3.8858708    
    400000   18000          200            200            0.0001196845  -7.1803819e-35  0              0.0003590535   7912.8713      0              3.8208424e+08  1.1971759e-13  0              3.8689824    
    500000   18000          200            200            1.2706281e-05 -3.5901893e-35  0              3.8118843e-05  100.87634      0              4870957.2      1.1971759e-13  0              3.8660094    
    600000   18000          200            200            0.0058911992   1.6571731e-41  0              0.017673598    239.38374      0              11558984       1.1971759e-13  0              3.8637029    
    700000   18000          200            200            0.0042131564  -8.0779345e-35  0              0.012639469    43.449215      0              2098007.1      1.1971759e-13  0              3.8639617    
    800000   18000          200            200            0.0039934393   8.9754932e-36  0              0.011980318    0.03532149     0              1705.5483      1.1971759e-13  0              3.8639968    
    900000   18000          200            200            0.0036251797  -1.795096e-35   0              0.010875539    0.96844613     0              46762.797      1.1971759e-13  0              3.8640593    
   1000000   18000          200            200            0.0035377736   1.3463232e-35  0              0.010613321    0.056177863    0              2712.628       1.1971759e-13  0              3.8640746    
   1100000   18000          200            200            0.0035627764  -8.975481e-36   0              0.010688329    0.0046339267   0              223.75574      1.1971759e-13  0              3.8640703    
   1200000   18000          200            200            0.0035808053   1.1219356e-35  0              0.010742416    0.0023693205   0              114.40601      1.1971759e-13  0              3.8640672    
   1300000   18000          200            200            0.003582147   -1.1219355e-36  0              0.010746441    1.2478214e-05  0              0.60252831     1.1971759e-13  0              3.8640669    
   1400000   18000          200            200            0.00358012    -5.6096775e-37  0              0.01074036     3.0154468e-05  0              1.4560513      1.1971759e-13  0              3.8640673    
   1500000   18000          200            200            0.0035794241  -1.1219355e-36  0              0.010738272    3.506002e-06   0              0.16929229     1.1971759e-13  0              3.8640674    
   1600000   18000          200            200            0.003579512    2.8048389e-37  0              0.010738536    5.832494e-08   0              0.0028163026   1.1971759e-13  0              3.8640674    
   1700000   18000          200            200            0.003579626    2.8048389e-37  0              0.010738878    9.4877907e-08  0              0.0045813146   1.1971759e-13  0              3.8640674    
   1800000   18000          200            200            0.0035796437  -5.6096774e-37  0              0.010738931    2.2327348e-09  0              0.00010781077  1.1971759e-13  0              3.8640674    
   1900000   18000          200            200            0.0035796332   1.0445805e-44  0              0.0107389      8.0450032e-10  0              3.8846441e-05  1.1971759e-13  0              3.8640674    
   2000000   18000          200            200            0.0035796282   2.8048389e-37  0              0.010738885    1.8181448e-10  0              8.7791705e-06  1.1971759e-13  0              3.8640674    
   2100000   18000          200            200            0.0035796283  -1.1219355e-36  0              0.010738885    7.2648154e-14  0              3.5079194e-09  1.1971759e-13  0              3.8640674    
   2200000   18000          200            200            0.003579629    3.0853227e-36  0              0.010738887    3.3929366e-12  0              1.6383277e-07  1.1971759e-13  0              3.8640674    
   2300000   18000          200            200            0.0035796292   1.1219355e-36  0              0.010738887    1.89857e-13    0              9.167515e-09   1.1971759e-13  0              3.8640674    
   2400000   18000          200            200            0.0035796291  -1.4024194e-36  0              0.010738887    1.7413385e-14  0              8.4083003e-10  1.1971759e-13  0              3.8640674    
   2500000   18000          200            200            0.0035796291   1.0208422e-44  0              0.010738887    8.1780742e-15  0              3.9488993e-10  1.1971759e-13  0              3.8640674    
   2600000   18000          200            200            0.0035796291   5.6096777e-37  0              0.010738887    6.9350929e-17  0              3.3487082e-12  1.1971759e-13  0              3.8640674    
   2700000   18000          200            200            0.0035796291   1.1219355e-36  0              0.010738887    9.755663e-17   0              4.7106605e-12  1.1971759e-13  0              3.8640674    
   2800000   18000          200            200            0.0035796291   5.6096777e-37  0              0.010738887    1.9187779e-17  0              9.2650917e-13  1.1971759e-13  0              3.8640674    
   2900000   18000          200            200            0.0035796291   9.5989535e-45  0              0.010738887    1.2224366e-17  0              5.9027087e-13  1.1971759e-13  0              3.8640674    
   3000000   18000          200            200            0.0035796291   1.1701077e-44  0              0.010738887    1.2900856e-17  0              6.2293616e-13  1.1971759e-13  0              3.8640674    
Loop time of 760.048 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3410311.096 ns/day, 0.000 hours/ns, 3947.119 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.11     | 242.17     | 242.24     |   0.4 | 31.86
Neigh   | 4.5633     | 4.5643     | 4.5653     |   0.0 |  0.60
Comm    | 23.291     | 23.5       | 23.709     |   4.3 |  3.09
Output  | 0.61208    | 0.61209    | 0.61211    |   0.0 |  0.08
Modify  | 429        | 429        | 429        |   0.0 | 56.44
Other   |            | 60.2       |            |       |  7.92

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 122
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 21:24:28

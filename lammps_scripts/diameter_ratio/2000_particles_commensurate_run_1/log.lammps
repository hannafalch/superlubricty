LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11613 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 417.1 | 417.1 | 417.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.00229385    -1.7950951e-35  0              0.0068815499   1196854.7      0              5.7791832e+10  1.1971759e-13  0              3.3177117    
    200000   18000          200            200            0.00088501655  5.4679519e-41  0              0.0026550497   333342.6       0              1.6095921e+10  1.1971759e-13  0              3.0561683    
    300000   18000          200            200            0.00021344295 -3.5901885e-35  0              0.00064032884  33730.854      0              1.6287422e+09  1.1971759e-13  0              3.0379284    
    400000   18000          200            200            9.2395985e-05  1.7951032e-35  0              0.00027718795  7560.4207      0              3.6506566e+08  1.1971759e-13  0              3.0083579    
    500000   18000          200            200           -3.0271267e-05  5.0759102e-41  0             -9.08138e-05    1009.3443      0              48737623       1.1971759e-13  0              3.0014131    
    600000   18000          200            200            0.0047631131  -1.7950949e-35  0              0.014289339    484.64727      0              23401882       1.1971759e-13  0              2.9985754    
    700000   18000          200            200            0.0017338771   4.4877431e-35  0              0.0052016312   0.083289265    0              4021.7405      1.1971759e-13  0              2.9992716    
    800000   18000          200            200            0.0024002859   1.7950978e-35  0              0.0072008576   1.0244052      0              49464.861      1.1971759e-13  0              2.9990949    
    900000   18000          200            200            0.0026428568  -4.4877337e-36  0              0.0079285705   0.21264486     0              10267.859      1.1971759e-13  0              2.999035     
   1000000   18000          200            200            0.0027297054   1.7950975e-35  0              0.0081891161   0.034553785    0              1668.4786      1.1971759e-13  0              2.999014     
   1100000   18000          200            200            0.0027608771  -1.7950964e-35  0              0.0082826314   0.0053717728   0              259.38368      1.1971759e-13  0              2.9990066    
   1200000   18000          200            200            0.0027720417  -2.24387e-36    0              0.0083161251   0.00081977449  0              39.583976      1.1971759e-13  0              2.9990039    
   1300000   18000          200            200            0.0027760321  -7.8535485e-36  0              0.0083280964   0.00012346965  0              5.9619078      1.1971759e-13  0              2.999003     
   1400000   18000          200            200            0.0027774559   7.0120969e-37  0              0.0083323677   1.8393817e-05  0              0.88817157     1.1971759e-13  0              2.9990026    
   1500000   18000          200            200            0.002777963    8.5145732e-45  0              0.0083338891   2.7142069e-06  0              0.13105934     1.1971759e-13  0              2.9990025    
   1600000   18000          200            200            0.0027781434  -2.8048387e-37  0              0.0083344302   3.9713634e-07  0              0.019176293    1.1971759e-13  0              2.9990025    
   1700000   18000          200            200            0.0027782074   1.0292667e-44  0              0.0083346223   5.7668191e-08  0              0.0027845906   1.1971759e-13  0              2.9990024    
   1800000   18000          200            200            0.0027782301  -3.0853226e-36  0              0.0083346904   8.3167811e-09  0              0.00040158759  1.1971759e-13  0              2.9990024    
   1900000   18000          200            200            0.0027782382  -1.9633871e-36  0              0.0083347145   1.1918357e-09  0              5.754948e-05   1.1971759e-13  0              2.9990024    
   2000000   18000          200            200            0.002778241   -3.6462904e-36  0              0.008334723    1.6982624e-10  0              8.2003014e-06  1.1971759e-13  0              2.9990024    
   2100000   18000          200            200            0.002778242    1.4024194e-36  0              0.008334726    2.4073673e-11  0              1.1624315e-06  1.1971759e-13  0              2.9990024    
   2200000   18000          200            200            0.0027782423   8.4145164e-37  0              0.008334727    3.3945963e-12  0              1.6391291e-07  1.1971759e-13  0              2.9990024    
   2300000   18000          200            200            0.0027782425   2.8048389e-37  0              0.0083347274   4.7590157e-13  0              2.2979584e-08  1.1971759e-13  0              2.9990024    
   2400000   18000          200            200            0.0027782425   2.8048389e-37  0              0.0083347275   6.6501708e-14  0              3.2111295e-09  1.1971759e-13  0              2.9990024    
   2500000   18000          200            200            0.0027782425   2.8048389e-37  0              0.0083347276   9.4018142e-15  0              4.5397996e-10  1.1971759e-13  0              2.9990024    
   2600000   18000          200            200            0.0027782425   1.6829033e-36  0              0.0083347276   1.2164432e-15  0              5.8737688e-11  1.1971759e-13  0              2.9990024    
   2700000   18000          200            200            0.0027782425  -1.1219355e-36  0              0.0083347276   2.3974505e-16  0              1.1576431e-11  1.1971759e-13  0              2.9990024    
   2800000   18000          200            200            0.0027782425   1.0303807e-44  0              0.0083347276   9.0660267e-18  0              4.3776598e-13  1.1971759e-13  0              2.9990024    
   2900000   18000          200            200            0.0027782425  -2.8048387e-37  0              0.0083347276   1.047127e-17   0              5.0562014e-13  1.1971759e-13  0              2.9990024    
   3000000   18000          200            200            0.0027782425  -8.4145162e-37  0              0.0083347276   7.7245363e-18  0              3.7299021e-13  1.1971759e-13  0              2.9990024    
Loop time of 869.35 on 2 procs for 3000000 steps with 5001 atoms

Performance: 2981536.338 ns/day, 0.000 hours/ns, 3450.852 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 292.89     | 293.97     | 295.05     |   6.3 | 33.81
Neigh   | 23.17      | 23.175     | 23.18      |   0.1 |  2.67
Comm    | 56.255     | 56.96      | 57.665     |   9.3 |  6.55
Output  | 0.60616    | 0.60622    | 0.60628    |   0.0 |  0.07
Modify  | 432.65     | 432.9      | 433.15     |   1.2 | 49.80
Other   |            | 61.74      |            |       |  7.10

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.01                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.4138228207373
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.11
  ghost atom cutoff = 3.11
  binsize = 1.555, bins = 11576 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 409.8 | 409.8 | 409.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023004135  -2.6926434e-35  0              0.0069012404   1201428.9      0              5.80127e+10    1.1971759e-13  0              3.3178921    
    200000   18000          200            200            0.00089471303 -3.5901894e-35  0              0.0026841391   338599.38      0              1.6349752e+10  1.1971759e-13  0              3.0577561    
    300000   18000          200            200            0.00022205806  5.8155895e-41  0              0.00066617419  36070.979      0              1.7417385e+09  1.1971759e-13  0              3.041666     
    400000   18000          200            200            0.00010057537  1.9746071e-34  0              0.0003017261   8825.797       0              4.2616615e+08  1.1971759e-13  0              3.0127046    
    500000   18000          200            200           -2.3142661e-05  5.1949566e-41  0             -6.9427982e-05  578.44579      0              27931077       1.1971759e-13  0              3.0066271    
    600000   18000          200            200            0.0055689124   1.7950985e-35  0              0.016706737    216.37614      0              10448029       1.1971759e-13  0              3.0034194    
    700000   18000          200            200            0.0018156624   2.6926462e-35  0              0.0054469873   15.369742      0              742149.85      1.1971759e-13  0              3.0042511    
    800000   18000          200            200            0.0023957618   1.9746066e-34  0              0.0071872854   0.35236821     0              17014.6        1.1971759e-13  0              3.0040979    
    900000   18000          200            200            0.0026407054   8.9754925e-36  0              0.0079221161   0.041825536    0              2019.6054      1.1971759e-13  0              3.0040373    
   1000000   18000          200            200            0.002731285    3.5901943e-35  0              0.008193855    0.0071751258   0              346.46115      1.1971759e-13  0              3.0040154    
   1100000   18000          200            200            0.002764223    8.9754878e-36  0              0.0082926689   0.0012385404   0              59.804681      1.1971759e-13  0              3.0040075    
   1200000   18000          200            200            0.0027761425   1.1248612e-42  0              0.0083284276   0.00020751697  0              10.020252      1.1971759e-13  0              3.0040046    
   1300000   18000          200            200            0.0027804474   7.4372299e-44  0              0.0083413422   3.3843784e-05  0              1.6341952      1.1971759e-13  0              3.0040036    
   1400000   18000          200            200            0.0027820004   1.4024194e-37  0              0.0083460011   5.3994011e-06  0              0.26071775     1.1971759e-13  0              3.0040032    
   1500000   18000          200            200            0.0027825601  -1.9633871e-36  0              0.0083476804   8.4595066e-07  0              0.04084793     1.1971759e-13  0              3.0040031    
   1600000   18000          200            200            0.0027827617   5.6096776e-37  0              0.0083482852   1.3054188e-07  0              0.0063034001   1.1971759e-13  0              3.004003     
   1700000   18000          200            200            0.0027828343  -2.8048387e-37  0              0.0083485028   1.9885646e-08  0              0.00096020666  1.1971759e-13  0              3.004003     
   1800000   18000          200            200            0.0027828604   1.1219355e-36  0              0.0083485811   2.9954918e-09  0              0.00014464158  1.1971759e-13  0              3.004003     
   1900000   18000          200            200            0.0027828697   2.5243549e-36  0              0.0083486092   4.4681296e-10  0              2.1574999e-05  1.1971759e-13  0              3.004003     
   2000000   18000          200            200            0.0027828731  -1.4024194e-36  0              0.0083486193   6.6086485e-11  0              3.1910799e-06  1.1971759e-13  0              3.004003     
   2100000   18000          200            200            0.0027828743  -2.8048388e-36  0              0.0083486229   9.6948172e-12  0              4.6812803e-07  1.1971759e-13  0              3.004003     
   2200000   18000          200            200            0.0027828747  -1.4024194e-36  0              0.0083486242   1.4133182e-12  0              6.8244079e-08  1.1971759e-13  0              3.004003     
   2300000   18000          200            200            0.0027828749   1.0386022e-44  0              0.0083486247   2.0464718e-13  0              9.8816801e-09  1.1971759e-13  0              3.004003     
   2400000   18000          200            200            0.002782875   -2.8048387e-37  0              0.0083486249   2.9272293e-14  0              1.4134543e-09  1.1971759e-13  0              3.004003     
   2500000   18000          200            200            0.002782875    2.8048389e-37  0              0.0083486249   4.2489322e-15  0              2.0516573e-10  1.1971759e-13  0              3.004003     
   2600000   18000          200            200            0.002782875    1.9633872e-36  0              0.0083486249   6.9763805e-16  0              3.3686445e-11  1.1971759e-13  0              3.004003     
   2700000   18000          200            200            0.002782875   -1.9633871e-36  0              0.008348625    2.1992745e-17  0              1.061951e-12   1.1971759e-13  0              3.004003     
   2800000   18000          200            200            0.002782875    8.4145164e-37  0              0.008348625    1.1862085e-17  0              5.7277761e-13  1.1971759e-13  0              3.004003     
   2900000   18000          200            200            0.002782875    2.8048389e-37  0              0.008348625    1.0681915e-19  0              5.1579143e-15  1.1971759e-13  0              3.004003     
   3000000   18000          200            200            0.002782875    2.8048389e-37  0              0.008348625    4.0883798e-19  0              1.9741323e-14  1.1971759e-13  0              3.004003     
Loop time of 838.168 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3092457.270 ns/day, 0.000 hours/ns, 3579.233 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 265.53     | 266.3      | 267.07     |   4.7 | 31.77
Neigh   | 23.102     | 23.106     | 23.11      |   0.1 |  2.76
Comm    | 58.183     | 58.66      | 59.136     |   6.2 |  7.00
Output  | 0.60794    | 0.60797    | 0.608      |   0.0 |  0.07
Modify  | 427.24     | 427.27     | 427.29     |   0.1 | 50.98
Other   |            | 62.23      |            |       |  7.42

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 174
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.02                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.7279587335909
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.12
  ghost atom cutoff = 3.12
  binsize = 1.56, bins = 11539 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 408.6 | 408.6 | 408.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023069784  -8.9754704e-36  0              0.0069209352   1206009.7      0              5.8233891e+10  1.1971759e-13  0              3.3180612    
    200000   18000          200            200            0.00090443916 -1.0770579e-34  0              0.0027133175   343893.15      0              1.6605369e+10  1.1971759e-13  0              3.0593137    
    300000   18000          200            200            0.00023074967 -7.1803825e-35  0              0.00069224902  38487.078      0              1.8584032e+09  1.1971759e-13  0              3.0453598    
    400000   18000          200            200            0.00010885302  3.5901989e-35  0              0.00032655905  10187.224      0              4.9190458e+08  1.1971759e-13  0              3.0169999    
    500000   18000          200            200           -1.5889082e-05  8.9754891e-35  0             -4.7667247e-05  267.13254      0              12898874       1.1971759e-13  0              3.0117823    
    600000   18000          200            200            0.0060313117  -1.2565676e-34  0              0.018093935    29.867333      0              1442186.6      1.1971759e-13  0              3.0083338    
    700000   18000          200            200            0.0020246873   2.6926462e-35  0              0.0060740619   49.607464      0              2395366.9      1.1971759e-13  0              3.0091967    
    800000   18000          200            200            0.0024634017  -1.7950958e-35  0              0.0073902052   4.3441118      0              209761.61      1.1971759e-13  0              3.0090829    
    900000   18000          200            200            0.002673632    1.7950977e-35  0              0.0080208961   0.66835972     0              32272.699      1.1971759e-13  0              3.0090311    
   1000000   18000          200            200            0.0027489099   1.7950975e-35  0              0.0082467296   0.10757772     0              5194.5431      1.1971759e-13  0              3.0090128    
   1100000   18000          200            200            0.0027746624  -5.3852901e-35  0              0.0083239871   0.016870241    0              814.60355      1.1971759e-13  0              3.0090066    
   1200000   18000          200            200            0.0027833068   1.1641472e-42  0              0.0083499205   0.0025725291   0              124.21823      1.1971759e-13  0              3.0090045    
   1300000   18000          200            200            0.0027861619   3.9267744e-36  0              0.0083584858   0.00038283258  0              18.485615      1.1971759e-13  0              3.0090039    
   1400000   18000          200            200            0.0027870877  -1.2621774e-36  0              0.0083612632   5.5764121e-05  0              2.6926498      1.1971759e-13  0              3.0090036    
   1500000   18000          200            200            0.0027873812  -1.9633871e-36  0              0.0083621435   7.9676172e-06  0              0.38472772     1.1971759e-13  0              3.0090036    
   1600000   18000          200            200            0.0027874714  -2.8048387e-37  0              0.0083624142   1.1184141e-06  0              0.054004215    1.1971759e-13  0              3.0090035    
   1700000   18000          200            200            0.002787498    2.8048389e-37  0              0.008362494    1.5440341e-07  0              0.007455588    1.1971759e-13  0              3.0090035    
   1800000   18000          200            200            0.0027875054  -2.8048387e-37  0              0.0083625161   2.0981193e-08  0              0.0010131067   1.1971759e-13  0              3.0090035    
   1900000   18000          200            200            0.0027875072  -5.6096774e-37  0              0.0083625215   2.8074825e-09  0              0.00013556328  1.1971759e-13  0              3.0090035    
   2000000   18000          200            200            0.0027875075   1.0310082e-44  0              0.0083625226   3.700616e-10   0              1.786895e-05   1.1971759e-13  0              3.0090035    
   2100000   18000          200            200            0.0027875075   5.6096777e-37  0              0.0083625226   4.80403e-11    0              2.3196941e-06  1.1971759e-13  0              3.0090035    
   2200000   18000          200            200            0.0027875075   8.4145164e-37  0              0.0083625225   6.1417647e-12  0              2.9656384e-07  1.1971759e-13  0              3.0090035    
   2300000   18000          200            200            0.0027875075   1.1219355e-36  0              0.0083625224   7.7244186e-13  0              3.7298453e-08  1.1971759e-13  0              3.0090035    
   2400000   18000          200            200            0.0027875075  -4.2072582e-36  0              0.0083625224   9.5123536e-14  0              4.5931751e-09  1.1971759e-13  0              3.0090035    
   2500000   18000          200            200            0.0027875074   2.243871e-36   0              0.0083625223   1.1598692e-14  0              5.600593e-10   1.1971759e-13  0              3.0090035    
   2600000   18000          200            200            0.0027875074   1.0323658e-44  0              0.0083625223   1.2995891e-15  0              6.2752507e-11  1.1971759e-13  0              3.0090035    
   2700000   18000          200            200            0.0027875074  -2.8048387e-37  0              0.0083625223   2.3449673e-16  0              1.1323008e-11  1.1971759e-13  0              3.0090035    
   2800000   18000          200            200            0.0027875074   2.5243549e-36  0              0.0083625223   2.3413037e-17  0              1.1305318e-12  1.1971759e-13  0              3.0090035    
   2900000   18000          200            200            0.0027875074  -1.4024194e-36  0              0.0083625223   1.2720945e-17  0              6.1424891e-13  1.1971759e-13  0              3.0090035    
   3000000   18000          200            200            0.0027875074   5.6096777e-37  0              0.0083625223   4.9788865e-18  0              2.4041261e-13  1.1971759e-13  0              3.0090035    
Loop time of 805.023 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3219783.092 ns/day, 0.000 hours/ns, 3726.601 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.31     | 244.48     | 245.65     |   7.5 | 30.37
Neigh   | 21.394     | 21.399     | 21.403     |   0.1 |  2.66
Comm    | 50.607     | 51.948     | 53.288     |  18.6 |  6.45
Output  | 0.60744    | 0.60746    | 0.60748    |   0.0 |  0.08
Modify  | 426.42     | 426.77     | 427.12     |   1.7 | 53.01
Other   |            | 59.82      |            |       |  7.43

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.03                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.0441819206036
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.13
  ghost atom cutoff = 3.13
  binsize = 1.565, bins = 11502 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 401.4 | 401.4 | 401.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023135447   3.5901948e-35  0              0.006940634    1210597.2      0              5.8455405e+10  1.1971759e-13  0              3.3182191    
    200000   18000          200            200            0.00091419379  2.1928352e-41  0              0.0027425814   349223.25      0              1.6862741e+10  1.1971759e-13  0              3.0608414    
    300000   18000          200            200            0.00023951692  1.795101e-35   0              0.00071855077  40978.809      0              1.97872e+09    1.1971759e-13  0              3.0490098    
    400000   18000          200            200            0.00011722962 -1.7950901e-35  0              0.00035168885  11644.584      0              5.6227529e+08  1.1971759e-13  0              3.0212436    
    500000   18000          200            200           -8.5092299e-06 -1.7950916e-35  0             -2.552769e-05   74.781472      0              3610929.7      1.1971759e-13  0              3.0168787    
    600000   18000          200            200            0.006055234   -2.6926434e-35  0              0.018165702    20.381383      0              984144.06      1.1971759e-13  0              3.0133303    
    700000   18000          200            200            0.0023457375   1.7950979e-35  0              0.0070372125   85.183487      0              4113205.7      1.1971759e-13  0              3.0141156    
    800000   18000          200            200            0.0025930492  -1.7950959e-35  0              0.0077791475   10.116654      0              488497.01      1.1971759e-13  0              3.0140528    
    900000   18000          200            200            0.0027349251  -5.3852896e-35  0              0.0082047754   1.5055399      0              72697.132      1.1971759e-13  0              3.014018     
   1000000   18000          200            200            0.0027785704  -4.4877347e-36  0              0.0083357112   0.21969059     0              10608.072      1.1971759e-13  0              3.0140074    
   1100000   18000          200            200            0.0027899821  -5.8340643e-35  0              0.0083699464   0.030638219    0              1479.4099      1.1971759e-13  0              3.0140046    
   1200000   18000          200            200            0.0027923769   8.9754853e-36  0              0.0083771307   0.0040871749   0              197.35505      1.1971759e-13  0              3.014004     
   1300000   18000          200            200            0.0027925936   8.5471479e-44  0              0.0083777808   0.00052195948  0              25.203555      1.1971759e-13  0              3.014004     
   1400000   18000          200            200            0.0027924343   4.2072582e-37  0              0.0083773029   6.3732926e-05  0              3.0774349      1.1971759e-13  0              3.014004     
   1500000   18000          200            200            0.0027922915   2.8048389e-37  0              0.0083768745   7.4143517e-06  0              0.35801251     1.1971759e-13  0              3.014004     
   1600000   18000          200            200            0.00279221     1.0371143e-44  0              0.0083766299   8.1650397e-07  0              0.039426054    1.1971759e-13  0              3.0140041    
   1700000   18000          200            200            0.0027921702  -2.8048387e-37  0              0.0083765107   8.4194041e-08  0              0.0040654289   1.1971759e-13  0              3.0140041    
   1800000   18000          200            200            0.0027921524  -5.6096774e-37  0              0.0083764573   7.9792774e-09  0              0.00038529075  1.1971759e-13  0              3.0140041    
   1900000   18000          200            200            0.0027921449  -2.8048387e-37  0              0.0083764347   6.7196053e-10  0              3.2446569e-05  1.1971759e-13  0              3.0140041    
   2000000   18000          200            200            0.0027921418  -2.243871e-36   0              0.0083764255   4.6875255e-11  0              2.2634383e-06  1.1971759e-13  0              3.0140041    
   2100000   18000          200            200            0.0027921406  -5.6096774e-37  0              0.0083764219   2.2560627e-12  0              1.0893719e-07  1.1971759e-13  0              3.0140041    
   2200000   18000          200            200            0.0027921402   5.6096777e-37  0              0.0083764205   3.0831084e-14  0              1.4887227e-09  1.1971759e-13  0              3.0140041    
   2300000   18000          200            200            0.00279214     1.6829033e-36  0              0.00837642     5.3109457e-15  0              2.5644656e-10  1.1971759e-13  0              3.0140041    
   2400000   18000          200            200            0.0027921399  -2.8048387e-37  0              0.0083764198   5.4161791e-15  0              2.615279e-10   1.1971759e-13  0              3.0140041    
   2500000   18000          200            200            0.0027921399   1.1219355e-36  0              0.0083764197   1.9218643e-15  0              9.2799949e-11  1.1971759e-13  0              3.0140041    
   2600000   18000          200            200            0.0027921399   5.6096777e-37  0              0.0083764197   5.5283897e-16  0              2.6694615e-11  1.1971759e-13  0              3.0140041    
   2700000   18000          200            200            0.0027921399   2.8048389e-37  0              0.0083764197   2.303962e-17   0              1.1125008e-12  1.1971759e-13  0              3.0140041    
   2800000   18000          200            200            0.0027921399  -2.8048387e-37  0              0.0083764197   6.4769325e-18  0              3.1274789e-13  1.1971759e-13  0              3.0140041    
   2900000   18000          200            200            0.0027921399  -8.4145162e-37  0              0.0083764197   9.2696537e-18  0              4.475984e-13   1.1971759e-13  0              3.0140041    
   3000000   18000          200            200            0.0027921399  -8.4145162e-37  0              0.0083764197   5.7406726e-18  0              2.7719654e-13  1.1971759e-13  0              3.0140041    
Loop time of 804.267 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3222809.187 ns/day, 0.000 hours/ns, 3730.103 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.16     | 241.63     | 242.11     |   3.1 | 30.04
Neigh   | 20.767     | 20.77      | 20.773     |   0.1 |  2.58
Comm    | 49.987     | 50.862     | 51.738     |  12.3 |  6.32
Output  | 0.60962    | 0.60962    | 0.60963    |   0.0 |  0.08
Modify  | 427.46     | 428.9      | 430.34     |   7.0 | 53.33
Other   |            | 61.49      |            |       |  7.65

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.04                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.3624992932791
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.14
  ghost atom cutoff = 3.14
  binsize = 1.57, bins = 11465 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 400.2 | 400.2 | 400.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023201122  -1.3463222e-35  0              0.0069603367   1215191.3      0              5.8677238e+10  1.1971759e-13  0              3.3183657    
    200000   18000          200            200            0.00092397686  8.9755156e-36  0              0.0027719306   354589.72      0              1.7121868e+10  1.1971759e-13  0              3.062339     
    300000   18000          200            200            0.00024835898  8.9754903e-35  0              0.00074507694  43545.831      0              2.1026723e+09  1.1971759e-13  0              3.0526161    
    400000   18000          200            200            0.00012570241 -1.2565672e-34  0              0.00037710723  13197.156      0              6.3724345e+08  1.1971759e-13  0              3.0254358    
    500000   18000          200            200           -1.0070909e-06 -1.7950916e-35  0             -3.0212727e-06  0.92991199     0              44902.122      1.1971759e-13  0              3.0219162    
    600000   18000          200            200            0.0056342208  -4.4877402e-35  0              0.016902662    192.13385      0              9277455.8      1.1971759e-13  0              3.0184095    
    700000   18000          200            200            0.0027467254   1.1363807e-41  0              0.0082401763   102.70074      0              4959051.1      1.1971759e-13  0              3.019019     
    800000   18000          200            200            0.0027633218  -1.7950958e-35  0              0.0082899654   13.467251      0              650285.33      1.1971759e-13  0              3.0190135    
    900000   18000          200            200            0.0028109234  -3.5901927e-35  0              0.0084327702   1.7720198      0              85564.495      1.1971759e-13  0              3.0190016    
   1000000   18000          200            200            0.0028125337  -1.3463219e-35  0              0.0084376012   0.21490023     0              10376.763      1.1971759e-13  0              3.019001     
   1100000   18000          200            200            0.0028061309   3.8459573e-42  0              0.0084183926   0.023678951    0              1143.3718      1.1971759e-13  0              3.0190024    
   1200000   18000          200            200            0.0028013404  -2.2438699e-36  0              0.0084040212   0.0023276365   0              112.39324      1.1971759e-13  0              3.0190036    
   1300000   18000          200            200            0.0027987838   5.6096776e-36  0              0.0083963513   0.00019613246  0              9.4705344      1.1971759e-13  0              3.0190041    
   1400000   18000          200            200            0.0027975993   1.4024194e-37  0              0.008392798    1.2918256e-05  0              0.62377634     1.1971759e-13  0              3.0190044    
   1500000   18000          200            200            0.0027970948  -2.8048387e-37  0              0.0083912845   5.0224926e-07  0              0.024251819    1.1971759e-13  0              3.0190045    
   1600000   18000          200            200            0.0027968925  -2.8048387e-37  0              0.0083906775   9.0492287e-10  0              4.3695487e-05  1.1971759e-13  0              3.0190046    
   1700000   18000          200            200            0.0027968152  -8.4145162e-37  0              0.0083904456   5.1763616e-09  0              0.00024994797  1.1971759e-13  0              3.0190046    
   1800000   18000          200            200            0.002796787   -1.1219355e-36  0              0.0083903609   3.0314246e-09  0              0.00014637664  1.1971759e-13  0              3.0190046    
   1900000   18000          200            200            0.0027967771   5.6096777e-37  0              0.0083903312   8.7792527e-10  0              4.2391869e-05  1.1971759e-13  0              3.0190046    
   2000000   18000          200            200            0.0027967738  -5.6096774e-37  0              0.0083903213   1.9027787e-10  0              9.1878375e-06  1.1971759e-13  0              3.0190046    
   2100000   18000          200            200            0.0027967727   1.0294682e-44  0              0.0083903182   3.4754676e-11  0              1.6781789e-06  1.1971759e-13  0              3.0190046    
   2200000   18000          200            200            0.0027967724   8.4145164e-37  0              0.0083903173   5.6189757e-12  0              2.7132023e-07  1.1971759e-13  0              3.0190046    
   2300000   18000          200            200            0.0027967724  -1.4024194e-36  0              0.0083903171   8.227109e-13   0              3.9725765e-08  1.1971759e-13  0              3.0190046    
   2400000   18000          200            200            0.0027967723  -8.4145162e-37  0              0.008390317    1.1044173e-13  0              5.3328361e-09  1.1971759e-13  0              3.0190046    
   2500000   18000          200            200            0.0027967723  -8.4145162e-37  0              0.008390317    1.3572242e-14  0              6.5535498e-10  1.1971759e-13  0              3.0190046    
   2600000   18000          200            200            0.0027967723  -2.8048387e-37  0              0.008390317    1.4329916e-15  0              6.9194037e-11  1.1971759e-13  0              3.0190046    
   2700000   18000          200            200            0.0027967723  -2.8048387e-37  0              0.008390317    2.270979e-16   0              1.0965745e-11  1.1971759e-13  0              3.0190046    
   2800000   18000          200            200            0.0027967723   2.8048389e-37  0              0.008390317    2.4826919e-17  0              1.198803e-12   1.1971759e-13  0              3.0190046    
   2900000   18000          200            200            0.0027967723   8.4145164e-37  0              0.008390317    1.6181212e-18  0              7.8133284e-14  1.1971759e-13  0              3.0190046    
   3000000   18000          200            200            0.0027967723   1.0471171e-44  0              0.008390317    5.253554e-18   0              2.5367532e-13  1.1971759e-13  0              3.0190046    
Loop time of 805.402 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3218267.259 ns/day, 0.000 hours/ns, 3724.846 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.08     | 243.33     | 243.58     |   1.6 | 30.21
Neigh   | 20.832     | 20.836     | 20.839     |   0.1 |  2.59
Comm    | 50.78      | 50.887     | 50.995     |   1.5 |  6.32
Output  | 0.60923    | 0.60925    | 0.60926    |   0.0 |  0.08
Modify  | 429.6      | 429.89     | 430.18     |   1.4 | 53.38
Other   |            | 59.85      |            |       |  7.43

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.05                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.6829177631213
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.15
  ghost atom cutoff = 3.15
  binsize = 1.575, bins = 11429 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 393.2 | 393.2 | 393.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023266811   1.2663777e-41  0              0.0069800434   1219792.2      0              5.8899398e+10  1.1971759e-13  0              3.3185008    
    200000   18000          200            200            0.00093378871  5.0863693e-41  0              0.0028013661   359992.78      0              1.7382763e+10  1.1971759e-13  0              3.0638064    
    300000   18000          200            200            0.00025727589  8.9754893e-35  0              0.00077182766  46188.067      0              2.2302565e+09  1.1971759e-13  0              3.0561784    
    400000   18000          200            200            0.00013427231  7.1803933e-35  0              0.00040281693  14844.88       0              7.1680613e+08  1.1971759e-13  0              3.0295763    
    500000   18000          200            200            6.6188833e-06  5.161536e-41   0              1.985665e-05   45.002041      0              2172987.5      1.1971759e-13  0              3.0268948    
    600000   18000          200            200            0.0048530671   4.4877438e-35  0              0.014559201    455.34948      0              21987197       1.1971759e-13  0              3.0235608    
    700000   18000          200            200            0.0031759485   1.7950981e-35  0              0.0095278454   91.456464      0              4416105.4      1.1971759e-13  0              3.0239205    
    800000   18000          200            200            0.0029437123  -8.9754741e-36  0              0.0088311369   11.8857        0              573917.9       1.1971759e-13  0              3.0239726    
    900000   18000          200            200            0.0028839998  -3.5901928e-35  0              0.0086519994   1.2171961      0              58774.044      1.1971759e-13  0              3.023986     
   1000000   18000          200            200            0.0028416887  -4.4877413e-35  0              0.008525066    0.098986493    0              4779.7035      1.1971759e-13  0              3.0239957    
   1100000   18000          200            200            0.0028187546  -2.6926448e-35  0              0.0084562637   0.0055916415   0              270.00036      1.1971759e-13  0              3.0240011    
   1200000   18000          200            200            0.0028082459   6.7316142e-36  0              0.0084247378   0.00011941031  0              5.7658966      1.1971759e-13  0              3.0240035    
   1300000   18000          200            200            0.0028039095   8.9754842e-36  0              0.0084117286   4.8106629e-06  0              0.23228969     1.1971759e-13  0              3.0240046    
   1400000   18000          200            200            0.0028022575   3.2255646e-36  0              0.0084067724   8.8432891e-06  0              0.42701078     1.1971759e-13  0              3.024005     
   1500000   18000          200            200            0.0028016719   8.4145164e-37  0              0.0084050157   3.2143196e-06  0              0.15520799     1.1971759e-13  0              3.0240051    
   1600000   18000          200            200            0.0028014795  -2.8048387e-37  0              0.0084044385   7.4557294e-07  0              0.036001049    1.1971759e-13  0              3.0240051    
   1700000   18000          200            200            0.0028014219   5.6096777e-37  0              0.0084042657   1.3569981e-07  0              0.0065524582   1.1971759e-13  0              3.0240052    
   1800000   18000          200            200            0.0028014069  -1.6829033e-36  0              0.0084042208   2.0786381e-08  0              0.0010037      1.1971759e-13  0              3.0240052    
   1900000   18000          200            200            0.002801404   -5.6096774e-37  0              0.0084042121   2.7479257e-09  0              0.0001326875   1.1971759e-13  0              3.0240052    
   2000000   18000          200            200            0.002801404    1.9633872e-36  0              0.0084042119   3.1370966e-10  0              1.5147917e-05  1.1971759e-13  0              3.0240052    
   2100000   18000          200            200            0.0028014043  -5.6096774e-37  0              0.0084042129   3.0215766e-11  0              1.4590112e-06  1.1971759e-13  0              3.0240052    
   2200000   18000          200            200            0.0028014046   8.4145164e-37  0              0.0084042137   2.2962351e-12  0              1.1087698e-07  1.1971759e-13  0              3.0240052    
   2300000   18000          200            200            0.0028014047   1.0440977e-44  0              0.0084042141   1.130024e-13   0              5.4564815e-09  1.1971759e-13  0              3.0240052    
   2400000   18000          200            200            0.0028014047  -1.1219355e-36  0              0.0084042142   1.1539091e-15  0              5.5718142e-11  1.1971759e-13  0              3.0240052    
   2500000   18000          200            200            0.0028014048  -1.9633871e-36  0              0.0084042143   3.7561439e-16  0              1.8137075e-11  1.1971759e-13  0              3.0240052    
   2600000   18000          200            200            0.0028014048  -1.4024194e-36  0              0.0084042143   3.9756909e-16  0              1.9197188e-11  1.1971759e-13  0              3.0240052    
   2700000   18000          200            200            0.0028014048   2.5243549e-36  0              0.0084042143   2.859904e-17   0              1.3809453e-12  1.1971759e-13  0              3.0240052    
   2800000   18000          200            200            0.0028014048   2.1877742e-35  0              0.0084042143   3.9899235e-18  0              1.9265913e-13  1.1971759e-13  0              3.0240052    
   2900000   18000          200            200            0.0028014048   8.4145164e-37  0              0.0084042143   8.1340368e-18  0              3.9276353e-13  1.1971759e-13  0              3.0240052    
   3000000   18000          200            200            0.0028014048   2.8048388e-37  0              0.0084042143   7.3933946e-18  0              3.5700056e-13  1.1971759e-13  0              3.0240052    
Loop time of 800.444 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3238201.594 ns/day, 0.000 hours/ns, 3747.919 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.79     | 242.87     | 243.96     |   7.0 | 30.34
Neigh   | 20.445     | 20.449     | 20.452     |   0.1 |  2.55
Comm    | 50.092     | 50.884     | 51.675     |  11.1 |  6.36
Output  | 0.60528    | 0.60528    | 0.60529    |   0.0 |  0.08
Modify  | 425.91     | 426.2      | 426.49     |   1.4 | 53.25
Other   |            | 59.44      |            |       |  7.43

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.06                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.005444241634
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.16
  ghost atom cutoff = 3.16
  binsize = 1.58, bins = 11393 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 392 | 392 | 392 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023332514   1.7950978e-35  0              0.0069997541   1224399.8      0              5.9121883e+10  1.1971759e-13  0              3.3186245    
    200000   18000          200            200            0.00094362937  1.7951016e-35  0              0.0028308881   365432.5       0              1.7645428e+10  1.1971759e-13  0              3.0652434    
    300000   18000          200            200            0.00026626755  1.7951017e-35  0              0.00079880264  48905.413      0              2.3614673e+09  1.1971759e-13  0              3.0596966    
    400000   18000          200            200            0.00014293824  1.7951028e-35  0              0.00042881471  16587.338      0              8.0094318e+08  1.1971759e-13  0              3.0336651    
    500000   18000          200            200            1.4366325e-05 -3.5901887e-35  0              4.3098976e-05  206.46826      0              9969613.1      1.1971759e-13  0              3.0318145    
    600000   18000          200            200            0.0038618094   3.5901956e-35  0              0.011585428    679.86865      0              32828424       1.1971759e-13  0              3.0287643    
    700000   18000          200            200            0.0035659365  -3.5901924e-35  0              0.01069781     56.807496      0              2743030.7      1.1971759e-13  0              3.0288351    
    800000   18000          200            200            0.0030991647   1.7950978e-35  0              0.0092974942   6.4847826      0              313126.94      1.1971759e-13  0              3.0289382    
    900000   18000          200            200            0.0029367582   8.4029784e-42  0              0.0088102747   0.35954152     0              17360.973      1.1971759e-13  0              3.0289752    
   1000000   18000          200            200            0.0028583615  -4.9365155e-35  0              0.0085750846   0.0047045762   0              227.16715      1.1971759e-13  0              3.0289934    
   1100000   18000          200            200            0.0028248398   8.9754878e-36  0              0.0084745195   0.0010333707   0              49.897771      1.1971759e-13  0              3.0290013    
   1200000   18000          200            200            0.0028120787  -1.7950967e-35  0              0.0084362362   0.00096929227  0              46.803655      1.1971759e-13  0              3.0290043    
   1300000   18000          200            200            0.0028077154   1.1219356e-36  0              0.0084231462   0.00029475888  0              14.232851      1.1971759e-13  0              3.0290053    
   1400000   18000          200            200            0.0028063954   1.4024194e-37  0              0.0084191862   5.9326619e-05  0              2.8646701      1.1971759e-13  0              3.0290056    
   1500000   18000          200            200            0.0028060625  -2.8048387e-37  0              0.0084181875   9.2051003e-06  0              0.44448135     1.1971759e-13  0              3.0290057    
   1600000   18000          200            200            0.0028060074   5.6096776e-37  0              0.0084180223   1.1478111e-06  0              0.055423689    1.1971759e-13  0              3.0290057    
   1700000   18000          200            200            0.0028060134   2.8048389e-37  0              0.0084180403   1.1353807e-07  0              0.0054823473   1.1971759e-13  0              3.0290057    
   1800000   18000          200            200            0.0028060248  -5.6096774e-37  0              0.0084180744   8.1996843e-09  0              0.00039593341  1.1971759e-13  0              3.0290057    
   1900000   18000          200            200            0.0028060318  -1.4024194e-36  0              0.0084180954   3.1959683e-10  0              1.5432187e-05  1.1971759e-13  0              3.0290057    
   2000000   18000          200            200            0.0028060351   5.6096777e-37  0              0.0084181054   1.3374585e-13  0              6.4581084e-09  1.1971759e-13  0              3.0290057    
   2100000   18000          200            200            0.0028060365   3.6462904e-36  0              0.0084181095   4.419851e-12   0              2.1341879e-07  1.1971759e-13  0              3.0290057    
   2200000   18000          200            200            0.002806037   -1.1219355e-36  0              0.008418111    2.2335462e-12  0              1.0784995e-07  1.1971759e-13  0              3.0290057    
   2300000   18000          200            200            0.0028060372  -5.6096774e-37  0              0.0084181115   5.6423856e-13  0              2.7245061e-08  1.1971759e-13  0              3.0290057    
   2400000   18000          200            200            0.0028060372   5.6096777e-37  0              0.0084181116   1.0147879e-13  0              4.9000477e-09  1.1971759e-13  0              3.0290057    
   2500000   18000          200            200            0.0028060372  -8.4145162e-37  0              0.0084181117   1.4504001e-14  0              7.0034631e-10  1.1971759e-13  0              3.0290057    
   2600000   18000          200            200            0.0028060372  -5.6096774e-37  0              0.0084181117   1.5691816e-15  0              7.5770165e-11  1.1971759e-13  0              3.0290057    
   2700000   18000          200            200            0.0028060372  -8.4145162e-37  0              0.0084181117   2.1730139e-16  0              1.0492706e-11  1.1971759e-13  0              3.0290057    
   2800000   18000          200            200            0.0028060372  -2.8048387e-37  0              0.0084181117   3.1349389e-17  0              1.5137498e-12  1.1971759e-13  0              3.0290057    
   2900000   18000          200            200            0.0028060372   2.8048388e-36  0              0.0084181117   3.1483787e-18  0              1.5202394e-13  1.1971759e-13  0              3.0290057    
   3000000   18000          200            200            0.0028060372   1.6829033e-36  0              0.0084181117   2.3974634e-19  0              1.1576493e-14  1.1971759e-13  0              3.0290057    
Loop time of 799.233 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3243109.103 ns/day, 0.000 hours/ns, 3753.598 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 236.99     | 238.2      | 239.42     |   7.9 | 29.80
Neigh   | 20.422     | 20.426     | 20.431     |   0.1 |  2.56
Comm    | 49.296     | 50.824     | 52.352     |  21.4 |  6.36
Output  | 0.62508    | 0.62509    | 0.6251     |   0.0 |  0.08
Modify  | 429.85     | 430.08     | 430.32     |   1.1 | 53.81
Other   |            | 59.07      |            |       |  7.39

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.07                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.3300856403214
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.17
  ghost atom cutoff = 3.17
  binsize = 1.585, bins = 11357 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 390.8 | 390.8 | 390.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023398227   2.692646e-35   0              0.0070194682   1229013.9      0              5.9344684e+10  1.1971759e-13  0              3.318737     
    200000   18000          200            200            0.00095349759  1.795099e-35   0              0.0028604928   370908.19      0              1.7909829e+10  1.1971759e-13  0              3.0666502    
    300000   18000          200            200            0.00027533254  4.7807911e-41  0              0.00082599763  51697.343      0              2.4962797e+09  1.1971759e-13  0              3.0631707    
    400000   18000          200            200            0.00015169939 -3.5901899e-35  0              0.00045509817  18424.159      0              8.8963669e+08  1.1971759e-13  0              3.037702     
    500000   18000          200            200            2.2235266e-05  4.7500589e-41  0              6.6705798e-05  484.82016      0              23410230       1.1971759e-13  0              3.0366752    
    600000   18000          200            200            0.0028310237   8.9755027e-36  0              0.008493071    767.02567      0              37036925       1.1971759e-13  0              3.0339951    
    700000   18000          200            200            0.0038465719   4.4877432e-35  0              0.011539716    18.691912      0              902565.52      1.1971759e-13  0              3.0337759    
    800000   18000          200            200            0.0031976328  -1.7950958e-35  0              0.0095928983   1.2960773      0              62582.936      1.1971759e-13  0              3.0339172    
    900000   18000          200            200            0.0029567209   8.9754923e-36  0              0.0088701626   0.0028306545   0              136.68218      1.1971759e-13  0              3.0339721    
   1000000   18000          200            200            0.0028587893   3.5901943e-35  0              0.0085763678   0.039130786    0              1889.4856      1.1971759e-13  0              3.0339949    
   1100000   18000          200            200            0.0028238579  -8.9754805e-36  0              0.0084715736   0.016026205    0              773.84809      1.1971759e-13  0              3.0340031    
   1200000   18000          200            200            0.0028132089   6.731614e-36   0              0.0084396268   0.003495012    0              168.76162      1.1971759e-13  0              3.0340056    
   1300000   18000          200            200            0.0028106411  -5.6096769e-37  0              0.0084319233   0.0005330648   0              25.739792      1.1971759e-13  0              3.0340062    
   1400000   18000          200            200            0.0028103161  -1.2621774e-36  0              0.0084309482   5.9923275e-05  0              2.8934805      1.1971759e-13  0              3.0340063    
   1500000   18000          200            200            0.0028104357  -6.4511292e-36  0              0.008431307    4.6875781e-06  0              0.22634637     1.1971759e-13  0              3.0340063    
   1600000   18000          200            200            0.0028105589   1.0133044e-44  0              0.0084316766   1.9057436e-07  0              0.009202154    1.1971759e-13  0              3.0340063    
   1700000   18000          200            200            0.002810626    1.4024194e-36  0              0.008431878    7.160896e-11   0              3.4577404e-06  1.1971759e-13  0              3.0340062    
   1800000   18000          200            200            0.0028106549  -1.1219355e-36  0              0.0084319646   2.6818415e-09  0              0.00012949653  1.1971759e-13  0              3.0340062    
   1900000   18000          200            200            0.0028106655  -1.4024194e-36  0              0.0084319964   1.2913546e-09  0              6.2354891e-05  1.1971759e-13  0              3.0340062    
   2000000   18000          200            200            0.0028106688   2.8048389e-37  0              0.0084320064   3.0081001e-10  0              1.4525039e-05  1.1971759e-13  0              3.0340062    
   2100000   18000          200            200            0.0028106696  -5.6096774e-37  0              0.0084320089   4.8027752e-11  0              2.3190883e-06  1.1971759e-13  0              3.0340062    
   2200000   18000          200            200            0.0028106698  -1.4024194e-36  0              0.0084320093   5.6474837e-12  0              2.7269678e-07  1.1971759e-13  0              3.0340062    
   2300000   18000          200            200            0.0028106697   8.4145164e-37  0              0.0084320092   4.6987795e-13  0              2.2688725e-08  1.1971759e-13  0              3.0340062    
   2400000   18000          200            200            0.0028106697   5.6096777e-37  0              0.0084320091   2.1786234e-14  0              1.0519793e-09  1.1971759e-13  0              3.0340062    
   2500000   18000          200            200            0.0028106697  -1.1219355e-36  0              0.008432009    8.1236774e-17  0              3.9226331e-12  1.1971759e-13  0              3.0340062    
   2600000   18000          200            200            0.0028106697   1.0459993e-44  0              0.008432009    2.4823524e-16  0              1.1986391e-11  1.1971759e-13  0              3.0340062    
   2700000   18000          200            200            0.0028106697  -5.6096774e-37  0              0.008432009    2.9129914e-17  0              1.4065793e-12  1.1971759e-13  0              3.0340062    
   2800000   18000          200            200            0.0028106697   5.6096777e-37  0              0.008432009    3.9441404e-19  0              1.9044842e-14  1.1971759e-13  0              3.0340062    
   2900000   18000          200            200            0.0028106697   2.5243549e-36  0              0.008432009    3.3802054e-19  0              1.6321802e-14  1.1971759e-13  0              3.0340062    
   3000000   18000          200            200            0.0028106697  -2.8048387e-37  0              0.008432009    7.2762778e-18  0              3.5134541e-13  1.1971759e-13  0              3.0340062    
Loop time of 799.969 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3240124.524 ns/day, 0.000 hours/ns, 3750.144 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.56     | 241.19     | 241.82     |   4.1 | 30.15
Neigh   | 20.567     | 20.571     | 20.574     |   0.1 |  2.57
Comm    | 49.74      | 50.618     | 51.496     |  12.3 |  6.33
Output  | 0.60692    | 0.60693    | 0.60695    |   0.0 |  0.08
Modify  | 426.83     | 426.96     | 427.08     |   0.6 | 53.37
Other   |            | 60.02      |            |       |  7.50

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.08                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.6568488706868
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.18
  ghost atom cutoff = 3.18
  binsize = 1.59, bins = 11321 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 383.9 | 383.9 | 383.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023463953   1.8848517e-34  0              0.0070391859   1233634.7      0              5.9567806e+10  1.1971759e-13  0              3.3188381    
    200000   18000          200            200            0.0009633935   4.2214155e-41  0              0.0028901805   376419.95      0              1.8175972e+10  1.1971759e-13  0              3.0680267    
    300000   18000          200            200            0.0002844705   8.9754893e-35  0              0.0008534115   54563.656      0              2.6346837e+09  1.1971759e-13  0              3.0666007    
    400000   18000          200            200            0.00016055496  8.9754901e-35  0              0.00048166487  20354.968      0              9.8286858e+08  1.1971759e-13  0              3.0416871    
    500000   18000          200            200            3.022392e-05   3.5901984e-35  0              9.0671759e-05  879.5056       0              42468178       1.1971759e-13  0              3.0414768    
    600000   18000          200            200            0.0019078155  -1.7950949e-35  0              0.0057234464   692.7074       0              33448361       1.1971759e-13  0              3.0392269    
    700000   18000          200            200            0.0039628389  -2.6926441e-35  0              0.011888517    0.17321145     0              8363.7612      1.1971759e-13  0              3.0387525    
    800000   18000          200            200            0.0032182656  -1.7950959e-35  0              0.0096547967   0.24544322     0              11851.575      1.1971759e-13  0              3.038914     
    900000   18000          200            200            0.0029398905  -4.4877339e-36  0              0.0088196715   0.47677126     0              23021.578      1.1971759e-13  0              3.0389775    
   1000000   18000          200            200            0.0028443297   4.4877487e-36  0              0.0085329892   0.16168564     0              7807.2207      1.1971759e-13  0              3.0389999    
   1100000   18000          200            200            0.0028179444   4.4877456e-36  0              0.0084538332   0.030049787    0              1450.9967      1.1971759e-13  0              3.0390061    
   1200000   18000          200            200            0.0028132102  -8.9754831e-36  0              0.0084396307   0.0036830477   0              177.84119      1.1971759e-13  0              3.0390072    
   1300000   18000          200            200            0.0028135828  -1.1219354e-36  0              0.0084407484   0.00028693596  0              13.85511       1.1971759e-13  0              3.0390072    
   1400000   18000          200            200            0.002814451   -5.6096775e-37  0              0.008443353    9.6520168e-06  0              0.46606135     1.1971759e-13  0              3.039007     
   1500000   18000          200            200            0.0028149709   1.6829033e-36  0              0.0084449127   3.8039523e-08  0              0.0018367924   1.1971759e-13  0              3.0390068    
   1600000   18000          200            200            0.0028151972  -8.4145162e-37  0              0.0084455915   2.8818295e-07  0              0.013915323    1.1971759e-13  0              3.0390068    
   1700000   18000          200            200            0.002815277    2.8048389e-37  0              0.0084458309   1.0627822e-07  0              0.0051317948   1.1971759e-13  0              3.0390068    
   1800000   18000          200            200            0.0028152995   1.0462574e-44  0              0.0084458984   2.0417481e-08  0              0.00098588706  1.1971759e-13  0              3.0390068    
   1900000   18000          200            200            0.0028153037   8.4145164e-37  0              0.008445911    2.5691901e-09  0              0.00012405699  1.1971759e-13  0              3.0390068    
   2000000   18000          200            200            0.0028153035   1.0300675e-44  0              0.0084459104   2.071634e-10   0              1.0003179e-05  1.1971759e-13  0              3.0390068    
   2100000   18000          200            200            0.0028153028   2.5243549e-36  0              0.0084459084   7.5946681e-12  0              3.6671934e-07  1.1971759e-13  0              3.0390068    
   2200000   18000          200            200            0.0028153024   2.8048389e-37  0              0.0084459071   8.1661468e-15  0              3.94314e-10    1.1971759e-13  0              3.0390068    
   2300000   18000          200            200            0.0028153022   8.4145164e-37  0              0.0084459066   1.7902378e-13  0              8.6444177e-09  1.1971759e-13  0              3.0390068    
   2400000   18000          200            200            0.0028153021   2.8048389e-37  0              0.0084459064   7.0468539e-14  0              3.4026736e-09  1.1971759e-13  0              3.0390068    
   2500000   18000          200            200            0.0028153021   2.8048389e-37  0              0.0084459063   1.3840335e-14  0              6.6830025e-10  1.1971759e-13  0              3.0390068    
   2600000   18000          200            200            0.0028153021  -5.6096774e-37  0              0.0084459063   1.719822e-15   0              8.304405e-11   1.1971759e-13  0              3.0390068    
   2700000   18000          200            200            0.0028153021   1.1219355e-36  0              0.0084459063   2.1290543e-16  0              1.0280441e-11  1.1971759e-13  0              3.0390068    
   2800000   18000          200            200            0.0028153021  -2.8048387e-37  0              0.0084459063   3.1327179e-17  0              1.5126774e-12  1.1971759e-13  0              3.0390068    
   2900000   18000          200            200            0.0028153021  -5.6096775e-37  0              0.0084459063   4.6918746e-19  0              2.2655383e-14  1.1971759e-13  0              3.0390068    
   3000000   18000          200            200            0.0028153021  -2.8048387e-37  0              0.0084459063   4.5547118e-18  0              2.1993073e-13  1.1971759e-13  0              3.0390068    
Loop time of 798.55 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3245882.667 ns/day, 0.000 hours/ns, 3756.809 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.02     | 242.89     | 243.75     |   5.6 | 30.42
Neigh   | 20.249     | 20.252     | 20.254     |   0.1 |  2.54
Comm    | 49.287     | 50.458     | 51.629     |  16.5 |  6.32
Output  | 0.60904    | 0.60907    | 0.6091     |   0.0 |  0.08
Modify  | 425.58     | 425.74     | 425.89     |   0.7 | 53.31
Other   |            | 58.61      |            |       |  7.34

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.09                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.9857408442343
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.19
  ghost atom cutoff = 3.19
  binsize = 1.595, bins = 11286 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 382.8 | 382.8 | 382.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023529691   8.9754951e-36  0              0.0070589072   1238262.2      0              5.9791252e+10  1.1971759e-13  0              3.3189278    
    200000   18000          200            200            0.00097331719  4.956524e-41   0              0.0029199516   381967.89      0              1.8443863e+10  1.1971759e-13  0              3.0693728    
    300000   18000          200            200            0.00029368111 -1.7950916e-35  0              0.00088104332  57504.176      0              2.7766708e+09  1.1971759e-13  0              3.0699865    
    400000   18000          200            200            0.00016950359  3.5902001e-35  0              0.00050851077  22379.261      0              1.0806144e+09  1.1971759e-13  0              3.0456203    
    500000   18000          200            200            3.8330809e-05  7.1803923e-35  0              0.00011499243  1389.9501      0              67115718       1.1971759e-13  0              3.0462194    
    600000   18000          200            200            0.0011856103  -8.975465e-36   0              0.0035568309   503.22295      0              24298835       1.1971759e-13  0              3.044436     
    700000   18000          200            200            0.0038911949  -2.6926443e-35  0              0.011673585    12.605817      0              608689.81      1.1971759e-13  0              3.0437688    
    800000   18000          200            200            0.0031574101   8.975493e-36   0              0.0094722302   4.0987551      0              197914.21      1.1971759e-13  0              3.0439291    
    900000   18000          200            200            0.0028919277  -4.4877342e-36  0              0.008675783    1.3286233      0              64154.462      1.1971759e-13  0              3.0439902    
   1000000   18000          200            200            0.0028209809  -8.9754774e-36  0              0.0084629427   0.23222977     0              11213.544      1.1971759e-13  0              3.0440069    
   1100000   18000          200            200            0.0028110606  -1.3463223e-35  0              0.0084331818   0.024144909    0              1165.8712      1.1971759e-13  0              3.0440093    
   1200000   18000          200            200            0.0028141436   4.4877431e-36  0              0.0084424309   0.0012504068   0              60.37767       1.1971759e-13  0              3.0440086    
   1300000   18000          200            200            0.0028174203  -2.8048387e-36  0              0.0084522609   4.067767e-06   0              0.19641791     1.1971759e-13  0              3.0440079    
   1400000   18000          200            200            0.0028190987  -5.6096775e-37  0              0.0084572961   1.1387027e-05  0              0.5498388      1.1971759e-13  0              3.0440075    
   1500000   18000          200            200            0.0028197343  -1.4024194e-36  0              0.0084592028   5.8112442e-06  0              0.28060418     1.1971759e-13  0              3.0440073    
   1600000   18000          200            200            0.0028199173  -2.8048387e-37  0              0.0084597519   1.1839175e-06  0              0.057167138    1.1971759e-13  0              3.0440073    
   1700000   18000          200            200            0.0028199499  -2.8048387e-37  0              0.0084598498   1.4007348e-07  0              0.0067636469   1.1971759e-13  0              3.0440073    
   1800000   18000          200            200            0.0028199466   1.1219355e-36  0              0.0084598398   8.9585171e-09  0              0.00043257473  1.1971759e-13  0              3.0440073    
   1900000   18000          200            200            0.0028199402  -1.1219355e-36  0              0.0084598205   1.1858274e-10  0              5.7259361e-06  1.1971759e-13  0              3.0440073    
   2000000   18000          200            200            0.0028199365  -1.9633871e-36  0              0.0084598096   3.0685372e-11  0              1.4816868e-06  1.1971759e-13  0              3.0440073    
   2100000   18000          200            200            0.0028199351  -1.1219355e-36  0              0.0084598052   2.4557859e-11  0              1.1858111e-06  1.1971759e-13  0              3.0440073    
   2200000   18000          200            200            0.0028199346   2.2999678e-35  0              0.0084598038   5.8591445e-12  0              2.8291712e-07  1.1971759e-13  0              3.0440073    
   2300000   18000          200            200            0.0028199345   1.9633872e-36  0              0.0084598035   7.8572987e-13  0              3.7940084e-08  1.1971759e-13  0              3.0440073    
   2400000   18000          200            200            0.0028199345  -1.4024194e-36  0              0.0084598035   6.0458656e-14  0              2.9193321e-09  1.1971759e-13  0              3.0440073    
   2500000   18000          200            200            0.0028199345   8.4145164e-37  0              0.0084598036   1.5438484e-15  0              7.4546913e-11  1.1971759e-13  0              3.0440073    
   2600000   18000          200            200            0.0028199345  -2.8048387e-37  0              0.0084598036   1.038035e-16   0              5.0122997e-12  1.1971759e-13  0              3.0440073    
   2700000   18000          200            200            0.0028199345   2.8048389e-37  0              0.0084598036   3.4801443e-17  0              1.6804371e-12  1.1971759e-13  0              3.0440073    
   2800000   18000          200            200            0.0028199345   8.4145164e-37  0              0.0084598036   3.1252298e-18  0              1.5090616e-13  1.1971759e-13  0              3.0440073    
   2900000   18000          200            200            0.0028199345  -5.6096775e-37  0              0.0084598036   1.2614033e-17  0              6.0908649e-13  1.1971759e-13  0              3.0440073    
   3000000   18000          200            200            0.0028199345  -4.2072582e-36  0              0.0084598036   5.7798306e-23  0              2.7908733e-18  1.1971759e-13  0              3.0440073    
Loop time of 801.577 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3233625.486 ns/day, 0.000 hours/ns, 3742.622 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.18     | 242.62     | 244.06     |   9.3 | 30.27
Neigh   | 20.743     | 20.747     | 20.75      |   0.1 |  2.59
Comm    | 50.801     | 51.923     | 53.045     |  15.6 |  6.48
Output  | 0.60754    | 0.60756    | 0.60759    |   0.0 |  0.08
Modify  | 425.83     | 425.93     | 426.03     |   0.5 | 53.14
Other   |            | 59.75      |            |       |  7.45

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.1                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.3167684724676
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.2
  ghost atom cutoff = 3.2
  binsize = 1.6, bins = 11250 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 393 | 393 | 393 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023595439   8.9755023e-36  0              0.0070786318   1242896.4      0              6.0015017e+10  1.1971759e-13  0              3.319006     
    200000   18000          200            200            0.0009832679  -1.7950897e-35  0              0.0029498037   387551.6       0              1.871348e+10   1.1971759e-13  0              3.0706885    
    300000   18000          200            200            0.0003029638   3.5901992e-35  0              0.00090889139  60518.644      0              2.9222287e+09  1.1971759e-13  0              3.073328     
    400000   18000          200            200            0.0011850131   1.7951026e-35  0              0.0035550392   24353.982      0              1.1759666e+09  1.1971759e-13  0              3.0495017    
    500000   18000          200            200            4.6557214e-05  1.7951018e-35  0              0.00013967164  2015.7845      0              97335017       1.1971759e-13  0              3.0509027    
    600000   18000          200            200            0.00069567668 -3.5901916e-35  0              0.0020870301   279.07543      0              13475554       1.1971759e-13  0              3.049604     
    700000   18000          200            200            0.0036469059  -8.9754831e-35  0              0.010940718    48.040946      0              2319725.4      1.1971759e-13  0              3.048822     
    800000   18000          200            200            0.0030296366  -1.7950959e-35  0              0.0090889097   9.8804434      0              477091.25      1.1971759e-13  0              3.0489596    
    900000   18000          200            200            0.002826406   -2.2438702e-35  0              0.008479218    1.7598344      0              84976.105      1.1971759e-13  0              3.0490071    
   1000000   18000          200            200            0.0027973935   2.2438717e-35  0              0.0083921806   0.17130859     0              8271.8788      1.1971759e-13  0              3.0490141    
   1100000   18000          200            200            0.0028074843   8.9754877e-36  0              0.008422453    0.0063806859   0              308.10049      1.1971759e-13  0              3.0490118    
   1200000   18000          200            200            0.0028176397  -4.487741e-36   0              0.008452919    2.9969167e-05  0              1.4471038      1.1971759e-13  0              3.0490094    
   1300000   18000          200            200            0.0028225617  -1.1219354e-36  0              0.008467685    0.00019285183  0              9.3121247      1.1971759e-13  0              3.0490083    
   1400000   18000          200            200            0.0028242477  -1.4024194e-37  0              0.008472743    6.0968211e-05  0              2.9439367      1.1971759e-13  0              3.0490079    
   1500000   18000          200            200            0.0028246349   2.8048389e-37  0              0.0084739047   8.802133e-06   0              0.4250235      1.1971759e-13  0              3.0490078    
   1600000   18000          200            200            0.0028246507  -1.1219355e-36  0              0.0084739522   6.3042811e-07  0              0.030441117    1.1971759e-13  0              3.0490078    
   1700000   18000          200            200            0.0028246095   2.8048389e-37  0              0.0084738284   9.4107864e-09  0              0.00045441319  1.1971759e-13  0              3.0490078    
   1800000   18000          200            200            0.002824582    3.9267743e-36  0              0.0084737461   2.0213947e-09  0              9.7605916e-05  1.1971759e-13  0              3.0490078    
   1900000   18000          200            200            0.0028245706   2.8048389e-37  0              0.0084737119   1.630917e-09   0              7.8751143e-05  1.1971759e-13  0              3.0490078    
   2000000   18000          200            200            0.0028245672  -5.6096774e-37  0              0.0084737017   3.5650697e-10  0              1.7214446e-05  1.1971759e-13  0              3.0490078    
   2100000   18000          200            200            0.0028245666  -1.6829033e-36  0              0.0084736999   3.9415286e-11  0              1.9032231e-06  1.1971759e-13  0              3.0490078    
   2200000   18000          200            200            0.0028245667  -5.6096774e-37  0              0.0084737002   1.8736619e-12  0              9.0472426e-08  1.1971759e-13  0              3.0490078    
   2300000   18000          200            200            0.0028245669   5.6096777e-37  0              0.0084737006   2.3216345e-16  0              1.1210342e-11  1.1971759e-13  0              3.0490078    
   2400000   18000          200            200            0.0028245669   3.6462904e-36  0              0.0084737008   2.9194232e-14  0              1.409685e-09   1.1971759e-13  0              3.0490078    
   2500000   18000          200            200            0.002824567   -8.4145162e-37  0              0.0084737009   1.1487258e-14  0              5.5467859e-10  1.1971759e-13  0              3.0490078    
   2600000   18000          200            200            0.002824567    1.0437073e-44  0              0.0084737009   1.8495265e-15  0              8.9307017e-11  1.1971759e-13  0              3.0490078    
   2700000   18000          200            200            0.002824567    1.0322314e-44  0              0.0084737009   2.2020429e-16  0              1.0632877e-11  1.1971759e-13  0              3.0490078    
   2800000   18000          200            200            0.002824567    2.8048388e-36  0              0.0084737009   3.0404251e-17  0              1.4681125e-12  1.1971759e-13  0              3.0490078    
   2900000   18000          200            200            0.002824567   -2.243871e-36   0              0.0084737009   3.7388521e-18  0              1.8053578e-13  1.1971759e-13  0              3.0490078    
   3000000   18000          200            200            0.002824567   -2.8048387e-37  0              0.0084737009   6.6382082e-19  0              3.2053532e-14  1.1971759e-13  0              3.0490078    
Loop time of 801.915 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3232262.929 ns/day, 0.000 hours/ns, 3741.045 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.69     | 240.27     | 240.84     |   3.7 | 29.96
Neigh   | 21.666     | 21.669     | 21.673     |   0.1 |  2.70
Comm    | 50.84      | 51.721     | 52.601     |  12.2 |  6.45
Output  | 0.60826    | 0.60829    | 0.60831    |   0.0 |  0.08
Modify  | 427.49     | 427.53     | 427.56     |   0.2 | 53.31
Other   |            | 60.12      |            |       |  7.50

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 169
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.11                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.6499386668908
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.21
  ghost atom cutoff = 3.21
  binsize = 1.605, bins = 11215 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 374.9 | 374.9 | 374.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.00236612    -1.7950956e-35  0              0.0070983599   1247537.2      0              6.0239108e+10  1.1971759e-13  0              3.3190725    
    200000   18000          200            200            0.00099324627 -5.3852864e-35  0              0.0029797388   393171.52      0              1.8984846e+10  1.1971759e-13  0              3.0719735    
    300000   18000          200            200            0.00031231841  7.1803926e-35  0              0.00093695524  63606.946      0              3.0713518e+09  1.1971759e-13  0              3.0766251    
    400000   18000          200            200            0.0062101513   5.8034864e-41  0              0.018630454    23853.888      0              1.1518189e+09  1.1971759e-13  0              3.0533572    
    500000   18000          200            200            5.4899454e-05  5.3852959e-35  0              0.00016469836  2756.2811      0              1.3309095e+08  1.1971759e-13  0              3.0555268    
    600000   18000          200            200            0.00041915188  1.7950989e-35  0              0.0012574556   96.516044      0              4660414.3      1.1971759e-13  0              3.0547181    
    700000   18000          200            200            0.0032795381   8.9754943e-36  0              0.0098386142   84.604981      0              4085271.7      1.1971759e-13  0              3.0539036    
    800000   18000          200            200            0.0028635673  -1.7950959e-35  0              0.0085907018   13.226078      0              638639.96      1.1971759e-13  0              3.0539995    
    900000   18000          200            200            0.0027609664   3.1414202e-35  0              0.0082828992   1.3756207      0              66423.802      1.1971759e-13  0              3.0540241    
   1000000   18000          200            200            0.0027821606  -1.3463219e-35  0              0.0083464818   0.048451555    0              2339.5522      1.1971759e-13  0              3.0540193    
   1100000   18000          200            200            0.0028102337   4.4877457e-36  0              0.0084307012   0.00061655013  0              29.770999      1.1971759e-13  0              3.0540128    
   1200000   18000          200            200            0.0028241889   4.4877432e-36  0              0.0084725667   0.0019124945   0              92.347513      1.1971759e-13  0              3.0540095    
   1300000   18000          200            200            0.0028287386   1.7950968e-35  0              0.0084862159   0.00050912514  0              24.583831      1.1971759e-13  0              3.0540085    
   1400000   18000          200            200            0.0028295871   1.4024194e-37  0              0.0084887612   5.7277358e-05  0              2.7657186      1.1971759e-13  0              3.0540083    
   1500000   18000          200            200            0.002829489    9.2147231e-45  0              0.008488467    2.2473034e-06  0              0.10851424     1.1971759e-13  0              3.0540083    
   1600000   18000          200            200            0.0028293194   5.6096776e-37  0              0.0084879582   1.2321806e-08  0              0.00059497591  1.1971759e-13  0              3.0540083    
   1700000   18000          200            200            0.0028292321  -2.8048387e-37  0              0.0084876964   6.9128462e-08  0              0.003337966    1.1971759e-13  0              3.0540083    
   1800000   18000          200            200            0.0028292029   2.8048389e-37  0              0.0084876088   1.9788567e-08  0              0.00095551908  1.1971759e-13  0              3.0540083    
   1900000   18000          200            200            0.0028291972  -2.8048387e-37  0              0.0084875915   2.3490205e-09  0              0.00011342579  1.1971759e-13  0              3.0540083    
   2000000   18000          200            200            0.0028291976  -2.243871e-36   0              0.0084875929   1.0211246e-10  0              4.9306453e-06  1.1971759e-13  0              3.0540083    
   2100000   18000          200            200            0.0028291986  -5.0487098e-36  0              0.0084875959   1.7030933e-13  0              8.2236279e-09  1.1971759e-13  0              3.0540083    
   2200000   18000          200            200            0.0028291992  -1.6548549e-35  0              0.0084875976   2.4763642e-12  0              1.1957476e-07  1.1971759e-13  0              3.0540083    
   2300000   18000          200            200            0.0028291994   1.5987581e-35  0              0.0084875981   7.6656158e-13  0              3.7014516e-08  1.1971759e-13  0              3.0540083    
   2400000   18000          200            200            0.0028291994  -3.9267743e-36  0              0.0084875982   9.5627406e-14  0              4.6175052e-09  1.1971759e-13  0              3.0540083    
   2500000   18000          200            200            0.0028291994   5.6096777e-37  0              0.0084875982   4.6748594e-15  0              2.2573223e-10  1.1971759e-13  0              3.0540083    
   2600000   18000          200            200            0.0028291994   1.0400865e-44  0              0.0084875982   8.2168676e-18  0              3.9676313e-13  1.1971759e-13  0              3.0540083    
   2700000   18000          200            200            0.0028291994   7.2925808e-36  0              0.0084875982   2.1149828e-17  0              1.0212495e-12  1.1971759e-13  0              3.0540083    
   2800000   18000          200            200            0.0028291994  -8.4145162e-37  0              0.0084875982   1.7213755e-18  0              8.3119063e-14  1.1971759e-13  0              3.0540083    
   2900000   18000          200            200            0.0028291994  -1.1219355e-36  0              0.0084875982   1.8155174e-20  0              8.7664836e-16  1.1971759e-13  0              3.0540083    
   3000000   18000          200            200            0.0028291994  -5.6096774e-37  0              0.0084875982   1.4215349e-17  0              6.8640834e-13  1.1971759e-13  0              3.0540083    
Loop time of 809.227 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3203055.578 ns/day, 0.000 hours/ns, 3707.240 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 247.15     | 247.25     | 247.36     |   0.7 | 30.55
Neigh   | 21.129     | 21.132     | 21.136     |   0.1 |  2.61
Comm    | 52.004     | 52.197     | 52.389     |   2.7 |  6.45
Output  | 0.61137    | 0.61138    | 0.6114     |   0.0 |  0.08
Modify  | 427.86     | 427.92     | 427.99     |   0.3 | 52.88
Other   |            | 60.11      |            |       |  7.43

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 173
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.12                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.9852583390075
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.22
  ghost atom cutoff = 3.22
  binsize = 1.61, bins = 11181 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 373.8 | 373.8 | 373.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.002372697    8.9754935e-36  0              0.007118091    1252184.7      0              6.0463516e+10  1.1971759e-13  0              3.3191277    
    200000   18000          200            200            0.0010032515   3.4324325e-41  0              0.0030097544   398827.18      0              1.9257937e+10  1.1971759e-13  0              3.0732279    
    300000   18000          200            200            0.00032174431 -7.1803809e-35  0              0.00096523293  66768.8        0              3.2240264e+09  1.1971759e-13  0              3.0798776    
    400000   18000          200            200            0.013048512   -1.7950904e-35  0              0.039145537    18785.499      0              9.0708454e+08  1.1971759e-13  0              3.0572779    
    500000   18000          200            200            6.3358974e-05 -1.7950911e-35  0              0.00019007692  3611.1314      0              1.7436861e+08  1.1971759e-13  0              3.0600916    
    600000   18000          200            200            0.00031283535 -8.9754643e-36  0              0.00093850605  5.6032206      0              270559.47      1.1971759e-13  0              3.0597708    
    700000   18000          200            200            0.0028579065   3.5901946e-35  0              0.0085737195   100.81351      0              4867923.5      1.1971759e-13  0              3.0590009    
    800000   18000          200            200            0.0026940141   1.7950977e-35  0              0.0080820423   11.712498      0              565554.6       1.1971759e-13  0              3.0590409    
    900000   18000          200            200            0.0027126317   4.4877501e-36  0              0.008137895    0.53743471     0              25950.799      1.1971759e-13  0              3.0590372    
   1000000   18000          200            200            0.0027812289  -2.6926445e-35  0              0.0083436866   0.0015765958   0              76.12817       1.1971759e-13  0              3.0590212    
   1100000   18000          200            200            0.0028199803   2.2438714e-35  0              0.0084599409   0.014399739    0              695.31184      1.1971759e-13  0              3.0590121    
   1200000   18000          200            200            0.0028329399   1.1219356e-35  0              0.0084988197   0.0039264017   0              189.59189      1.1971759e-13  0              3.0590091    
   1300000   18000          200            200            0.0028351524   8.1891586e-44  0              0.0085054573   0.00038471374  0              18.57645       1.1971759e-13  0              3.0590086    
   1400000   18000          200            200            0.0028346955  -5.6096775e-37  0              0.0085040866   8.0426895e-06  0              0.38835269     1.1971759e-13  0              3.0590087    
   1500000   18000          200            200            0.0028341461  -5.6096775e-37  0              0.0085024384   9.5897006e-07  0              0.046305232    1.1971759e-13  0              3.0590088    
   1600000   18000          200            200            0.0028338958   2.8048389e-37  0              0.0085016873   8.5905352e-07  0              0.04148062     1.1971759e-13  0              3.0590089    
   1700000   18000          200            200            0.0028338266   1.0642686e-44  0              0.0085014798   1.5598496e-07  0              0.0075319556   1.1971759e-13  0              3.0590089    
   1800000   18000          200            200            0.0028338204  -5.6096774e-37  0              0.0085014613   1.0243323e-08  0              0.0004946134   1.1971759e-13  0              3.0590089    
   1900000   18000          200            200            0.0028338261  -2.8048387e-37  0              0.0085014782   2.7121255e-11  0              1.3095883e-06  1.1971759e-13  0              3.0590089    
   2000000   18000          200            200            0.0028338301   5.6096777e-37  0              0.0085014902   1.0776441e-10  0              5.2035577e-06  1.1971759e-13  0              3.0590089    
   2100000   18000          200            200            0.0028338316   8.4145164e-37  0              0.0085014948   4.2948419e-11  0              2.0738254e-06  1.1971759e-13  0              3.0590089    
   2200000   18000          200            200            0.0028338319  -8.4145162e-37  0              0.0085014958   5.4735859e-12  0              2.6429987e-07  1.1971759e-13  0              3.0590089    
   2300000   18000          200            200            0.0028338319  -2.243871e-36   0              0.0085014957   2.115314e-13   0              1.0214095e-08  1.1971759e-13  0              3.0590089    
   2400000   18000          200            200            0.0028338319   2.8048389e-37  0              0.0085014956   2.2036107e-15  0              1.0640447e-10  1.1971759e-13  0              3.0590089    
   2500000   18000          200            200            0.0028338318   1.0517599e-44  0              0.0085014955   7.6979589e-15  0              3.7170688e-10  1.1971759e-13  0              3.0590089    
   2600000   18000          200            200            0.0028338318   8.4145164e-37  0              0.0085014955   1.8810529e-15  0              9.0829312e-11  1.1971759e-13  0              3.0590089    
   2700000   18000          200            200            0.0028338318   1.4024194e-36  0              0.0085014955   2.1563122e-16  0              1.041206e-11   1.1971759e-13  0              3.0590089    
   2800000   18000          200            200            0.0028338318   2.8048389e-37  0              0.0085014955   2.1862578e-17  0              1.0556657e-12  1.1971759e-13  0              3.0590089    
   2900000   18000          200            200            0.0028338318   2.8048389e-37  0              0.0085014955   7.2535521e-18  0              3.5024807e-13  1.1971759e-13  0              3.0590089    
   3000000   18000          200            200            0.0028338318  -8.4145162e-37  0              0.0085014955   1.5327848e-17  0              7.4012692e-13  1.1971759e-13  0              3.0590089    
Loop time of 796.62 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3253745.089 ns/day, 0.000 hours/ns, 3765.909 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.57     | 242.35     | 243.13     |   5.0 | 30.42
Neigh   | 19.463     | 19.466     | 19.47      |   0.1 |  2.44
Comm    | 47.602     | 48.663     | 49.724     |  15.2 |  6.11
Output  | 0.60997    | 0.60998    | 0.60999    |   0.0 |  0.08
Modify  | 426.39     | 426.57     | 426.74     |   0.9 | 53.55
Other   |            | 58.96      |            |       |  7.40

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.13                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.3227344003217
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.23
  ghost atom cutoff = 3.23
  binsize = 1.615, bins = 11146 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 367.1 | 367.1 | 367.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.002379275    1.5633415e-41  0              0.0071378251   1256838.6      0              6.0688239e+10  1.1971759e-13  0              3.3191717    
    200000   18000          200            200            0.0010132823  -5.3852869e-35  0              0.0030398468   404517.88      0              1.953272e+10   1.1971759e-13  0              3.0744522    
    300000   18000          200            200            0.00033123948 -1.0770576e-34  0              0.00099371845  70003.435      0              3.3802153e+09  1.1971759e-13  0              3.0830859    
    400000   18000          200            200            0.019830269    2.1541167e-34  0              0.059490806    10318.761      0              4.9825605e+08  1.1971759e-13  0              3.0613916    
    500000   18000          200            200            0.00080512851 -8.9754792e-35  0              0.0024153855   4494.239       0              2.1701072e+08  1.1971759e-13  0              3.0645982    
    600000   18000          200            200            0.00034555133  1.5258325e-34  0              0.001036654    27.095523      0              1308345.8      1.1971759e-13  0              3.0647592    
    700000   18000          200            200            0.0024521808   6.2828397e-35  0              0.0073565423   88.304835      0              4263924.5      1.1971759e-13  0              3.0640991    
    800000   18000          200            200            0.0025540621  -4.4877412e-35  0              0.0076621864   6.5380912      0              315701.03      1.1971759e-13  0              3.0640761    
    900000   18000          200            200            0.0026938944   4.4877504e-36  0              0.0080816833   0.013703219    0              661.6794       1.1971759e-13  0              3.0640433    
   1000000   18000          200            200            0.0027962271  -2.6926445e-35  0              0.0083886812   0.082120856    0              3965.3222      1.1971759e-13  0              3.0640193    
   1100000   18000          200            200            0.0028348304   8.9754879e-36  0              0.0085044911   0.029142692    0              1407.1963      1.1971759e-13  0              3.0640103    
   1200000   18000          200            200            0.0028420822   8.9754852e-36  0              0.0085262466   0.0029288748   0              141.42488      1.1971759e-13  0              3.0640086    
   1300000   18000          200            200            0.0028408885   1.6829033e-36  0              0.0085226654   4.4071514e-05  0              2.1280557      1.1971759e-13  0              3.0640088    
   1400000   18000          200            200            0.0028392921   4.2072582e-37  0              0.0085178763   1.2619396e-05  0              0.60934545     1.1971759e-13  0              3.0640092    
   1500000   18000          200            200            0.0028385906   8.9448348e-45  0              0.0085157717   7.7576691e-06  0              0.37459008     1.1971759e-13  0              3.0640094    
   1600000   18000          200            200            0.0028384232  -8.4145162e-37  0              0.0085152697   1.0629001e-06  0              0.051323643    1.1971759e-13  0              3.0640094    
   1700000   18000          200            200            0.0028384255  -2.8048387e-37  0              0.0085152766   3.5359979e-08  0              0.0017074068   1.1971759e-13  0              3.0640094    
   1800000   18000          200            200            0.0028384488  -3.3658065e-36  0              0.0085153465   1.1937597e-09  0              5.7642385e-05  1.1971759e-13  0              3.0640094    
   1900000   18000          200            200            0.002838461    3.6462904e-36  0              0.0085153831   1.8790034e-09  0              9.0730349e-05  1.1971759e-13  0              3.0640094    
   2000000   18000          200            200            0.0028384646   1.0621368e-44  0              0.0085153937   3.5252777e-10  0              1.7022304e-05  1.1971759e-13  0              3.0640094    
   2100000   18000          200            200            0.0028384648  -8.4145162e-37  0              0.0085153945   1.9326606e-11  0              9.3321264e-07  1.1971759e-13  0              3.0640094    
   2200000   18000          200            200            0.0028384645   5.6096777e-37  0              0.0085153936   1.1118064e-14  0              5.3685152e-10  1.1971759e-13  0              3.0640094    
   2300000   18000          200            200            0.0028384643   2.8048389e-37  0              0.008515393    4.0428334e-13  0              1.9521396e-08  1.1971759e-13  0              3.0640094    
   2400000   18000          200            200            0.0028384643  -1.6829033e-36  0              0.0085153928   1.0752447e-13  0              5.1919719e-09  1.1971759e-13  0              3.0640094    
   2500000   18000          200            200            0.0028384642  -2.8048387e-37  0              0.0085153927   8.6737788e-15  0              4.1882574e-10  1.1971759e-13  0              3.0640094    
   2600000   18000          200            200            0.0028384642  -8.4145162e-37  0              0.0085153927   1.9155894e-17  0              9.2496955e-13  1.1971759e-13  0              3.0640094    
   2700000   18000          200            200            0.0028384642  -3.0853226e-36  0              0.0085153927   1.7483252e-17  0              8.4420368e-13  1.1971759e-13  0              3.0640094    
   2800000   18000          200            200            0.0028384642  -8.4145162e-37  0              0.0085153927   8.0002419e-18  0              3.8630305e-13  1.1971759e-13  0              3.0640094    
   2900000   18000          200            200            0.0028384642   1.2402917e-44  0              0.0085153927   9.9024907e-18  0              4.7815584e-13  1.1971759e-13  0              3.0640094    
   3000000   18000          200            200            0.0028384642   1.1219355e-36  0              0.0085153927   2.6145394e-20  0              1.2624675e-15  1.1971759e-13  0              3.0640094    
Loop time of 794.521 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3262342.674 ns/day, 0.000 hours/ns, 3775.860 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.32     | 241.53     | 243.74     |  14.2 | 30.40
Neigh   | 18.95      | 18.952     | 18.955     |   0.1 |  2.39
Comm    | 46.367     | 48.882     | 51.397     |  36.0 |  6.15
Output  | 0.61033    | 0.61035    | 0.61036    |   0.0 |  0.08
Modify  | 425.81     | 425.86     | 425.92     |   0.3 | 53.60
Other   |            | 58.68      |            |       |  7.39

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.14                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.6623737623371
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.24
  ghost atom cutoff = 3.24
  binsize = 1.62, bins = 11112 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 366 | 366 | 366 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023858542   8.9754923e-36  0              0.0071575625   1261499.4      0              6.0913293e+10  1.1971759e-13  0              3.3192036    
    200000   18000          200            200            0.0010233414   3.5902e-35     0              0.0030700242   410245.38      0              1.9809281e+10  1.1971759e-13  0              3.0756448    
    300000   18000          200            200            0.00034080735 -5.3852832e-35  0              0.0010224221   73312.023      0              3.5399752e+09  1.1971759e-13  0              3.086249     
    400000   18000          200            200            0.024646895   -1.9746059e-34  0              0.073940686    2563.4889      0              1.237817e+08   1.1971759e-13  0              3.0658251    
    500000   18000          200            200            0.00269452     8.9754888e-35  0              0.0080835601   4932.7501      0              2.3818485e+08  1.1971759e-13  0              3.0690627    
    600000   18000          200            200            0.00052570542 -2.6926428e-35  0              0.0015771163   155.68172      0              7517313        1.1971759e-13  0              3.0696839    
    700000   18000          200            200            0.0021188578  -3.5901927e-35  0              0.0063565735   55.217628      0              2666261.6      1.1971759e-13  0              3.0691842    
    800000   18000          200            200            0.0024690132   9.2282039e-42  0              0.0074070397   1.4773439      0              71335.652      1.1971759e-13  0              3.0690985    
    900000   18000          200            200            0.0027101271  -4.4877412e-35  0              0.0081303812   0.27598519     0              13326.337      1.1971759e-13  0              3.0690411    
   1000000   18000          200            200            0.0028240391  -4.4877348e-36  0              0.0084721173   0.19895345     0              9606.75        1.1971759e-13  0              3.0690144    
   1100000   18000          200            200            0.0028510295  -5.3852901e-35  0              0.0085530886   0.025163555    0              1215.058       1.1971759e-13  0              3.0690081    
   1200000   18000          200            200            0.002849645   -6.2828387e-35  0              0.008548935    0.00048474618  0              23.406658      1.1971759e-13  0              3.0690084    
   1300000   18000          200            200            0.0028453854  -5.6096775e-36  0              0.0085361563   9.3496576e-05  0              4.514615       1.1971759e-13  0              3.0690094    
   1400000   18000          200            200            0.0028434002  -9.8169357e-37  0              0.0085302007   6.1178431e-05  0              2.9540875      1.1971759e-13  0              3.0690098    
   1500000   18000          200            200            0.00284295    -4.7682259e-36  0              0.0085288499   7.3456501e-06  0              0.35469516     1.1971759e-13  0              3.0690099    
   1600000   18000          200            200            0.002842982    3.0853227e-36  0              0.008528946    1.2286224e-07  0              0.005932578    1.1971759e-13  0              3.0690099    
   1700000   18000          200            200            0.0028430576   1.6829033e-36  0              0.0085291728   3.1793928e-08  0              0.001535215    1.1971759e-13  0              3.0690099    
   1800000   18000          200            200            0.0028430919   5.6096777e-37  0              0.0085292756   1.8755235e-08  0              0.00090562316  1.1971759e-13  0              3.0690099    
   1900000   18000          200            200            0.0028430994  -2.8048387e-37  0              0.0085292981   2.140685e-09   0              0.00010336602  1.1971759e-13  0              3.0690099    
   2000000   18000          200            200            0.0028430987  -5.6096774e-37  0              0.008529296    3.0605077e-11  0              1.4778096e-06  1.1971759e-13  0              3.0690099    
   2100000   18000          200            200            0.0028430973   1.0357891e-44  0              0.008529292    1.0716057e-11  0              5.1744003e-07  1.1971759e-13  0              3.0690099    
   2200000   18000          200            200            0.0028430967   8.4145164e-37  0              0.0085292902   5.741159e-12   0              2.7722002e-07  1.1971759e-13  0              3.0690099    
   2300000   18000          200            200            0.0028430966   5.6096777e-37  0              0.0085292899   6.2321272e-13  0              3.0092712e-08  1.1971759e-13  0              3.0690099    
   2400000   18000          200            200            0.0028430966   1.1219355e-36  0              0.0085292899   7.4144102e-15  0              3.5801533e-10  1.1971759e-13  0              3.0690099    
   2500000   18000          200            200            0.0028430967   1.0510715e-44  0              0.00852929     3.5057686e-15  0              1.6928102e-10  1.1971759e-13  0              3.0690099    
   2600000   18000          200            200            0.0028430967   5.6096777e-37  0              0.00852929     1.7819331e-15  0              8.604317e-11   1.1971759e-13  0              3.0690099    
   2700000   18000          200            200            0.0028430967  -2.8048387e-37  0              0.00852929     2.2315879e-16  0              1.0775539e-11  1.1971759e-13  0              3.0690099    
   2800000   18000          200            200            0.0028430967  -1.6829033e-36  0              0.00852929     1.535259e-17   0              7.4132162e-13  1.1971759e-13  0              3.0690099    
   2900000   18000          200            200            0.0028430967   1.1219355e-36  0              0.00852929     2.5575069e-18  0              1.2349286e-13  1.1971759e-13  0              3.0690099    
   3000000   18000          200            200            0.0028430967  -5.6096775e-37  0              0.00852929     4.1502498e-18  0              2.0040071e-13  1.1971759e-13  0              3.0690099    
Loop time of 801.04 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3235791.535 ns/day, 0.000 hours/ns, 3745.129 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 245.1      | 245.38     | 245.66     |   1.8 | 30.63
Neigh   | 18.818     | 18.821     | 18.825     |   0.1 |  2.35
Comm    | 46.918     | 47.557     | 48.196     |   9.3 |  5.94
Output  | 0.608      | 0.60802    | 0.60804    |   0.0 |  0.08
Modify  | 427.39     | 428.25     | 429.11     |   4.2 | 53.46
Other   |            | 60.43      |            |       |  7.54

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.15                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.0041833365577
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.25
  ghost atom cutoff = 3.25
  binsize = 1.625, bins = 11077 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 365 | 365 | 365 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023924342   8.9754966e-36  0              0.0071773025   1266166.7      0              6.1138657e+10  1.1971759e-13  0              3.3192244    
    200000   18000          200            200            0.0010334247   3.5798989e-41  0              0.003100274    416007.06      0              2.0087492e+10  1.1971759e-13  0              3.0768078    
    300000   18000          200            200            0.00035044169  8.9754894e-35  0              0.0010513251   76692.258      0              3.7031947e+09  1.1971759e-13  0              3.089368     
    400000   18000          200            200            0.026032691    3.5901997e-35  0              0.078098072    73.576569      0              3552749.2      1.1971759e-13  0              3.0706695    
    500000   18000          200            200            0.0052558662   3.5901987e-35  0              0.015767599    4525.36        0              2.1851344e+08  1.1971759e-13  0              3.0735247    
    600000   18000          200            200            0.00089429511  1.7950993e-35  0              0.0026828853   358.92542      0              17331224       1.1971759e-13  0              3.0745495    
    700000   18000          200            200            0.0018949938   1.7950979e-35  0              0.0056849814   19.981562      0              964838.1       1.1971759e-13  0              3.0742446    
    800000   18000          200            200            0.002453595   -1.7950959e-35  0              0.0073607849   0.1201599      0              5802.0914      1.1971759e-13  0              3.0741041    
    900000   18000          200            200            0.002758613    8.6519274e-42  0              0.008275839    1.0789048      0              52096.45       1.1971759e-13  0              3.0740314    
   1000000   18000          200            200            0.0028576946   8.9754914e-36  0              0.0085730837   0.2211059      0              10676.412      1.1971759e-13  0              3.0740082    
   1100000   18000          200            200            0.0028643279  -4.4877383e-36  0              0.0085929838   0.0078368985   0              378.41578      1.1971759e-13  0              3.0740066    
   1200000   18000          200            200            0.0028543557  -8.975483e-36   0              0.008563067    0.00038097477  0              18.395908      1.1971759e-13  0              3.0740089    
   1300000   18000          200            200            0.0028487175   1.6829033e-35  0              0.0085461526   0.00044075995  0              21.282721      1.1971759e-13  0              3.0740102    
   1400000   18000          200            200            0.0028473304  -7.0120969e-37  0              0.0085419911   5.6025878e-05  0              2.7052891      1.1971759e-13  0              3.0740105    
   1500000   18000          200            200            0.002847408    8.7617454e-45  0              0.008542224    6.7398745e-07  0              0.032544442    1.1971759e-13  0              3.0740105    
   1600000   18000          200            200            0.0028476278   6.1706453e-36  0              0.0085428834   3.5073662e-07  0              0.016935816    1.1971759e-13  0              3.0740104    
   1700000   18000          200            200            0.0028477229  -2.8048387e-37  0              0.0085431686   1.534349e-07   0              0.0074088224   1.1971759e-13  0              3.0740104    
   1800000   18000          200            200            0.0028477394  -5.6096774e-37  0              0.0085432183   1.2018048e-08  0              0.00058030852  1.1971759e-13  0              3.0740104    
   1900000   18000          200            200            0.0028477349   1.0248994e-44  0              0.0085432046   8.7173609e-13  0              4.2093016e-08  1.1971759e-13  0              3.0740104    
   2000000   18000          200            200            0.0028477305  -1.6829033e-36  0              0.0085431915   1.9554997e-10  0              9.4424083e-06  1.1971759e-13  0              3.0740104    
   2100000   18000          200            200            0.002847729    2.243871e-36   0              0.008543187    4.6525215e-11  0              2.2465361e-06  1.1971759e-13  0              3.0740104    
   2200000   18000          200            200            0.0028477289  -1.2060807e-35  0              0.0085431866   2.0329298e-12  0              9.8162904e-08  1.1971759e-13  0              3.0740104    
   2300000   18000          200            200            0.002847729    1.4024194e-36  0              0.008543187    4.577923e-14   0              2.2105152e-09  1.1971759e-13  0              3.0740104    
   2400000   18000          200            200            0.0028477291   2.243871e-36   0              0.0085431872   8.428655e-14   0              4.0698959e-09  1.1971759e-13  0              3.0740104    
   2500000   18000          200            200            0.0028477291   6.1706453e-36  0              0.0085431873   1.2447051e-14  0              6.0102356e-10  1.1971759e-13  0              3.0740104    
   2600000   18000          200            200            0.0028477291   8.4145164e-37  0              0.0085431873   1.5535071e-16  0              7.5013299e-12  1.1971759e-13  0              3.0740104    
   2700000   18000          200            200            0.0028477291  -1.4024194e-36  0              0.0085431873   8.7896271e-18  0              4.2441964e-13  1.1971759e-13  0              3.0740104    
   2800000   18000          200            200            0.0028477291  -2.8048387e-37  0              0.0085431873   2.6581298e-18  0              1.2835157e-13  1.1971759e-13  0              3.0740104    
   2900000   18000          200            200            0.0028477291   9.0620607e-45  0              0.0085431873   5.9297049e-18  0              2.8632423e-13  1.1971759e-13  0              3.0740104    
   3000000   18000          200            200            0.0028477291  -8.4145162e-37  0              0.0085431873   1.9723827e-19  0              9.5239301e-15  1.1971759e-13  0              3.0740104    
Loop time of 795.417 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3258666.806 ns/day, 0.000 hours/ns, 3771.605 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.71     | 240.78     | 241.85     |   6.9 | 30.27
Neigh   | 18.648     | 18.651     | 18.653     |   0.1 |  2.34
Comm    | 46.955     | 47.674     | 48.393     |  10.4 |  5.99
Output  | 0.60871    | 0.60872    | 0.60873    |   0.0 |  0.08
Modify  | 427.88     | 428.09     | 428.3      |   1.0 | 53.82
Other   |            | 59.62      |            |       |  7.50

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.16                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.3481700344871
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.26
  ghost atom cutoff = 3.26
  binsize = 1.63, bins = 11043 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 358.5 | 358.5 | 358.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0023990151   2.6926463e-35  0              0.0071970453   1270840.5      0              6.1364342e+10  1.1971759e-13  0              3.3192335    
    200000   18000          200            200            0.0096009682  -7.1803828e-35  0              0.028802905    416849.09      0              2.0128151e+10  1.1971759e-13  0              3.0779428    
    300000   18000          200            200            0.00036014678  7.6179245e-41  0              0.0010804404   80145.649      0              3.8699466e+09  1.1971759e-13  0              3.092442     
    400000   18000          200            200            0.023532916   -1.7950908e-35  0              0.070598749    4396.8212      0              2.1230676e+08  1.1971759e-13  0              3.0759516    
    500000   18000          200            200            0.0080327017  -1.7950919e-35  0              0.024098105    3237.7407      0              1.5633891e+08  1.1971759e-13  0              3.0780372    
    600000   18000          200            200            0.001491341   -8.9754615e-36  0              0.004474023    575.28188      0              27778303       1.1971759e-13  0              3.0793653    
    700000   18000          200            200            0.001799349   -5.3852894e-35  0              0.0053980471   0.87327862     0              42167.499      1.1971759e-13  0              3.0792723    
    800000   18000          200            200            0.002510977    9.1632833e-42  0              0.007532931    3.3887201      0              163629.16      1.1971759e-13  0              3.079092     
    900000   18000          200            200            0.0028291149   2.0643614e-34  0              0.0084873447   1.6870134      0              81459.839      1.1971759e-13  0              3.0790166    
   1000000   18000          200            200            0.0028884288  -3.5901929e-35  0              0.0086652864   0.12402015     0              5988.489       1.1971759e-13  0              3.0790027    
   1100000   18000          200            200            0.0028715533   3.6722661e-42  0              0.0086146599   0.00018690662  0              9.0250517      1.1971759e-13  0              3.0790065    
   1200000   18000          200            200            0.0028561903  -1.1219354e-35  0              0.0085685708   0.0027495366   0              132.76528      1.1971759e-13  0              3.07901      
   1300000   18000          200            200            0.002851549    2.8048388e-36  0              0.0085546471   0.00046855847  0              22.625012      1.1971759e-13  0              3.0790111    
   1400000   18000          200            200            0.0028514942   3.6462904e-36  0              0.0085544825   7.7147018e-06  0              0.37251534     1.1971759e-13  0              3.0790111    
   1500000   18000          200            200            0.0028520806   8.8704831e-45  0              0.0085562418   2.5846411e-06  0              0.12480307     1.1971759e-13  0              3.079011     
   1600000   18000          200            200            0.0028523501   1.1219355e-36  0              0.0085570502   1.17627e-06    0              0.056797869    1.1971759e-13  0              3.0790109    
   1700000   18000          200            200            0.0028523934   1.0292563e-44  0              0.0085571801   7.4704072e-08  0              0.0036071923   1.1971759e-13  0              3.0790109    
   1800000   18000          200            200            0.0028523773   8.4145164e-37  0              0.0085571318   4.2274386e-10  0              2.0412788e-05  1.1971759e-13  0              3.0790109    
   1900000   18000          200            200            0.0028523644  -1.1219355e-36  0              0.0085570931   2.0408996e-09  0              9.8547735e-05  1.1971759e-13  0              3.0790109    
   2000000   18000          200            200            0.0028523607   1.0324177e-44  0              0.0085570821   3.0605581e-10  0              1.477834e-05   1.1971759e-13  0              3.0790109    
   2100000   18000          200            200            0.0028523608   1.0326394e-44  0              0.0085570823   3.5199167e-12  0              1.6996418e-07  1.1971759e-13  0              3.0790109    
   2200000   18000          200            200            0.0028523613   1.6829033e-36  0              0.0085570838   2.1453926e-12  0              1.0359333e-07  1.1971759e-13  0              3.0790109    
   2300000   18000          200            200            0.0028523615  -8.4145162e-37  0              0.0085570845   8.1319863e-13  0              3.9266451e-08  1.1971759e-13  0              3.0790109    
   2400000   18000          200            200            0.0028523615   1.1219355e-36  0              0.0085570846   4.4180993e-14  0              2.133342e-09   1.1971759e-13  0              3.0790109    
   2500000   18000          200            200            0.0028523615   2.8048389e-37  0              0.0085570846   5.9259774e-16  0              2.8614424e-11  1.1971759e-13  0              3.0790109    
   2600000   18000          200            200            0.0028523615  -1.6829033e-36  0              0.0085570845   1.5794403e-15  0              7.626552e-11   1.1971759e-13  0              3.0790109    
   2700000   18000          200            200            0.0028523615  -2.8048387e-37  0              0.0085570845   2.347321e-16   0              1.1334373e-11  1.1971759e-13  0              3.0790109    
   2800000   18000          200            200            0.0028523615   2.8048389e-37  0              0.0085570845   2.0540705e-17  0              9.9183715e-13  1.1971759e-13  0              3.0790109    
   2900000   18000          200            200            0.0028523615   1.1916329e-44  0              0.0085570845   2.5454769e-19  0              1.2291197e-14  1.1971759e-13  0              3.0790109    
   3000000   18000          200            200            0.0028523615   1.4024194e-36  0              0.0085570845   1.1539487e-17  0              5.5720051e-13  1.1971759e-13  0              3.0790109    
Loop time of 790.491 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3278974.280 ns/day, 0.000 hours/ns, 3795.109 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 236.08     | 238.69     | 241.31     |  16.9 | 30.20
Neigh   | 18.149     | 18.151     | 18.154     |   0.1 |  2.30
Comm    | 44.485     | 47.361     | 50.237     |  41.8 |  5.99
Output  | 0.61372    | 0.61373    | 0.61374    |   0.0 |  0.08
Modify  | 427.48     | 427.5      | 427.51     |   0.1 | 54.08
Other   |            | 58.18      |            |       |  7.36

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.17                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.6943407676294
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.27
  ghost atom cutoff = 3.27
  binsize = 1.635, bins = 11010 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 357.4 | 357.4 | 357.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.002405597   -3.5901913e-35  0              0.0072167909   1275521.1      0              6.159035e+10   1.1971759e-13  0              3.3192309    
    200000   18000          200            200            0.041704477    5.3852937e-35  0              0.12511343     360887.64      0              1.7425973e+10  1.1971759e-13  0              3.0791802    
    300000   18000          200            200            0.00036992085  5.3852945e-35  0              0.0011097625   83671.505      0              4.0401975e+09  1.1971759e-13  0              3.0954709    
    400000   18000          200            200            0.017896471    3.5901997e-35  0              0.053689412    12806.043      0              6.1835799e+08  1.1971759e-13  0              3.0816259    
    500000   18000          200            200            0.010450158   -1.2565673e-34  0              0.031350473    1544.8418      0              74594883       1.1971759e-13  0              3.0826588    
    600000   18000          200            200            0.0023204777  -8.9754636e-36  0              0.0069614332   723.20961      0              34921204       1.1971759e-13  0              3.0841464    
    700000   18000          200            200            0.0018385702   1.0220062e-41  0              0.0055157107   7.3571431      0              355250.11      1.1971759e-13  0              3.0842639    
    800000   18000          200            200            0.0026327586  -7.1803863e-35  0              0.0078982758   8.9366768      0              431520.14      1.1971759e-13  0              3.0840646    
    900000   18000          200            200            0.0029058724   1.7950977e-35  0              0.0087176171   1.5415955      0              74438.131      1.1971759e-13  0              3.0840005    
   1000000   18000          200            200            0.0029082847  -1.3463219e-35  0              0.008724854    0.016385296    0              791.18732      1.1971759e-13  0              3.0839997    
   1100000   18000          200            200            0.0028717687   4.4877456e-36  0              0.008615306    0.012208086    0              589.4848       1.1971759e-13  0              3.084008     
   1200000   18000          200            200            0.0028563711  -4.4877411e-36  0              0.0085691132   0.0039164033   0              189.1091       1.1971759e-13  0              3.0840116    
   1300000   18000          200            200            0.0028547921   3.9267743e-36  0              0.0085643763   0.00012949541  0              6.2528697      1.1971759e-13  0              3.0840119    
   1400000   18000          200            200            0.0028561638   2.8048388e-37  0              0.0085684915   1.2430649e-05  0              0.60023155     1.1971759e-13  0              3.0840116    
   1500000   18000          200            200            0.00285694    -8.4145162e-37  0              0.0085708201   8.7513939e-06  0              0.42257349     1.1971759e-13  0              3.0840114    
   1600000   18000          200            200            0.0028570809  -8.4145162e-37  0              0.0085712427   5.7897866e-07  0              0.027956807    1.1971759e-13  0              3.0840114    
   1700000   18000          200            200            0.002857037   -5.6096774e-37  0              0.0085711111   5.5267795e-09  0              0.0002668684   1.1971759e-13  0              3.0840114    
   1800000   18000          200            200            0.0028570003  -8.4145162e-37  0              0.008571001    1.7149005e-08  0              0.00082806409  1.1971759e-13  0              3.0840114    
   1900000   18000          200            200            0.0028569909  -1.1219355e-36  0              0.0085709727   1.9752059e-09  0              9.5375623e-05  1.1971759e-13  0              3.0840114    
   2000000   18000          200            200            0.0028569918   5.6096777e-37  0              0.0085709755   1.36051e-12    0              6.5694159e-08  1.1971759e-13  0              3.0840114    
   2100000   18000          200            200            0.0028569934   2.8048389e-37  0              0.0085709803   2.8818964e-11  0              1.3915646e-06  1.1971759e-13  0              3.0840114    
   2200000   18000          200            200            0.002856994   -2.8048387e-37  0              0.008570982    5.6494358e-12  0              2.7279104e-07  1.1971759e-13  0              3.0840114    
   2300000   18000          200            200            0.002856994    2.8048389e-37  0              0.008570982    7.7255694e-14  0              3.730401e-09   1.1971759e-13  0              3.0840114    
   2400000   18000          200            200            0.0028569939   1.0425032e-44  0              0.0085709818   3.943115e-14   0              1.9039891e-09  1.1971759e-13  0              3.0840114    
   2500000   18000          200            200            0.0028569939  -1.1219355e-36  0              0.0085709818   1.4082875e-14  0              6.8001164e-10  1.1971759e-13  0              3.0840114    
   2600000   18000          200            200            0.0028569939  -8.4145162e-37  0              0.0085709817   4.4728436e-16  0              2.1597761e-11  1.1971759e-13  0              3.0840114    
   2700000   18000          200            200            0.0028569939  -1.1219355e-36  0              0.0085709818   2.7949524e-18  0              1.3495825e-13  1.1971759e-13  0              3.0840114    
   2800000   18000          200            200            0.0028569939  -2.8048387e-37  0              0.0085709818   7.66059e-18    0              3.6990248e-13  1.1971759e-13  0              3.0840114    
   2900000   18000          200            200            0.0028569939  -5.6096774e-37  0              0.0085709818   7.6004108e-18  0              3.6699664e-13  1.1971759e-13  0              3.0840114    
   3000000   18000          200            200            0.0028569939   1.1219355e-36  0              0.0085709818   1.3202258e-18  0              6.3748977e-14  1.1971759e-13  0              3.0840114    
Loop time of 795.367 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3258873.408 ns/day, 0.000 hours/ns, 3771.844 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.11     | 240.95     | 241.78     |   5.4 | 30.29
Neigh   | 18.774     | 18.777     | 18.78      |   0.1 |  2.36
Comm    | 46.572     | 47.697     | 48.823     |  16.3 |  6.00
Output  | 0.6107     | 0.61073    | 0.61075    |   0.0 |  0.08
Modify  | 426.53     | 426.62     | 426.71     |   0.4 | 53.64
Other   |            | 60.72      |            |       |  7.63

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.18                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.0427024474883
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.28
  ghost atom cutoff = 3.28
  binsize = 1.64, bins = 10976 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 351 | 351 | 351 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024121796   1.866398e-41   0              0.0072365388   1280208.1      0              6.1816667e+10  1.1971759e-13  0              3.3192171    
    200000   18000          200            200            0.080397212   -1.2565673e-34  0              0.24119164     229291.58      0              1.107167e+10   1.1971759e-13  0              3.0809069    
    300000   18000          200            200            0.00037976153  1.7951022e-35  0              0.0011392846   87268.887      0              4.2139022e+09  1.1971759e-13  0              3.0984552    
    400000   18000          200            200            0.010784701    4.4877427e-34  0              0.032354102    20453.042      0              9.8760419e+08  1.1971759e-13  0              3.0875875    
    500000   18000          200            200            0.011944575    3.5901983e-35  0              0.035833725    264.29627      0              12761921       1.1971759e-13  0              3.0874401    
    600000   18000          200            200            0.0033262443   8.9755062e-36  0              0.0099787328   731.22484      0              35308230       1.1971759e-13  0              3.0889139    
    700000   18000          200            200            0.002010742    8.9754951e-36  0              0.006032226    36.026799      0              1739605.2      1.1971759e-13  0              3.0892207    
    800000   18000          200            200            0.0027992696   9.7468217e-42  0              0.0083978089   12.764704      0              616361.86      1.1971759e-13  0              3.0890272    
    900000   18000          200            200            0.0029711519   8.5185232e-42  0              0.0089134557   0.77452975     0              37399.27       1.1971759e-13  0              3.0889871    
   1000000   18000          200            200            0.0029126141   2.6926459e-35  0              0.0087378423   0.017967477    0              867.58517      1.1971759e-13  0              3.0890002    
   1100000   18000          200            200            0.0028666112   2.6926456e-35  0              0.0085998337   0.027816733    0              1343.1705      1.1971759e-13  0              3.0890107    
   1200000   18000          200            200            0.0028568238  -1.3463225e-35  0              0.0085704713   0.0020946247   0              101.14193      1.1971759e-13  0              3.089013     
   1300000   18000          200            200            0.0028591441  -2.2999678e-35  0              0.0085774322   2.079661e-05   0              1.0041939      1.1971759e-13  0              3.0890125    
   1400000   18000          200            200            0.0028613154   1.4024194e-37  0              0.0085839462   6.0196063e-05  0              2.9066525      1.1971759e-13  0              3.089012     
   1500000   18000          200            200            0.002861835    9.4428338e-45  0              0.0085855051   5.509111e-06   0              0.26601525     1.1971759e-13  0              3.0890119    
   1600000   18000          200            200            0.0028617465  -8.4145162e-37  0              0.0085852396   1.6823414e-08  0              0.00081234245  1.1971759e-13  0              3.0890119    
   1700000   18000          200            200            0.0028616445  -2.8048387e-37  0              0.0085849336   1.2834931e-07  0              0.0061975286   1.1971759e-13  0              3.0890119    
   1800000   18000          200            200            0.0028616174   1.9633872e-36  0              0.0085848523   1.4167672e-08  0              0.0006841062   1.1971759e-13  0              3.0890119    
   1900000   18000          200            200            0.0028616205  -2.8048387e-37  0              0.0085848616   3.7802802e-12  0              1.825362e-07   1.1971759e-13  0              3.0890119    
   2000000   18000          200            200            0.0028616253   1.2902258e-35  0              0.0085848759   2.6921727e-10  0              1.2999539e-05  1.1971759e-13  0              3.0890119    
   2100000   18000          200            200            0.0028616267  -2.8048387e-37  0              0.0085848801   3.5724616e-11  0              1.7250138e-06  1.1971759e-13  0              3.0890119    
   2200000   18000          200            200            0.0028616266  -2.8048387e-37  0              0.0085848798   1.2461354e-14  0              6.0171418e-10  1.1971759e-13  0              3.0890119    
   2300000   18000          200            200            0.0028616264   1.0288567e-44  0              0.0085848792   5.54434e-13    0              2.6771634e-08  1.1971759e-13  0              3.0890119    
   2400000   18000          200            200            0.0028616263  -1.6829033e-36  0              0.0085848789   8.8385245e-14  0              4.2678072e-09  1.1971759e-13  0              3.0890119    
   2500000   18000          200            200            0.0028616263   1.6829033e-36  0              0.008584879    2.1887794e-16  0              1.0568833e-11  1.1971759e-13  0              3.0890119    
   2600000   18000          200            200            0.0028616263  -1.9633871e-36  0              0.008584879    1.1905309e-15  0              5.7486478e-11  1.1971759e-13  0              3.0890119    
   2700000   18000          200            200            0.0028616263   1.1219355e-36  0              0.008584879    2.3219584e-16  0              1.1211906e-11  1.1971759e-13  0              3.0890119    
   2800000   18000          200            200            0.0028616263  -5.6096774e-37  0              0.008584879    9.0538245e-18  0              4.3717678e-13  1.1971759e-13  0              3.0890119    
   2900000   18000          200            200            0.0028616263  -2.8048387e-37  0              0.008584879    2.7163165e-18  0              1.311612e-13   1.1971759e-13  0              3.0890119    
   3000000   18000          200            200            0.0028616263  -1.4024194e-36  0              0.008584879    6.010844e-18   0              2.9024214e-13  1.1971759e-13  0              3.0890119    
Loop time of 797.856 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3248706.180 ns/day, 0.000 hours/ns, 3760.077 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 244.65     | 244.9      | 245.14     |   1.5 | 30.69
Neigh   | 18.442     | 18.445     | 18.448     |   0.1 |  2.31
Comm    | 46.959     | 47.39      | 47.821     |   6.3 |  5.94
Output  | 0.61034    | 0.61035    | 0.61036    |   0.0 |  0.08
Modify  | 426.6      | 426.72     | 426.83     |   0.6 | 53.48
Other   |            | 59.8       |            |       |  7.49

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.19                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.3932619855676
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.29
  ghost atom cutoff = 3.29
  binsize = 1.645, bins = 10943 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 350 | 350 | 350 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024187632  -1.7950957e-35  0              0.0072562896   1284902        0              6.2043317e+10  1.1971759e-13  0              3.319191     
    200000   18000          200            200            0.1124115     -1.4360769e-34  0              0.33723451     78358.456      0              3.7836494e+09  1.1971759e-13  0              3.0835996    
    300000   18000          200            200            0.000389672    2.8721555e-34  0              0.001169016    90938.975      0              4.3911177e+09  1.1971759e-13  0              3.101394     
    400000   18000          200            200            0.0041740927   1.2565687e-34  0              0.012522278    23905.389      0              1.1543057e+09  1.1971759e-13  0              3.0937036    
    500000   18000          200            200            0.012138067   -1.795092e-35   0              0.0364142      83.67741       0              4040482.7      1.1971759e-13  0              3.0924128    
    600000   18000          200            200            0.00438858     3.5901956e-35  0              0.01316574     579.26231      0              27970504       1.1971759e-13  0              3.093693     
    700000   18000          200            200            0.0023041933   6.2828401e-35  0              0.00691258     72.113239      0              3482090.2      1.1971759e-13  0              3.0941484    
    800000   18000          200            200            0.002981297    1.7950978e-35  0              0.0089438911   12.044313      0              581576.78      1.1971759e-13  0              3.093987     
    900000   18000          200            200            0.0030096726  -8.9754756e-36  0              0.0090290177   0.091602561    0              4423.1598      1.1971759e-13  0              3.0939798    
   1000000   18000          200            200            0.0029015358   6.7349809e-42  0              0.0087046074   0.12585105     0              6076.8969      1.1971759e-13  0              3.0940043    
   1100000   18000          200            200            0.0028596574  -1.7950965e-35  0              0.0085789723   0.02639766     0              1274.6485      1.1971759e-13  0              3.0940139    
   1200000   18000          200            200            0.0028593408   2.2438721e-36  0              0.0085780224   8.8354773e-05  0              4.2663358      1.1971759e-13  0              3.094014     
   1300000   18000          200            200            0.0028647412   1.1219356e-36  0              0.0085942235   0.00032951477  0              15.911089      1.1971759e-13  0              3.0940128    
   1400000   18000          200            200            0.0028666466   4.2072582e-37  0              0.0085999399   5.6166522e-05  0              2.7120803      1.1971759e-13  0              3.0940123    
   1500000   18000          200            200            0.0028665922   5.6096776e-37  0              0.0085997766   3.7288846e-08  0              0.0018005449   1.1971759e-13  0              3.0940124    
   1600000   18000          200            200            0.0028663226   1.0166033e-44  0              0.0085989678   8.4641912e-07  0              0.04087055     1.1971759e-13  0              3.0940124    
   1700000   18000          200            200            0.0028662369   1.9633872e-36  0              0.0085987106   1.1730036e-07  0              0.0056640144   1.1971759e-13  0              3.0940124    
   1800000   18000          200            200            0.0028662428  -2.243871e-36   0              0.0085987284   9.449884e-12   0              4.5630108e-07  1.1971759e-13  0              3.0940124    
   1900000   18000          200            200            0.0028662561   5.6096777e-37  0              0.0085987684   2.1292316e-09  0              0.00010281297  1.1971759e-13  0              3.0940124    
   2000000   18000          200            200            0.0028662599   1.0517414e-44  0              0.0085987798   2.4018571e-10  0              1.1597708e-05  1.1971759e-13  0              3.0940124    
   2100000   18000          200            200            0.0028662595  -5.6096774e-37  0              0.0085987785   5.364423e-13   0              2.5902879e-08  1.1971759e-13  0              3.0940124    
   2200000   18000          200            200            0.0028662588  -1.1219355e-36  0              0.0085987765   5.253005e-12   0              2.5364881e-07  1.1971759e-13  0              3.0940124    
   2300000   18000          200            200            0.0028662587  -2.8048387e-37  0              0.008598776    4.7974276e-13  0              2.3165061e-08  1.1971759e-13  0              3.0940124    
   2400000   18000          200            200            0.0028662587   1.6829033e-36  0              0.0085987761   3.8524345e-15  0              1.8602028e-10  1.1971759e-13  0              3.0940124    
   2500000   18000          200            200            0.0028662587   2.8048389e-37  0              0.0085987762   1.2705629e-14  0              6.1350935e-10  1.1971759e-13  0              3.0940124    
   2600000   18000          200            200            0.0028662587  -8.4145162e-37  0              0.0085987762   8.9633801e-16  0              4.3280955e-11  1.1971759e-13  0              3.0940124    
   2700000   18000          200            200            0.0028662587   1.4024194e-36  0              0.0085987762   1.9584496e-19  0              9.456652e-15   1.1971759e-13  0              3.0940124    
   2800000   18000          200            200            0.0028662587   1.0307113e-44  0              0.0085987762   1.4965253e-17  0              7.226185e-13   1.1971759e-13  0              3.0940124    
   2900000   18000          200            200            0.0028662587  -2.8048387e-37  0              0.0085987762   8.7818492e-19  0              4.2404407e-14  1.1971759e-13  0              3.0940124    
   3000000   18000          200            200            0.0028662587  -1.1219355e-36  0              0.0085987762   3.1207274e-21  0              1.5068876e-16  1.1971759e-13  0              3.0940124    
Loop time of 797.914 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3248469.397 ns/day, 0.000 hours/ns, 3759.803 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.79     | 242.48     | 244.18     |  10.9 | 30.39
Neigh   | 18.985     | 18.988     | 18.991     |   0.1 |  2.38
Comm    | 47.61      | 49.012     | 50.414     |  20.0 |  6.14
Output  | 0.61388    | 0.6139     | 0.61391    |   0.0 |  0.08
Modify  | 426.31     | 426.48     | 426.65     |   0.8 | 53.45
Other   |            | 60.34      |            |       |  7.56

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.2                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.7460262933712
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.3
  ghost atom cutoff = 3.3
  binsize = 1.65, bins = 10910 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 349 | 349 | 349 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024253474   1.7950979e-35  0              0.0072760423   1289602.1      0              6.227027e+10   1.1971759e-13  0              3.319154     
    200000   18000          200            200            0.12652452    -7.1803814e-35  0              0.37957355     941.5431       0              45463747       1.1971759e-13  0              3.0876566    
    300000   18000          200            200            0.00039964671  5.385296e-35   0              0.0011989401   94679.572      0              4.5717377e+09  1.1971759e-13  0              3.1042883    
    400000   18000          200            200            3.7792463e-05  6.0079591e-41  0              0.00011337739  23039.636      0              1.1125016e+09  1.1971759e-13  0              3.0998495    
    500000   18000          200            200            0.010972962   -1.7950924e-35  0              0.032918887    1100.4437      0              53136490       1.1971759e-13  0              3.0975814    
    600000   18000          200            200            0.00533798    -6.2828369e-35  0              0.01601394     325.92298      0              15737654       1.1971759e-13  0              3.0985108    
    700000   18000          200            200            0.0026915732  -8.9754719e-36  0              0.0080747196   96.110619      0              4640837.8      1.1971759e-13  0              3.0990569    
    800000   18000          200            200            0.0031440884  -8.9754741e-36  0              0.0094322653   7.2441807      0              349795.56      1.1971759e-13  0              3.0989519    
    900000   18000          200            200            0.0030127418  -1.3463218e-35  0              0.0090382253   0.12079518     0              5832.767       1.1971759e-13  0              3.0989806    
   1000000   18000          200            200            0.0028798824  -3.1414188e-35  0              0.0086396473   0.21902958     0              10576.155      1.1971759e-13  0              3.0990108    
   1100000   18000          200            200            0.002855104   -8.9754805e-36  0              0.008565312    0.0099164078   0              478.82785      1.1971759e-13  0              3.0990165    
   1200000   18000          200            200            0.0028648194   4.4877431e-36  0              0.0085944581   0.00095057812  0              45.900015      1.1971759e-13  0              3.0990143    
   1300000   18000          200            200            0.0028710963   3.3658066e-36  0              0.008613289    0.00051217318  0              24.73101       1.1971759e-13  0              3.0990129    
   1400000   18000          200            200            0.002871754   -2.8048388e-37  0              0.0086152619   8.5355526e-06  0              0.41215129     1.1971759e-13  0              3.0990127    
   1500000   18000          200            200            0.0028711302   8.4145164e-37  0              0.0086133907   4.3179745e-06  0              0.20849954     1.1971759e-13  0              3.0990129    
   1600000   18000          200            200            0.0028708513   1.4024194e-36  0              0.008612554    1.0517663e-06  0              0.050786032    1.1971759e-13  0              3.0990129    
   1700000   18000          200            200            0.0028708474   2.8048389e-37  0              0.0086125422   1.8327622e-09  0              8.8497526e-05  1.1971759e-13  0              3.0990129    
   1800000   18000          200            200            0.0028708829  -2.8048387e-37  0              0.0086126487   1.4834422e-08  0              0.00071630114  1.1971759e-13  0              3.0990129    
   1900000   18000          200            200            0.0028708944  -1.1219355e-36  0              0.0086126831   1.8667834e-09  0              9.0140287e-05  1.1971759e-13  0              3.0990129    
   2000000   18000          200            200            0.0028708932   5.6096777e-37  0              0.0086126797   7.3141096e-12  0              3.5317218e-07  1.1971759e-13  0              3.0990129    
   2100000   18000          200            200            0.0028708914   1.0208156e-44  0              0.0086126741   4.2548274e-11  0              2.0545039e-06  1.1971759e-13  0              3.0990129    
   2200000   18000          200            200            0.0028708909  -2.8048387e-37  0              0.0086126728   2.7385416e-12  0              1.3223437e-07  1.1971759e-13  0              3.0990129    
   2300000   18000          200            200            0.0028708911  -1.4024194e-36  0              0.0086126732   1.2061151e-13  0              5.8238984e-09  1.1971759e-13  0              3.0990129    
   2400000   18000          200            200            0.0028708911  -2.8048387e-37  0              0.0086126734   1.0600485e-13  0              5.1185947e-09  1.1971759e-13  0              3.0990129    
   2500000   18000          200            200            0.0028708912   2.8048389e-37  0              0.0086126735   2.9477255e-15  0              1.4233512e-10  1.1971759e-13  0              3.0990129    
   2600000   18000          200            200            0.0028708911   2.243871e-35   0              0.0086126734   8.0016779e-16  0              3.8637239e-11  1.1971759e-13  0              3.0990129    
   2700000   18000          200            200            0.0028708911   5.6096777e-37  0              0.0086126734   2.4066203e-16  0              1.1620708e-11  1.1971759e-13  0              3.0990129    
   2800000   18000          200            200            0.0028708911  -5.6096774e-37  0              0.0086126734   1.9194266e-17  0              9.268224e-13   1.1971759e-13  0              3.0990129    
   2900000   18000          200            200            0.0028708911   1.0689051e-44  0              0.0086126734   1.0661994e-17  0              5.1482954e-13  1.1971759e-13  0              3.0990129    
   3000000   18000          200            200            0.0028708911  -3.3658065e-36  0              0.0086126734   1.0780758e-17  0              5.2056421e-13  1.1971759e-13  0              3.0990129    
Loop time of 796.459 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3254404.606 ns/day, 0.000 hours/ns, 3766.672 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.67     | 241.31     | 243.94     |  16.9 | 30.30
Neigh   | 18.916     | 18.919     | 18.922     |   0.1 |  2.38
Comm    | 46.653     | 49.526     | 52.399     |  40.8 |  6.22
Output  | 0.60809    | 0.6081     | 0.60811    |   0.0 |  0.08
Modify  | 426.14     | 426.25     | 426.36     |   0.5 | 53.52
Other   |            | 59.85      |            |       |  7.51

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.21                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.1010022824028
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.31
  ghost atom cutoff = 3.31
  binsize = 1.655, bins = 10877 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 342.7 | 342.7 | 342.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024319325   1.7950983e-35  0              0.0072957975   1294309        0              6.2497549e+10  1.1971759e-13  0              3.3191049    
    200000   18000          200            200            0.11751961     1.7951007e-35  0              0.35255883     50232.411      0              2.4255434e+09  1.1971759e-13  0              3.0932548    
    300000   18000          200            200            0.00040968948 -3.5901889e-35  0              0.0012290684   98492.14       0              4.755833e+09   1.1971759e-13  0              3.1071371    
    400000   18000          200            200           -0.00012694318  5.385297e-35   0             -0.00038082953  20727.581      0              1.0008607e+09  1.1971759e-13  0              3.1059508    
    500000   18000          200            200            0.0087357473  -1.7950917e-35  0              0.026207242    2749.7144      0              1.3277387e+08  1.1971759e-13  0              3.1029219    
    600000   18000          200            200            0.0059969042  -1.7950951e-35  0              0.017990713    92.243635      0              4454115        1.1971759e-13  0              3.1033912    
    700000   18000          200            200            0.0031258284   3.5901948e-35  0              0.0093774851   93.911814      0              4534665.4      1.1971759e-13  0              3.1039592    
    800000   18000          200            200            0.0032546575  -8.9754746e-36  0              0.0097639725   1.9071122      0              92087.624      1.1971759e-13  0              3.1039288    
    900000   18000          200            200            0.0029807871   4.48775e-36    0              0.0089423614   0.82818459     0              39990.07       1.1971759e-13  0              3.1039893    
   1000000   18000          200            200            0.0028556111  -1.3463219e-35  0              0.0085668334   0.19434222     0              9384.0901      1.1971759e-13  0              3.1040179    
   1100000   18000          200            200            0.0028562396  -5.0711485e-34  0              0.0085687188   1.2777835e-06  0              0.061699594    1.1971759e-13  0              3.1040178    
   1200000   18000          200            200            0.002872889    8.9754852e-36  0              0.0086186671   0.0033378783   0              161.1742       1.1971759e-13  0              3.104014     
   1300000   18000          200            200            0.002877349   -1.1219354e-36  0              0.008632047    0.00025089105  0              12.114631      1.1971759e-13  0              3.104013     
   1400000   18000          200            200            0.0028763658   9.8169357e-37  0              0.0086290975   1.0929404e-05  0              0.52774179     1.1971759e-13  0              3.1040132    
   1500000   18000          200            200            0.0028755119  -8.4145162e-37  0              0.0086265358   8.8950971e-06  0              0.4295124      1.1971759e-13  0              3.1040134    
   1600000   18000          200            200            0.0028754095   8.4145164e-37  0              0.0086262286   1.4029907e-07  0              0.0067745398   1.1971759e-13  0              3.1040135    
   1700000   18000          200            200            0.0028754941  -5.6096774e-37  0              0.0086264824   8.4627228e-08  0              0.004086346    1.1971759e-13  0              3.1040134    
   1800000   18000          200            200            0.0028755306  -5.6096774e-37  0              0.0086265917   1.6457235e-08  0              0.000794661    1.1971759e-13  0              3.1040134    
   1900000   18000          200            200            0.0028755293  -3.0853226e-36  0              0.008626588    1.2001147e-11  0              5.7949244e-07  1.1971759e-13  0              3.1040134    
   2000000   18000          200            200            0.0028755242  -1.4024194e-36  0              0.0086265726   3.1782872e-10  0              1.5346811e-05  1.1971759e-13  0              3.1040134    
   2100000   18000          200            200            0.002875523    1.6829033e-36  0              0.0086265689   1.9215337e-11  0              9.2783985e-07  1.1971759e-13  0              3.1040134    
   2200000   18000          200            200            0.0028755233   2.8048389e-37  0              0.0086265699   1.3352067e-12  0              6.4472354e-08  1.1971759e-13  0              3.1040134    
   2300000   18000          200            200            0.0028755236  -8.4145162e-37  0              0.0086265707   7.9188207e-13  0              3.8237151e-08  1.1971759e-13  0              3.1040134    
   2400000   18000          200            200            0.0028755236   2.6365484e-35  0              0.0086265708   8.0657768e-15  0              3.894675e-10   1.1971759e-13  0              3.1040134    
   2500000   18000          200            200            0.0028755236   8.4145164e-37  0              0.0086265707   8.5885608e-15  0              4.1471086e-10  1.1971759e-13  0              3.1040134    
   2600000   18000          200            200            0.0028755235   5.6096776e-37  0              0.0086265706   1.3765852e-15  0              6.6470374e-11  1.1971759e-13  0              3.1040134    
   2700000   18000          200            200            0.0028755235   5.6096777e-37  0              0.0086265706   1.6262385e-18  0              7.8525238e-14  1.1971759e-13  0              3.1040134    
   2800000   18000          200            200            0.0028755235   1.1219355e-36  0              0.0086265706   1.731317e-17   0              8.3599103e-13  1.1971759e-13  0              3.1040134    
   2900000   18000          200            200            0.0028755236   5.6096776e-37  0              0.0086265707   4.0631973e-20  0              1.9619725e-15  1.1971759e-13  0              3.1040134    
   3000000   18000          200            200            0.0028755236  -1.1219355e-36  0              0.0086265707   7.0039038e-19  0              3.3819345e-14  1.1971759e-13  0              3.1040134    
Loop time of 797.063 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3251936.754 ns/day, 0.000 hours/ns, 3763.816 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.57     | 243.13     | 243.68     |   3.6 | 30.50
Neigh   | 18.998     | 19         | 19.003     |   0.1 |  2.38
Comm    | 48.281     | 48.501     | 48.721     |   3.2 |  6.08
Output  | 0.60373    | 0.60375    | 0.60378    |   0.0 |  0.08
Modify  | 425.75     | 425.93     | 426.1      |   0.8 | 53.44
Other   |            | 59.91      |            |       |  7.52

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 170
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.22                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.4581968641666
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.32
  ghost atom cutoff = 3.32
  binsize = 1.66, bins = 10844 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 341.7 | 341.7 | 341.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024385183   8.9755025e-36  0              0.0073155549   1299022.4      0              6.2725145e+10  1.1971759e-13  0              3.3190442    
    200000   18000          200            200            0.088518875   -2.8721543e-34  0              0.26555662     191232.67      0              9.2339412e+09  1.1971759e-13  0              3.100286     
    300000   18000          200            200            0.00046355998  3.5901985e-35  0              0.0013906799   102375.21      0              4.9433326e+09  1.1971759e-13  0              3.1099405    
    400000   18000          200            200           -0.00012129699  1.0770587e-34  0             -0.00036389096  18533.828      0              8.9493225e+08  1.1971759e-13  0              3.1119953    
    500000   18000          200            200            0.0059575638   3.9492135e-34  0              0.017872691    4185.6138      0              2.0210831e+08  1.1971759e-13  0              3.1083877    
    600000   18000          200            200            0.00622859     5.3852922e-35  0              0.01868577     0.034630245    0              1672.1706      1.1971759e-13  0              3.1083507    
    700000   18000          200            200            0.0035414254   8.975495e-36   0              0.010624276    65.664075      0              3170683.2      1.1971759e-13  0              3.10887      
    800000   18000          200            200            0.0032897512  -8.9754747e-36  0              0.0098692537   0.041058108    0              1982.5491      1.1971759e-13  0              3.1089225    
    900000   18000          200            200            0.0029231828  -2.6926444e-35  0              0.0087695484   1.5558208      0              75125.017      1.1971759e-13  0              3.1090038    
   1000000   18000          200            200            0.0028373496   4.9365169e-35  0              0.0085120488   0.079816059    0              3854.0318      1.1971759e-13  0              3.1090237    
   1100000   18000          200            200            0.0028642995   3.7591272e-42  0              0.0085928985   0.0094779287   0              457.65525      1.1971759e-13  0              3.1090176    
   1200000   18000          200            200            0.0028820807   4.4877432e-36  0              0.0086462422   0.003608307    0              174.23223      1.1971759e-13  0              3.1090135    
   1300000   18000          200            200            0.0028826948  -3.9267742e-36  0              0.0086480844   1.5027432e-06  0              0.072562089    1.1971759e-13  0              3.1090133    
   1400000   18000          200            200            0.002880496   -7.0120969e-37  0              0.0086414881   5.8066074e-05  0              2.8038029      1.1971759e-13  0              3.1090138    
   1500000   18000          200            200            0.0028799013   8.7636596e-45  0              0.008639704    3.7767588e-06  0              0.18236617     1.1971759e-13  0              3.109014     
   1600000   18000          200            200            0.0028800516  -1.1219355e-36  0              0.0086401549   3.0092328e-07  0              0.014530508    1.1971759e-13  0              3.1090139    
   1700000   18000          200            200            0.0028801651  -1.1219355e-36  0              0.0086404952   1.4754258e-07  0              0.0071243031   1.1971759e-13  0              3.1090139    
   1800000   18000          200            200            0.0028801718  -1.6829033e-36  0              0.0086405155   3.10447e-10    0              1.4990375e-05  1.1971759e-13  0              3.1090139    
   1900000   18000          200            200            0.0028801585   5.6096777e-37  0              0.0086404754   2.1568288e-09  0              0.00010414554  1.1971759e-13  0              3.1090139    
   2000000   18000          200            200            0.0028801545   1.0379161e-44  0              0.0086404634   1.7373877e-10  0              8.3892234e-06  1.1971759e-13  0              3.1090139    
   2100000   18000          200            200            0.0028801553   8.4145164e-37  0              0.0086404658   9.1850984e-12  0              4.4351553e-07  1.1971759e-13  0              3.1090139    
   2200000   18000          200            200            0.002880156    5.6096777e-37  0              0.008640468    5.9741766e-12  0              2.8847161e-07  1.1971759e-13  0              3.1090139    
   2300000   18000          200            200            0.0028801561  -2.8048387e-37  0              0.0086404682   2.9414e-14     0              1.4202968e-09  1.1971759e-13  0              3.1090139    
   2400000   18000          200            200            0.002880156   -1.1219355e-36  0              0.0086404679   7.9541127e-14  0              3.8407564e-09  1.1971759e-13  0              3.1090139    
   2500000   18000          200            200            0.0028801559  -1.1219355e-36  0              0.0086404678   7.8310058e-15  0              3.7813124e-10  1.1971759e-13  0              3.1090139    
   2600000   18000          200            200            0.0028801559  -2.8048387e-37  0              0.0086404678   3.0338061e-16  0              1.4649164e-11  1.1971759e-13  0              3.1090139    
   2700000   18000          200            200            0.002880156    1.1219355e-36  0              0.0086404679   2.2945839e-16  0              1.1079724e-11  1.1971759e-13  0              3.1090139    
   2800000   18000          200            200            0.002880156   -2.0475323e-35  0              0.0086404679   1.1954791e-17  0              5.7725406e-13  1.1971759e-13  0              3.1090139    
   2900000   18000          200            200            0.002880156    2.8048389e-37  0              0.0086404679   2.8431276e-18  0              1.3728446e-13  1.1971759e-13  0              3.1090139    
   3000000   18000          200            200            0.002880156    7.4114242e-45  0              0.0086404679   5.8686426e-19  0              2.8337575e-14  1.1971759e-13  0              3.1090139    
Loop time of 795.408 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3258706.214 ns/day, 0.000 hours/ns, 3771.651 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.67     | 243.44     | 244.21     |   4.9 | 30.61
Neigh   | 17.855     | 17.857     | 17.859     |   0.1 |  2.25
Comm    | 45.666     | 46.164     | 46.661     |   7.3 |  5.80
Output  | 0.61448    | 0.61449    | 0.6145     |   0.0 |  0.08
Modify  | 427.27     | 427.31     | 427.35     |   0.2 | 53.72
Other   |            | 60.02      |            |       |  7.55

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.23                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.8176169501661
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.33
  ghost atom cutoff = 3.33
  binsize = 1.665, bins = 10811 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 340.7 | 340.7 | 340.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024451047  -8.9754749e-36  0              0.0073353142   1303742.4      0              6.2953057e+10  1.1971759e-13  0              3.3189718    
    200000   18000          200            200            0.049676955   -1.2565669e-34  0              0.14903086     332292.28      0              1.6045205e+10  1.1971759e-13  0              3.1083934    
    300000   18000          200            200            0.010569723   -1.0770576e-34  0              0.03170917     99866.635      0              4.8222024e+09  1.1971759e-13  0              3.1127195    
    400000   18000          200            200           -0.00011551316 -1.6155864e-34  0             -0.00034653948  16465.798      0              7.9507445e+08  1.1971759e-13  0              3.1179825    
    500000   18000          200            200            0.003241412   -1.795092e-35   0              0.0097242359   4802.4618      0              2.3189369e+08  1.1971759e-13  0              3.1139201    
    600000   18000          200            200            0.0059817898   1.7950986e-35  0              0.01794537     98.693708      0              4765565.9      1.1971759e-13  0              3.1133953    
    700000   18000          200            200            0.0038653066   1.795098e-35   0              0.01159592     27.413506      0              1323700.1      1.1971759e-13  0              3.1138032    
    800000   18000          200            200            0.0032424918  -1.7950959e-35  0              0.0097274755   3.0310445      0              146358.29      1.1971759e-13  0              3.1139341    
    900000   18000          200            200            0.0028555564   4.4877499e-36  0              0.0085666693   1.6374336      0              79065.809      1.1971759e-13  0              3.1140208    
   1000000   18000          200            200            0.002831829   -4.4877351e-36  0              0.0084954871   0.0016842667   0              81.327212      1.1971759e-13  0              3.1140265    
   1100000   18000          200            200            0.0028780428   1.1219355e-34  0              0.0086341285   0.025807407    0              1246.1473      1.1971759e-13  0              3.114016     
   1200000   18000          200            200            0.0028904557   6.7316142e-36  0              0.0086713672   0.0013622614   0              65.778727      1.1971759e-13  0              3.1140131    
   1300000   18000          200            200            0.0028867841   1.6829033e-36  0              0.0086603522   0.00019408048  0              9.371452       1.1971759e-13  0              3.114014     
   1400000   18000          200            200            0.0028844329  -2.8048388e-37  0              0.0086532987   5.7506436e-05  0              2.77678        1.1971759e-13  0              3.1140145    
   1500000   18000          200            200            0.0028844561  -5.6096775e-37  0              0.0086533683   1.2229095e-07  0              0.0059049922   1.1971759e-13  0              3.1140145    
   1600000   18000          200            200            0.0028847701   1.1219355e-36  0              0.0086543104   1.1377705e-06  0              0.054938867    1.1971759e-13  0              3.1140144    
   1700000   18000          200            200            0.0028848285  -5.6096774e-37  0              0.0086544856   2.6471128e-08  0              0.001278196    1.1971759e-13  0              3.1140144    
   1800000   18000          200            200            0.0028847986   8.4145164e-37  0              0.0086543958   1.1787474e-08  0              0.00056917494  1.1971759e-13  0              3.1140144    
   1900000   18000          200            200            0.0028847851   2.8048389e-37  0              0.0086543552   1.8200226e-09  0              8.7882377e-05  1.1971759e-13  0              3.1140144    
   2000000   18000          200            200            0.0028847864   5.6096776e-37  0              0.0086543591   3.532101e-11   0              1.7055252e-06  1.1971759e-13  0              3.1140144    
   2100000   18000          200            200            0.0028847884  -1.4024194e-36  0              0.0086543652   4.596938e-11   0              2.2196968e-06  1.1971759e-13  0              3.1140144    
   2200000   18000          200            200            0.0028847886  -8.4145162e-37  0              0.0086543659   2.953741e-13   0              1.4262558e-08  1.1971759e-13  0              3.1140144    
   2300000   18000          200            200            0.0028847884  -8.4145162e-37  0              0.0086543652   6.1644797e-13  0              2.9766066e-08  1.1971759e-13  0              3.1140144    
   2400000   18000          200            200            0.0028847883   1.5707097e-35  0              0.008654365    5.0311712e-14  0              2.4293725e-09  1.1971759e-13  0              3.1140144    
   2500000   18000          200            200            0.0028847883   2.8048389e-37  0              0.008654365    3.5186366e-15  0              1.6990237e-10  1.1971759e-13  0              3.1140144    
   2600000   18000          200            200            0.0028847884  -7.0120969e-36  0              0.0086543651   1.7087491e-15  0              8.2509377e-11  1.1971759e-13  0              3.1140144    
   2700000   18000          200            200            0.0028847884   1.0500139e-44  0              0.0086543651   1.133942e-17   0              5.4754002e-13  1.1971759e-13  0              3.1140144    
   2800000   18000          200            200            0.0028847884  -5.6096774e-37  0              0.0086543651   1.4301514e-17  0              6.9056891e-13  1.1971759e-13  0              3.1140144    
   2900000   18000          200            200            0.0028847884  -5.6096775e-37  0              0.0086543651   3.4224104e-18  0              1.6525595e-13  1.1971759e-13  0              3.1140144    
   3000000   18000          200            200            0.0028847884  -2.8048387e-37  0              0.0086543651   8.3698356e-18  0              4.0414941e-13  1.1971759e-13  0              3.1140144    
Loop time of 792.308 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3271454.051 ns/day, 0.000 hours/ns, 3786.405 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.38     | 242.59     | 242.79     |   1.3 | 30.62
Neigh   | 17.439     | 17.442     | 17.446     |   0.1 |  2.20
Comm    | 44.918     | 45.04      | 45.161     |   1.8 |  5.68
Output  | 0.6134     | 0.61341    | 0.61343    |   0.0 |  0.08
Modify  | 426.9      | 427.04     | 427.18     |   0.7 | 53.90
Other   |            | 59.58      |            |       |  7.52

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.24                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.1792694519052
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.34
  ghost atom cutoff = 3.34
  binsize = 1.67, bins = 10779 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 334.6 | 334.6 | 334.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024516918   3.1414199e-35  0              0.0073550755   1308469        0              6.3181283e+10  1.1971759e-13  0              3.3188877    
    200000   18000          200            200            0.014312459   -5.3852817e-35  0              0.042937377    403083.13      0              1.9463442e+10  1.1971759e-13  0              3.117098     
    300000   18000          200            200            0.027315893    3.5902009e-35  0              0.081947679    77343.477      0              3.7346397e+09  1.1971759e-13  0              3.1156316    
    400000   18000          200            200           -0.00010958919  7.4963598e-41  0             -0.00032876756  14521.859      0              7.0120858e+08  1.1971759e-13  0              3.123913     
    500000   18000          200            200            0.0011012061  -8.9754795e-35  0              0.0033036184   4510.2386      0              2.1778328e+08  1.1971759e-13  0              3.119462     
    600000   18000          200            200            0.0053078941   1.4831405e-41  0              0.015923682    333.71271      0              16113792       1.1971759e-13  0              3.1185188    
    700000   18000          200            200            0.0040347717   4.4877432e-35  0              0.012104315    2.3096824      0              111526.3       1.1971759e-13  0              3.1187696    
    800000   18000          200            200            0.0031243316  -8.9754752e-36  0              0.0093729947   8.5711521      0              413870.26      1.1971759e-13  0              3.1189615    
    900000   18000          200            200            0.0027954864   4.4877501e-36  0              0.0083864592   1.0055635      0              48555.061      1.1971759e-13  0              3.1190361    
   1000000   18000          200            200            0.0028419862  -1.7950961e-35  0              0.0085259585   0.044840874    0              2165.2053      1.1971759e-13  0              3.1190258    
   1100000   18000          200            200            0.0028942115  -2.2438706e-35  0              0.0086826344   0.027673817    0              1336.2696      1.1971759e-13  0              3.1190139    
   1200000   18000          200            200            0.0028964317   1.0435711e-42  0              0.0086892951   3.0913898e-06  0              0.14927215     1.1971759e-13  0              3.1190133    
   1300000   18000          200            200            0.0028898895   7.2925809e-36  0              0.0086696685   0.00049153004  0              23.734227      1.1971759e-13  0              3.1190148    
   1400000   18000          200            200            0.0028885718   2.8048388e-37  0              0.0086657155   1.0570763e-05  0              0.51042431     1.1971759e-13  0              3.1190151    
   1500000   18000          200            200            0.0028892257   5.6096776e-37  0              0.008667677    5.7960898e-06  0              0.27987243     1.1971759e-13  0              3.1190149    
   1600000   18000          200            200            0.0028895018  -5.3291937e-36  0              0.0086685055   6.4993359e-07  0              0.031382967    1.1971759e-13  0              3.1190149    
   1700000   18000          200            200            0.0028894592   2.243871e-36   0              0.0086683775   3.6200235e-08  0              0.0017479798   1.1971759e-13  0              3.1190149    
   1800000   18000          200            200            0.0028894161  -2.8048387e-37  0              0.0086682483   1.8498001e-08  0              0.00089320225  1.1971759e-13  0              3.1190149    
   1900000   18000          200            200            0.002889415   -5.6096774e-37  0              0.0086682449   1.3540508e-11  0              6.5382269e-07  1.1971759e-13  0              3.1190149    
   2000000   18000          200            200            0.0028894205   5.6096777e-37  0              0.0086682614   3.4155296e-10  0              1.649237e-05   1.1971759e-13  0              3.1190149    
   2100000   18000          200            200            0.0028894215  -5.6096774e-37  0              0.0086682644   5.8502159e-12  0              2.8248599e-07  1.1971759e-13  0              3.1190149    
   2200000   18000          200            200            0.0028894209   1.1219355e-36  0              0.0086682627   4.2130284e-12  0              2.0343207e-07  1.1971759e-13  0              3.1190149    
   2300000   18000          200            200            0.0028894207  -8.4145162e-37  0              0.008668262    4.101142e-13   0              1.9802947e-08  1.1971759e-13  0              3.1190149    
   2400000   18000          200            200            0.0028894207   5.6096777e-37  0              0.0086682622   2.8661664e-14  0              1.3839692e-09  1.1971759e-13  0              3.1190149    
   2500000   18000          200            200            0.0028894208  -2.8048387e-37  0              0.0086682623   1.231905e-14   0              5.9484285e-10  1.1971759e-13  0              3.1190149    
   2600000   18000          200            200            0.0028894208   1.4024194e-36  0              0.0086682623   2.6917008e-17  0              1.299726e-12   1.1971759e-13  0              3.1190149    
   2700000   18000          200            200            0.0028894207   1.1219355e-36  0              0.0086682622   2.1334503e-16  0              1.0301668e-11  1.1971759e-13  0              3.1190149    
   2800000   18000          200            200            0.0028894207  -2.8048387e-37  0              0.0086682622   6.4607802e-18  0              3.1196795e-13  1.1971759e-13  0              3.1190149    
   2900000   18000          200            200            0.0028894207  -2.8048387e-37  0              0.0086682622   1.1747293e-17  0              5.6723475e-13  1.1971759e-13  0              3.1190149    
   3000000   18000          200            200            0.0028894207   2.8048389e-37  0              0.0086682622   6.6877513e-18  0              3.2292758e-13  1.1971759e-13  0              3.1190149    
Loop time of 794.908 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3260756.639 ns/day, 0.000 hours/ns, 3774.024 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.33     | 242.99     | 244.65     |  10.6 | 30.57
Neigh   | 17.01      | 17.012     | 17.014     |   0.1 |  2.14
Comm    | 43.95      | 45.273     | 46.596     |  19.7 |  5.70
Output  | 0.61201    | 0.61203    | 0.61204    |   0.0 |  0.08
Modify  | 427.85     | 427.87     | 427.88     |   0.1 | 53.83
Other   |            | 61.15      |            |       |  7.69

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.25                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.5431612808879
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.35
  ghost atom cutoff = 3.35
  binsize = 1.675, bins = 10747 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 333.6 | 333.6 | 333.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024582795  -8.9754703e-36  0              0.0073748385   1313202        0              6.3409824e+10  1.1971759e-13  0              3.3187921    
    200000   18000          200            200           -0.00027490741 -1.7950862e-35  0             -0.00082472222  405151.29      0              1.9563306e+10  1.1971759e-13  0              3.1259662    
    300000   18000          200            200            0.044244251    1.7951014e-35  0              0.13273275     39310.86       0              1.8981808e+09  1.1971759e-13  0              3.118951     
    400000   18000          200            200           -0.00010352858  6.1680216e-41  0             -0.00031058573  12702.419      0              6.1335435e+08  1.1971759e-13  0              3.1297861    
    500000   18000          200            200           -4.1397513e-05 -1.436077e-34   0             -0.00012419254  3649.9769      0              1.7624432e+08  1.1971759e-13  0              3.1249678    
    600000   18000          200            200            0.0043449779  -7.1803856e-35  0              0.013034934    580.68884      0              28039386       1.1971759e-13  0              3.1237041    
    700000   18000          200            200            0.004015108    2.6926463e-35  0              0.012045324    5.9520626      0              287403.8       1.1971759e-13  0              3.1237746    
    800000   18000          200            200            0.0029618015  -1.7950959e-35  0              0.0088854044   12.482997      0              602759.25      1.1971759e-13  0              3.1239993    
    900000   18000          200            200            0.0027582616   2.2438718e-35  0              0.0082747849   0.23679176     0              11433.827      1.1971759e-13  0              3.1240463    
   1000000   18000          200            200            0.0028661878   4.4877492e-36  0              0.0085985635   0.16092532     0              7770.5076      1.1971759e-13  0              3.1240218    
   1100000   18000          200            200            0.0029086802   6.2828392e-35  0              0.0087260405   0.012706939    0              613.57261      1.1971759e-13  0              3.1240121    
   1200000   18000          200            200            0.0028994477   9.917033e-43   0              0.008698343    0.0015625774   0              75.451272      1.1971759e-13  0              3.1240142    
   1300000   18000          200            200            0.0028927656   9.5364519e-36  0              0.0086782969   0.00038029894  0              18.363275      1.1971759e-13  0              3.1240157    
   1400000   18000          200            200            0.002893191   -2.8048388e-37  0              0.0086795729   8.3924646e-06  0              0.40524208     1.1971759e-13  0              3.1240156    
   1500000   18000          200            200            0.0028941207   8.4145164e-37  0              0.0086823621   8.4652009e-06  0              0.40875426     1.1971759e-13  0              3.1240154    
   1600000   18000          200            200            0.0028941746   7.8535486e-36  0              0.0086825239   1.4028808e-09  0              6.7740093e-05  1.1971759e-13  0              3.1240154    
   1700000   18000          200            200            0.0028940586  -1.4024194e-36  0              0.0086821758   1.5008104e-07  0              0.0072468764   1.1971759e-13  0              3.1240154    
   1800000   18000          200            200            0.0028940378  -1.009742e-35   0              0.0086821134   1.6693416e-09  0              8.0606533e-05  1.1971759e-13  0              3.1240154    
   1900000   18000          200            200            0.0028940506   8.4145164e-37  0              0.0086821518   2.1311404e-09  0              0.00010290514  1.1971759e-13  0              3.1240154    
   2000000   18000          200            200            0.0028940549  -1.4024194e-36  0              0.0086821646   1.1740426e-10  0              5.6690318e-06  1.1971759e-13  0              3.1240154    
   2100000   18000          200            200            0.0028940537   1.6829033e-36  0              0.008682161    2.2998563e-11  0              1.1105183e-06  1.1971759e-13  0              3.1240154    
   2200000   18000          200            200            0.002894053   -2.5243549e-36  0              0.0086821589   3.9681254e-12  0              1.9160657e-07  1.1971759e-13  0              3.1240154    
   2300000   18000          200            200            0.0028940531  -1.1219355e-36  0              0.0086821592   1.560402e-13   0              7.534623e-09   1.1971759e-13  0              3.1240154    
   2400000   18000          200            200            0.0028940532   2.8048389e-37  0              0.0086821595   9.587379e-14   0              4.6294022e-09  1.1971759e-13  0              3.1240154    
   2500000   18000          200            200            0.0028940532   1.4024194e-36  0              0.0086821595   2.2976078e-16  0              1.1094326e-11  1.1971759e-13  0              3.1240154    
   2600000   18000          200            200            0.0028940531  -5.6096774e-37  0              0.0086821594   1.8064574e-15  0              8.7227365e-11  1.1971759e-13  0              3.1240154    
   2700000   18000          200            200            0.0028940531   2.8048389e-37  0              0.0086821594   3.7204581e-17  0              1.7964761e-12  1.1971759e-13  0              3.1240154    
   2800000   18000          200            200            0.0028940531  -1.9633871e-36  0              0.0086821594   7.8525351e-18  0              3.7917082e-13  1.1971759e-13  0              3.1240154    
   2900000   18000          200            200            0.0028940531   4.2072582e-36  0              0.0086821594   1.2562243e-17  0              6.0658575e-13  1.1971759e-13  0              3.1240154    
   3000000   18000          200            200            0.0028940531  -1.1219355e-36  0              0.0086821594   7.4751632e-18  0              3.6094888e-13  1.1971759e-13  0              3.1240154    
Loop time of 796.058 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3256044.258 ns/day, 0.000 hours/ns, 3768.570 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.06     | 242.86     | 243.65     |   5.1 | 30.51
Neigh   | 17.258     | 17.262     | 17.265     |   0.1 |  2.17
Comm    | 44.64      | 45.127     | 45.613     |   7.2 |  5.67
Output  | 0.61356    | 0.61358    | 0.61361    |   0.0 |  0.08
Modify  | 428.4      | 428.44     | 428.48     |   0.2 | 53.82
Other   |            | 61.76      |            |       |  7.76

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.26                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.9092993486176
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.36
  ghost atom cutoff = 3.36
  binsize = 1.68, bins = 10715 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 332.7 | 332.7 | 332.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024648678   1.7950981e-35  0              0.0073946035   1317941.7      0              6.3638689e+10  1.1971759e-13  0              3.3186843    
    200000   18000          200            200           -0.00027786205  3.590206e-35   0             -0.00083358615  395582.6       0              1.9101268e+10  1.1971759e-13  0              3.1348047    
    300000   18000          200            200            0.055498646    7.1803927e-35  0              0.16649594     6925.2741      0              3.343967e+08   1.1971759e-13  0              3.1229557    
    400000   18000          200            200           -9.7331154e-05 -1.7950909e-35  0             -0.00029199346  11006.683      0              5.3147331e+08  1.1971759e-13  0              3.1356019    
    500000   18000          200            200           -5.1062344e-05  3.590199e-35   0             -0.00015318703  2741.3489      0              1.3236993e+08  1.1971759e-13  0              3.1304137    
    600000   18000          200            200            0.0032738581  -1.7950951e-35  0              0.0098215743   719.84854      0              34758910       1.1971759e-13  0              3.1289268    
    700000   18000          200            200            0.0038108496  -2.6926442e-35  0              0.011432549    35.850594      0              1731096.9      1.1971759e-13  0              3.1288176    
    800000   18000          200            200            0.0027892125   9.1104221e-42  0              0.0083676375   11.912941      0              575233.26      1.1971759e-13  0              3.12904      
    900000   18000          200            200            0.0027534943  -2.6926444e-35  0              0.0082604828   0.020682263    0              998.67245      1.1971759e-13  0              3.1290491    
   1000000   18000          200            200            0.0028986973   7.2471219e-42  0              0.0086960919   0.22228704     0              10733.446      1.1971759e-13  0              3.129016     
   1100000   18000          200            200            0.0029179368  -4.4877384e-36  0              0.0087538103   0.00036722424  0              17.731944      1.1971759e-13  0              3.1290115    
   1200000   18000          200            200            0.0029001947  -3.3658064e-35  0              0.0087005842   0.0036659218   0              177.01425      1.1971759e-13  0              3.1290155    
   1300000   18000          200            200            0.0028962731   5.6096782e-37  0              0.0086888194   5.3463486e-05  0              2.5815604      1.1971759e-13  0              3.1290164    
   1400000   18000          200            200            0.0028982957   1.5404964e-45  0              0.0086948872   5.4619341e-05  0              2.6373725      1.1971759e-13  0              3.129016     
   1500000   18000          200            200            0.0028989723   1.4024194e-36  0              0.0086969168   2.3941765e-06  0              0.11560621     1.1971759e-13  0              3.1290158    
   1600000   18000          200            200            0.0028987595   1.1219355e-36  0              0.0086962786   7.2316133e-07  0              0.034918872    1.1971759e-13  0              3.1290159    
   1700000   18000          200            200            0.0028986536  -2.8048387e-37  0              0.0086959609   7.3413678e-08  0              0.0035448838   1.1971759e-13  0              3.1290159    
   1800000   18000          200            200            0.0028986733  -5.6096774e-37  0              0.0086960198   8.1895207e-09  0              0.00039544265  1.1971759e-13  0              3.1290159    
   1900000   18000          200            200            0.0028986888  -1.2341291e-35  0              0.0086960663   1.8339364e-09  0              8.8554227e-05  1.1971759e-13  0              3.1290159    
   2000000   18000          200            200            0.0028986874   1.1219355e-36  0              0.0086960622   7.2648293e-11  0              3.5079261e-06  1.1971759e-13  0              3.1290159    
   2100000   18000          200            200            0.0028986853   2.8048389e-37  0              0.0086960558   3.9837893e-11  0              1.9236293e-06  1.1971759e-13  0              3.1290159    
   2200000   18000          200            200            0.0028986853   5.6096777e-37  0              0.0086960558   3.8689292e-13  0              1.8681674e-08  1.1971759e-13  0              3.1290159    
   2300000   18000          200            200            0.0028986856   1.0090841e-44  0              0.0086960567   7.7528843e-13  0              3.7435904e-08  1.1971759e-13  0              3.1290159    
   2400000   18000          200            200            0.0028986856  -2.5243549e-36  0              0.0086960567   1.8405011e-16  0              8.8871213e-12  1.1971759e-13  0              3.1290159    
   2500000   18000          200            200            0.0028986855  -2.8048387e-37  0              0.0086960566   1.3661472e-14  0              6.5966361e-10  1.1971759e-13  0              3.1290159    
   2600000   18000          200            200            0.0028986855  -8.4145162e-37  0              0.0086960566   5.2240697e-17  0              2.5225163e-12  1.1971759e-13  0              3.1290159    
   2700000   18000          200            200            0.0028986855   2.8048389e-37  0              0.0086960566   1.8282181e-16  0              8.8278108e-12  1.1971759e-13  0              3.1290159    
   2800000   18000          200            200            0.0028986855  -1.9633871e-36  0              0.0086960566   6.9112129e-18  0              3.3371774e-13  1.1971759e-13  0              3.1290159    
   2900000   18000          200            200            0.0028986855  -3.6462904e-36  0              0.0086960566   1.4249459e-17  0              6.8805536e-13  1.1971759e-13  0              3.1290159    
   3000000   18000          200            200            0.0028986855   2.243871e-36   0              0.0086960566   3.5755133e-18  0              1.7264874e-13  1.1971759e-13  0              3.1290159    
Loop time of 793.445 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3266765.693 ns/day, 0.000 hours/ns, 3780.979 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.3      | 243.53     | 245.76     |  14.3 | 30.69
Neigh   | 16.829     | 16.831     | 16.834     |   0.1 |  2.12
Comm    | 43.625     | 45.501     | 47.377     |  27.8 |  5.73
Output  | 0.60902    | 0.60903    | 0.60904    |   0.0 |  0.08
Modify  | 426.93     | 427.12     | 427.32     |   0.9 | 53.83
Other   |            | 59.85      |            |       |  7.54

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.27                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.2776905665988
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.37
  ghost atom cutoff = 3.37
  binsize = 1.685, bins = 10683 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 326.6 | 326.6 | 326.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024714567   1.6548214e-41  0              0.0074143701   1322688        0              6.3867869e+10  1.1971759e-13  0              3.3185647    
    200000   18000          200            200           -0.00028065792 -1.7950861e-35  0             -0.00084197375  386136.04      0              1.8645128e+10  1.1971759e-13  0              3.1436015    
    300000   18000          200            200            0.056944921   -5.3852835e-35  0              0.17083476     2280.4291      0              1.1011376e+08  1.1971759e-13  0              3.1278326    
    400000   18000          200            200           -9.0997222e-05  1.7951042e-35  0             -0.00027299167  9434.0753      0              4.5553773e+08  1.1971759e-13  0              3.1413605    
    500000   18000          200            200           -4.3631068e-05  1.7951017e-35  0             -0.00013089321  1963.4097      0              94806029       1.1971759e-13  0              3.1357965    
    600000   18000          200            200            0.0022662985  -8.9754823e-35  0              0.0067988956   697.49949      0              33679754       1.1971759e-13  0              3.1341596    
    700000   18000          200            200            0.0034643001   8.9754948e-36  0              0.0103929      73.166925      0              3532969        1.1971759e-13  0              3.1338915    
    800000   18000          200            200            0.0026405064  -1.7950959e-35  0              0.0079215193   7.3616425      0              355467.37      1.1971759e-13  0              3.134076     
    900000   18000          200            200            0.0027832998   3.5901945e-35  0              0.0083498994   0.5448332      0              26308.045      1.1971759e-13  0              3.1340438    
   1000000   18000          200            200            0.0029312982   4.4877492e-36  0              0.0087938945   0.16177227     0              7811.404       1.1971759e-13  0              3.1340101    
   1100000   18000          200            200            0.0029203395  -1.7950965e-35  0              0.0087610184   0.0065391533   0              315.75231      1.1971759e-13  0              3.1340125    
   1200000   18000          200            200            0.0029003115  -2.2438701e-36  0              0.0087009346   0.0031506903   0              152.13556      1.1971759e-13  0              3.134017     
   1300000   18000          200            200            0.0029009584  -2.243871e-36   0              0.0087028752   7.0389349e-05  0              3.3988498      1.1971759e-13  0              3.1340169    
   1400000   18000          200            200            0.0029036191   1.4024194e-37  0              0.0087108573   5.9672896e-05  0              2.8813906      1.1971759e-13  0              3.1340163    
   1500000   18000          200            200            0.0029036406   5.6096776e-37  0              0.0087109217   6.3285858e-07  0              0.030558476    1.1971759e-13  0              3.1340163    
   1600000   18000          200            200            0.0029032912  -1.4024194e-36  0              0.0087098735   1.0995411e-06  0              0.053092904    1.1971759e-13  0              3.1340164    
   1700000   18000          200            200            0.0029032744   1.0346719e-44  0              0.0087098232   3.9412084e-09  0              0.00019030685  1.1971759e-13  0              3.1340164    
   1800000   18000          200            200            0.0029033197   1.0628087e-44  0              0.0087099591   1.9749762e-08  0              0.00095364531  1.1971759e-13  0              3.1340164    
   1900000   18000          200            200            0.0029033237   1.0457741e-44  0              0.0087099712   6.9878183e-12  0              3.3741674e-07  1.1971759e-13  0              3.1340164    
   2000000   18000          200            200            0.0029033179  -8.4145162e-37  0              0.0087099538   3.4610055e-10  0              1.6711957e-05  1.1971759e-13  0              3.1340164    
   2100000   18000          200            200            0.0029033172  -8.4145162e-37  0              0.0087099515   1.5630902e-13  0              7.547603e-09   1.1971759e-13  0              3.1340164    
   2200000   18000          200            200            0.0029033179   2.8048389e-37  0              0.0087099537   5.9140842e-12  0              2.8556996e-07  1.1971759e-13  0              3.1340164    
   2300000   18000          200            200            0.002903318   -5.6096774e-37  0              0.0087099541   2.2403703e-14  0              1.0817946e-09  1.1971759e-13  0              3.1340164    
   2400000   18000          200            200            0.0029033179  -2.5243549e-36  0              0.0087099538   9.8734583e-14  0              4.7675396e-09  1.1971759e-13  0              3.1340164    
   2500000   18000          200            200            0.0029033179  -4.2072582e-36  0              0.0087099537   1.0233051e-15  0              4.9411742e-11  1.1971759e-13  0              3.1340164    
   2600000   18000          200            200            0.0029033179   5.6096777e-37  0              0.0087099538   1.6293164e-15  0              7.8673856e-11  1.1971759e-13  0              3.1340164    
   2700000   18000          200            200            0.0029033179   1.0438113e-44  0              0.0087099538   7.1017468e-17  0              3.4291794e-12  1.1971759e-13  0              3.1340164    
   2800000   18000          200            200            0.0029033179   1.1219355e-36  0              0.0087099538   1.6822726e-17  0              8.1230922e-13  1.1971759e-13  0              3.1340164    
   2900000   18000          200            200            0.0029033179   5.6096777e-37  0              0.0087099538   8.8682838e-18  0              4.2821769e-13  1.1971759e-13  0              3.1340164    
   3000000   18000          200            200            0.0029033179  -5.6096775e-37  0              0.0087099538   2.2581707e-18  0              1.0903898e-13  1.1971759e-13  0              3.1340164    
Loop time of 789.289 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3283966.722 ns/day, 0.000 hours/ns, 3800.887 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.51     | 241.41     | 243.31     |  12.2 | 30.59
Neigh   | 16.915     | 16.918     | 16.92      |   0.1 |  2.14
Comm    | 42.815     | 44.919     | 47.023     |  31.4 |  5.69
Output  | 0.60805    | 0.60807    | 0.60808    |   0.0 |  0.08
Modify  | 426.04     | 426.09     | 426.14     |   0.2 | 53.98
Other   |            | 59.35      |            |       |  7.52

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.28                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.6483418463349
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.38
  ghost atom cutoff = 3.38
  binsize = 1.69, bins = 10651 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 325.7 | 325.7 | 325.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.002478046    6.6821793e-42  0              0.0074341381   1327440.7      0              6.4097359e+10  1.1971759e-13  0              3.3184336    
    200000   18000          200            200           -0.00028329535 -4.6672509e-34  0             -0.00084988606  376812.95      0              1.8194949e+10  1.1971759e-13  0              3.152356     
    300000   18000          200            200            0.047974357    1.0770588e-34  0              0.14392307     28654.219      0              1.3836097e+09  1.1971759e-13  0              3.1336077    
    400000   18000          200            200           -8.4529685e-05  7.0303333e-41  0             -0.00025358905  7984.6155      0              3.855485e+08   1.1971759e-13  0              3.1470616    
    500000   18000          200            200           -3.6063789e-05  3.5901995e-35  0             -0.00010819137  1315.9773      0              63543836       1.1971759e-13  0              3.1411161    
    600000   18000          200            200            0.0014449206   3.5901954e-35  0              0.0043347618   539.6223       0              26056430       1.1971759e-13  0              3.1393766    
    700000   18000          200            200            0.0030428432   4.487743e-35   0              0.0091285297   95.306837      0              4602026.1      1.1971759e-13  0              3.1389844    
    800000   18000          200            200            0.0025429157  -6.282838e-35   0              0.007628747    2.1604776      0              104321.73      1.1971759e-13  0              3.1391006    
    900000   18000          200            200            0.0028419175   8.6282121e-42  0              0.0085257524   1.3335837      0              64393.986      1.1971759e-13  0              3.139032     
   1000000   18000          200            200            0.0029556725  -1.3463219e-35  0              0.0088670174   0.045883087    0              2215.53        1.1971759e-13  0              3.1390062    
   1100000   18000          200            200            0.0029167016   3.1414198e-35  0              0.0087501048   0.02305846     0              1113.4105      1.1971759e-13  0              3.1390148    
   1200000   18000          200            200            0.0029016884   6.7316141e-36  0              0.0087050651   0.00080149036  0              38.701101      1.1971759e-13  0              3.1390182    
   1300000   18000          200            200            0.0029067913   7.1241466e-44  0              0.0087203738   0.0003981186   0              19.223722      1.1971759e-13  0              3.1390171    
   1400000   18000          200            200            0.0029087736   8.4145163e-37  0              0.0087263209   1.4030174e-05  0              0.67746689     1.1971759e-13  0              3.1390166    
   1500000   18000          200            200            0.0029081036   1.4024194e-36  0              0.0087243108   6.8801561e-06  0              0.33221811     1.1971759e-13  0              3.1390168    
   1600000   18000          200            200            0.0029078421   1.6829033e-36  0              0.0087235263   2.4542084e-07  0              0.011850494    1.1971759e-13  0              3.1390169    
   1700000   18000          200            200            0.00290793     2.8048389e-37  0              0.0087237901   1.1888549e-07  0              0.0057405546   1.1971759e-13  0              3.1390168    
   1800000   18000          200            200            0.0029079645   1.0430105e-44  0              0.0087238936   4.2930222e-09  0              0.00020729468  1.1971759e-13  0              3.1390168    
   1900000   18000          200            200            0.002907953   -1.4024194e-36  0              0.008723859    2.0543031e-09  0              9.9194944e-05  1.1971759e-13  0              3.1390168    
   2000000   18000          200            200            0.0029079484  -8.4145162e-37  0              0.0087238453   7.5107458e-11  0              3.6266703e-06  1.1971759e-13  0              3.1390168    
   2100000   18000          200            200            0.00290795     2.8048389e-37  0              0.0087238499   3.5509449e-11  0              1.7146242e-06  1.1971759e-13  0              3.1390168    
   2200000   18000          200            200            0.0029079506  -1.1219355e-36  0              0.0087238517   1.3117231e-12  0              6.3338412e-08  1.1971759e-13  0              3.1390168    
   2300000   18000          200            200            0.0029079504   2.8048389e-37  0              0.0087238511   6.1460563e-13  0              2.9677106e-08  1.1971759e-13  0              3.1390168    
   2400000   18000          200            200            0.0029079503   2.5243549e-36  0              0.0087238508   2.3427365e-14  0              1.1312236e-09  1.1971759e-13  0              3.1390168    
   2500000   18000          200            200            0.0029079503   1.4024194e-36  0              0.0087238509   1.0528251e-14  0              5.0837157e-10  1.1971759e-13  0              3.1390168    
   2600000   18000          200            200            0.0029079503  -8.4145162e-37  0              0.008723851    4.1930661e-16  0              2.0246816e-11  1.1971759e-13  0              3.1390168    
   2700000   18000          200            200            0.0029079503   2.8048389e-37  0              0.0087238509   1.3234659e-16  0              6.3905434e-12  1.1971759e-13  0              3.1390168    
   2800000   18000          200            200            0.0029079503   2.8048389e-37  0              0.0087238509   2.0258892e-17  0              9.782294e-13   1.1971759e-13  0              3.1390168    
   2900000   18000          200            200            0.0029079503   5.0487098e-36  0              0.0087238509   2.352549e-18   0              1.1359617e-13  1.1971759e-13  0              3.1390168    
   3000000   18000          200            200            0.0029079503  -2.8048387e-37  0              0.0087238509   8.2269329e-18  0              3.9724915e-13  1.1971759e-13  0              3.1390168    
Loop time of 789.861 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3281589.109 ns/day, 0.000 hours/ns, 3798.136 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.55     | 240.95     | 241.35     |   2.6 | 30.51
Neigh   | 16.831     | 16.834     | 16.837     |   0.1 |  2.13
Comm    | 44.17      | 44.282     | 44.394     |   1.7 |  5.61
Output  | 0.60645    | 0.60646    | 0.60647    |   0.0 |  0.08
Modify  | 428.66     | 428.89     | 429.12     |   1.1 | 54.30
Other   |            | 58.3       |            |       |  7.38

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.29                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.0212600993298
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.39
  ghost atom cutoff = 3.39
  binsize = 1.695, bins = 10620 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 319.8 | 319.8 | 319.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024846358  -8.9754764e-36  0              0.0074539074   1332199.9      0              6.4327164e+10  1.1971759e-13  0              3.3182907    
    200000   18000          200            200           -0.00028577518 -1.7950859e-35  0             -0.00085732555  367612.02      0              1.7750669e+10  1.1971759e-13  0              3.1610685    
    300000   18000          200            200            0.03182613     1.7951031e-35  0              0.09547839     67273.859      0              3.2484139e+09  1.1971759e-13  0              3.1401356    
    400000   18000          200            200           -7.7928283e-05  5.9571513e-41  0             -0.00023378485  6657.5562      0              3.2146956e+08  1.1971759e-13  0              3.1527051    
    500000   18000          200            200           -2.8360127e-05  1.7951018e-35  0             -8.5080382e-05  798.30944      0              38547506       1.1971759e-13  0              3.1463725    
    600000   18000          200            200            0.00086455497  1.256568e-34   0              0.0025936649   322.00732      0              15548581       1.1971759e-13  0              3.1445566    
    700000   18000          200            200            0.0026198888  -8.9754741e-36  0              0.0078596663   90.005967      0              4346066        1.1971759e-13  0              3.144082     
    800000   18000          200            200            0.0025133452  -1.2565677e-34  0              0.0075400357   0.00172345     0              83.219232      1.1971759e-13  0              3.1441093    
    900000   18000          200            200            0.0029168267  -5.3852896e-35  0              0.00875048     1.674417       0              80851.606      1.1971759e-13  0              3.1440167    
   1000000   18000          200            200            0.0029659219   6.8865243e-42  0              0.0088977658   0.0013350374   0              64.464179      1.1971759e-13  0              3.1440053    
   1100000   18000          200            200            0.0029099775  -4.4877385e-36  0              0.0087299324   0.028535778    0              1377.8906      1.1971759e-13  0              3.1440179    
   1200000   18000          200            200            0.0029056759   2.2438711e-35  0              0.0087170277   0.00012490446  0              6.0311893      1.1971759e-13  0              3.1440189    
   1300000   18000          200            200            0.0029131858  -1.6829032e-36  0              0.0087395575   0.00047579063  0              22.974227      1.1971759e-13  0              3.1440172    
   1400000   18000          200            200            0.0029134691  -4.2072581e-37  0              0.0087404074   5.290564e-06   0              0.2554624      1.1971759e-13  0              3.1440171    
   1500000   18000          200            200            0.0029124696   8.7222283e-45  0              0.0087374088   7.7482669e-06  0              0.37413608     1.1971759e-13  0              3.1440173    
   1600000   18000          200            200            0.0029124703  -2.8048387e-37  0              0.008737411    1.6687079e-07  0              0.0080575933   1.1971759e-13  0              3.1440173    
   1700000   18000          200            200            0.0029126019   2.8048389e-37  0              0.0087378056   1.2310406e-07  0              0.0059442544   1.1971759e-13  0              3.1440173    
   1800000   18000          200            200            0.0029125968   1.4024194e-36  0              0.0087377903   4.5022792e-09  0              0.00021739895  1.1971759e-13  0              3.1440173    
   1900000   18000          200            200            0.0029125796   8.4145164e-37  0              0.0087377389   1.9037179e-09  0              9.1923726e-05  1.1971759e-13  0              3.1440173    
   2000000   18000          200            200            0.002912581   -4.7682259e-36  0              0.0087377429   1.1002052e-10  0              5.3124972e-06  1.1971759e-13  0              3.1440173    
   2100000   18000          200            200            0.0029125832   9.255968e-36   0              0.0087377495   2.8543698e-11  0              1.378273e-06   1.1971759e-13  0              3.1440173    
   2200000   18000          200            200            0.0029125829   2.8048389e-37  0              0.0087377487   2.510847e-12   0              1.2123982e-07  1.1971759e-13  0              3.1440173    
   2300000   18000          200            200            0.0029125826   1.0329944e-44  0              0.0087377479   4.1227405e-13  0              1.9907238e-08  1.1971759e-13  0              3.1440173    
   2400000   18000          200            200            0.0029125827   8.4145164e-37  0              0.008737748    5.4680357e-14  0              2.6403187e-09  1.1971759e-13  0              3.1440173    
   2500000   18000          200            200            0.0029125827   1.0332025e-44  0              0.0087377481   5.6746736e-15  0              2.7400968e-10  1.1971759e-13  0              3.1440173    
   2600000   18000          200            200            0.0029125827   1.6829033e-36  0              0.0087377481   1.180891e-15   0              5.7021e-11     1.1971759e-13  0              3.1440173    
   2700000   18000          200            200            0.0029125827  -5.6096774e-37  0              0.0087377481   1.2201594e-16  0              5.8917131e-12  1.1971759e-13  0              3.1440173    
   2800000   18000          200            200            0.0029125827   2.8048389e-37  0              0.0087377481   4.2652233e-18  0              2.0595237e-13  1.1971759e-13  0              3.1440173    
   2900000   18000          200            200            0.0029125827  -1.1219355e-36  0              0.0087377481   1.9489317e-18  0              9.4106935e-14  1.1971759e-13  0              3.1440173    
   3000000   18000          200            200            0.0029125827   5.6096776e-37  0              0.0087377481   4.6434607e-18  0              2.242161e-13   1.1971759e-13  0              3.1440173    
Loop time of 788.511 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3287207.307 ns/day, 0.000 hours/ns, 3804.638 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.08     | 238.43     | 238.78     |   2.2 | 30.24
Neigh   | 16.991     | 16.994     | 16.996     |   0.1 |  2.16
Comm    | 44.529     | 44.556     | 44.582     |   0.4 |  5.65
Output  | 0.6048     | 0.60482    | 0.60483    |   0.0 |  0.08
Modify  | 426.94     | 427.13     | 427.33     |   0.9 | 54.17
Other   |            | 60.8       |            |       |  7.71

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.3964522370874
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.4
  ghost atom cutoff = 3.4
  binsize = 1.7, bins = 10589 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 318.9 | 318.9 | 318.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024912261  -4.4877364e-36  0              0.0074736783   1336965.7      0              6.4557289e+10  1.1971759e-13  0              3.3181357    
    200000   18000          200            200           -0.00028809824  7.1803969e-35  0             -0.00086429471  358531.62      0              1.7312209e+10  1.1971759e-13  0              3.1697393    
    300000   18000          200            200            0.014156356   -5.3852812e-35  0              0.042469069    94426.918      0              4.5595379e+09  1.1971759e-13  0              3.1471524    
    400000   18000          200            200           -7.1192834e-05  6.3531528e-41  0             -0.0002135785   5452.2671      0              2.6327047e+08  1.1971759e-13  0              3.158291     
    500000   18000          200            200           -2.052017e-05   1.2565682e-34  0             -6.1560511e-05  409.79008      0              19787297       1.1971759e-13  0              3.1515656    
    600000   18000          200            200            0.00051949512  4.4877442e-35  0              0.0015584854   127.18539      0              6141327.3      1.1971759e-13  0              3.1496845    
    700000   18000          200            200            0.0022583517  -8.9754742e-36  0              0.006775055    61.434746      0              2966464        1.1971759e-13  0              3.1491699    
    800000   18000          200            200            0.0025572632   1.7950978e-35  0              0.0076717897   2.3755628      0              114707.43      1.1971759e-13  0              3.1491007    
    900000   18000          200            200            0.002991304   -1.7950959e-35  0              0.0089739119   1.2571361      0              60702.602      1.1971759e-13  0              3.1490015    
   1000000   18000          200            200            0.0029603776  -4.4877353e-36  0              0.0088811328   0.075970701    0              3668.3533      1.1971759e-13  0              3.149008     
   1100000   18000          200            200            0.0029041856   3.522688e-42   0              0.0087125568   0.015992517    0              772.22142      1.1971759e-13  0              3.1490207    
   1200000   18000          200            200            0.0029125337   2.2438721e-36  0              0.008737601    0.0021044044   0              101.61415      1.1971759e-13  0              3.1490188    
   1300000   18000          200            200            0.0029192884  -2.8048388e-35  0              0.0087578653   0.00017266281  0              8.3372692      1.1971759e-13  0              3.1490173    
   1400000   18000          200            200            0.0029176724   2.8048388e-37  0              0.0087530171   4.9643825e-05  0              2.3971226      1.1971759e-13  0              3.1490177    
   1500000   18000          200            200            0.0029169072   1.1219355e-36  0              0.0087507215   1.414919e-06   0              0.068321373    1.1971759e-13  0              3.1490178    
   1600000   18000          200            200            0.0029171785  -2.8048387e-37  0              0.0087515355   1.0373566e-06  0              0.05009024     1.1971759e-13  0              3.1490178    
   1700000   18000          200            200            0.0029172584   1.1219355e-36  0              0.0087517752   6.1661004e-09  0              0.00029773892  1.1971759e-13  0              3.1490178    
   1800000   18000          200            200            0.0029172166  -2.8048387e-37  0              0.0087516497   1.9620454e-08  0              0.00094740151  1.1971759e-13  0              3.1490178    
   1900000   18000          200            200            0.0029172093   2.243871e-36   0              0.0087516278   1.5801866e-13  0              7.6301558e-09  1.1971759e-13  0              3.1490178    
   2000000   18000          200            200            0.0029172153  -2.8048387e-37  0              0.008751646    3.3879107e-10  0              1.6359008e-05  1.1971759e-13  0              3.1490178    
   2100000   18000          200            200            0.0029172158   1.1219355e-36  0              0.0087516475   2.1394242e-12  0              1.0330514e-07  1.1971759e-13  0              3.1490178    
   2200000   18000          200            200            0.002917215    8.4145164e-37  0              0.008751645    5.3411092e-12  0              2.5790305e-07  1.1971759e-13  0              3.1490178    
   2300000   18000          200            200            0.002917215   -2.8048388e-36  0              0.008751645    1.3633406e-13  0              6.5830837e-09  1.1971759e-13  0              3.1490178    
   2400000   18000          200            200            0.0029172151   3.3658065e-36  0              0.0087516453   7.5922088e-14  0              3.6660059e-09  1.1971759e-13  0              3.1490178    
   2500000   18000          200            200            0.0029172151  -5.6096774e-37  0              0.0087516453   4.8488696e-15  0              2.3413456e-10  1.1971759e-13  0              3.1490178    
   2600000   18000          200            200            0.0029172151  -2.8048387e-37  0              0.0087516452   9.7922873e-16  0              4.7283451e-11  1.1971759e-13  0              3.1490178    
   2700000   18000          200            200            0.0029172151  -2.8048387e-37  0              0.0087516452   7.8212775e-17  0              3.776615e-12   1.1971759e-13  0              3.1490178    
   2800000   18000          200            200            0.0029172151  -5.6096774e-37  0              0.0087516452   2.538403e-17   0              1.225704e-12   1.1971759e-13  0              3.1490178    
   2900000   18000          200            200            0.0029172151   2.384113e-35   0              0.0087516452   1.1414476e-17  0              5.511642e-13   1.1971759e-13  0              3.1490178    
   3000000   18000          200            200            0.0029172151   1.369288e-44   0              0.0087516452   2.2094564e-18  0              1.0668674e-13  1.1971759e-13  0              3.1490178    
Loop time of 791.664 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3274116.782 ns/day, 0.000 hours/ns, 3789.487 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.28     | 239.88     | 240.48     |   3.9 | 30.30
Neigh   | 17.185     | 17.188     | 17.191     |   0.1 |  2.17
Comm    | 44.227     | 45.129     | 46.031     |  13.4 |  5.70
Output  | 0.60901    | 0.60903    | 0.60906    |   0.0 |  0.08
Modify  | 428.25     | 428.41     | 428.57     |   0.8 | 54.12
Other   |            | 60.45      |            |       |  7.64

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.31                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.7739251711113
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.41
  ghost atom cutoff = 3.41
  binsize = 1.705, bins = 10558 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 318 | 318 | 318 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0024978168   1.2613634e-41  0              0.0074934503   1341738        0              6.4787727e+10  1.1971759e-13  0              3.3179689    
    200000   18000          200            200           -0.00029026485  7.180394e-35   0             -0.00087079454  349573.4       0              1.6879649e+10  1.1971759e-13  0              3.1783677    
    300000   18000          200            200            0.0012742799   5.3852966e-35  0              0.0038228397   100463.5       0              4.851023e+09   1.1971759e-13  0              3.1543674    
    400000   18000          200            200           -6.4325537e-05  1.7951039e-35  0             -0.00019297661  4368.5526      0              2.1094177e+08  1.1971759e-13  0              3.1638193    
    500000   18000          200            200           -1.2546231e-05  5.0724383e-41  0             -3.7638694e-05  149.92466      0              7239325.1      1.1971759e-13  0              3.1566952    
    600000   18000          200            200            0.0003690132   1.7950988e-35  0              0.0011070396   15.015141      0              725027.42      1.1971759e-13  0              3.1547511    
    700000   18000          200            200            0.0020017095  -8.9754742e-36  0              0.0060051285   26.096967      0              1260129.1      1.1971759e-13  0              3.1542357    
    800000   18000          200            200            0.0026684728  -8.9754745e-36  0              0.0080054184   7.5755742      0              365797.37      1.1971759e-13  0              3.1540765    
    900000   18000          200            200            0.0030482459  -2.6926444e-35  0              0.0091447376   0.45879505     0              22153.571      1.1971759e-13  0              3.1539903    
   1000000   18000          200            200            0.0029421134   8.9754907e-36  0              0.0088263401   0.18717251     0              9037.8907      1.1971759e-13  0              3.1540136    
   1100000   18000          200            200            0.0029029825   1.346323e-35   0              0.0087089474   0.0015824215   0              76.409469      1.1971759e-13  0              3.1540225    
   1200000   18000          200            200            0.0029213322  -2.2438709e-35  0              0.0087639966   0.0037768698   0              182.37152      1.1971759e-13  0              3.1540184    
   1300000   18000          200            200            0.0029243913  -5.6096768e-37  0              0.0087731739   3.3044361e-06  0              0.15955939     1.1971759e-13  0              3.1540177    
   1400000   18000          200            200            0.0029216228  -2.8048388e-37  0              0.0087648685   6.2096517e-05  0              2.9984186      1.1971759e-13  0              3.1540183    
   1500000   18000          200            200            0.0029215385  -2.8048387e-37  0              0.0087646154   1.3096004e-06  0              0.063235919    1.1971759e-13  0              3.1540183    
   1600000   18000          200            200            0.0029219125   2.5243549e-36  0              0.0087657375   8.2036139e-07  0              0.039612315    1.1971759e-13  0              3.1540182    
   1700000   18000          200            200            0.0029218807  -8.4145162e-37  0              0.008765642    6.4852292e-08  0              0.0031314851   1.1971759e-13  0              3.1540182    
   1800000   18000          200            200            0.0029218351   1.0263922e-44  0              0.0087655053   8.0927972e-09  0              0.00039077221  1.1971759e-13  0              3.1540183    
   1900000   18000          200            200            0.0029218445  -8.4145162e-37  0              0.0087655335   1.9230218e-09  0              9.2855841e-05  1.1971759e-13  0              3.1540183    
   2000000   18000          200            200            0.0029218494   1.0421639e-44  0              0.0087655483   4.6279742e-11  0              2.2346831e-06  1.1971759e-13  0              3.1540183    
   2100000   18000          200            200            0.0029218476   1.0336835e-44  0              0.0087655429   4.2932397e-11  0              2.0730518e-06  1.1971759e-13  0              3.1540183    
   2200000   18000          200            200            0.0029218472  -5.6096774e-37  0              0.0087655416   2.0567657e-14  0              9.9313854e-10  1.1971759e-13  0              3.1540183    
   2300000   18000          200            200            0.0029218475   1.6829033e-36  0              0.0087655424   7.7307696e-13  0              3.732912e-08   1.1971759e-13  0              3.1540183    
   2400000   18000          200            200            0.0029218475   5.6096776e-37  0              0.0087655425   6.4876898e-15  0              3.1326732e-10  1.1971759e-13  0              3.1540183    
   2500000   18000          200            200            0.0029218475  -5.6096774e-37  0              0.0087655424   1.1212948e-14  0              5.4143312e-10  1.1971759e-13  0              3.1540183    
   2600000   18000          200            200            0.0029218475   5.6096777e-37  0              0.0087655424   5.2050759e-16  0              2.5133449e-11  1.1971759e-13  0              3.1540183    
   2700000   18000          200            200            0.0029218475   2.8048389e-37  0              0.0087655424   1.7060774e-16  0              8.2380374e-12  1.1971759e-13  0              3.1540183    
   2800000   18000          200            200            0.0029218475   1.0583995e-44  0              0.0087655424   4.6753605e-18  0              2.2575643e-13  1.1971759e-13  0              3.1540183    
   2900000   18000          200            200            0.0029218475  -8.4145162e-37  0              0.0087655424   1.0726053e-17  0              5.179227e-13   1.1971759e-13  0              3.1540183    
   3000000   18000          200            200            0.0029218475   8.4145164e-37  0              0.0087655424   7.9084493e-20  0              3.8187071e-15  1.1971759e-13  0              3.1540183    
Loop time of 796.468 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3254367.054 ns/day, 0.000 hours/ns, 3766.629 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.28     | 244.45     | 245.62     |   7.5 | 30.69
Neigh   | 17.58      | 17.581     | 17.582     |   0.0 |  2.21
Comm    | 45.514     | 46.449     | 47.384     |  13.7 |  5.83
Output  | 0.6113     | 0.61132    | 0.61134    |   0.0 |  0.08
Modify  | 427.82     | 427.91     | 428        |   0.4 | 53.73
Other   |            | 59.46      |            |       |  7.47

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 169
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.32                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.1536858129059
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.42
  ghost atom cutoff = 3.42
  binsize = 1.71, bins = 10527 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 312.2 | 312.2 | 312.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025044078   1.7950977e-35  0              0.0075132234   1346516.8      0              6.5018479e+10  1.1971759e-13  0              3.3177903    
    200000   18000          200            200           -0.00029227574 -3.5901797e-35  0             -0.00087682721  340736.65      0              1.6452953e+10  1.1971759e-13  0              3.1869538    
    300000   18000          200            200           -0.0002310225   1.0081921e-40  0             -0.00069306751  95797.554      0              4.625721e+09   1.1971759e-13  0              3.1615756    
    400000   18000          200            200           -5.7328032e-05 -2.6926445e-34  0             -0.0001719841   3406.0414      0              1.6446555e+08  1.1971759e-13  0              3.1692896    
    500000   18000          200            200           -4.4400709e-06  1.7951018e-35  0             -1.3320213e-05  18.133241      0              875589.31      1.1971759e-13  0              3.1617615    
    600000   18000          200            200            0.00037542552  1.3463228e-34  0              0.0011262765   14.03291       0              677599.01      1.1971759e-13  0              3.1597521    
    700000   18000          200            200            0.0018737565  -2.6926443e-35  0              0.0056212694   2.9063537      0              140337.42      1.1971759e-13  0              3.1592706    
    800000   18000          200            200            0.0028293293   9.7739465e-42  0              0.008487988    11.871667      0              573240.33      1.1971759e-13  0              3.1590414    
    900000   18000          200            200            0.0030745521  -4.4877337e-36  0              0.0092236564   0.0049069259   0              236.93789      1.1971759e-13  0              3.1589859    
   1000000   18000          200            200            0.0029179579  -3.590193e-35   0              0.0087538738   0.21351021     0              10309.644      1.1971759e-13  0              3.1590205    
   1100000   18000          200            200            0.0029083932  -8.9754804e-36  0              0.0087251795   0.003659641    0              176.71097      1.1971759e-13  0              3.1590228    
   1200000   18000          200            200            0.0029303445   1.1107269e-42  0              0.0087910335   0.0026639092   0              128.63064      1.1971759e-13  0              3.1590179    
   1300000   18000          200            200            0.0029282719   1.1219356e-36  0              0.0087848158   0.00025099002  0              12.11941       1.1971759e-13  0              3.1590183    
   1400000   18000          200            200            0.0029256976  -7.0120969e-37  0              0.0087770928   1.91355e-05    0              0.92398481     1.1971759e-13  0              3.1590189    
   1500000   18000          200            200            0.0029263634   1.9633872e-36  0              0.0087790901   7.5770516e-06  0              0.36586871     1.1971759e-13  0              3.1590187    
   1600000   18000          200            200            0.0029266006  -5.6096774e-37  0              0.0087798017   2.4231936e-08  0              0.0011700734   1.1971759e-13  0              3.1590187    
   1700000   18000          200            200            0.0029264767   1.0128464e-44  0              0.0087794302   1.4903868e-07  0              0.0071965445   1.1971759e-13  0              3.1590187    
   1800000   18000          200            200            0.0029264644  -5.6096774e-37  0              0.0087793933   1.4769048e-09  0              7.1314448e-05  1.1971759e-13  0              3.1590187    
   1900000   18000          200            200            0.0029264826   1.0268354e-44  0              0.0087794478   2.0201863e-09  0              9.7547569e-05  1.1971759e-13  0              3.1590187    
   2000000   18000          200            200            0.0029264814  -2.8048387e-37  0              0.0087794443   1.4203596e-10  0              6.858408e-06   1.1971759e-13  0              3.1590187    
   2100000   18000          200            200            0.0029264792  -1.9633871e-36  0              0.0087794377   1.6787839e-11  0              8.1062466e-07  1.1971759e-13  0              3.1590187    
   2200000   18000          200            200            0.0029264797   5.6096777e-37  0              0.0087794392   4.8148822e-12  0              2.3249343e-07  1.1971759e-13  0              3.1590187    
   2300000   18000          200            200            0.0029264799   1.0555157e-44  0              0.0087794398   4.1894178e-14  0              2.0229199e-09  1.1971759e-13  0              3.1590187    
   2400000   18000          200            200            0.0029264798   2.8048389e-37  0              0.0087794395   1.027966e-13   0              4.9636801e-09  1.1971759e-13  0              3.1590187    
   2500000   18000          200            200            0.0029264798   1.0311913e-44  0              0.0087794395   5.0120079e-16  0              2.4201192e-11  1.1971759e-13  0              3.1590187    
   2600000   18000          200            200            0.0029264798  -1.6829033e-36  0              0.0087794395   1.5344895e-15  0              7.4095006e-11  1.1971759e-13  0              3.1590187    
   2700000   18000          200            200            0.0029264798   1.0279483e-44  0              0.0087794395   4.4406902e-17  0              2.1442504e-12  1.1971759e-13  0              3.1590187    
   2800000   18000          200            200            0.0029264798   1.4024194e-36  0              0.0087794395   1.761725e-17   0              8.5067395e-13  1.1971759e-13  0              3.1590187    
   2900000   18000          200            200            0.0029264798  -1.6829033e-36  0              0.0087794395   2.3222275e-18  0              1.1213206e-13  1.1971759e-13  0              3.1590187    
   3000000   18000          200            200            0.0029264798   5.6096777e-37  0              0.0087794395   3.78836e-18    0              1.8292634e-13  1.1971759e-13  0              3.1590187    
Loop time of 790.38 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3279434.265 ns/day, 0.000 hours/ns, 3795.642 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.34     | 243.96     | 244.58     |   4.0 | 30.87
Neigh   | 15.865     | 15.866     | 15.867     |   0.0 |  2.01
Comm    | 42.341     | 42.613     | 42.885     |   4.2 |  5.39
Output  | 0.61005    | 0.61008    | 0.61011    |   0.0 |  0.08
Modify  | 427.04     | 427.2      | 427.35     |   0.7 | 54.05
Other   |            | 60.13      |            |       |  7.61

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.33                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.5357410739745
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.43
  ghost atom cutoff = 3.43
  binsize = 1.715, bins = 10496 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 311.3 | 311.3 | 311.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025109992  -7.6291609e-35  0              0.0075329975   1351302.1      0              6.5249544e+10  1.1971759e-13  0              3.3175998    
    200000   18000          200            200           -0.00029413165 -1.7950883e-35  0             -0.00088239495  332019.91      0              1.6032053e+10  1.1971759e-13  0              3.195498     
    300000   18000          200            200           -0.00022806119  3.5902012e-35  0             -0.00068418358  90997.959      0              4.3939658e+09  1.1971759e-13  0              3.1687319    
    400000   18000          200            200           -5.019875e-05   8.1611823e-41  0             -0.00015059625  2563.9651      0              1.238047e+08   1.1971759e-13  0              3.1747022    
    500000   18000          200            200            3.7995296e-06  5.3852958e-35  0              1.1398589e-05  13.817258      0              667185.92      1.1971759e-13  0              3.1667642    
    600000   18000          200            200            0.00053864456 -1.7950945e-35  0              0.0016159337   123.93718      0              5984482.8      1.1971759e-13  0              3.1646876    
    700000   18000          200            200            0.0018839264   2.6926462e-35  0              0.0056517792   3.6647247      0              176956.44      1.1971759e-13  0              3.1642701    
    800000   18000          200            200            0.0030120988   9.6379564e-42  0              0.0090362963   12.118243      0              585146.59      1.1971759e-13  0              3.164002     
    900000   18000          200            200            0.0030647288  -1.795096e-35   0              0.0091941863   0.30524488     0              14739.183      1.1971759e-13  0              3.1639895    
   1000000   18000          200            200            0.002896374    4.4877487e-36  0              0.0086891221   0.12699009     0              6131.8968      1.1971759e-13  0              3.1640269    
   1100000   18000          200            200            0.0029201319  -8.9754804e-36  0              0.0087603957   0.019399823    0              936.74801      1.1971759e-13  0              3.1640217    
   1200000   18000          200            200            0.0029377629  -1.1219354e-35  0              0.0088132888   0.00042244896  0              20.398548      1.1971759e-13  0              3.1640177    
   1300000   18000          200            200            0.0029312948   1.4585162e-35  0              0.0087938844   0.00049454076  0              23.879604      1.1971759e-13  0              3.1640191    
   1400000   18000          200            200            0.0029302024   2.8048388e-37  0              0.0087906072   2.2974477e-06  0              0.11093553     1.1971759e-13  0              3.1640194    
   1500000   18000          200            200            0.0029312608   3.9267743e-36  0              0.0087937825   6.9655713e-06  0              0.33634251     1.1971759e-13  0              3.1640192    
   1600000   18000          200            200            0.0029312038   1.0205106e-44  0              0.0087936113   4.9052096e-07  0              0.023685502    1.1971759e-13  0              3.1640192    
   1700000   18000          200            200            0.0029310753   1.0474332e-44  0              0.0087932259   4.5987809e-08  0              0.0022205867   1.1971759e-13  0              3.1640192    
   1800000   18000          200            200            0.0029311072  -8.4145162e-37  0              0.0087933215   1.7656461e-08  0              0.00085256732  1.1971759e-13  0              3.1640192    
   1900000   18000          200            200            0.002931118    1.0205252e-44  0              0.0087933541   9.0404365e-12  0              4.3653032e-07  1.1971759e-13  0              3.1640192    
   2000000   18000          200            200            0.0029311118  -2.8048387e-37  0              0.0087933353   3.2620409e-10  0              1.5751228e-05  1.1971759e-13  0              3.1640192    
   2100000   18000          200            200            0.0029311115   5.6096777e-37  0              0.0087933346   9.1857722e-12  0              4.4354807e-07  1.1971759e-13  0              3.1640192    
   2200000   18000          200            200            0.0029311124   5.6096777e-37  0              0.0087933372   3.2439007e-12  0              1.5663636e-07  1.1971759e-13  0              3.1640192    
   2300000   18000          200            200            0.0029311123   1.0220364e-44  0              0.0087933368   5.4862883e-13  0              2.6491323e-08  1.1971759e-13  0              3.1640192    
   2400000   18000          200            200            0.0029311122  -5.6096774e-37  0              0.0087933366   9.0661179e-15  0              4.3777039e-10  1.1971759e-13  0              3.1640192    
   2500000   18000          200            200            0.0029311122   5.6096777e-37  0              0.0087933367   1.3385487e-14  0              6.4633727e-10  1.1971759e-13  0              3.1640192    
   2600000   18000          200            200            0.0029311122   2.8048389e-37  0              0.0087933367   7.411088e-17   0              3.5785492e-12  1.1971759e-13  0              3.1640192    
   2700000   18000          200            200            0.0029311122   2.8048389e-37  0              0.0087933367   1.9871902e-16  0              9.5954302e-12  1.1971759e-13  0              3.1640192    
   2800000   18000          200            200            0.0029311122   5.6096776e-37  0              0.0087933367   7.1956344e-18  0              3.4745143e-13  1.1971759e-13  0              3.1640192    
   2900000   18000          200            200            0.0029311122  -8.4145162e-37  0              0.0087933367   6.0227059e-18  0              2.9081491e-13  1.1971759e-13  0              3.1640192    
   3000000   18000          200            200            0.0029311122   1.3186755e-44  0              0.0087933367   2.1079139e-18  0              1.0178362e-13  1.1971759e-13  0              3.1640192    
Loop time of 788.716 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3286352.611 ns/day, 0.000 hours/ns, 3803.649 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.75     | 242.77     | 244.79     |  13.0 | 30.78
Neigh   | 15.357     | 15.358     | 15.359     |   0.0 |  1.95
Comm    | 40.004     | 42.276     | 44.548     |  34.9 |  5.36
Output  | 0.61091    | 0.61092    | 0.61094    |   0.0 |  0.08
Modify  | 428.11     | 428.31     | 428.51     |   1.0 | 54.31
Other   |            | 59.39      |            |       |  7.53

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.34                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.920097865821
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.44
  ghost atom cutoff = 3.44
  binsize = 1.72, bins = 10466 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 310.4 | 310.4 | 310.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025175908   4.4877432e-35  0              0.0075527725   1356094        0              6.5480924e+10  1.1971759e-13  0              3.3173973    
    200000   18000          200            200           -0.00029583311  1.7951061e-35  0             -0.00088749932  323423.96      0              1.5616986e+10  1.1971759e-13  0              3.2039997    
    300000   18000          200            200           -0.00022494829 -3.5901868e-35  0             -0.00067484486  86326.938      0              4.1684189e+09  1.1971759e-13  0              3.1758354    
    400000   18000          200            200           -4.294036e-05   1.2565685e-34  0             -0.00012882108  1842.1166      0              88949216       1.1971759e-13  0              3.1800567    
    500000   18000          200            200            1.2169974e-05 -1.7950917e-35  0              3.6509921e-05  136.43524      0              6587969.5      1.1971759e-13  0              3.1717033    
    600000   18000          200            200            0.00089704164  8.9755084e-36  0              0.0026911249   315.72182      0              15245077       1.1971759e-13  0              3.1695615    
    700000   18000          200            200            0.0020321208   8.975485e-35   0              0.0060963624   27.831649      0              1343890.7      1.1971759e-13  0              3.1692343    
    800000   18000          200            200            0.0031825365   8.9754934e-36  0              0.0095476094   8.0729422      0              389813.49      1.1971759e-13  0              3.1689661    
    900000   18000          200            200            0.0030224524  -4.4877412e-35  0              0.0090673573   1.0790841      0              52105.107      1.1971759e-13  0              3.1690002    
   1000000   18000          200            200            0.0028849633  -2.6926445e-35  0              0.0086548898   0.021696302    0              1047.6368      1.1971759e-13  0              3.169031     
   1100000   18000          200            200            0.0029357142   4.4877458e-36  0              0.0088071425   0.028635944    0              1382.7272      1.1971759e-13  0              3.1690197    
   1200000   18000          200            200            0.0029424436   1.5707098e-35  0              0.0088273309   0.00035451651  0              17.118333      1.1971759e-13  0              3.1690182    
   1300000   18000          200            200            0.0029342315   4.4877421e-36  0              0.0088026945   0.00032443315  0              15.665716      1.1971759e-13  0              3.16902      
   1400000   18000          200            200            0.0029352054   1.4024194e-37  0              0.0088056163   4.2940089e-05  0              2.0734232      1.1971759e-13  0              3.1690198    
   1500000   18000          200            200            0.0029360657   9.1841281e-45  0              0.0088081972   7.8876473e-07  0              0.038086626    1.1971759e-13  0              3.1690196    
   1600000   18000          200            200            0.0029357429   8.4145164e-37  0              0.0088072287   1.1308366e-06  0              0.054604054    1.1971759e-13  0              3.1690197    
   1700000   18000          200            200            0.0029357027   1.1219355e-36  0              0.0088071081   1.5305375e-08  0              0.0007390418   1.1971759e-13  0              3.1690197    
   1800000   18000          200            200            0.0029357543  -2.8048387e-37  0              0.0088072629   1.2536735e-08  0              0.00060535408  1.1971759e-13  0              3.1690196    
   1900000   18000          200            200            0.0029357479   1.04435e-44    0              0.0088072437   1.732001e-09   0              8.3632128e-05  1.1971759e-13  0              3.1690196    
   2000000   18000          200            200            0.0029357426   1.0361535e-44  0              0.0088072277   2.8292865e-11  0              1.3661612e-06  1.1971759e-13  0              3.1690197    
   2100000   18000          200            200            0.0029357446  -5.6096774e-37  0              0.0088072338   4.4642723e-11  0              2.1556373e-06  1.1971759e-13  0              3.1690197    
   2200000   18000          200            200            0.0029357449   5.6096777e-37  0              0.0088072346   6.5971638e-13  0              3.1855343e-08  1.1971759e-13  0              3.1690197    
   2300000   18000          200            200            0.0029357445   8.4145164e-37  0              0.0088072336   4.8377316e-13  0              2.3359674e-08  1.1971759e-13  0              3.1690197    
   2400000   18000          200            200            0.0029357446  -2.8048387e-37  0              0.0088072337   6.9591919e-14  0              3.3603447e-09  1.1971759e-13  0              3.1690197    
   2500000   18000          200            200            0.0029357446   1.4024194e-36  0              0.0088072338   9.5058714e-16  0              4.5900451e-11  1.1971759e-13  0              3.1690197    
   2600000   18000          200            200            0.0029357446  -2.8048387e-37  0              0.0088072338   1.7548701e-15  0              8.4736396e-11  1.1971759e-13  0              3.1690197    
   2700000   18000          200            200            0.0029357446   2.5243549e-36  0              0.0088072338   4.2730689e-18  0              2.063312e-13   1.1971759e-13  0              3.1690197    
   2800000   18000          200            200            0.0029357446  -2.8048387e-37  0              0.0088072338   1.9020656e-17  0              9.1843938e-13  1.1971759e-13  0              3.1690197    
   2900000   18000          200            200            0.0029357446   9.9993251e-45  0              0.0088072338   8.4484471e-18  0              4.0794528e-13  1.1971759e-13  0              3.1690197    
   3000000   18000          200            200            0.0029357446  -5.6096775e-37  0              0.0088072338   3.9419155e-18  0              1.9034099e-13  1.1971759e-13  0              3.1690197    
Loop time of 789.465 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3283234.522 ns/day, 0.000 hours/ns, 3800.040 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.35     | 244.15     | 244.95     |   5.1 | 30.93
Neigh   | 15.407     | 15.408     | 15.41      |   0.0 |  1.95
Comm    | 40.784     | 41.98      | 43.175     |  18.5 |  5.32
Output  | 0.60544    | 0.60545    | 0.60547    |   0.0 |  0.08
Modify  | 427.32     | 427.53     | 427.73     |   1.0 | 54.15
Other   |            | 59.79      |            |       |  7.57

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.35                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.3067630999496
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.45
  ghost atom cutoff = 3.45
  binsize = 1.725, bins = 10435 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 304.7 | 304.7 | 304.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025241827  -1.7950951e-35  0              0.0075725482   1360892.3      0              6.5712618e+10  1.1971759e-13  0              3.3171828    
    200000   18000          200            200           -0.00029738076  7.3675978e-41  0             -0.00089214229  314948.33      0              1.5207728e+10  1.1971759e-13  0              3.212459     
    300000   18000          200            200           -0.00022168463 -3.5901859e-35  0             -0.00066505388  81784.067      0              3.9490599e+09  1.1971759e-13  0              3.182886     
    400000   18000          200            200           -3.555402e-05  -1.7950904e-35  0             -0.00010666206  1240.0518      0              59877662       1.1971759e-13  0              3.1853532    
    500000   18000          200            200            2.0669862e-05  8.9754845e-34  0              6.2009585e-05  385.39872      0              18609525       1.1971759e-13  0              3.1765787    
    600000   18000          200            200            0.0014934974  -1.7950948e-35  0              0.0044804923   529.34937      0              25560386       1.1971759e-13  0              3.1743831    
    700000   18000          200            200            0.0023084028  -8.9754736e-36  0              0.0069252083   62.781279      0              3031483.3      1.1971759e-13  0              3.1741681    
    800000   18000          200            200            0.0033064803  -4.4877411e-35  0              0.009919441    2.6982622      0              130289.43      1.1971759e-13  0              3.1739407    
    900000   18000          200            200            0.0029595035   4.4877498e-36  0              0.0088785106   1.6190989      0              78180.494      1.1971759e-13  0              3.1740156    
   1000000   18000          200            200            0.0028883147  -2.2438703e-35  0              0.008664944    0.010767036    0              519.90165      1.1971759e-13  0              3.1740317    
   1100000   18000          200            200            0.0029513192   5.3852908e-35  0              0.0088539576   0.019633333    0              948.0234       1.1971759e-13  0              3.1740177    
   1200000   18000          200            200            0.0029443749   4.487743e-36   0              0.0088331246   0.0025343383   0              122.37413      1.1971759e-13  0              3.1740192    
   1300000   18000          200            200            0.0029378891  -1.1219354e-36  0              0.0088136672   2.7550634e-05  0              1.3303215      1.1971759e-13  0              3.1740207    
   1400000   18000          200            200            0.0029405024   2.8048388e-37  0              0.0088215073   6.3996233e-05  0              3.0901491      1.1971759e-13  0              3.1740201    
   1500000   18000          200            200            0.0029406716  -2.8048387e-37  0              0.0088220147   1.9732204e-06  0              0.09527975     1.1971759e-13  0              3.17402      
   1600000   18000          200            200            0.0029402833   2.8048389e-37  0              0.0088208498   4.6907416e-07  0              0.022649913    1.1971759e-13  0              3.1740201    
   1700000   18000          200            200            0.0029403627  -1.9633871e-36  0              0.0088210882   1.327054e-07   0              0.0064078687   1.1971759e-13  0              3.1740201    
   1800000   18000          200            200            0.002940393   -2.8048387e-37  0              0.0088211791   2.7969717e-11  0              1.3505575e-06  1.1971759e-13  0              3.1740201    
   1900000   18000          200            200            0.0029403746   1.1219355e-36  0              0.0088211239   2.167861e-09   0              0.00010467825  1.1971759e-13  0              3.1740201    
   2000000   18000          200            200            0.0029403755   3.0853227e-36  0              0.0088211264   1.662222e-10   0              8.0262753e-06  1.1971759e-13  0              3.1740201    
   2100000   18000          200            200            0.0029403777   2.8048389e-37  0              0.008821133    7.5652614e-12  0              3.652994e-07   1.1971759e-13  0              3.1740201    
   2200000   18000          200            200            0.002940377   -1.6829033e-36  0              0.0088211309   5.8456149e-12  0              2.8226382e-07  1.1971759e-13  0              3.1740201    
   2300000   18000          200            200            0.0029403769  -5.6096774e-37  0              0.0088211306   7.3450306e-14  0              3.5466524e-09  1.1971759e-13  0              3.1740201    
   2400000   18000          200            200            0.002940377    1.4024194e-36  0              0.008821131    6.1597896e-14  0              2.974342e-09   1.1971759e-13  0              3.1740201    
   2500000   18000          200            200            0.002940377   -5.6096774e-37  0              0.0088211309   1.0126605e-14  0              4.8897751e-10  1.1971759e-13  0              3.1740201    
   2600000   18000          200            200            0.002940377    2.8048389e-37  0              0.0088211309   4.8043291e-17  0              2.3198386e-12  1.1971759e-13  0              3.1740201    
   2700000   18000          200            200            0.002940377   -3.9267743e-36  0              0.0088211309   2.3156106e-16  0              1.1181255e-11  1.1971759e-13  0              3.1740201    
   2800000   18000          200            200            0.002940377   -1.4024194e-36  0              0.0088211309   9.4353808e-19  0              4.5560077e-14  1.1971759e-13  0              3.1740201    
   2900000   18000          200            200            0.002940377   -2.8048387e-37  0              0.0088211309   2.7261006e-19  0              1.3163364e-14  1.1971759e-13  0              3.1740201    
   3000000   18000          200            200            0.002940377    1.1219355e-36  0              0.0088211309   2.707048e-18   0              1.3071366e-13  1.1971759e-13  0              3.1740201    
Loop time of 782.334 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3313161.177 ns/day, 0.000 hours/ns, 3834.677 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.28     | 238.65     | 239.01     |   2.4 | 30.50
Neigh   | 15.461     | 15.461     | 15.462     |   0.0 |  1.98
Comm    | 40.573     | 41.27      | 41.967     |  10.9 |  5.28
Output  | 0.60688    | 0.60689    | 0.60691    |   0.0 |  0.08
Modify  | 427.14     | 427.22     | 427.29     |   0.4 | 54.61
Other   |            | 59.13      |            |       |  7.56

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.36                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.6957436878637
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.46
  ghost atom cutoff = 3.46
  binsize = 1.73, bins = 10405 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 303.9 | 303.9 | 303.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025307749   2.6926464e-35  0              0.0075923247   1365697.1      0              6.5944625e+10  1.1971759e-13  0              3.3169564    
    200000   18000          200            200           -0.00029877526  1.7950976e-34  0             -0.00089632579  306592.35      0              1.4804247e+10  1.1971759e-13  0              3.2208759    
    300000   18000          200            200           -0.0002182704   3.5902002e-35  0             -0.00065481121  77368.207      0              3.7358338e+09  1.1971759e-13  0              3.1898841    
    400000   18000          200            200           -2.8038925e-05  1.7951029e-35  0             -8.4116774e-05  757.20249      0              36562598       1.1971759e-13  0              3.1905915    
    500000   18000          200            200            2.9299786e-05 -5.3852854e-35  0              8.7899359e-05  760.20341      0              36707502       1.1971759e-13  0              3.1813903    
    600000   18000          200            200            0.0023360269   1.7950992e-35  0              0.0070080806   682.31115      0              32946363       1.1971759e-13  0              3.1791675    
    700000   18000          200            200            0.0026879789  -4.4877409e-35  0              0.0080639366   89.52313       0              4322751.6      1.1971759e-13  0              3.1790807    
    800000   18000          200            200            0.003358049    5.3852914e-35  0              0.010074147    0.014192955    0              685.327        1.1971759e-13  0              3.178931     
    900000   18000          200            200            0.0028924493  -4.4877341e-36  0              0.0086773478   1.440261       0              69545.048      1.1971759e-13  0              3.179032     
   1000000   18000          200            200            0.0029067734  -8.9754769e-36  0              0.0087203202   0.10493423     0              5066.8986      1.1971759e-13  0              3.1790291    
   1100000   18000          200            200            0.0029631196   3.6658682e-42  0              0.0088893587   0.0038905569   0              187.86107      1.1971759e-13  0              3.1790166    
   1200000   18000          200            200            0.0029446717   4.487743e-36   0              0.0088340152   0.003741479    0              180.66263      1.1971759e-13  0              3.1790206    
   1300000   18000          200            200            0.002942727    1.1219356e-36  0              0.0088281811   9.8969184e-05  0              4.7788677      1.1971759e-13  0              3.1790211    
   1400000   18000          200            200            0.0029457309   1.6544048e-45  0              0.0088371928   2.5986737e-05  0              1.2548065      1.1971759e-13  0              3.1790204    
   1500000   18000          200            200            0.0029450956  -1.6829033e-36  0              0.0088352867   7.9656196e-06  0              0.38463126     1.1971759e-13  0              3.1790206    
   1600000   18000          200            200            0.0029448888   1.024969e-44   0              0.0088346663   2.7806186e-08  0              0.0013426612   1.1971759e-13  0              3.1790206    
   1700000   18000          200            200            0.0029450338   1.4024194e-36  0              0.0088351013   1.0365697e-07  0              0.0050052241   1.1971759e-13  0              3.1790206    
   1800000   18000          200            200            0.002945018   -2.8048387e-37  0              0.0088350539   1.3806889e-08  0              0.00066668525  1.1971759e-13  0              3.1790206    
   1900000   18000          200            200            0.0029450036   1.0384607e-44  0              0.0088350107   5.6227175e-11  0              2.7150091e-06  1.1971759e-13  0              3.1790206    
   2000000   18000          200            200            0.0029450099   2.8048389e-37  0              0.0088350297   3.1292599e-10  0              1.5110076e-05  1.1971759e-13  0              3.1790206    
   2100000   18000          200            200            0.0029450099   3.0853227e-36  0              0.0088350298   1.8166685e-11  0              8.7720418e-07  1.1971759e-13  0              3.1790206    
   2200000   18000          200            200            0.0029450091  -1.9633871e-36  0              0.0088350273   1.1295285e-12  0              5.4540888e-08  1.1971759e-13  0              3.1790206    
   2300000   18000          200            200            0.0029450093  -1.4024194e-36  0              0.008835028    7.6967114e-13  0              3.7164665e-08  1.1971759e-13  0              3.1790206    
   2400000   18000          200            200            0.0029450094   4.2072582e-36  0              0.0088350281   1.4782696e-14  0              7.1380348e-10  1.1971759e-13  0              3.1790206    
   2500000   18000          200            200            0.0029450093   1.1219355e-36  0              0.008835028    6.1489389e-15  0              2.9691025e-10  1.1971759e-13  0              3.1790206    
   2600000   18000          200            200            0.0029450093  -2.8048387e-37  0              0.008835028    1.5328585e-15  0              7.4016251e-11  1.1971759e-13  0              3.1790206    
   2700000   18000          200            200            0.0029450093   5.6096777e-37  0              0.008835028    1.4238709e-20  0              6.8753628e-16  1.1971759e-13  0              3.1790206    
   2800000   18000          200            200            0.0029450093   1.0381371e-44  0              0.008835028    2.1674752e-17  0              1.0465962e-12  1.1971759e-13  0              3.1790206    
   2900000   18000          200            200            0.0029450093  -4.487742e-36   0              0.008835028    1.2643628e-18  0              6.1051555e-14  1.1971759e-13  0              3.1790206    
   3000000   18000          200            200            0.0029450093  -5.6096774e-37  0              0.008835028    1.1180559e-17  0              5.398692e-13   1.1971759e-13  0              3.1790206    
Loop time of 782.497 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3312470.665 ns/day, 0.000 hours/ns, 3833.878 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.77     | 239.33     | 240.9      |  10.1 | 30.59
Neigh   | 15.148     | 15.148     | 15.148     |   0.0 |  1.94
Comm    | 39.671     | 41.478     | 43.286     |  28.1 |  5.30
Output  | 0.6087     | 0.60872    | 0.60875    |   0.0 |  0.08
Modify  | 427.06     | 427.11     | 427.16     |   0.2 | 54.58
Other   |            | 58.82      |            |       |  7.52

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.37                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.0870465410674
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.47
  ghost atom cutoff = 3.47
  binsize = 1.735, bins = 10375 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 303 | 303 | 303 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025373672  -8.5267093e-35  0              0.0076121016   1370508.3      0              6.6176942e+10  1.1971759e-13  0              3.3167181    
    200000   18000          200            200           -0.00030001721 -1.7950905e-35  0             -0.00090005164  298356.59      0              1.4406572e+10  1.1971759e-13  0              3.22925      
    300000   18000          200            200           -0.00021470727  9.0471396e-41  0             -0.00064412181  73079.907      0              3.5287672e+09  1.1971759e-13  0              3.196829     
    400000   18000          200            200           -2.0397881e-05 -3.5901865e-35  0             -6.1193644e-05  393.25539      0              18988895       1.1971759e-13  0              3.1957715    
    500000   18000          200            200            3.8056758e-05  3.5901986e-35  0              0.00011417027  1260.2081      0              60850941       1.1971759e-13  0              3.1861382    
    600000   18000          200            200            0.0033694119   2.6926474e-35  0              0.010108236    699.29783      0              33766589       1.1971759e-13  0              3.1839363    
    700000   18000          200            200            0.0031256697  -8.0779346e-35  0              0.0093770091   92.390481      0              4461205.7      1.1971759e-13  0              3.1839847    
    800000   18000          200            200            0.0033266965   1.0770582e-34  0              0.0099800895   2.0282501      0              97936.938      1.1971759e-13  0              3.1839389    
    900000   18000          200            200            0.0028383679  -8.9754762e-36  0              0.0085151037   0.70978825     0              34273.135      1.1971759e-13  0              3.1840456    
   1000000   18000          200            200            0.0029363659  -8.9754769e-36  0              0.0088090978   0.20210047     0              9758.7085      1.1971759e-13  0              3.1840241    
   1100000   18000          200            200            0.0029686182  -1.3463223e-35  0              0.0089058545   0.0013505588   0              65.213651      1.1971759e-13  0              3.1840168    
   1200000   18000          200            200            0.0029451097   9.4769271e-43  0              0.0088353291   0.0022124934   0              106.83339      1.1971759e-13  0              3.184022     
   1300000   18000          200            200            0.0029486442   3.9267744e-36  0              0.0088459326   0.00041565905  0              20.070688      1.1971759e-13  0              3.1840213    
   1400000   18000          200            200            0.0029505679   1.5506043e-45  0              0.0088517038   3.0297256e-07  0              0.014629461    1.1971759e-13  0              3.1840208    
   1500000   18000          200            200            0.0029494667  -2.8048387e-37  0              0.0088484001   6.2563783e-06  0              0.30209812     1.1971759e-13  0              3.1840211    
   1600000   18000          200            200            0.0029495777   1.1219355e-36  0              0.008848733    8.0921252e-07  0              0.039073976    1.1971759e-13  0              3.184021     
   1700000   18000          200            200            0.0029496859  -8.4145162e-37  0              0.0088490577   1.0064746e-09  0              4.8599055e-05  1.1971759e-13  0              3.184021     
   1800000   18000          200            200            0.0029496355  -8.4145162e-37  0              0.0088489065   1.6610297e-08  0              0.00080205178  1.1971759e-13  0              3.184021     
   1900000   18000          200            200            0.0029496379  -8.4145162e-37  0              0.0088489138   1.4779123e-09  0              7.1363096e-05  1.1971759e-13  0              3.184021     
   2000000   18000          200            200            0.0029496438  -8.4145162e-37  0              0.0088489313   1.8074395e-11  0              8.7274786e-07  1.1971759e-13  0              3.184021     
   2100000   18000          200            200            0.0029496415   2.8048389e-37  0              0.0088489246   4.1788833e-11  0              2.0178332e-06  1.1971759e-13  0              3.184021     
   2200000   18000          200            200            0.0029496415   8.4145164e-37  0              0.0088489245   2.4914707e-12  0              1.203042e-07   1.1971759e-13  0              3.184021     
   2300000   18000          200            200            0.0029496418   2.8048389e-37  0              0.0088489254   1.0878635e-13  0              5.2529034e-09  1.1971759e-13  0              3.184021     
   2400000   18000          200            200            0.0029496417   8.4145164e-37  0              0.0088489251   1.0013373e-13  0              4.8350993e-09  1.1971759e-13  0              3.184021     
   2500000   18000          200            200            0.0029496417  -5.6096774e-37  0              0.0088489251   3.9260132e-15  0              1.8957313e-10  1.1971759e-13  0              3.184021     
   2600000   18000          200            200            0.0029496417   8.1340325e-36  0              0.0088489251   4.9951366e-16  0              2.4119727e-11  1.1971759e-13  0              3.184021     
   2700000   18000          200            200            0.0029496417   8.4145164e-37  0              0.0088489251   2.1830782e-16  0              1.0541303e-11  1.1971759e-13  0              3.184021     
   2800000   18000          200            200            0.0029496417   2.5243549e-36  0              0.0088489251   6.6963593e-18  0              3.2334323e-13  1.1971759e-13  0              3.184021     
   2900000   18000          200            200            0.0029496417   1.1722858e-44  0              0.0088489251   7.4830286e-18  0              3.6132867e-13  1.1971759e-13  0              3.184021     
   3000000   18000          200            200            0.0029496417  -1.1219355e-36  0              0.0088489251   4.6487735e-18  0              2.2447263e-13  1.1971759e-13  0              3.184021     
Loop time of 787.907 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3289727.934 ns/day, 0.000 hours/ns, 3807.555 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.73     | 242.89     | 244.05     |   7.4 | 30.83
Neigh   | 15.283     | 15.284     | 15.285     |   0.0 |  1.94
Comm    | 40.293     | 41.73      | 43.166     |  22.2 |  5.30
Output  | 0.60712    | 0.60712    | 0.60713    |   0.0 |  0.08
Modify  | 429.02     | 429.21     | 429.39     |   0.9 | 54.47
Other   |            | 58.19      |            |       |  7.39

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.38                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.4806785710646
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.48
  ghost atom cutoff = 3.48
  binsize = 1.74, bins = 10345 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 297.4 | 297.4 | 297.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025439597   8.8928049e-42  0              0.0076318791   1375326.1      0              6.6409574e+10  1.1971759e-13  0              3.3164677    
    200000   18000          200            200           -0.00030110728 -7.1803774e-35  0             -0.00090332183  290239.93      0              1.4014647e+10  1.1971759e-13  0              3.2375817    
    300000   18000          200            200           -0.0002109957   5.3852972e-35  0             -0.00063298709  68918.342      0              3.3278201e+09  1.1971759e-13  0              3.203721     
    400000   18000          200            200           -1.2631294e-05 -8.9754779e-35  0             -3.7893883e-05  147.71763      0              7132755.8      1.1971759e-13  0              3.2008931    
    500000   18000          200            200            4.6940016e-05  3.5901986e-35  0              0.00014082005  1884.841       0              91012226       1.1971759e-13  0              3.1908222    
    600000   18000          200            200            0.004467175    1.7950991e-35  0              0.013401525    556.19475      0              26856654       1.1971759e-13  0              3.1887157    
    700000   18000          200            200            0.0035565207   8.9754959e-36  0              0.010669562    68.64933       0              3314830.5      1.1971759e-13  0              3.1888945    
    800000   18000          200            200            0.0032203397   7.1803882e-35  0              0.0096610192   7.1755463      0              346481.45      1.1971759e-13  0              3.188963     
    900000   18000          200            200            0.0028108273   1.3463234e-35  0              0.008432482    0.08235834     0              3976.7895      1.1971759e-13  0              3.1890534    
   1000000   18000          200            200            0.0029698969  -4.4877349e-36  0              0.0089096908   0.19754508     0              9538.7449      1.1971759e-13  0              3.1890181    
   1100000   18000          200            200            0.0029675267   4.4877455e-36  0              0.0089025802   0.015072034    0              727.7746       1.1971759e-13  0              3.1890185    
   1200000   18000          200            200            0.0029473936  -2.24387e-36    0              0.0088421809   0.00019215826  0              9.2786344      1.1971759e-13  0              3.189023     
   1300000   18000          200            200            0.0029550314   1.6829033e-36  0              0.0088650941   0.00044899429  0              21.680328      1.1971759e-13  0              3.1890213    
   1400000   18000          200            200            0.0029549044  -7.0120969e-37  0              0.0088647133   3.4552928e-05  0              1.6684373      1.1971759e-13  0              3.1890213    
   1500000   18000          200            200            0.0029539452  -5.6096775e-37  0              0.0088618357   4.2472809e-07  0              0.020508599    1.1971759e-13  0              3.1890216    
   1600000   18000          200            200            0.0029543107  -1.1219355e-36  0              0.008862932    1.0211489e-06  0              0.049307624    1.1971759e-13  0              3.1890215    
   1700000   18000          200            200            0.002954304    8.4145164e-37  0              0.0088629121   7.9293045e-08  0              0.0038287774   1.1971759e-13  0              3.1890215    
   1800000   18000          200            200            0.0029542584   1.1219355e-36  0              0.0088627751   9.3774834e-10  0              4.5280511e-05  1.1971759e-13  0              3.1890215    
   1900000   18000          200            200            0.0029542758   1.0271135e-44  0              0.0088628275   2.3224501e-09  0              0.0001121428   1.1971759e-13  0              3.1890215    
   2000000   18000          200            200            0.0029542755  -2.8048387e-37  0              0.0088628265   1.8194892e-10  0              8.785662e-06   1.1971759e-13  0              3.1890215    
   2100000   18000          200            200            0.0029542733   2.8048389e-37  0              0.00886282     2.0696656e-12  0              9.9936744e-08  1.1971759e-13  0              3.1890215    
   2200000   18000          200            200            0.0029542742   1.0540685e-44  0              0.0088628225   5.2809492e-12  0              2.5499814e-07  1.1971759e-13  0              3.1890215    
   2300000   18000          200            200            0.0029542741  -5.6096774e-37  0              0.0088628224   4.176169e-13   0              2.0165226e-08  1.1971759e-13  0              3.1890215    
   2400000   18000          200            200            0.002954274   -1.6829033e-36  0              0.0088628221   4.7173612e-15  0              2.2778449e-10  1.1971759e-13  0              3.1890215    
   2500000   18000          200            200            0.0029542741  -1.6829033e-36  0              0.0088628222   1.1998186e-14  0              5.7934947e-10  1.1971759e-13  0              3.1890215    
   2600000   18000          200            200            0.0029542741   1.0421927e-44  0              0.0088628222   8.8120989e-16  0              4.2550472e-11  1.1971759e-13  0              3.1890215    
   2700000   18000          200            200            0.0029542741  -8.4145162e-37  0              0.0088628222   2.2637335e-17  0              1.0930759e-12  1.1971759e-13  0              3.1890215    
   2800000   18000          200            200            0.0029542741  -5.6096774e-37  0              0.0088628222   2.403747e-17   0              1.1606834e-12  1.1971759e-13  0              3.1890215    
   2900000   18000          200            200            0.0029542741  -2.8048387e-37  0              0.0088628222   7.4286841e-19  0              3.5870457e-14  1.1971759e-13  0              3.1890215    
   3000000   18000          200            200            0.0029542741   1.1219355e-36  0              0.0088628222   1.0928424e-18  0              5.2769451e-14  1.1971759e-13  0              3.1890215    
Loop time of 783.592 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3307843.842 ns/day, 0.000 hours/ns, 3828.523 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.96     | 238.44     | 238.93     |   3.2 | 30.43
Neigh   | 15.279     | 15.279     | 15.28      |   0.0 |  1.95
Comm    | 41.62      | 41.838     | 42.056     |   3.4 |  5.34
Output  | 0.60931    | 0.60934    | 0.60937    |   0.0 |  0.08
Modify  | 426.95     | 427.12     | 427.28     |   0.8 | 54.51
Other   |            | 60.3       |            |       |  7.70

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.39                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.8766466893589
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.49
  ghost atom cutoff = 3.49
  binsize = 1.745, bins = 10316 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 296.6 | 296.6 | 296.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025505524  -3.2311742e-34  0              0.0076516571   1380150.3      0              6.6642521e+10  1.1971759e-13  0              3.3162052    
    200000   18000          200            200           -0.00030204608  5.3852986e-35  0             -0.00090613823  282241.89      0              1.3628451e+10  1.1971759e-13  0              3.2458708    
    300000   18000          200            200           -0.00020713608 -3.5901857e-35  0             -0.00062140825  64882.73       0              3.1329548e+09  1.1971759e-13  0              3.21056      
    400000   18000          200            200           -4.7387836e-06 -1.7950907e-35  0             -1.4216351e-05  20.122486      0              971642.85      1.1971759e-13  0              3.2059563    
    500000   18000          200            200            5.5950179e-05  3.5901983e-35  0              0.00016785054  2633.6734      0              1.2717066e+08  1.1971759e-13  0              3.1954421    
    600000   18000          200            200            0.0054489123  -8.975465e-36   0              0.016346737    310.03487      0              14970475       1.1971759e-13  0              3.1935338    
    700000   18000          200            200            0.0039054176  -2.6926442e-35  0              0.011716253    31.742635      0              1532738.2      1.1971759e-13  0              3.1938243    
    800000   18000          200            200            0.0030630256  -8.9754755e-36  0              0.0091890769   11.561092      0              558243.77      1.1971759e-13  0              3.1939983    
    900000   18000          200            200            0.0028170972  -8.9754757e-36  0              0.0084512915   0.111799       0              5398.3736      1.1971759e-13  0              3.1940535    
   1000000   18000          200            200            0.0029989708  -8.975477e-36   0              0.0089969125   0.096331976    0              4651.5264      1.1971759e-13  0              3.1940132    
   1100000   18000          200            200            0.0029618513   4.4877455e-36  0              0.0088855539   0.027564084    0              1330.971       1.1971759e-13  0              3.1940212    
   1200000   18000          200            200            0.0029524694   3.8145808e-35  0              0.0088574083   0.00061503372  0              29.697777      1.1971759e-13  0              3.1940234    
   1300000   18000          200            200            0.002961062    7.1390984e-44  0              0.008883186    0.00014502376  0              7.0026783      1.1971759e-13  0              3.1940215    
   1400000   18000          200            200            0.0029589017  -1.8231452e-36  0              0.008876705    6.4392261e-05  0              3.1092718      1.1971759e-13  0              3.1940219    
   1500000   18000          200            200            0.0029586246   6.7316131e-36  0              0.0088758739   2.5194542e-06  0              0.12165543     1.1971759e-13  0              3.194022     
   1600000   18000          200            200            0.0029590185   1.9633872e-36  0              0.0088770554   1.8371214e-07  0              0.008870802    1.1971759e-13  0              3.1940219    
   1700000   18000          200            200            0.0029588992  -2.8048387e-37  0              0.0088766977   1.4312979e-07  0              0.0069112255   1.1971759e-13  0              3.1940219    
   1800000   18000          200            200            0.0029588945   1.1219355e-36  0              0.0088766836   8.6754843e-09  0              0.00041890809  1.1971759e-13  0              3.1940219    
   1900000   18000          200            200            0.0029589121  -2.8048388e-36  0              0.0088767362   1.6823376e-10  0              8.123406e-06   1.1971759e-13  0              3.1940219    
   2000000   18000          200            200            0.0029589058   8.4145164e-37  0              0.0088767173   3.0228045e-10  0              1.4596041e-05  1.1971759e-13  0              3.1940219    
   2100000   18000          200            200            0.002958906   -2.8048387e-37  0              0.0088767179   2.6680619e-11  0              1.2883116e-06  1.1971759e-13  0              3.1940219    
   2200000   18000          200            200            0.0029589067  -6.1706453e-36  0              0.0088767201   6.0072452e-14  0              2.9006837e-09  1.1971759e-13  0              3.1940219    
   2300000   18000          200            200            0.0029589064   1.0227222e-44  0              0.0088767192   6.0277565e-13  0              2.9105879e-08  1.1971759e-13  0              3.1940219    
   2400000   18000          200            200            0.0029589064   8.4145164e-37  0              0.0088767192   7.6385461e-14  0              3.6883805e-09  1.1971759e-13  0              3.1940219    
   2500000   18000          200            200            0.0029589064   1.0203215e-44  0              0.0088767193   5.459192e-17   0              2.6360485e-12  1.1971759e-13  0              3.1940219    
   2600000   18000          200            200            0.0029589064  -1.9633871e-36  0              0.0088767193   1.1757568e-15  0              5.6773088e-11  1.1971759e-13  0              3.1940219    
   2700000   18000          200            200            0.0029589064  -5.6096774e-37  0              0.0088767193   1.7675652e-16  0              8.5349397e-12  1.1971759e-13  0              3.1940219    
   2800000   18000          200            200            0.0029589064  -2.6085001e-35  0              0.0088767193   1.5121511e-18  0              7.3016367e-14  1.1971759e-13  0              3.1940219    
   2900000   18000          200            200            0.0029589064  -2.8048387e-37  0              0.0088767193   9.971905e-18   0              4.815076e-13   1.1971759e-13  0              3.1940219    
   3000000   18000          200            200            0.0029589064  -2.8048387e-37  0              0.0088767193   4.2615071e-18  0              2.0577293e-13  1.1971759e-13  0              3.1940219    
Loop time of 785.593 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3299417.462 ns/day, 0.000 hours/ns, 3818.770 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.45     | 239.84     | 240.24     |   2.5 | 30.53
Neigh   | 15.335     | 15.337     | 15.34      |   0.1 |  1.95
Comm    | 40.879     | 41.547     | 42.214     |  10.4 |  5.29
Output  | 0.61141    | 0.61143    | 0.61145    |   0.0 |  0.08
Modify  | 426.87     | 426.92     | 426.97     |   0.2 | 54.34
Other   |            | 61.33      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.4                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.2749578074541
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.5
  ghost atom cutoff = 3.5
  binsize = 1.75, bins = 10286 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 295.8 | 295.8 | 295.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025571451  -3.5901925e-35  0              0.0076714353   1384981.1      0              6.6875781e+10  1.1971759e-13  0              3.3159305    
    200000   18000          200            200           -0.00030283423  1.795108e-35   0             -0.00090850269  274362.37      0              1.3247977e+10  1.1971759e-13  0              3.2541173    
    300000   18000          200            200           -0.00020312951  1.077059e-34   0             -0.00060938853  60972.959      0              2.944166e+09   1.1971759e-13  0              3.2173459    
    400000   18000          200            200            3.2782202e-06  1.7951024e-35  0              9.8346606e-06  10.06854       0              486173.78      1.1971759e-13  0              3.2109609    
    500000   18000          200            200            6.5415402e-05  5.1560837e-41  0              0.0001962462   3506.1618      0              1.693e+08      1.1971759e-13  0              3.1999979    
    600000   18000          200            200            0.0061230223   1.9769196e-41  0              0.018369067    83.698836      0              4041517.2      1.1971759e-13  0              3.1984156    
    700000   18000          200            200            0.0041044935  -8.9754728e-36  0              0.012313481    4.2298799      0              204245.76      1.1971759e-13  0              3.1987857    
    800000   18000          200            200            0.0028883386   9.8730334e-35  0              0.0086650159   11.954987      0              577263.53      1.1971759e-13  0              3.1990382    
    900000   18000          200            200            0.002856805    8.9754928e-36  0              0.008570415    0.76604762     0              36989.698      1.1971759e-13  0              3.1990462    
   1000000   18000          200            200            0.003016426    6.9540064e-42  0              0.009049278    0.007489144    0              361.62396      1.1971759e-13  0              3.1990108    
   1100000   18000          200            200            0.0029551715  -8.9754806e-36  0              0.0088655145   0.023068471    0              1113.8939      1.1971759e-13  0              3.1990242    
   1200000   18000          200            200            0.0029601506   4.4877431e-36  0              0.0088804519   0.002840421    0              137.15376      1.1971759e-13  0              3.1990231    
   1300000   18000          200            200            0.0029660814  -6.731613e-36   0              0.0088982441   7.3173628e-06  0              0.35332926     1.1971759e-13  0              3.1990218    
   1400000   18000          200            200            0.0029629018  -7.0120969e-37  0              0.0088887055   3.4371083e-05  0              1.6596566      1.1971759e-13  0              3.1990225    
   1500000   18000          200            200            0.0029634755   5.6096776e-37  0              0.0088904264   8.1385528e-06  0              0.39298159     1.1971759e-13  0              3.1990224    
   1600000   18000          200            200            0.0029636496   2.8048389e-37  0              0.0088909488   1.9659563e-07  0              0.0094928995   1.1971759e-13  0              3.1990224    
   1700000   18000          200            200            0.0029634999  -5.6096774e-37  0              0.0088904998   3.4823602e-08  0              0.0016815071   1.1971759e-13  0              3.1990224    
   1800000   18000          200            200            0.0029635408  -2.8048387e-37  0              0.0088906223   1.8995909e-08  0              0.00091724446  1.1971759e-13  0              3.1990224    
   1900000   18000          200            200            0.0029635431   2.8048389e-37  0              0.0088906292   1.1654492e-09  0              5.627537e-05   1.1971759e-13  0              3.1990224    
   2000000   18000          200            200            0.0029635367  -8.4145162e-37  0              0.0088906101   1.295365e-11   0              6.2548542e-07  1.1971759e-13  0              3.1990224    
   2100000   18000          200            200            0.0029635391  -5.6096774e-37  0              0.0088906174   3.6319984e-11  0              1.753762e-06   1.1971759e-13  0              3.1990224    
   2200000   18000          200            200            0.0029635389   2.8048389e-37  0              0.0088906168   4.3802833e-12  0              2.115082e-07   1.1971759e-13  0              3.1990224    
   2300000   18000          200            200            0.0029635387   8.4145164e-37  0              0.0088906161   9.5479306e-15  0              4.610354e-10   1.1971759e-13  0              3.1990224    
   2400000   18000          200            200            0.0029635388   5.6096777e-37  0              0.0088906165   5.4597141e-14  0              2.6363006e-09  1.1971759e-13  0              3.1990224    
   2500000   18000          200            200            0.0029635388  -2.8048387e-37  0              0.0088906164   1.267511e-14   0              6.120357e-10   1.1971759e-13  0              3.1990224    
   2600000   18000          200            200            0.0029635388   1.6829033e-36  0              0.0088906164   2.5245208e-16  0              1.2190007e-11  1.1971759e-13  0              3.1990224    
   2700000   18000          200            200            0.0029635388   2.8048389e-37  0              0.0088906164   9.467872e-17   0              4.5716965e-12  1.1971759e-13  0              3.1990224    
   2800000   18000          200            200            0.0029635388  -1.9633871e-36  0              0.0088906164   2.8541043e-17  0              1.3781448e-12  1.1971759e-13  0              3.1990224    
   2900000   18000          200            200            0.0029635388   8.4145164e-37  0              0.0088906164   1.1199092e-17  0              5.4076407e-13  1.1971759e-13  0              3.1990224    
   3000000   18000          200            200            0.0029635388  -2.8048387e-37  0              0.0088906164   8.7186354e-18  0              4.209917e-13   1.1971759e-13  0              3.1990224    
Loop time of 787.286 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3292321.520 ns/day, 0.000 hours/ns, 3810.557 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.49     | 241.36     | 243.22     |  12.0 | 30.66
Neigh   | 15.539     | 15.54      | 15.541     |   0.0 |  1.97
Comm    | 40.793     | 42.939     | 45.086     |  32.8 |  5.45
Output  | 0.60763    | 0.60765    | 0.60766    |   0.0 |  0.08
Modify  | 427.02     | 427.21     | 427.39     |   0.9 | 54.26
Other   |            | 59.64      |            |       |  7.57

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.41                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.6756188368544
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.51
  ghost atom cutoff = 3.51
  binsize = 1.755, bins = 10257 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 290.3 | 290.3 | 290.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025637379   1.795098e-35   0              0.0076912137   1389818.3      0              6.7109352e+10  1.1971759e-13  0              3.3156439    
    200000   18000          200            200           -0.00030347237 -1.0770566e-34  0             -0.00091041711  266601.49      0              1.2873232e+10  1.1971759e-13  0              3.2623208    
    300000   18000          200            200           -0.00019897695  3.5902032e-35  0             -0.00059693084  57188.763      0              2.7614407e+09  1.1971759e-13  0              3.2240784    
    400000   18000          200            200            1.1418117e-05  3.5902016e-35  0              3.4254352e-05  117.11845      0              5655230.7      1.1971759e-13  0              3.2159068    
    500000   18000          200            200            0.0011852864   1.7951018e-35  0              0.0035558592   4344.1309      0              2.0976253e+08  1.1971759e-13  0              3.2044923    
    600000   18000          200            200            0.006343795    1.7950985e-35  0              0.019031385    0.41657872     0              20115.096      1.1971759e-13  0              3.2033783    
    700000   18000          200            200            0.0041126032   1.0591543e-41  0              0.01233781     3.4551668      0              166837.64      1.1971759e-13  0              3.2037851    
    800000   18000          200            200            0.0027311855  -4.4877411e-35  0              0.0081935565   8.1453043      0              393307.59      1.1971759e-13  0              3.2040749    
    900000   18000          200            200            0.0029219987   1.7950977e-35  0              0.008765996    1.4594018      0              70469.292      1.1971759e-13  0              3.2040333    
   1000000   18000          200            200            0.0030184927  -4.4877352e-36  0              0.0090554781   0.026136823    0              1262.0537      1.1971759e-13  0              3.2040118    
   1100000   18000          200            200            0.0029513845   4.4877455e-36  0              0.0088541536   0.0073265036   0              353.77064      1.1971759e-13  0              3.2040265    
   1200000   18000          200            200            0.0029692005   1.0841186e-42  0              0.0089076015   0.0036237481   0              174.97783      1.1971759e-13  0              3.2040226    
   1300000   18000          200            200            0.0029699117  -5.6096769e-37  0              0.0089097351   0.00026018696  0              12.563497      1.1971759e-13  0              3.2040224    
   1400000   18000          200            200            0.0029672431   2.8048388e-37  0              0.0089017294   3.3562966e-07  0              0.016206355    1.1971759e-13  0              3.204023     
   1500000   18000          200            200            0.0029683646  -2.8048387e-37  0              0.0089050937   5.6949034e-06  0              0.2749865      1.1971759e-13  0              3.2040228    
   1600000   18000          200            200            0.0029682052  -2.8048387e-37  0              0.0089046157   1.0203098e-06  0              0.04926711     1.1971759e-13  0              3.2040228    
   1700000   18000          200            200            0.0029681302   2.8048389e-37  0              0.0089043906   2.1249973e-08  0              0.0010260852   1.1971759e-13  0              3.2040228    
   1800000   18000          200            200            0.0029681853  -2.8048387e-37  0              0.008904556    4.4317864e-09  0              0.00021399511  1.1971759e-13  0              3.2040228    
   1900000   18000          200            200            0.0029681701  -8.4145162e-37  0              0.0089045103   2.4491896e-09  0              0.0001182626   1.1971759e-13  0              3.2040228    
   2000000   18000          200            200            0.0029681698  -5.6096774e-37  0              0.0089045093   1.8954893e-10  0              9.1526394e-06  1.1971759e-13  0              3.2040228    
   2100000   18000          200            200            0.0029681719  -2.8048387e-37  0              0.0089045158   5.9436224e-14  0              2.8699625e-09  1.1971759e-13  0              3.2040228    
   2200000   18000          200            200            0.002968171   -2.243871e-36   0              0.008904513    3.6983126e-12  0              1.7857828e-07  1.1971759e-13  0              3.2040228    
   2300000   18000          200            200            0.0029681711   1.1219355e-36  0              0.0089045134   7.1183387e-13  0              3.437191e-08   1.1971759e-13  0              3.2040228    
   2400000   18000          200            200            0.0029681712   1.0428584e-44  0              0.0089045136   1.6886255e-14  0              8.1537681e-10  1.1971759e-13  0              3.2040228    
   2500000   18000          200            200            0.0029681711   8.4145164e-37  0              0.0089045134   2.6419302e-15  0              1.2756935e-10  1.1971759e-13  0              3.2040228    
   2600000   18000          200            200            0.0029681712  -8.4145162e-37  0              0.0089045135   1.6808066e-15  0              8.1160137e-11  1.1971759e-13  0              3.2040228    
   2700000   18000          200            200            0.0029681712   2.8048388e-36  0              0.0089045135   1.067177e-16   0              5.1530159e-12  1.1971759e-13  0              3.2040228    
   2800000   18000          200            200            0.0029681712  -5.6096774e-37  0              0.0089045135   1.6231106e-19  0              7.8374201e-15  1.1971759e-13  0              3.2040228    
   2900000   18000          200            200            0.0029681712   8.4145164e-37  0              0.0089045135   3.7389129e-18  0              1.8053872e-13  1.1971759e-13  0              3.2040228    
   3000000   18000          200            200            0.0029681712  -1.1219355e-36  0              0.0089045135   8.6054502e-18  0              4.1552639e-13  1.1971759e-13  0              3.2040228    
Loop time of 790.052 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3280795.826 ns/day, 0.000 hours/ns, 3797.217 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.11     | 243.55     | 244.99     |   9.2 | 30.83
Neigh   | 15.269     | 15.269     | 15.269     |   0.0 |  1.93
Comm    | 41.551     | 42.76      | 43.968     |  18.5 |  5.41
Output  | 0.60777    | 0.60781    | 0.60785    |   0.0 |  0.08
Modify  | 428.59     | 428.59     | 428.59     |   0.0 | 54.25
Other   |            | 59.27      |            |       |  7.50

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.42                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.0786366890634
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.52
  ghost atom cutoff = 3.52
  binsize = 1.76, bins = 10228 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 289.5 | 289.5 | 289.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025703306   8.7610687e-42  0              0.0077109918   1394661.8      0              6.7343227e+10  1.1971759e-13  0              3.3153454    
    200000   18000          200            200           -0.00030396117  8.4452291e-41  0             -0.00091188351  258959.41      0              1.2504223e+10  1.1971759e-13  0              3.2704813    
    300000   18000          200            200           -0.00019467982  3.5902018e-35  0             -0.00058403945  53530.2        0              2.5847818e+09  1.1971759e-13  0              3.2307574    
    400000   18000          200            200            1.9679413e-05 -1.7950893e-35  0              5.9038238e-05  340.79907      0              16455968       1.1971759e-13  0              3.2207941    
    500000   18000          200            200            0.003395619   -3.5901889e-35  0              0.010186857    4619.3252      0              2.2305068e+08  1.1971759e-13  0              3.2089488    
    600000   18000          200            200            0.0060602394   4.4877437e-35  0              0.018180718    106.69983      0              5152153.1      1.1971759e-13  0              3.2084276    
    700000   18000          200            200            0.0039283916   3.5901947e-35  0              0.011785175    29.737856      0              1435934.6      1.1971759e-13  0              3.2088226    
    800000   18000          200            200            0.002620754    8.9754932e-36  0              0.0078622621   2.9451677      0              142211.61      1.1971759e-13  0              3.2091016    
    900000   18000          200            200            0.0029986798  -8.9754753e-36  0              0.0089960394   1.5709945      0              75857.7        1.1971759e-13  0              3.2090179    
   1000000   18000          200            200            0.0030059475   8.9754907e-36  0              0.0090178424   0.1311493      0              6332.7301      1.1971759e-13  0              3.2090159    
   1100000   18000          200            200            0.0029533645   3.1414198e-35  0              0.0088600935   9.5711913e-05  0              4.6215857      1.1971759e-13  0              3.2090275    
   1200000   18000          200            200            0.0029778362  -2.2438699e-36  0              0.0089335087   0.0018368849   0              88.696599      1.1971759e-13  0              3.2090222    
   1300000   18000          200            200            0.0029729312  -2.243871e-36   0              0.0089187935   0.0004837996   0              23.360951      1.1971759e-13  0              3.2090232    
   1400000   18000          200            200            0.0029720794  -4.2072581e-37  0              0.0089162382   2.4904725e-05  0              1.20256        1.1971759e-13  0              3.2090234    
   1500000   18000          200            200            0.0029731366   2.8048389e-37  0              0.0089194099   2.3305687e-07  0              0.011253482    1.1971759e-13  0              3.2090232    
   1600000   18000          200            200            0.0029727378   2.8048389e-37  0              0.0089182135   7.9221607e-07  0              0.038253279    1.1971759e-13  0              3.2090233    
   1700000   18000          200            200            0.0029727914  -5.6096774e-37  0              0.0089183743   1.3440835e-07  0              0.006490098    1.1971759e-13  0              3.2090233    
   1800000   18000          200            200            0.002972818    2.8048389e-37  0              0.008918454    3.6054485e-09  0              0.0001740942   1.1971759e-13  0              3.2090233    
   1900000   18000          200            200            0.0029727981   8.4145164e-37  0              0.0089183943   3.6975489e-10  0              1.785414e-05   1.1971759e-13  0              3.2090233    
   2000000   18000          200            200            0.0029728042  -8.4145162e-37  0              0.0089184127   2.9570152e-10  0              1.4278368e-05  1.1971759e-13  0              3.2090233    
   2100000   18000          200            200            0.0029728039  -2.8048388e-36  0              0.0089184116   3.3397261e-11  0              1.6126342e-06  1.1971759e-13  0              3.2090233    
   2200000   18000          200            200            0.0029728032   1.032876e-44   0              0.0089184097   2.8091706e-13  0              1.3564479e-08  1.1971759e-13  0              3.2090233    
   2300000   18000          200            200            0.0029728036   1.1219355e-36  0              0.0089184108   2.5623292e-13  0              1.2372571e-08  1.1971759e-13  0              3.2090233    
   2400000   18000          200            200            0.0029728035   2.8048389e-37  0              0.0089184105   9.8376996e-14  0              4.7502731e-09  1.1971759e-13  0              3.2090233    
   2500000   18000          200            200            0.0029728035   2.8048389e-37  0              0.0089184105   7.2380807e-15  0              3.4950101e-10  1.1971759e-13  0              3.2090233    
   2600000   18000          200            200            0.0029728035   2.8048389e-37  0              0.0089184105   2.9155742e-18  0              1.4078264e-13  1.1971759e-13  0              3.2090233    
   2700000   18000          200            200            0.0029728035   1.1219355e-36  0              0.0089184105   1.5683026e-16  0              7.5727719e-12  1.1971759e-13  0              3.2090233    
   2800000   18000          200            200            0.0029728035  -2.5243549e-36  0              0.0089184105   2.9084781e-17  0              1.4044e-12     1.1971759e-13  0              3.2090233    
   2900000   18000          200            200            0.0029728035   1.4024194e-36  0              0.0089184105   1.4018562e-17  0              6.7690617e-13  1.1971759e-13  0              3.2090233    
   3000000   18000          200            200            0.0029728035   1.1219355e-36  0              0.0089184105   9.875464e-18   0              4.7685081e-13  1.1971759e-13  0              3.2090233    
Loop time of 784.028 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3306004.262 ns/day, 0.000 hours/ns, 3826.394 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.1      | 240.46     | 241.82     |   8.8 | 30.67
Neigh   | 14.379     | 14.38      | 14.381     |   0.0 |  1.83
Comm    | 38.572     | 40.103     | 41.633     |  24.2 |  5.11
Output  | 0.60944    | 0.60946    | 0.60947    |   0.0 |  0.08
Modify  | 428.67     | 428.74     | 428.8      |   0.3 | 54.68
Other   |            | 59.74      |            |       |  7.62

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.43                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.4840182755848
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.53
  ghost atom cutoff = 3.53
  binsize = 1.765, bins = 10199 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 288.8 | 288.8 | 288.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025769234  -8.9754677e-36  0              0.0077307702   1399511.9      0              6.7577421e+10  1.1971759e-13  0              3.3150345    
    200000   18000          200            200           -0.00030430122  3.5901997e-35  0             -0.00091290365  251434.77      0              1.2140885e+10  1.1971759e-13  0              3.2785989    
    300000   18000          200            200           -0.00019023784  1.7951066e-35  0             -0.00057071351  49995.998      0              2.4141278e+09  1.1971759e-13  0              3.2373831    
    400000   18000          200            200            2.8063163e-05  3.5902001e-35  0              8.418949e-05   680.72728      0              32869884       1.1971759e-13  0              3.2256224    
    500000   18000          200            200            0.0062303671  -1.795092e-35   0              0.018691101    3977.7751      0              1.9207253e+08  1.1971759e-13  0              3.2134148    
    600000   18000          200            200            0.00533405     2.6926467e-35  0              0.01600215     341.38756      0              16484383       1.1971759e-13  0              3.2135563    
    700000   18000          200            200            0.0035907782   2.6926462e-35  0              0.010772334    66.171489      0              3195184.4      1.1971759e-13  0              3.2138921    
    800000   18000          200            200            0.0025764068   8.9754934e-36  0              0.0077292205   0.069290424    0              3345.7866      1.1971759e-13  0              3.2141134    
    900000   18000          200            200            0.0030697371  -8.9754832e-35  0              0.0092092112   0.99866554     0              48221.985      1.1971759e-13  0              3.2140039    
   1000000   18000          200            200            0.0029838479  -4.4877414e-35  0              0.0089515438   0.20906224     0              10094.867      1.1971759e-13  0              3.2140222    
   1100000   18000          200            200            0.0029620035   3.590194e-35   0              0.0088860105   0.010296967    0              497.20371      1.1971759e-13  0              3.2140271    
   1200000   18000          200            200            0.0029844481   3.5901937e-35  0              0.0089533442   7.0236537e-05  0              3.391471       1.1971759e-13  0              3.2140222    
   1300000   18000          200            200            0.0029758922  -2.8048387e-36  0              0.0089276766   0.00031088594  0              15.011569      1.1971759e-13  0              3.2140241    
   1400000   18000          200            200            0.0029773005  -1.5426613e-36  0              0.0089319014   6.2246322e-05  0              3.0056521      1.1971759e-13  0              3.2140238    
   1500000   18000          200            200            0.002977708   -8.4145162e-37  0              0.0089331241   2.9003907e-06  0              0.14004949     1.1971759e-13  0              3.2140237    
   1600000   18000          200            200            0.0029773149  -3.3658065e-36  0              0.0089319447   2.8821885e-08  0              0.0013917057   1.1971759e-13  0              3.2140238    
   1700000   18000          200            200            0.0029774617  -2.8048387e-37  0              0.0089323852   9.6532487e-08  0              0.0046612083   1.1971759e-13  0              3.2140237    
   1800000   18000          200            200            0.0029774386   5.6096777e-37  0              0.0089323158   1.852459e-08   0              0.00089448616  1.1971759e-13  0              3.2140237    
   1900000   18000          200            200            0.0029774311   1.0409938e-44  0              0.0089322932   8.136105e-10   0              3.9286339e-05  1.1971759e-13  0              3.2140237    
   2000000   18000          200            200            0.002977438   -8.4145162e-37  0              0.0089323139   1.132571e-11   0              5.4687802e-07  1.1971759e-13  0              3.2140237    
   2100000   18000          200            200            0.0029774354  -5.6096774e-37  0              0.0089323063   2.9923329e-11  0              1.4448905e-06  1.1971759e-13  0              3.2140237    
   2200000   18000          200            200            0.0029774358  -4.2072582e-36  0              0.0089323074   5.5123018e-12  0              2.6616932e-07  1.1971759e-13  0              3.2140237    
   2300000   18000          200            200            0.002977436   -5.6096774e-37  0              0.0089323079   2.2847229e-13  0              1.1032109e-08  1.1971759e-13  0              3.2140237    
   2400000   18000          200            200            0.0029774358  -2.8048387e-37  0              0.0089323075   4.1422369e-15  0              2.000138e-10   1.1971759e-13  0              3.2140237    
   2500000   18000          200            200            0.0029774359   7.8535486e-36  0              0.0089323076   9.1724476e-15  0              4.4290467e-10  1.1971759e-13  0              3.2140237    
   2600000   18000          200            200            0.0029774359   5.6096777e-37  0              0.0089323076   1.610341e-15   0              7.7757604e-11  1.1971759e-13  0              3.2140237    
   2700000   18000          200            200            0.0029774359   1.035259e-44   0              0.0089323076   4.5711925e-17  0              2.2072652e-12  1.1971759e-13  0              3.2140237    
   2800000   18000          200            200            0.0029774359   8.9754841e-36  0              0.0089323076   4.3151524e-20  0              2.0836327e-15  1.1971759e-13  0              3.2140237    
   2900000   18000          200            200            0.0029774359   8.4145164e-37  0              0.0089323076   8.9627482e-19  0              4.3277903e-14  1.1971759e-13  0              3.2140237    
   3000000   18000          200            200            0.0029774359  -1.4304678e-35  0              0.0089323076   1.2034721e-17  0              5.8111361e-13  1.1971759e-13  0              3.2140237    
Loop time of 784.54 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3303844.796 ns/day, 0.000 hours/ns, 3823.894 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.88     | 243.08     | 244.28     |   7.7 | 30.98
Neigh   | 14.003     | 14.004     | 14.005     |   0.0 |  1.79
Comm    | 37.893     | 39.379     | 40.865     |  23.7 |  5.02
Output  | 0.60523    | 0.60525    | 0.60526    |   0.0 |  0.08
Modify  | 427.02     | 427.14     | 427.26     |   0.6 | 54.44
Other   |            | 60.33      |            |       |  7.69

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.44                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.8917705079228
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.54
  ghost atom cutoff = 3.54
  binsize = 1.77, bins = 10170 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 283.4 | 283.4 | 283.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025835162  -8.9754686e-36  0              0.0077505485   1404368.5      0              6.7811931e+10  1.1971759e-13  0              3.3147112    
    200000   18000          200            200           -0.00030449302 -1.7950869e-35  0             -0.00091347906  244026.32      0              1.1783157e+10  1.1971759e-13  0              3.286674     
    300000   18000          200            200           -0.00018565136  1.7951071e-35  0             -0.00055695409  46585.515      0              2.2494478e+09  1.1971759e-13  0              3.2439555    
    400000   18000          200            200            3.6568851e-05 -4.128722e-34   0              0.00010970655  1136.5288      0              54878907       1.1971759e-13  0              3.2303917    
    500000   18000          200            200            0.0091232724   3.5901985e-35  0              0.027369817    2524.944       0              1.2192051e+08  1.1971759e-13  0              3.2179515    
    600000   18000          200            200            0.0043190708  -2.6926435e-35  0              0.012957212    575.45897      0              27786854       1.1971759e-13  0              3.2187459    
    700000   18000          200            200            0.003166919   -8.9754746e-36  0              0.009500757    90.164701      0              4353730.7      1.1971759e-13  0              3.2189821    
    800000   18000          200            200            0.0026060637   8.9754935e-36  0              0.007818191    1.524138       0              73595.17       1.1971759e-13  0              3.2191083    
    900000   18000          200            200            0.0031189519   4.4877429e-35  0              0.0093568557   0.25593206     0              12358.043      1.1971759e-13  0              3.2189946    
   1000000   18000          200            200            0.0029599728   8.9754908e-36  0              0.0088799183   0.17664951     0              8529.7728      1.1971759e-13  0              3.2190289    
   1100000   18000          200            200            0.0029759265  -4.0389675e-35  0              0.0089277795   0.025023952    0              1208.3171      1.1971759e-13  0              3.2190255    
   1200000   18000          200            200            0.0029882454   4.487743e-36   0              0.0089647361   0.00085999031  0              41.525854      1.1971759e-13  0              3.2190228    
   1300000   18000          200            200            0.0029795695   5.6096782e-37  0              0.0089387086   2.62954e-05    0              1.2697107      1.1971759e-13  0              3.2190247    
   1400000   18000          200            200            0.002982593   -1.5426613e-36  0              0.008947779    4.3604892e-05  0              2.1055242      1.1971759e-13  0              3.2190241    
   1500000   18000          200            200            0.0029821162  -2.8048387e-37  0              0.0089463485   8.1773291e-06  0              0.39485396     1.1971759e-13  0              3.2190242    
   1600000   18000          200            200            0.0029819735   2.8048388e-36  0              0.0089459205   4.377967e-07   0              0.021139636    1.1971759e-13  0              3.2190242    
   1700000   18000          200            200            0.0029821126  -8.4145162e-37  0              0.0089463378   4.9065994e-10  0              2.3692213e-05  1.1971759e-13  0              3.2190242    
   1800000   18000          200            200            0.0029820569   4.487742e-36   0              0.0089461708   9.7869736e-09  0              0.00047257793  1.1971759e-13  0              3.2190242    
   1900000   18000          200            200            0.0029820684   7.2925808e-36  0              0.0089462053   2.5038074e-09  0              0.0001208999   1.1971759e-13  0              3.2190242    
   2000000   18000          200            200            0.0029820696  -2.8048387e-37  0              0.0089462088   1.8945551e-10  0              9.1481287e-06  1.1971759e-13  0              3.2190242    
   2100000   18000          200            200            0.0029820675  -2.5243549e-36  0              0.0089462024   6.1269419e-13  0              2.958481e-08   1.1971759e-13  0              3.2190242    
   2200000   18000          200            200            0.0029820684  -2.8048387e-37  0              0.0089462053   1.9398435e-12  0              9.3668102e-08  1.1971759e-13  0              3.2190242    
   2300000   18000          200            200            0.0029820682   1.6829033e-36  0              0.0089462046   7.2185917e-13  0              3.4855996e-08  1.1971759e-13  0              3.2190242    
   2400000   18000          200            200            0.0029820682  -5.6096774e-37  0              0.0089462046   7.3235279e-14  0              3.5362695e-09  1.1971759e-13  0              3.2190242    
   2500000   18000          200            200            0.0029820682   1.0515126e-44  0              0.0089462047   1.1500459e-15  0              5.55316e-11    1.1971759e-13  0              3.2190242    
   2600000   18000          200            200            0.0029820682   2.8048389e-37  0              0.0089462046   4.0736665e-16  0              1.9670278e-11  1.1971759e-13  0              3.2190242    
   2700000   18000          200            200            0.0029820682   8.4145164e-37  0              0.0089462047   1.9863611e-16  0              9.5914267e-12  1.1971759e-13  0              3.2190242    
   2800000   18000          200            200            0.0029820682  -2.8048387e-37  0              0.0089462047   2.452674e-17   0              1.1843085e-12  1.1971759e-13  0              3.2190242    
   2900000   18000          200            200            0.0029820682  -7.5730647e-36  0              0.0089462047   2.0550154e-18  0              9.9229341e-14  1.1971759e-13  0              3.2190242    
   3000000   18000          200            200            0.0029820682  -4.487742e-36   0              0.0089462047   2.7877441e-18  0              1.3461018e-13  1.1971759e-13  0              3.2190242    
Loop time of 781.966 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3314722.241 ns/day, 0.000 hours/ns, 3836.484 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.03     | 242.04     | 243.04     |   6.5 | 30.95
Neigh   | 13.983     | 13.984     | 13.985     |   0.0 |  1.79
Comm    | 38.024     | 39.29      | 40.556     |  20.2 |  5.02
Output  | 0.61598    | 0.616      | 0.61603    |   0.0 |  0.08
Modify  | 426.63     | 426.65     | 426.68     |   0.1 | 54.56
Other   |            | 59.39      |            |       |  7.59

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.45                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.3019002975809
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.55
  ghost atom cutoff = 3.55
  binsize = 1.775, bins = 10141 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 282.6 | 282.6 | 282.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025901088  -4.4877411e-35  0              0.0077703263   1409231.5      0              6.8046744e+10  1.1971759e-13  0              3.3143761    
    200000   18000          200            200           -0.00030453743 -1.7950865e-35  0             -0.00091361229  236736.25      0              1.1431146e+10  1.1971759e-13  0              3.2947056    
    300000   18000          200            200           -0.00018092297 -1.795088e-35   0             -0.00054276892  43299.576      0              2.0907816e+09  1.1971759e-13  0              3.250474     
    400000   18000          200            200            4.5192878e-05  3.5901987e-35  0              0.00013557864  1707.6217      0              82454939       1.1971759e-13  0              3.235102     
    500000   18000          200            200            0.011399829    1.7951014e-35  0              0.034199486    915.41784      0              44202251       1.1971759e-13  0              3.2226218    
    600000   18000          200            200            0.0032117141  -3.590192e-35   0              0.0096351423   691.65352      0              33397473       1.1971759e-13  0              3.2239704    
    700000   18000          200            200            0.0027331923  -8.9754739e-36  0              0.0081995769   87.921093      0              4245394.9      1.1971759e-13  0              3.2240784    
    800000   18000          200            200            0.0027057984   5.3852914e-35  0              0.0081173952   6.2502901      0              301804.14      1.1971759e-13  0              3.2240874    
    900000   18000          200            200            0.0031352     -4.4877336e-36  0              0.0094056      0.011664963    0              563.25931      1.1971759e-13  0              3.2239925    
   1000000   18000          200            200            0.002942514   -1.3463219e-35  0              0.0088275421   0.069135581    0              3338.3098      1.1971759e-13  0              3.2240342    
   1100000   18000          200            200            0.0029919583   1.346323e-35   0              0.008975875    0.025835768    0              1247.5168      1.1971759e-13  0              3.2240235    
   1200000   18000          200            200            0.0029895707   9.644007e-43   0              0.008968712    0.0030433069   0              146.9504       1.1971759e-13  0              3.224024     
   1300000   18000          200            200            0.002984402   -3.3658065e-36  0              0.0089532061   9.3912556e-05  0              4.5347012      1.1971759e-13  0              3.2240251    
   1400000   18000          200            200            0.0029876079   1.718315e-45   0              0.0089628238   3.3865696e-06  0              0.16352533     1.1971759e-13  0              3.2240244    
   1500000   18000          200            200            0.0029864958   8.4145164e-37  0              0.0089594873   5.3094036e-06  0              0.2563721      1.1971759e-13  0              3.2240246    
   1600000   18000          200            200            0.0029866957   2.243871e-36   0              0.008960087    1.0944028e-06  0              0.052844795    1.1971759e-13  0              3.2240246    
   1700000   18000          200            200            0.0029867303   8.4145164e-37  0              0.0089601908   7.9338182e-08  0              0.0038309569   1.1971759e-13  0              3.2240246    
   1800000   18000          200            200            0.0029866846   1.2060807e-35  0              0.0089600539   3.9267937e-10  0              1.8961082e-05  1.1971759e-13  0              3.2240246    
   1900000   18000          200            200            0.0029867056   8.4145164e-37  0              0.0089601168   6.752321e-10   0              3.2604541e-05  1.1971759e-13  0              3.2240246    
   2000000   18000          200            200            0.0029866999   2.8048389e-37  0              0.0089600996   2.9368417e-10  0              1.4180957e-05  1.1971759e-13  0              3.2240246    
   2100000   18000          200            200            0.0029867003  -1.9633871e-36  0              0.0089601009   3.7973445e-11  0              1.8336017e-06  1.1971759e-13  0              3.2240246    
   2200000   18000          200            200            0.0029867008  -1.1219355e-36  0              0.0089601024   1.4192729e-12  0              6.8531609e-08  1.1971759e-13  0              3.2240246    
   2300000   18000          200            200            0.0029867005  -2.8048387e-37  0              0.0089601014   2.1119709e-14  0              1.0197952e-09  1.1971759e-13  0              3.2240246    
   2400000   18000          200            200            0.0029867006  -3.6462904e-36  0              0.0089601018   5.7197572e-14  0              2.7618661e-09  1.1971759e-13  0              3.2240246    
   2500000   18000          200            200            0.0029867006   5.6096777e-37  0              0.0089601017   1.3041573e-14  0              6.2973091e-10  1.1971759e-13  0              3.2240246    
   2600000   18000          200            200            0.0029867006  -8.4145162e-37  0              0.0089601017   9.8801008e-16  0              4.7707471e-11  1.1971759e-13  0              3.2240246    
   2700000   18000          200            200            0.0029867006   3.3658065e-36  0              0.0089601017   2.9888317e-18  0              1.4431999e-13  1.1971759e-13  0              3.2240246    
   2800000   18000          200            200            0.0029867006  -1.9633871e-36  0              0.0089601017   2.4866268e-18  0              1.2007031e-13  1.1971759e-13  0              3.2240246    
   2900000   18000          200            200            0.0029867006   5.6096777e-37  0              0.0089601017   4.0087093e-18  0              1.9356622e-13  1.1971759e-13  0              3.2240246    
   3000000   18000          200            200            0.0029867006  -2.8048387e-37  0              0.0089601017   8.8143024e-18  0              4.2561112e-13  1.1971759e-13  0              3.2240246    
Loop time of 784.441 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3304263.002 ns/day, 0.000 hours/ns, 3824.378 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.91     | 241.79     | 243.67     |  12.1 | 30.82
Neigh   | 14.133     | 14.134     | 14.135     |   0.0 |  1.80
Comm    | 37.82      | 39.936     | 42.052     |  33.5 |  5.09
Output  | 0.60892    | 0.60894    | 0.60895    |   0.0 |  0.08
Modify  | 427.7      | 427.86     | 428.03     |   0.8 | 54.54
Other   |            | 60.11      |            |       |  7.66

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.46                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.7144145560632
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.56
  ghost atom cutoff = 3.56
  binsize = 1.78, bins = 10113 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 281.9 | 281.9 | 281.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0025967013   1.0637922e-41  0              0.0077901038   1414100.9      0              6.8281871e+10  1.1971759e-13  0              3.3140287    
    200000   18000          200            200           -0.00030443497  1.7951055e-35  0             -0.00091330491  229563.01      0              1.1084776e+10  1.1971759e-13  0              3.3026941    
    300000   18000          200            200           -0.00017605252 -8.077935e-34   0             -0.00052815755  40137.111      0              1.9380775e+09  1.1971759e-13  0              3.2569387    
    400000   18000          200            200            5.3935982e-05 -5.3852851e-35  0              0.00016180795  2393.6582      0              1.1558119e+08  1.1971759e-13  0              3.2397532    
    500000   18000          200            200            0.01246826     3.5901984e-35  0              0.03740478     31.467235      0              1519440.1      1.1971759e-13  0              3.2274749    
    600000   18000          200            200            0.0021919854  -8.9754673e-36  0              0.0065759561   645.92684      0              31189496       1.1971759e-13  0              3.2292012    
    700000   18000          200            200            0.002356601    4.487743e-35   0              0.0070698031   61.852719      0              2986646.5      1.1971759e-13  0              3.2291664    
    800000   18000          200            200            0.0028600131  -3.5901926e-35  0              0.0085800392   10.857083      0              524249.69      1.1971759e-13  0              3.2290546    
    900000   18000          200            200            0.0031155592  -4.9365154e-35  0              0.0093466776   0.48168262     0              23258.73       1.1971759e-13  0              3.2289981    
   1000000   18000          200            200            0.002937729   -8.9754772e-36  0              0.0088131871   0.00095757151  0              46.237701      1.1971759e-13  0              3.2290367    
   1100000   18000          200            200            0.0030062066   4.0389682e-35  0              0.0090186198   0.011768557    0              568.26149      1.1971759e-13  0              3.2290218    
   1200000   18000          200            200            0.0029897524   9.2562347e-43  0              0.0089692573   0.0034719559   0              167.64832      1.1971759e-13  0              3.2290254    
   1300000   18000          200            200            0.0029902938  -3.9267742e-36  0              0.0089708815   0.00039971718  0              19.300912      1.1971759e-13  0              3.2290253    
   1400000   18000          200            200            0.0029921448  -4.2072581e-37  0              0.0089764343   1.4984409e-05  0              0.72354347     1.1971759e-13  0              3.2290249    
   1500000   18000          200            200            0.0029909976   5.6096776e-37  0              0.0089729928   1.4466084e-07  0              0.0069851541   1.1971759e-13  0              3.2290251    
   1600000   18000          200            200            0.0029914211   2.8048388e-36  0              0.0089742632   5.3368015e-07  0              0.025769504    1.1971759e-13  0              3.229025     
   1700000   18000          200            200            0.0029913258   2.8048389e-37  0              0.0089739774   1.4041011e-07  0              0.0067799017   1.1971759e-13  0              3.229025     
   1800000   18000          200            200            0.0029913255  -2.8048387e-37  0              0.0089739764   1.4821321e-08  0              0.00071566853  1.1971759e-13  0              3.229025     
   1900000   18000          200            200            0.0029913382   8.4145164e-37  0              0.0089740146   4.61227e-10    0              2.2271001e-05  1.1971759e-13  0              3.229025     
   2000000   18000          200            200            0.0029913308  -5.6096774e-37  0              0.0089739925   1.2484822e-11  0              6.0284738e-07  1.1971759e-13  0              3.229025     
   2100000   18000          200            200            0.0029913334   1.1219355e-36  0              0.0089740003   2.3825434e-11  0              1.150445e-06   1.1971759e-13  0              3.229025     
   2200000   18000          200            200            0.0029913329   2.243871e-36   0              0.0089739987   5.6338939e-12  0              2.7204058e-07  1.1971759e-13  0              3.229025     
   2300000   18000          200            200            0.0029913329  -2.8048387e-37  0              0.0089739986   5.4524387e-13  0              2.6327875e-08  1.1971759e-13  0              3.229025     
   2400000   18000          200            200            0.002991333   -2.8048387e-37  0              0.0089739989   1.3849844e-14  0              6.687594e-10   1.1971759e-13  0              3.229025     
   2500000   18000          200            200            0.0029913329  -1.1219355e-36  0              0.0089739987   7.8054368e-16  0              3.7689661e-11  1.1971759e-13  0              3.229025     
   2600000   18000          200            200            0.0029913329  -2.8048387e-37  0              0.0089739988   1.1199086e-15  0              5.4076379e-11  1.1971759e-13  0              3.229025     
   2700000   18000          200            200            0.0029913329  -5.6096774e-37  0              0.0089739988   2.1799846e-16  0              1.0526365e-11  1.1971759e-13  0              3.229025     
   2800000   18000          200            200            0.0029913329   1.6829033e-36  0              0.0089739988   2.6093495e-17  0              1.2599615e-12  1.1971759e-13  0              3.229025     
   2900000   18000          200            200            0.0029913329   5.6096776e-37  0              0.0089739988   4.5539889e-18  0              2.1989583e-13  1.1971759e-13  0              3.229025     
   3000000   18000          200            200            0.0029913329   2.8048389e-37  0              0.0089739988   2.2039657e-18  0              1.0642162e-13  1.1971759e-13  0              3.229025     
Loop time of 786.109 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3297253.915 ns/day, 0.000 hours/ns, 3816.266 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.86     | 243.64     | 246.43     |  17.8 | 30.99
Neigh   | 13.866     | 13.867     | 13.868     |   0.0 |  1.76
Comm    | 37.19      | 40.197     | 43.205     |  47.4 |  5.11
Output  | 0.60841    | 0.60844    | 0.60848    |   0.0 |  0.08
Modify  | 427.61     | 427.71     | 427.82     |   0.5 | 54.41
Other   |            | 60.08      |            |       |  7.64

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.47                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.1293201948733
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.57
  ghost atom cutoff = 3.57
  binsize = 1.785, bins = 10085 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 281.1 | 281.1 | 281.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026032936   2.6926465e-35  0              0.0078098808   1418976.7      0              6.8517305e+10  1.1971759e-13  0              3.3136692    
    200000   18000          200            200           -0.00030418628  1.7951049e-35  0             -0.00091255884  222506.43      0              1.0744039e+10  1.1971759e-13  0              3.3106392    
    300000   18000          200            200           -0.00017104088  7.1803937e-35  0             -0.00051312265  37097.782      0              1.7913191e+09  1.1971759e-13  0              3.2633497    
    400000   18000          200            200            6.2796868e-05 -3.5901884e-35  0              0.0001883906   3194.1741      0              1.5423524e+08  1.1971759e-13  0              3.2443451    
    500000   18000          200            200            0.012028628    5.3852953e-35  0              0.036085885    396.19921      0              19131042       1.1971759e-13  0              3.2325346    
    600000   18000          200            200            0.0013817889  -1.7950949e-35  0              0.0041453668   475.0341       0              22937697       1.1971759e-13  0              3.2344119    
    700000   18000          200            200            0.0020846376   2.6926462e-35  0              0.0062539128   27.456395      0              1325771        1.1971759e-13  0              3.2342334    
    800000   18000          200            200            0.0030424182  -8.0779347e-35  0              0.0091272546   11.981316      0              578534.87      1.1971759e-13  0              3.2340162    
    900000   18000          200            200            0.0030661227   8.975492e-36   0              0.0091983681   1.2349348      0              59630.584      1.1971759e-13  0              3.2340101    
   1000000   18000          200            200            0.0029482555  -2.2438703e-35  0              0.0088447664   0.04371564     0              2110.8718      1.1971759e-13  0              3.2340359    
   1100000   18000          200            200            0.0030153852   8.9754876e-36  0              0.0090461556   0.00037941527  0              18.320606      1.1971759e-13  0              3.2340213    
   1200000   18000          200            200            0.0029905667  -4.0389677e-35  0              0.0089717001   0.0015404325   0              74.381974      1.1971759e-13  0              3.2340266    
   1300000   18000          200            200            0.0029966629   6.8183845e-44  0              0.0089899886   0.00044438103  0              21.45757       1.1971759e-13  0              3.2340253    
   1400000   18000          200            200            0.0029962554  -7.0120969e-37  0              0.0089887663   5.6697343e-05  0              2.7377118      1.1971759e-13  0              3.2340254    
   1500000   18000          200            200            0.0029956987   1.9633872e-36  0              0.008987096    3.1007227e-06  0              0.1497228      1.1971759e-13  0              3.2340255    
   1600000   18000          200            200            0.0029960876  -8.4145162e-37  0              0.0089882629   4.8551959e-09  0              0.00023444003  1.1971759e-13  0              3.2340255    
   1700000   18000          200            200            0.0029959267   1.037318e-44   0              0.00898778     3.6007188e-08  0              0.0017386582   1.1971759e-13  0              3.2340255    
   1800000   18000          200            200            0.0029959724   3.0853227e-36  0              0.0089879173   1.5240187e-08  0              0.00073589411  1.1971759e-13  0              3.2340255    
   1900000   18000          200            200            0.002995966   -1.1219355e-36  0              0.0089878981   2.4383235e-09  0              0.00011773791  1.1971759e-13  0              3.2340255    
   2000000   18000          200            200            0.0029959639   3.0853227e-36  0              0.0089878916   1.8206515e-10  0              8.7912745e-06  1.1971759e-13  0              3.2340255    
   2100000   18000          200            200            0.002995966    1.1219355e-36  0              0.008987898    2.6527422e-12  0              1.2809143e-07  1.1971759e-13  0              3.2340255    
   2200000   18000          200            200            0.002995965   -8.4145162e-37  0              0.008987895    6.3138168e-13  0              3.0487162e-08  1.1971759e-13  0              3.2340255    
   2300000   18000          200            200            0.0029959653   1.1219355e-36  0              0.008987896    4.802624e-13   0              2.3190153e-08  1.1971759e-13  0              3.2340255    
   2400000   18000          200            200            0.0029959653  -2.8048387e-37  0              0.0089878958   9.7875397e-14  0              4.7260526e-09  1.1971759e-13  0              3.2340255    
   2500000   18000          200            200            0.0029959653  -5.6096774e-37  0              0.0089878958   9.5642344e-15  0              4.6182265e-10  1.1971759e-13  0              3.2340255    
   2600000   18000          200            200            0.0029959653  -8.4145162e-37  0              0.0089878958   2.3150804e-16  0              1.1178695e-11  1.1971759e-13  0              3.2340255    
   2700000   18000          200            200            0.0029959653  -3.0853226e-36  0              0.0089878958   7.86025e-18    0              3.7954334e-13  1.1971759e-13  0              3.2340255    
   2800000   18000          200            200            0.0029959653  -4.2072582e-36  0              0.0089878958   2.009795e-18   0              9.7045808e-14  1.1971759e-13  0              3.2340255    
   2900000   18000          200            200            0.0029959653   1.4024194e-36  0              0.0089878958   1.8639619e-18  0              9.000405e-14   1.1971759e-13  0              3.2340255    
   3000000   18000          200            200            0.0029959653  -1.1219355e-36  0              0.0089878958   3.4691187e-18  0              1.6751133e-13  1.1971759e-13  0              3.2340255    
Loop time of 784.8 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3302752.803 ns/day, 0.000 hours/ns, 3822.631 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.94     | 242.76     | 244.57     |  11.7 | 30.93
Neigh   | 14.03      | 14.031     | 14.031     |   0.0 |  1.79
Comm    | 37.826     | 39.896     | 41.965     |  32.8 |  5.08
Output  | 0.62304    | 0.62306    | 0.62308    |   0.0 |  0.08
Modify  | 427.32     | 427.44     | 427.56     |   0.6 | 54.46
Other   |            | 60.05      |            |       |  7.65

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.48                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.5466241255151
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.58
  ghost atom cutoff = 3.58
  binsize = 1.79, bins = 10056 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 275.8 | 275.8 | 275.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026098858  -8.9754683e-36  0              0.0078296574   1423859        0              6.8753057e+10  1.1971759e-13  0              3.3132971    
    200000   18000          200            200           -0.0003037919  -2.5131345e-34  0             -0.00091137569  215565.64      0              1.0408893e+10  1.1971759e-13  0              3.3185413    
    300000   18000          200            200           -0.00016588863  1.0480244e-40  0             -0.00049766588  34181.065      0              1.6504813e+09  1.1971759e-13  0              3.2697068    
    400000   18000          200            200            7.1775567e-05  6.2281771e-41  0              0.0002153267   4108.8305      0              1.9840072e+08  1.1971759e-13  0              3.2488776    
    500000   18000          200            200            0.010193175   -2.1541157e-34  0              0.030579525    1784.4751      0              86165914       1.1971759e-13  0              3.2377919    
    600000   18000          200            200            0.00082858056  1.7950986e-35  0              0.0024857417   260.74209      0              12590302       1.1971759e-13  0              3.2395813    
    700000   18000          200            200            0.0019439401   1.0488717e-41  0              0.0058318203   3.6265702      0              175114.1       1.1971759e-13  0              3.2392702    
    800000   18000          200            200            0.0032193006  -2.4233806e-34  0              0.0096579017   8.7410463      0              422073.84      1.1971759e-13  0              3.2389798    
    900000   18000          200            200            0.0030002502   1.6155872e-34  0              0.0090007505   1.5912767      0              76837.057      1.1971759e-13  0              3.2390257    
   1000000   18000          200            200            0.0029724218  -3.1414187e-35  0              0.0089172654   0.15112083     0              7297.0842      1.1971759e-13  0              3.2390321    
   1100000   18000          200            200            0.0030179475   6.7316134e-35  0              0.0090538425   0.0057512885   0              277.70914      1.1971759e-13  0              3.2390221    
   1200000   18000          200            200            0.0029935263   6.731614e-36   0              0.008980579    1.6720021e-05  0              0.80734996     1.1971759e-13  0              3.2390274    
   1300000   18000          200            200            0.0030027116   5.6096782e-37  0              0.0090081349   0.0001566272   0              7.562967       1.1971759e-13  0              3.2390255    
   1400000   18000          200            200            0.0030002145   2.5243549e-36  0              0.0090006435   5.2407049e-05  0              2.5305488      1.1971759e-13  0              3.239026     
   1500000   18000          200            200            0.0030005575  -2.8048387e-37  0              0.0090016726   8.1375238e-06  0              0.3929319      1.1971759e-13  0              3.2390259    
   1600000   18000          200            200            0.0030006729  -1.9633871e-36  0              0.0090020188   6.7293582e-07  0              0.032493663    1.1971759e-13  0              3.2390259    
   1700000   18000          200            200            0.0030005561  -1.1219355e-36  0              0.0090016682   1.8080278e-08  0              0.00087303191  1.1971759e-13  0              3.2390259    
   1800000   18000          200            200            0.0030006135  -2.8048387e-37  0              0.0090018406   5.9416614e-10  0              2.8690156e-05  1.1971759e-13  0              3.2390259    
   1900000   18000          200            200            0.0030005932   5.6096777e-37  0              0.0090017796   1.0787648e-09  0              5.2089692e-05  1.1971759e-13  0              3.2390259    
   2000000   18000          200            200            0.0030005983   1.9633872e-36  0              0.0090017948   2.960012e-10   0              1.4292839e-05  1.1971759e-13  0              3.2390259    
   2100000   18000          200            200            0.0030005978   2.8048388e-36  0              0.0090017934   4.0598326e-11  0              1.9603479e-06  1.1971759e-13  0              3.2390259    
   2200000   18000          200            200            0.0030005974   5.6096777e-37  0              0.0090017923   2.8752375e-12  0              1.3883493e-07  1.1971759e-13  0              3.2390259    
   2300000   18000          200            200            0.0030005977   2.8048389e-37  0              0.0090017931   4.6115414e-14  0              2.2267483e-09  1.1971759e-13  0              3.2390259    
   2400000   18000          200            200            0.0030005976   1.0306985e-44  0              0.0090017927   8.2391433e-15  0              3.9783874e-10  1.1971759e-13  0              3.2390259    
   2500000   18000          200            200            0.0030005976  -2.8048387e-37  0              0.0090017929   7.070947e-15   0              3.4143072e-10  1.1971759e-13  0              3.2390259    
   2600000   18000          200            200            0.0030005976  -8.4145162e-37  0              0.0090017928   1.6649987e-15  0              8.0396829e-11  1.1971759e-13  0              3.2390259    
   2700000   18000          200            200            0.0030005976   1.4024194e-36  0              0.0090017928   1.8543196e-16  0              8.9538456e-12  1.1971759e-13  0              3.2390259    
   2800000   18000          200            200            0.0030005976   1.0178795e-44  0              0.0090017928   1.6030804e-17  0              7.7407016e-13  1.1971759e-13  0              3.2390259    
   2900000   18000          200            200            0.0030005976   5.6096777e-37  0              0.0090017928   5.5057982e-18  0              2.6585529e-13  1.1971759e-13  0              3.2390259    
   3000000   18000          200            200            0.0030005976   8.4145164e-37  0              0.0090017928   9.9184771e-19  0              4.7892776e-14  1.1971759e-13  0              3.2390259    
Loop time of 786.342 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3296277.187 ns/day, 0.000 hours/ns, 3815.136 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.4      | 242.85     | 243.3      |   2.9 | 30.88
Neigh   | 14.027     | 14.028     | 14.028     |   0.0 |  1.78
Comm    | 38.591     | 39.416     | 40.241     |  13.1 |  5.01
Output  | 0.64022    | 0.64025    | 0.64028    |   0.0 |  0.08
Modify  | 428.84     | 428.99     | 429.14     |   0.7 | 54.55
Other   |            | 60.42      |            |       |  7.68

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.49                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.9663332594927
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.59
  ghost atom cutoff = 3.59
  binsize = 1.795, bins = 10028 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 275.1 | 275.1 | 275.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026164776   2.5814481e-41  0              0.0078494329   1428747.6      0              6.8989109e+10  1.1971759e-13  0              3.3129132    
    200000   18000          200            200           -0.00030325262  1.1928819e-40  0             -0.00090975786  208741.42      0              1.0079376e+10  1.1971759e-13  0              3.3263998    
    300000   18000          200            200           -0.00016059713  8.9754906e-35  0             -0.00048179138  31386.872      0              1.5155597e+09  1.1971759e-13  0              3.2760098    
    400000   18000          200            200            8.0870104e-05  1.7951019e-35  0              0.00024261031  5137.0899      0              2.4805168e+08  1.1971759e-13  0              3.2533506    
    500000   18000          200            200            0.0074460734  -5.7443093e-34  0              0.02233822     3386.3271      0              1.6351361e+08  1.1971759e-13  0              3.2432074    
    600000   18000          200            200            0.00051776742 -1.795095e-35   0              0.0015533023   85.062433      0              4107360.4      1.1971759e-13  0              3.2446948    
    700000   18000          200            200            0.0019455701   2.6926462e-35  0              0.0058367102   2.8180107      0              136071.65      1.1971759e-13  0              3.2442718    
    800000   18000          200            200            0.0033555063   9.4260453e-42  0              0.010066519    3.4960846      0              168813.41      1.1971759e-13  0              3.2439525    
    900000   18000          200            200            0.0029349601  -9.8730317e-35  0              0.0088048804   1.2358899      0              59676.699      1.1971759e-13  0              3.2440413    
   1000000   18000          200            200            0.0030047019   4.4877492e-36  0              0.0090141057   0.2087834      0              10081.403      1.1971759e-13  0              3.2440266    
   1100000   18000          200            200            0.0030146131  -4.4877386e-36  0              0.0090438392   0.021044496    0              1016.1634      1.1971759e-13  0              3.2440243    
   1200000   18000          200            200            0.0029992876  -2.24387e-36    0              0.0089978629   0.0010596998   0              51.169112      1.1971759e-13  0              3.2440276    
   1300000   18000          200            200            0.003007793   -2.243871e-36   0              0.0090233791   2.9920434e-06  0              0.14447507     1.1971759e-13  0              3.2440258    
   1400000   18000          200            200            0.0030043739  -8.4145163e-37  0              0.0090131218   1.0105107e-05  0              0.48793944     1.1971759e-13  0              3.2440265    
   1500000   18000          200            200            0.0030054399  -1.1219355e-36  0              0.0090163197   5.1054715e-06  0              0.24652495     1.1971759e-13  0              3.2440263    
   1600000   18000          200            200            0.0030052084   3.9267743e-36  0              0.0090156253   1.0524931e-06  0              0.050821127    1.1971759e-13  0              3.2440263    
   1700000   18000          200            200            0.0030052161  -5.6096774e-37  0              0.0090156483   1.2846082e-07  0              0.006202913    1.1971759e-13  0              3.2440263    
   1800000   18000          200            200            0.0030052417   1.1219355e-36  0              0.009015725    8.8533163e-09  0              0.00042749496  1.1971759e-13  0              3.2440263    
   1900000   18000          200            200            0.0030052243   1.009742e-35   0              0.0090156729   1.6841385e-10  0              8.132102e-06   1.1971759e-13  0              3.2440263    
   2000000   18000          200            200            0.003005232    8.4145164e-37  0              0.0090156961   1.6695337e-11  0              8.0615806e-07  1.1971759e-13  0              3.2440263    
   2100000   18000          200            200            0.0030052294   1.1219355e-36  0              0.0090156881   1.8657366e-11  0              9.0089743e-07  1.1971759e-13  0              3.2440263    
   2200000   18000          200            200            0.0030052301   8.4145164e-37  0              0.0090156902   4.9349096e-12  0              2.3828912e-07  1.1971759e-13  0              3.2440263    
   2300000   18000          200            200            0.00300523    -3.9267743e-36  0              0.0090156899   7.2563326e-13  0              3.5038233e-08  1.1971759e-13  0              3.2440263    
   2400000   18000          200            200            0.0030052299  -2.8048387e-37  0              0.0090156898   6.2976966e-14  0              3.0409323e-09  1.1971759e-13  0              3.2440263    
   2500000   18000          200            200            0.00300523     2.5243549e-36  0              0.0090156899   2.4697236e-15  0              1.1925411e-10  1.1971759e-13  0              3.2440263    
   2600000   18000          200            200            0.00300523     1.6829033e-36  0              0.0090156899   1.5787894e-17  0              7.6234089e-13  1.1971759e-13  0              3.2440263    
   2700000   18000          200            200            0.00300523    -8.4145162e-37  0              0.0090156899   6.4757135e-17  0              3.1268903e-12  1.1971759e-13  0              3.2440263    
   2800000   18000          200            200            0.00300523     5.6096776e-37  0              0.0090156899   1.1662339e-17  0              5.6313261e-13  1.1971759e-13  0              3.2440263    
   2900000   18000          200            200            0.00300523     9.7134489e-45  0              0.0090156899   6.7333787e-18  0              3.2513076e-13  1.1971759e-13  0              3.2440263    
   3000000   18000          200            200            0.00300523     2.8048389e-37  0              0.0090156899   6.9329396e-19  0              3.3476684e-14  1.1971759e-13  0              3.2440263    
Loop time of 783.848 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3306765.578 ns/day, 0.000 hours/ns, 3827.275 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.12     | 242.67     | 244.21     |   9.9 | 30.96
Neigh   | 14.155     | 14.156     | 14.157     |   0.0 |  1.81
Comm    | 38.213     | 39.929     | 41.646     |  27.2 |  5.09
Output  | 0.60994    | 0.60995    | 0.60996    |   0.0 |  0.08
Modify  | 428.04     | 428.27     | 428.49     |   1.1 | 54.64
Other   |            | 58.22      |            |       |  7.43

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.5                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.3884545083096
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.6
  ghost atom cutoff = 3.6
  binsize = 1.8, bins = 10000 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 274.4 | 274.4 | 274.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026230694   4.4877499e-36  0              0.0078692081   1433642.8      0              6.9225482e+10  1.1971759e-13  0              3.3125164    
    200000   18000          200            200           -0.00030256882  1.7951029e-35  0             -0.00090770646  202032.1       0              9.7554068e+09  1.1971759e-13  0              3.3342153    
    300000   18000          200            200           -0.00015516636 -5.3852835e-35  0             -0.00046549909  28714.406      0              1.3865159e+09  1.1971759e-13  0              3.2822588    
    400000   18000          200            200            9.0080521e-05  3.5901995e-35  0              0.00027024156  6278.6301      0              3.0317258e+08  1.1971759e-13  0              3.257764     
    500000   18000          200            200            0.0044631125  -3.5901885e-35  0              0.013389337    4379.1859      0              2.1145521e+08  1.1971759e-13  0              3.2487217    
    600000   18000          200            200            0.00040488232 -4.4877402e-35  0              0.001214647    2.7991127      0              135159.13      1.1971759e-13  0              3.2497438    
    700000   18000          200            200            0.0020899855   2.5131356e-34  0              0.0062699564   25.2983        0              1221564.3      1.1971759e-13  0              3.2492382    
    800000   18000          200            200            0.003422669    3.5901945e-35  0              0.010268007    0.16985619     0              8201.7477      1.1971759e-13  0              3.2489398    
    900000   18000          200            200            0.0028866356   7.925213e-42   0              0.0086599067   0.49069442     0              23693.878      1.1971759e-13  0              3.2490534    
   1000000   18000          200            200            0.0030372227   3.1414201e-35  0              0.009111668    0.15551883     0              7509.4478      1.1971759e-13  0              3.249021     
   1100000   18000          200            200            0.0030081061   2.6926456e-35  0              0.0090243182   0.027203011    0              1313.5361      1.1971759e-13  0              3.2490271    
   1200000   18000          200            200            0.0030073982   4.4877431e-36  0              0.0090221946   0.0031597276   0              152.57194      1.1971759e-13  0              3.2490273    
   1300000   18000          200            200            0.003011705   -1.1219354e-36  0              0.0090351151   0.00022894242  0              11.05481       1.1971759e-13  0              3.2490264    
   1400000   18000          200            200            0.003008979    1.4024194e-37  0              0.009026937    6.3303434e-06  0              0.30566963     1.1971759e-13  0              3.249027     
   1500000   18000          200            200            0.0030101986   2.8048389e-37  0              0.0090305958   1.1715611e-07  0              0.0056570491   1.1971759e-13  0              3.2490267    
   1600000   18000          200            200            0.0030097582  -1.4024194e-36  0              0.0090292745   3.0841718e-07  0              0.014892362    1.1971759e-13  0              3.2490268    
   1700000   18000          200            200            0.0030098863   8.4145164e-37  0              0.0090296588   1.0166226e-07  0              0.0049089066   1.1971759e-13  0              3.2490268    
   1800000   18000          200            200            0.0030098603   2.8048389e-37  0              0.0090295809   1.8451954e-08  0              0.00089097882  1.1971759e-13  0              3.2490268    
   1900000   18000          200            200            0.0030098605  -8.4145162e-37  0              0.0090295814   2.2135486e-09  0              0.00010688434  1.1971759e-13  0              3.2490268    
   2000000   18000          200            200            0.0030098638   1.0385852e-44  0              0.0090295913   1.6779701e-10  0              8.1023173e-06  1.1971759e-13  0              3.2490268    
   2100000   18000          200            200            0.0030098616   2.243871e-36   0              0.0090295847   5.2733985e-12  0              2.5463354e-07  1.1971759e-13  0              3.2490268    
   2200000   18000          200            200            0.0030098626   1.0290767e-44  0              0.0090295877   3.9712439e-14  0              1.9175716e-09  1.1971759e-13  0              3.2490268    
   2300000   18000          200            200            0.0030098622  -1.5426613e-35  0              0.0090295866   1.8637948e-13  0              8.9995983e-09  1.1971759e-13  0              3.2490268    
   2400000   18000          200            200            0.0030098623   2.8048389e-37  0              0.009029587    6.5296632e-14  0              3.1529407e-09  1.1971759e-13  0              3.2490268    
   2500000   18000          200            200            0.0030098623   1.0234526e-44  0              0.0090295869   1.2504161e-14  0              6.0378119e-10  1.1971759e-13  0              3.2490268    
   2600000   18000          200            200            0.0030098623  -8.4145162e-37  0              0.0090295869   1.5377765e-15  0              7.4253722e-11  1.1971759e-13  0              3.2490268    
   2700000   18000          200            200            0.0030098623  -5.6096774e-37  0              0.0090295869   1.1101707e-16  0              5.3606168e-12  1.1971759e-13  0              3.2490268    
   2800000   18000          200            200            0.0030098623   8.4145164e-37  0              0.0090295869   1.1177438e-17  0              5.3971847e-13  1.1971759e-13  0              3.2490268    
   2900000   18000          200            200            0.0030098623  -2.8048387e-37  0              0.0090295869   5.6924828e-18  0              2.7486962e-13  1.1971759e-13  0              3.2490268    
   3000000   18000          200            200            0.0030098623  -9.8169357e-36  0              0.0090295869   1.8744448e-18  0              9.0510229e-14  1.1971759e-13  0              3.2490268    
Loop time of 781.548 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3316494.818 ns/day, 0.000 hours/ns, 3838.536 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.31     | 242.2      | 243.09     |   5.7 | 30.99
Neigh   | 14.303     | 14.304     | 14.305     |   0.0 |  1.83
Comm    | 38.722     | 39.873     | 41.024     |  18.2 |  5.10
Output  | 0.60901    | 0.60903    | 0.60906    |   0.0 |  0.08
Modify  | 425.99     | 426.14     | 426.29     |   0.7 | 54.52
Other   |            | 58.42      |            |       |  7.48

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.51                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.8129947834697
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.61
  ghost atom cutoff = 3.61
  binsize = 1.805, bins = 9973 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 269.2 | 269.2 | 269.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026296607  -8.0779344e-35  0              0.007888982    1438544.3      0              6.9462155e+10  1.1971759e-13  0              3.3121078    
    200000   18000          200            200           -0.00030174137 -1.7950838e-35  0             -0.00090522411  195438.68      0              9.4370342e+09  1.1971759e-13  0              3.3419869    
    300000   18000          200            200           -0.00014959792  1.7951028e-35  0             -0.00044879375  26163.652      0              1.2633491e+09  1.1971759e-13  0              3.2884535    
    400000   18000          200            200            9.9405596e-05  5.9312162e-41  0              0.00029821679  7532.991       0              3.6374118e+08  1.1971759e-13  0              3.2621177    
    500000   18000          200            200            0.0018928671   3.5901988e-35  0              0.0056786012   4417.2485      0              2.1329312e+08  1.1971759e-13  0              3.2542699    
    600000   18000          200            200            0.00045951257  1.7950991e-35  0              0.0013785377   35.670073      0              1722380.2      1.1971759e-13  0              3.254725     
    700000   18000          200            200            0.0023672301   4.4877431e-35  0              0.0071016903   59.065603      0              2852066.6      1.1971759e-13  0              3.2541739    
    800000   18000          200            200            0.0034067789  -7.1803864e-35  0              0.010220337    1.265145       0              61089.324      1.1971759e-13  0              3.2539443    
    900000   18000          200            200            0.0028673577   8.9754921e-36  0              0.0086020731   0.015988045    0              772.00549      1.1971759e-13  0              3.2540591    
   1000000   18000          200            200            0.0030619694  -4.487735e-36   0              0.0091859081   0.048022314    0              2318.8257      1.1971759e-13  0              3.2540171    
   1100000   18000          200            200            0.0030022058   3.590194e-35   0              0.0090066175   0.016650684    0              804.00194      1.1971759e-13  0              3.2540298    
   1200000   18000          200            200            0.003016482   -2.2438699e-36  0              0.0090494459   0.0033223576   0              160.42476      1.1971759e-13  0              3.2540268    
   1300000   18000          200            200            0.003014779   -3.3658065e-36  0              0.0090443371   0.00046687825  0              22.54388       1.1971759e-13  0              3.2540271    
   1400000   18000          200            200            0.0030140423   4.2072582e-37  0              0.0090421269   4.7402053e-05  0              2.2888755      1.1971759e-13  0              3.2540273    
   1500000   18000          200            200            0.0030147601  -1.1219355e-36  0              0.0090442802   3.123516e-06   0              0.15082341     1.1971759e-13  0              3.2540271    
   1600000   18000          200            200            0.0030143764  -8.4145162e-37  0              0.0090431292   7.7012402e-08  0              0.0037186533   1.1971759e-13  0              3.2540272    
   1700000   18000          200            200            0.0030145389  -8.4145162e-37  0              0.0090436166   2.1829394e-09  0              0.00010540633  1.1971759e-13  0              3.2540272    
   1800000   18000          200            200            0.0030144806  -7.8535486e-36  0              0.0090434417   4.5972188e-09  0              0.00022198324  1.1971759e-13  0              3.2540272    
   1900000   18000          200            200            0.0030144982  -5.6096774e-37  0              0.0090434947   1.5410771e-09  0              7.4413096e-05  1.1971759e-13  0              3.2540272    
   2000000   18000          200            200            0.0030144941  -2.243871e-35   0              0.0090434822   3.0156043e-10  0              1.4561274e-05  1.1971759e-13  0              3.2540272    
   2100000   18000          200            200            0.0030144945  -5.6096774e-37  0              0.0090434836   4.1779698e-11  0              2.0173921e-06  1.1971759e-13  0              3.2540272    
   2200000   18000          200            200            0.0030144948   1.0592022e-44  0              0.0090434843   4.1749847e-12  0              2.0159507e-07  1.1971759e-13  0              3.2540272    
   2300000   18000          200            200            0.0030144946   8.4145164e-37  0              0.0090434837   2.6788017e-13  0              1.2934975e-08  1.1971759e-13  0              3.2540272    
   2400000   18000          200            200            0.0030144947   5.6096777e-37  0              0.009043484    6.1062642e-15  0              2.9484964e-10  1.1971759e-13  0              3.2540272    
   2500000   18000          200            200            0.0030144946  -8.4145162e-37  0              0.0090434839   2.3884846e-16  0              1.1533137e-11  1.1971759e-13  0              3.2540272    
   2600000   18000          200            200            0.0030144946  -2.8048387e-37  0              0.0090434839   4.9067623e-16  0              2.3692999e-11  1.1971759e-13  0              3.2540272    
   2700000   18000          200            200            0.0030144946   1.0270837e-44  0              0.0090434839   1.3059012e-16  0              6.3057293e-12  1.1971759e-13  0              3.2540272    
   2800000   18000          200            200            0.0030144946   1.9633872e-36  0              0.0090434839   1.1388535e-17  0              5.4991162e-13  1.1971759e-13  0              3.2540272    
   2900000   18000          200            200            0.0030144946   1.4024194e-36  0              0.0090434839   7.2681786e-18  0              3.5095433e-13  1.1971759e-13  0              3.2540272    
   3000000   18000          200            200            0.0030144946   2.243871e-36   0              0.0090434839   1.362478e-17   0              6.5789189e-13  1.1971759e-13  0              3.2540272    
Loop time of 783.264 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3309230.210 ns/day, 0.000 hours/ns, 3830.128 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.31     | 240.93     | 244.54     |  23.3 | 30.76
Neigh   | 14.428     | 14.429     | 14.43      |   0.0 |  1.84
Comm    | 37.991     | 41.827     | 45.664     |  59.3 |  5.34
Output  | 0.60881    | 0.60884    | 0.60887    |   0.0 |  0.08
Modify  | 425.78     | 425.86     | 425.94     |   0.4 | 54.37
Other   |            | 59.61      |            |       |  7.61

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.52                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.2399609964769
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.62
  ghost atom cutoff = 3.62
  binsize = 1.81, bins = 9945 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 268.5 | 268.5 | 268.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026362517  -2.6926437e-35  0              0.0079087552   1443452.3      0              6.9699146e+10  1.1971759e-13  0              3.3116865    
    200000   18000          200            200           -0.00030077072 -1.6155862e-34  0             -0.00090231215  188960.04      0              9.1242042e+09  1.1971759e-13  0              3.3497151    
    300000   18000          200            200           -0.000143892   -1.795091e-35   0             -0.00043167599  23733.963      0              1.1460281e+09  1.1971759e-13  0              3.2945939    
    400000   18000          200            200            0.00010884464  3.5901995e-35  0              0.00032653391  8899.7782      0              4.2973844e+08  1.1971759e-13  0              3.2664116    
    500000   18000          200            200            0.00022959941  1.7951019e-35  0              0.00068879823  3706.834       0              1.7898975e+08  1.1971759e-13  0              3.2597954    
    600000   18000          200            200            0.0006952338   1.9944068e-41  0              0.0020857014   174.51992      0              8426942.5      1.1971759e-13  0              3.2596398    
    700000   18000          200            200            0.0027517301  -1.7950957e-35  0              0.0082551903   85.38574       0              4122971.8      1.1971759e-13  0              3.2590882    
    800000   18000          200            200            0.0033122879  -2.6926443e-35  0              0.0099368637   5.9137309      0              285552.9       1.1971759e-13  0              3.2589651    
    900000   18000          200            200            0.0028824866   1.7950977e-35  0              0.0086474597   0.2259943      0              10912.456      1.1971759e-13  0              3.2590573    
   1000000   18000          200            200            0.0030731176  -8.9754772e-36  0              0.0092193528   0.0003333411   0              16.095849      1.1971759e-13  0              3.2590161    
   1100000   18000          200            200            0.0030004596   1.7950972e-35  0              0.0090013789   0.0024820565   0              119.84963      1.1971759e-13  0              3.2590316    
   1200000   18000          200            200            0.0030247833  -2.24387e-36    0              0.00907435     0.0013248805   0              63.97374       1.1971759e-13  0              3.2590264    
   1300000   18000          200            200            0.003017725   -1.1219355e-36  0              0.009053175    0.00033384163  0              16.120018      1.1971759e-13  0              3.2590279    
   1400000   18000          200            200            0.0030193394  -1.4024194e-37  0              0.0090580181   5.8994343e-05  0              2.8486257      1.1971759e-13  0              3.2590276    
   1500000   18000          200            200            0.0030191665  -1.1219355e-36  0              0.0090574994   8.0491425e-06  0              0.38866429     1.1971759e-13  0              3.2590276    
   1600000   18000          200            200            0.0030190721  -8.4145162e-37  0              0.0090572162   8.5639543e-07  0              0.041352271    1.1971759e-13  0              3.2590276    
   1700000   18000          200            200            0.0030191592   5.6096777e-37  0              0.0090574777   6.6669149e-08  0              0.0032192146   1.1971759e-13  0              3.2590276    
   1800000   18000          200            200            0.0030191122  -1.2902258e-35  0              0.0090573365   2.9628809e-09  0              0.00014306691  1.1971759e-13  0              3.2590276    
   1900000   18000          200            200            0.0030191328   8.4145164e-37  0              0.0090573985   1.0051679e-11  0              4.8535959e-07  1.1971759e-13  0              3.2590276    
   2000000   18000          200            200            0.0030191249  -2.8048388e-36  0              0.0090573748   2.4990034e-11  0              1.2066793e-06  1.1971759e-13  0              3.2590276    
   2100000   18000          200            200            0.0030191276  -2.9450807e-35  0              0.0090573828   1.4662198e-11  0              7.0798505e-07  1.1971759e-13  0              3.2590276    
   2200000   18000          200            200            0.0030191268  -1.1219355e-36  0              0.0090573805   3.8219062e-12  0              1.8454617e-07  1.1971759e-13  0              3.2590276    
   2300000   18000          200            200            0.003019127   -5.6096774e-37  0              0.009057381    6.8927766e-13  0              3.3282751e-08  1.1971759e-13  0              3.2590276    
   2400000   18000          200            200            0.003019127   -2.8048387e-37  0              0.0090573809   9.5716752e-14  0              4.6218194e-09  1.1971759e-13  0              3.2590276    
   2500000   18000          200            200            0.003019127    1.4024194e-36  0              0.0090573809   1.0355063e-14  0              5.0000894e-10  1.1971759e-13  0              3.2590276    
   2600000   18000          200            200            0.003019127    2.8048389e-37  0              0.0090573809   7.5992063e-16  0              3.6693848e-11  1.1971759e-13  0              3.2590276    
   2700000   18000          200            200            0.003019127   -3.6462904e-36  0              0.0090573809   3.4592212e-17  0              1.6703341e-12  1.1971759e-13  0              3.2590276    
   2800000   18000          200            200            0.003019127    9.9989632e-45  0              0.0090573809   4.0890754e-18  0              1.9744682e-13  1.1971759e-13  0              3.2590276    
   2900000   18000          200            200            0.003019127    2.8048389e-37  0              0.0090573809   4.7812301e-19  0              2.3086849e-14  1.1971759e-13  0              3.2590276    
   3000000   18000          200            200            0.003019127   -8.4145162e-37  0              0.0090573809   1.0680621e-17  0              5.1572894e-13  1.1971759e-13  0              3.2590276    
Loop time of 779.089 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3326961.639 ns/day, 0.000 hours/ns, 3850.650 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.7      | 241.18     | 241.65     |   3.0 | 30.96
Neigh   | 13.24      | 13.24      | 13.241     |   0.0 |  1.70
Comm    | 37.273     | 37.926     | 38.58      |  10.6 |  4.87
Output  | 0.62487    | 0.62488    | 0.62489    |   0.0 |  0.08
Modify  | 425.96     | 426.1      | 426.23     |   0.6 | 54.69
Other   |            | 60.02      |            |       |  7.70

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.53                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.6693600588351
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.63
  ghost atom cutoff = 3.63
  binsize = 1.815, bins = 9918 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 267.8 | 267.8 | 267.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026428423   2.6926465e-35  0              0.007928527    1448366.6      0              6.9936438e+10  1.1971759e-13  0              3.3112532    
    200000   18000          200            200           -0.00029965774  1.5537608e-40  0             -0.00089897322  182596.82      0              8.8169471e+09  1.1971759e-13  0              3.3573995    
    300000   18000          200            200           -0.00013805061  3.5902052e-35  0             -0.00041415183  21425.418      0              1.0345567e+09  1.1971759e-13  0              3.3006798    
    400000   18000          200            200            0.00011839529 -1.7950906e-35  0              0.00035518588  10378.336      0              5.0113272e+08  1.1971759e-13  0              3.2706457    
    500000   18000          200            200           -5.3642876e-05  1.7951026e-35  0             -0.00016092863  2770.7622      0              1.3379019e+08  1.1971759e-13  0              3.2652622    
    600000   18000          200            200            0.0011572528   4.4877443e-35  0              0.0034717584   378.14254      0              18259150       1.1971759e-13  0              3.264494     
    700000   18000          200            200            0.0031968554   4.4877431e-35  0              0.0095905661   88.556051      0              4276054.8      1.1971759e-13  0              3.2639934    
    800000   18000          200            200            0.0031608406   8.9754928e-36  0              0.0094825217   10.571246      0              510447.63      1.1971759e-13  0              3.2639981    
    900000   18000          200            200            0.0029296751   1.6155872e-34  0              0.0087890253   0.93001        0              44906.854      1.1971759e-13  0              3.2640485    
   1000000   18000          200            200            0.0030687841   4.4877488e-36  0              0.0092063524   0.062322976    0              3009.3534      1.1971759e-13  0              3.2640184    
   1100000   18000          200            200            0.0030049972   3.589555e-42   0              0.0090149915   0.002102354    0              101.51515      1.1971759e-13  0              3.2640321    
   1200000   18000          200            200            0.0030308605   1.0170348e-42  0              0.0090925815   9.0638785e-07  0              0.043766225    1.1971759e-13  0              3.2640265    
   1300000   18000          200            200            0.0030213063  -5.609677e-37   0              0.0090639189   4.4826249e-05  0              2.1644991      1.1971759e-13  0              3.2640286    
   1400000   18000          200            200            0.0030245266   1.8869319e-45  0              0.0090735797   2.0418045e-05  0              0.98591433     1.1971759e-13  0              3.2640279    
   1500000   18000          200            200            0.00302355    -5.6096775e-37  0              0.0090706501   5.074394e-06   0              0.24502433     1.1971759e-13  0              3.2640281    
   1600000   18000          200            200            0.0030238035   5.6096776e-37  0              0.0090714105   9.3650831e-07  0              0.045220635    1.1971759e-13  0              3.264028     
   1700000   18000          200            200            0.0030237562   7.5730647e-36  0              0.0090712686   1.4043071e-07  0              0.0067808962   1.1971759e-13  0              3.264028     
   1800000   18000          200            200            0.0030237557   5.6096777e-37  0              0.009071267    1.757148e-08   0              0.00084846387  1.1971759e-13  0              3.264028     
   1900000   18000          200            200            0.0030237623   1.0241013e-44  0              0.0090712868   1.8168439e-09  0              8.772889e-05   1.1971759e-13  0              3.264028     
   2000000   18000          200            200            0.0030237578  -2.8048387e-37  0              0.0090712733   1.4686401e-10  0              7.0915374e-06  1.1971759e-13  0              3.264028     
   2100000   18000          200            200            0.00302376    -1.4024194e-36  0              0.00907128     7.8200277e-12  0              3.7760115e-07  1.1971759e-13  0              3.264028     
   2200000   18000          200            200            0.003023759    2.5243549e-36  0              0.0090712771   1.1854362e-13  0              5.7240471e-09  1.1971759e-13  0              3.264028     
   2300000   18000          200            200            0.0030237594  -5.8901614e-36  0              0.0090712782   1.6768452e-14  0              8.0968851e-10  1.1971759e-13  0              3.264028     
   2400000   18000          200            200            0.0030237593   1.0658387e-35  0              0.0090712778   1.7933142e-14  0              8.6592727e-10  1.1971759e-13  0              3.264028     
   2500000   18000          200            200            0.0030237593   5.6096777e-37  0              0.009071278    5.9900684e-15  0              2.8923896e-10  1.1971759e-13  0              3.264028     
   2600000   18000          200            200            0.0030237593  -1.6829033e-36  0              0.0090712779   1.3386511e-15  0              6.4638673e-11  1.1971759e-13  0              3.264028     
   2700000   18000          200            200            0.0030237593  -8.4145162e-37  0              0.0090712779   2.0460235e-16  0              9.8795152e-12  1.1971759e-13  0              3.264028     
   2800000   18000          200            200            0.0030237593   8.4145164e-37  0              0.0090712779   2.09983e-17    0              1.0139328e-12  1.1971759e-13  0              3.264028     
   2900000   18000          200            200            0.0030237593   8.4145164e-37  0              0.0090712779   4.2677085e-18  0              2.0607237e-13  1.1971759e-13  0              3.264028     
   3000000   18000          200            200            0.0030237593   2.8048389e-37  0              0.0090712779   5.213988e-21   0              2.5176482e-16  1.1971759e-13  0              3.264028     
Loop time of 780.467 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3321086.622 ns/day, 0.000 hours/ns, 3843.850 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.5      | 242.53     | 245.56     |  19.5 | 31.07
Neigh   | 12.64      | 12.641     | 12.642     |   0.0 |  1.62
Comm    | 34.732     | 38.003     | 41.274     |  53.1 |  4.87
Output  | 0.60893    | 0.60894    | 0.60896    |   0.0 |  0.08
Modify  | 426.39     | 426.46     | 426.53     |   0.3 | 54.64
Other   |            | 60.23      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.54                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.1011988820483
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.64
  ghost atom cutoff = 3.64
  binsize = 1.82, bins = 9891 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 262.8 | 262.8 | 262.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026494326  -8.9754755e-36  0              0.0079482977   1453287.3      0              7.0174044e+10  1.1971759e-13  0              3.3108072    
    200000   18000          200            200           -0.00029840277  1.7951069e-35  0             -0.0008952083   176347.7       0              8.5151991e+09  1.1971759e-13  0              3.3650402    
    300000   18000          200            200           -0.00013207307  9.2387496e-41  0             -0.0003962192   19237.054      0              9.288885e+08   1.1971759e-13  0              3.3067113    
    400000   18000          200            200            0.00012805855  5.5122294e-41  0              0.00038417566  11968.527      0              5.7791731e+08  1.1971759e-13  0              3.2748197    
    500000   18000          200            200           -4.5548887e-05  3.5901983e-35  0             -0.00013664666  1960.0999      0              94646210       1.1971759e-13  0              3.270661     
    600000   18000          200            200            0.0018800367  -1.7950946e-35  0              0.00564011     573.80159      0              27706825       1.1971759e-13  0              3.2692997    
    700000   18000          200            200            0.0036352345   1.1576282e-41  0              0.010905704    65.654099      0              3170201.5      1.1971759e-13  0              3.2689044    
    800000   18000          200            200            0.0029852279   1.7950977e-35  0              0.0089556838   11.770373      0              568349.19      1.1971759e-13  0              3.2690369    
    900000   18000          200            200            0.0029993108   8.9754926e-36  0              0.0089979325   1.5023384      0              72542.543      1.1971759e-13  0              3.269035     
   1000000   18000          200            200            0.0030515866  -8.9754775e-36  0              0.0091547599   0.16723504     0              8075.1816      1.1971759e-13  0              3.2690234    
   1100000   18000          200            200            0.0030158391   4.4877424e-35  0              0.0090475174   0.015826947    0              764.22661      1.1971759e-13  0              3.2690312    
   1200000   18000          200            200            0.0030341509   9.6461415e-43  0              0.0091024526   0.0012064757   0              58.256392      1.1971759e-13  0              3.2690272    
   1300000   18000          200            200            0.0030259951   1.6829033e-36  0              0.0090779854   6.1648493e-05  0              2.9767851      1.1971759e-13  0              3.269029     
   1400000   18000          200            200            0.0030293188  -7.0120969e-37  0              0.0090879564   9.0386498e-07  0              0.043644405    1.1971759e-13  0              3.2690283    
   1500000   18000          200            200            0.0030280553   3.3658065e-36  0              0.0090841658   1.3314416e-07  0              0.006429055    1.1971759e-13  0              3.2690285    
   1600000   18000          200            200            0.0030285061  -1.1219355e-36  0              0.0090855184   1.4562458e-07  0              0.0070316898   1.1971759e-13  0              3.2690284    
   1700000   18000          200            200            0.0030283554   1.0403022e-44  0              0.0090850663   4.8509644e-08  0              0.0023423571   1.1971759e-13  0              3.2690285    
   1800000   18000          200            200            0.003028402   -1.4024194e-36  0              0.0090852061   1.0945475e-08  0              0.0005285178   1.1971759e-13  0              3.2690285    
   1900000   18000          200            200            0.0030283891  -8.4145162e-37  0              0.0090851673   1.9861284e-09  0              9.5903034e-05  1.1971759e-13  0              3.2690285    
   2000000   18000          200            200            0.0030283921  -1.1219355e-36  0              0.0090851762   3.0847227e-10  0              1.4895022e-05  1.1971759e-13  0              3.2690285    
   2100000   18000          200            200            0.0030283917   2.243871e-36   0              0.0090851751   4.2017991e-11  0              2.0288984e-06  1.1971759e-13  0              3.2690285    
   2200000   18000          200            200            0.0030283916  -5.6096774e-37  0              0.0090851747   5.0405049e-12  0              2.4338794e-07  1.1971759e-13  0              3.2690285    
   2300000   18000          200            200            0.0030283917  -2.8048387e-37  0              0.0090851751   5.2715831e-13  0              2.5454588e-08  1.1971759e-13  0              3.2690285    
   2400000   18000          200            200            0.0030283916   5.6096777e-37  0              0.0090851749   4.647837e-14   0              2.2442741e-09  1.1971759e-13  0              3.2690285    
   2500000   18000          200            200            0.0030283917   8.4145164e-37  0              0.009085175    3.1332959e-15  0              1.5129564e-10  1.1971759e-13  0              3.2690285    
   2600000   18000          200            200            0.0030283916   2.8048389e-37  0              0.0090851749   8.3284752e-17  0              4.0215226e-12  1.1971759e-13  0              3.2690285    
   2700000   18000          200            200            0.0030283916   1.056216e-44   0              0.0090851749   3.3069604e-20  0              1.5968128e-15  1.1971759e-13  0              3.2690285    
   2800000   18000          200            200            0.0030283916  -2.8048387e-37  0              0.0090851749   1.2109257e-18  0              5.8471266e-14  1.1971759e-13  0              3.2690285    
   2900000   18000          200            200            0.0030283916   1.0312539e-44  0              0.0090851749   7.7892313e-18  0              3.761141e-13   1.1971759e-13  0              3.2690285    
   3000000   18000          200            200            0.0030283916   1.1219355e-36  0              0.0090851749   3.9013591e-18  0              1.8838267e-13  1.1971759e-13  0              3.2690285    
Loop time of 779.66 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3324524.903 ns/day, 0.000 hours/ns, 3847.830 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.95     | 242.52     | 243.1      |   3.7 | 31.11
Neigh   | 12.584     | 12.584     | 12.584     |   0.0 |  1.61
Comm    | 37.177     | 37.545     | 37.914     |   6.0 |  4.82
Output  | 0.60377    | 0.60378    | 0.6038     |   0.0 |  0.08
Modify  | 427.25     | 427.4      | 427.55     |   0.7 | 54.82
Other   |            | 59         |            |       |  7.57

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.55                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.5354843776197
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.65
  ghost atom cutoff = 3.65
  binsize = 1.825, bins = 9864 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 262.1 | 262.1 | 262.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026560223   8.9755018e-36  0              0.007968067    1458214.5      0              7.0411957e+10  1.1971759e-13  0              3.310349     
    200000   18000          200            200           -0.00029700667  1.7950978e-34  0             -0.00089102002  170213.16      0              8.2189841e+09  1.1971759e-13  0              3.372637     
    300000   18000          200            200           -0.00012596145  1.7951029e-35  0             -0.00037788434  17168.935      0              8.2902645e+08  1.1971759e-13  0              3.3126881    
    400000   18000          200            200            0.0001378323  -1.795091e-35   0              0.0004134969   13669.719      0              6.6006179e+08  1.1971759e-13  0              3.2789336    
    500000   18000          200            200           -3.730756e-05  -1.795092e-35   0             -0.00011192268  1290.2828      0              62303140       1.1971759e-13  0              3.2759915    
    600000   18000          200            200            0.0028463544  -1.7950945e-35  0              0.0085390633   674.83302      0              32585271       1.1971759e-13  0              3.2740754    
    700000   18000          200            200            0.0039888731  -8.9754722e-36  0              0.011966619    29.931524      0              1445286.2      1.1971759e-13  0              3.2738354    
    800000   18000          200            200            0.0028211154   9.8730334e-35  0              0.0084633463   8.6934253      0              419774.39      1.1971759e-13  0              3.274074     
    900000   18000          200            200            0.0030763697  -8.9754755e-36  0              0.009229109    1.4326369      0              69176.908      1.1971759e-13  0              3.2740199    
   1000000   18000          200            200            0.0030278335  -4.4877355e-36  0              0.0090835006   0.20362435     0              9832.2913      1.1971759e-13  0              3.2740299    
   1100000   18000          200            200            0.0030309011  -4.4877384e-36  0              0.0090927033   0.026675273    0              1288.0535      1.1971759e-13  0              3.2740294    
   1200000   18000          200            200            0.0030351874   9.3501933e-43  0              0.0091055621   0.0032161839   0              155.29801      1.1971759e-13  0              3.2740284    
   1300000   18000          200            200            0.0030317628  -3.3658065e-36  0              0.0090952885   0.00035393071  0              17.090047      1.1971759e-13  0              3.2740292    
   1400000   18000          200            200            0.0030336354  -2.8048388e-37  0              0.0091009063   3.4941688e-05  0              1.6872091      1.1971759e-13  0              3.2740288    
   1500000   18000          200            200            0.0030327553   8.8242645e-45  0              0.0090982659   2.9786152e-06  0              0.14382667     1.1971759e-13  0              3.2740289    
   1600000   18000          200            200            0.0030331345  -2.8048388e-36  0              0.0090994035   2.0155416e-07  0              0.0097323292   1.1971759e-13  0              3.2740289    
   1700000   18000          200            200            0.0030329808  -2.5243549e-36  0              0.0090989423   8.4658303e-09  0              0.00040878465  1.1971759e-13  0              3.2740289    
   1800000   18000          200            200            0.0030330401   8.4145164e-37  0              0.0090991204   4.001713e-11   0              1.932284e-06   1.1971759e-13  0              3.2740289    
   1900000   18000          200            200            0.0030330182  -2.8048387e-37  0              0.0090990545   5.79048e-11    0              2.7960156e-06  1.1971759e-13  0              3.2740289    
   2000000   18000          200            200            0.003033026    1.0115399e-44  0              0.0090990779   3.8957806e-11  0              1.881133e-06   1.1971759e-13  0              3.2740289    
   2100000   18000          200            200            0.0030330233  -1.4024194e-36  0              0.00909907     1.1793664e-11  0              5.6947382e-07  1.1971759e-13  0              3.2740289    
   2200000   18000          200            200            0.0030330242  -2.8048387e-37  0              0.0090990726   2.6235344e-12  0              1.2668109e-07  1.1971759e-13  0              3.2740289    
   2300000   18000          200            200            0.0030330239  -5.6096774e-37  0              0.0090990718   4.8898188e-13  0              2.3611185e-08  1.1971759e-13  0              3.2740289    
   2400000   18000          200            200            0.003033024   -4.487742e-36   0              0.009099072    8.0933945e-14  0              3.9080105e-09  1.1971759e-13  0              3.2740289    
   2500000   18000          200            200            0.003033024   -1.6829033e-36  0              0.0090990719   1.2107039e-14  0              5.8460559e-10  1.1971759e-13  0              3.2740289    
   2600000   18000          200            200            0.003033024   -4.2072582e-36  0              0.0090990719   1.6609103e-15  0              8.0199416e-11  1.1971759e-13  0              3.2740289    
   2700000   18000          200            200            0.003033024   -2.8048387e-37  0              0.0090990719   2.0853366e-16  0              1.0069344e-11  1.1971759e-13  0              3.2740289    
   2800000   18000          200            200            0.003033024    2.8048389e-37  0              0.0090990719   2.2500573e-17  0              1.0864722e-12  1.1971759e-13  0              3.2740289    
   2900000   18000          200            200            0.003033024   -1.6829033e-36  0              0.0090990719   8.5960311e-21  0              4.1507158e-16  1.1971759e-13  0              3.2740289    
   3000000   18000          200            200            0.003033024   -8.1340324e-36  0              0.0090990719   1.3524583e-19  0              6.5305369e-15  1.1971759e-13  0              3.2740289    
Loop time of 779.275 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3326167.127 ns/day, 0.000 hours/ns, 3849.730 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 236.94     | 240.14     | 243.35     |  20.7 | 30.82
Neigh   | 12.701     | 12.701     | 12.701     |   0.0 |  1.63
Comm    | 35.133     | 38.471     | 41.808     |  53.8 |  4.94
Output  | 0.60875    | 0.60877    | 0.60879    |   0.0 |  0.08
Modify  | 427.39     | 427.45     | 427.51     |   0.3 | 54.85
Other   |            | 59.9       |            |       |  7.69

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.56                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.9722234570539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.66
  ghost atom cutoff = 3.66
  binsize = 1.83, bins = 9837 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 261.4 | 261.4 | 261.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026626117   3.5901952e-35  0              0.007987835    1463148        0              7.0650181e+10  1.1971759e-13  0              3.3098781    
    200000   18000          200            200           -0.00029546966  1.7951066e-35  0             -0.00088640899  164191.76      0              7.9282326e+09  1.1971759e-13  0              3.3801902    
    300000   18000          200            200           -0.0001197146   3.5902013e-35  0             -0.00035914379  15220.061      0              7.349223e+08   1.1971759e-13  0              3.3186104    
    400000   18000          200            200            0.00014771819  7.1803926e-35  0              0.00044315458  15481.961      0              7.4756847e+08  1.1971759e-13  0              3.2829872    
    500000   18000          200            200           -2.8918288e-05  5.3852957e-35  0             -8.6754863e-05  760.58631      0              36725991       1.1971759e-13  0              3.2812537    
    600000   18000          200            200            0.003963496    8.9755064e-36  0              0.011890488    620.8337       0              29977838       1.1971759e-13  0              3.2788463    
    700000   18000          200            200            0.0041876565  -8.9754734e-36  0              0.01256297     3.6862869      0              177997.6       1.1971759e-13  0              3.278798     
    800000   18000          200            200            0.0026995577  -8.975475e-36   0              0.0080986731   3.6432699      0              175920.47      1.1971759e-13  0              3.2791023    
    900000   18000          200            200            0.0031436387   8.6679026e-42  0              0.0094309162   0.78085209     0              37704.553      1.1971759e-13  0              3.2790071    
   1000000   18000          200            200            0.0030056285   2.2438717e-35  0              0.0090168855   0.13349095     0              6445.8002      1.1971759e-13  0              3.2790361    
   1100000   18000          200            200            0.0030466881   2.2438714e-35  0              0.0091400644   0.021321241    0              1029.5264      1.1971759e-13  0              3.2790274    
   1200000   18000          200            200            0.0030353811   4.487743e-36   0              0.0091061432   0.0031914477   0              154.10359      1.1971759e-13  0              3.2790298    
   1300000   18000          200            200            0.0030380968   1.1219356e-36  0              0.0091142905   0.0004535474   0              21.900181      1.1971759e-13  0              3.2790292    
   1400000   18000          200            200            0.0030376395  -1.9633871e-36  0              0.0091129184   6.1364832e-05  0              2.9630881      1.1971759e-13  0              3.2790293    
   1500000   18000          200            200            0.0030376104  -8.4145162e-37  0              0.0091128311   7.9174606e-06  0              0.38230584     1.1971759e-13  0              3.2790293    
   1600000   18000          200            200            0.0030376915   2.8048389e-37  0              0.0091130744   9.7319453e-07  0              0.046992081    1.1971759e-13  0              3.2790293    
   1700000   18000          200            200            0.0030376372  -5.6096774e-37  0              0.0091129115   1.1356594e-07  0              0.0054836928   1.1971759e-13  0              3.2790293    
   1800000   18000          200            200            0.0030376654   2.8048389e-37  0              0.0091129963   1.2497729e-08  0              0.00060347059  1.1971759e-13  0              3.2790293    
   1900000   18000          200            200            0.0030376523  -1.4024194e-36  0              0.0091129569   1.281954e-09   0              6.1900972e-05  1.1971759e-13  0              3.2790293    
   2000000   18000          200            200            0.003037658    2.8048389e-37  0              0.009112974    1.2008219e-10  0              5.7983393e-06  1.1971759e-13  0              3.2790293    
   2100000   18000          200            200            0.0030376556   8.4145164e-37  0              0.0091129669   9.8930433e-12  0              4.7769966e-07  1.1971759e-13  0              3.2790293    
   2200000   18000          200            200            0.0030376566  -3.9267743e-36  0              0.0091129697   6.6250979e-13  0              3.1990227e-08  1.1971759e-13  0              3.2790293    
   2300000   18000          200            200            0.0030376562  -8.4145162e-37  0              0.0091129686   2.884706e-14   0              1.3929213e-09  1.1971759e-13  0              3.2790293    
   2400000   18000          200            200            0.0030376563   2.8048389e-37  0              0.009112969    1.5919927e-16  0              7.6871632e-12  1.1971759e-13  0              3.2790293    
   2500000   18000          200            200            0.0030376563   5.6096777e-37  0              0.0091129689   1.9071911e-16  0              9.2091435e-12  1.1971759e-13  0              3.2790293    
   2600000   18000          200            200            0.0030376563   1.0687653e-44  0              0.0091129689   1.8452357e-16  0              8.9099827e-12  1.1971759e-13  0              3.2790293    
   2700000   18000          200            200            0.0030376563   8.4145164e-37  0              0.0091129689   2.8110241e-17  0              1.3573429e-12  1.1971759e-13  0              3.2790293    
   2800000   18000          200            200            0.0030376563   1.0295714e-44  0              0.0091129689   9.0200897e-19  0              4.3554785e-14  1.1971759e-13  0              3.2790293    
   2900000   18000          200            200            0.0030376563   5.6096776e-37  0              0.0091129689   2.7484609e-18  0              1.3271334e-13  1.1971759e-13  0              3.2790293    
   3000000   18000          200            200            0.0030376563  -5.6096775e-37  0              0.0091129689   2.640049e-18   0              1.2747852e-13  1.1971759e-13  0              3.2790293    
Loop time of 776.61 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3337580.954 ns/day, 0.000 hours/ns, 3862.941 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.31     | 239.07     | 239.83     |   4.9 | 30.78
Neigh   | 12.821     | 12.821     | 12.821     |   0.0 |  1.65
Comm    | 36.217     | 37.193     | 38.168     |  16.0 |  4.79
Output  | 0.61056    | 0.61058    | 0.6106     |   0.0 |  0.08
Modify  | 426.88     | 426.96     | 427.05     |   0.4 | 54.98
Other   |            | 59.96      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.57                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.411423031854
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.67
  ghost atom cutoff = 3.67
  binsize = 1.835, bins = 9810 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 256.4 | 256.4 | 256.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026692004  -8.9754706e-36  0              0.0080076012   1468087.8      0              7.0888707e+10  1.1971759e-13  0              3.3093951    
    200000   18000          200            200           -0.00029379287 -1.7950887e-35  0             -0.00088137862  158284.61      0              7.6429972e+09  1.1971759e-13  0              3.3876993    
    300000   18000          200            200           -0.00011333567 -8.6164639e-34  0             -0.00034000701  13390.769      0              6.4659233e+08  1.1971759e-13  0              3.3244777    
    400000   18000          200            200            0.00015771201  5.3852963e-35  0              0.00047313604  17404.212      0              8.4038713e+08  1.1971759e-13  0              3.2869805    
    500000   18000          200            200           -2.0385261e-05 -1.7950918e-35  0             -6.1155783e-05  370.58759      0              17894349       1.1971759e-13  0              3.2864475    
    600000   18000          200            200            0.0050644048  -9.8730304e-35  0              0.015193215    422.64951      0              20408232       1.1971759e-13  0              3.2836411    
    700000   18000          200            200            0.0041896338   2.6926462e-35  0              0.012568901    3.8150018      0              184212.78      1.1971759e-13  0              3.2837985    
    800000   18000          200            200            0.0026422561  -1.7950959e-35  0              0.0079267683   0.2654316      0              12816.742      1.1971759e-13  0              3.2841166    
    900000   18000          200            200            0.0031858097  -4.4877337e-36  0              0.009557429    0.12961591     0              6258.6884      1.1971759e-13  0              3.2839995    
   1000000   18000          200            200            0.0029925449   8.9754908e-36  0              0.0089776347   0.031144884    0              1503.875       1.1971759e-13  0              3.2840403    
   1100000   18000          200            200            0.0030594551   3.5919328e-42  0              0.0091783652   0.0063835063   0              308.23668      1.1971759e-13  0              3.2840261    
   1200000   18000          200            200            0.0030364646   1.7950969e-35  0              0.0091093937   0.0011765456   0              56.811177      1.1971759e-13  0              3.2840309    
   1300000   18000          200            200            0.0030442328  -2.243871e-36   0              0.0091326985   0.00020287004  0              9.795868       1.1971759e-13  0              3.2840293    
   1400000   18000          200            200            0.0030416526   1.1219355e-36  0              0.0091249577   3.3174355e-05  0              1.6018709      1.1971759e-13  0              3.2840298    
   1500000   18000          200            200            0.0030424917   1.4024194e-36  0              0.0091274751   5.2034988e-06  0              0.25125834     1.1971759e-13  0              3.2840297    
   1600000   18000          200            200            0.0030422259  -8.4145162e-37  0              0.0091266776   7.8797566e-07  0              0.038048524    1.1971759e-13  0              3.2840297    
   1700000   18000          200            200            0.0030423072  -2.8048387e-37  0              0.0091269216   1.1574777e-07  0              0.0055890454   1.1971759e-13  0              3.2840297    
   1800000   18000          200            200            0.0030422835   1.4024194e-36  0              0.0091268505   1.6545188e-08  0              0.00079890789  1.1971759e-13  0              3.2840297    
   1900000   18000          200            200            0.0030422899   2.8048389e-37  0              0.0091268697   2.3064267e-09  0              0.00011136909  1.1971759e-13  0              3.2840297    
   2000000   18000          200            200            0.0030422884  -8.4145162e-37  0              0.0091268652   3.1398621e-10  0              1.516127e-05   1.1971759e-13  0              3.2840297    
   2100000   18000          200            200            0.0030422886  -4.7682259e-36  0              0.0091268659   4.1782819e-11  0              2.0175428e-06  1.1971759e-13  0              3.2840297    
   2200000   18000          200            200            0.0030422887  -5.6096774e-37  0              0.009126866    5.4293236e-12  0              2.621626e-07   1.1971759e-13  0              3.2840297    
   2300000   18000          200            200            0.0030422886  -8.4145162e-37  0              0.0091268659   6.9006308e-13  0              3.3320677e-08  1.1971759e-13  0              3.2840297    
   2400000   18000          200            200            0.0030422887   2.8048389e-37  0              0.009126866    8.5753178e-14  0              4.1407141e-09  1.1971759e-13  0              3.2840297    
   2500000   18000          200            200            0.0030422886  -8.4145162e-37  0              0.0091268659   1.0317354e-14  0              4.9818811e-10  1.1971759e-13  0              3.2840297    
   2600000   18000          200            200            0.0030422886   5.6096777e-37  0              0.0091268659   1.1161217e-15  0              5.3893522e-11  1.1971759e-13  0              3.2840297    
   2700000   18000          200            200            0.0030422886   2.8048389e-37  0              0.0091268659   1.576949e-16   0              7.6145224e-12  1.1971759e-13  0              3.2840297    
   2800000   18000          200            200            0.0030422886  -5.6096774e-37  0              0.0091268659   2.7396008e-17  0              1.3228552e-12  1.1971759e-13  0              3.2840297    
   2900000   18000          200            200            0.0030422886   5.6096777e-37  0              0.0091268659   1.3299232e-18  0              6.4217234e-14  1.1971759e-13  0              3.2840297    
   3000000   18000          200            200            0.0030422886   1.4024194e-36  0              0.0091268659   8.4761466e-18  0              4.0928278e-13  1.1971759e-13  0              3.2840297    
Loop time of 782.141 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3313979.167 ns/day, 0.000 hours/ns, 3835.624 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.03     | 243.94     | 245.86     |  12.3 | 31.19
Neigh   | 12.762     | 12.763     | 12.765     |   0.0 |  1.63
Comm    | 35.551     | 37.704     | 39.858     |  35.1 |  4.82
Output  | 0.60814    | 0.60816    | 0.60817    |   0.0 |  0.08
Modify  | 428.45     | 428.46     | 428.46     |   0.0 | 54.78
Other   |            | 58.67      |            |       |  7.50

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.58                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.8530900135247
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.68
  ghost atom cutoff = 3.68
  binsize = 1.84, bins = 9783 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 255.8 | 255.8 | 255.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026757887  -4.4877365e-36  0              0.008027366    1473034.1      0              7.1127547e+10  1.1971759e-13  0              3.3088993    
    200000   18000          200            200           -0.00029197667 -5.3852799e-35  0             -0.00087593002  152490.71      0              7.3632308e+09  1.1971759e-13  0              3.3951643    
    300000   18000          200            200           -0.00010682443 -1.795088e-35   0             -0.00032047328  11680.348      0              5.6400221e+08  1.1971759e-13  0              3.33029      
    400000   18000          200            200            0.00016781399 -1.7950913e-35  0              0.00050344197  19436.246      0              9.3850676e+08  1.1971759e-13  0              3.2909133    
    500000   18000          200            200           -1.1708458e-05 -5.3852854e-35  0             -3.5125373e-05  119.57545      0              5773870.7      1.1971759e-13  0              3.2915727    
    600000   18000          200            200            0.0059422241   1.7950987e-35  0              0.017826672    175.61554      0              8479845.8      1.1971759e-13  0              3.2884884    
    700000   18000          200            200            0.0039947136  -1.7950967e-34  0              0.011984141    30.059428      0              1451462.2      1.1971759e-13  0              3.288837     
    800000   18000          200            200            0.0026593371  -1.7950959e-35  0              0.0079780114   0.94161475     0              45467.206      1.1971759e-13  0              3.2891145    
    900000   18000          200            200            0.0031935485  -6.7316122e-35  0              0.0095806454   0.061735467    0              2980.9848      1.1971759e-13  0              3.2889992    
   1000000   18000          200            200            0.0029935181   8.9754909e-36  0              0.0089805543   0.0037871998   0              182.87032      1.1971759e-13  0              3.2890415    
   1100000   18000          200            200            0.003066473   -4.9365159e-35  0              0.0091994191   0.000161644    0              7.8052102      1.1971759e-13  0              3.289026     
   1200000   18000          200            200            0.0030398136  -2.2438701e-36  0              0.0091194407   1.2514804e-06  0              0.06042951     1.1971759e-13  0              3.2890316    
   1300000   18000          200            200            0.003049499    5.6096776e-36  0              0.0091484971   7.4013922e-07  0              0.035738674    1.1971759e-13  0              3.2890296    
   1400000   18000          200            200            0.0030459895  -9.8169357e-37  0              0.0091379685   5.9302764e-07  0              0.028635182    1.1971759e-13  0              3.2890303    
   1500000   18000          200            200            0.0030472564   1.6829033e-36  0              0.0091417692   1.9762025e-07  0              0.0095423748   1.1971759e-13  0              3.2890301    
   1600000   18000          200            200            0.0030468006  -2.8048387e-37  0              0.0091404018   4.8669133e-08  0              0.0023500583   1.1971759e-13  0              3.2890302    
   1700000   18000          200            200            0.003046964    2.8048389e-37  0              0.009140892    1.0257645e-08  0              0.00049530497  1.1971759e-13  0              3.2890301    
   1800000   18000          200            200            0.0030469056  -5.6096775e-36  0              0.0091407169   1.9644218e-09  0              9.4854901e-05  1.1971759e-13  0              3.2890301    
   1900000   18000          200            200            0.0030469264  -5.6096774e-37  0              0.0091407792   3.5239351e-10  0              1.7015821e-05  1.1971759e-13  0              3.2890301    
   2000000   18000          200            200            0.003046919    1.0594544e-44  0              0.0091407571   6.0272939e-11  0              2.9103645e-06  1.1971759e-13  0              3.2890301    
   2100000   18000          200            200            0.0030469216   8.4145164e-37  0              0.0091407649   9.9334497e-12  0              4.7965074e-07  1.1971759e-13  0              3.2890301    
   2200000   18000          200            200            0.0030469207   1.1219355e-36  0              0.0091407622   1.5926854e-12  0              7.6905078e-08  1.1971759e-13  0              3.2890301    
   2300000   18000          200            200            0.003046921    8.4145164e-37  0              0.0091407631   2.4856058e-13  0              1.2002101e-08  1.1971759e-13  0              3.2890301    
   2400000   18000          200            200            0.0030469209  -1.1219355e-36  0              0.0091407628   3.785343e-14   0              1.8278067e-09  1.1971759e-13  0              3.2890301    
   2500000   18000          200            200            0.003046921   -2.8048387e-37  0              0.0091407629   5.7507012e-15  0              2.7768078e-10  1.1971759e-13  0              3.2890301    
   2600000   18000          200            200            0.003046921    1.1219355e-36  0              0.0091407629   9.2287275e-16  0              4.4562222e-11  1.1971759e-13  0              3.2890301    
   2700000   18000          200            200            0.003046921   -1.1219355e-36  0              0.0091407629   9.246316e-17   0              4.4647151e-12  1.1971759e-13  0              3.2890301    
   2800000   18000          200            200            0.003046921    1.4024194e-36  0              0.0091407629   2.4882801e-19  0              1.2015014e-14  1.1971759e-13  0              3.2890301    
   2900000   18000          200            200            0.003046921    8.4145165e-37  0              0.0091407629   1.4158139e-20  0              6.8364588e-16  1.1971759e-13  0              3.2890301    
   3000000   18000          200            200            0.003046921    9.0859878e-45  0              0.0091407629   4.4555792e-18  0              2.1514398e-13  1.1971759e-13  0              3.2890301    
Loop time of 781.709 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3315810.336 ns/day, 0.000 hours/ns, 3837.743 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.44     | 243.41     | 245.37     |  12.6 | 31.14
Neigh   | 12.676     | 12.677     | 12.677     |   0.0 |  1.62
Comm    | 35.434     | 37.579     | 39.724     |  35.0 |  4.81
Output  | 0.60967    | 0.6097     | 0.60972    |   0.0 |  0.08
Modify  | 427.03     | 427.06     | 427.09     |   0.1 | 54.63
Other   |            | 60.38      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.59                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.2972313135691
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.69
  ghost atom cutoff = 3.69
  binsize = 1.845, bins = 9757 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 255.1 | 255.1 | 255.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026823764  -8.9754777e-36  0              0.0080471291   1477986.9      0              7.1366699e+10  1.1971759e-13  0              3.3083909    
    200000   18000          200            200           -0.00029002144  2.3336272e-34  0             -0.00087006431  146809.29      0              7.0888952e+09  1.1971759e-13  0              3.4025854    
    300000   18000          200            200           -0.00010018054  5.3852983e-35  0             -0.00030054163  10088.166      0              4.8712142e+08  1.1971759e-13  0              3.3360475    
    400000   18000          200            200            0.00049681731  4.7456753e-41  0              0.0014904519   21560.16       0              1.041063e+09   1.1971759e-13  0              3.2947854    
    500000   18000          200            200           -2.8869685e-06 -3.5901893e-35  0             -8.6609056e-06  6.9167804      0              333986.57      1.1971759e-13  0              3.2966293    
    600000   18000          200            200            0.0064078691  -1.795095e-35   0              0.019223607    15.543641      0              750546.77      1.1971759e-13  0              3.2934108    
    700000   18000          200            200            0.0036446849  -1.7950959e-35  0              0.010934055    65.206573      0              3148592.1      1.1971759e-13  0              3.2939069    
    800000   18000          200            200            0.0027489076  -3.5901926e-35  0              0.0082467228   5.1617197      0              249240.97      1.1971759e-13  0              3.2940963    
    900000   18000          200            200            0.0031660563  -4.4877338e-36  0              0.0094981688   0.63300991     0              30565.783      1.1971759e-13  0              3.2940063    
   1000000   18000          200            200            0.0030095554   1.7950975e-35  0              0.0090286661   0.079232649    0              3825.8611      1.1971759e-13  0              3.2940395    
   1100000   18000          200            200            0.0030669476  -4.4877386e-36  0              0.0092008429   0.010152861    0              490.24531      1.1971759e-13  0              3.2940273    
   1200000   18000          200            200            0.0030459202   9.9377366e-43  0              0.0091377605   0.0012942969   0              62.496966      1.1971759e-13  0              3.2940317    
   1300000   18000          200            200            0.0030536149  -1.1219354e-36  0              0.0091608448   0.00016524588  0              7.979132       1.1971759e-13  0              3.2940301    
   1400000   18000          200            200            0.0030507991  -1.4024194e-37  0              0.0091523972   2.10661e-05    0              1.0172066      1.1971759e-13  0              3.2940307    
   1500000   18000          200            200            0.0030518292  -1.9633871e-36  0              0.0091554875   2.6842606e-06  0              0.12961334     1.1971759e-13  0              3.2940305    
   1600000   18000          200            200            0.0030514524  -1.4024194e-36  0              0.0091543572   3.4172236e-07  0              0.01650055     1.1971759e-13  0              3.2940306    
   1700000   18000          200            200            0.0030515902   1.4024194e-36  0              0.0091547705   4.3469054e-08  0              0.002098965    1.1971759e-13  0              3.2940305    
   1800000   18000          200            200            0.0030515398   5.6096777e-37  0              0.0091546194   5.5244814e-09  0              0.00026675744  1.1971759e-13  0              3.2940305    
   1900000   18000          200            200            0.0030515582   1.4024194e-36  0              0.0091546747   7.0151081e-10  0              3.3873447e-05  1.1971759e-13  0              3.2940305    
   2000000   18000          200            200            0.0030515515   8.4145164e-37  0              0.0091546545   8.8993243e-11  0              4.2971652e-06  1.1971759e-13  0              3.2940305    
   2100000   18000          200            200            0.0030515539   5.6096777e-37  0              0.0091546618   1.1282592e-11  0              5.44796e-07    1.1971759e-13  0              3.2940305    
   2200000   18000          200            200            0.0030515531  -1.4024194e-36  0              0.0091546592   1.4282675e-12  0              6.8965928e-08  1.1971759e-13  0              3.2940305    
   2300000   18000          200            200            0.0030515534   1.1219355e-36  0              0.0091546601   1.7993515e-13  0              8.6884244e-09  1.1971759e-13  0              3.2940305    
   2400000   18000          200            200            0.0030515533  -5.6096774e-37  0              0.0091546598   2.2495582e-14  0              1.0862312e-09  1.1971759e-13  0              3.2940305    
   2500000   18000          200            200            0.0030515533  -2.243871e-36   0              0.0091546599   2.7609721e-15  0              1.3331746e-10  1.1971759e-13  0              3.2940305    
   2600000   18000          200            200            0.0030515533   1.6829033e-36  0              0.0091546599   2.7546948e-16  0              1.3301435e-11  1.1971759e-13  0              3.2940305    
   2700000   18000          200            200            0.0030515533   8.4145163e-36  0              0.0091546599   5.7665781e-17  0              2.7844742e-12  1.1971759e-13  0              3.2940305    
   2800000   18000          200            200            0.0030515533   1.0218004e-44  0              0.0091546599   2.0048528e-17  0              9.6807168e-13  1.1971759e-13  0              3.2940305    
   2900000   18000          200            200            0.0030515533   1.0343461e-44  0              0.0091546599   4.1123377e-19  0              1.9857007e-14  1.1971759e-13  0              3.2940305    
   3000000   18000          200            200            0.0030515533   5.6096777e-37  0              0.0091546599   7.9199949e-18  0              3.8242821e-13  1.1971759e-13  0              3.2940305    
Loop time of 780.879 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3319336.840 ns/day, 0.000 hours/ns, 3841.825 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.65     | 242.83     | 244.02     |   7.6 | 31.10
Neigh   | 13         | 13         | 13.001     |   0.0 |  1.66
Comm    | 36.65      | 38.058     | 39.467     |  22.8 |  4.87
Output  | 0.60976    | 0.60979    | 0.60983    |   0.0 |  0.08
Modify  | 427.21     | 427.29     | 427.36     |   0.4 | 54.72
Other   |            | 59.09      |            |       |  7.57

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.6                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.7438538434912
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.7
  ghost atom cutoff = 3.7
  binsize = 1.85, bins = 9730 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 254.4 | 254.4 | 254.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026889633   5.7146585e-42  0              0.00806689     1482945.9      0              7.160615e+10   1.1971759e-13  0              3.3078703    
    200000   18000          200            200           -0.00028792853  1.7951043e-35  0             -0.00086378558  141241.6       0              6.8200515e+09  1.1971759e-13  0              3.409962     
    300000   18000          200            200           -9.3407578e-05  1.7951045e-35  0             -0.00028022274  8614.4697      0              4.1596191e+08  1.1971759e-13  0              3.3417497    
    400000   18000          200            200            0.0054090379  -1.0770576e-34  0              0.016227114    21899.212      0              1.0574346e+09  1.1971759e-13  0              3.2986141    
    500000   18000          200            200            6.0743005e-06  4.6936859e-41  0              1.8222901e-05  32.047899      0              1547478.4      1.1971759e-13  0              3.3016172    
    600000   18000          200            200            0.0063524784  -1.7950953e-35  0              0.019057435    35.609431      0              1719452        1.1971759e-13  0              3.2984204    
    700000   18000          200            200            0.0032103865  -1.7950959e-35  0              0.0096311595   87.02766       0              4202254.2      1.1971759e-13  0              3.2989965    
    800000   18000          200            200            0.0028970143   6.2828399e-35  0              0.008691043    9.8802819      0              477083.45      1.1971759e-13  0              3.2990656    
    900000   18000          200            200            0.003111328   -2.2438702e-35  0              0.009333984    1.3243265      0              63946.985      1.1971759e-13  0              3.2990191    
   1000000   18000          200            200            0.0030374735   6.9865141e-42  0              0.0091124205   0.17759122     0              8575.2446      1.1971759e-13  0              3.299035     
   1100000   18000          200            200            0.0030622856  -1.3463223e-35  0              0.0091868567   0.023991915    0              1158.4837      1.1971759e-13  0              3.2990296    
   1200000   18000          200            200            0.0030542082   1.0251518e-42  0              0.0091626247   0.0032255947   0              155.75242      1.1971759e-13  0              3.2990314    
   1300000   18000          200            200            0.0030568137  -1.1219355e-36  0              0.0091704411   0.00043283659  0              20.90013       1.1971759e-13  0              3.2990308    
   1400000   18000          200            200            0.00305599    -1.4024194e-37  0              0.0091679701   5.7911552e-05  0              2.7963416      1.1971759e-13  0              3.299031     
   1500000   18000          200            200            0.0030562447   5.6096776e-37  0              0.0091687341   7.7284944e-06  0              0.37318134     1.1971759e-13  0              3.2990309    
   1600000   18000          200            200            0.0030561685   5.6096777e-37  0              0.0091685055   1.0286864e-06  0              0.049671584    1.1971759e-13  0              3.299031     
   1700000   18000          200            200            0.0030561902   1.0401885e-44  0              0.0091685707   1.3657021e-07  0              0.0065944867   1.1971759e-13  0              3.2990309    
   1800000   18000          200            200            0.0030561845  -2.8048387e-37  0              0.0091685535   1.8085367e-08  0              0.00087327764  1.1971759e-13  0              3.2990309    
   1900000   18000          200            200            0.0030561858  -2.8048387e-37  0              0.0091685574   2.3889588e-09  0              0.00011535427  1.1971759e-13  0              3.2990309    
   2000000   18000          200            200            0.0030561856  -5.6096774e-37  0              0.0091685569   3.1471917e-10  0              1.5196662e-05  1.1971759e-13  0              3.2990309    
   2100000   18000          200            200            0.0030561856  -8.4145162e-37  0              0.0091685568   4.1355099e-11  0              1.9968897e-06  1.1971759e-13  0              3.2990309    
   2200000   18000          200            200            0.0030561856  -2.243871e-36   0              0.0091685569   5.4173132e-12  0              2.6158267e-07  1.1971759e-13  0              3.2990309    
   2300000   18000          200            200            0.0030561856   1.0620389e-44  0              0.0091685568   7.0755005e-13  0              3.416506e-08   1.1971759e-13  0              3.2990309    
   2400000   18000          200            200            0.0030561856   8.4145164e-37  0              0.0091685569   9.2369574e-14  0              4.4601962e-09  1.1971759e-13  0              3.2990309    
   2500000   18000          200            200            0.0030561856   2.8048389e-37  0              0.0091685568   1.2093218e-14  0              5.8393823e-10  1.1971759e-13  0              3.2990309    
   2600000   18000          200            200            0.0030561856   5.6096777e-37  0              0.0091685568   1.5916671e-15  0              7.6855907e-11  1.1971759e-13  0              3.2990309    
   2700000   18000          200            200            0.0030561856  -1.6829033e-36  0              0.0091685568   1.9773219e-16  0              9.5477796e-12  1.1971759e-13  0              3.2990309    
   2800000   18000          200            200            0.0030561856  -8.4145162e-37  0              0.0091685568   5.5195311e-18  0              2.665184e-13   1.1971759e-13  0              3.2990309    
   2900000   18000          200            200            0.0030561856   2.8048389e-37  0              0.0091685568   9.8691712e-19  0              4.7654696e-14  1.1971759e-13  0              3.2990309    
   3000000   18000          200            200            0.0030561856   2.8048389e-37  0              0.0091685568   6.3164068e-18  0              3.0499668e-13  1.1971759e-13  0              3.2990309    
Loop time of 779.666 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3324500.775 ns/day, 0.000 hours/ns, 3847.802 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.86     | 239.81     | 241.77     |  12.6 | 30.76
Neigh   | 13.062     | 13.062     | 13.063     |   0.0 |  1.68
Comm    | 36.388     | 38.6       | 40.813     |  35.6 |  4.95
Output  | 0.6097     | 0.6097     | 0.60971    |   0.0 |  0.08
Modify  | 427.37     | 427.39     | 427.41     |   0.1 | 54.82
Other   |            | 60.19      |            |       |  7.72

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.61                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.1929645147953
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.71
  ghost atom cutoff = 3.71
  binsize = 1.855, bins = 9704 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 249.6 | 249.6 | 249.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.0026955497  -1.7950955e-35  0              0.008086649    1487911.2      0              7.1845908e+10  1.1971759e-13  0              3.3073371    
    200000   18000          200            200           -0.00028569794  1.2320345e-40  0             -0.00085709381  135786.04      0              6.5566221e+09  1.1971759e-13  0              3.4172943    
    300000   18000          200            200           -8.6504112e-05 -1.7950889e-35  0             -0.00025951233  7258.3749      0              3.5048095e+08  1.1971759e-13  0              3.3473967    
    400000   18000          200            200            0.01290162    -3.590189e-35   0              0.03870486     17568.708      0              8.4833006e+08  1.1971759e-13  0              3.302493     
    500000   18000          200            200            1.517655e-05  -3.5901888e-35  0              4.552965e-05   194.33396      0              9383691.3      1.1971759e-13  0              3.3065363    
    600000   18000          200            200            0.0057872499  -2.6926436e-35  0              0.01736175     222.99878      0              10767813       1.1971759e-13  0              3.303516     
    700000   18000          200            200            0.0027708736  -4.487741e-35   0              0.0083126207   82.789097      0              3997589.2      1.1971759e-13  0              3.3040914    
    800000   18000          200            200            0.0030785802  -1.7950958e-35  0              0.0092357405   11.643974      0              562245.82      1.1971759e-13  0              3.3040284    
    900000   18000          200            200            0.0030438839  -1.3463218e-35  0              0.0091316517   1.5161486      0              73209.391      1.1971759e-13  0              3.3040346    
   1000000   18000          200            200            0.0030707549  -1.7950967e-34  0              0.0092122648   0.19541117     0              9435.7062      1.1971759e-13  0              3.3040294    
   1100000   18000          200            200            0.0030556023   3.4021137e-42  0              0.0091668068   0.024746655    0              1194.9274      1.1971759e-13  0              3.3040324    
   1200000   18000          200            200            0.0030632615   8.9754851e-36  0              0.0091897846   0.0030931645   0              149.35785      1.1971759e-13  0              3.3040309    
   1300000   18000          200            200            0.0030597345  -2.243871e-36   0              0.0091792035   0.00038041674  0              18.368963      1.1971759e-13  0              3.3040316    
   1400000   18000          200            200            0.0030612794  -1.1219355e-36  0              0.0091838383   4.6040747e-05  0              2.2231429      1.1971759e-13  0              3.3040313    
   1500000   18000          200            200            0.0030606268   1.4024194e-36  0              0.0091818804   5.4726818e-06  0              0.26425622     1.1971759e-13  0              3.3040314    
   1600000   18000          200            200            0.0030608954   2.8048389e-37  0              0.0091826862   6.3781665e-07  0              0.030797883    1.1971759e-13  0              3.3040313    
   1700000   18000          200            200            0.0030607871   1.1219355e-36  0              0.0091823612   7.2689869e-08  0              0.0035099336   1.1971759e-13  0              3.3040314    
   1800000   18000          200            200            0.0030608301   2.8048389e-37  0              0.0091824902   8.0734674e-09  0              0.00038983885  1.1971759e-13  0              3.3040314    
   1900000   18000          200            200            0.0030608132  -1.9633871e-36  0              0.0091824397   8.6964651e-10  0              4.1992118e-05  1.1971759e-13  0              3.3040314    
   2000000   18000          200            200            0.0030608197  -5.6096774e-37  0              0.0091824592   9.0265968e-11  0              4.3586206e-06  1.1971759e-13  0              3.3040314    
   2100000   18000          200            200            0.0030608172   3.0853227e-36  0              0.0091824517   8.9214048e-12  0              4.3078271e-07  1.1971759e-13  0              3.3040314    
   2200000   18000          200            200            0.0030608182   2.8048389e-37  0              0.0091824546   8.2908954e-13  0              4.0033767e-08  1.1971759e-13  0              3.3040314    
   2300000   18000          200            200            0.0030608178   2.8048389e-37  0              0.0091824535   7.0813976e-14  0              3.4193535e-09  1.1971759e-13  0              3.3040314    
   2400000   18000          200            200            0.003060818   -1.6829033e-36  0              0.0091824539   5.0873037e-15  0              2.4564769e-10  1.1971759e-13  0              3.3040314    
   2500000   18000          200            200            0.0030608179  -2.8048387e-37  0              0.0091824538   2.7376964e-16  0              1.3219356e-11  1.1971759e-13  0              3.3040314    
   2600000   18000          200            200            0.0030608179   1.4024194e-36  0              0.0091824538   1.9279456e-17  0              9.3093595e-13  1.1971759e-13  0              3.3040314    
   2700000   18000          200            200            0.0030608179   8.4145164e-37  0              0.0091824538   3.9016524e-18  0              1.8839683e-13  1.1971759e-13  0              3.3040314    
   2800000   18000          200            200            0.0030608179  -2.8048387e-37  0              0.0091824538   1.6368148e-17  0              7.9035927e-13  1.1971759e-13  0              3.3040314    
   2900000   18000          200            200            0.0030608179   5.6096777e-37  0              0.0091824538   3.3752587e-18  0              1.6297916e-13  1.1971759e-13  0              3.3040314    
   3000000   18000          200            200            0.0030608179  -1.3182742e-35  0              0.0091824538   1.0584012e-18  0              5.1106404e-14  1.1971759e-13  0              3.3040314    
Loop time of 779.574 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3324894.952 ns/day, 0.000 hours/ns, 3848.258 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.83     | 241.41     | 241.99     |   3.7 | 30.97
Neigh   | 12.914     | 12.914     | 12.915     |   0.0 |  1.66
Comm    | 36.715     | 37.537     | 38.358     |  13.4 |  4.82
Output  | 0.61206    | 0.61207    | 0.61209    |   0.0 |  0.08
Modify  | 426.81     | 426.97     | 427.14     |   0.8 | 54.77
Other   |            | 60.13      |            |       |  7.71

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.62                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.6445702389847
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.72
  ghost atom cutoff = 3.72
  binsize = 1.86, bins = 9678 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 248.9 | 248.9 | 248.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.021154526   -1.7950964e-35  0              0.063463577    1477395.9      0              7.1338162e+10  1.1971759e-13  0              3.3067961    
    200000   18000          200            200           -0.00028333039 -7.1803788e-35  0             -0.00084999118  130442.55      0              6.298604e+09   1.1971759e-13  0              3.4245824    
    300000   18000          200            200           -7.9471662e-05 -3.5901864e-35  0             -0.00023841498  6019.6545      0              2.9066757e+08  1.1971759e-13  0              3.3529883    
    400000   18000          200            200            0.0205241      3.5901991e-35  0              0.0615723      9407.4431      0              4.5425176e+08  1.1971759e-13  0              3.3065718    
    500000   18000          200            200            2.4418021e-05 -1.7950917e-35  0              7.3254062e-05  493.16604      0              23813223       1.1971759e-13  0              3.3113864    
    600000   18000          200            200            0.004839921    8.9755012e-36  0              0.014519763    467.38189      0              22568199       1.1971759e-13  0              3.3086829    
    700000   18000          200            200            0.002394855    1.0544293e-41  0              0.0071845649   56.07578       0              2707698.7      1.1971759e-13  0              3.3091769    
    800000   18000          200            200            0.0032601848   5.3852915e-35  0              0.0097805545   9.0998631      0              439399.82      1.1971759e-13  0              3.3089919    
    900000   18000          200            200            0.002980928    1.3463234e-35  0              0.008942784    1.0424108      0              50334.287      1.1971759e-13  0              3.3090494    
   1000000   18000          200            200            0.0031013083  -8.9754772e-36  0              0.009303925    0.11404856     0              5506.9967      1.1971759e-13  0              3.3090243    
   1100000   18000          200            200            0.0030506648  -8.9754806e-36  0              0.0091519945   0.011560578    0              558.21896      1.1971759e-13  0              3.3090349    
   1200000   18000          200            200            0.003071372   -6.731612e-36   0              0.009214116    0.0010896079   0              52.613264      1.1971759e-13  0              3.3090305    
   1300000   18000          200            200            0.0030631361  -5.609677e-37   0              0.0091894082   9.1901966e-05  0              4.437617       1.1971759e-13  0              3.3090322    
   1400000   18000          200            200            0.0030663362   2.8048388e-37  0              0.0091990087   6.5298238e-06  0              0.31530182     1.1971759e-13  0              3.3090316    
   1500000   18000          200            200            0.0030651174  -2.8048387e-37  0              0.0091953521   3.3281673e-07  0              0.016070529    1.1971759e-13  0              3.3090318    
   1600000   18000          200            200            0.0030655732   4.487742e-36   0              0.0091967195   6.2171809e-09  0              0.00030020541  1.1971759e-13  0              3.3090317    
   1700000   18000          200            200            0.0030654056   1.4024194e-36  0              0.0091962169   3.6776105e-10  0              1.7757865e-05  1.1971759e-13  0              3.3090318    
   1800000   18000          200            200            0.0030654662   8.4145164e-37  0              0.0091963986   5.842188e-10   0              2.8209835e-05  1.1971759e-13  0              3.3090318    
   1900000   18000          200            200            0.0030654447   1.0443726e-44  0              0.009196334    2.2104303e-10  0              1.0673377e-05  1.1971759e-13  0              3.3090318    
   2000000   18000          200            200            0.0030654522   1.0422385e-44  0              0.0091963565   5.6482343e-11  0              2.7273302e-06  1.1971759e-13  0              3.3090318    
   2100000   18000          200            200            0.0030654496  -2.243871e-36   0              0.0091963488   1.1906536e-11  0              5.7492401e-07  1.1971759e-13  0              3.3090318    
   2200000   18000          200            200            0.0030654505   5.6096777e-37  0              0.0091963514   2.2315469e-12  0              1.0775341e-07  1.1971759e-13  0              3.3090318    
   2300000   18000          200            200            0.0030654502  -8.4145162e-37  0              0.0091963506   3.8607608e-13  0              1.8642232e-08  1.1971759e-13  0              3.3090318    
   2400000   18000          200            200            0.0030654503  -8.4145162e-37  0              0.0091963508   6.2421749e-14  0              3.0141228e-09  1.1971759e-13  0              3.3090318    
   2500000   18000          200            200            0.0030654502  -1.1219355e-36  0              0.0091963507   9.6023722e-15  0              4.6366419e-10  1.1971759e-13  0              3.3090318    
   2600000   18000          200            200            0.0030654503   1.0305563e-44  0              0.0091963508   1.3604166e-15  0              6.568965e-11   1.1971759e-13  0              3.3090318    
   2700000   18000          200            200            0.0030654503   1.4024194e-36  0              0.0091963508   2.0853608e-16  0              1.0069461e-11  1.1971759e-13  0              3.3090318    
   2800000   18000          200            200            0.0030654503  -1.4024194e-36  0              0.0091963508   1.5324997e-17  0              7.3998925e-13  1.1971759e-13  0              3.3090318    
   2900000   18000          200            200            0.0030654503   1.4024194e-36  0              0.0091963508   6.8764631e-18  0              3.3203979e-13  1.1971759e-13  0              3.3090318    
   3000000   18000          200            200            0.0030654503   2.8048389e-37  0              0.0091963508   2.9636699e-21  0              1.4310501e-16  1.1971759e-13  0              3.3090318    
Loop time of 777.704 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3332886.156 ns/day, 0.000 hours/ns, 3857.507 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.99     | 243.1      | 244.2      |   7.1 | 31.26
Neigh   | 12.053     | 12.053     | 12.053     |   0.0 |  1.55
Comm    | 35.607     | 36.504     | 37.401     |  14.8 |  4.69
Output  | 0.61085    | 0.61087    | 0.61089    |   0.0 |  0.08
Modify  | 425.46     | 425.56     | 425.67     |   0.5 | 54.72
Other   |            | 59.88      |            |       |  7.70

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.63                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.0986779275632
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.73
  ghost atom cutoff = 3.73
  binsize = 1.865, bins = 9652 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 248.3 | 248.3 | 248.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.083756387   -2.692644e-35   0              0.25126916     1314847.4      0              6.3489275e+10  1.1971759e-13  0              3.3063919    
    200000   18000          200            200           -0.00028082635 -1.7950892e-35  0             -0.00084247906  125210.59      0              6.0459712e+09  1.1971759e-13  0              3.4318263    
    300000   18000          200            200           -7.2310066e-05  3.5902009e-35  0             -0.0002169302   4897.7836      0              2.3649644e+08  1.1971759e-13  0              3.3585246    
    400000   18000          200            200            0.025787237   -8.9754787e-35  0              0.077361711    1954.683       0              94384648       1.1971759e-13  0              3.3110037    
    500000   18000          200            200            3.3799093e-05  5.3852952e-35  0              0.00010139728  928.01695      0              44810617       1.1971759e-13  0              3.3161675    
    600000   18000          200            200            0.003710293    5.3852971e-35  0              0.011130879    634.39589      0              30632707       1.1971759e-13  0              3.3138965    
    700000   18000          200            200            0.0021300873  -3.5901896e-35  0              0.0063902618   22.983478      0              1109789.9      1.1971759e-13  0              3.3142403    
    800000   18000          200            200            0.0034058797   1.7950994e-35  0              0.010217639    4.0961349      0              197787.7       1.1971759e-13  0              3.3139633    
    900000   18000          200            200            0.0029381399   1.7950976e-35  0              0.0088144197   0.32709438     0              15794.217      1.1971759e-13  0              3.31406      
   1000000   18000          200            200            0.0031217466   7.629162e-35   0              0.0093652399   0.019068769    0              920.76262      1.1971759e-13  0              3.3140214    
   1100000   18000          200            200            0.0030506364  -4.4877386e-36  0              0.0091519091   0.00049729039  0              24.012373      1.1971759e-13  0              3.3140362    
   1200000   18000          200            200            0.0030771996   4.4877431e-36  0              0.0092315987   4.9232146e-06  0              0.23772441     1.1971759e-13  0              3.3140307    
   1300000   18000          200            200            0.0030675606  -2.8048387e-36  0              0.0092026818   2.0446381e-05  0              0.98728258     1.1971759e-13  0              3.3140327    
   1400000   18000          200            200            0.0030709481   8.4145163e-37  0              0.0092128442   8.6345969e-06  0              0.41693378     1.1971759e-13  0              3.314032     
   1500000   18000          200            200            0.0030697962  -1.1219355e-36  0              0.0092093886   2.2617542e-06  0              0.10921202     1.1971759e-13  0              3.3140322    
   1600000   18000          200            200            0.0030701733  -2.8048387e-37  0              0.0092105198   4.7288635e-07  0              0.022833989    1.1971759e-13  0              3.3140321    
   1700000   18000          200            200            0.0030700555   8.4145164e-37  0              0.0092101664   8.6044988e-08  0              0.0041548045   1.1971759e-13  0              3.3140322    
   1800000   18000          200            200            0.00307009     2.8048389e-37  0              0.00921027     1.4174073e-08  0              0.00068441527  1.1971759e-13  0              3.3140322    
   1900000   18000          200            200            0.0030700808   1.0228422e-44  0              0.0092102425   2.1574006e-09  0              0.00010417316  1.1971759e-13  0              3.3140322    
   2000000   18000          200            200            0.0030700828  -2.8048387e-37  0              0.0092102485   3.0669486e-10  0              1.4809197e-05  1.1971759e-13  0              3.3140322    
   2100000   18000          200            200            0.0030700826   2.243871e-36   0              0.0092102478   4.094344e-11   0              1.9770122e-06  1.1971759e-13  0              3.3140322    
   2200000   18000          200            200            0.0030700825  -2.8048387e-37  0              0.0092102475   5.1397008e-12  0              2.4817776e-07  1.1971759e-13  0              3.3140322    
   2300000   18000          200            200            0.0030700826   5.6096777e-37  0              0.0092102478   6.0492468e-13  0              2.9209648e-08  1.1971759e-13  0              3.3140322    
   2400000   18000          200            200            0.0030700826   1.4024194e-36  0              0.0092102477   6.6619708e-14  0              3.2168273e-09  1.1971759e-13  0              3.3140322    
   2500000   18000          200            200            0.0030700826   2.8048389e-37  0              0.0092102477   6.8322882e-15  0              3.2990674e-10  1.1971759e-13  0              3.3140322    
   2600000   18000          200            200            0.0030700826  -8.4145162e-37  0              0.0092102477   7.0517168e-16  0              3.4050217e-11  1.1971759e-13  0              3.3140322    
   2700000   18000          200            200            0.0030700826  -2.8048387e-37  0              0.0092102477   2.6145134e-17  0              1.2624549e-12  1.1971759e-13  0              3.3140322    
   2800000   18000          200            200            0.0030700826  -2.8048387e-37  0              0.0092102477   4.7071105e-18  0              2.2728952e-13  1.1971759e-13  0              3.3140322    
   2900000   18000          200            200            0.0030700826   7.8535486e-36  0              0.0092102477   1.1328009e-19  0              5.46989e-15    1.1971759e-13  0              3.3140322    
   3000000   18000          200            200            0.0030700826  -2.8048388e-36  0              0.0092102477   1.2136998e-17  0              5.860522e-13   1.1971759e-13  0              3.3140322    
Loop time of 776.987 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3335963.744 ns/day, 0.000 hours/ns, 3861.069 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.58     | 243.6      | 243.62     |   0.1 | 31.35
Neigh   | 11.689     | 11.69      | 11.691     |   0.0 |  1.50
Comm    | 34.959     | 35.213     | 35.466     |   4.3 |  4.53
Output  | 0.60966    | 0.60968    | 0.60971    |   0.0 |  0.08
Modify  | 426.6      | 426.64     | 426.69     |   0.2 | 54.91
Other   |            | 59.23      |            |       |  7.62

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.64                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.5552944920351
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.74
  ghost atom cutoff = 3.74
  binsize = 1.87, bins = 9626 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 243.5 | 243.5 | 243.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.16106369    -1.7950955e-35  0              0.48319107     942332.67      0              4.5501872e+10  1.1971759e-13  0              3.3065333    
    200000   18000          200            200           -0.00027818696  1.7951055e-35  0             -0.00083456087  120090.73      0              5.7987515e+09  1.1971759e-13  0              3.4390254    
    300000   18000          200            200           -6.5021642e-05  3.5902017e-35  0             -0.00019506493  3892.6221      0              1.8796079e+08  1.1971759e-13  0              3.3640053    
    400000   18000          200            200            0.026829825    6.8849045e-41  0              0.080489475    289.7147       0              13989286       1.1971759e-13  0              3.3158951    
    500000   18000          200            200            4.3316907e-05 -8.9754792e-35  0              0.00012995072  1498.2277      0              72344056       1.1971759e-13  0              3.3208794    
    600000   18000          200            200            0.0026060653  -8.9754679e-36  0              0.0078181958   645.86223      0              31186376       1.1971759e-13  0              3.3191275    
    700000   18000          200            200            0.002002963    1.7950979e-35  0              0.0060088889   2.0567291      0              99312.085      1.1971759e-13  0              3.3192726    
    800000   18000          200            200            0.0034852378   1.7950978e-35  0              0.010455713    0.392947       0              18974.004      1.1971759e-13  0              3.3189484    
    900000   18000          200            200            0.0029262681  -2.2438702e-35  0              0.0087788044   8.4797398e-05  0              4.0945629      1.1971759e-13  0              3.319064     
   1000000   18000          200            200            0.0031275333   6.7634136e-42  0              0.0093826      0.010001766    0              482.94947      1.1971759e-13  0              3.3190215    
   1100000   18000          200            200            0.0030570465   4.4877455e-36  0              0.0091711394   0.0048988839   0              236.54957      1.1971759e-13  0              3.3190363    
   1200000   18000          200            200            0.0030802879  -2.6926451e-35  0              0.0092408637   0.0013296149   0              64.202343      1.1971759e-13  0              3.3190314    
   1300000   18000          200            200            0.003073097   -1.1219354e-36  0              0.0092192911   0.00027507686  0              13.282477      1.1971759e-13  0              3.3190329    
   1400000   18000          200            200            0.0030751266  -2.8048388e-37  0              0.0092253798   4.8184376e-05  0              2.3266511      1.1971759e-13  0              3.3190325    
   1500000   18000          200            200            0.0030746364  -1.4024194e-36  0              0.0092239091   7.4531392e-06  0              0.35988542     1.1971759e-13  0              3.3190326    
   1600000   18000          200            200            0.0030747163   1.0303151e-44  0              0.0092241488   1.0378334e-06  0              0.050113259    1.1971759e-13  0              3.3190326    
   1700000   18000          200            200            0.0030747242   1.4024194e-36  0              0.0092241727   1.3086787e-07  0              0.0063191412   1.1971759e-13  0              3.3190326    
   1800000   18000          200            200            0.0030747081  -1.1219355e-36  0              0.0092241243   1.4877801e-08  0              0.00071839576  1.1971759e-13  0              3.3190326    
   1900000   18000          200            200            0.0030747185   1.1219355e-36  0              0.0092241554   1.4994914e-09  0              7.2405075e-05  1.1971759e-13  0              3.3190326    
   2000000   18000          200            200            0.0030747132  -2.8048387e-37  0              0.0092241397   1.2890898e-10  0              6.2245531e-06  1.1971759e-13  0              3.3190326    
   2100000   18000          200            200            0.0030747156  -5.6096774e-37  0              0.0092241467   8.6486726e-12  0              4.1761345e-07  1.1971759e-13  0              3.3190326    
   2200000   18000          200            200            0.0030747146  -1.9633871e-36  0              0.0092241439   3.4350503e-13  0              1.6586628e-08  1.1971759e-13  0              3.3190326    
   2300000   18000          200            200            0.003074715   -8.4145162e-37  0              0.009224145    7.6172523e-16  0              3.6780985e-11  1.1971759e-13  0              3.3190326    
   2400000   18000          200            200            0.0030747149   1.0305146e-44  0              0.0092241446   3.2753593e-15  0              1.5815538e-10  1.1971759e-13  0              3.3190326    
   2500000   18000          200            200            0.0030747149  -1.1219355e-36  0              0.0092241447   1.8359653e-15  0              8.8652192e-11  1.1971759e-13  0              3.3190326    
   2600000   18000          200            200            0.0030747149   2.8048389e-37  0              0.0092241447   4.5613351e-16  0              2.2025055e-11  1.1971759e-13  0              3.3190326    
   2700000   18000          200            200            0.0030747149  -2.5243549e-36  0              0.0092241447   1.3956981e-16  0              6.7393265e-12  1.1971759e-13  0              3.3190326    
   2800000   18000          200            200            0.0030747149  -8.4145162e-37  0              0.0092241447   2.5655593e-17  0              1.2388167e-12  1.1971759e-13  0              3.3190326    
   2900000   18000          200            200            0.0030747149   2.8048389e-37  0              0.0092241447   5.0298232e-18  0              2.4287216e-13  1.1971759e-13  0              3.3190326    
   3000000   18000          200            200            0.0030747149  -1.4024194e-36  0              0.0092241447   2.6625189e-18  0              1.2856351e-13  1.1971759e-13  0              3.3190326    
Loop time of 777.128 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3335358.603 ns/day, 0.000 hours/ns, 3860.369 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 241.3      | 241.84     | 242.39     |   3.5 | 31.12
Neigh   | 11.49      | 11.491     | 11.491     |   0.0 |  1.48
Comm    | 34.781     | 34.991     | 35.2       |   3.5 |  4.50
Output  | 0.61258    | 0.6126     | 0.61263    |   0.0 |  0.08
Modify  | 426.93     | 427.23     | 427.53     |   1.5 | 54.98
Other   |            | 60.96      |            |       |  7.84

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.65                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.0144268439039
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.75
  ghost atom cutoff = 3.75
  binsize = 1.875, bins = 9600 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 243 | 243 | 243 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.23234383     8.9755009e-36  0              0.6970315      463745.1       0              2.2392591e+10  1.1971759e-13  0              3.3077364    
    200000   18000          200            200           -0.00027541234 -1.7950894e-35  0             -0.00082623701  115081.89      0              5.5568928e+09  1.1971759e-13  0              3.44618      
    300000   18000          200            200           -5.7606506e-05  3.5902013e-35  0             -0.00017281952  3003.6816      0              1.4503703e+08  1.1971759e-13  0              3.3694303    
    400000   18000          200            200            0.023245214    3.7697039e-34  0              0.069735643    5602.6776      0              2.7053325e+08  1.1971759e-13  0              3.3212683    
    500000   18000          200            200            5.2969206e-05  4.9402491e-41  0              0.00015890762  2203.0969      0              1.0637966e+08  1.1971759e-13  0              3.3255222    
    600000   18000          200            200            0.0016853036   1.7950985e-35  0              0.0050559109   511.88759      0              24717220       1.1971759e-13  0              3.3243468    
    700000   18000          200            200            0.0020237996   9.6913983e-42  0              0.0060713989   4.4756727      0              216114.21      1.1971759e-13  0              3.3242696    
    800000   18000          200            200            0.0034814977   1.7950977e-35  0              0.010444493    0.79832347     0              38548.183      1.1971759e-13  0              3.3239503    
    900000   18000          200            200            0.0029489987  -8.9754756e-36  0              0.008846996    0.34391968     0              16606.651      1.1971759e-13  0              3.3240606    
   1000000   18000          200            200            0.0031183461  -1.3463219e-35  0              0.0093550384   0.095486309    0              4610.6921      1.1971759e-13  0              3.3240247    
   1100000   18000          200            200            0.0030693003   1.7950972e-35  0              0.0092079009   0.019280329    0              930.97806      1.1971759e-13  0              3.3240351    
   1200000   18000          200            200            0.0030812372   2.2438719e-36  0              0.0092437117   0.0032036219   0              154.69144      1.1971759e-13  0              3.3240326    
   1300000   18000          200            200            0.0030793448   6.1946468e-44  0              0.0092380343   0.00045450621  0              21.946478      1.1971759e-13  0              3.324033     
   1400000   18000          200            200            0.0030790998  -5.6096775e-37  0              0.0092372995   5.5771666e-05  0              2.6930142      1.1971759e-13  0              3.324033     
   1500000   18000          200            200            0.0030795205  -4.7682259e-36  0              0.0092385616   5.8545704e-06  0              0.28269625     1.1971759e-13  0              3.3240329    
   1600000   18000          200            200            0.0030792585   1.4024194e-36  0              0.0092377755   5.0429766e-07  0              0.024350729    1.1971759e-13  0              3.324033     
   1700000   18000          200            200            0.0030793865   8.4145164e-37  0              0.0092381594   3.1847508e-08  0              0.0015378022   1.1971759e-13  0              3.324033     
   1800000   18000          200            200            0.0030793314   5.6096777e-37  0              0.0092379942   9.8686288e-10  0              4.7652077e-05  1.1971759e-13  0              3.324033     
   1900000   18000          200            200            0.0030793531   1.0339906e-44  0              0.0092380593   2.2567154e-12  0              1.0896871e-07  1.1971759e-13  0              3.324033     
   2000000   18000          200            200            0.0030793452   5.6096776e-37  0              0.0092380355   2.6866679e-11  0              1.2972958e-06  1.1971759e-13  0              3.324033     
   2100000   18000          200            200            0.0030793479  -2.8048387e-37  0              0.0092380436   1.1758521e-11  0              5.6777688e-07  1.1971759e-13  0              3.324033     
   2200000   18000          200            200            0.003079347    1.0241219e-44  0              0.009238041    2.9509211e-12  0              1.4248942e-07  1.1971759e-13  0              3.324033     
   2300000   18000          200            200            0.0030793472  -1.6829033e-36  0              0.0092380417   5.6226093e-13  0              2.7149568e-08  1.1971759e-13  0              3.324033     
   2400000   18000          200            200            0.0030793472  -5.6096774e-37  0              0.0092380416   8.9520974e-14  0              4.3226475e-09  1.1971759e-13  0              3.324033     
   2500000   18000          200            200            0.0030793472  -2.8048388e-36  0              0.0092380416   1.2206051e-14  0              5.8938651e-10  1.1971759e-13  0              3.324033     
   2600000   18000          200            200            0.0030793472  -2.8048387e-37  0              0.0092380416   1.4623586e-15  0              7.0612064e-11  1.1971759e-13  0              3.324033     
   2700000   18000          200            200            0.0030793472  -8.4145162e-37  0              0.0092380416   1.0637045e-16  0              5.1362485e-12  1.1971759e-13  0              3.324033     
   2800000   18000          200            200            0.0030793472  -5.6096774e-37  0              0.0092380416   1.4466155e-18  0              6.9851884e-14  1.1971759e-13  0              3.324033     
   2900000   18000          200            200            0.0030793472   2.8048389e-37  0              0.0092380416   1.026647e-17   0              4.957311e-13   1.1971759e-13  0              3.324033     
   3000000   18000          200            200            0.0030793472   2.8048389e-37  0              0.0092380416   7.5627352e-18  0              3.6517742e-13  1.1971759e-13  0              3.324033     
Loop time of 780.638 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3320362.229 ns/day, 0.000 hours/ns, 3843.012 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 244.49     | 245.74     | 246.98     |   8.0 | 31.48
Neigh   | 11.419     | 11.421     | 11.422     |   0.0 |  1.46
Comm    | 33.562     | 35.106     | 36.649     |  26.1 |  4.50
Output  | 0.60915    | 0.60917    | 0.60919    |   0.0 |  0.08
Modify  | 426.75     | 427.02     | 427.3      |   1.3 | 54.70
Other   |            | 60.74      |            |       |  7.78

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.66                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.4760818946735
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.76
  ghost atom cutoff = 3.76
  binsize = 1.88, bins = 9575 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 242.3 | 242.3 | 242.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.27872879     1.7950986e-35  0              0.83618637     90518.4        0              4.3708096e+09  1.1971759e-13  0              3.3104801    
    200000   18000          200            200           -0.0002725034   1.0902419e-40  0             -0.00081751019  110184.23      0              5.3204021e+09  1.1971759e-13  0              3.4532899    
    300000   18000          200            200           -5.0065693e-05 -3.5901831e-35  0             -0.00015019708  2230.6077      0              1.0770806e+08  1.1971759e-13  0              3.3747995    
    400000   18000          200            200            0.016288619    8.1806703e-41  0              0.048865858    14059.205      0              6.7886867e+08  1.1971759e-13  0              3.3270529    
    500000   18000          200            200            6.2757082e-05  1.7951013e-35  0              0.00018827125  3042.18        0              1.4689598e+08  1.1971759e-13  0              3.3300956    
    600000   18000          200            200            0.0010268698  -2.6926434e-35  0              0.0030806093   306.10858      0              14780888       1.1971759e-13  0              3.32953      
    700000   18000          200            200            0.0021917671  -2.6926442e-35  0              0.0065753013   28.799148      0              1390607.8      1.1971759e-13  0              3.3292316    
    800000   18000          200            200            0.0033963857  -1.7950959e-35  0              0.010189157    4.9694116      0              239955.1       1.1971759e-13  0              3.3289686    
    900000   18000          200            200            0.0030023044   8.9754925e-36  0              0.0090069131   1.0512759      0              50762.352      1.1971759e-13  0              3.3290507    
   1000000   18000          200            200            0.0030981569   1.3463233e-35  0              0.0092944707   0.18494289     0              8930.2303      1.1971759e-13  0              3.3290303    
   1100000   18000          200            200            0.0030848831  -2.2438707e-35  0              0.0092546494   0.02613858     0              1262.1385      1.1971759e-13  0              3.3290332    
   1200000   18000          200            200            0.0030814647   6.731614e-36   0              0.0092443941   0.0030260817   0              146.11866      1.1971759e-13  0              3.3290339    
   1300000   18000          200            200            0.0030855932   7.8535486e-36  0              0.0092567796   0.00027863578  0              13.454325      1.1971759e-13  0              3.329033     
   1400000   18000          200            200            0.0030831967  -8.4145163e-37  0              0.00924959     1.8312254e-05  0              0.8842332      1.1971759e-13  0              3.3290335    
   1500000   18000          200            200            0.0030843074  -2.8048387e-37  0              0.0092529222   5.7288909e-07  0              0.027662764    1.1971759e-13  0              3.3290333    
   1600000   18000          200            200            0.0030838563   2.8048389e-37  0              0.0092515688   1.6603522e-09  0              8.0172467e-05  1.1971759e-13  0              3.3290334    
   1700000   18000          200            200            0.0030840214  -2.8048387e-37  0              0.0092520643   1.6305857e-08  0              0.00078735149  1.1971759e-13  0              3.3290334    
   1800000   18000          200            200            0.0030839668  -8.4145162e-37  0              0.0092519005   6.8475618e-09  0              0.00033064425  1.1971759e-13  0              3.3290334    
   1900000   18000          200            200            0.0030839828   1.0375885e-44  0              0.0092519483   1.6240093e-09  0              7.8417598e-05  1.1971759e-13  0              3.3290334    
   2000000   18000          200            200            0.0030839789   1.0489653e-44  0              0.0092519368   2.8625705e-10  0              1.3822329e-05  1.1971759e-13  0              3.3290334    
   2100000   18000          200            200            0.0030839795  -1.4024194e-36  0              0.0092519384   4.061491e-11   0              1.9611486e-06  1.1971759e-13  0              3.3290334    
   2200000   18000          200            200            0.0030839796   1.4024194e-36  0              0.0092519388   4.7153116e-12  0              2.2768552e-07  1.1971759e-13  0              3.3290334    
   2300000   18000          200            200            0.0030839795   2.8048388e-36  0              0.0092519384   4.3684253e-13  0              2.1093562e-08  1.1971759e-13  0              3.3290334    
   2400000   18000          200            200            0.0030839795   5.6096777e-37  0              0.0092519386   2.9031114e-14  0              1.4018086e-09  1.1971759e-13  0              3.3290334    
   2500000   18000          200            200            0.0030839795   9.5364518e-36  0              0.0092519385   9.8290413e-16  0              4.7460923e-11  1.1971759e-13  0              3.3290334    
   2600000   18000          200            200            0.0030839795   2.8048389e-37  0              0.0092519386   2.2699097e-18  0              1.0960582e-13  1.1971759e-13  0              3.3290334    
   2700000   18000          200            200            0.0030839795   2.8048389e-37  0              0.0092519385   3.1265694e-17  0              1.5097085e-12  1.1971759e-13  0              3.3290334    
   2800000   18000          200            200            0.0030839795  -1.1219355e-36  0              0.0092519385   2.5434736e-17  0              1.2281524e-12  1.1971759e-13  0              3.3290334    
   2900000   18000          200            200            0.0030839795   9.3547571e-45  0              0.0092519385   1.2485115e-17  0              6.0286153e-13  1.1971759e-13  0              3.3290334    
   3000000   18000          200            200            0.0030839795   1.1598243e-44  0              0.0092519385   6.8626479e-18  0              3.3137271e-13  1.1971759e-13  0              3.3290334    
Loop time of 781.204 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3317956.062 ns/day, 0.000 hours/ns, 3840.227 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.38     | 244.14     | 248.89     |  30.4 | 31.25
Neigh   | 11.522     | 11.524     | 11.525     |   0.0 |  1.48
Comm    | 32.655     | 37.642     | 42.629     |  81.3 |  4.82
Output  | 0.61185    | 0.61187    | 0.61189    |   0.0 |  0.08
Modify  | 425.99     | 426.12     | 426.24     |   0.6 | 54.55
Other   |            | 61.17      |            |       |  7.83

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.67                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.9402665558481
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.77
  ghost atom cutoff = 3.77
  binsize = 1.885, bins = 9550 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 241.7 | 241.7 | 241.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.28740025    -7.1803858e-35  0              0.86220076     14758.581      0              7.1263905e+08  1.1971759e-13  0              3.3150776    
    200000   18000          200            200           -0.00026946046  1.7951062e-35  0             -0.00080838139  105397.05      0              5.0892465e+09  1.1971759e-13  0              3.4603551    
    300000   18000          200            200           -4.2399017e-05 -2.1541153e-34  0             -0.00012719705  1572.9378      0              75951539       1.1971759e-13  0              3.3801129    
    400000   18000          200            200            0.0083063817   5.3852975e-35  0              0.024919145    20261.227      0              9.7834212e+08  1.1971759e-13  0              3.3331102    
    500000   18000          200            200            0.00089278474 -1.795092e-35   0              0.0026783542   3927.4497      0              1.8964249e+08  1.1971759e-13  0              3.3346008    
    600000   18000          200            200            0.00063474754 -7.1803854e-35  0              0.0019042426   117.05517      0              5652175.2      1.1971759e-13  0              3.3346594    
    700000   18000          200            200            0.0024941855   8.9754948e-36  0              0.0074825566   61.641216      0              2976433.7      1.1971759e-13  0              3.3341641    
    800000   18000          200            200            0.0032496591   8.3802656e-42  0              0.0097489773   9.6934156      0              468060.35      1.1971759e-13  0              3.3339997    
    900000   18000          200            200            0.0030751759   3.5901945e-35  0              0.0092255276   1.4949309      0              72184.863      1.1971759e-13  0              3.3340368    
   1000000   18000          200            200            0.0030740369   8.9754906e-36  0              0.0092221106   0.18453813     0              8910.6859      1.1971759e-13  0              3.3340367    
   1100000   18000          200            200            0.0031001793   3.5622053e-42  0              0.0093005379   0.017184818    0              829.79335      1.1971759e-13  0              3.3340314    
   1200000   18000          200            200            0.0030826566   9.0496594e-43  0              0.0092479698   0.001051277    0              50.762404      1.1971759e-13  0              3.334035     
   1300000   18000          200            200            0.0030911342   1.1219356e-36  0              0.0092734025   2.2873033e-05  0              1.1044569      1.1971759e-13  0              3.3340332    
   1400000   18000          200            200            0.0030876828   4.2072582e-37  0              0.0092630483   1.0389261e-06  0              0.050166025    1.1971759e-13  0              3.334034     
   1500000   18000          200            200            0.0030889109  -1.4024194e-36  0              0.0092667328   1.7458858e-06  0              0.084302577    1.1971759e-13  0              3.3340337    
   1600000   18000          200            200            0.003088531   -2.8048388e-36  0              0.0092655929   5.8237328e-07  0              0.028120721    1.1971759e-13  0              3.3340338    
   1700000   18000          200            200            0.0030886274   2.8048389e-37  0              0.0092658822   1.1859571e-07  0              0.0057265624   1.1971759e-13  0              3.3340338    
   1800000   18000          200            200            0.0030886119  -1.4024194e-36  0              0.0092658357   1.7809597e-08  0              0.0008599617   1.1971759e-13  0              3.3340338    
   1900000   18000          200            200            0.0030886097   1.0130101e-44  0              0.0092658292   2.0534135e-09  0              9.915199e-05   1.1971759e-13  0              3.3340338    
   2000000   18000          200            200            0.0030886132   1.9633872e-36  0              0.0092658397   1.7458303e-10  0              8.4299899e-06  1.1971759e-13  0              3.3340338    
   2100000   18000          200            200            0.0030886111  -2.9170323e-35  0              0.0092658334   9.0608306e-12  0              4.3751508e-07  1.1971759e-13  0              3.3340338    
   2200000   18000          200            200            0.0030886121   8.4145164e-37  0              0.0092658363   9.4160208e-14  0              4.5466595e-09  1.1971759e-13  0              3.3340338    
   2300000   18000          200            200            0.0030886117   2.8048388e-36  0              0.0092658352   3.5261638e-14  0              1.7026583e-09  1.1971759e-13  0              3.3340338    
   2400000   18000          200            200            0.0030886119   2.8048389e-37  0              0.0092658356   2.7960401e-14  0              1.3501077e-09  1.1971759e-13  0              3.3340338    
   2500000   18000          200            200            0.0030886118  -1.4024194e-36  0              0.0092658355   7.887563e-15   0              3.8086219e-10  1.1971759e-13  0              3.3340338    
   2600000   18000          200            200            0.0030886118   1.6829033e-36  0              0.0092658355   1.4635838e-15  0              7.0671222e-11  1.1971759e-13  0              3.3340338    
   2700000   18000          200            200            0.0030886118  -5.6096774e-37  0              0.0092658355   1.9206246e-16  0              9.274009e-12   1.1971759e-13  0              3.3340338    
   2800000   18000          200            200            0.0030886118   1.1219355e-36  0              0.0092658355   2.839974e-18   0              1.3713218e-13  1.1971759e-13  0              3.3340338    
   2900000   18000          200            200            0.0030886118   1.1219355e-36  0              0.0092658355   9.5293273e-18  0              4.6013711e-13  1.1971759e-13  0              3.3340338    
   3000000   18000          200            200            0.0030886118  -2.8048386e-37  0              0.0092658355   5.2647852e-18  0              2.5421763e-13  1.1971759e-13  0              3.3340338    
Loop time of 781.548 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3316494.699 ns/day, 0.000 hours/ns, 3838.536 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.28     | 242.96     | 245.65     |  17.2 | 31.09
Neigh   | 11.585     | 11.586     | 11.587     |   0.0 |  1.48
Comm    | 33.046     | 35.955     | 38.864     |  48.5 |  4.60
Output  | 0.60947    | 0.60951    | 0.60954    |   0.0 |  0.08
Modify  | 428.97     | 430.76     | 432.55     |   8.6 | 55.12
Other   |            | 59.67      |            |       |  7.64

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.68                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.4069877389307
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.78
  ghost atom cutoff = 3.78
  binsize = 1.89, bins = 9524 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 237 | 237 | 237 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.25574438     8.9754871e-35  0              0.76723315     276462.72      0              1.3349395e+10  1.1971759e-13  0              3.321589     
    200000   18000          200            200           -0.00026628456  5.3249774e-41  0             -0.00079885368  100720.6       0              4.8634371e+09  1.1971759e-13  0              3.4673754    
    300000   18000          200            200           -3.4609059e-05  7.180392e-35   0             -0.00010382718  1030.4419      0              49756351       1.1971759e-13  0              3.3853703    
    400000   18000          200            200            0.0018512944  -2.1541156e-34  0              0.0055538832   21563.732      0              1.0412355e+09  1.1971759e-13  0              3.3392794    
    500000   18000          200            200            0.0030580743  -1.7950925e-35  0              0.009174223    4347.9666      0              2.0994775e+08  1.1971759e-13  0              3.3390576    
    600000   18000          200            200            0.00046831699 -1.7950949e-35  0              0.001404951    11.046467      0              533394.36      1.1971759e-13  0              3.3397242    
    700000   18000          200            200            0.0029006962  -8.9754728e-36  0              0.0087020887   84.127282      0              4062205.4      1.1971759e-13  0              3.3390768    
    800000   18000          200            200            0.0030735787   8.8166084e-42  0              0.0092207362   11.408867      0              550893.34      1.1971759e-13  0              3.3390375    
    900000   18000          200            200            0.0031517727  -8.9754754e-36  0              0.0094553181   1.2791753      0              61766.796      1.1971759e-13  0              3.3390223    
   1000000   18000          200            200            0.0030540857  -8.9754774e-36  0              0.0091622571   0.095204442    0              4597.0818      1.1971759e-13  0              3.3390422    
   1100000   18000          200            200            0.0031116617  -1.3463223e-35  0              0.009334985    0.0032937431   0              159.04307      1.1971759e-13  0              3.3390303    
   1200000   18000          200            200            0.0030861228  -6.7316121e-36  0              0.0092583683   5.9089793e-06  0              0.28532346     1.1971759e-13  0              3.3390356    
   1300000   18000          200            200            0.0030955719  -1.6829032e-36  0              0.0092867158   8.4055329e-05  0              4.058731       1.1971759e-13  0              3.3390337    
   1400000   18000          200            200            0.0030926293   4.2072582e-37  0              0.009277888    3.3550029e-05  0              1.6200108      1.1971759e-13  0              3.3390343    
   1500000   18000          200            200            0.0030933478   9.0918447e-45  0              0.0092800434   7.0536733e-06  0              0.34059664     1.1971759e-13  0              3.3390341    
   1600000   18000          200            200            0.0030932559   5.6096777e-37  0              0.0092797677   1.0174716e-06  0              0.049130063    1.1971759e-13  0              3.3390341    
   1700000   18000          200            200            0.0030932227  -4.487742e-36   0              0.009279668    1.0440812e-07  0              0.0050414942   1.1971759e-13  0              3.3390342    
   1800000   18000          200            200            0.0030932569  -1.0377903e-35  0              0.0092797707   6.8445586e-09  0              0.00033049924  1.1971759e-13  0              3.3390341    
   1900000   18000          200            200            0.0030932384   1.0427202e-44  0              0.0092797153   1.6002115e-10  0              7.7268488e-06  1.1971759e-13  0              3.3390342    
   2000000   18000          200            200            0.0030932463   2.8048389e-37  0              0.0092797388   6.0051789e-12  0              2.899686e-07   1.1971759e-13  0              3.3390341    
   2100000   18000          200            200            0.0030932435  -5.6096774e-37  0              0.0092797304   1.088338e-11   0              5.2551947e-07  1.1971759e-13  0              3.3390342    
   2200000   18000          200            200            0.0030932443   1.0411551e-44  0              0.0092797329   3.5203045e-12  0              1.6998291e-07  1.1971759e-13  0              3.3390342    
   2300000   18000          200            200            0.0030932441   1.4024194e-36  0              0.0092797323   6.6888531e-13  0              3.2298078e-08  1.1971759e-13  0              3.3390342    
   2400000   18000          200            200            0.0030932441   1.0313327e-44  0              0.0092797324   8.8971596e-14  0              4.29612e-09    1.1971759e-13  0              3.3390342    
   2500000   18000          200            200            0.0030932441  -5.6096774e-37  0              0.0092797324   8.3322197e-15  0              4.0233307e-10  1.1971759e-13  0              3.3390342    
   2600000   18000          200            200            0.0030932441   5.6096777e-37  0              0.0092797324   5.2198825e-16  0              2.5204944e-11  1.1971759e-13  0              3.3390342    
   2700000   18000          200            200            0.0030932441   8.4145164e-37  0              0.0092797324   1.5039924e-19  0              7.2622412e-15  1.1971759e-13  0              3.3390342    
   2800000   18000          200            200            0.0030932441   2.8048389e-37  0              0.0092797324   2.2928498e-17  0              1.1071351e-12  1.1971759e-13  0              3.3390342    
   2900000   18000          200            200            0.0030932441   1.4206874e-44  0              0.0092797324   1.3466114e-17  0              6.5023045e-13  1.1971759e-13  0              3.3390342    
   3000000   18000          200            200            0.0030932441  -5.6096774e-37  0              0.0092797324   4.7122917e-18  0              2.275397e-13   1.1971759e-13  0              3.3390342    
Loop time of 777.553 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3333535.854 ns/day, 0.000 hours/ns, 3858.259 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.99     | 243.1      | 245.2      |  13.5 | 31.26
Neigh   | 11.367     | 11.367     | 11.368     |   0.0 |  1.46
Comm    | 33.159     | 35.485     | 37.811     |  39.0 |  4.56
Output  | 0.60899    | 0.60901    | 0.60904    |   0.0 |  0.08
Modify  | 427.61     | 427.88     | 428.14     |   1.3 | 55.03
Other   |            | 59.12      |            |       |  7.60

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.69                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.8762523554259
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.79
  ghost atom cutoff = 3.79
  binsize = 1.895, bins = 9499 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 236.5 | 236.5 | 236.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.19233932    -2.333625e-34   0              0.57701795     733769.08      0              3.5431083e+10  1.1971759e-13  0              3.3298031    
    200000   18000          200            200           -0.00026297577  1.795104e-35   0             -0.00078892732  96153.928      0              4.6429291e+09  1.1971759e-13  0              3.4743509    
    300000   18000          200            200           -2.6694545e-05  1.7951025e-35  0             -8.0083635e-05  602.60234      0              29097510       1.1971759e-13  0              3.3905716    
    400000   18000          200            200           -0.00013464898 -5.385285e-35   0             -0.00040394693  19510.662      0              9.4210004e+08  1.1971759e-13  0              3.3454319    
    500000   18000          200            200            0.0059868854  -7.1803823e-35  0              0.017960656    3867.2468      0              1.8673551e+08  1.1971759e-13  0              3.3435141    
    600000   18000          200            200            0.00048940284  2.062692e-41   0              0.0014682085   19.308631      0              932344.67      1.1971759e-13  0              3.3447197    
    700000   18000          200            200            0.0033584047   2.6926463e-35  0              0.010075214    82.247296      0              3971427.6      1.1971759e-13  0              3.3439832    
    800000   18000          200            200            0.0029044876  -8.9754749e-36  0              0.0087134629   8.8949784      0              429506.67      1.1971759e-13  0              3.3440745    
    900000   18000          200            200            0.0032149296  -8.9754756e-36  0              0.0096447887   0.59417065     0              28690.374      1.1971759e-13  0              3.3440105    
   1000000   18000          200            200            0.0030451412  -1.3463219e-35  0              0.0091354236   0.010314059    0              498.02897      1.1971759e-13  0              3.3440455    
   1100000   18000          200            200            0.0031170655  -8.9754806e-36  0              0.0093511966   0.0012235125   0              59.07904       1.1971759e-13  0              3.3440306    
   1200000   18000          200            200            0.0030923021  -4.4877411e-36  0              0.0092769064   0.0013131012   0              63.404955      1.1971759e-13  0              3.3440357    
   1300000   18000          200            200            0.0030989942   1.6829033e-36  0              0.0092969825   0.00036379414  0              17.566317      1.1971759e-13  0              3.3440343    
   1400000   18000          200            200            0.0030978798   1.4024194e-37  0              0.0092936393   5.9101359e-05  0              2.8537931      1.1971759e-13  0              3.3440345    
   1500000   18000          200            200            0.0030977272  -8.4145162e-37  0              0.0092931816   6.307665e-06   0              0.30457457     1.1971759e-13  0              3.3440346    
   1600000   18000          200            200            0.0030979735  -1.4024194e-36  0              0.0092939204   3.9542969e-07  0              0.019093884    1.1971759e-13  0              3.3440345    
   1700000   18000          200            200            0.0030978327   1.0365833e-44  0              0.0092934981   6.4422029e-09  0              0.00031107092  1.1971759e-13  0              3.3440346    
   1800000   18000          200            200            0.0030978922  -5.6096774e-37  0              0.0092936767   9.18584e-10    0              4.4355134e-05  1.1971759e-13  0              3.3440345    
   1900000   18000          200            200            0.0030978719   1.0363317e-44  0              0.0092936156   9.2134822e-10  0              4.4488608e-05  1.1971759e-13  0              3.3440345    
   2000000   18000          200            200            0.0030978773   2.243871e-36   0              0.009293632    2.5077906e-10  0              1.2109223e-05  1.1971759e-13  0              3.3440345    
   2100000   18000          200            200            0.0030978765  -2.8048387e-37  0              0.0092936294   4.0315417e-11  0              1.9466872e-06  1.1971759e-13  0              3.3440345    
   2200000   18000          200            200            0.0030978763   2.243871e-36   0              0.009293629    4.2534392e-12  0              2.0538336e-07  1.1971759e-13  0              3.3440345    
   2300000   18000          200            200            0.0030978765  -2.8048387e-37  0              0.0092936296   2.6246499e-13  0              1.2673495e-08  1.1971759e-13  0              3.3440345    
   2400000   18000          200            200            0.0030978764  -6.4511292e-36  0              0.0092936292   3.8678669e-15  0              1.8676545e-10  1.1971759e-13  0              3.3440345    
   2500000   18000          200            200            0.0030978765   1.0118387e-44  0              0.0092936294   7.2328651e-16  0              3.4924917e-11  1.1971759e-13  0              3.3440345    
   2600000   18000          200            200            0.0030978764  -8.4145162e-37  0              0.0092936293   5.52533e-16    0              2.6679841e-11  1.1971759e-13  0              3.3440345    
   2700000   18000          200            200            0.0030978764  -1.1219355e-36  0              0.0092936293   1.7815515e-16  0              8.6024744e-12  1.1971759e-13  0              3.3440345    
   2800000   18000          200            200            0.0030978764   1.9633872e-36  0              0.0092936293   1.6575615e-17  0              8.0037711e-13  1.1971759e-13  0              3.3440345    
   2900000   18000          200            200            0.0030978764   2.8048389e-37  0              0.0092936293   7.11889e-19    0              3.4374572e-14  1.1971759e-13  0              3.3440345    
   3000000   18000          200            200            0.0030978764   1.2563667e-44  0              0.0092936293   1.2855888e-17  0              6.2076483e-13  1.1971759e-13  0              3.3440345    
Loop time of 777.64 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3333161.721 ns/day, 0.000 hours/ns, 3857.826 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.25     | 241.61     | 242.97     |   8.7 | 31.07
Neigh   | 11.85      | 11.85      | 11.851     |   0.0 |  1.52
Comm    | 35.058     | 36.012     | 36.965     |  15.9 |  4.63
Output  | 0.61186    | 0.61188    | 0.6119     |   0.0 |  0.08
Modify  | 426.42     | 426.43     | 426.44     |   0.1 | 54.84
Other   |            | 61.13      |            |       |  7.86

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.7                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.3480673168373
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.8
  ghost atom cutoff = 3.8
  binsize = 1.9, bins = 9474 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 235.9 | 235.9 | 235.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.11413814     1.7951011e-35  0              0.34241442     1163224.7      0              5.6167959e+10  1.1971759e-13  0              3.3392947    
    200000   18000          200            200           -0.0002595352   8.6130231e-41  0             -0.00077860561  91697.34       0              4.4277364e+09  1.1971759e-13  0              3.4812814    
    300000   18000          200            200           -1.8657834e-05 -1.7950915e-35  0             -5.5973503e-05  289.14137      0              13961602       1.1971759e-13  0              3.3957167    
    400000   18000          200            200           -0.0001278157   7.5258884e-41  0             -0.00038344711  17227.843      0              8.3187091e+08  1.1971759e-13  0              3.3515202    
    500000   18000          200            200            0.0090626979   5.3852951e-35  0              0.027188094    2512.2888      0              1.2130943e+08  1.1971759e-13  0              3.348036     
    600000   18000          200            200            0.00070191467 -1.0770579e-34  0              0.002105744    138.9737       0              6710542.7      1.1971759e-13  0              3.3496462    
    700000   18000          200            200            0.0037936023  -1.2565677e-34  0              0.011380807    56.128366      0              2710237.9      1.1971759e-13  0              3.3488981    
    800000   18000          200            200            0.002775063    3.5901945e-35  0              0.0083251889   4.0659145      0              196328.46      1.1971759e-13  0              3.3491036    
    900000   18000          200            200            0.0032502977  -4.4877336e-36  0              0.0097508932   0.051753443    0              2498.9886      1.1971759e-13  0              3.3490046    
   1000000   18000          200            200            0.0030509502  -1.3463219e-35  0              0.0091528507   0.017720709    0              855.66961      1.1971759e-13  0              3.3490457    
   1100000   18000          200            200            0.003116142   -1.3463223e-35  0              0.0093484259   0.013342348    0              644.25425      1.1971759e-13  0              3.3490321    
   1200000   18000          200            200            0.003100602   -6.7316121e-36  0              0.0093018061   0.0031535824   0              152.27521      1.1971759e-13  0              3.3490353    
   1300000   18000          200            200            0.0031019306  -2.8048387e-36  0              0.0093057919   0.0004264451   0              20.591508      1.1971759e-13  0              3.349035     
   1400000   18000          200            200            0.0031031282   1.4024194e-37  0              0.0093093845   3.3525667e-05  0              1.6188345      1.1971759e-13  0              3.3490348    
   1500000   18000          200            200            0.0031021895   9.0899477e-45  0              0.0093065685   9.5662808e-07  0              0.046192146    1.1971759e-13  0              3.349035     
   1600000   18000          200            200            0.003102631    2.8048389e-37  0              0.009307893    1.8920954e-08  0              0.00091362515  1.1971759e-13  0              3.3490349    
   1700000   18000          200            200            0.0031024727   2.8048389e-37  0              0.0093074182   4.685065e-08   0              0.0022622502   1.1971759e-13  0              3.3490349    
   1800000   18000          200            200            0.0031025156  -2.8048388e-36  0              0.0093075469   1.4407283e-08  0              0.00069567615  1.1971759e-13  0              3.3490349    
   1900000   18000          200            200            0.0031025091   1.053529e-44   0              0.0093075273   2.3155669e-09  0              0.00011181044  1.1971759e-13  0              3.3490349    
   2000000   18000          200            200            0.0031025076   5.6096777e-37  0              0.0093075229   2.2254962e-10  0              1.0746125e-05  1.1971759e-13  0              3.3490349    
   2100000   18000          200            200            0.0031025094   1.1219355e-36  0              0.0093075283   1.0165137e-11  0              4.9083809e-07  1.1971759e-13  0              3.3490349    
   2200000   18000          200            200            0.0031025085  -2.243871e-36   0              0.0093075254   5.218001e-15   0              2.5195859e-10  1.1971759e-13  0              3.3490349    
   2300000   18000          200            200            0.0031025088   8.4145164e-37  0              0.0093075265   1.3969924e-13  0              6.7455765e-09  1.1971759e-13  0              3.3490349    
   2400000   18000          200            200            0.0031025087   5.3291937e-36  0              0.0093075262   6.1340908e-14  0              2.9619329e-09  1.1971759e-13  0              3.3490349    
   2500000   18000          200            200            0.0031025088  -3.3658065e-36  0              0.0093075263   1.1788222e-14  0              5.6921104e-10  1.1971759e-13  0              3.3490349    
   2600000   18000          200            200            0.0031025088   1.042332e-44   0              0.0093075263   1.4091148e-15  0              6.8041112e-11  1.1971759e-13  0              3.3490349    
   2700000   18000          200            200            0.0031025087   3.3658065e-36  0              0.0093075262   3.9588753e-17  0              1.9115992e-12  1.1971759e-13  0              3.3490349    
   2800000   18000          200            200            0.0031025088   5.6096777e-37  0              0.0093075263   1.2909935e-17  0              6.2337457e-13  1.1971759e-13  0              3.3490349    
   2900000   18000          200            200            0.0031025087   1.032629e-44   0              0.0093075262   3.2248189e-18  0              1.5571496e-13  1.1971759e-13  0              3.3490349    
   3000000   18000          200            200            0.0031025087  -1.4024194e-36  0              0.0093075262   7.9291174e-18  0              3.828687e-13   1.1971759e-13  0              3.3490349    
Loop time of 781.618 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3316196.711 ns/day, 0.000 hours/ns, 3838.191 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 246.6      | 246.64     | 246.68     |   0.3 | 31.56
Neigh   | 11.975     | 11.976     | 11.976     |   0.0 |  1.53
Comm    | 35.94      | 36.271     | 36.602     |   5.5 |  4.64
Output  | 0.62902    | 0.62903    | 0.62903    |   0.0 |  0.08
Modify  | 426.72     | 426.98     | 427.25     |   1.3 | 54.63
Other   |            | 59.12      |            |       |  7.56

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.71                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.8224395346687
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.81
  ghost atom cutoff = 3.81
  binsize = 1.905, bins = 9449 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 231.3 | 231.3 | 231.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.041748062    3.9492146e-34  0              0.12524419     1404707.4      0              6.7828292e+10  1.1971759e-13  0              3.3495396    
    200000   18000          200            200           -0.00025596342 -5.3852811e-35  0             -0.00076789026  87350.474      0              4.2178418e+09  1.1971759e-13  0              3.4881667    
    300000   18000          200            200           -1.0499107e-05  1.2565685e-34  0             -3.149732e-05   89.652475      0              4328997.2      1.1971759e-13  0              3.4008054    
    400000   18000          200            200           -0.00012082394  6.065526e-41   0             -0.00036247183  15089.594      0              7.2862251e+08  1.1971759e-13  0              3.3575424    
    500000   18000          200            200            0.011524506    8.9754886e-35  0              0.034573517    921.67059      0              44504174       1.1971759e-13  0              3.3526926    
    600000   18000          200            200            0.0011487371  -2.692643e-35   0              0.0034462113   332.81354      0              16070375       1.1971759e-13  0              3.354509     
    700000   18000          200            200            0.0041249896  -4.0389677e-34  0              0.012374969    21.622577      0              1044076.9      1.1971759e-13  0              3.3538357    
    800000   18000          200            200            0.0027087765   1.0770582e-34  0              0.0081263296   0.45096028     0              21775.258      1.1971759e-13  0              3.3541195    
    900000   18000          200            200            0.0032502174  -8.9754759e-36  0              0.0097506522   0.13602934     0              6568.3701      1.1971759e-13  0              3.3540058    
   1000000   18000          200            200            0.0030711805   1.3463233e-35  0              0.0092135415   0.10883443     0              5255.225       1.1971759e-13  0              3.3540429    
   1100000   18000          200            200            0.0031107368  -4.4877387e-36  0              0.0093322105   0.024901589    0              1202.4086      1.1971759e-13  0              3.3540345    
   1200000   18000          200            200            0.003109627    8.9754851e-36  0              0.0093288809   0.0029929635   0              144.51949      1.1971759e-13  0              3.3540348    
   1300000   18000          200            200            0.0031051192  -4.487742e-36   0              0.0093153575   0.00017600014  0              8.4984168      1.1971759e-13  0              3.3540357    
   1400000   18000          200            200            0.0031080715   2.0534446e-45  0              0.0093242144   1.1143133e-06  0              0.053806201    1.1971759e-13  0              3.3540351    
   1500000   18000          200            200            0.0031068284   5.6096776e-37  0              0.0093204851   1.1855889e-06  0              0.057247843    1.1971759e-13  0              3.3540354    
   1600000   18000          200            200            0.0031072131   2.8048388e-36  0              0.0093216394   6.6603562e-07  0              0.032160476    1.1971759e-13  0              3.3540353    
   1700000   18000          200            200            0.0031071374  -1.6829033e-36  0              0.0093214121   1.3275318e-07  0              0.0064101758   1.1971759e-13  0              3.3540353    
   1800000   18000          200            200            0.0031071339  -1.1219355e-36  0              0.0093214016   1.4221814e-08  0              0.00068672052  1.1971759e-13  0              3.3540353    
   1900000   18000          200            200            0.003107146   -1.4024194e-36  0              0.009321438    6.8863189e-10  0              3.3251569e-05  1.1971759e-13  0              3.3540353    
   2000000   18000          200            200            0.0031071389  -1.1219355e-36  0              0.0093214168   4.0221847e-13  0              1.942169e-08   1.1971759e-13  0              3.3540353    
   2100000   18000          200            200            0.0031071417   1.4024194e-36  0              0.0093214252   9.3500316e-12  0              4.5147957e-07  1.1971759e-13  0              3.3540353    
   2200000   18000          200            200            0.0031071409   1.0450753e-44  0              0.0093214227   3.9439919e-12  0              1.9044125e-07  1.1971759e-13  0              3.3540353    
   2300000   18000          200            200            0.0031071411  -1.9633871e-36  0              0.0093214232   6.9365166e-13  0              3.3493956e-08  1.1971759e-13  0              3.3540353    
   2400000   18000          200            200            0.0031071411   1.1219355e-36  0              0.0093214232   6.6225099e-14  0              3.197773e-09   1.1971759e-13  0              3.3540353    
   2500000   18000          200            200            0.003107141    5.6096777e-37  0              0.0093214231   2.6058899e-15  0              1.258291e-10   1.1971759e-13  0              3.3540353    
   2600000   18000          200            200            0.0031071411   2.8048389e-37  0              0.0093214232   3.4566519e-19  0              1.6690935e-14  1.1971759e-13  0              3.3540353    
   2700000   18000          200            200            0.0031071411   5.6096777e-37  0              0.0093214232   1.0073745e-16  0              4.8642507e-12  1.1971759e-13  0              3.3540353    
   2800000   18000          200            200            0.0031071411   8.4145164e-37  0              0.0093214232   1.1244509e-17  0              5.4295709e-13  1.1971759e-13  0              3.3540353    
   2900000   18000          200            200            0.0031071411   2.8048389e-37  0              0.0093214232   1.0865927e-18  0              5.2467674e-14  1.1971759e-13  0              3.3540353    
   3000000   18000          200            200            0.0031071411  -5.6096774e-37  0              0.0093214232   3.0095617e-18  0              1.4532096e-13  1.1971759e-13  0              3.3540353    
Loop time of 775.943 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3340451.428 ns/day, 0.000 hours/ns, 3866.263 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 238.43     | 240.96     | 243.49     |  16.3 | 31.05
Neigh   | 11.865     | 11.866     | 11.867     |   0.0 |  1.53
Comm    | 33.926     | 36.748     | 39.569     |  46.5 |  4.74
Output  | 0.74323    | 0.74325    | 0.74328    |   0.0 |  0.10
Modify  | 426.82     | 426.85     | 426.88     |   0.2 | 55.01
Other   |            | 58.77      |            |       |  7.57

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.72                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.299375920424
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.82
  ghost atom cutoff = 3.82
  binsize = 1.91, bins = 9425 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 230.8 | 230.8 | 230.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            1.9118708e-05 -1.7950865e-35  0              5.7356125e-05  1446416.8      0              6.9842292e+10  1.1971759e-13  0              3.3600558    
    200000   18000          200            200           -0.000252261    1.795106e-35   0             -0.00075678301  83112.978      0              4.0132283e+09  1.1971759e-13  0              3.4950068    
    300000   18000          200            200           -2.2200161e-06 -1.7950917e-35  0             -6.6600482e-06  3.7704203      0              182060.1       1.1971759e-13  0              3.4058378    
    400000   18000          200            200           -0.0001136754  -5.385284e-35   0             -0.0003410262   13095.542      0              6.3233688e+08  1.1971759e-13  0              3.3634984    
    500000   18000          200            200            0.012684937   -1.0770576e-34  0              0.03805481     30.754335      0              1485016.8      1.1971759e-13  0              3.3575394    
    600000   18000          200            200            0.0018687775  -6.2828368e-35  0              0.0056063326   529.32552      0              25559235       1.1971759e-13  0              3.35932      
    700000   18000          200            200            0.0042841682  -1.7950957e-35  0              0.012852505    1.0086748      0              48705.298      1.1971759e-13  0              3.3588068    
    800000   18000          200            200            0.0027174683   4.487743e-35   0              0.0081524048   0.63364419     0              30596.41       1.1971759e-13  0              3.3591192    
    900000   18000          200            200            0.003215841    8.975492e-36   0              0.0096475229   0.76572519     0              36974.129      1.1971759e-13  0              3.3590141    
   1000000   18000          200            200            0.0031015208   1.3463233e-35  0              0.0093045624   0.1882692      0              9090.8458      1.1971759e-13  0              3.3590379    
   1100000   18000          200            200            0.0031041627  -1.7950965e-35  0              0.0093124882   0.021962831    0              1060.5065      1.1971759e-13  0              3.3590372    
   1200000   18000          200            200            0.0031177091  -6.7316121e-36  0              0.0093531274   0.0010590169   0              51.136138      1.1971759e-13  0              3.3590345    
   1300000   18000          200            200            0.0031091849   1.6829033e-36  0              0.0093275546   2.8881435e-08  0              0.0013945811   1.1971759e-13  0              3.3590362    
   1400000   18000          200            200            0.0031125578  -4.2072581e-37  0              0.0093376734   1.7451818e-05  0              0.84268583     1.1971759e-13  0              3.3590355    
   1500000   18000          200            200            0.0031116396  -2.8048387e-37  0              0.0093349189   6.4928302e-06  0              0.31351553     1.1971759e-13  0              3.3590357    
   1600000   18000          200            200            0.003111751    8.4145164e-37  0              0.009335253    9.8225435e-07  0              0.047429547    1.1971759e-13  0              3.3590357    
   1700000   18000          200            200            0.0031118045   1.0520641e-44  0              0.0093354134   6.9705931e-08  0              0.0033658499   1.1971759e-13  0              3.3590357    
   1800000   18000          200            200            0.0031117575   2.8048389e-37  0              0.0093352725   8.5563279e-10  0              4.1315445e-05  1.1971759e-13  0              3.3590357    
   1900000   18000          200            200            0.0031117789  -2.243871e-36   0              0.0093353366   2.9059352e-10  0              1.4031721e-05  1.1971759e-13  0              3.3590357    
   2000000   18000          200            200            0.0031117721   5.6096777e-37  0              0.0093353164   2.0033128e-10  0              9.6732805e-06  1.1971759e-13  0              3.3590357    
   2100000   18000          200            200            0.0031117734   2.8048389e-37  0              0.0093353201   3.9892605e-11  0              1.9262711e-06  1.1971759e-13  0              3.3590357    
   2200000   18000          200            200            0.0031117735   1.6829033e-36  0              0.0093353205   3.8317545e-12  0              1.8502171e-07  1.1971759e-13  0              3.3590357    
   2300000   18000          200            200            0.0031117733   5.6096776e-37  0              0.0093353198   1.2407082e-13  0              5.9909356e-09  1.1971759e-13  0              3.3590357    
   2400000   18000          200            200            0.0031117734   2.5243549e-36  0              0.0093353202   2.0884756e-15  0              1.0084501e-10  1.1971759e-13  0              3.3590357    
   2500000   18000          200            200            0.0031117733   2.8048389e-37  0              0.00933532     5.5171129e-15  0              2.6640164e-10  1.1971759e-13  0              3.3590357    
   2600000   18000          200            200            0.0031117734   1.0139055e-44  0              0.0093353201   1.4535811e-15  0              7.0188227e-11  1.1971759e-13  0              3.3590357    
   2700000   18000          200            200            0.0031117734   1.4024194e-36  0              0.0093353201   1.3289602e-16  0              6.4170733e-12  1.1971759e-13  0              3.3590357    
   2800000   18000          200            200            0.0031117734  -2.8048387e-37  0              0.0093353201   7.9239509e-18  0              3.8261923e-13  1.1971759e-13  0              3.3590357    
   2900000   18000          200            200            0.0031117734   9.2015545e-45  0              0.0093353201   6.6241192e-18  0              3.1985501e-13  1.1971759e-13  0              3.3590357    
   3000000   18000          200            200            0.0031117734   1.0339254e-44  0              0.0093353201   1.5277625e-17  0              7.3770185e-13  1.1971759e-13  0              3.3590357    
Loop time of 776.491 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3338095.291 ns/day, 0.000 hours/ns, 3863.536 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.75     | 242.6      | 245.44     |  18.3 | 31.24
Neigh   | 10.991     | 10.991     | 10.991     |   0.0 |  1.42
Comm    | 32.085     | 35.2       | 38.315     |  52.5 |  4.53
Output  | 0.61124    | 0.61125    | 0.61127    |   0.0 |  0.08
Modify  | 427.64     | 428.25     | 428.87     |   3.0 | 55.15
Other   |            | 58.84      |            |       |  7.58

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.73                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.7788833856071
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.83
  ghost atom cutoff = 3.83
  binsize = 1.915, bins = 9400 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 230.2 | 230.2 | 230.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            7.0247616e-06  3.5902097e-35  0              2.1074285e-05  1429362.8      0              6.9018814e+10  1.1971759e-13  0              3.3705747    
    200000   18000          200            200           -0.00024842842  5.3852989e-35  0             -0.00074528526  78984.42       0              3.813875e+09   1.1971759e-13  0              3.5018016    
    300000   18000          200            200            6.1796149e-06  1.7951035e-35  0              1.8538845e-05  31.102565      0              1501831.6      1.1971759e-13  0              3.4108135    
    400000   18000          200            200           -0.00010637077  7.1803933e-35  0             -0.00031911231  11245.019      0              5.4298175e+08  1.1971759e-13  0              3.369388     
    500000   18000          200            200            0.012193602    1.7951013e-35  0              0.036580807    407.95172      0              19698528       1.1971759e-13  0              3.362603     
    600000   18000          200            200            0.0028493217  -8.975461e-36   0              0.0085479651   639.14769      0              30862155       1.1971759e-13  0              3.3640981    
    700000   18000          200            200            0.0042365878  -1.7950959e-35  0              0.012709763    7.9023942      0              381578.33      1.1971759e-13  0              3.3638165    
    800000   18000          200            200            0.0028005745   9.635287e-42   0              0.0084017235   4.4531785      0              215028.05      1.1971759e-13  0              3.3641029    
    900000   18000          200            200            0.0031568258   8.0779365e-35  0              0.0094704773   1.3710425      0              66202.735      1.1971759e-13  0              3.3640275    
   1000000   18000          200            200            0.0031348161  -1.7950961e-35  0              0.0094044484   0.17316689     0              8361.6096      1.1971759e-13  0              3.3640324    
   1100000   18000          200            200            0.0031000946  -1.7950965e-35  0              0.0093002838   0.0081246449   0              392.31003      1.1971759e-13  0              3.3640394    
   1200000   18000          200            200            0.0031235417   6.731614e-36   0              0.0093706251   3.4263968e-06  0              0.16544844     1.1971759e-13  0              3.3640346    
   1300000   18000          200            200            0.0031143704  -2.243871e-36   0              0.0093431113   0.00016769152  0              8.0972234      1.1971759e-13  0              3.3640365    
   1400000   18000          200            200            0.00311666    -5.6096775e-37  0              0.0093499801   5.3982831e-05  0              2.6066377      1.1971759e-13  0              3.364036     
   1500000   18000          200            200            0.0031165243  -2.8048387e-37  0              0.0093495728   6.774378e-06   0              0.32711047     1.1971759e-13  0              3.3640361    
   1600000   18000          200            200            0.0031163027   2.8048389e-37  0              0.009348908    3.1248204e-07  0              0.015088639    1.1971759e-13  0              3.3640361    
   1700000   18000          200            200            0.0031164504   8.4145164e-37  0              0.0093493513   2.1759753e-10  0              1.0507006e-05  1.1971759e-13  0              3.3640361    
   1800000   18000          200            200            0.003116393   -9.8169357e-36  0              0.0093491789   6.7539152e-09  0              0.00032612239  1.1971759e-13  0              3.3640361    
   1900000   18000          200            200            0.0031164072  -2.5243549e-36  0              0.0093492216   2.1371315e-09  0              0.00010319443  1.1971759e-13  0              3.3640361    
   2000000   18000          200            200            0.0031164064   2.8048388e-36  0              0.0093492193   2.6524991e-10  0              1.2807969e-05  1.1971759e-13  0              3.3640361    
   2100000   18000          200            200            0.003116405   -8.4145162e-37  0              0.009349215    1.1993175e-11  0              5.7910748e-07  1.1971759e-13  0              3.3640361    
   2200000   18000          200            200            0.0031164059   6.1706453e-36  0              0.0093492178   1.2454514e-14  0              6.0138389e-10  1.1971759e-13  0              3.3640361    
   2300000   18000          200            200            0.0031164056   1.0301371e-44  0              0.0093492167   2.7067567e-13  0              1.3069959e-08  1.1971759e-13  0              3.3640361    
   2400000   18000          200            200            0.0031164057   7.2925808e-36  0              0.009349217    8.4537587e-14  0              4.0820175e-09  1.1971759e-13  0              3.3640361    
   2500000   18000          200            200            0.0031164057  -2.8048387e-37  0              0.009349217    1.0253905e-14  0              4.9512436e-10  1.1971759e-13  0              3.3640361    
   2600000   18000          200            200            0.0031164057   8.4145164e-37  0              0.009349217    5.0222819e-16  0              2.4250802e-11  1.1971759e-13  0              3.3640361    
   2700000   18000          200            200            0.0031164057  -2.8048387e-37  0              0.009349217    2.3756398e-17  0              1.1471114e-12  1.1971759e-13  0              3.3640361    
   2800000   18000          200            200            0.0031164057  -2.8048387e-37  0              0.009349217    2.256651e-17   0              1.089656e-12   1.1971759e-13  0              3.3640361    
   2900000   18000          200            200            0.0031164057   1.1017434e-44  0              0.009349217    8.9770214e-18  0              4.3346823e-13  1.1971759e-13  0              3.3640361    
   3000000   18000          200            200            0.0031164057   9.7701745e-45  0              0.009349217    2.4136856e-18  0              1.1654824e-13  1.1971759e-13  0              3.3640361    
Loop time of 772.895 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3353627.131 ns/day, 0.000 hours/ns, 3881.513 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 240.99     | 241.39     | 241.79     |   2.6 | 31.23
Neigh   | 10.473     | 10.474     | 10.474     |   0.0 |  1.36
Comm    | 32.891     | 32.926     | 32.961     |   0.6 |  4.26
Output  | 0.6107     | 0.61072    | 0.61074    |   0.0 |  0.08
Modify  | 428.17     | 428.36     | 428.54     |   0.9 | 55.42
Other   |            | 59.14      |            |       |  7.65

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 6      # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                       # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.74                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.2609688417216
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system wi
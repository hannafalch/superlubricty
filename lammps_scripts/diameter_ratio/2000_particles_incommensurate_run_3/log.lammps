LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.003 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 143.989663289532
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.1
  ghost atom cutoff = 5.1
  binsize = 2.55, bins = 4992 79 79
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 46.54 | 46.55 | 46.56 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            4.4987728e-14  1.3496319e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00057121588  1.3496319e-13  0             -0.0017136476   132700.02      0              6.4076091e+09  1.1971759e-13  0              4.4260061    
    200000   12727.922      200            200            0.033863998   -0.00094150377  0              0.1025335      238352.12      0              1.1509171e+10  1.1971759e-13  0              3.9893749    
    300000   12727.922      200            200            0.007107717    0.00011154581  0              0.021211605    61707.209      0              2.9796203e+09  1.1971759e-13  0              3.9952786    
    400000   12727.922      200            200            0.003732419    0.00055050126  0              0.010646756    11673.22       0              5.63658e+08    1.1971759e-13  0              3.9964276    
    500000   12727.922      200            200            0.0094072876  -0.00050749883  0              0.028729362    572.72718      0              27654946       1.1971759e-13  0              3.9942687    
    600000   12727.922      200            200            0.0037530288   0.00037414916  0              0.010884937    11.560373      0              558209.03      1.1971759e-13  0              3.9964815    
    700000   12727.922      200            200            0.005684473    0.00035330749  0              0.016700111    23.044295      0              1112726.5      1.1971759e-13  0              3.9956366    
    800000   12727.922      200            200            0.0054264103   0.00032553298  0              0.015953698    3.725986       0              179914.53      1.1971759e-13  0              3.9957399    
    900000   12727.922      200            200            0.005259179    0.00032161035  0              0.015455927    0.03704599     0              1788.8183      1.1971759e-13  0              3.9958052    
   1000000   12727.922      200            200            0.0053668901   0.00032455901  0              0.015776111    0.031959451    0              1543.2075      1.1971759e-13  0              3.9957621    
   1100000   12727.922      200            200            0.0053442938   0.00032450629  0              0.015708375    0.010117948    0              488.5595       1.1971759e-13  0              3.9957713    
   1200000   12727.922      200            200            0.0053393869   0.00032454386  0              0.015693617    0.00032385944  0              15.638013      1.1971759e-13  0              3.9957732    
   1300000   12727.922      200            200            0.0053444557   0.00032450298  0              0.015708864    3.5850544e-05  0              1.7310945      1.1971759e-13  0              3.9957712    
   1400000   12727.922      200            200            0.0053430001   0.00032451534  0              0.015704485    2.4132027e-05  0              1.1652492      1.1971759e-13  0              3.9957718    
   1500000   12727.922      200            200            0.0053429272   0.00032451583  0              0.015704266    1.5523516e-06  0              0.074957501    1.1971759e-13  0              3.9957718    
   1600000   12727.922      200            200            0.0053431529   0.00032451399  0              0.015704945    1.9418291e-08  0              0.00093763979  1.1971759e-13  0              3.9957717    
   1700000   12727.922      200            200            0.0053430685   0.00032451469  0              0.015704691    5.0759048e-08  0              0.0024509728   1.1971759e-13  0              3.9957718    
   1800000   12727.922      200            200            0.0053430734   0.00032451465  0              0.015704706    5.6682882e-09  0              0.00027370135  1.1971759e-13  0              3.9957718    
   1900000   12727.922      200            200            0.0053430827   0.00032451457  0              0.015704734    1.3894307e-12  0              6.7090635e-08  1.1971759e-13  0              3.9957718    
   2000000   12727.922      200            200            0.0053430782   0.00032451461  0              0.01570472     9.2335523e-11  0              4.458552e-06   1.1971759e-13  0              3.9957718    
   2100000   12727.922      200            200            0.0053430788   0.0003245146   0              0.015704722    1.7359674e-11  0              8.3823651e-07  1.1971759e-13  0              3.9957718    
   2200000   12727.922      200            200            0.0053430792   0.0003245146   0              0.015704723    2.018307e-13   0              9.7456822e-09  1.1971759e-13  0              3.9957718    
   2300000   12727.922      200            200            0.0053430789   0.0003245146   0              0.015704722    1.3830986e-13  0              6.678488e-09   1.1971759e-13  0              3.9957718    
   2400000   12727.922      200            200            0.005343079    0.0003245146   0              0.015704722    4.6432544e-14  0              2.2420614e-09  1.1971759e-13  0              3.9957718    
   2500000   12727.922      200            200            0.005343079    0.0003245146   0              0.015704722    1.6984694e-15  0              8.2013009e-11  1.1971759e-13  0              3.9957718    
   2600000   12727.922      200            200            0.005343079    0.0003245146   0              0.015704722    1.8026061e-16  0              8.7041399e-12  1.1971759e-13  0              3.9957718    
   2700000   12727.922      200            200            0.005343079    0.0003245146   0              0.015704722    7.9395827e-17  0              3.8337403e-12  1.1971759e-13  0              3.9957718    
   2800000   12727.922      200            200            0.005343079    0.0003245146   0              0.015704722    1.480926e-18   0              7.1508618e-14  1.1971759e-13  0              3.9957718    
   2900000   12727.922      200            200            0.005343079    0.0003245146   0              0.015704722    1.4340686e-17  0              6.9246043e-13  1.1971759e-13  0              3.9957718    
   3000000   12727.922      200            200            0.005343079    0.0003245146   0              0.015704722    5.413199e-18   0              2.6138401e-13  1.1971759e-13  0              3.9957718    
Loop time of 745.027 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3479066.794 ns/day, 0.000 hours/ns, 4026.698 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 212.78     | 273.33     | 332.72     | 351.9 | 36.69
Neigh   | 1.2674     | 1.2936     | 1.3208     |   1.8 |  0.17
Comm    | 23.994     | 83.783     | 145.24     | 635.6 | 11.25
Output  | 0.39792    | 0.39864    | 0.39939    |   0.1 |  0.05
Modify  | 208.06     | 279.33     | 351.44     | 424.8 | 37.49
Other   |            | 106.9      |            |       | 14.35

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1463.75 ave        2179 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5855
Ave neighs/atom = 1.1707658
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.01                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 144.855330297146
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.11
  ghost atom cutoff = 5.11
  binsize = 2.555, bins = 4982 79 79
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 46.48 | 46.48 | 46.48 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            4.5927533e-14  1.377826e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.0005649492   1.377826e-13   0             -0.0016948476   127875.1       0              6.1746308e+09  1.1971759e-13  0              4.4325554    
    200000   12727.922      200            200            0.060090119   -0.005196464    0              0.18546682     177102.35      0              8.5516385e+09  1.1971759e-13  0              3.9905627    
    300000   12727.922      200            200            0.014796849   -0.0012528324   0              0.04564338     56676.405      0              2.7367008e+09  1.1971759e-13  0              3.9979218    
    400000   12727.922      200            200            0.0016995737   0.00028761638  0              0.0048111048   10515.971      0              5.0777858e+08  1.1971759e-13  0              4.002536     
    500000   12727.922      200            200            0.0083595071  -0.00045945858  0              0.02553798     1045.7578      0              50495899       1.1971759e-13  0              3.9995963    
    600000   12727.922      200            200            0.0039105019   0.00038689705  0              0.011344609    51.602057      0              2491678.6      1.1971759e-13  0              4.0014155    
    700000   12727.922      200            200            0.0054956339   0.0003298115   0              0.01615709     29.766989      0              1437341.4      1.1971759e-13  0              4.0007122    
    800000   12727.922      200            200            0.0055011768   0.00032302862  0              0.016180502    2.489764       0              120221.79      1.1971759e-13  0              4.0007143    
    900000   12727.922      200            200            0.0052618485   0.00031603287  0              0.015469513    0.0069438483   0              335.29358      1.1971759e-13  0              4.0008083    
   1000000   12727.922      200            200            0.005361892    0.00031962872  0              0.015766047    0.06056544     0              2924.4883      1.1971759e-13  0              4.0007681    
   1100000   12727.922      200            200            0.0053538245   0.00031946406  0              0.015742009    0.0075993506   0              366.94544      1.1971759e-13  0              4.0007716    
   1200000   12727.922      200            200            0.0053437643   0.00031954694  0              0.015711746    3.2046723e-06  0              0.15474216     1.1971759e-13  0              4.0007756    
   1300000   12727.922      200            200            0.0053488557   0.00031950567  0              0.015727061    0.00012055337  0              5.821091       1.1971759e-13  0              4.0007735    
   1400000   12727.922      200            200            0.0053481734   0.00031951167  0              0.015725009    2.1370842e-05  0              1.0319215      1.1971759e-13  0              4.0007738    
   1500000   12727.922      200            200            0.0053477627   0.00031951499  0              0.015723773    1.385193e-07   0              0.0066886014   1.1971759e-13  0              4.000774     
   1600000   12727.922      200            200            0.0053480182   0.00031951287  0              0.015724542    2.2248074e-07  0              0.010742798    1.1971759e-13  0              4.0007739    
   1700000   12727.922      200            200            0.0053479713   0.00031951327  0              0.015724401    5.6745367e-08  0              0.0027400307   1.1971759e-13  0              4.0007739    
   1800000   12727.922      200            200            0.0053479557   0.0003195134   0              0.015724354    1.0113844e-09  0              4.8836132e-05  1.1971759e-13  0              4.0007739    
   1900000   12727.922      200            200            0.0053479682   0.00031951329  0              0.015724391    3.7117621e-10  0              1.7922771e-05  1.1971759e-13  0              4.0007739    
   2000000   12727.922      200            200            0.0053479653   0.00031951332  0              0.015724383    1.430316e-10   0              6.9064843e-06  1.1971759e-13  0              4.0007739    
   2100000   12727.922      200            200            0.0053479648   0.00031951332  0              0.015724381    4.791311e-12   0              2.3135526e-07  1.1971759e-13  0              4.0007739    
   2200000   12727.922      200            200            0.0053479654   0.00031951332  0              0.015724383    5.3551727e-13  0              2.5858212e-08  1.1971759e-13  0              4.0007739    
   2300000   12727.922      200            200            0.0053479652   0.00031951332  0              0.015724382    3.4316221e-13  0              1.6570075e-08  1.1971759e-13  0              4.0007739    
   2400000   12727.922      200            200            0.0053479652   0.00031951332  0              0.015724382    1.7941719e-14  0              8.6634142e-10  1.1971759e-13  0              4.0007739    
   2500000   12727.922      200            200            0.0053479652   0.00031951332  0              0.015724382    5.2849178e-16  0              2.5518977e-11  1.1971759e-13  0              4.0007739    
   2600000   12727.922      200            200            0.0053479652   0.00031951332  0              0.015724382    8.0784187e-16  0              3.9007793e-11  1.1971759e-13  0              4.0007739    
   2700000   12727.922      200            200            0.0053479652   0.00031951332  0              0.015724382    6.6693897e-21  0              3.2204096e-16  1.1971759e-13  0              4.0007739    
   2800000   12727.922      200            200            0.0053479652   0.00031951332  0              0.015724382    1.7075352e-17  0              8.2450761e-13  1.1971759e-13  0              4.0007739    
   2900000   12727.922      200            200            0.0053479652   0.00031951332  0              0.015724382    1.7099254e-17  0              8.2566179e-13  1.1971759e-13  0              4.0007739    
   3000000   12727.922      200            200            0.0053479652   0.00031951331  0              0.015724382    1.2584863e-17  0              6.0767799e-13  1.1971759e-13  0              4.0007739    
Loop time of 739.184 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3506568.141 ns/day, 0.000 hours/ns, 4058.528 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 204.95     | 265.12     | 327.33     | 360.3 | 35.87
Neigh   | 1.3275     | 1.3496     | 1.3713     |   1.6 |  0.18
Comm    | 25.62      | 85.536     | 148.31     | 624.1 | 11.57
Output  | 0.40561    | 0.4063     | 0.40702    |   0.1 |  0.05
Modify  | 201.82     | 276.88     | 352.25     | 425.3 | 37.46
Other   |            | 109.9      |            |       | 14.87

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1468.75 ave        2189 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5875
Ave neighs/atom = 1.174765
Neighbor list builds = 130
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.02                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 145.724459968183
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.12
  ghost atom cutoff = 5.12
  binsize = 2.56, bins = 4972 79 79
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 46.4 | 46.41 | 46.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            4.6874935e-14  1.406248e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00055852306  1.406248e-13   0             -0.0016755692   123142.05      0              5.9460889e+09  1.1971759e-13  0              4.4390671    
    200000   12727.922      200            200            0.087586957   -0.0074536866   0              0.27021456     94583.391      0              4.5670934e+09  1.1971759e-13  0              3.9924979    
    300000   12727.922      200            200            0.025384319   -0.00069829236  0              0.076851251    44247.529      0              2.1365548e+09  1.1971759e-13  0              4.0007411    
    400000   12727.922      200            200            0.00048013214  0.0001290642   0              0.0013113322   8824.465       0              4.2610183e+08  1.1971759e-13  0              4.0085712    
    500000   12727.922      200            200            0.0072443499  -6.3160432e-05  0              0.02179621     1457.0506      0              70355761       1.1971759e-13  0              4.0050069    
    600000   12727.922      200            200            0.0041800465   0.00043068895  0              0.012109451    109.92014      0              5307650        1.1971759e-13  0              4.0063036    
    700000   12727.922      200            200            0.0053012691   0.00032205838  0              0.015581749    31.164773      0              1504835.3      1.1971759e-13  0              4.0057936    
    800000   12727.922      200            200            0.0055617796   0.00033000075  0              0.016355338    1.0881778      0              52544.212      1.1971759e-13  0              4.0056957    
    900000   12727.922      200            200            0.0052771433   0.00031400658  0              0.015517423    0.12046624     0              5816.8838      1.1971759e-13  0              4.0058067    
   1000000   12727.922      200            200            0.005355683    0.0003175968   0              0.015749452    0.075261783    0              3634.1221      1.1971759e-13  0              4.0057751    
   1100000   12727.922      200            200            0.0053632493   0.00031731863  0              0.015772429    0.0033645264   0              162.46094      1.1971759e-13  0              4.0057722    
   1200000   12727.922      200            200            0.0053499721   0.00031742628  0              0.01573249     0.00021640732  0              10.449535      1.1971759e-13  0              4.0057776    
   1300000   12727.922      200            200            0.0053540103   0.00031739525  0              0.015744636    0.00017916754  0              8.6513593      1.1971759e-13  0              4.0057759    
   1400000   12727.922      200            200            0.0053542533   0.00031739363  0              0.015745366    9.7684816e-06  0              0.47168502     1.1971759e-13  0              4.0057758    
   1500000   12727.922      200            200            0.005353619    0.00031739855  0              0.015743458    3.6626015e-07  0              0.017685392    1.1971759e-13  0              4.0057761    
   1600000   12727.922      200            200            0.005353828    0.0003173969   0              0.015744087    4.2236147e-07  0              0.020394324    1.1971759e-13  0              4.005776     
   1700000   12727.922      200            200            0.0053538335   0.00031739687  0              0.015744104    2.7685204e-08  0              0.0013368194   1.1971759e-13  0              4.005776     
   1800000   12727.922      200            200            0.0053538034   0.0003173971   0              0.015744013    5.6671685e-10  0              2.7364728e-05  1.1971759e-13  0              4.005776     
   1900000   12727.922      200            200            0.0053538141   0.00031739702  0              0.015744045    9.8551984e-10  0              4.7587226e-05  1.1971759e-13  0              4.005776     
   2000000   12727.922      200            200            0.0053538141   0.00031739702  0              0.015744045    7.6848292e-11  0              3.710729e-06   1.1971759e-13  0              4.005776     
   2100000   12727.922      200            200            0.0053538126   0.00031739703  0              0.015744041    7.6193909e-13  0              3.6791312e-08  1.1971759e-13  0              4.005776     
   2200000   12727.922      200            200            0.0053538132   0.00031739703  0              0.015744043    2.2755281e-12  0              1.0987711e-07  1.1971759e-13  0              4.005776     
   2300000   12727.922      200            200            0.0053538132   0.00031739703  0              0.015744043    2.0751561e-13  0              1.0020186e-08  1.1971759e-13  0              4.005776     
   2400000   12727.922      200            200            0.0053538131   0.00031739703  0              0.015744042    7.9452877e-16  0              3.8364951e-11  1.1971759e-13  0              4.005776     
   2500000   12727.922      200            200            0.0053538131   0.00031739703  0              0.015744042    5.1292677e-15  0              2.4767398e-10  1.1971759e-13  0              4.005776     
   2600000   12727.922      200            200            0.0053538131   0.00031739703  0              0.015744042    4.606498e-16   0              2.224313e-11   1.1971759e-13  0              4.005776     
   2700000   12727.922      200            200            0.0053538131   0.00031739703  0              0.015744042    5.1948855e-17  0              2.5084243e-12  1.1971759e-13  0              4.005776     
   2800000   12727.922      200            200            0.0053538131   0.00031739702  0              0.015744042    3.2149876e-18  0              1.5524024e-13  1.1971759e-13  0              4.005776     
   2900000   12727.922      200            200            0.0053538131   0.00031739703  0              0.015744042    1.033165e-21   0              4.988784e-17   1.1971759e-13  0              4.005776     
   3000000   12727.922      200            200            0.0053538131   0.00031739701  0              0.015744042    8.1757358e-18  0              3.9477702e-13  1.1971759e-13  0              4.005776     
Loop time of 726.212 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3569207.570 ns/day, 0.000 hours/ns, 4131.027 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.33     | 260.44     | 320.45     | 371.9 | 35.86
Neigh   | 1.3191     | 1.341      | 1.363      |   1.6 |  0.18
Comm    | 24.341     | 84.939     | 146.68     | 652.8 | 11.70
Output  | 0.40338    | 0.40413    | 0.40487    |   0.1 |  0.06
Modify  | 201.36     | 272.71     | 343.86     | 425.7 | 37.55
Other   |            | 106.4      |            |       | 14.65

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1474.25 ave        2199 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5897
Ave neighs/atom = 1.1791642
Neighbor list builds = 130
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.03                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 146.597059214146
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.13
  ghost atom cutoff = 5.13
  binsize = 2.565, bins = 4963 78 78
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.55 | 45.57 | 45.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            4.7829909e-14  1.4348973e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00055193802  1.4348973e-13  0             -0.0016558141   118500.75      0              5.7219769e+09  1.1971759e-13  0              4.4455411    
    200000   12727.922      200            200            0.10804329    -0.0082253743   0              0.33235526     23614.185      0              1.1402445e+09  1.1971759e-13  0              3.9955544    
    300000   12727.922      200            200            0.036022938   -0.0011269827   0              0.1091958      26442.408      0              1.2768092e+09  1.1971759e-13  0              4.0039213    
    400000   12727.922      200            200           -6.6513785e-05  2.8713145e-05  0             -0.0002282545   6998.017       0              3.3790919e+08  1.1971759e-13  0              4.014508     
    500000   12727.922      200            200            0.0061101703   0.00039878151  0              0.017931729    1695.9954      0              81893550       1.1971759e-13  0              4.0104693    
    600000   12727.922      200            200            0.0045308164   0.00043709219  0              0.013155357    170.59555      0              8237448.6      1.1971759e-13  0              4.0111533    
    700000   12727.922      200            200            0.0051296578   0.00035687319  0              0.0150321      26.802749      0              1294208.8      1.1971759e-13  0              4.0108731    
    800000   12727.922      200            200            0.0055961435   0.00032928023  0              0.01645915     0.15033663     0              7259.218       1.1971759e-13  0              4.0106864    
    900000   12727.922      200            200            0.0053026117   0.00031186363  0              0.015595971    0.31726698     0              15319.687      1.1971759e-13  0              4.010801     
   1000000   12727.922      200            200            0.0053490773   0.0003151638   0              0.015732068    0.067197119    0              3244.7084      1.1971759e-13  0              4.0107821    
   1100000   12727.922      200            200            0.0053708342   0.00031481634  0              0.015797686    0.00034009041  0              16.421749      1.1971759e-13  0              4.0107736    
   1200000   12727.922      200            200            0.0053568482   0.00031492787  0              0.015755617    0.00078993909  0              38.143332      1.1971759e-13  0              4.0107792    
   1300000   12727.922      200            200            0.0053589958   0.00031491173  0              0.015762076    0.00016039613  0              7.744955       1.1971759e-13  0              4.0107783    
   1400000   12727.922      200            200            0.0053600936   0.0003149038   0              0.015765377    6.7377236e-07  0              0.032534056    1.1971759e-13  0              4.0107779    
   1500000   12727.922      200            200            0.0053594075   0.00031490892  0              0.015763313    1.9645229e-06  0              0.094859781    1.1971759e-13  0              4.0107782    
   1600000   12727.922      200            200            0.0053595089   0.00031490813  0              0.015763619    3.8232208e-07  0              0.018460965    1.1971759e-13  0              4.0107781    
   1700000   12727.922      200            200            0.0053595642   0.00031490773  0              0.015763785    1.3059081e-09  0              6.305763e-05   1.1971759e-13  0              4.0107781    
   1800000   12727.922      200            200            0.0053595306   0.00031490798  0              0.015763684    4.8800012e-09  0              0.00023563779  1.1971759e-13  0              4.0107781    
   1900000   12727.922      200            200            0.0053595353   0.00031490795  0              0.015763698    9.1067655e-10  0              4.3973311e-05  1.1971759e-13  0              4.0107781    
   2000000   12727.922      200            200            0.0053595381   0.00031490793  0              0.015763706    2.4628946e-12  0              1.1892437e-07  1.1971759e-13  0              4.0107781    
   2100000   12727.922      200            200            0.0053595365   0.00031490794  0              0.015763701    1.2108471e-11  0              5.8467474e-07  1.1971759e-13  0              4.0107781    
   2200000   12727.922      200            200            0.0053595367   0.00031490794  0              0.015763702    2.1700335e-12  0              1.0478315e-07  1.1971759e-13  0              4.0107781    
   2300000   12727.922      200            200            0.0053595368   0.00031490794  0              0.015763703    4.4778726e-15  0              2.1622044e-10  1.1971759e-13  0              4.0107781    
   2400000   12727.922      200            200            0.0053595368   0.00031490794  0              0.015763702    2.9736626e-14  0              1.4358752e-09  1.1971759e-13  0              4.0107781    
   2500000   12727.922      200            200            0.0053595368   0.00031490794  0              0.015763702    5.1644359e-15  0              2.4937213e-10  1.1971759e-13  0              4.0107781    
   2600000   12727.922      200            200            0.0053595368   0.00031490794  0              0.015763702    2.9018183e-19  0              1.4011842e-14  1.1971759e-13  0              4.0107781    
   2700000   12727.922      200            200            0.0053595368   0.00031490794  0              0.015763702    1.0107956e-16  0              4.88077e-12    1.1971759e-13  0              4.0107781    
   2800000   12727.922      200            200            0.0053595368   0.00031490794  0              0.015763702    4.2870116e-18  0              2.0700445e-13  1.1971759e-13  0              4.0107781    
   2900000   12727.922      200            200            0.0053595368   0.00031490794  0              0.015763702    9.1914045e-18  0              4.4382003e-13  1.1971759e-13  0              4.0107781    
   3000000   12727.922      200            200            0.0053595368   0.00031490792  0              0.015763702    4.8758499e-18  0              2.3543734e-13  1.1971759e-13  0              4.0107781    
Loop time of 718.275 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3608647.739 ns/day, 0.000 hours/ns, 4176.676 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.27     | 253.27     | 308.35     | 345.0 | 35.26
Neigh   | 1.2514     | 1.2731     | 1.2945     |   1.7 |  0.18
Comm    | 26.155     | 81.246     | 135.48     | 601.3 | 11.31
Output  | 0.40361    | 0.4043     | 0.40501    |   0.1 |  0.06
Modify  | 205.46     | 275.52     | 346.85     | 416.8 | 38.36
Other   |            | 106.6      |            |       | 14.84

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1423.75 ave        2099 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5695
Ave neighs/atom = 1.1387722
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.04                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 147.47313494654
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.14
  ghost atom cutoff = 5.14
  binsize = 2.57, bins = 4953 78 78
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.5 | 45.51 | 45.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            4.8792434e-14  1.463773e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00054519462  1.463773e-13   0             -0.0016355839   113951.02      0              5.502287e+09   1.1971759e-13  0              4.4519772    
    200000   12727.922      200            200            0.11423558    -0.0081167496   0              0.3508235      513.39846      0              24790174       1.1971759e-13  0              4.0000089    
    300000   12727.922      200            200            0.044359354   -0.0019908647   0              0.13506893     9289.7008      0              4.4856641e+08  1.1971759e-13  0              4.0076548    
    400000   12727.922      200            200           -0.00012844324  1.463773e-13   0             -0.00038532972  5305.3423      0              2.5617599e+08  1.1971759e-13  0              4.0203347    
    500000   12727.922      200            200            0.0049651366   0.00059396369  0              0.014301446    1715.1698      0              82819411       1.1971759e-13  0              4.0159513    
    600000   12727.922      200            200            0.0049508553   0.00041491606  0              0.01443765     216.08477      0              10433960       1.1971759e-13  0              4.0159754    
    700000   12727.922      200            200            0.0049652058   0.00033569139  0              0.014559926    18.376646      0              887342.45      1.1971759e-13  0              4.0159434    
    800000   12727.922      200            200            0.0056023073   0.00032572635  0              0.016481196    0.097129591    0              4690.0403      1.1971759e-13  0              4.0156879    
    900000   12727.922      200            200            0.0053355099   0.0003091592   0              0.015697371    0.4937404      0              23840.957      1.1971759e-13  0              4.0157922    
   1000000   12727.922      200            200            0.0053440035   0.00031227693  0              0.015719734    0.041346271    0              1996.4635      1.1971759e-13  0              4.0157886    
   1100000   12727.922      200            200            0.0053762332   0.00031192679  0              0.015816773    0.00059053532  0              28.514837      1.1971759e-13  0              4.0157757    
   1200000   12727.922      200            200            0.0053641419   0.00031202097  0              0.015780405    0.0012715762   0              61.399865      1.1971759e-13  0              4.0157806    
   1300000   12727.922      200            200            0.0053639732   0.00031202145  0              0.015779898    8.1145955e-05  0              3.9182477      1.1971759e-13  0              4.0157807    
   1400000   12727.922      200            200            0.0053656535   0.00031200973  0              0.015784951    2.8407944e-06  0              0.13717179     1.1971759e-13  0              4.01578      
   1500000   12727.922      200            200            0.0053650981   0.00031201373  0              0.015783281    3.1985185e-06  0              0.15444501     1.1971759e-13  0              4.0157802    
   1600000   12727.922      200            200            0.0053650637   0.00031201394  0              0.015783177    1.5140752e-07  0              0.0073109273   1.1971759e-13  0              4.0157802    
   1700000   12727.922      200            200            0.0053651501   0.00031201333  0              0.015783437    1.1255397e-08  0              0.00054348284  1.1971759e-13  0              4.0157802    
   1800000   12727.922      200            200            0.005365125    0.00031201352  0              0.015783361    7.8680817e-09  0              0.0003799215   1.1971759e-13  0              4.0157802    
   1900000   12727.922      200            200            0.005365122    0.00031201353  0              0.015783353    2.6507149e-10  0              1.2799354e-05  1.1971759e-13  0              4.0157802    
   2000000   12727.922      200            200            0.0053651264   0.0003120135   0              0.015783366    3.9678723e-11  0              1.9159435e-06  1.1971759e-13  0              4.0157802    
   2100000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    1.8937842e-11  0              9.1444062e-07  1.1971759e-13  0              4.0157802    
   2200000   12727.922      200            200            0.0053651251   0.00031201351  0              0.015783362    4.2426339e-13  0              2.0486161e-08  1.1971759e-13  0              4.0157802    
   2300000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    1.3014392e-13  0              6.2841843e-09  1.1971759e-13  0              4.0157802    
   2400000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    4.4435359e-14  0              2.1456244e-09  1.1971759e-13  0              4.0157802    
   2500000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    6.5419138e-16  0              3.1588561e-11  1.1971759e-13  0              4.0157802    
   2600000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    4.6767129e-16  0              2.2582173e-11  1.1971759e-13  0              4.0157802    
   2700000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    1.0157419e-17  0              4.904654e-13   1.1971759e-13  0              4.0157802    
   2800000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    1.9456136e-17  0              9.3946717e-13  1.1971759e-13  0              4.0157802    
   2900000   12727.922      200            200            0.0053651253   0.00031201351  0              0.015783362    1.7537569e-17  0              8.4682643e-13  1.1971759e-13  0              4.0157802    
   3000000   12727.922      200            200            0.0053651253   0.0003120135   0              0.015783362    1.8353073e-19  0              8.8620421e-15  1.1971759e-13  0              4.0157802    
Loop time of 694.305 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3733227.774 ns/day, 0.000 hours/ns, 4320.865 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.09     | 235.18     | 290.03     | 357.6 | 33.87
Neigh   | 1.2042     | 1.2262     | 1.2485     |   1.6 |  0.18
Comm    | 24.307     | 79.816     | 135.5      | 613.6 | 11.50
Output  | 0.40301    | 0.40364    | 0.40429    |   0.1 |  0.06
Modify  | 201.91     | 271.91     | 342.18     | 419.4 | 39.16
Other   |            | 105.8      |            |       | 15.23

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1430.25 ave        2112 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5721
Ave neighs/atom = 1.1439712
Neighbor list builds = 123
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.05                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 148.352694076868
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.15
  ghost atom cutoff = 5.15
  binsize = 2.575, bins = 4943 78 78
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.42 | 45.43 | 45.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            4.9762488e-14  1.4928746e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00053829339  1.4928746e-13  0             -0.0016148802   109492.73      0              5.287012e+09   1.1971759e-13  0              4.4583755    
    200000   12727.922      200            200            0.10348242    -0.0081494397   0              0.31859671     38134.608      0              1.8413837e+09  1.1971759e-13  0              4.0059481    
    300000   12727.922      200            200            0.048110438   -0.0029474483   0              0.14727876     322.81834      0              15587742       1.1971759e-13  0              4.0120973    
    400000   12727.922      200            200           -0.00011041202  1.4928746e-13  0             -0.00033123606  3845.5274      0              1.8568676e+08  1.1971759e-13  0              4.0260486    
    500000   12727.922      200            200            0.0037875124   0.00021032665  0              0.011152211    1531.4258      0              73947070       1.1971759e-13  0              4.0214219    
    600000   12727.922      200            200            0.0054467351   0.00045552855  0              0.015884677    232.03969      0              11204366       1.1971759e-13  0              4.020783     
    700000   12727.922      200            200            0.0048400978   0.00031277086  0              0.014207522    9.0086463      0              434995.29      1.1971759e-13  0              4.0209981    
    800000   12727.922      200            200            0.0055801652   0.00031958367  0              0.016420912    0.94591508     0              45674.854      1.1971759e-13  0              4.0207001    
    900000   12727.922      200            200            0.005371337    0.00030333046  0              0.01581068     0.55700732     0              26895.89       1.1971759e-13  0              4.0207819    
   1000000   12727.922      200            200            0.0053410342   0.00030563322  0              0.015717469    0.013374803    0              645.82135      1.1971759e-13  0              4.0207936    
   1100000   12727.922      200            200            0.0053784175   0.00030544789  0              0.015829805    0.0039030829   0              188.4659       1.1971759e-13  0              4.0207787    
   1200000   12727.922      200            200            0.0053704363   0.00030551433  0              0.015805795    0.0012854778   0              62.071121      1.1971759e-13  0              4.020782     
   1300000   12727.922      200            200            0.0053680196   0.00030553174  0              0.015798527    1.0775219e-05  0              0.52029678     1.1971759e-13  0              4.0207829    
   1400000   12727.922      200            200            0.0053698767   0.00030551791  0              0.015804112    1.4005877e-05  0              0.67629366     1.1971759e-13  0              4.0207822    
   1500000   12727.922      200            200            0.005369597    0.00030552011  0              0.015803271    2.7482315e-06  0              0.13270226     1.1971759e-13  0              4.0207823    
   1600000   12727.922      200            200            0.0053694388   0.00030552127  0              0.015802795    1.3795782e-09  0              6.6614892e-05  1.1971759e-13  0              4.0207823    
   1700000   12727.922      200            200            0.0053695278   0.0003055206   0              0.015803063    4.4241211e-08  0              0.0021362497   1.1971759e-13  0              4.0207823    
   1800000   12727.922      200            200            0.0053695201   0.00030552066  0              0.01580304     5.3879537e-09  0              0.000260165    1.1971759e-13  0              4.0207823    
   1900000   12727.922      200            200            0.0053695106   0.00030552073  0              0.015803011    1.8872102e-11  0              9.1126624e-07  1.1971759e-13  0              4.0207823    
   2000000   12727.922      200            200            0.0053695147   0.0003055207   0              0.015803024    1.268246e-10   0              6.1239061e-06  1.1971759e-13  0              4.0207823    
   2100000   12727.922      200            200            0.0053695147   0.0003055207   0              0.015803023    9.4853825e-12  0              4.5801517e-07  1.1971759e-13  0              4.0207823    
   2200000   12727.922      200            200            0.0053695141   0.0003055207   0              0.015803022    2.6000603e-13  0              1.255476e-08   1.1971759e-13  0              4.0207823    
   2300000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    3.3548212e-13  0              1.6199231e-08  1.1971759e-13  0              4.0207823    
   2400000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    1.4526401e-14  0              7.0142789e-10  1.1971759e-13  0              4.0207823    
   2500000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    1.2829438e-15  0              6.1948764e-11  1.1971759e-13  0              4.0207823    
   2600000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    7.9325477e-16  0              3.8303434e-11  1.1971759e-13  0              4.0207823    
   2700000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    1.4578726e-17  0              7.0395451e-13  1.1971759e-13  0              4.0207823    
   2800000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    4.8048226e-17  0              2.3200769e-12  1.1971759e-13  0              4.0207823    
   2900000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    6.1017674e-17  0              2.9463251e-12  1.1971759e-13  0              4.0207823    
   3000000   12727.922      200            200            0.0053695143   0.0003055207   0              0.015803022    9.3479262e-18  0              4.513779e-13   1.1971759e-13  0              4.0207823    
Loop time of 692.329 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3743885.438 ns/day, 0.000 hours/ns, 4333.201 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.78     | 235.31     | 291.09     | 360.4 | 33.99
Neigh   | 1.16       | 1.1809     | 1.202      |   1.6 |  0.17
Comm    | 23.303     | 79.505     | 135.18     | 619.1 | 11.48
Output  | 0.40257    | 0.4032     | 0.40386    |   0.1 |  0.06
Modify  | 200.97     | 270.35     | 339.94     | 420.7 | 39.05
Other   |            | 105.6      |            |       | 15.25

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1436.25 ave        2123 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5745
Ave neighs/atom = 1.1487702
Neighbor list builds = 119
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.06                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 149.235743516635
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.16
  ghost atom cutoff = 5.16
  binsize = 2.58, bins = 4934 78 78
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.37 | 45.37 | 45.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.074005e-14   1.5222015e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.0005312349   1.5222015e-13  0             -0.0015937047   105125.73      0              5.0761451e+09  1.1971759e-13  0              4.4647358    
    200000   12727.922      200            200            0.079795815   -0.0073294097   0              0.24671686     114993.24      0              5.5526119e+09  1.1971759e-13  0              4.0132366    
    300000   12727.922      200            200            0.046456046   -0.0026711922   0              0.14203933     3937.5495      0              1.9013017e+08  1.1971759e-13  0              4.0173244    
    400000   12727.922      200            200           -9.2044302e-05  1.5222015e-13  0             -0.00027613291  2621.8855      0              1.2660147e+08  1.1971759e-13  0              4.0316495    
    500000   12727.922      200            200            0.0029653547   0.00028809873  0              0.0086079654   1206.9574      0              58279651       1.1971759e-13  0              4.0268544    
    600000   12727.922      200            200            0.0059184418   0.00036277859  0              0.017392547    212.11423      0              10242237       1.1971759e-13  0              4.025591     
    700000   12727.922      200            200            0.0047703246   0.00030637184  0              0.014004602    2.0845219      0              100654.1       1.1971759e-13  0              4.0260324    
    800000   12727.922      200            200            0.0055342552   0.00031472871  0              0.016288037    2.3019413      0              111152.51      1.1971759e-13  0              4.0257219    
    900000   12727.922      200            200            0.0054069442   0.00029763174  0              0.015923201    0.47362217     0              22869.52       1.1971759e-13  0              4.0257716    
   1000000   12727.922      200            200            0.0053425665   0.00029899548  0              0.015728704    0.00010148179  0              4.9001924      1.1971759e-13  0              4.0257969    
   1100000   12727.922      200            200            0.0053789537   0.0002988662   0              0.015837995    0.0079566099   0              384.19622      1.1971759e-13  0              4.0257823    
   1200000   12727.922      200            200            0.0053764989   0.0002988888   0              0.015830608    0.00082311577  0              39.745315      1.1971759e-13  0              4.0257834    
   1300000   12727.922      200            200            0.0053723731   0.00029892107  0              0.015818198    1.0081626e-05  0              0.48680564     1.1971759e-13  0              4.025785     
   1400000   12727.922      200            200            0.0053739671   0.00029890852  0              0.015822993    2.3250589e-05  0              1.1226877      1.1971759e-13  0              4.0257844    
   1500000   12727.922      200            200            0.0053740322   0.00029890811  0              0.015823189    1.1056031e-06  0              0.053385618    1.1971759e-13  0              4.0257843    
   1600000   12727.922      200            200            0.0053737984   0.00029890994  0              0.015822485    1.0545832e-07  0              0.0050922049   1.1971759e-13  0              4.0257844    
   1700000   12727.922      200            200            0.0053738613   0.00029890944  0              0.015822675    5.7877926e-08  0              0.0027947179   1.1971759e-13  0              4.0257844    
   1800000   12727.922      200            200            0.0053738734   0.00029890935  0              0.015822711    9.0889264e-10  0              4.3887173e-05  1.1971759e-13  0              4.0257844    
   1900000   12727.922      200            200            0.0053738613   0.00029890944  0              0.015822674    5.3082185e-10  0              2.5631487e-05  1.1971759e-13  0              4.0257844    
   2000000   12727.922      200            200            0.0053738634   0.00029890942  0              0.015822681    1.2331708e-10  0              5.9545406e-06  1.1971759e-13  0              4.0257844    
   2100000   12727.922      200            200            0.0053738644   0.00029890942  0              0.015822684    9.7028889e-14  0              4.6851778e-09  1.1971759e-13  0              4.0257844    
   2200000   12727.922      200            200            0.0053738638   0.00029890942  0              0.015822682    1.9443887e-12  0              9.3887571e-08  1.1971759e-13  0              4.0257844    
   2300000   12727.922      200            200            0.0053738638   0.00029890942  0              0.015822682    2.2319774e-13  0              1.077742e-08   1.1971759e-13  0              4.0257844    
   2400000   12727.922      200            200            0.0053738639   0.00029890942  0              0.015822682    1.802815e-15   0              8.7051485e-11  1.1971759e-13  0              4.0257844    
   2500000   12727.922      200            200            0.0053738639   0.00029890942  0              0.015822682    5.7159667e-15  0              2.7600357e-10  1.1971759e-13  0              4.0257844    
   2600000   12727.922      200            200            0.0053738639   0.00029890942  0              0.015822682    1.8717527e-16  0              9.0380238e-12  1.1971759e-13  0              4.0257844    
   2700000   12727.922      200            200            0.0053738639   0.00029890942  0              0.015822682    1.0563913e-16  0              5.1009357e-12  1.1971759e-13  0              4.0257844    
   2800000   12727.922      200            200            0.0053738639   0.00029890942  0              0.015822682    9.4944474e-19  0              4.5845289e-14  1.1971759e-13  0              4.0257844    
   2900000   12727.922      200            200            0.0053738639   0.00029890942  0              0.015822682    1.6498422e-19  0              7.9664978e-15  1.1971759e-13  0              4.0257844    
   3000000   12727.922      200            200            0.0053738639   0.00029890943  0              0.015822682    8.5974704e-18  0              4.1514108e-13  1.1971759e-13  0              4.0257844    
Loop time of 692.781 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3741441.000 ns/day, 0.000 hours/ns, 4330.372 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.09     | 235.44     | 291.17     | 360.0 | 33.98
Neigh   | 1.1276     | 1.1477     | 1.1668     |   1.5 |  0.17
Comm    | 23.717     | 80.042     | 135.37     | 617.3 | 11.55
Output  | 0.40239    | 0.40303    | 0.40368    |   0.1 |  0.06
Modify  | 200.42     | 270.1      | 340.09     | 420.0 | 38.99
Other   |            | 105.6      |            |       | 15.25

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1442.25 ave        2136 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5769
Ave neighs/atom = 1.1535693
Neighbor list builds = 117
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.07                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 150.122290177343
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.17
  ghost atom cutoff = 5.17
  binsize = 2.585, bins = 4924 78 78
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.29 | 45.3 | 45.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.1725098e-14  1.551753e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.0005240197   1.551753e-13   0             -0.0015720591   100849.87      0              4.8696791e+09  1.1971759e-13  0              4.4710579    
    200000   12727.922      200            200            0.050951087   -0.0056279594   0              0.15848122     192510.66      0              9.2956507e+09  1.1971759e-13  0              4.0215625    
    300000   12727.922      200            200            0.039850615   -0.0012243426   0              0.12077619     18244.786      0              8.809754e+08   1.1971759e-13  0              4.023309     
    400000   12727.922      200            200           -7.3343483e-05  1.551753e-13   0             -0.00022003045  1633.286       0              78865538       1.1971759e-13  0              4.037137     
    500000   12727.922      200            200            0.0023528473   0.00036281849  0              0.0066957233   823.40093      0              39759084       1.1971759e-13  0              4.0322266    
    600000   12727.922      200            200            0.0063706641   0.00027874841  0              0.018833244    161.12143      0              7779977.2      1.1971759e-13  0              4.0304152    
    700000   12727.922      200            200            0.0047563351   0.00030067085  0              0.013968334    0.058615919    0              2830.353       1.1971759e-13  0              4.0310432    
    800000   12727.922      200            200            0.0054699438   0.00030855371  0              0.016101278    3.5419842      0              171029.74      1.1971759e-13  0              4.0307509    
    900000   12727.922      200            200            0.0054384962   0.00029332034  0              0.016022168    0.28742392     0              13878.673      1.1971759e-13  0              4.0307631    
   1000000   12727.922      200            200            0.0053496655   0.00029424399  0              0.015754753    0.0093549921   0              451.71909      1.1971759e-13  0              4.0307982    
   1100000   12727.922      200            200            0.0053791845   0.00029412395  0              0.015843429    0.0099404813   0              479.99027      1.1971759e-13  0              4.0307863    
   1200000   12727.922      200            200            0.0053826291   0.00029409911  0              0.015853788    0.00024573445  0              11.865637      1.1971759e-13  0              4.030785     
   1300000   12727.922      200            200            0.0053776807   0.00029413704  0              0.015838905    7.8695953e-05  0              3.7999459      1.1971759e-13  0              4.030787     
   1400000   12727.922      200            200            0.0053786413   0.00029412965  0              0.015841794    2.1647447e-05  0              1.0452777      1.1971759e-13  0              4.0307866    
   1500000   12727.922      200            200            0.0053790291   0.00029412681  0              0.015842961    2.1619373e-08  0              0.0010439222   1.1971759e-13  0              4.0307864    
   1600000   12727.922      200            200            0.0053787888   0.00029412863  0              0.015842238    3.3869353e-07  0              0.016354299    1.1971759e-13  0              4.0307865    
   1700000   12727.922      200            200            0.0053788058   0.00029412849  0              0.015842289    3.4967565e-08  0              0.0016884586   1.1971759e-13  0              4.0307865    
   1800000   12727.922      200            200            0.0053788332   0.00029412829  0              0.015842371    5.9216064e-10  0              2.8593318e-05  1.1971759e-13  0              4.0307865    
   1900000   12727.922      200            200            0.005378823    0.00029412836  0              0.015842341    1.0292442e-09  0              4.9698518e-05  1.1971759e-13  0              4.0307865    
   2000000   12727.922      200            200            0.0053788223   0.00029412837  0              0.015842338    3.5474678e-11  0              1.7129452e-06  1.1971759e-13  0              4.0307865    
   2100000   12727.922      200            200            0.0053788239   0.00029412836  0              0.015842343    6.7257704e-12  0              3.2476338e-07  1.1971759e-13  0              4.0307865    
   2200000   12727.922      200            200            0.0053788235   0.00029412836  0              0.015842342    2.3847723e-12  0              1.1515212e-07  1.1971759e-13  0              4.0307865    
   2300000   12727.922      200            200            0.0053788234   0.00029412836  0              0.015842342    8.9823531e-15  0              4.3372569e-10  1.1971759e-13  0              4.0307865    
   2400000   12727.922      200            200            0.0053788235   0.00029412836  0              0.015842342    3.2405062e-14  0              1.5647245e-09  1.1971759e-13  0              4.0307865    
   2500000   12727.922      200            200            0.0053788235   0.00029412836  0              0.015842342    4.1896155e-15  0              2.0230154e-10  1.1971759e-13  0              4.0307865    
   2600000   12727.922      200            200            0.0053788235   0.00029412836  0              0.015842342    9.3312887e-17  0              4.5057453e-12  1.1971759e-13  0              4.0307865    
   2700000   12727.922      200            200            0.0053788235   0.00029412836  0              0.015842342    4.5280253e-17  0              2.1864214e-12  1.1971759e-13  0              4.0307865    
   2800000   12727.922      200            200            0.0053788235   0.00029412836  0              0.015842342    1.2290282e-18  0              5.9345376e-14  1.1971759e-13  0              4.0307865    
   2900000   12727.922      200            200            0.0053788235   0.00029412836  0              0.015842342    7.5441148e-20  0              3.642783e-15   1.1971759e-13  0              4.0307865    
   3000000   12727.922      200            200            0.0053788235   0.00029412837  0              0.015842342    8.5590705e-18  0              4.1328689e-13  1.1971759e-13  0              4.0307865    
Loop time of 696.235 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3722882.165 ns/day, 0.000 hours/ns, 4308.891 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.09     | 236.02     | 293.25     | 360.4 | 33.90
Neigh   | 1.1459     | 1.1688     | 1.1921     |   1.6 |  0.17
Comm    | 23.251     | 80.563     | 138.63     | 612.7 | 11.57
Output  | 0.39864    | 0.39928    | 0.39991    |   0.1 |  0.06
Modify  | 201.71     | 272.21     | 341.87     | 419.3 | 39.10
Other   |            | 105.9      |            |       | 15.21

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1447.75 ave        2147 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5791
Ave neighs/atom = 1.1579684
Neighbor list builds = 117
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.08                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 151.012340970497
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.18
  ghost atom cutoff = 5.18
  binsize = 2.59, bins = 4915 78 78
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.24 | 45.25 | 45.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.2717614e-14  1.5815284e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00051664831  1.5815284e-13  0             -0.0015499449   96664.994      0              4.6676066e+09  1.1971759e-13  0              4.4773419    
    200000   12727.922      200            200            0.026068053    0.00016545663  0              0.078038701    242209.23      0              1.1695417e+10  1.1971759e-13  0              4.0305382    
    300000   12727.922      200            200            0.02943129    -0.0012276803   0              0.089521552    36369.206      0              1.7561388e+09  1.1971759e-13  0              4.0299283    
    400000   12727.922      200            200           -5.4312741e-05  1.5815284e-13  0             -0.00016293822  878.58832      0              42423886       1.1971759e-13  0              4.0425108    
    500000   12727.922      200            200            0.001876628    0.00026112059  0              0.0053687635   459.80346      0              22202264       1.1971759e-13  0              4.0375217    
    600000   12727.922      200            200            0.0067526332   0.00019422987  0              0.02006367     94.711351      0              4573272.2      1.1971759e-13  0              4.0352706    
    700000   12727.922      200            200            0.0047998223   0.00029605664  0              0.01410341     3.6182777      0              174713.68      1.1971759e-13  0              4.0360299    
    800000   12727.922      200            200            0.0053946157   0.00029839782  0              0.015885449    4.1019494      0              198068.46      1.1971759e-13  0              4.035784     
    900000   12727.922      200            200            0.0054619863   0.00028941654  0              0.016096542    0.096643697    0              4666.5783      1.1971759e-13  0              4.0357579    
   1000000   12727.922      200            200            0.0053614536   0.00028974416  0              0.015794617    0.035314348    0              1705.2035      1.1971759e-13  0              4.0357977    
   1100000   12727.922      200            200            0.0053794407   0.00028963598  0              0.015848686    0.0084933812   0              410.11498      1.1971759e-13  0              4.0357903    
   1200000   12727.922      200            200            0.0053880622   0.00028956985  0              0.015874617    2.4408384e-07  0              0.011785935    1.1971759e-13  0              4.0357869    
   1300000   12727.922      200            200            0.005383337    0.0002896082   0              0.015860403    0.00015621675  0              7.5431479      1.1971759e-13  0              4.0357888    
   1400000   12727.922      200            200            0.0053834486   0.00028960705  0              0.015860739    1.0805912e-05  0              0.52177882     1.1971759e-13  0              4.0357888    
   1500000   12727.922      200            200            0.0053840526   0.00028960236  0              0.015862555    6.3188215e-07  0              0.030511327    1.1971759e-13  0              4.0357885    
   1600000   12727.922      200            200            0.0053838756   0.00028960377  0              0.015862023    4.2813064e-07  0              0.020672897    1.1971759e-13  0              4.0357886    
   1700000   12727.922      200            200            0.005383842    0.00028960402  0              0.015861922    4.7490052e-09  0              0.00022931247  1.1971759e-13  0              4.0357886    
   1800000   12727.922      200            200            0.0053838748   0.00028960377  0              0.015862021    4.8021032e-09  0              0.00023187638  1.1971759e-13  0              4.0357886    
   1900000   12727.922      200            200            0.0053838705   0.0002896038   0              0.015862008    7.7503831e-10  0              3.7423826e-05  1.1971759e-13  0              4.0357886    
   2000000   12727.922      200            200            0.0053838672   0.00028960383  0              0.015861998    3.3417721e-12  0              1.6136221e-07  1.1971759e-13  0              4.0357886    
   2100000   12727.922      200            200            0.0053838687   0.00028960382  0              0.015862002    1.7851004e-11  0              8.6196112e-07  1.1971759e-13  0              4.0357886    
   2200000   12727.922      200            200            0.0053838687   0.00028960382  0              0.015862002    7.8866534e-13  0              3.8081827e-08  1.1971759e-13  0              4.0357886    
   2300000   12727.922      200            200            0.0053838685   0.00028960382  0              0.015862002    1.0966939e-13  0              5.2955422e-09  1.1971759e-13  0              4.0357886    
   2400000   12727.922      200            200            0.0053838686   0.00028960382  0              0.015862002    4.3099588e-14  0              2.0811249e-09  1.1971759e-13  0              4.0357886    
   2500000   12727.922      200            200            0.0053838686   0.00028960382  0              0.015862002    1.2762883e-16  0              6.1627394e-12  1.1971759e-13  0              4.0357886    
   2600000   12727.922      200            200            0.0053838686   0.00028960382  0              0.015862002    6.9047062e-16  0              3.3340355e-11  1.1971759e-13  0              4.0357886    
   2700000   12727.922      200            200            0.0053838686   0.00028960382  0              0.015862002    3.5682796e-20  0              1.7229945e-15  1.1971759e-13  0              4.0357886    
   2800000   12727.922      200            200            0.0053838686   0.00028960382  0              0.015862002    3.5309879e-17  0              1.7049877e-12  1.1971759e-13  0              4.0357886    
   2900000   12727.922      200            200            0.0053838686   0.00028960382  0              0.015862002    3.3935436e-17  0              1.6386207e-12  1.1971759e-13  0              4.0357886    
   3000000   12727.922      200            200            0.0053838686   0.00028960383  0              0.015862002    5.9251812e-18  0              2.8610579e-13  1.1971759e-13  0              4.0357886    
Loop time of 695.692 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3725788.694 ns/day, 0.000 hours/ns, 4312.255 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.14     | 237.04     | 294.17     | 365.4 | 34.07
Neigh   | 1.1703     | 1.1911     | 1.2119     |   1.6 |  0.17
Comm    | 23.722     | 81.254     | 138.58     | 622.2 | 11.68
Output  | 0.40118    | 0.40184    | 0.40251    |   0.1 |  0.06
Modify  | 201.69     | 270.45     | 339.49     | 416.8 | 38.87
Other   |            | 105.4      |            |       | 15.15

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1453.25 ave        2158 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5813
Ave neighs/atom = 1.1623675
Neighbor list builds = 121
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.09                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 151.905902807601
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.19
  ghost atom cutoff = 5.19
  binsize = 2.595, bins = 4905 78 78
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.19 | 45.2 | 45.21 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.3717576e-14  1.6115273e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00050912129  1.6115273e-13  0             -0.0015273639   92570.963      0              4.4699205e+09  1.1971759e-13  0              4.4835876    
    200000   12727.922      200            200            0.0076281293   0.00055237161  0              0.022332016    258547.72      0              1.2484344e+10  1.1971759e-13  0              4.0398063    
    300000   12727.922      200            200            0.018338976   -0.0012203722   0              0.056237301    51018.905      0              2.4635203e+09  1.1971759e-13  0              4.0369983    
    400000   12727.922      200            200           -3.4955302e-05  1.6115273e-13  0             -0.00010486591  356.66132      0              17221899       1.1971759e-13  0              4.0477707    
    500000   12727.922      200            200            0.0015869772   0.00021054307  0              0.0045503886   179.18138      0              8652027.6      1.1971759e-13  0              4.0427276    
    600000   12727.922      200            200            0.0070056459   6.8709313e-05  0              0.020948228    34.902715      0              1685327.2      1.1971759e-13  0              4.0401701    
    700000   12727.922      200            200            0.0048972477   0.00028995039  0              0.014401793    11.449768      0              552868.34      1.1971759e-13  0              4.0409938    
    800000   12727.922      200            200            0.0053180414   0.00028569719  0              0.015668427    3.732315       0              180220.13      1.1971759e-13  0              4.0408175    
    900000   12727.922      200            200            0.0054756917   0.00028846404  0              0.016138611    0.0018889257   0              91.209459      1.1971759e-13  0              4.0407568    
   1000000   12727.922      200            200            0.0053776895   0.00028793672  0              0.015845132    0.06209339     0              2998.2676      1.1971759e-13  0              4.0407957    
   1100000   12727.922      200            200            0.0053814241   0.00028790566  0              0.015856367    0.0046256241   0              223.35483      1.1971759e-13  0              4.040794     
   1200000   12727.922      200            200            0.0053935564   0.00028781039  0              0.015892859    0.00027214194  0              13.14076       1.1971759e-13  0              4.0407892    
   1300000   12727.922      200            200            0.0053900356   0.00028784052  0              0.015882266    0.00017520084  0              8.4598216      1.1971759e-13  0              4.0407906    
   1400000   12727.922      200            200            0.0053892851   0.00028784639  0              0.015880009    1.1754093e-06  0              0.05675631     1.1971759e-13  0              4.0407909    
   1500000   12727.922      200            200            0.0053899444   0.000287841    0              0.015881992    2.2673365e-06  0              0.10948156     1.1971759e-13  0              4.0407906    
   1600000   12727.922      200            200            0.0053898809   0.00028784156  0              0.015881801    2.709747e-07   0              0.013084399    1.1971759e-13  0              4.0407906    
   1700000   12727.922      200            200            0.0053898083   0.00028784215  0              0.015881583    5.2342688e-09  0              0.00025274411  1.1971759e-13  0              4.0407907    
   1800000   12727.922      200            200            0.0053898349   0.00028784193  0              0.015881663    7.7194889e-09  0              0.00037274649  1.1971759e-13  0              4.0407907    
   1900000   12727.922      200            200            0.005389838    0.0002878419   0              0.015881672    1.4836358e-10  0              7.1639464e-06  1.1971759e-13  0              4.0407907    
   2000000   12727.922      200            200            0.0053898337   0.00028784194  0              0.015881659    7.6650065e-11  0              3.7011573e-06  1.1971759e-13  0              4.0407907    
   2100000   12727.922      200            200            0.0053898343   0.00028784193  0              0.015881661    1.4558995e-11  0              7.0300178e-07  1.1971759e-13  0              4.0407907    
   2200000   12727.922      200            200            0.0053898347   0.00028784193  0              0.015881662    4.9774509e-14  0              2.4034329e-09  1.1971759e-13  0              4.0407907    
   2300000   12727.922      200            200            0.0053898346   0.00028784193  0              0.015881662    3.2269614e-13  0              1.5581842e-08  1.1971759e-13  0              4.0407907    
   2400000   12727.922      200            200            0.0053898345   0.00028784193  0              0.015881662    1.1778892e-14  0              5.6876053e-10  1.1971759e-13  0              4.0407907    
   2500000   12727.922      200            200            0.0053898346   0.00028784193  0              0.015881662    2.3350905e-15  0              1.1275316e-10  1.1971759e-13  0              4.0407907    
   2600000   12727.922      200            200            0.0053898346   0.00028784193  0              0.015881662    6.0509288e-16  0              2.921777e-11   1.1971759e-13  0              4.0407907    
   2700000   12727.922      200            200            0.0053898346   0.00028784193  0              0.015881662    6.2582727e-17  0              3.0218959e-12  1.1971759e-13  0              4.0407907    
   2800000   12727.922      200            200            0.0053898346   0.00028784193  0              0.015881662    2.0207784e-17  0              9.7576159e-13  1.1971759e-13  0              4.0407907    
   2900000   12727.922      200            200            0.0053898346   0.00028784193  0              0.015881662    2.4814616e-17  0              1.198209e-12   1.1971759e-13  0              4.0407907    
   3000000   12727.922      200            200            0.0053898346   0.00028784193  0              0.015881662    1.2230238e-17  0              5.9055442e-13  1.1971759e-13  0              4.0407907    
Loop time of 699.17 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3707254.821 ns/day, 0.000 hours/ns, 4290.804 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.08     | 237.96     | 297.2      | 370.8 | 34.04
Neigh   | 1.2301     | 1.2531     | 1.2759     |   1.6 |  0.18
Comm    | 23.794     | 82.902     | 141.94     | 621.4 | 11.86
Output  | 0.4017     | 0.40239    | 0.40307    |   0.1 |  0.06
Modify  | 201.99     | 271.65     | 339.99     | 414.2 | 38.85
Other   |            | 105        |            |       | 15.02

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1459.75 ave        2171 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5839
Ave neighs/atom = 1.1675665
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.1                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 152.802982600158
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.2
  ghost atom cutoff = 5.2
  binsize = 2.6, bins = 4896 77 77
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.33 | 44.34 | 44.36 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.4724966e-14  1.641749e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00050143919  1.641749e-13   0             -0.0015043176   88567.628      0              4.2766138e+09  1.1971759e-13  0              4.4897949    
    200000   12727.922      200            200           -0.00033504651  0.00013077842  0             -0.001135918    253453.53      0              1.2238364e+10  1.1971759e-13  0              4.049117     
    300000   12727.922      200            200            0.0094148898   0.00040248339  0              0.027842186    58351.454      0              2.8175829e+09  1.1971759e-13  0              4.0443205    
    400000   12727.922      200            200           -1.5274525e-05  1.641749e-13   0             -4.5823574e-05  66.380633      0              3205283.2      1.1971759e-13  0              4.0529164    
    500000   12727.922      200            200            0.0014595431   0.0002047907   0              0.0041738385   23.725416      0              1145615.4      1.1971759e-13  0              4.0478367    
    600000   12727.922      200            200            0.0071253611  -3.9574124e-06  0              0.021380041    2.4036327      0              116062.82      1.1971759e-13  0              4.0451232    
    700000   12727.922      200            200            0.0050431217   0.00028670169  0              0.014842663    20.675553      0              998348.46      1.1971759e-13  0              4.0459384    
    800000   12727.922      200            200            0.0052533338   0.00028234304  0              0.015477658    2.6059977      0              125834.3       1.1971759e-13  0              4.0458478    
    900000   12727.922      200            200            0.0054779634   0.00028873634  0              0.016145154    0.052530003    0              2536.4858      1.1971759e-13  0              4.0457605    
   1000000   12727.922      200            200            0.0053964909   0.0002880255   0              0.015901447    0.07338127     0              3543.3189      1.1971759e-13  0              4.0457929    
   1100000   12727.922      200            200            0.0053855757   0.00028809762  0              0.01586863     0.0010037518   0              48.467581      1.1971759e-13  0              4.045797     
   1200000   12727.922      200            200            0.0053989371   0.00028800125  0              0.01590881     0.00084459117  0              40.782285      1.1971759e-13  0              4.0457917    
   1300000   12727.922      200            200            0.0053973341   0.00028801455  0              0.015903988    0.00011948763  0              5.7696302      1.1971759e-13  0              4.0457924    
   1400000   12727.922      200            200            0.0053959098   0.00028802535  0              0.015899704    1.9228032e-06  0              0.092845284    1.1971759e-13  0              4.045793     
   1500000   12727.922      200            200            0.0053964522   0.00028802114  0              0.015901336    3.1869206e-06  0              0.15388499     1.1971759e-13  0              4.0457927    
   1600000   12727.922      200            200            0.0053965187   0.00028802067  0              0.015901535    5.0279632e-08  0              0.0024278235   1.1971759e-13  0              4.0457927    
   1700000   12727.922      200            200            0.0053964306   0.00028802134  0              0.015901271    3.5335614e-08  0              0.0017062303   1.1971759e-13  0              4.0457927    
   1800000   12727.922      200            200            0.005396442    0.00028802125  0              0.015901305    5.3706607e-09  0              0.00025932998  1.1971759e-13  0              4.0457927    
   1900000   12727.922      200            200            0.0053964512   0.00028802118  0              0.015901332    7.0193146e-11  0              3.3893758e-06  1.1971759e-13  0              4.0457927    
   2000000   12727.922      200            200            0.0053964475   0.00028802121  0              0.015901321    1.382305e-10   0              6.6746562e-06  1.1971759e-13  0              4.0457927    
   2100000   12727.922      200            200            0.0053964471   0.00028802121  0              0.01590132     2.4850994e-12  0              1.1999656e-07  1.1971759e-13  0              4.0457927    
   2200000   12727.922      200            200            0.0053964477   0.00028802121  0              0.015901322    1.4794093e-12  0              7.1435379e-08  1.1971759e-13  0              4.0457927    
   2300000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    2.3868061e-13  0              1.1525032e-08  1.1971759e-13  0              4.0457927    
   2400000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    2.8020244e-15  0              1.3529973e-10  1.1971759e-13  0              4.0457927    
   2500000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    5.9513085e-15  0              2.8736739e-10  1.1971759e-13  0              4.0457927    
   2600000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    5.3951008e-17  0              2.6051011e-12  1.1971759e-13  0              4.0457927    
   2700000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    9.7887245e-17  0              4.7266247e-12  1.1971759e-13  0              4.0457927    
   2800000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    2.2946323e-17  0              1.1079958e-12  1.1971759e-13  0              4.0457927    
   2900000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    3.9280089e-17  0              1.8966949e-12  1.1971759e-13  0              4.0457927    
   3000000   12727.922      200            200            0.0053964476   0.00028802121  0              0.015901322    1.1598173e-17  0              5.6003427e-13  1.1971759e-13  0              4.0457927    
Loop time of 702.295 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3690754.945 ns/day, 0.000 hours/ns, 4271.707 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.44     | 238.47     | 297.02     | 372.6 | 33.96
Neigh   | 1.2067     | 1.2278     | 1.2493     |   1.6 |  0.17
Comm    | 25.778     | 83.083     | 141.98     | 626.4 | 11.83
Output  | 0.3973     | 0.39796    | 0.39862    |   0.1 |  0.06
Modify  | 203.1      | 273.6      | 342.5      | 416.3 | 38.96
Other   |            | 105.5      |            |       | 15.02

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1465.25 ave        2182 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5861
Ave neighs/atom = 1.1719656
Neighbor list builds = 127
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.11                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 153.703587259672
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.21
  ghost atom cutoff = 5.21
  binsize = 2.605, bins = 4886 77 77
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.28 | 44.28 | 44.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.5739764e-14  1.6721929e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00049360255  1.6721929e-13  0             -0.0014808076   84654.842      0              4.0876793e+09  1.1971759e-13  0              4.4959638    
    200000   12727.922      200            200           -0.00060633877  1.6721929e-13  0             -0.0018190163   243327.01      0              1.1749391e+10  1.1971759e-13  0              4.0583613    
    300000   12727.922      200            200            0.0029962717   0.00047030543  0              0.0085185096   58690.501      0              2.8339543e+09  1.1971759e-13  0              4.0517236    
    400000   12727.922      200            200            4.7263076e-06  1.6721929e-13  0              1.4178923e-05  6.6211552      0              319711.89      1.1971759e-13  0              4.0579475    
    500000   12727.922      200            200            0.0014649688   0.0001955569   0              0.0041993495   14.397503      0              695203.9       1.1971759e-13  0              4.0528451    
    600000   12727.922      200            200            0.0070983403  -9.5650428e-06  0              0.021304586    8.661344       0              418225.31      1.1971759e-13  0              4.0501343    
    700000   12727.922      200            200            0.0052207979   0.00027074495  0              0.015391649    27.847151      0              1344639.3      1.1971759e-13  0              4.0508692    
    800000   12727.922      200            200            0.0052063813   0.00028211949  0              0.015337024    1.2336847      0              59570.217      1.1971759e-13  0              4.0508716    
    900000   12727.922      200            200            0.0054693146   0.00028999442  0              0.016117949    0.22033354     0              10639.118      1.1971759e-13  0              4.0507686    
   1000000   12727.922      200            200            0.0054155924   0.00028900672  0              0.01595777     0.062325289    0              3009.4652      1.1971759e-13  0              4.0507901    
   1100000   12727.922      200            200            0.0053919928   0.00028917292  0              0.015886805    0.00010471133  0              5.0561356      1.1971759e-13  0              4.0507993    
   1200000   12727.922      200            200            0.0054041083   0.00028909201  0              0.015923233    0.0012701138   0              61.329249      1.1971759e-13  0              4.0507945    
   1300000   12727.922      200            200            0.0054047274   0.00028908817  0              0.015925094    3.7550288e-05  0              1.813169       1.1971759e-13  0              4.0507943    
   1400000   12727.922      200            200            0.0054029715   0.00028910086  0              0.015919814    1.219131e-05   0              0.58867471     1.1971759e-13  0              4.050795     
   1500000   12727.922      200            200            0.0054032581   0.00028909872  0              0.015920675    2.4241414e-06  0              0.11705311     1.1971759e-13  0              4.0507948    
   1600000   12727.922      200            200            0.0054034333   0.00028909748  0              0.015921202    1.9813501e-08  0              0.00095672308  1.1971759e-13  0              4.0507948    
   1700000   12727.922      200            200            0.005403358    0.00028909803  0              0.015920976    5.688908e-08   0              0.0027469701   1.1971759e-13  0              4.0507948    
   1800000   12727.922      200            200            0.0054033503   0.00028909808  0              0.015920953    9.8063236e-10  0              4.7351227e-05  1.1971759e-13  0              4.0507948    
   1900000   12727.922      200            200            0.005403362    0.00028909799  0              0.015920988    6.455891e-10   0              3.1173187e-05  1.1971759e-13  0              4.0507948    
   2000000   12727.922      200            200            0.0054033606   0.00028909801  0              0.015920984    9.1191276e-11  0              4.4033003e-06  1.1971759e-13  0              4.0507948    
   2100000   12727.922      200            200            0.0054033593   0.00028909801  0              0.01592098     1.9566754e-12  0              9.4480851e-08  1.1971759e-13  0              4.0507948    
   2200000   12727.922      200            200            0.0054033598   0.00028909801  0              0.015920981    2.48162e-12    0              1.1982855e-07  1.1971759e-13  0              4.0507948    
   2300000   12727.922      200            200            0.0054033599   0.00028909801  0              0.015920982    2.1539733e-14  0              1.0400766e-09  1.1971759e-13  0              4.0507948    
   2400000   12727.922      200            200            0.0054033598   0.00028909801  0              0.015920981    3.2616715e-14  0              1.5749444e-09  1.1971759e-13  0              4.0507948    
   2500000   12727.922      200            200            0.0054033598   0.00028909801  0              0.015920981    3.4522738e-15  0              1.6669795e-10  1.1971759e-13  0              4.0507948    
   2600000   12727.922      200            200            0.0054033598   0.00028909801  0              0.015920981    2.5116351e-16  0              1.2127787e-11  1.1971759e-13  0              4.0507948    
   2700000   12727.922      200            200            0.0054033598   0.00028909801  0              0.015920981    1.5805043e-17  0              7.6316895e-13  1.1971759e-13  0              4.0507948    
   2800000   12727.922      200            200            0.0054033598   0.00028909801  0              0.015920981    1.1019266e-17  0              5.3208091e-13  1.1971759e-13  0              4.0507948    
   2900000   12727.922      200            200            0.0054033598   0.00028909801  0              0.015920981    7.5790235e-18  0              3.6596392e-13  1.1971759e-13  0              4.0507948    
   3000000   12727.922      200            200            0.0054033598   0.00028909799  0              0.015920981    5.6844984e-18  0              2.7448408e-13  1.1971759e-13  0              4.0507948    
Loop time of 696.107 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3723564.011 ns/day, 0.000 hours/ns, 4309.681 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.06     | 237.02     | 294.08     | 368.8 | 34.05
Neigh   | 1.1943     | 1.2124     | 1.2335     |   1.5 |  0.17
Comm    | 24.777     | 81.724     | 139.37     | 626.3 | 11.74
Output  | 0.40158    | 0.40222    | 0.40286    |   0.1 |  0.06
Modify  | 200.72     | 270.5      | 339.58     | 417.9 | 38.86
Other   |            | 105.2      |            |       | 15.12

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1470.25 ave        2192 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5881
Ave neighs/atom = 1.1759648
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.12                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 154.607723697648
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.22
  ghost atom cutoff = 5.22
  binsize = 2.61, bins = 4877 77 77
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.23 | 44.24 | 44.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.6761952e-14  1.7028586e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00048561192  1.7028586e-13  0             -0.0014568357   80832.459      0              3.9031101e+09  1.1971759e-13  0              4.502094     
    200000   12727.922      200            200           -0.00060231673  1.7028586e-13  0             -0.0018069502   233392.77      0              1.1269701e+10  1.1971759e-13  0              4.0675257    
    300000   12727.922      200            200           -8.5255115e-05  0.00010349711  0             -0.00035926246  54838.06       0              2.6479337e+09  1.1971759e-13  0              4.0590895    
    400000   12727.922      200            200            2.5044005e-05  1.7028586e-13  0              7.5132014e-05  176.26152      0              8511037.8      1.1971759e-13  0              4.0628637    
    500000   12727.922      200            200            0.0016124731   0.00021201415  0              0.0046254052   151.71558      0              7325802.3      1.1971759e-13  0              4.0577523    
    600000   12727.922      200            200            0.0069085974  -4.9712684e-06  0              0.020730763    51.191242      0              2471841.9      1.1971759e-13  0              4.0552027    
    700000   12727.922      200            200            0.0054154573   0.00024408222  0              0.01600229     30.201383      0              1458316.7      1.1971759e-13  0              4.0557929    
    800000   12727.922      200            200            0.0051815233   0.0002801952   0              0.015264375    0.23061688     0              11135.664      1.1971759e-13  0              4.0558864    
    900000   12727.922      200            200            0.0054511938   0.00029004636  0              0.016063535    0.41470938     0              20024.832      1.1971759e-13  0              4.0557803    
   1000000   12727.922      200            200            0.005432339    0.00028874269  0              0.016008274    0.035675049    0              1722.6205      1.1971759e-13  0              4.0557881    
   1100000   12727.922      200            200            0.0054000529   0.00028899918  0              0.01591116     0.0025152761   0              121.45368      1.1971759e-13  0              4.0558008    
   1200000   12727.922      200            200            0.0054087134   0.00028893874  0              0.015937201    0.0012187579   0              58.849459      1.1971759e-13  0              4.0557973    
   1300000   12727.922      200            200            0.0054113913   0.00028891941  0              0.015945255    3.5906562e-09  0              0.00017337994  1.1971759e-13  0              4.0557963    
   1400000   12727.922      200            200            0.0054097177   0.00028893201  0              0.015940221    2.2045942e-05  0              1.0645196      1.1971759e-13  0              4.0557969    
   1500000   12727.922      200            200            0.0054096782   0.00028893221  0              0.015940103    7.9041844e-07  0              0.038166478    1.1971759e-13  0              4.0557969    
   1600000   12727.922      200            200            0.0054099103   0.0002889305   0              0.0159408      2.1166892e-07  0              0.010220734    1.1971759e-13  0              4.0557969    
   1700000   12727.922      200            200            0.0054098713   0.0002889308   0              0.015940683    4.2924805e-08  0              0.0020726852   1.1971759e-13  0              4.0557969    
   1800000   12727.922      200            200            0.0054098476   0.00028893097  0              0.015940612    4.9015333e-10  0              2.366775e-05   1.1971759e-13  0              4.0557969    
   1900000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    1.025696e-09   0              4.9527187e-05  1.1971759e-13  0              4.0557969    
   2000000   12727.922      200            200            0.0054098587   0.00028893089  0              0.015940645    9.908718e-12   0              4.7845653e-07  1.1971759e-13  0              4.0557969    
   2100000   12727.922      200            200            0.0054098571   0.0002889309   0              0.01594064     1.3652949e-11  0              6.5925206e-07  1.1971759e-13  0              4.0557969    
   2200000   12727.922      200            200            0.0054098572   0.0002889309   0              0.015940641    1.2731849e-12  0              6.1477541e-08  1.1971759e-13  0              4.0557969    
   2300000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    7.5948651e-14  0              3.6672885e-09  1.1971759e-13  0              4.0557969    
   2400000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    4.2197647e-14  0              2.0375734e-09  1.1971759e-13  0              4.0557969    
   2500000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    8.4444086e-18  0              4.0775027e-13  1.1971759e-13  0              4.0557969    
   2600000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    7.8455846e-16  0              3.788352e-11   1.1971759e-13  0              4.0557969    
   2700000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    1.5405199e-17  0              7.4386193e-13  1.1971759e-13  0              4.0557969    
   2800000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    3.0477916e-17  0              1.4716695e-12  1.1971759e-13  0              4.0557969    
   2900000   12727.922      200            200            0.0054098574   0.0002889309   0              0.015940641    1.969364e-17   0              9.5093537e-13  1.1971759e-13  0              4.0557969    
   3000000   12727.922      200            200            0.0054098574   0.00028893089  0              0.015940641    6.4453325e-19  0              3.1122204e-14  1.1971759e-13  0              4.0557969    
Loop time of 702.048 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3692056.494 ns/day, 0.000 hours/ns, 4273.214 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.97     | 237.97     | 296.45     | 374.5 | 33.90
Neigh   | 1.2149     | 1.2368     | 1.2598     |   1.7 |  0.18
Comm    | 25.486     | 83.002     | 141.6      | 631.1 | 11.82
Output  | 0.40503    | 0.40568    | 0.40633    |   0.1 |  0.06
Modify  | 201.85     | 272.82     | 343.13     | 421.1 | 38.86
Other   |            | 106.6      |            |       | 15.19

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1475.25 ave        2202 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5901
Ave neighs/atom = 1.179964
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.13                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 155.515398825589
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.23
  ghost atom cutoff = 5.23
  binsize = 2.615, bins = 4868 77 77
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.15 | 44.16 | 44.18 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.7791512e-14  1.7337454e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00047746784  1.7337454e-13  0             -0.0014324035   77100.335      0              3.7228992e+09  1.1971759e-13  0              4.5081856    
    200000   12727.922      200            200           -0.00059792682  1.7337454e-13  0             -0.0017937805   223675.69      0              1.0800498e+10  1.1971759e-13  0              4.07661      
    300000   12727.922      200            200           -0.00035451808  1.7337454e-13  0             -0.0010635542   49935.912      0              2.4112265e+09  1.1971759e-13  0              4.0663625    
    400000   12727.922      200            200            4.5675206e-05  1.7337454e-13  0              0.00013702562  574.1825       0              27725218       1.1971759e-13  0              4.0676647    
    500000   12727.922      200            200            0.0019048111   0.00022485792  0              0.0054895752   415.78911      0              20076968       1.1971759e-13  0              4.0625613    
    600000   12727.922      200            200            0.0066025549   7.786345e-05   0              0.019729801    114.49558      0              5528582        1.1971759e-13  0              4.0603225    
    700000   12727.922      200            200            0.0056277685   0.00026541611  0              0.016617889    26.742944      0              1291321.1      1.1971759e-13  0              4.0607172    
    800000   12727.922      200            200            0.0051846928   0.00028419903  0              0.015269879    0.041636038    0              2010.4553      1.1971759e-13  0              4.0608908    
    900000   12727.922      200            200            0.0054291991   0.00029534305  0              0.015992254    0.53136091     0              25657.517      1.1971759e-13  0              4.0607942    
   1000000   12727.922      200            200            0.0054472708   0.00029378813  0              0.016048024    0.0096565368   0              466.2796       1.1971759e-13  0              4.0607875    
   1100000   12727.922      200            200            0.0054116419   0.00029408058  0              0.015940845    0.0065408624   0              315.83483      1.1971759e-13  0              4.0608015    
   1200000   12727.922      200            200            0.0054153112   0.00029405459  0              0.015951879    0.00073208512  0              35.349771      1.1971759e-13  0              4.0608       
   1300000   12727.922      200            200            0.0054194606   0.00029402566  0              0.015964356    3.8546878e-05  0              1.8612908      1.1971759e-13  0              4.0607984    
   1400000   12727.922      200            200            0.0054182565   0.00029403451  0              0.015960735    2.2051161e-05  0              1.0647716      1.1971759e-13  0              4.0607989    
   1500000   12727.922      200            200            0.0054179065   0.00029403692  0              0.015959682    7.3000421e-10  0              3.5249291e-05  1.1971759e-13  0              4.060799     
   1600000   12727.922      200            200            0.0054181281   0.00029403534  0              0.015960349    4.0277107e-07  0              0.019448373    1.1971759e-13  0              4.0607989    
   1700000   12727.922      200            200            0.005418137    0.00029403529  0              0.015960376    1.1087386e-08  0              0.00053537018  1.1971759e-13  0              4.0607989    
   1800000   12727.922      200            200            0.0054181057   0.00029403551  0              0.015960282    4.4989437e-09  0              0.00021723789  1.1971759e-13  0              4.0607989    
   1900000   12727.922      200            200            0.0054181099   0.00029403548  0              0.015960294    6.5729512e-10  0              3.1738429e-05  1.1971759e-13  0              4.0607989    
   2000000   12727.922      200            200            0.0054181134   0.00029403545  0              0.015960305    2.1154909e-11  0              1.0214948e-06  1.1971759e-13  0              4.0607989    
   2100000   12727.922      200            200            0.0054181122   0.00029403546  0              0.015960301    1.7882566e-11  0              8.6348512e-07  1.1971759e-13  0              4.0607989    
   2200000   12727.922      200            200            0.005418112    0.00029403546  0              0.0159603      1.2074244e-14  0              5.8302203e-10  1.1971759e-13  0              4.0607989    
   2300000   12727.922      200            200            0.0054181122   0.00029403546  0              0.015960301    3.023471e-13   0              1.4599259e-08  1.1971759e-13  0              4.0607989    
   2400000   12727.922      200            200            0.0054181122   0.00029403546  0              0.015960301    1.1756342e-14  0              5.676717e-10   1.1971759e-13  0              4.0607989    
   2500000   12727.922      200            200            0.0054181121   0.00029403546  0              0.015960301    2.95723e-15    0              1.4279405e-10  1.1971759e-13  0              4.0607989    
   2600000   12727.922      200            200            0.0054181121   0.00029403546  0              0.015960301    4.2612319e-16  0              2.0575964e-11  1.1971759e-13  0              4.0607989    
   2700000   12727.922      200            200            0.0054181121   0.00029403546  0              0.015960301    9.5162979e-17  0              4.5950797e-12  1.1971759e-13  0              4.0607989    
   2800000   12727.922      200            200            0.0054181121   0.00029403546  0              0.015960301    1.9005595e-17  0              9.1771217e-13  1.1971759e-13  0              4.0607989    
   2900000   12727.922      200            200            0.0054181121   0.00029403546  0              0.015960301    3.6804025e-18  0              1.7771347e-13  1.1971759e-13  0              4.0607989    
   3000000   12727.922      200            200            0.0054181121   0.00029403544  0              0.015960301    6.4892645e-18  0              3.1334336e-13  1.1971759e-13  0              4.0607989    
Loop time of 692.382 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3743600.560 ns/day, 0.000 hours/ns, 4332.871 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.41     | 234.6      | 290.56     | 358.9 | 33.88
Neigh   | 1.2338     | 1.2535     | 1.2745     |   1.6 |  0.18
Comm    | 24.847     | 79.816     | 136.29     | 613.5 | 11.53
Output  | 0.3997     | 0.40035    | 0.40104    |   0.1 |  0.06
Modify  | 199.41     | 270.34     | 340.46     | 419.3 | 39.04
Other   |            | 106        |            |       | 15.31

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1424.25 ave        2099 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5697
Ave neighs/atom = 1.1391722
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.14                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 156.426619554998
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.24
  ghost atom cutoff = 5.24
  binsize = 2.62, bins = 4858 77 77
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.1 | 44.1 | 44.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.8828426e-14  1.7648528e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00046917087  1.7648528e-13  0             -0.0014075126   73458.327      0              3.5470397e+09  1.1971759e-13  0              4.5142384    
    200000   12727.922      200            200           -0.00059317111  1.7648528e-13  0             -0.0017795133   214175.13      0              1.0341751e+10  1.1971759e-13  0              4.0856139    
    300000   12727.922      200            200           -0.0003411578   1.7648528e-13  0             -0.0010234734   45243.796      0              2.184661e+09   1.1971759e-13  0              4.0735329    
    400000   12727.922      200            200            6.661665e-05   1.7648528e-13  0              0.00019984995  1199.2671      0              57908318       1.1971759e-13  0              4.0723503    
    500000   12727.922      200            200            0.0023619425   0.00022581326  0              0.0068600142   765.48685      0              36962620       1.1971759e-13  0              4.0672791    
    600000   12727.922      200            200            0.0062092656   0.00020616737  0              0.01842163     176.20125      0              8508127.9      1.1971759e-13  0              4.0654828    
    700000   12727.922      200            200            0.0058190067   0.00027997329  0              0.017177047    18.72259       0              904046.85      1.1971759e-13  0              4.0656499    
    800000   12727.922      200            200            0.005214766    0.00028901233  0              0.015355286    0.7448184      0              35964.615      1.1971759e-13  0              4.0658844    
    900000   12727.922      200            200            0.0054057966   0.00030062932  0              0.015916761    0.50805478     0              24532.147      1.1971759e-13  0              4.0658088    
   1000000   12727.922      200            200            0.0054577653   0.00029951334  0              0.016073783    5.9711244e-05  0              2.8832423      1.1971759e-13  0              4.0657887    
   1100000   12727.922      200            200            0.0054246033   0.00029975745  0              0.015974053    0.0093843274   0              453.13559      1.1971759e-13  0              4.0658018    
   1200000   12727.922      200            200            0.0054226833   0.00029976675  0              0.015968283    0.00018791014  0              9.0735083      1.1971759e-13  0              4.0658025    
   1300000   12727.922      200            200            0.0054274228   0.00029973952  0              0.015982529    0.00011906166  0              5.7490614      1.1971759e-13  0              4.0658006    
   1400000   12727.922      200            200            0.0054269597   0.00029974248  0              0.015981137    1.2247408e-05  0              0.5913835      1.1971759e-13  0              4.0658008    
   1500000   12727.922      200            200            0.0054263943   0.00029974579  0              0.015979437    8.6745376e-07  0              0.041886238    1.1971759e-13  0              4.0658011    
   1600000   12727.922      200            200            0.0054265425   0.00029974489  0              0.015979883    3.736032e-07   0              0.018039962    1.1971759e-13  0              4.065801     
   1700000   12727.922      200            200            0.0054265958   0.00029974459  0              0.015980043    1.0208259e-09  0              4.929203e-05   1.1971759e-13  0              4.065801     
   1800000   12727.922      200            200            0.0054265678   0.00029974475  0              0.015979959    7.5455327e-09  0              0.00036434677  1.1971759e-13  0              4.065801     
   1900000   12727.922      200            200            0.0054265649   0.00029974477  0              0.01597995     7.9745674e-11  0              3.8506332e-06  1.1971759e-13  0              4.065801     
   2000000   12727.922      200            200            0.0054265691   0.00029974475  0              0.015979963    1.0595993e-10  0              5.1164256e-06  1.1971759e-13  0              4.065801     
   2100000   12727.922      200            200            0.0054265689   0.00029974475  0              0.015979962    7.6431196e-12  0              3.6905889e-07  1.1971759e-13  0              4.065801     
   2200000   12727.922      200            200            0.0054265683   0.00029974475  0              0.01597996     9.2382221e-13  0              4.4608068e-08  1.1971759e-13  0              4.065801     
   2300000   12727.922      200            200            0.0054265685   0.00029974475  0              0.015979961    2.6566407e-13  0              1.2827967e-08  1.1971759e-13  0              4.065801     
   2400000   12727.922      200            200            0.0054265685   0.00029974475  0              0.015979961    2.5263754e-15  0              1.2198963e-10  1.1971759e-13  0              4.065801     
   2500000   12727.922      200            200            0.0054265685   0.00029974475  0              0.015979961    5.9112239e-15  0              2.8543185e-10  1.1971759e-13  0              4.065801     
   2600000   12727.922      200            200            0.0054265685   0.00029974475  0              0.015979961    1.0184929e-18  0              4.9179379e-14  1.1971759e-13  0              4.065801     
   2700000   12727.922      200            200            0.0054265685   0.00029974475  0              0.015979961    5.103873e-17   0              2.4644776e-12  1.1971759e-13  0              4.065801     
   2800000   12727.922      200            200            0.0054265685   0.00029974475  0              0.015979961    3.3153511e-18  0              1.6008644e-13  1.1971759e-13  0              4.065801     
   2900000   12727.922      200            200            0.0054265685   0.00029974475  0              0.015979961    1.6330895e-17  0              7.8856048e-13  1.1971759e-13  0              4.065801     
   3000000   12727.922      200            200            0.0054265685   0.00029974476  0              0.015979961    1.1754638e-17  0              5.6758941e-13  1.1971759e-13  0              4.065801     
Loop time of 695.758 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3725431.808 ns/day, 0.000 hours/ns, 4311.842 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.14     | 235.43     | 291.83     | 361.9 | 33.84
Neigh   | 1.1267     | 1.1488     | 1.1703     |   1.6 |  0.17
Comm    | 23.682     | 80.41      | 137.11     | 616.0 | 11.56
Output  | 0.40082    | 0.40148    | 0.40214    |   0.1 |  0.06
Modify  | 202.75     | 272.37     | 342.72     | 420.0 | 39.15
Other   |            | 106        |            |       | 15.24

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1430.75 ave        2113 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5723
Ave neighs/atom = 1.1443711
Neighbor list builds = 120
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.15                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 157.341392797381
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.25
  ghost atom cutoff = 5.25
  binsize = 2.625, bins = 4849 77 77
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.05 | 44.06 | 44.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            5.9872677e-14  1.7961803e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00046072155  1.7961803e-13  0             -0.0013821647   69906.291      0              3.3755246e+09  1.1971759e-13  0              4.5202523    
    200000   12727.922      200            200           -0.00058805167  1.7961803e-13  0             -0.001764155    204890.43      0              9.8934257e+09  1.1971759e-13  0              4.0945372    
    300000   12727.922      200            200           -0.00032743331  1.7961803e-13  0             -0.00098229994  40789.011      0              1.9695554e+09  1.1971759e-13  0              4.0806004    
    400000   12727.922      200            200            8.7865088e-05  1.7961803e-13  0              0.00026359526  2050.402       0              99006573       1.1971759e-13  0              4.0769201    
    500000   12727.922      200            200            0.0030621443   0.00036840866  0              0.0088180243   1138.5022      0              54974197       1.1971759e-13  0              4.071917     
    600000   12727.922      200            200            0.0057557278   0.00031662879  0              0.016950555    215.5179       0              10406588       1.1971759e-13  0              4.0706698    
    700000   12727.922      200            200            0.0059717361   0.00029480087  0              0.017620408    9.2451087      0              446413.21      1.1971759e-13  0              4.070598     
    800000   12727.922      200            200            0.0052682519   0.00029103799  0              0.015513718    2.0168333      0              97385.662      1.1971759e-13  0              4.0708682    
    900000   12727.922      200            200            0.005384012    0.00030180153  0              0.015850234    0.35759332     0              17266.901      1.1971759e-13  0              4.0708222    
   1000000   12727.922      200            200            0.0054620957   0.0003017442   0              0.016084543    0.012585472    0              607.70738      1.1971759e-13  0              4.0707918    
   1100000   12727.922      200            200            0.0054367513   0.00030192164  0              0.016008332    0.0090779941   0              438.34385      1.1971759e-13  0              4.070802     
   1200000   12727.922      200            200            0.0054296787   0.00030195805  0              0.015987078    5.725663e-06   0              0.27647177     1.1971759e-13  0              4.0708047    
   1300000   12727.922      200            200            0.0054340167   0.00030193535  0              0.016000115    0.00017159082  0              8.2855064      1.1971759e-13  0              4.070803     
   1400000   12727.922      200            200            0.0054343904   0.00030193351  0              0.016001238    2.008212e-06   0              0.096969369    1.1971759e-13  0              4.0708028    
   1500000   12727.922      200            200            0.0054337588   0.00030193693  0              0.015999339    2.4629179e-06  0              0.11892549     1.1971759e-13  0              4.0708031    
   1600000   12727.922      200            200            0.0054337925   0.00030193672  0              0.015999441    1.5868855e-07  0              0.0076625024   1.1971759e-13  0              4.0708031    
   1700000   12727.922      200            200            0.0054338728   0.00030193629  0              0.015999682    2.4866503e-08  0              0.0012007144   1.1971759e-13  0              4.070803     
   1800000   12727.922      200            200            0.0054338576   0.00030193638  0              0.015999636    5.5307006e-09  0              0.00026705774  1.1971759e-13  0              4.070803     
   1900000   12727.922      200            200            0.0054338488   0.00030193642  0              0.01599961     1.2743035e-10  0              6.1531553e-06  1.1971759e-13  0              4.070803     
   2000000   12727.922      200            200            0.005433852    0.00030193641  0              0.01599962     1.3170142e-10  0              6.3593903e-06  1.1971759e-13  0              4.070803     
   2100000   12727.922      200            200            0.0054338528   0.0003019364   0              0.015999622    5.6128508e-17  0              2.7102448e-12  1.1971759e-13  0              4.070803     
   2200000   12727.922      200            200            0.0054338522   0.00030193641  0              0.01599962     2.3678294e-12  0              1.1433401e-07  1.1971759e-13  0              4.070803     
   2300000   12727.922      200            200            0.0054338522   0.00030193641  0              0.01599962     4.2158922e-14  0              2.0357035e-09  1.1971759e-13  0              4.070803     
   2400000   12727.922      200            200            0.0054338523   0.00030193641  0              0.01599962     3.2746056e-14  0              1.5811898e-09  1.1971759e-13  0              4.070803     
   2500000   12727.922      200            200            0.0054338523   0.00030193641  0              0.01599962     2.6241736e-15  0              1.2671195e-10  1.1971759e-13  0              4.070803     
   2600000   12727.922      200            200            0.0054338523   0.00030193641  0              0.01599962     4.2973644e-16  0              2.0750435e-11  1.1971759e-13  0              4.070803     
   2700000   12727.922      200            200            0.0054338523   0.00030193641  0              0.01599962     8.6751737e-20  0              4.1889309e-15  1.1971759e-13  0              4.070803     
   2800000   12727.922      200            200            0.0054338523   0.00030193641  0              0.01599962     4.0694984e-18  0              1.9650151e-13  1.1971759e-13  0              4.070803     
   2900000   12727.922      200            200            0.0054338523   0.0003019364   0              0.01599962     3.1413913e-20  0              1.5168655e-15  1.1971759e-13  0              4.070803     
   3000000   12727.922      200            200            0.0054338523   0.00030193642  0              0.01599962     7.9494392e-18  0              3.8384997e-13  1.1971759e-13  0              4.070803     
Loop time of 694.887 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3730102.770 ns/day, 0.000 hours/ns, 4317.249 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.54     | 235.15     | 290.62     | 361.2 | 33.84
Neigh   | 1.1141     | 1.1358     | 1.1582     |   1.6 |  0.16
Comm    | 23.849     | 79.966     | 135.91     | 619.4 | 11.51
Output  | 0.40055    | 0.40118    | 0.40181    |   0.1 |  0.06
Modify  | 200.4      | 271.43     | 342.67     | 425.7 | 39.06
Other   |            | 106.8      |            |       | 15.37

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1437.25 ave        2126 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5749
Ave neighs/atom = 1.1495701
Neighbor list builds = 118
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.16                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 158.259725464239
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.26
  ghost atom cutoff = 5.26
  binsize = 2.63, bins = 4840 77 77
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.97 | 43.99 | 44 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.0924247e-14  1.8277274e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00045212042  1.8277274e-13  0             -0.0013563613   66444.077      0              3.2083467e+09  1.1971759e-13  0              4.5262273    
    200000   12727.922      200            200           -0.00058257054  1.8277274e-13  0             -0.0017477116   195820.91      0              9.455491e+09   1.1971759e-13  0              4.1033797    
    300000   12727.922      200            200           -0.00031334742  1.8277274e-13  0             -0.00094004225  36570.594      0              1.7658631e+09  1.1971759e-13  0              4.0875648    
    400000   12727.922      200            200            0.0001094174   1.8277274e-13  0              0.00032825219  3126.4837      0              1.5096671e+08  1.1971759e-13  0              4.0813738    
    500000   12727.922      200            200            0.0039068855   0.00030022286  0              0.011420434    1455.5796      0              70284730       1.1971759e-13  0              4.0764915    
    600000   12727.922      200            200            0.0052361969   0.00024633465  0              0.015462256    220.37251      0              10641000       1.1971759e-13  0              4.0758674    
    700000   12727.922      200            200            0.0060611786   0.00028492013  0              0.017898616    2.0743038      0              100160.7       1.1971759e-13  0              4.0755671    
    800000   12727.922      200            200            0.0053395906   0.00028879688  0              0.015729975    3.2754722      0              158160.83      1.1971759e-13  0              4.0758444    
    900000   12727.922      200            200            0.0053675281   0.0002980243   0              0.01580456     0.16057011     0              7753.3558      1.1971759e-13  0              4.0758329    
   1000000   12727.922      200            200            0.005460165    0.00029878785  0              0.016081707    0.039369115    0              1900.9937      1.1971759e-13  0              4.0757968    
   1100000   12727.922      200            200            0.0054466377   0.00029888135  0              0.016041032    0.0058382234   0              281.90692      1.1971759e-13  0              4.0758023    
   1200000   12727.922      200            200            0.0054357933   0.00029893957  0              0.01600844     0.00032217461  0              15.556659      1.1971759e-13  0              4.0758065    
   1300000   12727.922      200            200            0.0054388376   0.00029892378  0              0.016017589    0.000150829    0              7.2829925      1.1971759e-13  0              4.0758053    
   1400000   12727.922      200            200            0.005439948    0.00029891806  0              0.016020926    1.035864e-06   0              0.050018163    1.1971759e-13  0              4.0758049    
   1500000   12727.922      200            200            0.0054394139   0.00029892093  0              0.016019321    3.1079113e-06  0              0.15006992     1.1971759e-13  0              4.0758051    
   1600000   12727.922      200            200            0.0054393254   0.00029892137  0              0.016019055    3.9769591e-09  0              0.00019203312  1.1971759e-13  0              4.0758051    
   1700000   12727.922      200            200            0.0054394071   0.00029892094  0              0.0160193      5.2612997e-08  0              0.0025404933   1.1971759e-13  0              4.0758051    
   1800000   12727.922      200            200            0.0054394097   0.00029892093  0              0.016019308    1.1855398e-09  0              5.7245475e-05  1.1971759e-13  0              4.0758051    
   1900000   12727.922      200            200            0.0054393984   0.00029892099  0              0.016019274    7.2229754e-10  0              3.4877163e-05  1.1971759e-13  0              4.0758051    
   2000000   12727.922      200            200            0.0054393993   0.00029892098  0              0.016019277    5.8717461e-11  0              2.835256e-06   1.1971759e-13  0              4.0758051    
   2100000   12727.922      200            200            0.0054394007   0.00029892098  0              0.016019281    7.4979659e-12  0              3.6204994e-07  1.1971759e-13  0              4.0758051    
   2200000   12727.922      200            200            0.0054394005   0.00029892098  0              0.01601928     1.7904391e-12  0              8.6453895e-08  1.1971759e-13  0              4.0758051    
   2300000   12727.922      200            200            0.0054394003   0.00029892098  0              0.01601928     4.7328724e-14  0              2.2853347e-09  1.1971759e-13  0              4.0758051    
   2400000   12727.922      200            200            0.0054394004   0.00029892098  0              0.01601928     4.1688039e-14  0              2.0129662e-09  1.1971759e-13  0              4.0758051    
   2500000   12727.922      200            200            0.0054394004   0.00029892098  0              0.01601928     2.3550577e-17  0              1.1371731e-12  1.1971759e-13  0              4.0758051    
   2600000   12727.922      200            200            0.0054394004   0.00029892098  0              0.01601928     7.7151737e-16  0              3.7253813e-11  1.1971759e-13  0              4.0758051    
   2700000   12727.922      200            200            0.0054394004   0.00029892098  0              0.01601928     5.1571516e-17  0              2.490204e-12   1.1971759e-13  0              4.0758051    
   2800000   12727.922      200            200            0.0054394004   0.00029892098  0              0.01601928     1.5088741e-17  0              7.2858129e-13  1.1971759e-13  0              4.0758051    
   2900000   12727.922      200            200            0.0054394004   0.00029892097  0              0.01601928     5.1769257e-18  0              2.4997521e-13  1.1971759e-13  0              4.0758051    
   3000000   12727.922      200            200            0.0054394004   0.00029892099  0              0.01601928     6.0016189e-18  0              2.897967e-13   1.1971759e-13  0              4.0758051    
Loop time of 695.607 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3726239.608 ns/day, 0.000 hours/ns, 4312.777 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.8      | 236.42     | 292.7      | 365.1 | 33.99
Neigh   | 1.08       | 1.1007     | 1.1214     |   1.6 |  0.16
Comm    | 23.694     | 80.638     | 137.26     | 625.0 | 11.59
Output  | 0.39999    | 0.40064    | 0.40129    |   0.1 |  0.06
Modify  | 200.5      | 270.29     | 340.55     | 419.8 | 38.86
Other   |            | 106.8      |            |       | 15.35

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1442.75 ave        2136 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5771
Ave neighs/atom = 1.1539692
Neighbor list builds = 116
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.17                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 159.181624467078
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.27
  ghost atom cutoff = 5.27
  binsize = 2.635, bins = 4831 76 76
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.17 | 43.18 | 43.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.198312e-14   1.8594936e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00044336803  1.8594936e-13  0             -0.0013301041   63071.544      0              3.0454991e+09  1.1971759e-13  0              4.5321631    
    200000   12727.922      200            200           -0.00057672981  1.8594936e-13  0             -0.0017301894   186965.93      0              9.0279155e+09  1.1971759e-13  0              4.1121412    
    300000   12727.922      200            200           -0.00029890302  1.8594936e-13  0             -0.00089670905  32587.622      0              1.5735396e+09  1.1971759e-13  0              4.0944256    
    400000   12727.922      200            200            0.00013127022  1.8594936e-13  0              0.00039381067  4426.402       0              2.1373511e+08  1.1971759e-13  0              4.085711     
    500000   12727.922      200            200            0.0049757347   0.00027884254  0              0.014648362    1633.6901      0              78885050       1.1971759e-13  0              4.0810251    
    600000   12727.922      200            200            0.0047791363   0.00025299718  0              0.014084412    190.59453      0              9203127.7      1.1971759e-13  0              4.0810595    
    700000   12727.922      200            200            0.0060855922   0.00027714772  0              0.017979629    0.095034021    0              4588.8528      1.1971759e-13  0              4.0805608    
    800000   12727.922      200            200            0.0054258889   0.00029584259  0              0.015981824    3.9407695      0              190285.66      1.1971759e-13  0              4.0808161    
    900000   12727.922      200            200            0.0053612406   0.00029499106  0              0.015788731    0.022032482    0              1063.8697      1.1971759e-13  0              4.0808398    
   1000000   12727.922      200            200            0.005455057    0.00029630381  0              0.016068867    0.063824276    0              3081.8459      1.1971759e-13  0              4.080803     
   1100000   12727.922      200            200            0.0054553604   0.00029630605  0              0.016069775    0.0019102797   0              92.240568      1.1971759e-13  0              4.0808031    
   1200000   12727.922      200            200            0.0054427976   0.00029636998  0              0.016032023    0.00088699649  0              42.829886      1.1971759e-13  0              4.080808     
   1300000   12727.922      200            200            0.005443939    0.00029636434  0              0.016035453    7.4908385e-05  0              3.6170578      1.1971759e-13  0              4.0808076    
   1400000   12727.922      200            200            0.0054455173   0.00029635699  0              0.016040195    1.0139393e-05  0              0.48959501     1.1971759e-13  0              4.0808069    
   1500000   12727.922      200            200            0.0054452162   0.00029635848  0              0.01603929     2.1310465e-06  0              0.10290061     1.1971759e-13  0              4.0808071    
   1600000   12727.922      200            200            0.0054450326   0.00029635933  0              0.016038739    8.4270147e-08  0              0.0040691038   1.1971759e-13  0              4.0808071    
   1700000   12727.922      200            200            0.0054450903   0.00029635905  0              0.016038912    4.9761129e-08  0              0.0024027868   1.1971759e-13  0              4.0808071    
   1800000   12727.922      200            200            0.0054451095   0.00029635897  0              0.016038969    3.2493268e-10  0              1.5689836e-05  1.1971759e-13  0              4.0808071    
   1900000   12727.922      200            200            0.0054450999   0.00029635901  0              0.016038941    9.9961988e-10  0              4.8268066e-05  1.1971759e-13  0              4.0808071    
   2000000   12727.922      200            200            0.0054450983   0.00029635902  0              0.016038936    3.015711e-13   0              1.4561789e-08  1.1971759e-13  0              4.0808071    
   2100000   12727.922      200            200            0.0054450997   0.00029635901  0              0.01603894     1.7554029e-11  0              8.4762126e-07  1.1971759e-13  0              4.0808071    
   2200000   12727.922      200            200            0.0054450998   0.00029635901  0              0.01603894     2.1824998e-13  0              1.0538511e-08  1.1971759e-13  0              4.0808071    
   2300000   12727.922      200            200            0.0054450996   0.00029635901  0              0.01603894     2.6761259e-13  0              1.2922054e-08  1.1971759e-13  0              4.0808071    
   2400000   12727.922      200            200            0.0054450996   0.00029635901  0              0.01603894     1.2811911e-14  0              6.1864131e-10  1.1971759e-13  0              4.0808071    
   2500000   12727.922      200            200            0.0054450996   0.00029635901  0              0.01603894     3.331536e-15   0              1.6086795e-10  1.1971759e-13  0              4.0808071    
   2600000   12727.922      200            200            0.0054450996   0.00029635901  0              0.01603894     2.2221786e-16  0              1.0730105e-11  1.1971759e-13  0              4.0808071    
   2700000   12727.922      200            200            0.0054450996   0.00029635901  0              0.01603894     1.0125905e-16  0              4.8894372e-12  1.1971759e-13  0              4.0808071    
   2800000   12727.922      200            200            0.0054450996   0.00029635901  0              0.01603894     3.3440029e-17  0              1.6146993e-12  1.1971759e-13  0              4.0808071    
   2900000   12727.922      200            200            0.0054450996   0.00029635901  0              0.01603894     5.9659308e-17  0              2.8807345e-12  1.1971759e-13  0              4.0808071    
   3000000   12727.922      200            200            0.0054450996   0.00029635902  0              0.01603894     9.7199501e-18  0              4.693416e-13   1.1971759e-13  0              4.0808071    
Loop time of 694.052 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3734591.568 ns/day, 0.000 hours/ns, 4322.444 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.18     | 235.71     | 292.88     | 364.2 | 33.96
Neigh   | 1.0481     | 1.0689     | 1.0901     |   1.7 |  0.15
Comm    | 23.138     | 80.656     | 137.95     | 620.7 | 11.62
Output  | 0.40118    | 0.40185    | 0.40252    |   0.1 |  0.06
Modify  | 200.93     | 270.27     | 340.7      | 418.9 | 38.94
Other   |            | 105.9      |            |       | 15.26

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1449.25 ave        2150 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5797
Ave neighs/atom = 1.1591682
Neighbor list builds = 116
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.18                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 160.107096717402
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.28
  ghost atom cutoff = 5.28
  binsize = 2.64, bins = 4822 76 76
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.11 | 43.12 | 43.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.304928e-14   1.8914784e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00043446493  1.8914784e-13  0             -0.0013033948   59788.554      0              2.8869753e+09  1.1971759e-13  0              4.5380598    
    200000   12727.922      200            200           -0.00057053154  1.8914784e-13  0             -0.0017115946   178324.85      0              8.6106688e+09  1.1971759e-13  0              4.1208215    
    300000   12727.922      200            200           -0.00028410302  1.8914784e-13  0             -0.00085230907  28839.17       0              1.3925403e+09  1.1971759e-13  0              4.1011827    
    400000   12727.922      200            200            0.0001548637   9.0063595e-08  0              0.00046450104  5949.0377      0              2.8725774e+08  1.1971759e-13  0              4.0899314    
    500000   12727.922      200            200            0.006197796    0.00021499835  0              0.01837839     1608.9274      0              77689345       1.1971759e-13  0              4.0855458    
    600000   12727.922      200            200            0.0044028799   0.00029233854  0              0.012916301    136.77814      0              6604526.7      1.1971759e-13  0              4.0862311    
    700000   12727.922      200            200            0.0060431261   0.00027435438  0              0.017855024    4.0818026      0              197095.64      1.1971759e-13  0              4.0855798    
    800000   12727.922      200            200            0.0055133068   0.00029775198  0              0.016242169    3.7011189      0              178713.78      1.1971759e-13  0              4.0857867    
    900000   12727.922      200            200            0.0053670188   0.00029339292  0              0.015807663    0.015322187    0              739.85356      1.1971759e-13  0              4.0858421    
   1000000   12727.922      200            200            0.0054486815   0.00029481443  0              0.01605123     0.070841538    0              3420.6843      1.1971759e-13  0              4.0858099    
   1100000   12727.922      200            200            0.005462549    0.00029475176  0              0.016092895    9.7995462e-06  0              0.47318502     1.1971759e-13  0              4.0858047    
   1200000   12727.922      200            200            0.0054506113   0.0002948095   0              0.016057024    0.0012586473   0              60.775576      1.1971759e-13  0              4.0858094    
   1300000   12727.922      200            200            0.0054496434   0.00029481317  0              0.016054117    9.3524148e-06  0              0.45159464     1.1971759e-13  0              4.0858097    
   1400000   12727.922      200            200            0.0054513167   0.00029480605  0              0.016059144    2.0541808e-05  0              0.99189039     1.1971759e-13  0              4.0858091    
   1500000   12727.922      200            200            0.0054513222   0.00029480609  0              0.01605916     5.5853764e-07  0              0.026969784    1.1971759e-13  0              4.0858091    
   1600000   12727.922      200            200            0.0054510973   0.00029480705  0              0.016058485    3.0522656e-07  0              0.014738298    1.1971759e-13  0              4.0858092    
   1700000   12727.922      200            200            0.0054511132   0.00029480698  0              0.016058533    1.9979542e-08  0              0.0009647406   1.1971759e-13  0              4.0858092    
   1800000   12727.922      200            200            0.0054511422   0.00029480685  0              0.01605862     4.0458138e-09  0              0.00019535787  1.1971759e-13  0              4.0858091    
   1900000   12727.922      200            200            0.0054511379   0.00029480687  0              0.016058607    5.6139679e-10  0              2.7107842e-05  1.1971759e-13  0              4.0858091    
   2000000   12727.922      200            200            0.0054511344   0.00029480689  0              0.016058596    4.5858977e-11  0              2.2143659e-06  1.1971759e-13  0              4.0858091    
   2100000   12727.922      200            200            0.0054511352   0.00029480688  0              0.016058599    1.3569546e-11  0              6.5522483e-07  1.1971759e-13  0              4.0858091    
   2200000   12727.922      200            200            0.0054511356   0.00029480688  0              0.0160586      4.0650465e-13  0              1.9628655e-08  1.1971759e-13  0              4.0858091    
   2300000   12727.922      200            200            0.0054511355   0.00029480688  0              0.0160586      2.9508527e-13  0              1.4248612e-08  1.1971759e-13  0              4.0858091    
   2400000   12727.922      200            200            0.0054511354   0.00029480688  0              0.016058599    1.841791e-15   0              8.8933497e-11  1.1971759e-13  0              4.0858091    
   2500000   12727.922      200            200            0.0054511355   0.00029480688  0              0.016058599    5.7504919e-15  0              2.7767067e-10  1.1971759e-13  0              4.0858091    
   2600000   12727.922      200            200            0.0054511355   0.00029480688  0              0.016058599    4.5838715e-17  0              2.2133875e-12  1.1971759e-13  0              4.0858091    
   2700000   12727.922      200            200            0.0054511355   0.00029480688  0              0.016058599    1.3957931e-17  0              6.7397851e-13  1.1971759e-13  0              4.0858091    
   2800000   12727.922      200            200            0.0054511355   0.00029480688  0              0.016058599    2.7214928e-17  0              1.3141115e-12  1.1971759e-13  0              4.0858091    
   2900000   12727.922      200            200            0.0054511355   0.00029480688  0              0.016058599    3.2926091e-19  0              1.5898831e-14  1.1971759e-13  0              4.0858091    
   3000000   12727.922      200            200            0.0054511355   0.0002948069   0              0.016058599    7.599453e-18   0              3.6695039e-13  1.1971759e-13  0              4.0858091    
Loop time of 697.129 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3718106.319 ns/day, 0.000 hours/ns, 4303.364 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.24     | 236.18     | 293.41     | 364.8 | 33.88
Neigh   | 1.0586     | 1.0786     | 1.099      |   1.6 |  0.15
Comm    | 23.347     | 80.955     | 138.63     | 621.4 | 11.61
Output  | 0.39898    | 0.39962    | 0.40027    |   0.1 |  0.06
Modify  | 201.95     | 271.65     | 343.32     | 420.4 | 38.97
Other   |            | 106.9      |            |       | 15.33

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1454.75 ave        2161 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5819
Ave neighs/atom = 1.1635673
Neighbor list builds = 116
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.19                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 161.036149126713
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.29
  ghost atom cutoff = 5.29
  binsize = 2.645, bins = 4813 76 76
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.07 | 43.08 | 43.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.4122712e-14  1.9236813e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00042541165  1.9236813e-13  0             -0.001276235    56594.955      0              2.7327678e+09  1.1971759e-13  0              4.5439172    
    200000   12727.922      200            200           -0.0005639778   1.9236813e-13  0             -0.0016919334   169896.99      0              8.2037177e+09  1.1971759e-13  0              4.1294202    
    300000   12727.922      200            200           -0.00026895024  1.9236813e-13  0             -0.00080685073  25324.289      0              1.2228193e+09  1.1971759e-13  0              4.1078357    
    400000   12727.922      200            200            0.00045685171 -5.5927195e-06  0              0.0013761478   7658.4581      0              3.6979953e+08  1.1971759e-13  0              4.0940354    
    500000   12727.922      200            200            0.0074537326   1.1241506e-05  0              0.022349956    1364.4852      0              65886105       1.1971759e-13  0              4.0900859    
    600000   12727.922      200            200            0.0041150722   0.00032043759  0              0.012024779    75.943978      0              3667062.9      1.1971759e-13  0              4.091369     
    700000   12727.922      200            200            0.0059404196   0.00027976427  0              0.017541494    12.354548      0              596556.93      1.1971759e-13  0              4.0906224    
    800000   12727.922      200            200            0.0055929615   0.00029666617  0              0.016482218    2.6620898      0              128542.79      1.1971759e-13  0              4.0907602    
    900000   12727.922      200            200            0.0053841176   0.00029080039  0              0.015861552    0.14294063     0              6902.0913      1.1971759e-13  0              4.0908397    
   1000000   12727.922      200            200            0.0054423507   0.00029226784  0              0.016034784    0.056076265    0              2707.7222      1.1971759e-13  0              4.0908167    
   1100000   12727.922      200            200            0.0054673048   0.00029217325  0              0.016109741    0.0014381078   0              69.44108       1.1971759e-13  0              4.0908071    
   1200000   12727.922      200            200            0.0054581891   0.00029221581  0              0.016082351    0.001147253    0              55.396742      1.1971759e-13  0              4.0908107    
   1300000   12727.922      200            200            0.0054553462   0.00029222695  0              0.016073812    1.0388516e-05  0              0.50162426     1.1971759e-13  0              4.0908118    
   1400000   12727.922      200            200            0.0054567253   0.0002922214   0              0.016077955    2.2289798e-05  0              1.0762946      1.1971759e-13  0              4.0908112    
   1500000   12727.922      200            200            0.0054570309   0.00029222021  0              0.016078873    2.9851775e-08  0              0.0014414354   1.1971759e-13  0              4.0908111    
   1600000   12727.922      200            200            0.0054568291   0.00029222104  0              0.016078266    4.1331919e-07  0              0.019957704    1.1971759e-13  0              4.0908112    
   1700000   12727.922      200            200            0.0054567992   0.00029222115  0              0.016078176    1.4828082e-10  0              7.1599499e-06  1.1971759e-13  0              4.0908112    
   1800000   12727.922      200            200            0.0054568279   0.00029222104  0              0.016078263    7.3243302e-09  0              0.00035366569  1.1971759e-13  0              4.0908112    
   1900000   12727.922      200            200            0.0054568304   0.00029222103  0              0.01607827     4.0213067e-11  0              1.9417451e-06  1.1971759e-13  0              4.0908112    
   2000000   12727.922      200            200            0.0054568264   0.00029222104  0              0.016078258    1.2396633e-10  0              5.9858906e-06  1.1971759e-13  0              4.0908112    
   2100000   12727.922      200            200            0.0054568263   0.00029222104  0              0.016078258    2.1436933e-12  0              1.0351128e-07  1.1971759e-13  0              4.0908112    
   2200000   12727.922      200            200            0.0054568268   0.00029222104  0              0.016078259    1.9946406e-12  0              9.6314056e-08  1.1971759e-13  0              4.0908112    
   2300000   12727.922      200            200            0.0054568268   0.00029222104  0              0.016078259    7.6060017e-14  0              3.672666e-09   1.1971759e-13  0              4.0908112    
   2400000   12727.922      200            200            0.0054568267   0.00029222104  0              0.016078259    3.0340162e-14  0              1.4650178e-09  1.1971759e-13  0              4.0908112    
   2500000   12727.922      200            200            0.0054568267   0.00029222104  0              0.016078259    2.0471378e-15  0              9.8848958e-11  1.1971759e-13  0              4.0908112    
   2600000   12727.922      200            200            0.0054568267   0.00029222104  0              0.016078259    6.0041694e-16  0              2.8991985e-11  1.1971759e-13  0              4.0908112    
   2700000   12727.922      200            200            0.0054568267   0.00029222104  0              0.016078259    8.6374745e-18  0              4.1707273e-13  1.1971759e-13  0              4.0908112    
   2800000   12727.922      200            200            0.0054568267   0.00029222104  0              0.016078259    1.6631355e-17  0              8.0306861e-13  1.1971759e-13  0              4.0908112    
   2900000   12727.922      200            200            0.0054568267   0.00029222104  0              0.016078259    4.9374605e-17  0              2.384123e-12   1.1971759e-13  0              4.0908112    
   3000000   12727.922      200            200            0.0054568267   0.00029222105  0              0.016078259    8.8220693e-18  0              4.2598616e-13  1.1971759e-13  0              4.0908112    
Loop time of 696.58 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3721034.499 ns/day, 0.000 hours/ns, 4306.753 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.06     | 236.87     | 294.17     | 367.9 | 34.00
Neigh   | 1.0914     | 1.1102     | 1.1283     |   1.7 |  0.16
Comm    | 23.061     | 80.94      | 137.63     | 629.3 | 11.62
Output  | 0.39899    | 0.39965    | 0.40031    |   0.1 |  0.06
Modify  | 201.61     | 271        | 340.95     | 420.0 | 38.90
Other   |            | 106.3      |            |       | 15.26

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1460.75 ave        2172 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5843
Ave neighs/atom = 1.1683663
Neighbor list builds = 120
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.2                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 161.968788606516
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.3
  ghost atom cutoff = 5.3
  binsize = 2.65, bins = 4803 76 76
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.99 | 43 | 43.01 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.5203398e-14  1.9561019e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00041620877  1.9561019e-13  0             -0.0012486263   53490.618      0              2.5828705e+09  1.1971759e-13  0              4.5497352    
    200000   12727.922      200            200           -0.00055707067  1.9561019e-13  0             -0.001671212    161681.75      0              7.807033e+09   1.1971759e-13  0              4.1379371    
    300000   12727.922      200            200           -0.00025344763  1.9561019e-13  0             -0.0007603429   22042.067      0              1.0643325e+09  1.1971759e-13  0              4.1143843    
    400000   12727.922      200            200            0.001374143   -2.9558238e-05  0              0.0041519872   9351.4997      0              4.5155045e+08  1.1971759e-13  0              4.0980293    
    500000   12727.922      200            200            0.0086613003  -0.00019042413  0              0.026174325    951.841        0              45960996       1.1971759e-13  0              4.0946805    
    600000   12727.922      200            200            0.003911461    0.00028433659  0              0.011450046    26.101072      0              1260327.4      1.1971759e-13  0              4.0964633    
    700000   12727.922      200            200            0.0057955217   0.00030814443  0              0.017078421    21.496924      0              1038009.5      1.1971759e-13  0              4.0956844    
    800000   12727.922      200            200            0.0056566604   0.00029551675  0              0.016674464    1.3048015      0              63004.195      1.1971759e-13  0              4.0957398    
    900000   12727.922      200            200            0.0054117599   0.00028947571  0              0.015945804    0.33516985     0              16184.152      1.1971759e-13  0              4.0958334    
   1000000   12727.922      200            200            0.005438767    0.00029094855  0              0.016025352    0.028633343    0              1382.6017      1.1971759e-13  0              4.0958225    
   1100000   12727.922      200            200            0.0054705483   0.00029084338  0              0.016120802    0.0051757888   0              249.92032      1.1971759e-13  0              4.0958102    
   1200000   12727.922      200            200            0.0054659014   0.00029086573  0              0.016106839    0.00063958531  0              30.883286      1.1971759e-13  0              4.0958121    
   1300000   12727.922      200            200            0.0054618043   0.00029088266  0              0.01609453     7.6507808e-05  0              3.6942882      1.1971759e-13  0              4.0958136    
   1400000   12727.922      200            200            0.0054625741   0.00029087943  0              0.016096843    1.3724767e-05  0              0.66271988     1.1971759e-13  0              4.0958133    
   1500000   12727.922      200            200            0.0054630964   0.00029087732  0              0.016098412    1.0843238e-06  0              0.052358118    1.1971759e-13  0              4.0958131    
   1600000   12727.922      200            200            0.0054629744   0.00029087784  0              0.016098045    2.8535099e-07  0              0.013778578    1.1971759e-13  0              4.0958132    
   1700000   12727.922      200            200            0.0054629087   0.00029087811  0              0.016097848    1.4553222e-08  0              0.00070272301  1.1971759e-13  0              4.0958132    
   1800000   12727.922      200            200            0.0054629274   0.00029087803  0              0.016097904    5.7716418e-09  0              0.00027869193  1.1971759e-13  0              4.0958132    
   1900000   12727.922      200            200            0.0054629356   0.00029087799  0              0.016097929    1.8150981e-10  0              8.7644591e-06  1.1971759e-13  0              4.0958132    
   2000000   12727.922      200            200            0.0054629328   0.00029087801  0              0.01609792     1.1394611e-10  0              5.5020498e-06  1.1971759e-13  0              4.0958132    
   2100000   12727.922      200            200            0.0054629318   0.00029087801  0              0.016097917    2.0354038e-12  0              9.8282367e-08  1.1971759e-13  0              4.0958132    
   2200000   12727.922      200            200            0.0054629322   0.00029087801  0              0.016097919    2.1979828e-12  0              1.0613272e-07  1.1971759e-13  0              4.0958132    
   2300000   12727.922      200            200            0.0054629323   0.00029087801  0              0.016097919    2.0680305e-14  0              9.9857793e-10  1.1971759e-13  0              4.0958132    
   2400000   12727.922      200            200            0.0054629323   0.00029087801  0              0.016097919    4.1546094e-14  0              2.0061122e-09  1.1971759e-13  0              4.0958132    
   2500000   12727.922      200            200            0.0054629322   0.00029087801  0              0.016097919    1.5731711e-16  0              7.5962802e-12  1.1971759e-13  0              4.0958132    
   2600000   12727.922      200            200            0.0054629323   0.00029087801  0              0.016097919    6.571794e-16   0              3.1732841e-11  1.1971759e-13  0              4.0958132    
   2700000   12727.922      200            200            0.0054629323   0.00029087801  0              0.016097919    9.380978e-17   0              4.5297385e-12  1.1971759e-13  0              4.0958132    
   2800000   12727.922      200            200            0.0054629323   0.00029087801  0              0.016097919    1.6439607e-19  0              7.9380977e-15  1.1971759e-13  0              4.0958132    
   2900000   12727.922      200            200            0.0054629323   0.00029087801  0              0.016097919    1.7421888e-17  0              8.4124064e-13  1.1971759e-13  0              4.0958132    
   3000000   12727.922      200            200            0.0054629323   0.000290878    0              0.016097919    1.2488293e-17  0              6.0301497e-13  1.1971759e-13  0              4.0958132    
Loop time of 697.611 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3715538.475 ns/day, 0.000 hours/ns, 4300.392 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.91     | 237.39     | 294.83     | 368.6 | 34.03
Neigh   | 1.1316     | 1.1522     | 1.1731     |   1.7 |  0.17
Comm    | 23.649     | 81.559     | 139.31     | 627.4 | 11.69
Output  | 0.40051    | 0.40116    | 0.40183    |   0.1 |  0.06
Modify  | 203.4      | 272.04     | 340.98     | 416.0 | 39.00
Other   |            | 105.1      |            |       | 15.06

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1465.75 ave        2183 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5863
Ave neighs/atom = 1.1723655
Neighbor list builds = 124
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.21                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 162.905022068315
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.31
  ghost atom cutoff = 5.31
  binsize = 2.655, bins = 4794 76 76
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.94 | 42.94 | 42.94 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.6291324e-14  1.9887397e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.0004068568   1.9887397e-13  0             -0.0012205704   50475.387      0              2.4372758e+09  1.1971759e-13  0              4.5555136    
    200000   12727.922      200            200           -0.00054981219  1.9887397e-13  0             -0.0016494366   153678.42      0              7.4205808e+09  1.1971759e-13  0              4.1463721    
    300000   12727.922      200            200           -0.00023759793  1.9887397e-13  0             -0.00071279378  18991.545      0              9.1703372e+08  1.1971759e-13  0              4.1208282    
    400000   12727.922      200            200            0.0031098685   5.4566604e-05  0              0.0092750389   10662.929      0              5.148747e+08   1.1971759e-13  0              4.1019334    
    500000   12727.922      200            200            0.0096729392  -0.00035864835  0              0.029377466    489.59446      0              23640764       1.1971759e-13  0              4.0993632    
    600000   12727.922      200            200            0.0038345835   0.00029068414  0              0.011213066    1.318234       0              63652.803      1.1971759e-13  0              4.1015072    
    700000   12727.922      200            200            0.0056063298   0.00029824694  0              0.016520742    27.803689      0              1342540.6      1.1971759e-13  0              4.1007594    
    800000   12727.922      200            200            0.0056975218   0.00029577047  0              0.016796795    0.2648905      0              12790.614      1.1971759e-13  0              4.1007285    
    900000   12727.922      200            200            0.0054472349   0.00029012305  0              0.016051582    0.48739548     0              23534.583      1.1971759e-13  0              4.1008243    
   1000000   12727.922      200            200            0.0054397858   0.00029167351  0              0.016027684    0.0055038189   0              265.75972      1.1971759e-13  0              4.1008268    
   1100000   12727.922      200            200            0.0054730685   0.00029158245  0              0.016127623    0.0085864478   0              414.60884      1.1971759e-13  0              4.1008138    
   1200000   12727.922      200            200            0.0054736882   0.00029158091  0              0.016129484    0.00013192125  0              6.370005       1.1971759e-13  0              4.1008137    
   1300000   12727.922      200            200            0.005469211    0.0002915993   0              0.016116034    0.00014984756  0              7.2356023      1.1971759e-13  0              4.1008154    
   1400000   12727.922      200            200            0.005469202    0.0002915992   0              0.016116007    3.0345471e-06  0              0.14652742     1.1971759e-13  0              4.1008154    
   1500000   12727.922      200            200            0.0054698028   0.00029159683  0              0.016117811    2.6038457e-06  0              0.12573039     1.1971759e-13  0              4.1008152    
   1600000   12727.922      200            200            0.0054697941   0.00029159689  0              0.016117785    6.7727645e-08  0              0.0032703256   1.1971759e-13  0              4.1008152    
   1700000   12727.922      200            200            0.0054697136   0.0002915972   0              0.016117544    4.5030422e-08  0              0.0021743579   1.1971759e-13  0              4.1008152    
   1800000   12727.922      200            200            0.0054697161   0.00029159719  0              0.016117551    1.4748127e-09  0              7.1213429e-05  1.1971759e-13  0              4.1008152    
   1900000   12727.922      200            200            0.0054697269   0.00029159715  0              0.016117583    7.749518e-10   0              3.7419649e-05  1.1971759e-13  0              4.1008152    
   2000000   12727.922      200            200            0.0054697264   0.00029159715  0              0.016117582    3.1461703e-11  0              1.519173e-06   1.1971759e-13  0              4.1008152    
   2100000   12727.922      200            200            0.0054697249   0.00029159716  0              0.016117578    1.3267966e-11  0              6.406626e-07   1.1971759e-13  0              4.1008152    
   2200000   12727.922      200            200            0.005469725    0.00029159716  0              0.016117578    6.6031506e-13  0              3.1884251e-08  1.1971759e-13  0              4.1008152    
   2300000   12727.922      200            200            0.0054697252   0.00029159716  0              0.016117578    2.2669337e-13  0              1.0946211e-08  1.1971759e-13  0              4.1008152    
   2400000   12727.922      200            200            0.0054697252   0.00029159716  0              0.016117578    1.3233741e-14  0              6.3901001e-10  1.1971759e-13  0              4.1008152    
   2500000   12727.922      200            200            0.0054697252   0.00029159716  0              0.016117578    3.7989879e-15  0              1.8343953e-10  1.1971759e-13  0              4.1008152    
   2600000   12727.922      200            200            0.0054697252   0.00029159716  0              0.016117578    1.2330258e-16  0              5.9538404e-12  1.1971759e-13  0              4.1008152    
   2700000   12727.922      200            200            0.0054697252   0.00029159716  0              0.016117578    6.9145529e-17  0              3.3387901e-12  1.1971759e-13  0              4.1008152    
   2800000   12727.922      200            200            0.0054697252   0.00029159716  0              0.016117578    5.1717163e-19  0              2.4972367e-14  1.1971759e-13  0              4.1008152    
   2900000   12727.922      200            200            0.0054697252   0.00029159716  0              0.016117578    3.1491717e-17  0              1.5206223e-12  1.1971759e-13  0              4.1008152    
   3000000   12727.922      200            200            0.0054697252   0.00029159715  0              0.016117578    1.1081879e-17  0              5.3510425e-13  1.1971759e-13  0              4.1008152    
Loop time of 699.083 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3707712.830 ns/day, 0.000 hours/ns, 4291.334 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 181.17     | 238.52     | 295.79     | 368.3 | 34.12
Neigh   | 1.138      | 1.1597     | 1.1816     |   1.7 |  0.17
Comm    | 24.945     | 81.958     | 138.85     | 626.3 | 11.72
Output  | 0.42282    | 0.42346    | 0.42411    |   0.1 |  0.06
Modify  | 201.26     | 271.43     | 340.69     | 419.4 | 38.83
Other   |            | 105.6      |            |       | 15.10

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1471.25 ave        2194 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5885
Ave neighs/atom = 1.1767646
Neighbor list builds = 126
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.22                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 163.844856423614
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.32
  ghost atom cutoff = 5.32
  binsize = 2.66, bins = 4785 76 76
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.89 | 42.9 | 42.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.7386475e-14  2.0215943e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.0003973563   2.0215943e-13  0             -0.0011920689   47549.132      0              2.2959774e+09  1.1971759e-13  0              4.5612525    
    200000   12727.922      200            200           -0.00054220445  2.0215943e-13  0             -0.0016266134   145886.39      0              7.0443317e+09  1.1971759e-13  0              4.1547249    
    300000   12727.922      200            200           -0.00022140412  2.0215943e-13  0             -0.00066421237  16171.819      0              7.8087925e+08  1.1971759e-13  0              4.127167     
    400000   12727.922      200            200            0.0057228026   0.00013583888  0              0.017032569    11122.264      0              5.3705431e+08  1.1971759e-13  0              4.1057853    
    500000   12727.922      200            200            0.010337136   -0.00048719899  0              0.031498607    129.86675      0              6270800.7      1.1971759e-13  0              4.1041628    
    600000   12727.922      200            200            0.0038709514   0.00029093017  0              0.011321924    8.3267804      0              402070.43      1.1971759e-13  0              4.1064977    
    700000   12727.922      200            200            0.0054058882   0.00028624895  0              0.015931416    28.793816      0              1390350.3      1.1971759e-13  0              4.10584      
    800000   12727.922      200            200            0.0057106742   0.00029629154  0              0.016835731    0.030463803    0              1470.988       1.1971759e-13  0              4.1057277    
    900000   12727.922      200            200            0.0054859267   0.00029086284  0              0.016166917    0.51653791     0              24941.767      1.1971759e-13  0              4.1058139    
   1000000   12727.922      200            200            0.0054456925   0.00029238367  0              0.016044694    0.0010803164   0              52.164612      1.1971759e-13  0              4.1058292    
   1100000   12727.922      200            200            0.0054749481   0.00029231204  0              0.016132532    0.009247963    0              446.55104      1.1971759e-13  0              4.1058178    
   1200000   12727.922      200            200            0.005480647    0.00029229008  0              0.016149651    2.2259307e-05  0              1.0748223      1.1971759e-13  0              4.1058156    
   1300000   12727.922      200            200            0.0054767358   0.00029230624  0              0.016137901    0.00016613443  0              8.0220371      1.1971759e-13  0              4.1058172    
   1400000   12727.922      200            200            0.0054759613   0.00029230913  0              0.016135575    4.460572e-07   0              0.021538506    1.1971759e-13  0              4.1058174    
   1500000   12727.922      200            200            0.0054764838   0.00029230708  0              0.016137144    2.9838269e-06  0              0.14407832     1.1971759e-13  0              4.1058172    
   1600000   12727.922      200            200            0.0054765892   0.00029230669  0              0.016137461    8.8908208e-09  0              0.00042930592  1.1971759e-13  0              4.1058172    
   1700000   12727.922      200            200            0.0054765194   0.00029230696  0              0.016137251    5.3585292e-08  0              0.002587442    1.1971759e-13  0              4.1058172    
   1800000   12727.922      200            200            0.005476505    0.00029230702  0              0.016137208    1.7632639e-10  0              8.5141705e-06  1.1971759e-13  0              4.1058172    
   1900000   12727.922      200            200            0.0054765144   0.00029230698  0              0.016137236    9.621407e-10   0              4.6458331e-05  1.1971759e-13  0              4.1058172    
   2000000   12727.922      200            200            0.0054765163   0.00029230697  0              0.016137242    3.4829864e-12  0              1.6818095e-07  1.1971759e-13  0              4.1058172    
   2100000   12727.922      200            200            0.0054765151   0.00029230698  0              0.016137238    1.7264026e-11  0              8.3361804e-07  1.1971759e-13  0              4.1058172    
   2200000   12727.922      200            200            0.0054765148   0.00029230698  0              0.016137237    6.7763675e-14  0              3.2720654e-09  1.1971759e-13  0              4.1058172    
   2300000   12727.922      200            200            0.005476515    0.00029230698  0              0.016137238    3.0999224e-13  0              1.4968416e-08  1.1971759e-13  0              4.1058172    
   2400000   12727.922      200            200            0.005476515    0.00029230698  0              0.016137238    1.2419147e-15  0              5.9967618e-11  1.1971759e-13  0              4.1058172    
   2500000   12727.922      200            200            0.005476515    0.00029230698  0              0.016137238    5.5845353e-15  0              2.6965722e-10  1.1971759e-13  0              4.1058172    
   2600000   12727.922      200            200            0.005476515    0.00029230698  0              0.016137238    1.2725444e-16  0              6.1446615e-12  1.1971759e-13  0              4.1058172    
   2700000   12727.922      200            200            0.005476515    0.00029230698  0              0.016137238    1.7532688e-18  0              8.4659078e-14  1.1971759e-13  0              4.1058172    
   2800000   12727.922      200            200            0.005476515    0.00029230698  0              0.016137238    3.6864084e-17  0              1.7800347e-12  1.1971759e-13  0              4.1058172    
   2900000   12727.922      200            200            0.005476515    0.00029230698  0              0.016137238    6.1171228e-20  0              2.9537397e-15  1.1971759e-13  0              4.1058172    
   3000000   12727.922      200            200            0.005476515    0.00029230696  0              0.016137238    7.4108956e-18  0              3.5784563e-13  1.1971759e-13  0              4.1058172    
Loop time of 698.095 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3712959.802 ns/day, 0.000 hours/ns, 4297.407 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.04     | 238.2      | 296.81     | 374.2 | 34.12
Neigh   | 1.1581     | 1.1817     | 1.2053     |   1.8 |  0.17
Comm    | 23.506     | 82.533     | 141        | 633.7 | 11.82
Output  | 0.40197    | 0.40261    | 0.40326    |   0.1 |  0.06
Modify  | 202.02     | 270.53     | 339.9      | 416.5 | 38.75
Other   |            | 105.2      |            |       | 15.08

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1476.75 ave        2205 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5907
Ave neighs/atom = 1.1811638
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.23                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 164.788298583916
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.33
  ghost atom cutoff = 5.33
  binsize = 2.665, bins = 4776 76 76
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.82 | 42.83 | 42.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.8488837e-14  2.0546651e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00038770783  2.0546651e-13  0             -0.0011631235   44711.709      0              2.1589684e+09  1.1971759e-13  0              4.5669517    
    200000   12727.922      200            200           -0.00053424954  2.0546651e-13  0             -0.0016027486   138305.02      0              6.6782544e+09  1.1971759e-13  0              4.1629953    
    300000   12727.922      200            200           -0.00020486905  2.0546651e-13  0             -0.00061460715  13581.954      0              6.5582393e+08  1.1971759e-13  0              4.1334005    
    400000   12727.922      200            200            0.0089439069  -0.0003286836   0              0.027160404    10311.908      0              4.9792515e+08  1.1971759e-13  0              4.1096426    
    500000   12727.922      200            200            0.010552323   -0.00054092141  0              0.03219789     0.16045508     0              7747.8014      1.1971759e-13  0              4.1090983    
    600000   12727.922      200            200            0.0040235338   0.00029535497  0              0.011775246    44.984425      0              2172136.9      1.1971759e-13  0              4.1114356    
    700000   12727.922      200            200            0.0052316222   0.000321642    0              0.015373224    24.160143      0              1166606.8      1.1971759e-13  0              4.110918     
    800000   12727.922      200            200            0.0056957002   0.00029860104  0              0.016788499    0.70641892     0              34110.441      1.1971759e-13  0              4.1107378    
    900000   12727.922      200            200            0.0055239054   0.00029335419  0              0.016278362    0.40637446     0              19622.368      1.1971759e-13  0              4.110804     
   1000000   12727.922      200            200            0.0054571805   0.00029461538  0              0.016076926    0.018061894    0              872.14421      1.1971759e-13  0              4.1108297    
   1100000   12727.922      200            200            0.005477597    0.00029456765  0              0.016138223    0.0066454605   0              320.8855       1.1971759e-13  0              4.1108216    
   1200000   12727.922      200            200            0.0054872399   0.00029453323  0              0.016167187    0.0004000284   0              19.31594       1.1971759e-13  0              4.1108179    
   1300000   12727.922      200            200            0.0054847237   0.00029454343  0              0.016159628    0.00011025367  0              5.3237549      1.1971759e-13  0              4.1108189    
   1400000   12727.922      200            200            0.005483375    0.00029454843  0              0.016155577    8.4777906e-06  0              0.40936217     1.1971759e-13  0              4.1108194    
   1500000   12727.922      200            200            0.0054836832   0.00029454724  0              0.016156502    1.8095872e-06  0              0.087378489    1.1971759e-13  0              4.1108193    
   1600000   12727.922      200            200            0.0054838709   0.00029454655  0              0.016157066    1.7634099e-07  0              0.0085148755   1.1971759e-13  0              4.1108192    
   1700000   12727.922      200            200            0.0054838336   0.00029454669  0              0.016156954    2.9351802e-08  0              0.0014172935   1.1971759e-13  0              4.1108192    
   1800000   12727.922      200            200            0.0054838076   0.00029454679  0              0.016156876    3.6080678e-09  0              0.00017422068  1.1971759e-13  0              4.1108192    
   1900000   12727.922      200            200            0.0054838121   0.00029454677  0              0.016156889    4.6987528e-10  0              2.2688596e-05  1.1971759e-13  0              4.1108192    
   2000000   12727.922      200            200            0.0054838157   0.00029454676  0              0.0161569      7.2769219e-11  0              3.5137652e-06  1.1971759e-13  0              4.1108192    
   2100000   12727.922      200            200            0.0054838151   0.00029454676  0              0.016156899    7.4130942e-12  0              3.5795179e-07  1.1971759e-13  0              4.1108192    
   2200000   12727.922      200            200            0.0054838146   0.00029454676  0              0.016156897    1.4502551e-12  0              7.0027628e-08  1.1971759e-13  0              4.1108192    
   2300000   12727.922      200            200            0.0054838147   0.00029454676  0              0.016156897    1.1619117e-13  0              5.6104559e-09  1.1971759e-13  0              4.1108192    
   2400000   12727.922      200            200            0.0054838148   0.00029454676  0              0.016156898    2.8153485e-14  0              1.359431e-09   1.1971759e-13  0              4.1108192    
   2500000   12727.922      200            200            0.0054838148   0.00029454676  0              0.016156898    1.7310682e-15  0              8.3587086e-11  1.1971759e-13  0              4.1108192    
   2600000   12727.922      200            200            0.0054838148   0.00029454676  0              0.016156898    6.9886917e-16  0              3.3745891e-11  1.1971759e-13  0              4.1108192    
   2700000   12727.922      200            200            0.0054838148   0.00029454676  0              0.016156898    3.4797985e-17  0              1.6802702e-12  1.1971759e-13  0              4.1108192    
   2800000   12727.922      200            200            0.0054838148   0.00029454676  0              0.016156898    3.546347e-17   0              1.712404e-12   1.1971759e-13  0              4.1108192    
   2900000   12727.922      200            200            0.0054838148   0.00029454676  0              0.016156898    3.126262e-17   0              1.50956e-12    1.1971759e-13  0              4.1108192    
   3000000   12727.922      200            200            0.0054838148   0.00029454675  0              0.016156898    3.7393025e-18  0              1.8055753e-13  1.1971759e-13  0              4.1108192    
Loop time of 694.702 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3731095.347 ns/day, 0.000 hours/ns, 4318.397 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.96     | 235.93     | 291.28     | 359.5 | 33.96
Neigh   | 1.1389     | 1.1605     | 1.1826     |   1.8 |  0.17
Comm    | 24.307     | 80.049     | 136.01     | 616.4 | 11.52
Output  | 0.3998     | 0.40044    | 0.40108    |   0.1 |  0.06
Modify  | 203.11     | 272.21     | 341.15     | 414.8 | 39.18
Other   |            | 105        |            |       | 15.11

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1425.75 ave        2103 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5703
Ave neighs/atom = 1.1403719
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.24                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 165.735355460725
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.34
  ghost atom cutoff = 5.34
  binsize = 2.67, bins = 4768 75 75
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.03 | 42.04 | 42.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            6.9598394e-14  2.0879518e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00037791191  2.0879518e-13  0             -0.0011337357   41962.976      0              2.0262419e+09  1.1971759e-13  0              4.572611     
    200000   12727.922      200            200           -0.00052594948  2.0879518e-13  0             -0.0015778484   130933.63      0              6.3223164e+09  1.1971759e-13  0              4.1711829    
    300000   12727.922      200            200           -0.00018799555  2.0879518e-13  0             -0.00056398664  11221.019      0              5.4182283e+08  1.1971759e-13  0              4.1395283    
    400000   12727.922      200            200            0.012637618   -0.00080437555  0              0.038717228    8128.0759      0              3.9247569e+08  1.1971759e-13  0              4.1135808    
    500000   12727.922      200            200            0.010267108   -0.00054935289  0              0.031350677    147.40599      0              7117707.9      1.1971759e-13  0              4.1141766    
    600000   12727.922      200            200            0.0042946218   0.00032314607  0              0.012560719    100.71262      0              4863052.1      1.1971759e-13  0              4.1163253    
    700000   12727.922      200            200            0.0050718822   0.00031333037  0              0.014902316    15.798935      0              762874.02      1.1971759e-13  0              4.1159858    
    800000   12727.922      200            200            0.0056549485   0.00030130868  0              0.016663537    1.9630144      0              94786.938      1.1971759e-13  0              4.1157579    
    900000   12727.922      200            200            0.0055560743   0.00029546984  0              0.016372753    0.21686881     0              10471.819      1.1971759e-13  0              4.1157964    
   1000000   12727.922      200            200            0.0054731387   0.00029700146  0              0.016122415    0.045612683    0              2202.4732      1.1971759e-13  0              4.1158284    
   1100000   12727.922      200            200            0.0054814592   0.00029698136  0              0.016147396    0.0026087471   0              125.96706      1.1971759e-13  0              4.115825     
   1200000   12727.922      200            200            0.0054930964   0.00029691537  0              0.016182374    0.0009737359   0              47.018222      1.1971759e-13  0              4.1158205    
   1300000   12727.922      200            200            0.0054925615   0.00029693303  0              0.016180752    2.8582347e-05  0              1.3801392      1.1971759e-13  0              4.1158207    
   1400000   12727.922      200            200            0.005490976    0.00029694748  0              0.016175981    1.9764522e-05  0              0.95435804     1.1971759e-13  0              4.1158213    
   1500000   12727.922      200            200            0.0054909707   0.00029694588  0              0.016175966    2.4928499e-07  0              0.01203708     1.1971759e-13  0              4.1158213    
   1600000   12727.922      200            200            0.0054911834   0.00029694489  0              0.016176605    3.8554716e-07  0              0.018616693    1.1971759e-13  0              4.1158212    
   1700000   12727.922      200            200            0.0054911945   0.00029694485  0              0.016176639    1.3334513e-09  0              6.438759e-05   1.1971759e-13  0              4.1158212    
   1800000   12727.922      200            200            0.0054911665   0.00029694498  0              0.016176555    7.2408542e-09  0              0.00034963494  1.1971759e-13  0              4.1158212    
   1900000   12727.922      200            200            0.0054911637   0.00029694499  0              0.016176546    5.2259278e-13  0              2.5234135e-08  1.1971759e-13  0              4.1158212    
   2000000   12727.922      200            200            0.0054911673   0.00029694497  0              0.016176557    1.3111516e-10  0              6.3310818e-06  1.1971759e-13  0              4.1158212    
   2100000   12727.922      200            200            0.0054911678   0.00029694497  0              0.016176559    2.1498805e-13  0              1.0381003e-08  1.1971759e-13  0              4.1158212    
   2200000   12727.922      200            200            0.0054911674   0.00029694497  0              0.016176557    2.2917029e-12  0              1.1065813e-07  1.1971759e-13  0              4.1158212    
   2300000   12727.922      200            200            0.0054911673   0.00029694497  0              0.016176557    1.6603332e-14  0              8.017155e-10   1.1971759e-13  0              4.1158212    
   2400000   12727.922      200            200            0.0054911673   0.00029694497  0              0.016176557    3.885073e-14   0              1.8759627e-09  1.1971759e-13  0              4.1158212    
   2500000   12727.922      200            200            0.0054911674   0.00029694497  0              0.016176557    7.4946016e-16  0              3.6188749e-11  1.1971759e-13  0              4.1158212    
   2600000   12727.922      200            200            0.0054911673   0.00029694497  0              0.016176557    4.2399519e-16  0              2.047321e-11   1.1971759e-13  0              4.1158212    
   2700000   12727.922      200            200            0.0054911673   0.00029694497  0              0.016176557    1.0051397e-16  0              4.8534598e-12  1.1971759e-13  0              4.1158212    
   2800000   12727.922      200            200            0.0054911673   0.00029694497  0              0.016176557    2.8366192e-19  0              1.3697019e-14  1.1971759e-13  0              4.1158212    
   2900000   12727.922      200            200            0.0054911673   0.00029694497  0              0.016176557    4.1064223e-18  0              1.9828444e-13  1.1971759e-13  0              4.1158212    
   3000000   12727.922      200            200            0.0054911673   0.00029694498  0              0.016176557    1.1738048e-17  0              5.6678832e-13  1.1971759e-13  0              4.1158212    
Loop time of 692.48 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3743070.723 ns/day, 0.000 hours/ns, 4332.258 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.26     | 234.96     | 290.78     | 360.7 | 33.93
Neigh   | 1.044      | 1.0653     | 1.0863     |   1.7 |  0.15
Comm    | 23.329     | 79.716     | 134.97     | 618.9 | 11.51
Output  | 0.3997     | 0.40033    | 0.40098    |   0.1 |  0.06
Modify  | 202.28     | 271.39     | 340.81     | 417.7 | 39.19
Other   |            | 104.9      |            |       | 15.16

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1432.25 ave        2116 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5729
Ave neighs/atom = 1.1455709
Neighbor list builds = 119
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.25                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 166.686033965545
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.35
  ghost atom cutoff = 5.35
  binsize = 2.675, bins = 4759 75 75
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.98 | 41.99 | 42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.0715134e-14  2.121454e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00036796911  2.121454e-13   0             -0.0011039073   39302.797      0              1.8977914e+09  1.1971759e-13  0              4.5782305    
    200000   12727.922      200            200           -0.00051730639  2.121454e-13   0             -0.0015519192   123771.61      0              5.9764881e+09  1.1971759e-13  0              4.1792876    
    300000   12727.922      200            200           -0.00017078653  2.121454e-13   0             -0.00051235958  9088.0954      0              4.388316e+08   1.1971759e-13  0              4.1455501    
    400000   12727.922      200            200            0.016214874   -0.0014056177   0              0.050050241    5014.6121      0              2.4213767e+08  1.1971759e-13  0              4.1176867    
    500000   12727.922      200            200            0.0095288808  -0.00050054784  0              0.02908719     515.39556      0              24886607       1.1971759e-13  0              4.1193908    
    600000   12727.922      200            200            0.0046653888   0.00034538343  0              0.013650783    158.91362      0              7673370        1.1971759e-13  0              4.1211751    
    700000   12727.922      200            200            0.0049570814   0.00030833644  0              0.014562908    6.9926689      0              337650.95      1.1971759e-13  0              4.121037     
    800000   12727.922      200            200            0.0055959441   0.00030854078  0              0.016479292    3.1956531      0              154306.65      1.1971759e-13  0              4.1207856    
    900000   12727.922      200            200            0.0055793454   0.00029886615  0              0.01643917     0.05186072     0              2504.1686      1.1971759e-13  0              4.1207922    
   1000000   12727.922      200            200            0.0054925543   0.00030070225  0              0.016176961    0.06612548     0              3192.9628      1.1971759e-13  0              4.1208259    
   1100000   12727.922      200            200            0.0054876488   0.00030072202  0              0.016162224    0.00011135758  0              5.377059       1.1971759e-13  0              4.1208276    
   1200000   12727.922      200            200            0.005498904    0.00030057247  0              0.01619614     0.0012473745   0              60.23125       1.1971759e-13  0              4.1208232    
   1300000   12727.922      200            200            0.0055004549   0.00030059171  0              0.016200773    1.8772079e-06  0              0.090643651    1.1971759e-13  0              4.1208227    
   1400000   12727.922      200            200            0.0054990619   0.00030059865  0              0.016196587    2.1433806e-05  0              1.0349618      1.1971759e-13  0              4.1208232    
   1500000   12727.922      200            200            0.005498745    0.00030060027  0              0.016195635    3.0281406e-07  0              0.014621807    1.1971759e-13  0              4.1208233    
   1600000   12727.922      200            200            0.0054989067   0.0003005994   0              0.016196121    3.3354272e-07  0              0.016105584    1.1971759e-13  0              4.1208233    
   1700000   12727.922      200            200            0.0054989621   0.00030059911  0              0.016196287    1.4290392e-08  0              0.00069003188  1.1971759e-13  0              4.1208232    
   1800000   12727.922      200            200            0.0054989447   0.0003005992   0              0.016196235    4.6262429e-09  0              0.00022338471  1.1971759e-13  0              4.1208232    
   1900000   12727.922      200            200            0.0054989359   0.00030059925  0              0.016196209    4.5887573e-10  0              2.2157467e-05  1.1971759e-13  0              4.1208232    
   2000000   12727.922      200            200            0.0054989376   0.00030059924  0              0.016196213    5.5195281e-11  0              2.6651826e-06  1.1971759e-13  0              4.1208232    
   2100000   12727.922      200            200            0.0054989389   0.00030059923  0              0.016196217    1.1984817e-11  0              5.7870392e-07  1.1971759e-13  0              4.1208232    
   2200000   12727.922      200            200            0.0054989388   0.00030059923  0              0.016196217    5.2591754e-13  0              2.5394676e-08  1.1971759e-13  0              4.1208232    
   2300000   12727.922      200            200            0.0054989386   0.00030059923  0              0.016196217    2.7336259e-13  0              1.3199701e-08  1.1971759e-13  0              4.1208232    
   2400000   12727.922      200            200            0.0054989386   0.00030059923  0              0.016196217    3.2473959e-15  0              1.5680513e-10  1.1971759e-13  0              4.1208232    
   2500000   12727.922      200            200            0.0054989386   0.00030059923  0              0.016196217    5.5500667e-15  0              2.6799286e-10  1.1971759e-13  0              4.1208232    
   2600000   12727.922      200            200            0.0054989386   0.00030059923  0              0.016196217    4.3810517e-17  0              2.1154531e-12  1.1971759e-13  0              4.1208232    
   2700000   12727.922      200            200            0.0054989386   0.00030059923  0              0.016196217    2.0309058e-18  0              9.8065172e-14  1.1971759e-13  0              4.1208232    
   2800000   12727.922      200            200            0.0054989386   0.00030059923  0              0.016196217    1.2447089e-17  0              6.0102538e-13  1.1971759e-13  0              4.1208232    
   2900000   12727.922      200            200            0.0054989386   0.00030059923  0              0.016196217    1.5565333e-17  0              7.5159423e-13  1.1971759e-13  0              4.1208232    
   3000000   12727.922      200            200            0.0054989386   0.00030059924  0              0.016196217    9.9880877e-18  0              4.8228901e-13  1.1971759e-13  0              4.1208232    
Loop time of 691.116 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3750457.748 ns/day, 0.000 hours/ns, 4340.808 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.73     | 234.77     | 290.13     | 356.7 | 33.97
Neigh   | 0.99786    | 1.0199     | 1.0417     |   1.7 |  0.15
Comm    | 24.625     | 79.142     | 134.3      | 612.8 | 11.45
Output  | 0.40373    | 0.40439    | 0.40505    |   0.1 |  0.06
Modify  | 200.54     | 270.68     | 339.87     | 417.6 | 39.16
Other   |            | 105.1      |            |       | 15.21

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1438.75 ave        2129 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5755
Ave neighs/atom = 1.1507698
Neighbor list builds = 115
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.26                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 167.64034100988
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.36
  ghost atom cutoff = 5.36
  binsize = 2.68, bins = 4750 75 75
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.93 | 41.93 | 41.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.1839041e-14  2.1551712e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00035787996  2.1551712e-13  0             -0.0010736399   36731.031      0              1.77361e+09    1.1971759e-13  0              4.5838098    
    200000   12727.922      200            200           -0.00050832231  2.1551712e-13  0             -0.0015249669   116818.29      0              5.6407371e+09  1.1971759e-13  0              4.1873091    
    300000   12727.922      200            200           -0.00015324479  2.1551712e-13  0             -0.00045973437  7182.2534      0              3.4680531e+08  1.1971759e-13  0              4.1514656    
    400000   12727.922      200            200            0.019222792   -0.0013985175   0              0.059066894    1967.4611      0              95001653       1.1971759e-13  0              4.1220457    
    500000   12727.922      200            200            0.0084291624  -0.00046976287  0              0.02575725     969.82076      0              46829174       1.1971759e-13  0              4.1247212    
    600000   12727.922      200            200            0.0051017091   0.00031300856  0              0.014992119    201.23298      0              9716820.5      1.1971759e-13  0              4.1259966    
    700000   12727.922      200            200            0.0048940879   0.00029621741  0              0.014386046    1.1201087      0              54086.038      1.1971759e-13  0              4.1260665    
    800000   12727.922      200            200            0.0055248744   0.00031306145  0              0.016261562    3.8167076      0              184295.15      1.1971759e-13  0              4.1258179    
    900000   12727.922      200            200            0.0055909227   0.00030208747  0              0.016470681    0.0017905255   0              86.45807       1.1971759e-13  0              4.1257926    
   1000000   12727.922      200            200            0.005512929    0.00030397186  0              0.016234815    0.066416193    0              3207.0003      1.1971759e-13  0              4.125823     
   1100000   12727.922      200            200            0.0054959951   0.00030423615  0              0.016183749    0.0010204897   0              49.275795      1.1971759e-13  0              4.1258294    
   1200000   12727.922      200            200            0.0055046766   0.00030404007  0              0.01620999     0.00097593741  0              47.124525      1.1971759e-13  0              4.125826     
   1300000   12727.922      200            200            0.0055078698   0.00030403694  0              0.016219572    5.7031594e-05  0              2.7538516      1.1971759e-13  0              4.1258248    
   1400000   12727.922      200            200            0.0055070313   0.00030404163  0              0.016217052    1.1569951e-05  0              0.55867153     1.1971759e-13  0              4.1258251    
   1500000   12727.922      200            200            0.0055065159   0.00030404451  0              0.016215503    1.8738432e-06  0              0.090481182    1.1971759e-13  0              4.1258253    
   1600000   12727.922      200            200            0.0055065745   0.00030404415  0              0.016215679    9.8047518e-08  0              0.0047343638   1.1971759e-13  0              4.1258253    
   1700000   12727.922      200            200            0.0055066498   0.00030404372  0              0.016215906    4.6827944e-08  0              0.0022611538   1.1971759e-13  0              4.1258252    
   1800000   12727.922      200            200            0.0055066498   0.00030404373  0              0.016215906    3.7524949e-10  0              1.8119455e-05  1.1971759e-13  0              4.1258252    
   1900000   12727.922      200            200            0.0055066397   0.00030404378  0              0.016215875    9.6456427e-10  0              4.6575357e-05  1.1971759e-13  0              4.1258252    
   2000000   12727.922      200            200            0.0055066386   0.00030404379  0              0.016215872    4.1982438e-13  0              2.0271817e-08  1.1971759e-13  0              4.1258252    
   2100000   12727.922      200            200            0.0055066399   0.00030404378  0              0.016215876    1.6803635e-11  0              8.1138741e-07  1.1971759e-13  0              4.1258252    
   2200000   12727.922      200            200            0.0055066401   0.00030404378  0              0.016215877    2.6669983e-13  0              1.287798e-08   1.1971759e-13  0              4.1258252    
   2300000   12727.922      200            200            0.00550664     0.00030404378  0              0.016215876    2.4393396e-13  0              1.1778698e-08  1.1971759e-13  0              4.1258252    
   2400000   12727.922      200            200            0.0055066399   0.00030404378  0              0.016215876    1.5171785e-14  0              7.325912e-10   1.1971759e-13  0              4.1258252    
   2500000   12727.922      200            200            0.00550664     0.00030404378  0              0.016215876    2.7336418e-15  0              1.3199778e-10  1.1971759e-13  0              4.1258252    
   2600000   12727.922      200            200            0.00550664     0.00030404378  0              0.016215876    6.3874051e-16  0              3.0842493e-11  1.1971759e-13  0              4.1258252    
   2700000   12727.922      200            200            0.00550664     0.00030404378  0              0.016215876    4.3206701e-17  0              2.086297e-12   1.1971759e-13  0              4.1258252    
   2800000   12727.922      200            200            0.00550664     0.00030404378  0              0.016215876    4.4406284e-17  0              2.1442205e-12  1.1971759e-13  0              4.1258252    
   2900000   12727.922      200            200            0.00550664     0.00030404378  0              0.016215876    7.6533163e-21  0              3.6955125e-16  1.1971759e-13  0              4.1258252    
   3000000   12727.922      200            200            0.00550664     0.00030404379  0              0.016215876    7.8740147e-18  0              3.8020799e-13  1.1971759e-13  0              4.1258252    
Loop time of 695.026 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3729357.284 ns/day, 0.000 hours/ns, 4316.386 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.71     | 236.39     | 293.79     | 361.9 | 34.01
Neigh   | 0.98729    | 1.0055     | 1.0239     |   1.6 |  0.14
Comm    | 24.395     | 80.262     | 137.53     | 614.2 | 11.55
Output  | 0.39933    | 0.39998    | 0.40062    |   0.1 |  0.06
Modify  | 200.68     | 271.59     | 341.14     | 414.9 | 39.08
Other   |            | 105.4      |            |       | 15.16

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1444.25 ave        2139 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5777
Ave neighs/atom = 1.155169
Neighbor list builds = 115
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.27                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 168.598283505233
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.37
  ghost atom cutoff = 5.37
  binsize = 2.685, bins = 4741 75 75
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.88 | 41.9 | 41.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.2970103e-14  2.1891031e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00034764502  2.1891031e-13  0             -0.0010429351   34247.54       0              1.6536912e+09  1.1971759e-13  0              4.5893491    
    200000   12727.922      200            200           -0.00049899933  2.1891031e-13  0             -0.001496998    110073.05      0              5.3150337e+09  1.1971759e-13  0              4.1952471    
    300000   12727.922      200            200           -0.00013537332  2.1891031e-13  0             -0.00040611996  5502.5824      0              2.6570001e+08  1.1971759e-13  0              4.1572745    
    400000   12727.922      200            200            0.020887568   -0.0011479718   0              0.063810675    170.3722       0              8226663.8      1.1971759e-13  0              4.1267269    
    500000   12727.922      200            200            0.0072397112  -0.00011629357  0              0.021835427    1356.4953      0              65500303       1.1971759e-13  0              4.1301383    
    600000   12727.922      200            200            0.0056212942   0.00036350266  0              0.01650038     213.07114      0              10288443       1.1971759e-13  0              4.1308042    
    700000   12727.922      200            200            0.0048946881   0.00029598332  0              0.014388081    0.39332935     0              18992.467      1.1971759e-13  0              4.1310718    
    800000   12727.922      200            200            0.0054485351   0.00030566045  0              0.016039945    3.5353132      0              170707.62      1.1971759e-13  0              4.130851     
    900000   12727.922      200            200            0.0055897888   0.00030392517  0              0.016465441    0.09335623     0              4507.8383      1.1971759e-13  0              4.1307976    
   1000000   12727.922      200            200            0.0055317122   0.0003055816   0              0.016289555    0.046244094    0              2232.9618      1.1971759e-13  0              4.1308205    
   1100000   12727.922      200            200            0.0055059118   0.00030615773  0              0.016211578    0.0046091782   0              222.56072      1.1971759e-13  0              4.1308303    
   1200000   12727.922      200            200            0.0055104003   0.00030597873  0              0.016225222    0.00040556513  0              19.583289      1.1971759e-13  0              4.1308285    
   1300000   12727.922      200            200            0.005514459    0.00030595127  0              0.016237426    0.0001367725   0              6.6042547      1.1971759e-13  0              4.130827     
   1400000   12727.922      200            200            0.0055143713   0.00030595201  0              0.016237162    1.441147e-06   0              0.069587833    1.1971759e-13  0              4.130827     
   1500000   12727.922      200            200            0.0055138155   0.00030595557  0              0.016235491    2.9688708e-06  0              0.14335615     1.1971759e-13  0              4.1308272    
   1600000   12727.922      200            200            0.0055137559   0.00030595593  0              0.016235312    3.6233581e-09  0              0.00017495899  1.1971759e-13  0              4.1308273    
   1700000   12727.922      200            200            0.0055138228   0.00030595549  0              0.016235513    4.9917745e-08  0              0.0024103493   1.1971759e-13  0              4.1308272    
   1800000   12727.922      200            200            0.0055138394   0.00030595539  0              0.016235563    1.3516001e-09  0              6.5263932e-05  1.1971759e-13  0              4.1308272    
   1900000   12727.922      200            200            0.0055138325   0.00030595544  0              0.016235542    6.3766493e-10  0              3.0790558e-05  1.1971759e-13  0              4.1308272    
   2000000   12727.922      200            200            0.0055138294   0.00030595546  0              0.016235533    6.6824295e-11  0              3.226706e-06   1.1971759e-13  0              4.1308272    
   2100000   12727.922      200            200            0.0055138299   0.00030595545  0              0.016235534    5.4666822e-12  0              2.6396652e-07  1.1971759e-13  0              4.1308272    
   2200000   12727.922      200            200            0.0055138304   0.00030595545  0              0.016235536    1.9512841e-12  0              9.4220527e-08  1.1971759e-13  0              4.1308272    
   2300000   12727.922      200            200            0.0055138304   0.00030595545  0              0.016235536    1.7794322e-14  0              8.5922411e-10  1.1971759e-13  0              4.1308272    
   2400000   12727.922      200            200            0.0055138304   0.00030595545  0              0.016235536    4.181047e-14   0              2.018878e-09   1.1971759e-13  0              4.1308272    
   2500000   12727.922      200            200            0.0055138303   0.00030595545  0              0.016235536    6.8225578e-17  0              3.294369e-12   1.1971759e-13  0              4.1308272    
   2600000   12727.922      200            200            0.0055138303   0.00030595545  0              0.016235536    4.9612662e-16  0              2.3956179e-11  1.1971759e-13  0              4.1308272    
   2700000   12727.922      200            200            0.0055138304   0.00030595545  0              0.016235536    9.1910848e-17  0              4.4380459e-12  1.1971759e-13  0              4.1308272    
   2800000   12727.922      200            200            0.0055138304   0.00030595545  0              0.016235536    8.8907502e-18  0              4.2930251e-13  1.1971759e-13  0              4.1308272    
   2900000   12727.922      200            200            0.0055138304   0.00030595545  0              0.016235536    3.5056645e-17  0              1.6927599e-12  1.1971759e-13  0              4.1308272    
   3000000   12727.922      200            200            0.0055138304   0.00030595546  0              0.016235536    2.9637464e-18  0              1.4310871e-13  1.1971759e-13  0              4.1308272    
Loop time of 696.14 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3723388.689 ns/day, 0.000 hours/ns, 4309.478 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.29     | 236.63     | 293.62     | 361.3 | 33.99
Neigh   | 0.9861     | 1.0043     | 1.0226     |   1.6 |  0.14
Comm    | 22.687     | 79.955     | 138.05     | 618.7 | 11.49
Output  | 0.40137    | 0.402      | 0.40263    |   0.1 |  0.06
Modify  | 202.3      | 271.77     | 342.64     | 418.7 | 39.04
Other   |            | 106.4      |            |       | 15.28

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1450.25 ave        2151 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5801
Ave neighs/atom = 1.159968
Neighbor list builds = 115
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.28                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 169.55986836311
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.38
  ghost atom cutoff = 5.38
  binsize = 2.69, bins = 4732 75 75
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.81 | 41.82 | 41.83 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.4108306e-14  2.2232492e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00033726483  2.2232492e-13  0             -0.0010117945   31852.186      0              1.5380281e+09  1.1971759e-13  0              4.594848     
    200000   12727.922      200            200           -0.00048933951  2.2232492e-13  0             -0.0014680185   103535.23      0              4.9993458e+09  1.1971759e-13  0              4.2031015    
    300000   12727.922      200            200           -0.00011717489  2.2232492e-13  0             -0.00035152467  4048.1531      0              1.9547082e+08  1.1971759e-13  0              4.1629763    
    400000   12727.922      200            200            0.020672847   -0.0011162506   0              0.063134793    388.49057      0              18758819       1.1971759e-13  0              4.1317676    
    500000   12727.922      200            200            0.0060449      0.00032474606  0              0.017809954    1560.6579      0              75358586       1.1971759e-13  0              4.1356073    
    600000   12727.922      200            200            0.0061208722   0.00030728395  0              0.018055333    188.99027      0              9125663.9      1.1971759e-13  0              4.1356144    
    700000   12727.922      200            200            0.0049555213   0.00029555641  0              0.014571008    5.051673       0              243927.21      1.1971759e-13  0              4.1360525    
    800000   12727.922      200            200            0.0053804984   0.00029782178  0              0.015843673    2.4902816      0              120246.79      1.1971759e-13  0              4.1358811    
    900000   12727.922      200            200            0.0055768673   0.00030357765  0              0.016427024    0.27454766     0              13256.924      1.1971759e-13  0              4.1358069    
   1000000   12727.922      200            200            0.0055466841   0.00030483579  0              0.016335217    0.01858056     0              897.18877      1.1971759e-13  0              4.1358191    
   1100000   12727.922      200            200            0.0055165801   0.00030568268  0              0.016244058    0.0081656002   0              394.28761      1.1971759e-13  0              4.1358307    
   1200000   12727.922      200            200            0.0055161098   0.00030553942  0              0.01624279     2.1465719e-05  0              1.0365028      1.1971759e-13  0              4.1358308    
   1300000   12727.922      200            200            0.0055201071   0.00030550877  0              0.016254812    0.00016445686  0              7.9410332      1.1971759e-13  0              4.1358292    
   1400000   12727.922      200            200            0.0055207686   0.00030550422  0              0.016256802    1.7350073e-06  0              0.083777291    1.1971759e-13  0              4.135829     
   1500000   12727.922      200            200            0.0055203322   0.00030550738  0              0.016255489    2.3142578e-06  0              0.11174723     1.1971759e-13  0              4.1358292    
   1600000   12727.922      200            200            0.0055201775   0.00030550847  0              0.016255024    1.6540797e-07  0              0.007986959    1.1971759e-13  0              4.1358292    
   1700000   12727.922      200            200            0.0055202127   0.00030550821  0              0.01625513     2.0333529e-08  0              0.00098183335  1.1971759e-13  0              4.1358292    
   1800000   12727.922      200            200            0.0055202387   0.00030550803  0              0.016255208    5.7944532e-09  0              0.00027979341  1.1971759e-13  0              4.1358292    
   1900000   12727.922      200            200            0.005520238    0.00030550803  0              0.016255206    5.8075601e-11  0              2.8042629e-06  1.1971759e-13  0              4.1358292    
   2000000   12727.922      200            200            0.0055202343   0.00030550806  0              0.016255195    1.2914439e-10  0              6.2359203e-06  1.1971759e-13  0              4.1358292    
   2100000   12727.922      200            200            0.0055202339   0.00030550806  0              0.016255194    4.8359163e-13  0              2.3350909e-08  1.1971759e-13  0              4.1358292    
   2200000   12727.922      200            200            0.0055202343   0.00030550806  0              0.016255195    2.0144064e-12  0              9.7268475e-08  1.1971759e-13  0              4.1358292    
   2300000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    9.3608007e-14  0              4.5199957e-09  1.1971759e-13  0              4.1358292    
   2400000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    2.1152063e-14  0              1.0213574e-09  1.1971759e-13  0              4.1358292    
   2500000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    3.9661994e-15  0              1.9151358e-10  1.1971759e-13  0              4.1358292    
   2600000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    5.2270677e-18  0              2.5239639e-13  1.1971759e-13  0              4.1358292    
   2700000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    1.3845086e-17  0              6.6852963e-13  1.1971759e-13  0              4.1358292    
   2800000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    4.9149662e-21  0              2.3732613e-16  1.1971759e-13  0              4.1358292    
   2900000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    5.4295253e-17  0              2.6217235e-12  1.1971759e-13  0              4.1358292    
   3000000   12727.922      200            200            0.0055202344   0.00030550806  0              0.016255195    9.3928372e-18  0              4.5354649e-13  1.1971759e-13  0              4.1358292    
Loop time of 697.846 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3714286.940 ns/day, 0.000 hours/ns, 4298.943 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.71     | 236.43     | 292.21     | 361.0 | 33.88
Neigh   | 1          | 1.017      | 1.0343     |   1.6 |  0.15
Comm    | 23.39      | 79.84      | 135.61     | 621.4 | 11.44
Output  | 0.40138    | 0.40206    | 0.40272    |   0.1 |  0.06
Modify  | 204.69     | 274.2      | 344.5      | 417.1 | 39.29
Other   |            | 106        |            |       | 15.18

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1456.25 ave        2163 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5825
Ave neighs/atom = 1.164767
Neighbor list builds = 115
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.29                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 170.525102495013
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.39
  ghost atom cutoff = 5.39
  binsize = 2.695, bins = 4723 75 75
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.76 | 41.77 | 41.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.5253636e-14  2.2576091e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00032673992  2.2576091e-13  0             -0.00098021977  29544.831      0              1.4266142e+09  1.1971759e-13  0              4.6003066    
    200000   12727.922      200            200           -0.00047934492  2.2576091e-13  0             -0.0014380348   97204.188      0              4.6936424e+09  1.1971759e-13  0              4.2108719    
    300000   12727.922      200            200           -9.8652362e-05  2.2576091e-13  0             -0.00029595708  2818.0469      0              1.360734e+08   1.1971759e-13  0              4.1685709    
    400000   12727.922      200            200            0.018548646   -0.0015030892   0              0.057149028    2516.2188      0              1.214992e+08   1.1971759e-13  0              4.1371647    
    500000   12727.922      200            200            0.0048715398   0.00053496846  0              0.014079651    1539.7504      0              74349035       1.1971759e-13  0              4.1410917    
    600000   12727.922      200            200            0.0065613898   0.00017418936  0              0.01950998     135.84209      0              6559328.3      1.1971759e-13  0              4.140444     
    700000   12727.922      200            200            0.0050722412   0.00029439851  0              0.014922325    13.270148      0              640767.93      1.1971759e-13  0              4.1410107    
    800000   12727.922      200            200            0.0053312015   0.00029516927  0              0.015698435    1.177511       0              56857.79       1.1971759e-13  0              4.1409047    
    900000   12727.922      200            200            0.0055564238   0.00030537857  0              0.016363893    0.443747       0              21426.955      1.1971759e-13  0              4.1408193    
   1000000   12727.922      200            200            0.0055576252   0.00030551556  0              0.01636736     0.0012185234   0              58.838134      1.1971759e-13  0              4.1408194    
   1100000   12727.922      200            200            0.005528379    0.00030646917  0              0.016278668    0.0090559995   0              437.2818       1.1971759e-13  0              4.1408308    
   1200000   12727.922      200            200            0.005523167    0.00030637986  0              0.016263121    0.00013882014  0              6.7031276      1.1971759e-13  0              4.1408327    
   1300000   12727.922      200            200            0.0055262216   0.00030635584  0              0.016272309    0.00011501412  0              5.5536203      1.1971759e-13  0              4.1408315    
   1400000   12727.922      200            200            0.0055274449   0.00030634696  0              0.016275988    1.1824386e-05  0              0.57095729     1.1971759e-13  0              4.140831     
   1500000   12727.922      200            200            0.0055272469   0.00030634847  0              0.016275392    7.1080605e-07  0              0.03432228     1.1971759e-13  0              4.1408311    
   1600000   12727.922      200            200            0.0055270485   0.00030634992  0              0.016274796    3.6887482e-07  0              0.017811645    1.1971759e-13  0              4.1408312    
   1700000   12727.922      200            200            0.0055270407   0.00030634997  0              0.016274772    6.2308999e-11  0              3.0086786e-06  1.1971759e-13  0              4.1408312    
   1800000   12727.922      200            200            0.005527066    0.00030634978  0              0.016274848    6.8633429e-09  0              0.00033140627  1.1971759e-13  0              4.1408312    
   1900000   12727.922      200            200            0.0055270714   0.00030634974  0              0.016274864    1.7668819e-10  0              8.5316403e-06  1.1971759e-13  0              4.1408312    
   2000000   12727.922      200            200            0.005527069    0.00030634976  0              0.016274857    7.7663861e-11  0              3.7501099e-06  1.1971759e-13  0              4.1408312    
   2100000   12727.922      200            200            0.0055270678   0.00030634977  0              0.016274854    1.0950134e-11  0              5.2874277e-07  1.1971759e-13  0              4.1408312    
   2200000   12727.922      200            200            0.0055270679   0.00030634977  0              0.016274854    3.7131233e-13  0              1.7929344e-08  1.1971759e-13  0              4.1408312    
   2300000   12727.922      200            200            0.0055270681   0.00030634976  0              0.016274855    3.0089693e-13  0              1.4529236e-08  1.1971759e-13  0              4.1408312    
   2400000   12727.922      200            200            0.0055270681   0.00030634976  0              0.016274855    1.4004891e-16  0              6.7624608e-12  1.1971759e-13  0              4.1408312    
   2500000   12727.922      200            200            0.0055270681   0.00030634977  0              0.016274855    5.0099151e-15  0              2.4191087e-10  1.1971759e-13  0              4.1408312    
   2600000   12727.922      200            200            0.0055270681   0.00030634977  0              0.016274855    4.1509567e-16  0              2.0043484e-11  1.1971759e-13  0              4.1408312    
   2700000   12727.922      200            200            0.0055270681   0.00030634977  0              0.016274855    2.2112856e-17  0              1.0677507e-12  1.1971759e-13  0              4.1408312    
   2800000   12727.922      200            200            0.0055270681   0.00030634977  0              0.016274855    3.2795894e-17  0              1.5835963e-12  1.1971759e-13  0              4.1408312    
   2900000   12727.922      200            200            0.0055270681   0.00030634977  0              0.016274855    5.1990508e-19  0              2.5104355e-14  1.1971759e-13  0              4.1408312    
   3000000   12727.922      200            200            0.0055270681   0.00030634976  0              0.016274855    8.2875788e-18  0              4.0017752e-13  1.1971759e-13  0              4.1408312    
Loop time of 699.021 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3708041.660 ns/day, 0.000 hours/ns, 4291.715 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.3      | 236.55     | 292.67     | 362.2 | 33.84
Neigh   | 1.0258     | 1.043      | 1.0607     |   1.6 |  0.15
Comm    | 24.609     | 80.387     | 137.38     | 619.8 | 11.50
Output  | 0.3997     | 0.40036    | 0.40103    |   0.1 |  0.06
Modify  | 202.31     | 273.42     | 345.16     | 423.0 | 39.11
Other   |            | 107.2      |            |       | 15.34

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1462.25 ave        2176 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5849
Ave neighs/atom = 1.1695661
Neighbor list builds = 119
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 171.493992812445
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.4
  ghost atom cutoff = 5.4
  binsize = 2.7, bins = 4715 75 75
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.71 | 41.72 | 41.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.6406083e-14  2.2921825e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00031607087  2.2921825e-13  0             -0.0009482126   27325.338      0              1.3194428e+09  1.1971759e-13  0              4.6057247    
    200000   12727.922      200            200           -0.00046901765  2.2921825e-13  0             -0.0014070529   91079.297      0              4.3978933e+09  1.1971759e-13  0              4.2185582    
    300000   12727.922      200            200           -7.9808685e-05  2.2921825e-13  0             -0.00023942606  1811.3522      0              87463716       1.1971759e-13  0              4.1740578    
    400000   12727.922      200            200            0.01502101    -0.002136544    0              0.047199573    5630.5003      0              2.7187671e+08  1.1971759e-13  0              4.1428749    
    500000   12727.922      200            200            0.0036835535   0.00014278397  0              0.010907876    1321.9034      0              63829984       1.1971759e-13  0              4.1465575    
    600000   12727.922      200            200            0.0069203063   5.6042775e-05  0              0.020704876    71.697853      0              3462032.7      1.1971759e-13  0              4.1453091    
    700000   12727.922      200            200            0.0052362632   0.00029451098  0              0.015414279    21.816453      0              1053438.4      1.1971759e-13  0              4.1459506    
    800000   12727.922      200            200            0.0053057253   0.00029358662  0              0.015623589    0.21346922     0              10307.665      1.1971759e-13  0              4.1459194    
    900000   12727.922      200            200            0.0055316638   0.00030688233  0              0.016288109    0.50654879     0              24459.428      1.1971759e-13  0              4.1458335    
   1000000   12727.922      200            200            0.0055631471   0.00030556426  0              0.016383877    0.0051774628   0              250.00115      1.1971759e-13  0              4.1458217    
   1100000   12727.922      200            200            0.005539649    0.00030644197  0              0.016312505    0.006647267    0              320.97273      1.1971759e-13  0              4.1458309    
   1200000   12727.922      200            200            0.0055308216   0.00030642792  0              0.016286037    0.00064984655  0              31.378764      1.1971759e-13  0              4.1458343    
   1300000   12727.922      200            200            0.0055322886   0.00030641572  0              0.01629045     3.5677352e-05  0              1.7227316      1.1971759e-13  0              4.1458337    
   1400000   12727.922      200            200            0.0055337548   0.00030640446  0              0.01629486     2.1002747e-05  0              1.0141475      1.1971759e-13  0              4.1458331    
   1500000   12727.922      200            200            0.0055338435   0.00030640386  0              0.016295127    8.2358141e-09  0              0.00039767799  1.1971759e-13  0              4.1458331    
   1600000   12727.922      200            200            0.005533664    0.00030640524  0              0.016294587    3.5657503e-07  0              0.017217732    1.1971759e-13  0              4.1458332    
   1700000   12727.922      200            200            0.0055336172   0.00030640559  0              0.016294446    1.6489899e-08  0              0.00079623822  1.1971759e-13  0              4.1458332    
   1800000   12727.922      200            200            0.0055336322   0.00030640547  0              0.016294491    3.037268e-09   0              0.0001466588   1.1971759e-13  0              4.1458332    
   1900000   12727.922      200            200            0.0055336413   0.0003064054   0              0.016294519    7.8138113e-10  0              3.7730098e-05  1.1971759e-13  0              4.1458332    
   2000000   12727.922      200            200            0.0055336411   0.0003064054   0              0.016294518    3.8124223e-12  0              1.8408823e-07  1.1971759e-13  0              4.1458332    
   2100000   12727.922      200            200            0.0055336399   0.00030640541  0              0.016294514    1.7057381e-11  0              8.2363987e-07  1.1971759e-13  0              4.1458332    
   2200000   12727.922      200            200            0.0055336396   0.00030640541  0              0.016294513    2.9601448e-13  0              1.429348e-08   1.1971759e-13  0              4.1458332    
   2300000   12727.922      200            200            0.0055336398   0.00030640541  0              0.016294514    2.0038244e-13  0              9.675751e-09   1.1971759e-13  0              4.1458332    
   2400000   12727.922      200            200            0.0055336398   0.00030640541  0              0.016294514    2.5342825e-14  0              1.2237143e-09  1.1971759e-13  0              4.1458332    
   2500000   12727.922      200            200            0.0055336398   0.00030640541  0              0.016294514    7.3638093e-16  0              3.55572e-11    1.1971759e-13  0              4.1458332    
   2600000   12727.922      200            200            0.0055336398   0.00030640541  0              0.016294514    7.1759721e-16  0              3.4650201e-11  1.1971759e-13  0              4.1458332    
   2700000   12727.922      200            200            0.0055336398   0.00030640541  0              0.016294514    1.0219443e-16  0              4.9346033e-12  1.1971759e-13  0              4.1458332    
   2800000   12727.922      200            200            0.0055336398   0.00030640541  0              0.016294514    3.5546506e-17  0              1.7164136e-12  1.1971759e-13  0              4.1458332    
   2900000   12727.922      200            200            0.0055336398   0.00030640541  0              0.016294514    1.9324726e-17  0              9.3312187e-13  1.1971759e-13  0              4.1458332    
   3000000   12727.922      200            200            0.0055336398   0.0003064054   0              0.016294514    1.7947874e-23  0              8.666386e-19   1.1971759e-13  0              4.1458332    
Loop time of 699.355 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3706270.372 ns/day, 0.000 hours/ns, 4289.665 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.95     | 238.15     | 294.72     | 365.6 | 34.05
Neigh   | 1.0496     | 1.0704     | 1.0898     |   1.7 |  0.15
Comm    | 24.206     | 81.231     | 138.96     | 624.3 | 11.62
Output  | 0.40205    | 0.40269    | 0.40336    |   0.1 |  0.06
Modify  | 204.24     | 273.6      | 342.96     | 415.1 | 39.12
Other   |            | 104.9      |            |       | 15.00

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1467.25 ave        2186 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5869
Ave neighs/atom = 1.1735653
Neighbor list builds = 119
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.31                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 172.466546226913
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.41
  ghost atom cutoff = 5.41
  binsize = 2.705, bins = 4706 74 74
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.94 | 40.95 | 40.95 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.7565632e-14  2.3269689e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00030525821  2.3269689e-13  0             -0.00091577462  25193.573      0              1.2165075e+09  1.1971759e-13  0              4.6111022    
    200000   12727.922      200            200           -0.00045835977  2.3269689e-13  0             -0.0013750793   85159.914      0              4.1120675e+09  1.1971759e-13  0              4.22616      
    300000   12727.922      200            200           -6.0646702e-05  2.3269689e-13  0             -0.0001819401   1027.1506      0              49597429       1.1971759e-13  0              4.1794367    
    400000   12727.922      200            200            0.011486646   -0.00090208663  0              0.035362023    8515.5397      0              4.1118494e+08  1.1971759e-13  0              4.1488243    
    500000   12727.922      200            200            0.0028801854   0.0002265217   0              0.0084140346   981.43772      0              47390115       1.1971759e-13  0              4.1519755    
    600000   12727.922      200            200            0.0071665506   5.589073e-06   0              0.021494063    19.893425      0              960582.29      1.1971759e-13  0              4.1502229    
    700000   12727.922      200            200            0.0054337481   0.00029638055  0              0.016004864    27.259751      0              1316275.8      1.1971759e-13  0              4.1508787    
    800000   12727.922      200            200            0.0053075686   0.00029251172  0              0.015630194    0.046419671    0              2241.4398      1.1971759e-13  0              4.1509234    
    900000   12727.922      200            200            0.0055067228   0.00030665219  0              0.016213516    0.42828415     0              20680.309      1.1971759e-13  0              4.1508475    
   1000000   12727.922      200            200            0.0055632177   0.0003043223   0              0.016385331    0.027639218    0              1334.5989      1.1971759e-13  0              4.150826     
   1100000   12727.922      200            200            0.0055493036   0.00030507377  0              0.016342837    0.0027296864   0              131.80678      1.1971759e-13  0              4.1508315    
   1200000   12727.922      200            200            0.0055386447   0.00030513198  0              0.016310802    0.0011243937   0              54.292947      1.1971759e-13  0              4.1508356    
   1300000   12727.922      200            200            0.0055382458   0.00030513474  0              0.016309603    4.8634844e-08  0              0.0023484026   1.1971759e-13  0              4.1508357    
   1400000   12727.922      200            200            0.0055395879   0.00030512333  0              0.01631364     1.9811238e-05  0              0.95661376     1.1971759e-13  0              4.1508352    
   1500000   12727.922      200            200            0.0055399307   0.00030512054  0              0.016314672    9.7809876e-07  0              0.047228889    1.1971759e-13  0              4.1508351    
   1600000   12727.922      200            200            0.0055398246   0.00030512145  0              0.016314352    1.4741074e-07  0              0.0071179371   1.1971759e-13  0              4.1508351    
   1700000   12727.922      200            200            0.0055397557   0.00030512202  0              0.016314145    4.6410565e-08  0              0.0022410001   1.1971759e-13  0              4.1508351    
   1800000   12727.922      200            200            0.0055397551   0.00030512202  0              0.016314143    2.5722379e-11  0              1.2420416e-06  1.1971759e-13  0              4.1508351    
   1900000   12727.922      200            200            0.0055397642   0.00030512194  0              0.016314171    8.9965648e-10  0              4.3441192e-05  1.1971759e-13  0              4.1508351    
   2000000   12727.922      200            200            0.0055397663   0.00030512192  0              0.016314177    3.3468509e-11  0              1.6160745e-06  1.1971759e-13  0              4.1508351    
   2100000   12727.922      200            200            0.0055397655   0.00030512193  0              0.016314175    7.7149888e-12  0              3.725292e-07   1.1971759e-13  0              4.1508351    
   2200000   12727.922      200            200            0.005539765    0.00030512193  0              0.016314173    1.8894572e-12  0              9.1235126e-08  1.1971759e-13  0              4.1508351    
   2300000   12727.922      200            200            0.0055397651   0.00030512193  0              0.016314173    5.103461e-15   0              2.4642787e-10  1.1971759e-13  0              4.1508351    
   2400000   12727.922      200            200            0.0055397651   0.00030512193  0              0.016314173    4.0164845e-14  0              1.9394166e-09  1.1971759e-13  0              4.1508351    
   2500000   12727.922      200            200            0.0055397651   0.00030512193  0              0.016314173    1.2241778e-15  0              5.9111167e-11  1.1971759e-13  0              4.1508351    
   2600000   12727.922      200            200            0.0055397651   0.00030512193  0              0.016314173    1.3730429e-16  0              6.6299328e-12  1.1971759e-13  0              4.1508351    
   2700000   12727.922      200            200            0.0055397651   0.00030512193  0              0.016314173    2.8975745e-17  0              1.399135e-12   1.1971759e-13  0              4.1508351    
   2800000   12727.922      200            200            0.0055397651   0.00030512193  0              0.016314173    1.6482567e-17  0              7.9588416e-13  1.1971759e-13  0              4.1508351    
   2900000   12727.922      200            200            0.0055397651   0.00030512194  0              0.016314173    7.2473766e-18  0              3.4994988e-13  1.1971759e-13  0              4.1508351    
   3000000   12727.922      200            200            0.0055397651   0.00030512192  0              0.016314173    4.6717431e-18  0              2.2558176e-13  1.1971759e-13  0              4.1508351    
Loop time of 698.323 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3711747.274 ns/day, 0.000 hours/ns, 4296.004 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.4      | 237.83     | 296.13     | 369.1 | 34.06
Neigh   | 1.0334     | 1.0562     | 1.0793     |   1.8 |  0.15
Comm    | 25.044     | 81.944     | 140.72     | 623.7 | 11.73
Output  | 0.40493    | 0.40558    | 0.40622    |   0.1 |  0.06
Modify  | 200.98     | 271.71     | 340.57     | 415.1 | 38.91
Other   |            | 105.4      |            |       | 15.09

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1472.75 ave        2197 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5891
Ave neighs/atom = 1.1779644
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.32                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 173.442769649917
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.42
  ghost atom cutoff = 5.42
  binsize = 2.71, bins = 4697 74 74
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.9 | 40.91 | 40.92 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.8732271e-14  2.3619681e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00029430248  2.3619681e-13  0             -0.00088290744  23149.398      0              1.1178016e+09  1.1971759e-13  0              4.616439     
    200000   12727.922      200            200           -0.00044737335  2.3619681e-13  0             -0.00134212     79445.394      0              3.8361337e+09  1.1971759e-13  0              4.2336771    
    300000   12727.922      200            200           -4.1169235e-05  2.3619681e-13  0             -0.0001235077   464.52637      0              22430316       1.1971759e-13  0              4.1847073    
    400000   12727.922      200            200            0.0079368441   6.512938e-05   0              0.023745403    10265.261      0              4.9567273e+08  1.1971759e-13  0              4.1549235    
    500000   12727.922      200            200            0.0023052898   0.00030724665  0              0.0066086227   608.34467      0              29374787       1.1971759e-13  0              4.157322     
    600000   12727.922      200            200            0.0072479775  -2.9721432e-05  0              0.021773654    0.00025074272  0              12.107469      1.1971759e-13  0              4.1551942    
    700000   12727.922      200            200            0.005635007    0.00026650295  0              0.016638518    27.328791      0              1319609.5      1.1971759e-13  0              4.1558024    
    800000   12727.922      200            200            0.0053372323   0.00029171262  0              0.015719984    0.74831556     0              36133.48       1.1971759e-13  0              4.1559166    
    900000   12727.922      200            200            0.0054864848   0.00030575405  0              0.0161537      0.25288967     0              12211.137      1.1971759e-13  0              4.1558597    
   1000000   12727.922      200            200            0.0055592872   0.0003030257   0              0.016374836    0.053910185    0              2603.1299      1.1971759e-13  0              4.1558317    
   1100000   12727.922      200            200            0.0055570829   0.00030362488  0              0.016367624    0.00017047305  0              8.2315336      1.1971759e-13  0              4.1558328    
   1200000   12727.922      200            200            0.0055466676   0.00030371305  0              0.01633629     0.0011702834   0              56.508798      1.1971759e-13  0              4.1558368    
   1300000   12727.922      200            200            0.0055445378   0.0003037319   0              0.016329881    3.9939051e-05  0              1.9285138      1.1971759e-13  0              4.1558376    
   1400000   12727.922      200            200            0.0055454314   0.0003037235   0              0.016332571    9.5971064e-06  0              0.46340992     1.1971759e-13  0              4.1558373    
   1500000   12727.922      200            200            0.005545928    0.00030371901  0              0.016334065    2.4925954e-06  0              0.12035851     1.1971759e-13  0              4.1558371    
   1600000   12727.922      200            200            0.0055459253   0.00030371907  0              0.016334057    1.8562497e-09  0              8.9631655e-05  1.1971759e-13  0              4.1558371    
   1700000   12727.922      200            200            0.0055458581   0.00030371968  0              0.016333855    4.9267832e-08  0              0.0023789673   1.1971759e-13  0              4.1558371    
   1800000   12727.922      200            200            0.0055458426   0.00030371982  0              0.016333808    2.1708005e-09  0              0.00010482019  1.1971759e-13  0              4.1558371    
   1900000   12727.922      200            200            0.0055458479   0.00030371977  0              0.016333824    3.5287332e-10  0              1.703899e-05   1.1971759e-13  0              4.1558371    
   2000000   12727.922      200            200            0.0055458513   0.00030371974  0              0.016333834    1.1416227e-10  0              5.5124874e-06  1.1971759e-13  0              4.1558371    
   2100000   12727.922      200            200            0.0055458513   0.00030371974  0              0.016333834    5.0618483e-21  0              2.4441854e-16  1.1971759e-13  0              4.1558371    
   2200000   12727.922      200            200            0.0055458509   0.00030371974  0              0.016333833    2.0523837e-12  0              9.9102265e-08  1.1971759e-13  0              4.1558371    
   2300000   12727.922      200            200            0.0055458508   0.00030371975  0              0.016333833    1.1618175e-13  0              5.6100011e-09  1.1971759e-13  0              4.1558371    
   2400000   12727.922      200            200            0.0055458508   0.00030371975  0              0.016333833    1.2164932e-14  0              5.8740101e-10  1.1971759e-13  0              4.1558371    
   2500000   12727.922      200            200            0.0055458509   0.00030371974  0              0.016333833    5.228173e-15   0              2.5244976e-10  1.1971759e-13  0              4.1558371    
   2600000   12727.922      200            200            0.0055458509   0.00030371974  0              0.016333833    1.1285606e-16  0              5.4494154e-12  1.1971759e-13  0              4.1558371    
   2700000   12727.922      200            200            0.0055458509   0.00030371974  0              0.016333833    2.3871906e-18  0              1.1526889e-13  1.1971759e-13  0              4.1558371    
   2800000   12727.922      200            200            0.0055458509   0.00030371975  0              0.016333833    7.8932552e-20  0              3.8113705e-15  1.1971759e-13  0              4.1558371    
   2900000   12727.922      200            200            0.0055458509   0.00030371974  0              0.016333833    6.1024669e-17  0              2.9466629e-12  1.1971759e-13  0              4.1558371    
   3000000   12727.922      200            200            0.0055458509   0.00030371974  0              0.016333833    9.1366143e-18  0              4.411744e-13   1.1971759e-13  0              4.1558371    
Loop time of 699.214 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3707021.473 ns/day, 0.000 hours/ns, 4290.534 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.07     | 238.71     | 298.35     | 379.0 | 34.14
Neigh   | 1.0515     | 1.0746     | 1.0981     |   1.8 |  0.15
Comm    | 24.681     | 83.224     | 143.04     | 638.6 | 11.90
Output  | 0.4032     | 0.40384    | 0.40449    |   0.1 |  0.06
Modify  | 199.33     | 270.66     | 340.09     | 419.9 | 38.71
Other   |            | 105.1      |            |       | 15.04

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1478.25 ave        2208 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5913
Ave neighs/atom = 1.1823635
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.33                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 174.422669992964
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.43
  ghost atom cutoff = 5.43
  binsize = 2.715, bins = 4689 74 74
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.85 | 40.86 | 40.87 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            7.9905989e-14  2.3971797e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00028320423  2.3971797e-13  0             -0.00084961269  21192.676      0              1.0233185e+09  1.1971759e-13  0              4.621735     
    200000   12727.922      200            200           -0.00043606044  2.3971797e-13  0             -0.0013081813   73935.098      0              3.5700613e+09  1.1971759e-13  0              4.2411092    
    300000   12727.922      200            200           -2.1379179e-05  2.3971797e-13  0             -6.4137536e-05  122.56798      0              5918368.9      1.1971759e-13  0              4.1898692    
    400000   12727.922      200            200            0.0047985227   0.00046823317  0              0.013927335    10583.025      0              5.1101638e+08  1.1971759e-13  0              4.1610838    
    500000   12727.922      200            200            0.0018817841   0.00021671558  0              0.0054286367   284.34018      0              13729770       1.1971759e-13  0              4.16258      
    600000   12727.922      200            200            0.007159798   -2.5541281e-05  0              0.021504935    19.551707      0              944081.97      1.1971759e-13  0              4.1602262    
    700000   12727.922      200            200            0.0058401641   0.00026978549  0              0.017250707    21.897672      0              1057360.2      1.1971759e-13  0              4.1607299    
    800000   12727.922      200            200            0.0053923317   0.00029186125  0              0.015885134    1.980947       0              95652.843      1.1971759e-13  0              4.1609       
    900000   12727.922      200            200            0.0054751484   0.00030539186  0              0.016120053    0.077959333    0              3764.3772      1.1971759e-13  0              4.1608686    
   1000000   12727.922      200            200            0.0055536075   0.00030331197  0              0.016357511    0.066995226    0              3234.9597      1.1971759e-13  0              4.1608384    
   1100000   12727.922      200            200            0.0055632196   0.00030375816  0              0.016385901    0.00080937989  0              39.082058      1.1971759e-13  0              4.1608349    
   1200000   12727.922      200            200            0.0055550191   0.00030382974  0              0.016361228    0.00075323789  0              36.371162      1.1971759e-13  0              4.1608381    
   1300000   12727.922      200            200            0.0055516618   0.0003038602   0              0.016351125    0.00011744098  0              5.6708046      1.1971759e-13  0              4.1608394    
   1400000   12727.922      200            200            0.0055519022   0.00030385771  0              0.016351849    8.251351e-07   0              0.039842821    1.1971759e-13  0              4.1608393    
   1500000   12727.922      200            200            0.005552414    0.00030385294  0              0.016353389    2.8435329e-06  0              0.13730403     1.1971759e-13  0              4.1608391    
   1600000   12727.922      200            200            0.0055525128   0.00030385205  0              0.016353686    9.5875356e-08  0              0.0046294778   1.1971759e-13  0              4.160839     
   1700000   12727.922      200            200            0.0055524694   0.00030385246  0              0.016353556    2.1604434e-08  0              0.0010432008   1.1971759e-13  0              4.1608391    
   1800000   12727.922      200            200            0.005552445    0.00030385269  0              0.016353482    6.2647236e-09  0              0.00030250108  1.1971759e-13  0              4.1608391    
   1900000   12727.922      200            200            0.0055524446   0.00030385269  0              0.016353481    2.8773141e-13  0              1.389352e-08   1.1971759e-13  0              4.1608391    
   2000000   12727.922      200            200            0.0055524478   0.00030385266  0              0.016353491    1.0985298e-10  0              5.3044074e-06  1.1971759e-13  0              4.1608391    
   2100000   12727.922      200            200            0.0055524487   0.00030385265  0              0.016353493    7.5752419e-12  0              3.6578132e-07  1.1971759e-13  0              4.1608391    
   2200000   12727.922      200            200            0.0055524484   0.00030385265  0              0.016353493    4.9343391e-13  0              2.3826158e-08  1.1971759e-13  0              4.1608391    
   2300000   12727.922      200            200            0.0055524483   0.00030385265  0              0.016353492    3.0125736e-13  0              1.454664e-08   1.1971759e-13  0              4.1608391    
   2400000   12727.922      200            200            0.0055524483   0.00030385265  0              0.016353492    2.0401445e-15  0              9.8511276e-11  1.1971759e-13  0              4.1608391    
   2500000   12727.922      200            200            0.0055524483   0.00030385265  0              0.016353492    3.6699616e-15  0              1.7720931e-10  1.1971759e-13  0              4.1608391    
   2600000   12727.922      200            200            0.0055524483   0.00030385265  0              0.016353492    6.6594288e-16  0              3.2155998e-11  1.1971759e-13  0              4.1608391    
   2700000   12727.922      200            200            0.0055524483   0.00030385265  0              0.016353492    7.0905895e-17  0              3.4237919e-12  1.1971759e-13  0              4.1608391    
   2800000   12727.922      200            200            0.0055524483   0.00030385265  0              0.016353492    1.6102973e-17  0              7.7755495e-13  1.1971759e-13  0              4.1608391    
   2900000   12727.922      200            200            0.0055524483   0.00030385265  0              0.016353492    9.3681762e-18  0              4.523557e-13   1.1971759e-13  0              4.1608391    
   3000000   12727.922      200            200            0.0055524483   0.00030385266  0              0.016353492    1.0747742e-17  0              5.1897e-13     1.1971759e-13  0              4.1608391    
Loop time of 692.622 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3742302.823 ns/day, 0.000 hours/ns, 4331.369 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.48     | 236.05     | 292.67     | 362.6 | 34.08
Neigh   | 1.0157     | 1.0387     | 1.0618     |   1.8 |  0.15
Comm    | 23.096     | 80.117     | 138.21     | 620.9 | 11.57
Output  | 0.40442    | 0.40507    | 0.40571    |   0.1 |  0.06
Modify  | 201.69     | 270.38     | 339.44     | 416.5 | 39.04
Other   |            | 104.6      |            |       | 15.11

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1426.75 ave        2105 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5707
Ave neighs/atom = 1.1411718
Neighbor list builds = 122
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.34                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 175.406254167557
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.44
  ghost atom cutoff = 5.44
  binsize = 2.72, bins = 4680 74 74
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.78 | 40.79 | 40.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.1086773e-14  2.4326032e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00027196402  2.4326032e-13  0             -0.00081589206  19323.275      0              9.330518e+08   1.1971759e-13  0              4.62699      
    200000   12727.922      200            200           -0.00042442318  2.4326032e-13  0             -0.0012732695   68628.403      0              3.31382e+09    1.1971759e-13  0              4.248456     
    300000   12727.922      200            200           -1.2794497e-06  2.4326032e-13  0             -3.8383493e-06  0.3644754      0              17599.213      1.1971759e-13  0              4.1949221    
    400000   12727.922      200            200            0.0023578692   0.00035047217  0              0.0067231355   9703.4644      0              4.6854557e+08  1.1971759e-13  0              4.1672291    
    500000   12727.922      200            200            0.0016570741   0.00017966263  0              0.0047915595   69.852778      0              3372940.7      1.1971759e-13  0              4.1677378    
    600000   12727.922      200            200            0.006903859   -1.2135527e-05  0              0.020723713    70.663867      0              3412105.3      1.1971759e-13  0              4.165316     
    700000   12727.922      200            200            0.0060121212   0.00026148381  0              0.01777488     13.146716      0              634807.85      1.1971759e-13  0              4.1656694    
    800000   12727.922      200            200            0.0054678101   0.00029460379  0              0.016108826    3.1526155      0              152228.52      1.1971759e-13  0              4.165876     
    900000   12727.922      200            200            0.0054758572   0.00030738327  0              0.016120188    0.00025221906  0              12.178756      1.1971759e-13  0              4.1658732    
   1000000   12727.922      200            200            0.0055484519   0.00030576189  0              0.016339594    0.058531095    0              2826.2571      1.1971759e-13  0              4.1658451    
   1100000   12727.922      200            200            0.0055679054   0.00030575786  0              0.016397958    0.0041351303   0              199.67064      1.1971759e-13  0              4.1658378    
   1200000   12727.922      200            200            0.0055634236   0.00030579722  0              0.016384473    0.00021805967  0              10.529321      1.1971759e-13  0              4.1658396    
   1300000   12727.922      200            200            0.0055595908   0.00030583105  0              0.016372941    0.00016104386  0              7.7762316      1.1971759e-13  0              4.1658411    
   1400000   12727.922      200            200            0.0055591367   0.00030583493  0              0.016371575    2.2923006e-06  0              0.11068699     1.1971759e-13  0              4.1658412    
   1500000   12727.922      200            200            0.0055595256   0.00030583136  0              0.016372746    1.6523872e-06  0              0.079787863    1.1971759e-13  0              4.1658411    
   1600000   12727.922      200            200            0.0055596937   0.00030582985  0              0.016373251    3.1037951e-07  0              0.014987116    1.1971759e-13  0              4.165841     
   1700000   12727.922      200            200            0.0055596878   0.00030582992  0              0.016373233    3.6177594e-10  0              1.7468865e-05  1.1971759e-13  0              4.165841     
   1800000   12727.922      200            200            0.0055596636   0.00030583014  0              0.016373161    6.3960401e-09  0              0.00030884188  1.1971759e-13  0              4.165841     
   1900000   12727.922      200            200            0.0055596578   0.00030583019  0              0.016373143    3.7916463e-10  0              1.8308503e-05  1.1971759e-13  0              4.165841     
   2000000   12727.922      200            200            0.0055596594   0.00030583017  0              0.016373148    2.8796305e-11  0              1.3904705e-06  1.1971759e-13  0              4.165841     
   2100000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    1.6730473e-11  0              8.0785466e-07  1.1971759e-13  0              4.165841     
   2200000   12727.922      200            200            0.0055596608   0.00030583016  0              0.016373152    1.660641e-13   0              8.018641e-09   1.1971759e-13  0              4.165841     
   2300000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    1.9279761e-13  0              9.3095066e-09  1.1971759e-13  0              4.165841     
   2400000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    3.01887e-14    0              1.4577043e-09  1.1971759e-13  0              4.165841     
   2500000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    8.7394008e-17  0              4.2199439e-12  1.1971759e-13  0              4.165841     
   2600000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    4.7860754e-16  0              2.3110245e-11  1.1971759e-13  0              4.165841     
   2700000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    6.2447079e-17  0              3.015346e-12   1.1971759e-13  0              4.165841     
   2800000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    3.799396e-17   0              1.8345924e-12  1.1971759e-13  0              4.165841     
   2900000   12727.922      200            200            0.0055596606   0.00030583016  0              0.016373152    1.8614587e-18  0              8.9883179e-14  1.1971759e-13  0              4.165841     
   3000000   12727.922      200            200            0.0055596606   0.00030583017  0              0.016373152    9.2671072e-18  0              4.4747544e-13  1.1971759e-13  0              4.165841     
Loop time of 693.304 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3738619.451 ns/day, 0.000 hours/ns, 4327.106 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.87     | 235.17     | 290.27     | 357.3 | 33.92
Neigh   | 0.96481    | 0.98663    | 1.0093     |   1.7 |  0.14
Comm    | 24.028     | 79.219     | 134.03     | 615.7 | 11.43
Output  | 0.40133    | 0.40199    | 0.40264    |   0.1 |  0.06
Modify  | 200.67     | 271.65     | 341.79     | 424.2 | 39.18
Other   |            | 105.9      |            |       | 15.27

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1432.75 ave        2117 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5731
Ave neighs/atom = 1.1459708
Neighbor list builds = 116
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.35                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 176.393529085198
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.45
  ghost atom cutoff = 5.45
  binsize = 2.725, bins = 4671 74 74
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.73 | 40.74 | 40.75 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.2274612e-14  2.4682384e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00026058238  2.4682384e-13  0             -0.00078174714  17541.058      0              8.4699494e+08  1.1971759e-13  0              4.632204     
    200000   12727.922      200            200           -0.00041246357  2.4682384e-13  0             -0.0012373907   63524.656      0              3.0673783e+09  1.1971759e-13  0              4.2557174    
    300000   12727.922      200            200            1.9127169e-05  2.4682384e-13  0              5.7381507e-05  97.005703      0              4684058.2      1.1971759e-13  0              4.1998656    
    400000   12727.922      200            200            0.00072494865 -6.5986995e-05  0              0.0022408329   8116.2542      0              3.9190487e+08  1.1971759e-13  0              4.1733027    
    500000   12727.922      200            200            0.0016015841   0.000166761    0              0.0046379914   0.21735107     0              10495.105      1.1971759e-13  0              4.1727885    
    600000   12727.922      200            200            0.0065505818   0.00011851184  0              0.019533234    133.38244      0              6440560.5      1.1971759e-13  0              4.1704549    
    700000   12727.922      200            200            0.0061352929   0.00025583867  0              0.01815004     4.7296898      0              228379.79      1.1971759e-13  0              4.1706276    
    800000   12727.922      200            200            0.0055546935   0.00029715188  0              0.016366929    3.6964401      0              178487.87      1.1971759e-13  0              4.1708477    
    900000   12727.922      200            200            0.0054884117   0.00030828918  0              0.016156946    0.061990864    0              2993.317       1.1971759e-13  0              4.1708731    
   1000000   12727.922      200            200            0.0055447358   0.0003068191   0              0.016327388    0.034051676    0              1644.2336      1.1971759e-13  0              4.1708511    
   1100000   12727.922      200            200            0.005570546    0.00030636162  0              0.016405276    0.007688819    0              371.26555      1.1971759e-13  0              4.1708413    
   1200000   12727.922      200            200            0.0055705409   0.00030636333  0              0.016405259    1.0815955e-06  0              0.052226374    1.1971759e-13  0              4.1708414    
   1300000   12727.922      200            200            0.0055670655   0.00030639407  0              0.016394803    0.00013122776  0              6.3365191      1.1971759e-13  0              4.1708427    
   1400000   12727.922      200            200            0.0055660436   0.00030640308  0              0.016391728    1.2339041e-05  0              0.59580815     1.1971759e-13  0              4.1708431    
   1500000   12727.922      200            200            0.0055662088   0.00030640151  0              0.016392225    2.5232459e-07  0              0.012183851    1.1971759e-13  0              4.170843     
   1600000   12727.922      200            200            0.0055663945   0.00030639984  0              0.016392784    3.8335181e-07  0              0.018510687    1.1971759e-13  0              4.170843     
   1700000   12727.922      200            200            0.005566427    0.00030639956  0              0.016392882    1.3210157e-08  0              0.0006378712   1.1971759e-13  0              4.170843     
   1800000   12727.922      200            200            0.0055664117   0.0003063997   0              0.016392835    2.4222368e-09  0              0.00011696115  1.1971759e-13  0              4.170843     
   1900000   12727.922      200            200            0.0055664028   0.00030639978  0              0.016392809    8.9466625e-10  0              4.3200231e-05  1.1971759e-13  0              4.170843     
   2000000   12727.922      200            200            0.0055664023   0.00030639978  0              0.016392807    4.8620495e-12  0              2.3477097e-07  1.1971759e-13  0              4.170843     
   2100000   12727.922      200            200            0.0055664033   0.00030639977  0              0.01639281     1.1313394e-11  0              5.462833e-07   1.1971759e-13  0              4.170843     
   2200000   12727.922      200            200            0.0055664037   0.00030639977  0              0.016392811    1.6543066e-12  0              7.9880547e-08  1.1971759e-13  0              4.170843     
   2300000   12727.922      200            200            0.0055664036   0.00030639977  0              0.016392811    6.154606e-15   0              2.971839e-10   1.1971759e-13  0              4.170843     
   2400000   12727.922      200            200            0.0055664036   0.00030639977  0              0.016392811    3.773631e-14   0              1.8221514e-09  1.1971759e-13  0              4.170843     
   2500000   12727.922      200            200            0.0055664036   0.00030639977  0              0.016392811    2.4234858e-15  0              1.1702146e-10  1.1971759e-13  0              4.170843     
   2600000   12727.922      200            200            0.0055664036   0.00030639977  0              0.016392811    3.5523733e-18  0              1.7153139e-13  1.1971759e-13  0              4.170843     
   2700000   12727.922      200            200            0.0055664036   0.00030639977  0              0.016392811    2.3437356e-19  0              1.1317061e-14  1.1971759e-13  0              4.170843     
   2800000   12727.922      200            200            0.0055664036   0.00030639977  0              0.016392811    3.0909806e-17  0              1.4925239e-12  1.1971759e-13  0              4.170843     
   2900000   12727.922      200            200            0.0055664036   0.00030639977  0              0.016392811    9.4312226e-19  0              4.5539999e-14  1.1971759e-13  0              4.170843     
   3000000   12727.922      200            200            0.0055664036   0.00030639978  0              0.016392811    6.9644824e-18  0              3.3628993e-13  1.1971759e-13  0              4.170843     
Loop time of 692.418 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3743405.636 ns/day, 0.000 hours/ns, 4332.645 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.24     | 234.73     | 291.47     | 360.5 | 33.90
Neigh   | 0.93339    | 0.95508    | 0.9758     |   1.7 |  0.14
Comm    | 24.254     | 79.652     | 136.77     | 614.6 | 11.50
Output  | 0.40462    | 0.40525    | 0.4059     |   0.1 |  0.06
Modify  | 199.95     | 271.51     | 340.48     | 416.6 | 39.21
Other   |            | 105.2      |            |       | 15.19

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1439.25 ave        2130 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5757
Ave neighs/atom = 1.1511698
Neighbor list builds = 112
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.36                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 177.384501657393
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.46
  ghost atom cutoff = 5.46
  binsize = 2.73, bins = 4663 74 74
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.68 | 40.7 | 40.71 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.3469494e-14  2.5040848e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00024905988  2.5040848e-13  0             -0.00074717963  15845.895      0              7.6514154e+08  1.1971759e-13  0              4.6373768    
    200000   12727.922      200            200           -0.00040018377  2.5040848e-13  0             -0.0012005513   58623.243      0              2.8307066e+09  1.1971759e-13  0              4.262893     
    300000   12727.922      200            200            3.9837685e-05  2.5040848e-13  0              0.00011951305  411.58242      0              19873842       1.1971759e-13  0              4.2046994    
    400000   12727.922      200            200            2.7248033e-05  1.3303056e-05  0              6.8441043e-05  6300.9575      0              3.0425069e+08  1.1971759e-13  0              4.1792686    
    500000   12727.922      200            200            0.0017027181   0.00016072856  0              0.0049474256   85.685881      0              4137464.5      1.1971759e-13  0              4.1777301    
    600000   12727.922      200            200            0.0061021537   0.00022393984  0              0.018082521    184.09891      0              8889477.5      1.1971759e-13  0              4.1756294    
    700000   12727.922      200            200            0.0061930593   0.00024849066  0              0.018330687    0.23429951     0              11313.485      1.1971759e-13  0              4.1756094    
    800000   12727.922      200            200            0.0056435378   0.00030049588  0              0.016630118    3.3432394      0              161433.06      1.1971759e-13  0              4.1758188    
    900000   12727.922      200            200            0.0055104769   0.00030344875  0              0.016227982    0.22747981     0              10984.186      1.1971759e-13  0              4.1758687    
   1000000   12727.922      200            200            0.005542841    0.0003023089   0              0.016326214    0.0092995976   0              449.04429      1.1971759e-13  0              4.1758558    
   1100000   12727.922      200            200            0.0055706025   0.00030157368  0              0.016410234    0.0088737064   0              428.47953      1.1971759e-13  0              4.1758451    
   1200000   12727.922      200            200            0.0055749626   0.00030153516  0              0.016423353    0.00027369138  0              13.215577      1.1971759e-13  0              4.1758435    
   1300000   12727.922      200            200            0.0055725778   0.00030155741  0              0.016416176    5.5617015e-05  0              2.6855466      1.1971759e-13  0              4.1758445    
   1400000   12727.922      200            200            0.0055712469   0.0003015697   0              0.016412171    2.0741034e-05  0              1.0015103      1.1971759e-13  0              4.175845     
   1500000   12727.922      200            200            0.00557115     0.00030157052  0              0.016411879    1.8120622e-07  0              0.0087498      1.1971759e-13  0              4.175845     
   1600000   12727.922      200            200            0.0055712982   0.00030156912  0              0.016412325    2.2815346e-07  0              0.011016714    1.1971759e-13  0              4.1758449    
   1700000   12727.922      200            200            0.0055713576   0.00030156857  0              0.016412504    4.2714581e-08  0              0.0020625342   1.1971759e-13  0              4.1758449    
   1800000   12727.922      200            200            0.0055713563   0.00030156858  0              0.0164125      4.0915125e-13  0              1.975645e-08   1.1971759e-13  0              4.1758449    
   1900000   12727.922      200            200            0.0055713479   0.00030156866  0              0.016412475    7.5763019e-10  0              3.658325e-05   1.1971759e-13  0              4.1758449    
   2000000   12727.922      200            200            0.0055713455   0.00030156869  0              0.016412468    7.5755366e-11  0              3.6579555e-06  1.1971759e-13  0              4.1758449    
   2100000   12727.922      200            200            0.0055713458   0.00030156868  0              0.016412469    9.3684118e-13  0              4.5236708e-08  1.1971759e-13  0              4.1758449    
   2200000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     2.1623633e-12  0              1.0441279e-07  1.1971759e-13  0              4.1758449    
   2300000   12727.922      200            200            0.0055713464   0.00030156868  0              0.01641247     1.094583e-13   0              5.2853494e-09  1.1971759e-13  0              4.1758449    
   2400000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     9.063007e-15   0              4.3762017e-10  1.1971759e-13  0              4.1758449    
   2500000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     5.4342815e-15  0              2.6240201e-10  1.1971759e-13  0              4.1758449    
   2600000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     3.1687803e-16  0              1.5300906e-11  1.1971759e-13  0              4.1758449    
   2700000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     3.3726859e-17  0              1.6285493e-12  1.1971759e-13  0              4.1758449    
   2800000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     5.8278397e-18  0              2.8140552e-13  1.1971759e-13  0              4.1758449    
   2900000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     3.1845349e-17  0              1.5376979e-12  1.1971759e-13  0              4.1758449    
   3000000   12727.922      200            200            0.0055713463   0.00030156868  0              0.01641247     1.1837966e-17  0              5.7161301e-13  1.1971759e-13  0              4.1758449    
Loop time of 690.057 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3756212.390 ns/day, 0.000 hours/ns, 4347.468 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.12     | 234.63     | 290.34     | 360.3 | 34.00
Neigh   | 0.9214     | 0.94268    | 0.9647     |   1.8 |  0.14
Comm    | 23.548     | 78.825     | 134.69     | 621.3 | 11.42
Output  | 0.41469    | 0.41534    | 0.41599    |   0.1 |  0.06
Modify  | 199.35     | 269.77     | 339.41     | 419.2 | 39.09
Other   |            | 105.5      |            |       | 15.29

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1445.75 ave        2142 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5783
Ave neighs/atom = 1.1563687
Neighbor list builds = 112
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.37                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 178.379178795646
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.47
  ghost atom cutoff = 5.47
  binsize = 2.735, bins = 4654 74 74
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.64 | 40.64 | 40.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.4671409e-14  2.5401423e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00023739704  2.5401423e-13  0             -0.00071219111  14237.648      0              6.8748504e+08  1.1971759e-13  0              4.6425083    
    200000   12727.922      200            200           -0.00038758578  2.5401423e-13  0             -0.0011627574   53923.509      0              2.6037733e+09  1.1971759e-13  0              4.2699826    
    300000   12727.922      200            200            6.0849345e-05  2.5401423e-13  0              0.00018254804  943.18924      0              45543233       1.1971759e-13  0              4.2094231    
    400000   12727.922      200            200           -0.0001251403   2.5401423e-13  0             -0.0003754209   4593.8064      0              2.2181847e+08  1.1971759e-13  0              4.1851085    
    500000   12727.922      200            200            0.0019636742   0.00014349939  0              0.0057475233   311.76587      0              15054058       1.1971759e-13  0              4.1825646    
    600000   12727.922      200            200            0.0056096135   0.00029255005  0              0.016536291    204.86878      0              9892380.1      1.1971759e-13  0              4.1808233    
    700000   12727.922      200            200            0.006179124    0.0002420833   0              0.018295289    1.5810251      0              76342.044      1.1971759e-13  0              4.1806171    
    800000   12727.922      200            200            0.0057211362   0.00029609535  0              0.016867313    2.2595902      0              109107.53      1.1971759e-13  0              4.1807934    
    900000   12727.922      200            200            0.0055411235   0.0002973586   0              0.016326012    0.4030204      0              19460.413      1.1971759e-13  0              4.1808607    
   1000000   12727.922      200            200            0.0055454101   0.00029669532  0              0.016339535    5.595282e-05   0              2.7017614      1.1971759e-13  0              4.1808586    
   1100000   12727.922      200            200            0.0055705233   0.00029592287  0              0.016415647    0.006839557    0              330.25773      1.1971759e-13  0              4.1808489    
   1200000   12727.922      200            200            0.0055783158   0.00029584538  0              0.016439102    0.0008070675   0              38.970401      1.1971759e-13  0              4.180846     
   1300000   12727.922      200            200            0.0055775016   0.00029585403  0              0.016436651    2.8313064e-06  0              0.13671366     1.1971759e-13  0              4.1808463    
   1400000   12727.922      200            200            0.0055761865   0.00029586712  0              0.016432692    1.9082666e-05  0              0.92143365     1.1971759e-13  0              4.1808468    
   1500000   12727.922      200            200            0.00557586     0.00029587031  0              0.01643171     1.4930482e-06  0              0.072093954    1.1971759e-13  0              4.1808469    
   1600000   12727.922      200            200            0.0055759282   0.00029586959  0              0.016431915    3.2790525e-08  0              0.0015833371   1.1971759e-13  0              4.1808469    
   1700000   12727.922      200            200            0.0055759946   0.00029586893  0              0.016432115    5.0142216e-08  0              0.0024211882   1.1971759e-13  0              4.1808469    
   1800000   12727.922      200            200            0.0055760074   0.00029586881  0              0.016432153    2.4915586e-09  0              0.00012030845  1.1971759e-13  0              4.1808469    
   1900000   12727.922      200            200            0.0055760028   0.00029586885  0              0.016432139    1.8218504e-10  0              8.7970637e-06  1.1971759e-13  0              4.1808469    
   2000000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     1.2475738e-10  0              6.0240875e-06  1.1971759e-13  0              4.1808469    
   2100000   12727.922      200            200            0.0055759991   0.00029586889  0              0.016432128    3.5709905e-12  0              1.7243035e-07  1.1971759e-13  0              4.1808469    
   2200000   12727.922      200            200            0.0055759993   0.00029586889  0              0.016432129    7.6206297e-13  0              3.6797293e-08  1.1971759e-13  0              4.1808469    
   2300000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     2.9536062e-13  0              1.4261907e-08  1.1971759e-13  0              4.1808469    
   2400000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     4.3421421e-15  0              2.096665e-10   1.1971759e-13  0              4.1808469    
   2500000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     2.4625304e-15  0              1.1890678e-10  1.1971759e-13  0              4.1808469    
   2600000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     7.1806301e-16  0              3.4672693e-11  1.1971759e-13  0              4.1808469    
   2700000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     9.852057e-17   0              4.7572057e-12  1.1971759e-13  0              4.1808469    
   2800000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     5.1046127e-18  0              2.4648348e-13  1.1971759e-13  0              4.1808469    
   2900000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     4.2978692e-17  0              2.0752872e-12  1.1971759e-13  0              4.1808469    
   3000000   12727.922      200            200            0.0055759995   0.00029586889  0              0.01643213     9.6848149e-18  0              4.6764505e-13  1.1971759e-13  0              4.1808469    
Loop time of 694.007 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3734835.231 ns/day, 0.000 hours/ns, 4322.726 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.26     | 236.28     | 292.91     | 367.8 | 34.05
Neigh   | 0.92573    | 0.94703    | 0.9685     |   1.7 |  0.14
Comm    | 23.721     | 80.866     | 137.99     | 627.5 | 11.65
Output  | 0.40418    | 0.4048     | 0.40543    |   0.1 |  0.06
Modify  | 200.49     | 270.42     | 340.52     | 420.2 | 38.96
Other   |            | 105.1      |            |       | 15.14

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1451.25 ave        2154 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5805
Ave neighs/atom = 1.1607678
Neighbor list builds = 114
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.38                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 179.377567411459
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.48
  ghost atom cutoff = 5.48
  binsize = 2.74, bins = 4646 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.89 | 39.89 | 39.89 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.5880344e-14  2.5764103e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00022559442  2.5764103e-13  0             -0.00067678327  12716.187      0              6.1401915e+08  1.1971759e-13  0              4.6475983    
    200000   12727.922      200            200           -0.00037467173  2.5764103e-13  0             -0.0011240152   49424.836      0              2.3865484e+09  1.1971759e-13  0              4.2769859    
    300000   12727.922      200            200            8.2159213e-05  2.5764103e-13  0              0.00024647764  1690.9196      0              81648457       1.1971759e-13  0              4.2140363    
    400000   12727.922      200            200           -0.00010460387  2.5764103e-13  0             -0.00031381161  3147.1816      0              1.5196614e+08  1.1971759e-13  0              4.190817     
    500000   12727.922      200            200            0.0023993549   9.3438235e-05  0              0.0071046263   638.70136      0              30840603       1.1971759e-13  0              4.1872988    
    600000   12727.922      200            200            0.0051054916   0.00026766901  0              0.015048806    189.56456      0              9153394.2      1.1971759e-13  0              4.186019     
    700000   12727.922      200            200            0.0060958304   0.00023755974  0              0.018049931    8.1395624      0              393030.34      1.1971759e-13  0              4.1856501    
    800000   12727.922      200            200            0.0057801996   0.00029065927  0              0.01704994     0.97391428     0              47026.835      1.1971759e-13  0              4.1857748    
    900000   12727.922      200            200            0.0055768155   0.00029068199  0              0.016439764    0.48931341     0              23627.194      1.1971759e-13  0              4.1858508    
   1000000   12727.922      200            200            0.005553113    0.0002909395   0              0.016368399    0.012045031    0              581.61144      1.1971759e-13  0              4.1858594    
   1100000   12727.922      200            200            0.0055714968   0.00029025633  0              0.016424234    0.0030779039   0              148.62096      1.1971759e-13  0              4.1858522    
   1200000   12727.922      200            200            0.00558117     0.00029015174  0              0.016453358    0.0011634506   0              56.178865      1.1971759e-13  0              4.1858486    
   1300000   12727.922      200            200            0.0055820592   0.00029014313  0              0.016456034    1.9958756e-05  0              0.96373688     1.1971759e-13  0              4.1858483    
   1400000   12727.922      200            200            0.0055810715   0.00029015363  0              0.016453061    9.0933632e-06  0              0.43908596     1.1971759e-13  0              4.1858486    
   1500000   12727.922      200            200            0.0055806073   0.00029015848  0              0.016451664    2.7304496e-06  0              0.13184364     1.1971759e-13  0              4.1858488    
   1600000   12727.922      200            200            0.0055805777   0.00029015875  0              0.016451574    2.9776715e-08  0              0.001437811    1.1971759e-13  0              4.1858488    
   1700000   12727.922      200            200            0.0055806297   0.0002901582   0              0.016451731    2.6050918e-08  0              0.0012579056   1.1971759e-13  0              4.1858488    
   1800000   12727.922      200            200            0.0055806518   0.00029015797  0              0.016451797    6.3227981e-09  0              0.00030530529  1.1971759e-13  0              4.1858488    
   1900000   12727.922      200            200            0.0055806525   0.00029015796  0              0.0164518      3.7426011e-11  0              1.8071681e-06  1.1971759e-13  0              4.1858488    
   2000000   12727.922      200            200            0.0055806498   0.00029015799  0              0.016451791    7.2762574e-11  0              3.5134443e-06  1.1971759e-13  0              4.1858488    
   2100000   12727.922      200            200            0.0055806488   0.000290158    0              0.016451788    1.4435547e-11  0              6.970409e-07   1.1971759e-13  0              4.1858488    
   2200000   12727.922      200            200            0.0055806488   0.000290158    0              0.016451788    3.3484725e-14  0              1.6168575e-09  1.1971759e-13  0              4.1858488    
   2300000   12727.922      200            200            0.0055806489   0.000290158    0              0.016451789    1.9719754e-13  0              9.5219634e-09  1.1971759e-13  0              4.1858488    
   2400000   12727.922      200            200            0.005580649    0.000290158    0              0.016451789    3.2656032e-14  0              1.5768429e-09  1.1971759e-13  0              4.1858488    
   2500000   12727.922      200            200            0.005580649    0.000290158    0              0.016451789    4.0490351e-17  0              1.9551341e-12  1.1971759e-13  0              4.1858488    
   2600000   12727.922      200            200            0.005580649    0.000290158    0              0.016451789    2.592217e-16   0              1.2516888e-11  1.1971759e-13  0              4.1858488    
   2700000   12727.922      200            200            0.005580649    0.000290158    0              0.016451789    2.0130137e-17  0              9.7201226e-13  1.1971759e-13  0              4.1858488    
   2800000   12727.922      200            200            0.005580649    0.000290158    0              0.016451789    5.6127815e-17  0              2.7102113e-12  1.1971759e-13  0              4.1858488    
   2900000   12727.922      200            200            0.005580649    0.000290158    0              0.016451789    5.7486167e-20  0              2.7758013e-15  1.1971759e-13  0              4.1858488    
   3000000   12727.922      200            200            0.005580649    0.00029015799  0              0.016451789    7.4991971e-18  0              3.6210939e-13  1.1971759e-13  0              4.1858488    
Loop time of 695.146 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3728713.398 ns/day, 0.000 hours/ns, 4315.641 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.29     | 236.51     | 294.86     | 364.6 | 34.02
Neigh   | 0.92357    | 0.94492    | 0.96583    |   1.7 |  0.14
Comm    | 21.901     | 80.301     | 138.54     | 621.7 | 11.55
Output  | 0.40165    | 0.40229    | 0.40294    |   0.1 |  0.06
Modify  | 201.35     | 271.18     | 341.38     | 418.5 | 39.01
Other   |            | 105.8      |            |       | 15.22

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1457.75 ave        2166 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5831
Ave neighs/atom = 1.1659668
Neighbor list builds = 114
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.39                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 180.379674416337
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.49
  ghost atom cutoff = 5.49
  binsize = 2.745, bins = 4637 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.84 | 39.85 | 39.86 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.709629e-14   2.6128887e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00021365257  2.6128887e-13  0             -0.0006409577   11281.377      0              5.4473732e+08  1.1971759e-13  0              4.6526469    
    200000   12727.922      200            200           -0.00036144368  2.6128887e-13  0             -0.0010843311   45126.584      0              2.1790013e+09  1.1971759e-13  0              4.2839026    
    300000   12727.922      200            200            0.00010376442  2.6128887e-13  0              0.00031129326  2653.8695      0              1.2814586e+08  1.1971759e-13  0              4.2185388    
    400000   12727.922      200            200           -8.3682012e-05  2.6128887e-13  0             -0.00025104604  1975.0595      0              95368553       1.1971759e-13  0              4.1963936    
    500000   12727.922      200            200            0.0030988137   0.00018927741  0              0.0091071638   1001.5778      0              48362607       1.1971759e-13  0              4.1919448    
    600000   12727.922      200            200            0.0046662693   0.00025186974  0              0.013746938    144.84615      0              6994102.3      1.1971759e-13  0              4.1911992    
    700000   12727.922      200            200            0.0059594746   0.00025085308  0              0.017627571    17.00716       0              821214.87      1.1971759e-13  0              4.1907048    
    800000   12727.922      200            200            0.0058130493   0.0002830721   0              0.017156076    0.11896636     0              5744.4598      1.1971759e-13  0              4.1907657    
    900000   12727.922      200            200            0.0056132494   0.00028422845  0              0.01655552     0.43736559     0              21118.819      1.1971759e-13  0              4.1908407    
   1000000   12727.922      200            200            0.0055656626   0.00028571958  0              0.016411268    0.037339171    0              1802.9749      1.1971759e-13  0              4.1908585    
   1100000   12727.922      200            200            0.0055744273   0.00028518441  0              0.016438097    0.00031673581  0              15.294039      1.1971759e-13  0              4.1908549    
   1200000   12727.922      200            200            0.0055841207   0.00028507467  0              0.016467288    0.0010536474   0              50.876864      1.1971759e-13  0              4.1908512    
   1300000   12727.922      200            200            0.0055864826   0.00028504964  0              0.016474398    9.0528501e-05  0              4.3712973      1.1971759e-13  0              4.1908504    
   1400000   12727.922      200            200            0.0055860475   0.00028505457  0              0.016473088    7.4973139e-07  0              0.036201845    1.1971759e-13  0              4.1908505    
   1500000   12727.922      200            200            0.0055855711   0.00028505973  0              0.016471654    2.5402951e-06  0              0.12266176     1.1971759e-13  0              4.1908507    
   1600000   12727.922      200            200            0.0055854548   0.00028506096  0              0.016471304    2.1928156e-07  0              0.010588322    1.1971759e-13  0              4.1908508    
   1700000   12727.922      200            200            0.0055854761   0.00028506072  0              0.016471368    1.7724326e-09  0              8.5584429e-05  1.1971759e-13  0              4.1908508    
   1800000   12727.922      200            200            0.0055854995   0.00028506047  0              0.016471438    6.1239146e-09  0              0.00029570192  1.1971759e-13  0              4.1908507    
   1900000   12727.922      200            200            0.0055855052   0.00028506041  0              0.016471455    5.3120799e-10  0              2.5650133e-05  1.1971759e-13  0              4.1908507    
   2000000   12727.922      200            200            0.0055855042   0.00028506042  0              0.016471452    4.1865688e-12  0              2.0215442e-07  1.1971759e-13  0              4.1908507    
   2100000   12727.922      200            200            0.005585503    0.00028506043  0              0.016471449    1.4760396e-11  0              7.127267e-07   1.1971759e-13  0              4.1908507    
   2200000   12727.922      200            200            0.0055855027   0.00028506043  0              0.016471448    1.2853512e-12  0              6.206501e-08   1.1971759e-13  0              4.1908507    
   2300000   12727.922      200            200            0.0055855028   0.00028506043  0              0.016471448    1.0093455e-14  0              4.8737683e-10  1.1971759e-13  0              4.1908507    
   2400000   12727.922      200            200            0.0055855029   0.00028506043  0              0.016471448    3.5426019e-14  0              1.7105957e-09  1.1971759e-13  0              4.1908507    
   2500000   12727.922      200            200            0.0055855029   0.00028506043  0              0.016471448    3.2569776e-15  0              1.5726779e-10  1.1971759e-13  0              4.1908507    
   2600000   12727.922      200            200            0.0055855029   0.00028506043  0              0.016471448    3.4008499e-17  0              1.6421487e-12  1.1971759e-13  0              4.1908507    
   2700000   12727.922      200            200            0.0055855029   0.00028506043  0              0.016471448    6.3289094e-18  0              3.0560039e-13  1.1971759e-13  0              4.1908507    
   2800000   12727.922      200            200            0.0055855029   0.00028506043  0              0.016471448    3.7188091e-17  0              1.7956798e-12  1.1971759e-13  0              4.1908507    
   2900000   12727.922      200            200            0.0055855029   0.00028506044  0              0.016471448    4.4848992e-20  0              2.1655973e-15  1.1971759e-13  0              4.1908507    
   3000000   12727.922      200            200            0.0055855029   0.00028506042  0              0.016471448    7.3338981e-18  0              3.5412769e-13  1.1971759e-13  0              4.1908507    
Loop time of 694.462 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3732387.077 ns/day, 0.000 hours/ns, 4319.892 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.01     | 236.17     | 293.67     | 364.7 | 34.01
Neigh   | 0.93175    | 0.95388    | 0.97558    |   1.8 |  0.14
Comm    | 24.62      | 80.686     | 139.59     | 619.1 | 11.62
Output  | 0.39733    | 0.39797    | 0.39861    |   0.1 |  0.06
Modify  | 199.17     | 270.51     | 340.47     | 417.8 | 38.95
Other   |            | 105.7      |            |       | 15.23

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1463.25 ave        2178 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5853
Ave neighs/atom = 1.1703659
Neighbor list builds = 116
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.4                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 181.385506721783
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.5
  ghost atom cutoff = 5.5
  binsize = 2.75, bins = 4629 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.8 | 39.81 | 39.82 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.8319236e-14  2.6495771e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00020157205  2.6495771e-13  0             -0.00060471615  9933.0913      0              4.7963343e+08  1.1971759e-13  0              4.6576537    
    200000   12727.922      200            200           -0.00034790376  2.6495771e-13  0             -0.0010437113   41028.138      0              1.981102e+09   1.1971759e-13  0              4.2907325    
    300000   12727.922      200            200            0.00012566203  2.6495771e-13  0              0.00037698608  3831.132       0              1.8499165e+08  1.1971759e-13  0              4.22293      
    400000   12727.922      200            200           -6.237884e-05   2.6495771e-13  0             -0.00018713652  1076.0578      0              51958980       1.1971759e-13  0              4.2018378    
    500000   12727.922      200            200            0.0040063229   0.00020397788  0              0.011814991    1315.0768      0              63500351       1.1971759e-13  0              4.1965209    
    600000   12727.922      200            200            0.0043476604   0.00032217757  0              0.012720804    86.628622      0              4182986.1      1.1971759e-13  0              4.1963488    
    700000   12727.922      200            200            0.0057892585   0.00028484799  0              0.017082928    24.322723      0              1174457.2      1.1971759e-13  0              4.1957754    
    800000   12727.922      200            200            0.0058167152   0.00027653879  0              0.017173607    0.11564589     0              5584.1264      1.1971759e-13  0              4.1957676    
    900000   12727.922      200            200            0.0056454971   0.0002774237   0              0.016659068    0.27645839     0              13349.186      1.1971759e-13  0              4.195832     
   1000000   12727.922      200            200            0.0055814565   0.00028010812  0              0.016464261    0.059515547    0              2873.7928      1.1971759e-13  0              4.1958562    
   1100000   12727.922      200            200            0.0055793606   0.00027975061  0              0.016458331    0.00053451378  0              25.809757      1.1971759e-13  0              4.1958568    
   1200000   12727.922      200            200            0.0055872588   0.00027965542  0              0.016482121    0.00056917282  0              27.483319      1.1971759e-13  0              4.1958538    
   1300000   12727.922      200            200            0.0055905583   0.00027961778  0              0.016492057    0.00015025094  0              7.2550802      1.1971759e-13  0              4.1958525    
   1400000   12727.922      200            200            0.0055907644   0.00027961571  0              0.016492677    2.2586613e-06  0              0.10906267     1.1971759e-13  0              4.1958525    
   1500000   12727.922      200            200            0.0055904008   0.00027961991  0              0.016491582    1.1398516e-06  0              0.055039353    1.1971759e-13  0              4.1958526    
   1600000   12727.922      200            200            0.0055902336   0.0002796218   0              0.016491079    3.7366936e-07  0              0.018043156    1.1971759e-13  0              4.1958527    
   1700000   12727.922      200            200            0.0055902183   0.00027962197  0              0.016491033    8.3439266e-09  0              0.00040289835  1.1971759e-13  0              4.1958527    
   1800000   12727.922      200            200            0.0055902348   0.00027962177  0              0.016491083    2.2043427e-09  0              0.00010643982  1.1971759e-13  0              4.1958527    
   1900000   12727.922      200            200            0.0055902432   0.00027962168  0              0.016491108    9.1633883e-10  0              4.4246723e-05  1.1971759e-13  0              4.1958527    
   2000000   12727.922      200            200            0.0055902442   0.00027962167  0              0.016491111    2.8257669e-11  0              1.3644617e-06  1.1971759e-13  0              4.1958527    
   2100000   12727.922      200            200            0.0055902435   0.00027962168  0              0.016491109    4.0854341e-12  0              1.9727099e-07  1.1971759e-13  0              4.1958527    
   2200000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    2.2168329e-12  0              1.0704293e-07  1.1971759e-13  0              4.1958527    
   2300000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    8.8190378e-14  0              4.2583977e-09  1.1971759e-13  0              4.1958527    
   2400000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    7.3042437e-15  0              3.5269579e-10  1.1971759e-13  0              4.1958527    
   2500000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    5.2147584e-15  0              2.5180202e-10  1.1971759e-13  0              4.1958527    
   2600000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    5.4526102e-16  0              2.6328703e-11  1.1971759e-13  0              4.1958527    
   2700000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    8.593024e-17   0              4.1492638e-12  1.1971759e-13  0              4.1958527    
   2800000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    1.4787278e-18  0              7.1402474e-14  1.1971759e-13  0              4.1958527    
   2900000   12727.922      200            200            0.005590243    0.00027962168  0              0.016491107    2.692695e-17   0              1.3002061e-12  1.1971759e-13  0              4.1958527    
   3000000   12727.922      200            200            0.005590243    0.00027962167  0              0.016491107    3.3602141e-19  0              1.6225271e-14  1.1971759e-13  0              4.1958527    
Loop time of 698.163 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3712599.917 ns/day, 0.000 hours/ns, 4296.991 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.36     | 237.63     | 296.86     | 375.6 | 34.04
Neigh   | 0.94151    | 0.9642     | 0.98643    |   1.8 |  0.14
Comm    | 22.936     | 82.506     | 141.49     | 635.5 | 11.82
Output  | 0.40239    | 0.40303    | 0.40368    |   0.1 |  0.06
Modify  | 201.97     | 271.49     | 340.9      | 419.2 | 38.89
Other   |            | 105.2      |            |       | 15.06

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1468.75 ave        2189 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5875
Ave neighs/atom = 1.174765
Neighbor list builds = 118
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.41                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 182.395071239302
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.51
  ghost atom cutoff = 5.51
  binsize = 2.755, bins = 4620 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.73 | 39.74 | 39.75 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            8.9549171e-14  2.6864751e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00018935339  2.6864751e-13  0             -0.00056806017  8671.1941      0              4.1870093e+08  1.1971759e-13  0              4.6626188    
    200000   12727.922      200            200           -0.00033405399  2.6864751e-13  0             -0.001002162    37128.848      0              1.7928192e+09  1.1971759e-13  0              4.2974752    
    300000   12727.922      200            200            0.00014784927  2.6864751e-13  0              0.0004435478   5221.8119      0              2.5214261e+08  1.1971759e-13  0              4.2272098    
    400000   12727.922      200            200           -4.0698342e-05  2.6864751e-13  0             -0.00012209503  448.79282      0              21670599       1.1971759e-13  0              4.2071493    
    500000   12727.922      200            200            0.0051352067   0.00020046543  0              0.015205155    1488.7213      0              71885023       1.1971759e-13  0              4.2010521    
    600000   12727.922      200            200            0.0041197406   0.00033201578  0              0.012027206    34.096056      0              1646376.5      1.1971759e-13  0              4.2014558    
    700000   12727.922      200            200            0.0055850876   0.00027249212  0              0.016482771    26.979008      0              1302719.8      1.1971759e-13  0              4.2008543    
    800000   12727.922      200            200            0.0057927874   0.00027588879  0              0.017102474    0.95883445     0              46298.684      1.1971759e-13  0              4.2007803    
    900000   12727.922      200            200            0.0056707765   0.00027449235  0              0.016737837    0.097860907    0              4725.353       1.1971759e-13  0              4.2008265    
   1000000   12727.922      200            200            0.0055999706   0.00027812432  0              0.016521787    0.064238516    0              3101.848       1.1971759e-13  0              4.2008534    
   1100000   12727.922      200            200            0.005587588    0.00027794692  0              0.016484817    0.0035361413   0              170.74761      1.1971759e-13  0              4.2008579    
   1200000   12727.922      200            200            0.0055922595   0.00027788817  0              0.01649889     0.00010368314  0              5.0064877      1.1971759e-13  0              4.2008561    
   1300000   12727.922      200            200            0.0055957796   0.00027784625  0              0.016509493    0.00014534652  0              7.0182634      1.1971759e-13  0              4.2008547    
   1400000   12727.922      200            200            0.0055965624   0.00027783726  0              0.01651185     1.19771e-05    0              0.57833129     1.1971759e-13  0              4.2008545    
   1500000   12727.922      200            200            0.0055964035   0.00027783922  0              0.016511371    5.3692645e-08  0              0.0025926257   1.1971759e-13  0              4.2008545    
   1600000   12727.922      200            200            0.0055962349   0.00027784121  0              0.016510863    3.1027411e-07  0              0.014982027    1.1971759e-13  0              4.2008546    
   1700000   12727.922      200            200            0.0055961887   0.00027784175  0              0.016510724    3.6837271e-08  0              0.00177874     1.1971759e-13  0              4.2008546    
   1800000   12727.922      200            200            0.0055961928   0.00027784169  0              0.016510737    4.4942329e-12  0              2.1701042e-07  1.1971759e-13  0              4.2008546    
   1900000   12727.922      200            200            0.0055962007   0.0002778416   0              0.01651076     6.1992219e-10  0              2.9933824e-05  1.1971759e-13  0              4.2008546    
   2000000   12727.922      200            200            0.0055962032   0.00027784157  0              0.016510768    1.0512408e-10  0              5.0760657e-06  1.1971759e-13  0              4.2008546    
   2100000   12727.922      200            200            0.0055962032   0.00027784157  0              0.016510768    5.848309e-13   0              2.8239391e-08  1.1971759e-13  0              4.2008546    
   2200000   12727.922      200            200            0.0055962029   0.00027784157  0              0.016510767    1.1436033e-12  0              5.522051e-08   1.1971759e-13  0              4.2008546    
   2300000   12727.922      200            200            0.0055962027   0.00027784158  0              0.016510767    2.7998666e-13  0              1.3519554e-08  1.1971759e-13  0              4.2008546    
   2400000   12727.922      200            200            0.0055962027   0.00027784158  0              0.016510767    4.6384065e-15  0              2.2397205e-10  1.1971759e-13  0              4.2008546    
   2500000   12727.922      200            200            0.0055962027   0.00027784158  0              0.016510767    1.6901926e-15  0              8.1613353e-11  1.1971759e-13  0              4.2008546    
   2600000   12727.922      200            200            0.0055962027   0.00027784158  0              0.016510767    6.310646e-16   0              3.0471851e-11  1.1971759e-13  0              4.2008546    
   2700000   12727.922      200            200            0.0055962027   0.00027784158  0              0.016510767    6.2142467e-17  0              3.0006374e-12  1.1971759e-13  0              4.2008546    
   2800000   12727.922      200            200            0.0055962027   0.00027784158  0              0.016510767    1.9016623e-18  0              9.1824468e-14  1.1971759e-13  0              4.2008546    
   2900000   12727.922      200            200            0.0055962027   0.00027784158  0              0.016510767    1.2113319e-17  0              5.8490883e-13  1.1971759e-13  0              4.2008546    
   3000000   12727.922      200            200            0.0055962027   0.00027784156  0              0.016510767    3.6542634e-18  0              1.764513e-13   1.1971759e-13  0              4.2008546    
Loop time of 695.514 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3726739.633 ns/day, 0.000 hours/ns, 4313.356 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.37     | 237.23     | 294.57     | 366.0 | 34.11
Neigh   | 0.95522    | 0.97803    | 1.0007     |   1.8 |  0.14
Comm    | 24.731     | 81.009     | 139.15     | 623.9 | 11.65
Output  | 0.40343    | 0.40406    | 0.40472    |   0.1 |  0.06
Modify  | 199.66     | 270.38     | 340        | 418.4 | 38.87
Other   |            | 105.5      |            |       | 15.17

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1473.75 ave        2199 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5895
Ave neighs/atom = 1.1787642
Neighbor list builds = 122
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.42                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 183.408374880398
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.52
  ghost atom cutoff = 5.52
  binsize = 2.76, bins = 4612 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.68 | 39.69 | 39.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.0786084e-14  2.7235825e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00017699714  2.7235825e-13  0             -0.00053099141  7495.5556      0              3.6193355e+08  1.1971759e-13  0              4.667542     
    200000   12727.922      200            200           -0.00031989646  2.7235825e-13  0             -0.00095968939  33428.093      0              1.614123e+09   1.1971759e-13  0              4.3041305    
    300000   12727.922      200            200            0.00017032323  2.7235825e-13  0              0.00051096969  6825.0075      0              3.2955519e+08  1.1971759e-13  0              4.2313776    
    400000   12727.922      200            200           -1.8644533e-05  2.7235825e-13  0             -5.5933598e-05  91.888282      0              4436956.3      1.1971759e-13  0              4.2123277    
    500000   12727.922      200            200            0.0063890986   4.0053114e-05  0              0.019127243    1453.9227      0              70204725       1.1971759e-13  0              4.2055701    
    600000   12727.922      200            200            0.0040068157   0.00032399231  0              0.011696455    3.6913535      0              178242.25      1.1971759e-13  0              4.2065117    
    700000   12727.922      200            200            0.0053889825   0.00027067177  0              0.015896276    23.922523      0              1155133        1.1971759e-13  0              4.205933     
    800000   12727.922      200            200            0.0057434814   0.00027561266  0              0.016954832    2.2187264      0              107134.36      1.1971759e-13  0              4.2058026    
    900000   12727.922      200            200            0.0056847604   0.00027142595  0              0.016782855    0.0029193973   0              140.96725      1.1971759e-13  0              4.2058251    
   1000000   12727.922      200            200            0.0056175502   0.00027518818  0              0.016577462    0.048480852    0              2340.9669      1.1971759e-13  0              4.2058508    
   1100000   12727.922      200            200            0.0055971387   0.00027516723  0              0.016516249    0.0071122999   0              343.42751      1.1971759e-13  0              4.2058584    
   1200000   12727.922      200            200            0.005597789    0.00027515688  0              0.01651821     3.1493263e-05  0              1.520697       1.1971759e-13  0              4.2058581    
   1300000   12727.922      200            200            0.0056007854   0.00027511909  0              0.016527237    8.0571352e-05  0              3.8905022      1.1971759e-13  0              4.2058569    
   1400000   12727.922      200            200            0.0056019471   0.00027510487  0              0.016530736    2.0182915e-05  0              0.97456075     1.1971759e-13  0              4.2058565    
   1500000   12727.922      200            200            0.005602029    0.00027510396  0              0.016530983    4.4550907e-07  0              0.021512038    1.1971759e-13  0              4.2058564    
   1600000   12727.922      200            200            0.0056019073   0.00027510549  0              0.016530616    1.0535748e-07  0              0.0050873358   1.1971759e-13  0              4.2058565    
   1700000   12727.922      200            200            0.0056018456   0.00027510625  0              0.01653043     5.0518185e-08  0              0.0024393423   1.1971759e-13  0              4.2058565    
   1800000   12727.922      200            200            0.0056018362   0.00027510636  0              0.016530402    2.5093441e-09  0              0.00012116724  1.1971759e-13  0              4.2058565    
   1900000   12727.922      200            200            0.0056018406   0.0002751063   0              0.016530415    8.6155304e-11  0              4.1601313e-06  1.1971759e-13  0              4.2058565    
   2000000   12727.922      200            200            0.0056018437   0.00027510626  0              0.016530425    1.1205643e-10  0              5.4108039e-06  1.1971759e-13  0              4.2058565    
   2100000   12727.922      200            200            0.0056018444   0.00027510626  0              0.016530427    1.0019701e-11  0              4.8381551e-07  1.1971759e-13  0              4.2058565    
   2200000   12727.922      200            200            0.0056018442   0.00027510626  0              0.016530426    1.0355244e-14  0              5.0001765e-10  1.1971759e-13  0              4.2058565    
   2300000   12727.922      200            200            0.0056018441   0.00027510626  0              0.016530426    2.178799e-13   0              1.0520641e-08  1.1971759e-13  0              4.2058565    
   2400000   12727.922      200            200            0.005601844    0.00027510626  0              0.016530426    3.2416848e-14  0              1.5652936e-09  1.1971759e-13  0              4.2058565    
   2500000   12727.922      200            200            0.005601844    0.00027510626  0              0.016530426    2.2882373e-16  0              1.1049079e-11  1.1971759e-13  0              4.2058565    
   2600000   12727.922      200            200            0.005601844    0.00027510626  0              0.016530426    9.4072676e-17  0              4.5424328e-12  1.1971759e-13  0              4.2058565    
   2700000   12727.922      200            200            0.0056018441   0.00027510626  0              0.016530426    9.8668066e-19  0              4.7643278e-14  1.1971759e-13  0              4.2058565    
   2800000   12727.922      200            200            0.005601844    0.00027510626  0              0.016530426    4.1981058e-19  0              2.027115e-14   1.1971759e-13  0              4.2058565    
   2900000   12727.922      200            200            0.005601844    0.00027510626  0              0.016530426    4.6060084e-17  0              2.2240766e-12  1.1971759e-13  0              4.2058565    
   3000000   12727.922      200            200            0.005601844    0.00027510625  0              0.016530426    6.7567257e-18  0              3.262581e-13   1.1971759e-13  0              4.2058565    
Loop time of 697.546 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3715885.937 ns/day, 0.000 hours/ns, 4300.794 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.13     | 238.58     | 297.93     | 373.3 | 34.20
Neigh   | 0.98947    | 1.0116     | 1.0342     |   1.8 |  0.15
Comm    | 22.676     | 82.322     | 141.52     | 632.3 | 11.80
Output  | 0.40179    | 0.40242    | 0.40306    |   0.1 |  0.06
Modify  | 200.94     | 269.98     | 339.66     | 416.8 | 38.70
Other   |            | 105.2      |            |       | 15.09

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1479.25 ave        2210 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5917
Ave neighs/atom = 1.1831634
Neighbor list builds = 124
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.43                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 184.425424556573
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.53
  ghost atom cutoff = 5.53
  binsize = 2.765, bins = 4604 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.63 | 39.64 | 39.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.2029967e-14  2.760899e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00016450385  2.760899e-13   0             -0.00049351155  6406.0459      0              3.0932503e+08  1.1971759e-13  0              4.6724231    
    200000   12727.922      200            200           -0.00030543328  2.760899e-13   0             -0.00091629983  29925.244      0              1.4449829e+09  1.1971759e-13  0              4.3106982    
    300000   12727.922      200            200            0.00019308105  2.760899e-13   0              0.00057924315  8639.822       0              4.1718608e+08  1.1971759e-13  0              4.2354331    
    400000   12727.922      200            200            3.7784909e-06  2.760899e-13   0              1.1335472e-05  3.9734389      0              191863.14      1.1971759e-13  0              4.2173726    
    500000   12727.922      200            200            0.0076660354  -0.00027041645  0              0.023268523    1197.1247      0              57804869       1.1971759e-13  0              4.2101118    
    600000   12727.922      200            200            0.0040216636   0.0003234833   0              0.011741508    4.5682834      0              220586.06      1.1971759e-13  0              4.2115123    
    700000   12727.922      200            200            0.0052283836   0.00029776754  0              0.015387383    16.518882      0              797637.69      1.1971759e-13  0              4.2110032    
    800000   12727.922      200            200            0.0056775102   0.00027946253  0              0.016753068    3.2594591      0              157387.61      1.1971759e-13  0              4.2108318    
    900000   12727.922      200            200            0.0056870784   0.00027103261  0              0.016790202    0.044956515    0              2170.7892      1.1971759e-13  0              4.2108284    
   1000000   12727.922      200            200            0.0056332291   0.00027450503  0              0.016625182    0.022449608    0              1084.0112      1.1971759e-13  0              4.2108492    
   1100000   12727.922      200            200            0.0056083423   0.00027464843  0              0.016550379    0.0086538711   0              417.86446      1.1971759e-13  0              4.2108585    
   1200000   12727.922      200            200            0.0056049454   0.000274689    0              0.016540147    0.00040552069  0              19.581143      1.1971759e-13  0              4.2108597    
   1300000   12727.922      200            200            0.0056068039   0.00027466499  0              0.016545747    1.4211334e-05  0              0.68621444     1.1971759e-13  0              4.210859     
   1400000   12727.922      200            200            0.0056080638   0.00027464925  0              0.016549542    1.8765199e-05  0              0.9061043      1.1971759e-13  0              4.2108585    
   1500000   12727.922      200            200            0.0056083593   0.00027464566  0              0.016550432    1.8702734e-06  0              0.090308807    1.1971759e-13  0              4.2108584    
   1600000   12727.922      200            200            0.0056083181   0.00027464621  0              0.016550308    1.0587381e-10  0              5.1122675e-06  1.1971759e-13  0              4.2108584    
   1700000   12727.922      200            200            0.0056082606   0.00027464693  0              0.016550135    3.2043082e-08  0              0.0015472458   1.1971759e-13  0              4.2108584    
   1800000   12727.922      200            200            0.0056082413   0.00027464717  0              0.016550077    6.2078258e-09  0              0.00029975369  1.1971759e-13  0              4.2108584    
   1900000   12727.922      200            200            0.0056082407   0.00027464717  0              0.016550075    1.0120129e-10  0              4.8866481e-06  1.1971759e-13  0              4.2108584    
   2000000   12727.922      200            200            0.005608243    0.00027464714  0              0.016550082    3.8685394e-11  0              1.8679792e-06  1.1971759e-13  0              4.2108584    
   2100000   12727.922      200            200            0.0056082441   0.00027464713  0              0.016550085    1.6306469e-11  0              7.8738105e-07  1.1971759e-13  0              4.2108584    
   2200000   12727.922      200            200            0.0056082442   0.00027464713  0              0.016550086    8.3354396e-13  0              4.0248855e-08  1.1971759e-13  0              4.2108584    
   2300000   12727.922      200            200            0.0056082441   0.00027464713  0              0.016550085    2.0103647e-14  0              9.7073318e-10  1.1971759e-13  0              4.2108584    
   2400000   12727.922      200            200            0.0056082441   0.00027464713  0              0.016550085    3.4052696e-14  0              1.6442828e-09  1.1971759e-13  0              4.2108584    
   2500000   12727.922      200            200            0.0056082441   0.00027464713  0              0.016550085    3.8896164e-15  0              1.8781565e-10  1.1971759e-13  0              4.2108584    
   2600000   12727.922      200            200            0.0056082441   0.00027464713  0              0.016550085    1.4321878e-16  0              6.9155222e-12  1.1971759e-13  0              4.2108584    
   2700000   12727.922      200            200            0.0056082441   0.00027464713  0              0.016550085    2.8556186e-17  0              1.378876e-12   1.1971759e-13  0              4.2108584    
   2800000   12727.922      200            200            0.0056082441   0.00027464713  0              0.016550085    5.5199883e-17  0              2.6654048e-12  1.1971759e-13  0              4.2108584    
   2900000   12727.922      200            200            0.0056082441   0.00027464712  0              0.016550085    2.4101844e-18  0              1.1637918e-13  1.1971759e-13  0              4.2108584    
   3000000   12727.922      200            200            0.0056082441   0.00027464714  0              0.016550085    9.9048139e-18  0              4.7826802e-13  1.1971759e-13  0              4.2108584    
Loop time of 691.967 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3745845.539 ns/day, 0.000 hours/ns, 4335.469 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.63     | 234.6      | 289.55     | 358.3 | 33.90
Neigh   | 0.95595    | 0.97812    | 1.0001     |   1.8 |  0.14
Comm    | 23.027     | 78.609     | 134.29     | 620.3 | 11.36
Output  | 0.40387    | 0.40454    | 0.4052     |   0.1 |  0.06
Modify  | 200.38     | 271.13     | 342.09     | 422.5 | 39.18
Other   |            | 106.2      |            |       | 15.35

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1427.75 ave        2106 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5711
Ave neighs/atom = 1.1419716
Neighbor list builds = 121
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.44                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 185.446227179332
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.54
  ghost atom cutoff = 5.54
  binsize = 2.77, bins = 4595 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.59 | 39.6 | 39.61 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.3280808e-14  2.7984243e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00015187407  2.7984243e-13  0             -0.00045562222  5402.5354      0              2.608691e+08   1.1971759e-13  0              4.6772621    
    200000   12727.922      200            200           -0.00029066652  2.7984243e-13  0             -0.00087199955  26619.675      0              1.2853688e+09  1.1971759e-13  0              4.3171778    
    300000   12727.922      200            200            0.00021611982  2.7984243e-13  0              0.00064835945  10665.356      0              5.1499185e+08  1.1971759e-13  0              4.2393759    
    400000   12727.922      200            200            2.6566654e-05  2.7984243e-13  0              7.9699961e-05  183.67917      0              8869209.6      1.1971759e-13  0              4.2222835    
    500000   12727.922      200            200            0.0089253273  -0.00038860312  0              0.027164585    783.09477      0              37812844       1.1971759e-13  0              4.2147166    
    600000   12727.922      200            200            0.0041613113   0.00032127288  0              0.012162661    36.259219      0              1750827.9      1.1971759e-13  0              4.2164574    
    700000   12727.922      200            200            0.0050955939   0.00027825869  0              0.015008523    7.8914193      0              381048.4       1.1971759e-13  0              4.2160577    
    800000   12727.922      200            200            0.0056029973   0.00028254338  0              0.016526448    3.5604783      0              171922.76      1.1971759e-13  0              4.2158644    
    900000   12727.922      200            200            0.0056771679   0.00026982652  0              0.016761677    0.19859        0              9589.2006      1.1971759e-13  0              4.2158361    
   1000000   12727.922      200            200            0.0056443276   0.00027281713  0              0.016660166    0.002955107    0              142.69154      1.1971759e-13  0              4.2158491    
   1100000   12727.922      200            200            0.0056191901   0.00027312792  0              0.016584442    0.007044947    0              340.17528      1.1971759e-13  0              4.2158586    
   1200000   12727.922      200            200            0.0056124733   0.00027321003  0              0.01656421     0.00091777459  0              44.31605       1.1971759e-13  0              4.2158611    
   1300000   12727.922      200            200            0.0056128328   0.00027320472  0              0.016565294    5.3403863e-06  0              0.25786814     1.1971759e-13  0              4.2158609    
   1400000   12727.922      200            200            0.0056138948   0.00027319123  0              0.016568493    9.1750803e-06  0              0.44303179     1.1971759e-13  0              4.2158605    
   1500000   12727.922      200            200            0.0056143223   0.00027318591  0              0.016569781    2.7777436e-06  0              0.1341273      1.1971759e-13  0              4.2158603    
   1600000   12727.922      200            200            0.0056143713   0.00027318534  0              0.016569929    1.156777e-07   0              0.0055856623   1.1971759e-13  0              4.2158603    
   1700000   12727.922      200            200            0.0056143359   0.00027318579  0              0.016569822    5.0759783e-09  0              0.00024510082  1.1971759e-13  0              4.2158603    
   1800000   12727.922      200            200            0.0056143135   0.00027318607  0              0.016569754    6.0114898e-09  0              0.00029027333  1.1971759e-13  0              4.2158603    
   1900000   12727.922      200            200            0.0056143082   0.00027318614  0              0.016569738    6.3338954e-10  0              3.0584114e-05  1.1971759e-13  0              4.2158603    
   2000000   12727.922      200            200            0.0056143088   0.00027318613  0              0.01656974     7.5887865e-13  0              3.6643534e-08  1.1971759e-13  0              4.2158603    
   2100000   12727.922      200            200            0.0056143098   0.00027318611  0              0.016569743    8.908692e-12   0              4.3016885e-07  1.1971759e-13  0              4.2158603    
   2200000   12727.922      200            200            0.0056143102   0.00027318611  0              0.016569744    2.1126201e-12  0              1.0201086e-07  1.1971759e-13  0              4.2158603    
   2300000   12727.922      200            200            0.0056143102   0.00027318611  0              0.016569744    6.4963899e-14  0              3.1368742e-09  1.1971759e-13  0              4.2158603    
   2400000   12727.922      200            200            0.0056143102   0.00027318611  0              0.016569744    6.3560531e-15  0              3.0691106e-10  1.1971759e-13  0              4.2158603    
   2500000   12727.922      200            200            0.0056143101   0.00027318611  0              0.016569744    4.8392229e-15  0              2.3366876e-10  1.1971759e-13  0              4.2158603    
   2600000   12727.922      200            200            0.0056143101   0.00027318611  0              0.016569744    6.6723137e-16  0              3.2218215e-11  1.1971759e-13  0              4.2158603    
   2700000   12727.922      200            200            0.0056143101   0.00027318611  0              0.016569744    9.7624716e-17  0              4.7139482e-12  1.1971759e-13  0              4.2158603    
   2800000   12727.922      200            200            0.0056143101   0.00027318611  0              0.016569744    2.3496205e-17  0              1.1345476e-12  1.1971759e-13  0              4.2158603    
   2900000   12727.922      200            200            0.0056143101   0.00027318611  0              0.016569744    1.7370805e-20  0              8.3877399e-16  1.1971759e-13  0              4.2158603    
   3000000   12727.922      200            200            0.0056143101   0.00027318612  0              0.016569744    7.1939842e-18  0              3.4737175e-13  1.1971759e-13  0              4.2158603    
Loop time of 692.115 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3745044.367 ns/day, 0.000 hours/ns, 4334.542 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.19     | 234.76     | 290.34     | 359.9 | 33.92
Neigh   | 0.91639    | 0.93799    | 0.95959    |   1.8 |  0.14
Comm    | 23.963     | 79.432     | 135.13     | 618.5 | 11.48
Output  | 0.40548    | 0.40612    | 0.40676    |   0.1 |  0.06
Modify  | 199.41     | 270.33     | 341.59     | 423.4 | 39.06
Other   |            | 106.2      |            |       | 15.35

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1434.25 ave        2120 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5737
Ave neighs/atom = 1.1471706
Neighbor list builds = 115
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.45                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 186.47078966018
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.55
  ghost atom cutoff = 5.55
  binsize = 2.775, bins = 4587 73 73
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.54 | 39.55 | 39.56 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.4538599e-14  2.836158e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00013910836  2.836158e-13   0             -0.00041732507  4484.895       0              2.1655953e+08  1.1971759e-13  0              4.6820589    
    200000   12727.922      200            200           -0.00027559828  2.836158e-13   0             -0.00082679483  23510.761      0              1.1352505e+09  1.1971759e-13  0              4.3235692    
    300000   12727.922      200            200            0.00023943665  2.836158e-13   0              0.00071830995  12900.712      0              6.2292924e+08  1.1971759e-13  0              4.2432057    
    400000   12727.922      200            200            4.9715879e-05  2.836158e-13   0              0.00014914764  629.63865      0              30402997       1.1971759e-13  0              4.22706      
    500000   12727.922      200            200            0.0099166756  -0.00051791432  0              0.030267941    348.54131      0              16829813       1.1971759e-13  0              4.2194217    
    600000   12727.922      200            200            0.0044238366   0.00032408027  0              0.01294743     88.744054      0              4285132.8      1.1971759e-13  0              4.2213515    
    700000   12727.922      200            200            0.0050226594   0.00027113703  0              0.014796841    1.593133       0              76926.689      1.1971759e-13  0              4.2210908    
    800000   12727.922      200            200            0.0055293205   0.0002809314   0              0.01630703     2.9756426      0              143683.13      1.1971759e-13  0              4.2208963    
    900000   12727.922      200            200            0.0056579269   0.00026924104  0              0.01670454     0.37446977     0              18081.805      1.1971759e-13  0              4.2208475    
   1000000   12727.922      200            200            0.0056505353   0.00027182091  0              0.016679785    0.002500124    0              120.72204      1.1971759e-13  0              4.220851     
   1100000   12727.922      200            200            0.0056292519   0.00027207089  0              0.016615685    0.0034629721   0              167.21453      1.1971759e-13  0              4.220859     
   1200000   12727.922      200            200            0.005620543    0.00027217724  0              0.016589452    0.0011513279   0              55.593503      1.1971759e-13  0              4.2208623    
   1300000   12727.922      200            200            0.0056193642   0.0002721913   0              0.016585901    6.1063334e-05  0              2.9485298      1.1971759e-13  0              4.2208627    
   1400000   12727.922      200            200            0.0056199863   0.00027218326  0              0.016587776    8.7296879e-07  0              0.042152538    1.1971759e-13  0              4.2208625    
   1500000   12727.922      200            200            0.0056204325   0.00027217765  0              0.01658912     2.1927334e-06  0              0.10587925     1.1971759e-13  0              4.2208623    
   1600000   12727.922      200            200            0.0056205555   0.00027217614  0              0.01658949     3.1373654e-07  0              0.015149215    1.1971759e-13  0              4.2208622    
   1700000   12727.922      200            200            0.0056205527   0.00027217619  0              0.016589482    3.6770821e-09  0              0.00017755314  1.1971759e-13  0              4.2208622    
   1800000   12727.922      200            200            0.0056205348   0.00027217642  0              0.016589428    2.2153615e-09  0              0.00010697188  1.1971759e-13  0              4.2208623    
   1900000   12727.922      200            200            0.0056205269   0.00027217651  0              0.016589404    8.9526035e-10  0              4.3228918e-05  1.1971759e-13  0              4.2208623    
   2000000   12727.922      200            200            0.0056205257   0.00027217653  0              0.016589401    5.6804332e-11  0              2.7428779e-06  1.1971759e-13  0              4.2208623    
   2100000   12727.922      200            200            0.0056205262   0.00027217652  0              0.016589402    2.7625694e-13  0              1.3339459e-08  1.1971759e-13  0              4.2208623    
   2200000   12727.922      200            200            0.0056205266   0.00027217652  0              0.016589403    1.5703403e-12  0              7.5826111e-08  1.1971759e-13  0              4.2208623    
   2300000   12727.922      200            200            0.0056205267   0.00027217652  0              0.016589404    2.6045277e-13  0              1.2576332e-08  1.1971759e-13  0              4.2208623    
   2400000   12727.922      200            200            0.0056205267   0.00027217652  0              0.016589404    4.7287948e-15  0              2.2833658e-10  1.1971759e-13  0              4.2208623    
   2500000   12727.922      200            200            0.0056205267   0.00027217652  0              0.016589403    1.1481731e-15  0              5.5441172e-11  1.1971759e-13  0              4.2208623    
   2600000   12727.922      200            200            0.0056205267   0.00027217652  0              0.016589403    4.459023e-16   0              2.1531026e-11  1.1971759e-13  0              4.2208623    
   2700000   12727.922      200            200            0.0056205267   0.00027217652  0              0.016589403    2.0475262e-17  0              9.8867713e-13  1.1971759e-13  0              4.2208623    
   2800000   12727.922      200            200            0.0056205267   0.00027217652  0              0.016589403    2.5007761e-17  0              1.2075353e-12  1.1971759e-13  0              4.2208623    
   2900000   12727.922      200            200            0.0056205267   0.00027217651  0              0.016589403    4.3513245e-18  0              2.1010989e-13  1.1971759e-13  0              4.2208623    
   3000000   12727.922      200            200            0.0056205267   0.00027217652  0              0.016589403    9.3977721e-18  0              4.5378478e-13  1.1971759e-13  0              4.2208623    
Loop time of 694.22 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3733686.134 ns/day, 0.000 hours/ns, 4321.396 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.02     | 235.18     | 291.15     | 358.7 | 33.88
Neigh   | 0.88368    | 0.90434    | 0.92548    |   1.7 |  0.13
Comm    | 24.252     | 79.209     | 135.87     | 614.1 | 11.41
Output  | 0.40383    | 0.40449    | 0.40515    |   0.1 |  0.06
Modify  | 203.31     | 273.82     | 342.42     | 412.2 | 39.44
Other   |            | 104.7      |            |       | 15.08

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1440.75 ave        2132 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5763
Ave neighs/atom = 1.1523695
Neighbor list builds = 111
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.46                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 187.499118910618
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.56
  ghost atom cutoff = 5.56
  binsize = 2.78, bins = 4579 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.81 | 38.82 | 38.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.5803329e-14  2.8740999e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00012620725  2.8740999e-13  0             -0.00037862175  3652.996       0              1.763901e+08   1.1971759e-13  0              4.6868132    
    200000   12727.922      200            200           -0.00026023064  2.8740999e-13  0             -0.00078069192  20597.877      0              9.9459775e+08  1.1971759e-13  0              4.329872     
    300000   12727.922      200            200            0.00026302867  2.8740999e-13  0              0.00078908602  15344.999      0              7.4095507e+08  1.1971759e-13  0              4.2469221    
    400000   12727.922      200            200            7.3222147e-05  2.8740999e-13  0              0.00021966644  1340.4893      0              64727430       1.1971759e-13  0              4.2317018    
    500000   12727.922      200            200            0.010492611   -0.00059608805  0              0.032073921    55.558589      0              2682725.4      1.1971759e-13  0              4.224257     
    600000   12727.922      200            200            0.0048058229   0.00035352802  0              0.014063941    144.95463      0              6999340.5      1.1971759e-13  0              4.2262033    
    700000   12727.922      200            200            0.0050138685   0.00026824603  0              0.01477336     0.17063784     0              8239.4904      1.1971759e-13  0              4.2260993    
    800000   12727.922      200            200            0.0054648739   0.00026929321  0              0.016125328    1.8007226      0              86950.45       1.1971759e-13  0              4.2259237    
    900000   12727.922      200            200            0.0056331351   0.0002690325   0              0.016630373    0.47094822     0              22740.404      1.1971759e-13  0              4.225861     
   1000000   12727.922      200            200            0.0056517143   0.00027110923  0              0.016684034    0.021175319    0              1022.4804      1.1971759e-13  0              4.2258547    
   1100000   12727.922      200            200            0.0056377213   0.00027127721  0              0.016641887    0.00051096386  0              24.672616      1.1971759e-13  0              4.2258601    
   1200000   12727.922      200            200            0.0056286882   0.00027138761  0              0.016614677    0.00091783183  0              44.318814      1.1971759e-13  0              4.2258635    
   1300000   12727.922      200            200            0.0056262532   0.00027141746  0              0.016607342    0.00013074589  0              6.3132512      1.1971759e-13  0              4.2258644    
   1400000   12727.922      200            200            0.0056263015   0.00027141658  0              0.016607488    1.9500551e-06  0              0.094161184    1.1971759e-13  0              4.2258644    
   1500000   12727.922      200            200            0.0056266512   0.00027141214  0              0.016608541    7.5176686e-07  0              0.036300131    1.1971759e-13  0              4.2258642    
   1600000   12727.922      200            200            0.0056268117   0.00027141014  0              0.016609025    3.6163476e-07  0              0.017462049    1.1971759e-13  0              4.2258642    
   1700000   12727.922      200            200            0.0056268414   0.00027140978  0              0.016609115    2.9190233e-08  0              0.0014094919   1.1971759e-13  0              4.2258642    
   1800000   12727.922      200            200            0.0056268341   0.00027140988  0              0.016609092    8.4070835e-13  0              4.0594797e-08  1.1971759e-13  0              4.2258642    
   1900000   12727.922      200            200            0.0056268266   0.00027140997  0              0.01660907     5.053905e-10   0              2.4403499e-05  1.1971759e-13  0              4.2258642    
   2000000   12727.922      200            200            0.005626824    0.00027141001  0              0.016609062    1.1788205e-10  0              5.6921022e-06  1.1971759e-13  0              4.2258642    
   2100000   12727.922      200            200            0.0056268238   0.00027141001  0              0.016609061    4.7016965e-12  0              2.270281e-07   1.1971759e-13  0              4.2258642    
   2200000   12727.922      200            200            0.005626824    0.00027141001  0              0.016609062    1.7820849e-13  0              8.6050503e-09  1.1971759e-13  0              4.2258642    
   2300000   12727.922      200            200            0.0056268242   0.00027141     0              0.016609063    2.4384209e-13  0              1.1774262e-08  1.1971759e-13  0              4.2258642    
   2400000   12727.922      200            200            0.0056268242   0.00027141     0              0.016609063    3.1701138e-14  0              1.5307345e-09  1.1971759e-13  0              4.2258642    
   2500000   12727.922      200            200            0.0056268242   0.00027141     0              0.016609063    5.1239174e-16  0              2.4741563e-11  1.1971759e-13  0              4.2258642    
   2600000   12727.922      200            200            0.0056268242   0.00027141     0              0.016609063    1.0016426e-17  0              4.8365739e-13  1.1971759e-13  0              4.2258642    
   2700000   12727.922      200            200            0.0056268242   0.00027141     0              0.016609063    3.2175601e-18  0              1.5536446e-13  1.1971759e-13  0              4.2258642    
   2800000   12727.922      200            200            0.0056268242   0.00027141     0              0.016609063    3.5718839e-18  0              1.7247349e-13  1.1971759e-13  0              4.2258642    
   2900000   12727.922      200            200            0.0056268242   0.00027141     0              0.016609063    4.9047341e-17  0              2.3683205e-12  1.1971759e-13  0              4.2258642    
   3000000   12727.922      200            200            0.0056268242   0.00027141001  0              0.016609063    6.5561031e-18  0              3.1657076e-13  1.1971759e-13  0              4.2258642    
Loop time of 691.216 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3749914.336 ns/day, 0.000 hours/ns, 4340.179 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.65     | 235.6      | 291.84     | 363.1 | 34.08
Neigh   | 0.84805    | 0.86826    | 0.88975    |   1.8 |  0.13
Comm    | 22.612     | 79.312     | 135.19     | 625.8 | 11.47
Output  | 0.40124    | 0.40189    | 0.40254    |   0.1 |  0.06
Modify  | 201.38     | 270.32     | 338.96     | 416.2 | 39.11
Other   |            | 104.7      |            |       | 15.15

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1446.75 ave        2144 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5787
Ave neighs/atom = 1.1571686
Neighbor list builds = 109
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.47                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 188.531221842153
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.57
  ghost atom cutoff = 5.57
  binsize = 2.785, bins = 4571 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.77 | 38.78 | 38.79 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.707499e-14   2.9122497e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.0001131713   2.9122497e-13  0             -0.00033951391  2906.7102      0              1.4035463e+08  1.1971759e-13  0              4.6915249    
    200000   12727.922      200            200           -0.0002445657   2.9122497e-13  0             -0.00073369711  17880.397      0              8.633804e+08   1.1971759e-13  0              4.336086     
    300000   12727.922      200            200            0.000286893    2.9122497e-13  0              0.00086067899  17997.32       0              8.6902619e+08  1.1971759e-13  0              4.2505246    
    400000   12727.922      200            200            9.7081376e-05  2.9122497e-13  0              0.00029124413  2314.8701      0              1.1177679e+08  1.1971759e-13  0              4.2362084    
    500000   12727.922      200            200            0.010549771   -0.00060685938  0              0.032256171    20.567329      0              993122.69      1.1971759e-13  0              4.2292404    
    600000   12727.922      200            200            0.0052585992   0.00032339312  0              0.015452404    185.5745       0              8960728.6      1.1971759e-13  0              4.2310252    
    700000   12727.922      200            200            0.0050701848   0.00026806419  0              0.01494249     4.1663618      0              201178.7       1.1971759e-13  0              4.2310825    
    800000   12727.922      200            200            0.0054247624   0.00026771431  0              0.016006573    0.62076069     0              29974.312      1.1971759e-13  0              4.2309434    
    900000   12727.922      200            200            0.0056085962   0.0002725108   0              0.016553278    0.43262474     0              20889.901      1.1971759e-13  0              4.2308749    
   1000000   12727.922      200            200            0.0056493943   0.00027264576  0              0.016675537    0.046642465    0              2252.1977      1.1971759e-13  0              4.2308601    
   1100000   12727.922      200            200            0.0056448322   0.00027270375  0              0.016661793    0.00031786765  0              15.348691      1.1971759e-13  0              4.2308619    
   1200000   12727.922      200            200            0.0056371629   0.0002727958   0              0.016638693    0.00040779027  0              19.690733      1.1971759e-13  0              4.2308648    
   1300000   12727.922      200            200            0.0056340078   0.00027283383  0              0.01662919     0.00015177831  0              7.3288315      1.1971759e-13  0              4.230866     
   1400000   12727.922      200            200            0.0056334848   0.00027283997  0              0.016627614    1.1218385e-05  0              0.54169568     1.1971759e-13  0              4.2308662    
   1500000   12727.922      200            200            0.0056336508   0.00027283786  0              0.016628114    3.1406236e-11  0              1.5164948e-06  1.1971759e-13  0              4.2308661    
   1600000   12727.922      200            200            0.0056338026   0.00027283599  0              0.016628572    2.0435869e-07  0              0.0098677496   1.1971759e-13  0              4.2308661    
   1700000   12727.922      200            200            0.0056338549   0.00027283536  0              0.016628729    4.9080954e-08  0              0.0023699436   1.1971759e-13  0              4.2308661    
   1800000   12727.922      200            200            0.0056338603   0.0002728353   0              0.016628746    2.3327488e-09  0              0.00011264009  1.1971759e-13  0              4.2308661    
   1900000   12727.922      200            200            0.0056338559   0.00027283535  0              0.016628732    3.5617073e-11  0              1.719821e-06   1.1971759e-13  0              4.2308661    
   2000000   12727.922      200            200            0.0056338531   0.00027283539  0              0.016628724    8.8631366e-11  0              4.2796914e-06  1.1971759e-13  0              4.2308661    
   2100000   12727.922      200            200            0.0056338522   0.0002728354   0              0.016628721    1.4655727e-11  0              7.0767258e-07  1.1971759e-13  0              4.2308661    
   2200000   12727.922      200            200            0.0056338522   0.0002728354   0              0.016628721    3.8582098e-13  0              1.8629914e-08  1.1971759e-13  0              4.2308661    
   2300000   12727.922      200            200            0.0056338523   0.0002728354   0              0.016628722    4.4991659e-14  0              2.1724862e-09  1.1971759e-13  0              4.2308661    
   2400000   12727.922      200            200            0.0056338524   0.0002728354   0              0.016628722    3.4767479e-14  0              1.6787971e-09  1.1971759e-13  0              4.2308661    
   2500000   12727.922      200            200            0.0056338524   0.0002728354   0              0.016628722    4.1611308e-15  0              2.0092611e-10  1.1971759e-13  0              4.2308661    
   2600000   12727.922      200            200            0.0056338524   0.0002728354   0              0.016628722    2.3595308e-16  0              1.139333e-11   1.1971759e-13  0              4.2308661    
   2700000   12727.922      200            200            0.0056338524   0.0002728354   0              0.016628722    5.6895104e-17  0              2.747261e-12   1.1971759e-13  0              4.2308661    
   2800000   12727.922      200            200            0.0056338524   0.0002728354   0              0.016628722    6.1880717e-17  0              2.9879983e-12  1.1971759e-13  0              4.2308661    
   2900000   12727.922      200            200            0.0056338524   0.0002728354   0              0.016628722    4.4759361e-18  0              2.1612694e-13  1.1971759e-13  0              4.2308661    
   3000000   12727.922      200            200            0.0056338524   0.00027283539  0              0.016628722    9.9370526e-18  0              4.7982471e-13  1.1971759e-13  0              4.2308661    
Loop time of 693.451 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3737825.370 ns/day, 0.000 hours/ns, 4326.187 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.43     | 237.04     | 292.83     | 361.9 | 34.18
Neigh   | 0.84045    | 0.86039    | 0.88074    |   1.7 |  0.12
Comm    | 23.849     | 80.07      | 136.8      | 621.0 | 11.55
Output  | 0.40311    | 0.40376    | 0.40441    |   0.1 |  0.06
Modify  | 201.41     | 270.5      | 338.93     | 415.9 | 39.01
Other   |            | 104.6      |            |       | 15.08

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1452.75 ave        2157 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5811
Ave neighs/atom = 1.1619676
Neighbor list builds = 109
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.48                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 189.567105366287
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.58
  ghost atom cutoff = 5.58
  binsize = 2.79, bins = 4562 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.72 | 38.72 | 38.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.8353571e-14  2.9506071e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00010000107  2.9506071e-13  0             -0.0003000032   2245.9102      0              1.0844697e+08  1.1971759e-13  0              4.696194     
    200000   12727.922      200            200           -0.00022860555  2.9506071e-13  0             -0.00068581664  15357.699      0              7.4156833e+08  1.1971759e-13  0              4.3422109    
    300000   12727.922      200            200            0.00031102673  2.9506071e-13  0              0.00093308019  20856.785      0              1.0070995e+09  1.1971759e-13  0              4.254013     
    400000   12727.922      200            200            0.00012128953  2.9506071e-13  0              0.00036386858  3551.4243      0              1.7148557e+08  1.1971759e-13  0              4.2405794    
    500000   12727.922      200            200            0.010052036   -0.00061450837  0              0.030770617    256.61721      0              12391127       1.1971759e-13  0              4.2343743    
    600000   12727.922      200            200            0.0057909334   0.00035778029  0              0.01701502     195.341        0              9432317.8      1.1971759e-13  0              4.235833     
    700000   12727.922      200            200            0.0051888037   0.00027468226  0              0.015291729    11.901915      0              574700.88      1.1971759e-13  0              4.2360422    
    800000   12727.922      200            200            0.0054122654   0.00026897913  0              0.015967817    0.018071709    0              872.61817      1.1971759e-13  0              4.2359531    
    900000   12727.922      200            200            0.005588256    0.00027704646  0              0.016487722    0.28190821     0              13612.339      1.1971759e-13  0              4.2358875    
   1000000   12727.922      200            200            0.0056448325   0.00027539487  0              0.016659103    0.062212381    0              3004.0132      1.1971759e-13  0              4.2358664    
   1100000   12727.922      200            200            0.005650231    0.00027533792  0              0.016675355    0.0029919565   0              144.47087      1.1971759e-13  0              4.2358646    
   1200000   12727.922      200            200            0.0056453209   0.00027539571  0              0.016660567    3.3761447e-05  0              1.6302195      1.1971759e-13  0              4.2358664    
   1300000   12727.922      200            200            0.0056421186   0.00027543309  0              0.016650923    0.00010553037  0              5.0956838      1.1971759e-13  0              4.2358676    
   1400000   12727.922      200            200            0.0056411585   0.0002754442   0              0.016648031    1.9481545e-05  0              0.94069409     1.1971759e-13  0              4.235868     
   1500000   12727.922      200            200            0.0056411027   0.00027544476  0              0.016647863    7.2819135e-07  0              0.035161754    1.1971759e-13  0              4.235868     
   1600000   12727.922      200            200            0.0056412032   0.00027544355  0              0.016648166    2.5820505e-08  0              0.0012467798   1.1971759e-13  0              4.235868     
   1700000   12727.922      200            200            0.0056412615   0.00027544287  0              0.016648342    3.8300383e-08  0              0.0018493884   1.1971759e-13  0              4.235868     
   1800000   12727.922      200            200            0.0056412775   0.00027544268  0              0.01664839     5.9877516e-09  0              0.0002891271   1.1971759e-13  0              4.2358679    
   1900000   12727.922      200            200            0.0056412778   0.00027544268  0              0.016648391    1.6552957e-10  0              7.9928305e-06  1.1971759e-13  0              4.2358679    
   2000000   12727.922      200            200            0.0056412758   0.00027544271  0              0.016648385    1.502689e-11   0              7.2559475e-07  1.1971759e-13  0              4.2358679    
   2100000   12727.922      200            200            0.0056412747   0.00027544272  0              0.016648381    1.3587094e-11  0              6.5607213e-07  1.1971759e-13  0              4.2358679    
   2200000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    1.803267e-12   0              8.7073311e-08  1.1971759e-13  0              4.235868     
   2300000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    3.325068e-14   0              1.6055563e-09  1.1971759e-13  0              4.235868     
   2400000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    7.740984e-15   0              3.7378441e-10  1.1971759e-13  0              4.235868     
   2500000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    4.5938564e-15  0              2.2182088e-10  1.1971759e-13  0              4.235868     
   2600000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    6.9525501e-16  0              3.3571376e-11  1.1971759e-13  0              4.235868     
   2700000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    8.8923273e-17  0              4.2937866e-12  1.1971759e-13  0              4.235868     
   2800000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    9.0949979e-18  0              4.391649e-13   1.1971759e-13  0              4.235868     
   2900000   12727.922      200            200            0.0056412745   0.00027544272  0              0.016648381    7.573121e-18   0              3.6567891e-13  1.1971759e-13  0              4.235868     
   3000000   12727.922      200            200            0.0056412745   0.00027544271  0              0.016648381    5.2521449e-18  0              2.5360728e-13  1.1971759e-13  0              4.235868     
Loop time of 694.264 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3733451.529 ns/day, 0.000 hours/ns, 4321.124 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.51     | 236.49     | 293.63     | 365.6 | 34.06
Neigh   | 0.83189    | 0.85273    | 0.87343    |   1.8 |  0.12
Comm    | 24.667     | 80.632     | 138.57     | 622.6 | 11.61
Output  | 0.40283    | 0.40348    | 0.40412    |   0.1 |  0.06
Modify  | 199.95     | 270.66     | 340.6      | 418.0 | 38.98
Other   |            | 105.2      |            |       | 15.16

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1458.75 ave        2169 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5835
Ave neighs/atom = 1.1667666
Neighbor list builds = 109
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.49                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 190.606776394524
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.59
  ghost atom cutoff = 5.59
  binsize = 2.795, bins = 4554 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.68 | 38.68 | 38.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            9.9639064e-14  2.9891719e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -8.6697083e-05  2.9891719e-13  0             -0.00026009125  1670.4688      0              80660959       1.1971759e-13  0              4.7008203    
    200000   12727.922      200            200           -0.00021235226  2.9891719e-13  0             -0.00063705678  13029.159      0              6.2913144e+08  1.1971759e-13  0              4.3482464    
    300000   12727.922      200            200            0.00033542702  2.9891719e-13  0              0.0010062811   23922.507      0              1.1551322e+09  1.1971759e-13  0              4.2573867    
    400000   12727.922      200            200            0.00015675598 -4.1658823e-07  0              0.00047068454  5048.5535      0              2.4377658e+08  1.1971759e-13  0              4.2448143    
    500000   12727.922      200            200            0.009076537   -0.00064371904  0              0.02787333     665.59415      0              32139160       1.1971759e-13  0              4.2396452    
    600000   12727.922      200            200            0.0063137324   0.00032615508  0              0.018615042    169.19415      0              8169779.8      1.1971759e-13  0              4.2406446    
    700000   12727.922      200            200            0.0053564411   0.00027746528  0              0.015791858    20.123594      0              971696.33      1.1971759e-13  0              4.2409831    
    800000   12727.922      200            200            0.0054283547   0.00026866251  0              0.016016402    0.28580696     0              13800.595      1.1971759e-13  0              4.2409517    
    900000   12727.922      200            200            0.0055746715   0.00027762378  0              0.016446391    0.1056741      0              5102.6243      1.1971759e-13  0              4.2408971    
   1000000   12727.922      200            200            0.0056385739   0.00027482904  0              0.016640893    0.057730251    0              2787.5872      1.1971759e-13  0              4.240873     
   1100000   12727.922      200            200            0.0056528034   0.000274665    0              0.016683745    0.006552573    0              316.4003       1.1971759e-13  0              4.2408678    
   1200000   12727.922      200            200            0.0056515024   0.00027468183  0              0.016679825    9.527208e-05   0              4.6003478      1.1971759e-13  0              4.2408684    
   1300000   12727.922      200            200            0.00564892     0.00027471227  0              0.016672048    3.3553539e-05  0              1.6201803      1.1971759e-13  0              4.2408693    
   1400000   12727.922      200            200            0.0056477549   0.00027472588  0              0.016668539    1.8619386e-05  0              0.8990635      1.1971759e-13  0              4.2408698    
   1500000   12727.922      200            200            0.0056474967   0.00027472884  0              0.016667761    2.1379677e-06  0              0.10323481     1.1971759e-13  0              4.2408699    
   1600000   12727.922      200            200            0.005647519    0.00027472854  0              0.016667828    3.2380184e-08  0              0.0015635232   1.1971759e-13  0              4.2408699    
   1700000   12727.922      200            200            0.0056475652   0.00027472799  0              0.016667968    1.0560129e-08  0              0.00050991081  1.1971759e-13  0              4.2408698    
   1800000   12727.922      200            200            0.0056475862   0.00027472775  0              0.016668031    6.0009379e-09  0              0.00028976382  1.1971759e-13  0              4.2408698    
   1900000   12727.922      200            200            0.0056475909   0.00027472769  0              0.016668045    6.9772655e-10  0              3.3690718e-05  1.1971759e-13  0              4.2408698    
   2000000   12727.922      200            200            0.0056475905   0.0002747277   0              0.016668044    1.0996695e-11  0              5.3099106e-07  1.1971759e-13  0              4.2408698    
   2100000   12727.922      200            200            0.0056475897   0.00027472771  0              0.016668041    3.3229795e-12  0              1.6045479e-07  1.1971759e-13  0              4.2408698    
   2200000   12727.922      200            200            0.0056475893   0.00027472771  0              0.01666804     1.9358733e-12  0              9.3476394e-08  1.1971759e-13  0              4.2408698    
   2300000   12727.922      200            200            0.0056475892   0.00027472771  0              0.01666804     2.2847698e-13  0              1.1032336e-08  1.1971759e-13  0              4.2408698    
   2400000   12727.922      200            200            0.0056475892   0.00027472771  0              0.01666804     3.965758e-15   0              1.9149226e-10  1.1971759e-13  0              4.2408698    
   2500000   12727.922      200            200            0.0056475892   0.00027472771  0              0.01666804     8.6180986e-16  0              4.1613714e-11  1.1971759e-13  0              4.2408698    
   2600000   12727.922      200            200            0.0056475892   0.00027472771  0              0.01666804     3.250359e-16   0              1.569482e-11   1.1971759e-13  0              4.2408698    
   2700000   12727.922      200            200            0.0056475892   0.00027472771  0              0.01666804     8.330338e-18   0              4.0224221e-13  1.1971759e-13  0              4.2408698    
   2800000   12727.922      200            200            0.0056475892   0.00027472772  0              0.01666804     2.376324e-19   0              1.1474418e-14  1.1971759e-13  0              4.2408698    
   2900000   12727.922      200            200            0.0056475892   0.00027472771  0              0.01666804     4.0126482e-17  0              1.9375642e-12  1.1971759e-13  0              4.2408698    
   3000000   12727.922      200            200            0.0056475892   0.00027472771  0              0.01666804     2.6624699e-18  0              1.2856114e-13  1.1971759e-13  0              4.2408698    
Loop time of 693.021 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3740148.416 ns/day, 0.000 hours/ns, 4328.875 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.49     | 236.54     | 292.33     | 361.8 | 34.13
Neigh   | 0.85739    | 0.87742    | 0.89855    |   1.7 |  0.13
Comm    | 23.359     | 79.783     | 136.02     | 623.2 | 11.51
Output  | 0.40188    | 0.40251    | 0.40315    |   0.1 |  0.06
Modify  | 199.95     | 270.05     | 340.25     | 421.5 | 38.97
Other   |            | 105.4      |            |       | 15.20

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1464.75 ave        2181 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5859
Ave neighs/atom = 1.1715657
Neighbor list builds = 111
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.5                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 191.650241838367
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.6
  ghost atom cutoff = 5.6
  binsize = 2.8, bins = 4546 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.63 | 38.63 | 38.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.0093146e-13  3.0279438e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -7.3259918e-05  3.0279438e-13  0             -0.00021977975  1180.26        0              56990533       1.1971759e-13  0              4.7054037    
    200000   12727.922      200            200           -0.00019580797  3.0279438e-13  0             -0.0005874239   10894.158      0              5.2603991e+08  1.1971759e-13  0              4.3541921    
    300000   12727.922      200            200            0.00036009093  3.0279438e-13  0              0.0010802728   27193.589      0              1.3130811e+09  1.1971759e-13  0              4.2606454    
    400000   12727.922      200            200            0.00055190044 -7.4742025e-06  0              0.0016631755   6753.7966      0              3.2611667e+08  1.1971759e-13  0              4.2489139    
    500000   12727.922      200            200            0.0078678268  -0.00043917023  0              0.024042651    1086.3826      0              52457529       1.1971759e-13  0              4.2450256    
    600000   12727.922      200            200            0.006737732    0.00012849176  0              0.020084704    115.56197      0              5580074        1.1971759e-13  0              4.2454786    
    700000   12727.922      200            200            0.0055617353   0.00028882121  0              0.016396385    25.303903      0              1221834.9      1.1971759e-13  0              4.2459116    
    800000   12727.922      200            200            0.0054719696   0.00026677609  0              0.016149133    1.2840746      0              62003.365      1.1971759e-13  0              4.2459396    
    900000   12727.922      200            200            0.0055714846   0.00027608884  0              0.016438365    0.0050502559   0              243.85878      1.1971759e-13  0              4.2459026    
   1000000   12727.922      200            200            0.0056334125   0.00027286775  0              0.01662737     0.036161515    0              1746.1101      1.1971759e-13  0              4.245879     
   1100000   12727.922      200            200            0.0056539141   0.00027261293  0              0.016689129    0.0083845255   0              404.85873      1.1971759e-13  0              4.2458715    
   1200000   12727.922      200            200            0.0056563802   0.000272585    0              0.016696556    0.00053734195  0              25.94632       1.1971759e-13  0              4.2458706    
   1300000   12727.922      200            200            0.0056549399   0.00027260296  0              0.016692217    2.1349444e-09  0              0.00010308883  1.1971759e-13  0              4.2458712    
   1400000   12727.922      200            200            0.0056538434   0.0002726163   0              0.016688914    9.5153927e-06  0              0.45946426     1.1971759e-13  0              4.2458716    
   1500000   12727.922      200            200            0.0056534534   0.00027262099  0              0.016687739    2.7125227e-06  0              0.13097801     1.1971759e-13  0              4.2458717    
   1600000   12727.922      200            200            0.0056533931   0.0002726217   0              0.016687557    2.1368653e-07  0              0.010318158    1.1971759e-13  0              4.2458717    
   1700000   12727.922      200            200            0.0056534133   0.00027262144  0              0.016687618    6.2265629e-10  0              3.0065844e-05  1.1971759e-13  0              4.2458717    
   1800000   12727.922      200            200            0.0056534321   0.00027262121  0              0.016687675    2.3752347e-09  0              0.00011469158  1.1971759e-13  0              4.2458717    
   1900000   12727.922      200            200            0.0056534394   0.00027262112  0              0.016687697    8.5672112e-10  0              4.1367997e-05  1.1971759e-13  0              4.2458717    
   2000000   12727.922      200            200            0.0056534408   0.0002726211   0              0.016687701    8.1568317e-11  0              3.9386421e-06  1.1971759e-13  0              4.2458717    
   2100000   12727.922      200            200            0.0056534405   0.00027262111  0              0.0166877      7.696044e-13   0              3.7161442e-08  1.1971759e-13  0              4.2458717    
   2200000   12727.922      200            200            0.0056534402   0.00027262111  0              0.0166877      5.5256427e-13  0              2.6681351e-08  1.1971759e-13  0              4.2458717    
   2300000   12727.922      200            200            0.0056534401   0.00027262111  0              0.016687699    2.6242722e-13  0              1.2671671e-08  1.1971759e-13  0              4.2458717    
   2400000   12727.922      200            200            0.00565344     0.00027262111  0              0.016687699    3.0598149e-14  0              1.4774751e-09  1.1971759e-13  0              4.2458717    
   2500000   12727.922      200            200            0.00565344     0.00027262111  0              0.016687699    7.630455e-16   0              3.6844736e-11  1.1971759e-13  0              4.2458717    
   2600000   12727.922      200            200            0.0056534401   0.00027262111  0              0.016687699    3.0694407e-18  0              1.482123e-13   1.1971759e-13  0              4.2458717    
   2700000   12727.922      200            200            0.0056534401   0.00027262111  0              0.016687699    1.6563667e-17  0              7.9980022e-13  1.1971759e-13  0              4.2458717    
   2800000   12727.922      200            200            0.0056534401   0.00027262111  0              0.016687699    2.9589362e-18  0              1.4287644e-13  1.1971759e-13  0              4.2458717    
   2900000   12727.922      200            200            0.0056534401   0.00027262112  0              0.016687699    3.6720594e-18  0              1.773106e-13   1.1971759e-13  0              4.2458717    
   3000000   12727.922      200            200            0.0056534401   0.0002726211   0              0.016687699    6.0620241e-18  0              2.9271345e-13  1.1971759e-13  0              4.2458717    
Loop time of 694.313 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3733186.900 ns/day, 0.000 hours/ns, 4320.818 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.2      | 236.37     | 294.78     | 369.8 | 34.04
Neigh   | 0.88626    | 0.90814    | 0.92992    |   1.8 |  0.13
Comm    | 24.624     | 81.567     | 140.35     | 624.1 | 11.75
Output  | 0.40418    | 0.40481    | 0.40545    |   0.1 |  0.06
Modify  | 199.59     | 270.36     | 338.58     | 414.3 | 38.94
Other   |            | 104.7      |            |       | 15.08

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1470.25 ave        2192 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5881
Ave neighs/atom = 1.1759648
Neighbor list builds = 117
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.51                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 192.697508609322
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61
  ghost atom cutoff = 5.61
  binsize = 2.805, bins = 4538 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.59 | 38.59 | 38.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.0223075e-13  3.0669225e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -5.9690122e-05  3.0669225e-13  0             -0.00017907036  775.15792      0              37429602       1.1971759e-13  0              4.709944     
    200000   12727.922      200            200           -0.00017897475  3.0669225e-13  0             -0.00053692424  8952.0752      0              4.3226367e+08  1.1971759e-13  0              4.3600477    
    300000   12727.922      200            200            0.00038501556  3.0669225e-13  0              0.0011550467   30669.143      0              1.4809031e+09  1.1971759e-13  0              4.2637887    
    400000   12727.922      200            200            0.0016426438  -2.3003563e-05  0              0.0049509351   8427.2383      0              4.0692118e+08  1.1971759e-13  0              4.2528876    
    500000   12727.922      200            200            0.0066393323   7.4485402e-05  0              0.019843512    1368.6763      0              66088479       1.1971759e-13  0              4.250479     
    600000   12727.922      200            200            0.0070884147   1.8256358e-05  0              0.021246988    54.550086      0              2634028.4      1.1971759e-13  0              4.250352     
    700000   12727.922      200            200            0.0057677397   0.00025875742  0              0.017044462    25.132293      0              1213548.5      1.1971759e-13  0              4.2508359    
    800000   12727.922      200            200            0.0055381337   0.00026190865  0              0.016352492    2.5070254      0              121055.28      1.1971759e-13  0              4.2509188    
    900000   12727.922      200            200            0.0055802172   0.00027282135  0              0.01646783     0.037226501    0              1797.5345      1.1971759e-13  0              4.2509034    
   1000000   12727.922      200            200            0.0056312981   0.00026969557  0              0.016624199    0.011604488    0              560.33918      1.1971759e-13  0              4.2508838    
   1100000   12727.922      200            200            0.0056545466   0.00026938574  0              0.016694254    0.0071493123   0              345.21471      1.1971759e-13  0              4.2508752    
   1200000   12727.922      200            200            0.0056602341   0.00026931493  0              0.016711387    0.00099724981  0              48.153624      1.1971759e-13  0              4.2508731    
   1300000   12727.922      200            200            0.0056602085   0.00026931597  0              0.016711309    3.4225778e-05  0              1.6526403      1.1971759e-13  0              4.2508731    
   1400000   12727.922      200            200            0.0056594316   0.00026932596  0              0.016708969    1.1039568e-06  0              0.053306124    1.1971759e-13  0              4.2508734    
   1500000   12727.922      200            200            0.0056590121   0.00026933127  0              0.016707705    1.8409686e-06  0              0.088893783    1.1971759e-13  0              4.2508736    
   1600000   12727.922      200            200            0.0056588879   0.00026933282  0              0.016707331    3.5739451e-07  0              0.017257302    1.1971759e-13  0              4.2508736    
   1700000   12727.922      200            200            0.0056588766   0.00026933295  0              0.016707297    2.0591909e-08  0              0.00099430961  1.1971759e-13  0              4.2508736    
   1800000   12727.922      200            200            0.0056588871   0.00026933281  0              0.016707328    4.2526136e-12  0              2.0534349e-07  1.1971759e-13  0              4.2508736    
   1900000   12727.922      200            200            0.0056588943   0.00026933272  0              0.01670735     4.1497382e-10  0              2.0037601e-05  1.1971759e-13  0              4.2508736    
   2000000   12727.922      200            200            0.0056588968   0.00026933269  0              0.016707358    1.1700137e-10  0              5.6495775e-06  1.1971759e-13  0              4.2508736    
   2100000   12727.922      200            200            0.0056588972   0.00026933268  0              0.016707359    9.9591343e-12  0              4.8089095e-07  1.1971759e-13  0              4.2508736    
   2200000   12727.922      200            200            0.0056588971   0.00026933269  0              0.016707359    7.1047625e-14  0              3.4306355e-09  1.1971759e-13  0              4.2508736    
   2300000   12727.922      200            200            0.005658897    0.00026933269  0              0.016707358    7.6433351e-14  0              3.690693e-09   1.1971759e-13  0              4.2508736    
   2400000   12727.922      200            200            0.0056588969   0.00026933269  0              0.016707358    3.521197e-14   0              1.70026e-09    1.1971759e-13  0              4.2508736    
   2500000   12727.922      200            200            0.0056588969   0.00026933269  0              0.016707358    4.2971773e-15  0              2.0749531e-10  1.1971759e-13  0              4.2508736    
   2600000   12727.922      200            200            0.0056588969   0.00026933269  0              0.016707358    3.9312274e-16  0              1.898249e-11   1.1971759e-13  0              4.2508736    
   2700000   12727.922      200            200            0.0056588969   0.00026933269  0              0.016707358    9.435671e-17   0              4.5561478e-12  1.1971759e-13  0              4.2508736    
   2800000   12727.922      200            200            0.0056588969   0.00026933269  0              0.016707358    1.0224082e-17  0              4.9368433e-13  1.1971759e-13  0              4.2508736    
   2900000   12727.922      200            200            0.0056588969   0.00026933269  0              0.016707358    5.1124021e-17  0              2.468596e-12   1.1971759e-13  0              4.2508736    
   3000000   12727.922      200            200            0.0056588969   0.00026933268  0              0.016707358    5.2264123e-18  0              2.5236475e-13  1.1971759e-13  0              4.2508736    
Loop time of 696.875 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3719464.284 ns/day, 0.000 hours/ns, 4304.936 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.96     | 237.07     | 294.31     | 370.7 | 34.02
Neigh   | 0.92787    | 0.94984    | 0.9726     |   1.8 |  0.14
Comm    | 23.349     | 80.914     | 138.6      | 634.2 | 11.61
Output  | 0.40377    | 0.40443    | 0.40509    |   0.1 |  0.06
Modify  | 201.53     | 271.68     | 342.13     | 418.5 | 38.99
Other   |            | 105.9      |            |       | 15.19

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1475.75 ave        2202 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5903
Ave neighs/atom = 1.1803639
Neighbor list builds = 119
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.52                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 193.748583618891
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.62
  ghost atom cutoff = 5.62
  binsize = 2.81, bins = 4530 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.54 | 38.54 | 38.54 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.0353693e-13  3.1061078e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -4.5988213e-05  3.1061078e-13  0             -0.00013796464  455.03628      0              21972074       1.1971759e-13  0              4.7144412    
    200000   12727.922      200            200           -0.00016185467  3.1061078e-13  0             -0.000485564    7202.286       0              3.4777262e+08  1.1971759e-13  0              4.3658131    
    300000   12727.922      200            200            0.00041019811  3.1061078e-13  0              0.0012305943   34348.295      0              1.6585563e+09  1.1971759e-13  0              4.2668162    
    400000   12727.922      200            200            0.0036403409   3.1607164e-06  0              0.010917862    9644.7734      0              4.6571159e+08  1.1971759e-13  0              4.2567622    
    500000   12727.922      200            200            0.0053857402   0.00036447236  0              0.015792748    1430.396       0              69068701       1.1971759e-13  0              4.2559644    
    600000   12727.922      200            200            0.0072978124  -5.1919895e-05  0              0.021945357    10.499372      0              506977.09      1.1971759e-13  0              4.2552783    
    700000   12727.922      200            200            0.0059598672   0.00021410802  0              0.017665494    19.587519      0              945811.2       1.1971759e-13  0              4.2557646    
    800000   12727.922      200            200            0.0056209333   0.00025919711  0              0.016603603    3.3320253      0              160891.58      1.1971759e-13  0              4.255892     
    900000   12727.922      200            200            0.0056018023   0.00027194289  0              0.016533464    0.18249542     0              8812.0506      1.1971759e-13  0              4.2558997    
   1000000   12727.922      200            200            0.0056347568   0.00026897894  0              0.016635291    5.0376255e-05  0              2.4324891      1.1971759e-13  0              4.2558868    
   1100000   12727.922      200            200            0.0056568626   0.00026867054  0              0.016701917    0.0037569088   0              181.40768      1.1971759e-13  0              4.2558785    
   1200000   12727.922      200            200            0.0056646424   0.00026856861  0              0.016725358    0.0011001876   0              53.124123      1.1971759e-13  0              4.2558757    
   1300000   12727.922      200            200            0.0056660044   0.00026855152  0              0.016729462    0.00010485076  0              5.0628682      1.1971759e-13  0              4.2558752    
   1400000   12727.922      200            200            0.0056657186   0.0002685555   0              0.0167286      1.5632289e-06  0              0.075482729    1.1971759e-13  0              4.2558753    
   1500000   12727.922      200            200            0.0056653768   0.00026856     0              0.01672757     4.5912072e-07  0              0.022169296    1.1971759e-13  0              4.2558754    
   1600000   12727.922      200            200            0.0056652249   0.00026856197  0              0.016727113    2.9689802e-07  0              0.014336143    1.1971759e-13  0              4.2558755    
   1700000   12727.922      200            200            0.0056651862   0.00026856247  0              0.016726996    4.5119886e-08  0              0.0021786778   1.1971759e-13  0              4.2558755    
   1800000   12727.922      200            200            0.005665185    0.00026856248  0              0.016726993    2.0380527e-09  0              9.8410271e-05  1.1971759e-13  0              4.2558755    
   1900000   12727.922      200            200            0.0056651896   0.00026856242  0              0.016727006    1.1303232e-11  0              5.4579263e-07  1.1971759e-13  0              4.2558755    
   2000000   12727.922      200            200            0.0056651923   0.00026856238  0              0.016727014    6.2836502e-11  0              3.0341498e-06  1.1971759e-13  0              4.2558755    
   2100000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    1.5698473e-11  0              7.580231e-07   1.1971759e-13  0              4.2558755    
   2200000   12727.922      200            200            0.0056651933   0.00026856237  0              0.016727018    1.3091322e-12  0              6.3213311e-08  1.1971759e-13  0              4.2558755    
   2300000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    1.0590481e-14  0              5.1137644e-10  1.1971759e-13  0              4.2558755    
   2400000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    8.8620724e-15  0              4.2791776e-10  1.1971759e-13  0              4.2558755    
   2500000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    4.2461724e-15  0              2.0503247e-10  1.1971759e-13  0              4.2558755    
   2600000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    6.6652791e-16  0              3.2184247e-11  1.1971759e-13  0              4.2558755    
   2700000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    3.8034756e-17  0              1.8365622e-12  1.1971759e-13  0              4.2558755    
   2800000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    4.4290883e-17  0              2.1386482e-12  1.1971759e-13  0              4.2558755    
   2900000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    4.7786469e-17  0              2.3074376e-12  1.1971759e-13  0              4.2558755    
   3000000   12727.922      200            200            0.0056651932   0.00026856237  0              0.016727017    8.9763161e-18  0              4.3343418e-13  1.1971759e-13  0              4.2558755    
Loop time of 696.736 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3720201.522 ns/day, 0.000 hours/ns, 4305.789 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.94     | 237.27     | 296.1      | 377.1 | 34.06
Neigh   | 0.9494     | 0.97206    | 0.9952     |   1.8 |  0.14
Comm    | 24.714     | 82.611     | 141.92     | 636.2 | 11.86
Output  | 0.40381    | 0.40445    | 0.4051     |   0.1 |  0.06
Modify  | 200.37     | 270.56     | 339.5      | 416.3 | 38.83
Other   |            | 104.9      |            |       | 15.06

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1480.25 ave        2212 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5921
Ave neighs/atom = 1.1839632
Neighbor list builds = 123
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.53                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 194.803473778579
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.63
  ghost atom cutoff = 5.63
  binsize = 2.815, bins = 4522 72 72
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.5 | 38.5 | 38.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.0484998e-13  3.1454993e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -3.21548e-05    3.1454993e-13  0             -9.64644e-05    219.77156      0              10611982       1.1971759e-13  0              4.718895     
    200000   12727.922      200            200           -0.00014444991  3.1454993e-13  0             -0.00043334973  5644.1806      0              2.7253728e+08  1.1971759e-13  0              4.3714878    
    300000   12727.922      200            200            0.00043563552  3.1454993e-13  0              0.0013069066   38230.136      0              1.8459965e+09  1.1971759e-13  0              4.2697274    
    400000   12727.922      200            200            0.0066145679   2.4905962e-05  0              0.019818798    9874.0569      0              4.7678287e+08  1.1971759e-13  0              4.2605872    
    500000   12727.922      200            200            0.0041584147   0.00021765123  0              0.012257593    1274.0822      0              61520869       1.1971759e-13  0              4.2614422    
    600000   12727.922      200            200            0.0073359131  -7.1872269e-05  0              0.022079612    1.561553       0              75401.806      1.1971759e-13  0              4.260266     
    700000   12727.922      200            200            0.0061320435   0.00020969753  0              0.018186433    11.058564      0              533978.5       1.1971759e-13  0              4.2607063    
    800000   12727.922      200            200            0.0057098224   0.00025679171  0              0.016872675    3.3335343      0              160964.44      1.1971759e-13  0              4.2608632    
    900000   12727.922      200            200            0.0056332906   0.00027131444  0              0.016628557    0.35542802     0              17162.347      1.1971759e-13  0              4.2608923    
   1000000   12727.922      200            200            0.0056435734   0.00026857724  0              0.016662143    0.0089219054   0              430.80688      1.1971759e-13  0              4.2608878    
   1100000   12727.922      200            200            0.0056609213   0.00026833052  0              0.016714433    0.00069145937  0              33.388098      1.1971759e-13  0              4.2608813    
   1200000   12727.922      200            200            0.0056693032   0.00026821778  0              0.016739692    0.00076318712  0              36.851575      1.1971759e-13  0              4.2608782    
   1300000   12727.922      200            200            0.0056717396   0.00026818599  0              0.016747033    0.00014822064  0              7.157044       1.1971759e-13  0              4.2608773    
   1400000   12727.922      200            200            0.0056719995   0.00026818282  0              0.016747816    1.032896e-05   0              0.4987485      1.1971759e-13  0              4.2608772    
   1500000   12727.922      200            200            0.0056718205   0.00026818527  0              0.016747276    3.7478792e-08  0              0.0018097168   1.1971759e-13  0              4.2608773    
   1600000   12727.922      200            200            0.0056716838   0.00026818708  0              0.016746864    1.0308801e-07  0              0.0049777509   1.1971759e-13  0              4.2608773    
   1700000   12727.922      200            200            0.0056716301   0.00026818779  0              0.016746703    4.3456124e-08  0              0.0020983407   1.1971759e-13  0              4.2608774    
   1800000   12727.922      200            200            0.005671618    0.00026818795  0              0.016746666    5.6875414e-09  0              0.00027463102  1.1971759e-13  0              4.2608774    
   1900000   12727.922      200            200            0.0056716183   0.00026818794  0              0.016746667    2.2210914e-10  0              1.0724855e-05  1.1971759e-13  0              4.2608774    
   2000000   12727.922      200            200            0.0056716201   0.00026818792  0              0.016746672    2.713893e-12   0              1.3104418e-07  1.1971759e-13  0              4.2608774    
   2100000   12727.922      200            200            0.005671621    0.0002681879   0              0.016746675    8.6063467e-12  0              4.1556968e-07  1.1971759e-13  0              4.2608774    
   2200000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    2.0937071e-12  0              1.0109762e-07  1.1971759e-13  0              4.2608774    
   2300000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    1.8121918e-13  0              8.7504257e-09  1.1971759e-13  0              4.2608774    
   2400000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    2.3248151e-15  0              1.12257e-10    1.1971759e-13  0              4.2608774    
   2500000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    6.7894177e-16  0              3.2783668e-11  1.1971759e-13  0              4.2608774    
   2600000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    2.2791705e-16  0              1.1005299e-11  1.1971759e-13  0              4.2608774    
   2700000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    5.3490964e-19  0              2.5828872e-14  1.1971759e-13  0              4.2608774    
   2800000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    1.6825437e-17  0              8.1244016e-13  1.1971759e-13  0              4.2608774    
   2900000   12727.922      200            200            0.0056716214   0.0002681879   0              0.016746676    5.9583059e-18  0              2.8770527e-13  1.1971759e-13  0              4.2608774    
   3000000   12727.922      200            200            0.0056716214   0.00026818791  0              0.016746676    6.2404253e-18  0              3.013278e-13   1.1971759e-13  0              4.2608774    
Loop time of 690.944 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3751386.772 ns/day, 0.000 hours/ns, 4341.883 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 177.82     | 234.14     | 289.41     | 360.0 | 33.89
Neigh   | 0.93737    | 0.9598     | 0.98289    |   1.8 |  0.14
Comm    | 22.918     | 78.777     | 135.4      | 621.3 | 11.40
Output  | 0.40285    | 0.4035     | 0.40414    |   0.1 |  0.06
Modify  | 200.77     | 271.09     | 341.21     | 421.5 | 39.23
Other   |            | 105.6      |            |       | 15.28

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1428.75 ave        2108 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5715
Ave neighs/atom = 1.1427714
Neighbor list builds = 120
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.54                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 195.86218599989
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.64
  ghost atom cutoff = 5.64
  binsize = 2.82, bins = 4514 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.79 | 37.79 | 37.79 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.061699e-13   3.1850969e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -1.8190365e-05  3.1850969e-13  0             -5.4571095e-05  69.238383      0              3343273.7      1.1971759e-13  0              4.7233053    
    200000   12727.922      200            200           -0.00012676245  3.1850969e-13  0             -0.00038028734  4277.1296      0              2.0652728e+08  1.1971759e-13  0              4.3770715    
    300000   12727.922      200            200            0.00046132512  3.1850969e-13  0              0.0013839754   42313.815      0              2.0431827e+09  1.1971759e-13  0              4.2725221    
    400000   12727.922      200            200            0.010198388   -0.00055800603  0              0.03115317     8706.0438      0              4.203837e+08   1.1971759e-13  0              4.2644367    
    500000   12727.922      200            200            0.0031902371   0.00013447716  0              0.0094362342   966.88604      0              46687466       1.1971759e-13  0              4.2668772    
    600000   12727.922      200            200            0.0071865571  -6.9581536e-05  0              0.021629253    31.288613      0              1510815.1      1.1971759e-13  0              4.2653165    
    700000   12727.922      200            200            0.0062468451   0.00019858631  0              0.018541949    3.3654587      0              162505.96      1.1971759e-13  0              4.265668     
    800000   12727.922      200            200            0.0057965426   0.00026299623  0              0.017126632    2.5050659      0              120960.67      1.1971759e-13  0              4.2658364    
    900000   12727.922      200            200            0.0056710911   0.00027139995  0              0.016741873    0.45422738     0              21933.015      1.1971759e-13  0              4.2658827    
   1000000   12727.922      200            200            0.0056575178   0.00026898485  0              0.016703568    0.032210564    0              1555.3329      1.1971759e-13  0              4.2658871    
   1100000   12727.922      200            200            0.0056673457   0.00026884876  0              0.016733188    0.00018691129  0              9.0252772      1.1971759e-13  0              4.2658833    
   1200000   12727.922      200            200            0.0056747621   0.00026875153  0              0.016755535    0.00026104836  0              12.605091      1.1971759e-13  0              4.2658805    
   1300000   12727.922      200            200            0.0056777449   0.0002687135   0              0.016764521    0.00012547323  0              6.058653       1.1971759e-13  0              4.2658794    
   1400000   12727.922      200            200            0.0056784789   0.00026870434  0              0.016766732    1.8716615e-05  0              0.90375837     1.1971759e-13  0              4.2658792    
   1500000   12727.922      200            200            0.0056785043   0.00026870411  0              0.016766809    1.0108418e-06  0              0.048809931    1.1971759e-13  0              4.2658792    
   1600000   12727.922      200            200            0.0056784206   0.00026870521  0              0.016766557    6.356003e-12   0              3.0690864e-07  1.1971759e-13  0              4.2658792    
   1700000   12727.922      200            200            0.0056783686   0.00026870587  0              0.0167664      1.779662e-08   0              0.00085933511  1.1971759e-13  0              4.2658792    
   1800000   12727.922      200            200            0.0056783497   0.00026870611  0              0.016766343    6.0333252e-09  0              0.00029132768  1.1971759e-13  0              4.2658792    
   1900000   12727.922      200            200            0.0056783458   0.00026870616  0              0.016766331    7.3630083e-10  0              3.5553332e-05  1.1971759e-13  0              4.2658792    
   2000000   12727.922      200            200            0.005678346    0.00026870616  0              0.016766332    2.8216531e-11  0              1.3624753e-06  1.1971759e-13  0              4.2658792    
   2100000   12727.922      200            200            0.0056783466   0.00026870615  0              0.016766334    3.1458058e-13  0              1.5189971e-08  1.1971759e-13  0              4.2658792    
   2200000   12727.922      200            200            0.005678347    0.00026870614  0              0.016766335    1.0737986e-12  0              5.1849893e-08  1.1971759e-13  0              4.2658792    
   2300000   12727.922      200            200            0.0056783471   0.00026870614  0              0.016766335    2.7729195e-13  0              1.3389436e-08  1.1971759e-13  0              4.2658792    
   2400000   12727.922      200            200            0.0056783471   0.00026870614  0              0.016766335    2.7346314e-14  0              1.3204556e-09  1.1971759e-13  0              4.2658792    
   2500000   12727.922      200            200            0.0056783471   0.00026870614  0              0.016766335    8.1549362e-16  0              3.9377268e-11  1.1971759e-13  0              4.2658792    
   2600000   12727.922      200            200            0.0056783471   0.00026870614  0              0.016766335    2.90242e-17    0              1.4014747e-12  1.1971759e-13  0              4.2658792    
   2700000   12727.922      200            200            0.0056783471   0.00026870614  0              0.016766335    3.5759265e-17  0              1.7266869e-12  1.1971759e-13  0              4.2658792    
   2800000   12727.922      200            200            0.0056783471   0.00026870614  0              0.016766335    3.0653963e-18  0              1.4801701e-13  1.1971759e-13  0              4.2658792    
   2900000   12727.922      200            200            0.0056783471   0.00026870614  0              0.016766335    2.0581373e-18  0              9.9380082e-14  1.1971759e-13  0              4.2658792    
   3000000   12727.922      200            200            0.0056783471   0.00026870615  0              0.016766335    7.8090597e-18  0              3.7707154e-13  1.1971759e-13  0              4.2658792    
Loop time of 687.834 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3768349.158 ns/day, 0.000 hours/ns, 4361.515 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.06     | 234.27     | 289.61     | 359.1 | 34.06
Neigh   | 0.85407    | 0.87437    | 0.89517    |   1.7 |  0.13
Comm    | 23.992     | 79.203     | 135.17     | 616.6 | 11.51
Output  | 0.40324    | 0.40386    | 0.40453    |   0.1 |  0.06
Modify  | 199.63     | 269.14     | 337.38     | 415.7 | 39.13
Other   |            | 103.9      |            |       | 15.11

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1435.25 ave        2122 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5741
Ave neighs/atom = 1.1479704
Neighbor list builds = 114
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.55                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 196.924727194326
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.65
  ghost atom cutoff = 5.65
  binsize = 2.825, bins = 4506 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.74 | 37.74 | 37.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.0749668e-13  3.2249004e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -4.0955277e-06  3.2249004e-13  0             -1.2286583e-05  3.3138564      0              160014.27      1.1971759e-13  0              4.7276721    
    200000   12727.922      200            200           -0.0001087945   3.2249004e-13  0             -0.00032638351  3100.5256      0              1.4971328e+08  1.1971759e-13  0              4.382564     
    300000   12727.922      200            200            0.00048726383  3.2249004e-13  0              0.0014617915   46598.421      0              2.250071e+09   1.1971759e-13  0              4.2751997    
    400000   12727.922      200            200            0.014109003   -0.0011759977   0              0.043503006    6195.1288      0              2.991406e+08   1.1971759e-13  0              4.2684057    
    500000   12727.922      200            200            0.0025296857   0.00021249596  0              0.0073765613   604.82594      0              29204880       1.1971759e-13  0              4.2722407    
    600000   12727.922      200            200            0.0068675649  -5.6227949e-05  0              0.020658923    86.840236      0              4193204.2      1.1971759e-13  0              4.2704249    
    700000   12727.922      200            200            0.0062928571   0.00019227594  0              0.018686295    0.016217608    0              783.09025      1.1971759e-13  0              4.2706545    
    800000   12727.922      200            200            0.0058632936   0.00025649796  0              0.017333383    1.2703432      0              61340.327      1.1971759e-13  0              4.2708153    
    900000   12727.922      200            200            0.0057092474   0.00026853265  0              0.01685921     0.42031586     0              20295.549      1.1971759e-13  0              4.2708726    
   1000000   12727.922      200            200            0.0056745279   0.00026770741  0              0.016755876    0.054410379    0              2627.2825      1.1971759e-13  0              4.2708849    
   1100000   12727.922      200            200            0.0056753541   0.00026769155  0              0.016758371    0.0025880183   0              124.96614      1.1971759e-13  0              4.2708845    
   1200000   12727.922      200            200            0.0056804454   0.00026762487  0              0.016773711    1.5450089e-06  0              0.074602951    1.1971759e-13  0              4.2708826    
   1300000   12727.922      200            200            0.0056833442   0.00026758799  0              0.016782445    5.7148148e-05  0              2.7594795      1.1971759e-13  0              4.2708815    
   1400000   12727.922      200            200            0.0056843736   0.00026757512  0              0.016785546    1.8475618e-05  0              0.89212146     1.1971759e-13  0              4.2708811    
   1500000   12727.922      200            200            0.0056845926   0.00026757244  0              0.016786205    2.3245872e-06  0              0.112246       1.1971759e-13  0              4.2708811    
   1600000   12727.922      200            200            0.0056845839   0.00026757258  0              0.016786179    1.0493162e-07  0              0.0050667725   1.1971759e-13  0              4.2708811    
   1700000   12727.922      200            200            0.0056845494   0.00026757303  0              0.016786075    1.7410358e-10  0              8.4068389e-06  1.1971759e-13  0              4.2708811    
   1800000   12727.922      200            200            0.0056845302   0.00026757327  0              0.016786017    2.6261739e-09  0              0.00012680854  1.1971759e-13  0              4.2708811    
   1900000   12727.922      200            200            0.0056845234   0.00026757335  0              0.016785997    8.1209751e-10  0              3.9213282e-05  1.1971759e-13  0              4.2708811    
   2000000   12727.922      200            200            0.005684522    0.00026757337  0              0.016785993    9.9138136e-11  0              4.7870258e-06  1.1971759e-13  0              4.2708811    
   2100000   12727.922      200            200            0.0056845221   0.00026757337  0              0.016785993    4.2409283e-12  0              2.0477925e-07  1.1971759e-13  0              4.2708811    
   2200000   12727.922      200            200            0.0056845224   0.00026757337  0              0.016785994    1.4142669e-14  0              6.8289887e-10  1.1971759e-13  0              4.2708811    
   2300000   12727.922      200            200            0.0056845225   0.00026757336  0              0.016785994    1.1911591e-13  0              5.751681e-09   1.1971759e-13  0              4.2708811    
   2400000   12727.922      200            200            0.0056845225   0.00026757336  0              0.016785994    3.5696938e-14  0              1.7236774e-09  1.1971759e-13  0              4.2708811    
   2500000   12727.922      200            200            0.0056845225   0.00026757336  0              0.016785994    4.3384472e-15  0              2.0948809e-10  1.1971759e-13  0              4.2708811    
   2600000   12727.922      200            200            0.0056845225   0.00026757336  0              0.016785994    4.7869621e-16  0              2.3114527e-11  1.1971759e-13  0              4.2708811    
   2700000   12727.922      200            200            0.0056845225   0.00026757336  0              0.016785994    9.4578653e-17  0              4.5668647e-12  1.1971759e-13  0              4.2708811    
   2800000   12727.922      200            200            0.0056845225   0.00026757336  0              0.016785994    2.3072776e-18  0              1.1141018e-13  1.1971759e-13  0              4.2708811    
   2900000   12727.922      200            200            0.0056845225   0.00026757336  0              0.016785994    3.956886e-17   0              1.9106386e-12  1.1971759e-13  0              4.2708811    
   3000000   12727.922      200            200            0.0056845225   0.00026757337  0              0.016785994    3.8451424e-18  0              1.8566817e-13  1.1971759e-13  0              4.2708811    
Loop time of 700.201 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3701794.164 ns/day, 0.000 hours/ns, 4284.484 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.38     | 236.86     | 296.28     | 365.3 | 33.83
Neigh   | 0.81763    | 0.83676    | 0.85654    |   1.7 |  0.12
Comm    | 22.484     | 81.396     | 139.13     | 612.2 | 11.62
Output  | 0.40472    | 0.40535    | 0.406      |   0.1 |  0.06
Modify  | 203.09     | 274.63     | 344.2      | 418.0 | 39.22
Other   |            | 106.1      |            |       | 15.15

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1441.25 ave        2134 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5765
Ave neighs/atom = 1.1527694
Neighbor list builds = 110
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.56                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 197.991104273393
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.66
  ghost atom cutoff = 5.66
  binsize = 2.83, bins = 4498 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.7 | 37.7 | 37.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.0883031e-13  3.2649093e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            1.0129193e-05  3.2649093e-13  0              3.0387579e-05  21.874444      0              1056238.6      1.1971759e-13  0              4.7319951    
    200000   12727.922      200            200           -9.0548151e-05  3.2649093e-13  0             -0.00027164445  2113.7492      0              1.0206538e+08  1.1971759e-13  0              4.3879649    
    300000   12727.922      200            200            0.0021634923  -6.1015514e-06  0              0.0064965785   50638.415      0              2.4451478e+09  1.1971759e-13  0              4.2777622    
    400000   12727.922      200            200            0.01773369    -0.0014140631   0              0.054615132    3089.7932      0              1.4919505e+08  1.1971759e-13  0              4.2725983    
    500000   12727.922      200            200            0.0020814106   0.00021245308  0              0.0060317788   280.88021      0              13562700       1.1971759e-13  0              4.2775116    
    600000   12727.922      200            200            0.0064649385   8.9773305e-05  0              0.019305042    144.9038       0              6996886.1      1.1971759e-13  0              4.2755795    
    700000   12727.922      200            200            0.0062635753   0.00018957916  0              0.018601147    2.532046       0              122263.44      1.1971759e-13  0              4.2756677    
    800000   12727.922      200            200            0.0059053686   0.00024971515  0              0.017466391    0.26982082     0              13028.682      1.1971759e-13  0              4.2758032    
    900000   12727.922      200            200            0.0057431561   0.00026397193  0              0.016965496    0.27334327     0              13198.768      1.1971759e-13  0              4.2758638    
   1000000   12727.922      200            200            0.005692756    0.00026480383  0              0.016813464    0.060727938    0              2932.3348      1.1971759e-13  0              4.2758822    
   1100000   12727.922      200            200            0.00568461     0.00026490228  0              0.016788928    0.0060979316   0              294.44729      1.1971759e-13  0              4.275885     
   1200000   12727.922      200            200            0.0056864743   0.00026487669  0              0.016794546    0.00019302724  0              9.3205948      1.1971759e-13  0              4.2758843    
   1300000   12727.922      200            200            0.005688689    0.00026484814  0              0.016801219    4.5100058e-06  0              0.21777204     1.1971759e-13  0              4.2758835    
   1400000   12727.922      200            200            0.0056897707   0.00026483445  0              0.016804478    9.86257e-06    0              0.47622821     1.1971759e-13  0              4.2758831    
   1500000   12727.922      200            200            0.0056901238   0.00026483004  0              0.016805541    2.5695543e-06  0              0.12407458     1.1971759e-13  0              4.275883     
   1600000   12727.922      200            200            0.005690191    0.00026482923  0              0.016805744    2.9413737e-07  0              0.014202841    1.1971759e-13  0              4.2758829    
   1700000   12727.922      200            200            0.005690184    0.00026482933  0              0.016805723    1.2320281e-08  0              0.00059490228  1.1971759e-13  0              4.2758829    
   1800000   12727.922      200            200            0.0056901708   0.0002648295   0              0.016805683    3.6313854e-11  0              1.753466e-06   1.1971759e-13  0              4.2758829    
   1900000   12727.922      200            200            0.0056901638   0.00026482958  0              0.016805662    3.4271019e-10  0              1.6548249e-05  1.1971759e-13  0              4.2758829    
   2000000   12727.922      200            200            0.0056901613   0.00026482961  0              0.016805654    1.0650218e-10  0              5.1426089e-06  1.1971759e-13  0              4.2758829    
   2100000   12727.922      200            200            0.0056901608   0.00026482962  0              0.016805653    1.3842547e-11  0              6.6840706e-07  1.1971759e-13  0              4.2758829    
   2200000   12727.922      200            200            0.0056901608   0.00026482962  0              0.016805653    7.2331838e-13  0              3.4926456e-08  1.1971759e-13  0              4.2758829    
   2300000   12727.922      200            200            0.0056901609   0.00026482962  0              0.016805653    2.6621185e-16  0              1.2854418e-11  1.1971759e-13  0              4.2758829    
   2400000   12727.922      200            200            0.0056901609   0.00026482962  0              0.016805653    1.1052548e-14  0              5.33688e-10    1.1971759e-13  0              4.2758829    
   2500000   12727.922      200            200            0.0056901609   0.00026482962  0              0.016805653    4.1761405e-15  0              2.0165088e-10  1.1971759e-13  0              4.2758829    
   2600000   12727.922      200            200            0.0056901609   0.00026482962  0              0.016805653    6.0648998e-16  0              2.928523e-11   1.1971759e-13  0              4.2758829    
   2700000   12727.922      200            200            0.0056901609   0.00026482962  0              0.016805653    1.5986511e-17  0              7.7193141e-13  1.1971759e-13  0              4.2758829    
   2800000   12727.922      200            200            0.0056901609   0.00026482962  0              0.016805653    2.0912354e-17  0              1.0097827e-12  1.1971759e-13  0              4.2758829    
   2900000   12727.922      200            200            0.0056901609   0.00026482962  0              0.016805653    5.3527263e-17  0              2.58464e-12    1.1971759e-13  0              4.2758829    
   3000000   12727.922      200            200            0.0056901609   0.00026482963  0              0.016805653    6.4111011e-18  0              3.0956913e-13  1.1971759e-13  0              4.2758829    
Loop time of 688.49 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3764762.050 ns/day, 0.000 hours/ns, 4357.363 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 177.95     | 234.32     | 290.1      | 359.3 | 34.03
Neigh   | 0.7984     | 0.818      | 0.83866    |   1.7 |  0.12
Comm    | 23.832     | 78.722     | 136.27     | 618.4 | 11.43
Output  | 0.40511    | 0.40576    | 0.40641    |   0.1 |  0.06
Modify  | 198.46     | 269.23     | 338.22     | 418.5 | 39.10
Other   |            | 105        |            |       | 15.25

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1447.75 ave        2146 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5791
Ave neighs/atom = 1.1579684
Neighbor list builds = 108
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.57                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 199.061324148593
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.67
  ghost atom cutoff = 5.67
  binsize = 2.835, bins = 4490 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.66 | 37.66 | 37.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.1017079e-13  3.3051236e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            2.4483251e-05  3.3051236e-13  0              7.3449752e-05  124.7977       0              6026034.2      1.1971759e-13  0              4.7362742    
    200000   12727.922      200            200           -7.202546e-05   3.3051236e-13  0             -0.00021607638  1316.1834      0              63553784       1.1971759e-13  0              4.393274     
    300000   12727.922      200            200            0.0079242386  -0.00019681897  0              0.023969535    51466.521      0              2.4851341e+09  1.1971759e-13  0              4.2802508    
    400000   12727.922      200            200            0.020239593   -0.0012270464   0              0.061945825    660.86903      0              31911000       1.1971759e-13  0              4.2771091    
    500000   12727.922      200            200            0.0018261734   0.00016497714  0              0.005313543    65.755218      0              3175084.2      1.1971759e-13  0              4.2826756    
    600000   12727.922      200            200            0.0059920536   0.00023135744  0              0.017744803    182.16137      0              8795920.6      1.1971759e-13  0              4.2807645    
    700000   12727.922      200            200            0.0061639566   0.00019199745  0              0.018299872    9.6943687      0              468106.37      1.1971759e-13  0              4.2807063    
    800000   12727.922      200            200            0.0059185705   0.00024666475  0              0.017509047    0.024888378    0              1201.7707      1.1971759e-13  0              4.280802     
    900000   12727.922      200            200            0.0057688998   0.00025951978  0              0.01704718     0.10021995     0              4839.2628      1.1971759e-13  0              4.280858     
   1000000   12727.922      200            200            0.0057107726   0.00026256904  0              0.016869749    0.046901532    0              2264.7071      1.1971759e-13  0              4.2808795    
   1100000   12727.922      200            200            0.0056951731   0.00026276167  0              0.016822757    0.0081019932   0              391.21625      1.1971759e-13  0              4.2808852    
   1200000   12727.922      200            200            0.0056935241   0.00026278104  0              0.016817791    0.00067475698  0              32.5816        1.1971759e-13  0              4.2808857    
   1300000   12727.922      200            200            0.0056946078   0.00026276649  0              0.016821057    1.4468673e-05  0              0.69864042     1.1971759e-13  0              4.2808853    
   1400000   12727.922      200            200            0.0056954917   0.00026275502  0              0.01682372     1.3446548e-06  0              0.06492857     1.1971759e-13  0              4.280885     
   1500000   12727.922      200            200            0.0056958866   0.00026274997  0              0.01682491     1.4860275e-06  0              0.071754951    1.1971759e-13  0              4.2808848    
   1600000   12727.922      200            200            0.0056960094   0.00026274842  0              0.01682528     3.4757003e-07  0              0.016782913    1.1971759e-13  0              4.2808848    
   1700000   12727.922      200            200            0.0056960315   0.00026274814  0              0.016825346    3.8740552e-08  0              0.0018706426   1.1971759e-13  0              4.2808848    
   1800000   12727.922      200            200            0.0056960285   0.00026274819  0              0.016825337    1.6991693e-09  0              8.2046807e-05  1.1971759e-13  0              4.2808848    
   1900000   12727.922      200            200            0.0056960238   0.00026274825  0              0.016825323    1.4557956e-12  0              7.029516e-08   1.1971759e-13  0              4.2808848    
   2000000   12727.922      200            200            0.0056960212   0.00026274828  0              0.016825315    3.927293e-11   0              1.8963492e-06  1.1971759e-13  0              4.2808848    
   2100000   12727.922      200            200            0.0056960203   0.00026274829  0              0.016825313    1.3460208e-11  0              6.4994528e-07  1.1971759e-13  0              4.2808848    
   2200000   12727.922      200            200            0.0056960201   0.00026274829  0              0.016825312    1.9669552e-12  0              9.4977229e-08  1.1971759e-13  0              4.2808848    
   2300000   12727.922      200            200            0.0056960201   0.00026274829  0              0.016825312    1.3622383e-13  0              6.5777612e-09  1.1971759e-13  0              4.2808848    
   2400000   12727.922      200            200            0.0056960201   0.00026274829  0              0.016825312    1.2828425e-15  0              6.1943875e-11  1.1971759e-13  0              4.2808848    
   2500000   12727.922      200            200            0.0056960201   0.00026274829  0              0.016825312    5.8629289e-16  0              2.8309985e-11  1.1971759e-13  0              4.2808848    
   2600000   12727.922      200            200            0.0056960202   0.00026274829  0              0.016825312    1.0947111e-16  0              5.2859682e-12  1.1971759e-13  0              4.2808848    
   2700000   12727.922      200            200            0.0056960202   0.00026274829  0              0.016825312    6.5893182e-18  0              3.1817459e-13  1.1971759e-13  0              4.2808848    
   2800000   12727.922      200            200            0.0056960202   0.00026274829  0              0.016825312    2.6415412e-17  0              1.2755057e-12  1.1971759e-13  0              4.2808848    
   2900000   12727.922      200            200            0.0056960202   0.0002627483   0              0.016825312    1.2912845e-17  0              6.2351509e-13  1.1971759e-13  0              4.2808848    
   3000000   12727.922      200            200            0.0056960202   0.00026274829  0              0.016825312    9.7556521e-18  0              4.7106553e-13  1.1971759e-13  0              4.2808848    
Loop time of 696.396 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3722017.810 ns/day, 0.000 hours/ns, 4307.891 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.7      | 235.9      | 294.68     | 370.1 | 33.87
Neigh   | 0.81101    | 0.83142    | 0.85176    |   1.7 |  0.12
Comm    | 24.577     | 81.598     | 140.8      | 620.8 | 11.72
Output  | 0.40399    | 0.40466    | 0.40531    |   0.1 |  0.06
Modify  | 200.96     | 272.14     | 340.44     | 413.0 | 39.08
Other   |            | 105.5      |            |       | 15.15

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1453.25 ave        2157 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5813
Ave neighs/atom = 1.1623675
Neighbor list builds = 108
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.58                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 200.135393731431
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.68
  ghost atom cutoff = 5.68
  binsize = 2.84, bins = 4482 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.61 | 37.61 | 37.61 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.115181e-13   3.345543e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            3.896609e-05   3.345543e-13   0              0.00011689827  311.96174      0              15063516       1.1971759e-13  0              4.7405093    
    200000   12727.922      200            200           -5.3228524e-05  3.345543e-13   0             -0.00015968557  707.21392      0              34148829       1.1971759e-13  0              4.3984908    
    300000   12727.922      200            200            0.017245562   -0.00140194     0              0.053138626    45435.743      0              2.1939294e+09  1.1971759e-13  0              4.2827922    
    400000   12727.922      200            200            0.020811301   -0.0011332872   0              0.063567191    56.054306      0              2706661.8      1.1971759e-13  0              4.2820014    
    500000   12727.922      200            200            0.0017623488   0.00013217808  0              0.0051548684   0.81777473     0              39487.415      1.1971759e-13  0              4.2877244    
    600000   12727.922      200            200            0.0054585279   0.00021470296  0              0.016160881    184.86764      0              8926596.6      1.1971759e-13  0              4.2859609    
    700000   12727.922      200            200            0.0060123387   0.00021177791  0              0.017825238    18.129046      0              875386.75      1.1971759e-13  0              4.2857658    
    800000   12727.922      200            200            0.0059017426   0.00024761754  0              0.01745761     0.658629       0              31802.837      1.1971759e-13  0              4.285812     
    900000   12727.922      200            200            0.0057844991   0.00025919344  0              0.017094304    0.0037771989   0              182.38742      1.1971759e-13  0              4.2858564    
   1000000   12727.922      200            200            0.0057273313   0.00026370612  0              0.016918288    0.022119383    0              1068.0659      1.1971759e-13  0              4.2858778    
   1100000   12727.922      200            200            0.0057070172   0.00026394831  0              0.016857103    0.0071018011   0              342.92056      1.1971759e-13  0              4.2858852    
   1200000   12727.922      200            200            0.0057022274   0.00026400614  0              0.016842676    0.0010483872   0              50.622864      1.1971759e-13  0              4.285887     
   1300000   12727.922      200            200            0.0057019757   0.00026400863  0              0.016841918    7.7458135e-05  0              3.7401761      1.1971759e-13  0              4.285887     
   1400000   12727.922      200            200            0.0057024619   0.00026400237  0              0.016843383    1.2573275e-06  0              0.060711847    1.1971759e-13  0              4.2858868    
   1500000   12727.922      200            200            0.0057027977   0.00026399815  0              0.016844395    2.3461109e-07  0              0.01132853     1.1971759e-13  0              4.2858867    
   1600000   12727.922      200            200            0.0057029409   0.00026399637  0              0.016844826    2.035402e-07   0              0.0098282279   1.1971759e-13  0              4.2858867    
   1700000   12727.922      200            200            0.0057029848   0.00026399583  0              0.016844958    4.6288121e-08  0              0.0022350877   1.1971759e-13  0              4.2858866    
   1800000   12727.922      200            200            0.0057029928   0.00026399574  0              0.016844983    5.3384899e-09  0              0.00025777657  1.1971759e-13  0              4.2858866    
   1900000   12727.922      200            200            0.0057029919   0.00026399575  0              0.01684498     2.7239767e-10  0              1.3153109e-05  1.1971759e-13  0              4.2858866    
   2000000   12727.922      200            200            0.0057029903   0.00026399577  0              0.016844975    2.0021831e-13  0              9.6678254e-09  1.1971759e-13  0              4.2858866    
   2100000   12727.922      200            200            0.0057029894   0.00026399578  0              0.016844972    3.7423083e-12  0              1.8070267e-07  1.1971759e-13  0              4.2858866    
   2200000   12727.922      200            200            0.0057029891   0.00026399579  0              0.016844971    1.592353e-12   0              7.6889027e-08  1.1971759e-13  0              4.2858866    
   2300000   12727.922      200            200            0.005702989    0.00026399579  0              0.016844971    2.7431435e-13  0              1.3245658e-08  1.1971759e-13  0              4.2858866    
   2400000   12727.922      200            200            0.005702989    0.00026399579  0              0.016844971    2.4144987e-14  0              1.165875e-09   1.1971759e-13  0              4.2858866    
   2500000   12727.922      200            200            0.005702989    0.00026399579  0              0.016844971    8.4468159e-16  0              4.0786651e-11  1.1971759e-13  0              4.2858866    
   2600000   12727.922      200            200            0.005702989    0.00026399579  0              0.016844971    8.4100337e-17  0              4.0609043e-12  1.1971759e-13  0              4.2858866    
   2700000   12727.922      200            200            0.005702989    0.00026399579  0              0.016844971    6.9248892e-17  0              3.3437812e-12  1.1971759e-13  0              4.2858866    
   2800000   12727.922      200            200            0.005702989    0.00026399579  0              0.016844971    1.6180902e-17  0              7.8131783e-13  1.1971759e-13  0              4.2858866    
   2900000   12727.922      200            200            0.005702989    0.00026399579  0              0.016844971    1.7810988e-18  0              8.6002887e-14  1.1971759e-13  0              4.2858866    
   3000000   12727.922      200            200            0.005702989    0.00026399578  0              0.016844971    8.5096915e-18  0              4.1090255e-13  1.1971759e-13  0              4.2858866    
Loop time of 694.039 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3734661.254 ns/day, 0.000 hours/ns, 4322.525 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.38     | 236.38     | 293.58     | 363.7 | 34.06
Neigh   | 0.79312    | 0.81269    | 0.83252    |   1.7 |  0.12
Comm    | 24.491     | 80.482     | 137.93     | 617.9 | 11.60
Output  | 0.40407    | 0.40469    | 0.40536    |   0.1 |  0.06
Modify  | 199.92     | 270.83     | 339.97     | 415.2 | 39.02
Other   |            | 105.1      |            |       | 15.15

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1459.75 ave        2171 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5839
Ave neighs/atom = 1.1675665
Neighbor list builds = 106
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.59                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 201.213319933411
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.69
  ghost atom cutoff = 5.69
  binsize = 2.845, bins = 4474 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.57 | 37.57 | 37.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.1287224e-13  3.3861673e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            5.3577143e-05  3.3861673e-13  0              0.00016073143  583.24494      0              28162811       1.1971759e-13  0              4.7447002    
    200000   12727.922      200            200           -3.4159509e-05  3.3861673e-13  0             -0.00010247853  286.22927      0              13820987       1.1971759e-13  0              4.4036151    
    300000   12727.922      200            200            0.029497122   -0.0006573635   0              0.089148728    31486.933      0              1.5203913e+09  1.1971759e-13  0              4.2855988    
    400000   12727.922      200            200            0.019244454   -0.0012498313   0              0.058983192    1570.8652      0              75851457       1.1971759e-13  0              4.2872915    
    500000   12727.922      200            200            0.0018900059   0.00013470452  0              0.0055353131   97.212569      0              4694047.1      1.1971759e-13  0              4.2926557    
    600000   12727.922      200            200            0.0049791382   0.0002244383   0              0.014712976    153.37803      0              7406076.2      1.1971759e-13  0              4.2911497    
    700000   12727.922      200            200            0.0058319897   0.00025449916  0              0.01724147     23.928465      0              1155419.9      1.1971759e-13  0              4.2908393    
    800000   12727.922      200            200            0.0058567533   0.00024819121  0              0.017322069    1.827796       0              88257.727      1.1971759e-13  0              4.2908322    
    900000   12727.922      200            200            0.0057867586   0.00025795387  0              0.017102322    0.041072687    0              1983.2531      1.1971759e-13  0              4.2908595    
   1000000   12727.922      200            200            0.0057389028   0.00026280211  0              0.016953906    0.0029864208   0              144.20357      1.1971759e-13  0              4.2908777    
   1100000   12727.922      200            200            0.005717393    0.00026310073  0              0.016889078    0.0038352006   0              185.18811      1.1971759e-13  0              4.2908856    
   1200000   12727.922      200            200            0.0057104174   0.00026318363  0              0.016868069    0.0010043257   0              48.495291      1.1971759e-13  0              4.2908881    
   1300000   12727.922      200            200            0.0057089065   0.00026320141  0              0.016863518    0.00013605467  0              6.5695931      1.1971759e-13  0              4.2908886    
   1400000   12727.922      200            200            0.0057088898   0.00026320138  0              0.016863468    9.6066225e-06  0              0.46386942     1.1971759e-13  0              4.2908886    
   1500000   12727.922      200            200            0.005709082    0.00026319898  0              0.016864047    1.5094268e-07  0              0.0072884817   1.1971759e-13  0              4.2908886    
   1600000   12727.922      200            200            0.0057092053   0.00026319747  0              0.016864418    2.9219204e-08  0              0.0014108908   1.1971759e-13  0              4.2908885    
   1700000   12727.922      200            200            0.0057092573   0.00026319684  0              0.016864575    2.5546451e-08  0              0.0012335467   1.1971759e-13  0              4.2908885    
   1800000   12727.922      200            200            0.0057092734   0.00026319664  0              0.016864624    6.0511439e-09  0              0.00029218808  1.1971759e-13  0              4.2908885    
   1900000   12727.922      200            200            0.0057092767   0.0002631966   0              0.016864633    7.6065844e-10  0              3.6729474e-05  1.1971759e-13  0              4.2908885    
   2000000   12727.922      200            200            0.0057092765   0.00026319661  0              0.016864633    4.8226241e-11  0              2.3286726e-06  1.1971759e-13  0              4.2908885    
   2100000   12727.922      200            200            0.005709276    0.00026319661  0              0.016864631    4.586425e-13   0              2.2146205e-08  1.1971759e-13  0              4.2908885    
   2200000   12727.922      200            200            0.0057092757   0.00026319662  0              0.016864631    2.5424649e-13  0              1.2276653e-08  1.1971759e-13  0              4.2908885    
   2300000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     1.6817122e-13  0              8.1203866e-09  1.1971759e-13  0              4.2908885    
   2400000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     3.5971918e-14  0              1.7369552e-09  1.1971759e-13  0              4.2908885    
   2500000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     4.3860123e-15  0              2.1178484e-10  1.1971759e-13  0              4.2908885    
   2600000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     5.59244e-16    0              2.7003891e-11  1.1971759e-13  0              4.2908885    
   2700000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     7.3167711e-17  0              3.5330069e-12  1.1971759e-13  0              4.2908885    
   2800000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     1.0753143e-17  0              5.1923077e-13  1.1971759e-13  0              4.2908885    
   2900000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     1.0846206e-17  0              5.2372448e-13  1.1971759e-13  0              4.2908885    
   3000000   12727.922      200            200            0.0057092756   0.00026319662  0              0.01686463     9.3575451e-18  0              4.5184236e-13  1.1971759e-13  0              4.2908885    
Loop time of 697.758 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3714755.810 ns/day, 0.000 hours/ns, 4299.486 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.8      | 236.19     | 293.13     | 366.2 | 33.85
Neigh   | 0.79486    | 0.81453    | 0.83381    |   1.7 |  0.12
Comm    | 24.322     | 80.546     | 137.9      | 625.1 | 11.54
Output  | 0.40276    | 0.40342    | 0.40408    |   0.1 |  0.06
Modify  | 201.52     | 273.39     | 344.62     | 424.5 | 39.18
Other   |            | 106.4      |            |       | 15.25

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1465.75 ave        2183 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5863
Ave neighs/atom = 1.1723655
Neighbor list builds = 108
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.6                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 202.295109666036
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.7
  ghost atom cutoff = 5.7
  binsize = 2.85, bins = 4466 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.52 | 37.52 | 37.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.142332e-13   3.4269961e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            6.8315859e-05  3.4269961e-13  0              0.00020494758  938.52642      0              45318082       1.1971759e-13  0              4.7488469    
    200000   12727.922      200            200           -1.4820522e-05  3.4269961e-13  0             -4.4461566e-05  52.616008      0              2540638.7      1.1971759e-13  0              4.4086465    
    300000   12727.922      200            200            0.040336148   -0.0017343858   0              0.12274283     13914.439      0              6.7187844e+08  1.1971759e-13  0              4.2889331    
    400000   12727.922      200            200            0.01588976    -0.0016996021   0              0.049368881    4435.9841      0              2.141978e+08   1.1971759e-13  0              4.2929429    
    500000   12727.922      200            200            0.0021907645   8.3516225e-05  0              0.0064887772   335.9736       0              16222963       1.1971759e-13  0              4.2974723    
    600000   12727.922      200            200            0.0045695141   0.00018464359  0              0.013523899    100.56596      0              4855970.5      1.1971759e-13  0              4.2963131    
    700000   12727.922      200            200            0.0056254072   0.00025191354  0              0.016624308    24.484037      0              1182246.5      1.1971759e-13  0              4.2959185    
    800000   12727.922      200            200            0.0057940219   0.00025754466  0              0.017124521    2.9071409      0              140375.43      1.1971759e-13  0              4.29586      
    900000   12727.922      200            200            0.00577693     0.00025785114  0              0.017072939    0.18859658     0              9106.6541      1.1971759e-13  0              4.2958671    
   1000000   12727.922      200            200            0.0057453668   0.00026247131  0              0.016973629    0.0024115079   0              116.44309      1.1971759e-13  0              4.2958794    
   1100000   12727.922      200            200            0.0057263941   0.00026296142  0              0.016916221    0.00074418232  0              35.933901      1.1971759e-13  0              4.2958865    
   1200000   12727.922      200            200            0.0057185889   0.00026305078  0              0.016892716    0.00057719533  0              27.870697      1.1971759e-13  0              4.2958893    
   1300000   12727.922      200            200            0.0057161567   0.00026307869  0              0.016885391    0.00013671629  0              6.6015404      1.1971759e-13  0              4.2958902    
   1400000   12727.922      200            200            0.0057156492   0.00026308441  0              0.016883863    1.8054512e-05  0              0.87178779     1.1971759e-13  0              4.2958904    
   1500000   12727.922      200            200            0.0057156511   0.00026308431  0              0.016883869    1.3150467e-06  0              0.063498898    1.1971759e-13  0              4.2958904    
   1600000   12727.922      200            200            0.0057157204   0.00026308348  0              0.016884078    2.6508704e-08  0              0.0012800104   1.1971759e-13  0              4.2958904    
   1700000   12727.922      200            200            0.0057157644   0.00026308296  0              0.01688421     2.4786524e-09  0              0.00011968525  1.1971759e-13  0              4.2958903    
   1800000   12727.922      200            200            0.0057157833   0.00026308274  0              0.016884267    2.8788386e-09  0              0.00013900881  1.1971759e-13  0              4.2958903    
   1900000   12727.922      200            200            0.0057157894   0.00026308267  0              0.016884286    7.6209241e-10  0              3.6798715e-05  1.1971759e-13  0              4.2958903    
   2000000   12727.922      200            200            0.0057157908   0.00026308265  0              0.01688429     1.0905954e-10  0              5.2660947e-06  1.1971759e-13  0              4.2958903    
   2100000   12727.922      200            200            0.0057157908   0.00026308265  0              0.01688429     8.8237234e-12  0              4.2606602e-07  1.1971759e-13  0              4.2958903    
   2200000   12727.922      200            200            0.0057157907   0.00026308265  0              0.016884289    2.460351e-13   0              1.1880154e-08  1.1971759e-13  0              4.2958903    
   2300000   12727.922      200            200            0.0057157906   0.00026308265  0              0.016884289    7.2868153e-15  0              3.5185423e-10  1.1971759e-13  0              4.2958903    
   2400000   12727.922      200            200            0.0057157906   0.00026308265  0              0.016884289    1.4386329e-14  0              6.9466434e-10  1.1971759e-13  0              4.2958903    
   2500000   12727.922      200            200            0.0057157905   0.00026308265  0              0.016884289    4.1457813e-15  0              2.0018494e-10  1.1971759e-13  0              4.2958903    
   2600000   12727.922      200            200            0.0057157905   0.00026308265  0              0.016884289    5.1913305e-16  0              2.5067077e-11  1.1971759e-13  0              4.2958903    
   2700000   12727.922      200            200            0.0057157905   0.00026308265  0              0.016884289    7.2195342e-18  0              3.4860547e-13  1.1971759e-13  0              4.2958903    
   2800000   12727.922      200            200            0.0057157905   0.00026308265  0              0.016884289    1.2763167e-18  0              6.1628764e-14  1.1971759e-13  0              4.2958903    
   2900000   12727.922      200            200            0.0057157905   0.00026308266  0              0.016884289    3.813008e-18   0              1.8411651e-13  1.1971759e-13  0              4.2958903    
   3000000   12727.922      200            200            0.0057157905   0.00026308264  0              0.016884289    5.6320667e-18  0              2.7195234e-13  1.1971759e-13  0              4.2958903    
Loop time of 694.672 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3731255.140 ns/day, 0.000 hours/ns, 4318.582 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.04     | 237.03     | 293.14     | 364.4 | 34.12
Neigh   | 0.85055    | 0.8715     | 0.89247    |   1.8 |  0.13
Comm    | 23.656     | 80.454     | 137.91     | 625.6 | 11.58
Output  | 0.4005     | 0.40115    | 0.4018     |   0.1 |  0.06
Modify  | 202.27     | 271.73     | 340.3      | 415.3 | 39.12
Other   |            | 104.2      |            |       | 15.00

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1470.75 ave        2193 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5883
Ave neighs/atom = 1.1763647
Neighbor list builds = 114
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.61                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 203.38076984081
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.71
  ghost atom cutoff = 5.71
  binsize = 2.855, bins = 4459 71 71
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.48 | 37.49 | 37.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.1560098e-13  3.4680294e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            8.3181693e-05  3.4680294e-13  0              0.00024954508  1377.6861      0              66523529       1.1971759e-13  0              4.7529491    
    200000   12727.922      200            200            4.7863707e-06  3.4680294e-13  0              1.4359112e-05  5.7619173      0              278222.37      1.1971759e-13  0              4.4135848    
    300000   12727.922      200            200            0.046735134   -0.0026527896   0              0.14285819     1594.5749      0              76996316       1.1971759e-13  0              4.2930417    
    400000   12727.922      200            200            0.011969773   -0.0011668133   0              0.037076131    7321.3423      0              3.5352142e+08  1.1971759e-13  0              4.2988759    
    500000   12727.922      200            200            0.0027218154   7.1720711e-05  0              0.0080937255   667.71341      0              32241491       1.1971759e-13  0              4.3021831    
    600000   12727.922      200            200            0.0043141715   0.00026850866  0              0.012674006    45.997338      0              2221046.8      1.1971759e-13  0              4.3014364    
    700000   12727.922      200            200            0.0054336169   0.00025281386  0              0.016048037    19.625252      0              947633.21      1.1971759e-13  0              4.3009941    
    800000   12727.922      200            200            0.005720583    0.00026624938  0              0.0168955      3.3244174      0              160524.22      1.1971759e-13  0              4.3008919    
    900000   12727.922      200            200            0.0057572675   0.00025792028  0              0.017013882    0.35626266     0              17202.649      1.1971759e-13  0              4.3008784    
   1000000   12727.922      200            200            0.0057459287   0.00026050163  0              0.016977284    0.020723641    0              1000.6705      1.1971759e-13  0              4.3008832    
   1100000   12727.922      200            200            0.0057327115   0.00026117152  0              0.016936963    0.00016796965  0              8.1106533      1.1971759e-13  0              4.3008882    
   1200000   12727.922      200            200            0.0057255901   0.00026126399  0              0.016915506    0.00012070465  0              5.8283954      1.1971759e-13  0              4.3008908    
   1300000   12727.922      200            200            0.0057227663   0.00026129568  0              0.016907003    7.8332094e-05  0              3.7823765      1.1971759e-13  0              4.3008918    
   1400000   12727.922      200            200            0.0057218937   0.00026130541  0              0.016904376    1.8117259e-05  0              0.87481757     1.1971759e-13  0              4.3008921    
   1500000   12727.922      200            200            0.0057217075   0.00026130745  0              0.016903815    2.4604791e-06  0              0.11880773     1.1971759e-13  0              4.3008922    
   1600000   12727.922      200            200            0.005721704    0.00026130746  0              0.016903804    1.9768076e-07  0              0.0095452963   1.1971759e-13  0              4.3008922    
   1700000   12727.922      200            200            0.0057217267   0.00026130719  0              0.016903873    5.9985879e-09  0              0.00028965034  1.1971759e-13  0              4.3008922    
   1800000   12727.922      200            200            0.0057217418   0.00026130702  0              0.016903919    9.0183643e-11  0              4.3546453e-06  1.1971759e-13  0              4.3008922    
   1900000   12727.922      200            200            0.0057217486   0.00026130694  0              0.016903939    2.7345538e-10  0              1.3204182e-05  1.1971759e-13  0              4.3008922    
   2000000   12727.922      200            200            0.005721751    0.00026130692  0              0.016903946    8.8958218e-11  0              4.295474e-06   1.1971759e-13  0              4.3008922    
   2100000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    1.5118462e-11  0              7.3001642e-07  1.1971759e-13  0              4.3008922    
   2200000   12727.922      200            200            0.0057217517   0.00026130691  0              0.016903948    1.5672251e-12  0              7.567569e-08   1.1971759e-13  0              4.3008922    
   2300000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    8.2101039e-14  0              3.9643653e-09  1.1971759e-13  0              4.3008922    
   2400000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    2.7258009e-16  0              1.3161917e-11  1.1971759e-13  0              4.3008922    
   2500000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    6.3595192e-16  0              3.0707842e-11  1.1971759e-13  0              4.3008922    
   2600000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    6.4910105e-17  0              3.1342767e-12  1.1971759e-13  0              4.3008922    
   2700000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    1.4738979e-17  0              7.1169254e-13  1.1971759e-13  0              4.3008922    
   2800000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    2.2170993e-17  0              1.0705579e-12  1.1971759e-13  0              4.3008922    
   2900000   12727.922      200            200            0.0057217516   0.00026130691  0              0.016903948    2.7050843e-17  0              1.3061884e-12  1.1971759e-13  0              4.3008922    
   3000000   12727.922      200            200            0.0057217516   0.0002613069   0              0.016903948    2.4439294e-18  0              1.180086e-13   1.1971759e-13  0              4.3008922    
Loop time of 697.693 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3715100.248 ns/day, 0.000 hours/ns, 4299.885 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.04     | 237.54     | 295.36     | 372.4 | 34.05
Neigh   | 0.86382    | 0.88601    | 0.90846    |   1.8 |  0.13
Comm    | 23.782     | 81.434     | 139.89     | 635.4 | 11.67
Output  | 0.4008     | 0.40146    | 0.40212    |   0.1 |  0.06
Modify  | 202.09     | 272.35     | 341.75     | 415.6 | 39.04
Other   |            | 105.1      |            |       | 15.06

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1476.75 ave        2204 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5907
Ave neighs/atom = 1.1811638
Neighbor list builds = 116
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.62                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 204.470307369237
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.72
  ghost atom cutoff = 5.72
  binsize = 2.86, bins = 4451 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.79 | 36.8 | 36.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.1697556e-13  3.5092669e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            9.8174088e-05  3.5092669e-13  0              0.00029452226  1900.6042      0              91773375       1.1971759e-13  0              4.7570067    
    200000   12727.922      200            200            2.4659022e-05  3.5092669e-13  0              7.3977067e-05  145.05652      0              7004260.2      1.1971759e-13  0              4.4184295    
    300000   12727.922      200            200            0.046350135   -0.0027986834   0              0.14184909     2007.3923      0              96929790       1.1971759e-13  0              4.2980749    
    400000   12727.922      200            200            0.0082406194   2.9207742e-05  0              0.02469265     9123.5282      0              4.4054253e+08  1.1971759e-13  0              4.3049868    
    500000   12727.922      200            200            0.0035096415   8.8959107e-05  0              0.010439965    1014.1529      0              48969812       1.1971759e-13  0              4.3068037    
    600000   12727.922      200            200            0.0041598665   0.00026994455  0              0.012209655    8.7276551      0              421427.23      1.1971759e-13  0              4.3065088    
    700000   12727.922      200            200            0.005284124    0.00027353187  0              0.01557884     11.598524      0              560051.2       1.1971759e-13  0              4.3060577    
    800000   12727.922      200            200            0.0056448727   0.00026522601  0              0.016669392    2.8629954      0              138243.8       1.1971759e-13  0              4.3059237    
    900000   12727.922      200            200            0.0057306731   0.00025437038  0              0.016937649    0.44203339     0              21344.211      1.1971759e-13  0              4.3058918    
   1000000   12727.922      200            200            0.0057409574   0.00025522076  0              0.016967652    0.045233448    0              2184.1613      1.1971759e-13  0              4.3058885    
   1100000   12727.922      200            200            0.0057355053   0.00025559881  0              0.016950917    0.002580714    0              124.61344      1.1971759e-13  0              4.3058907    
   1200000   12727.922      200            200            0.0057304971   0.00025580591  0              0.016935685    2.2691798e-05  0              1.0957057      1.1971759e-13  0              4.3058925    
   1300000   12727.922      200            200            0.0057279118   0.00025586269  0              0.016927873    1.3857224e-05  0              0.66911574     1.1971759e-13  0              4.3058935    
   1400000   12727.922      200            200            0.0057268859   0.00025587479  0              0.016924783    9.5038463e-06  0              0.45890672     1.1971759e-13  0              4.3058939    
   1500000   12727.922      200            200            0.0057265614   0.00025587859  0              0.016923806    2.3144416e-06  0              0.1117561      1.1971759e-13  0              4.305894     
   1600000   12727.922      200            200            0.0057264862   0.00025587945  0              0.016923579    3.4063895e-07  0              0.016448236    1.1971759e-13  0              4.305894     
   1700000   12727.922      200            200            0.0057264805   0.00025587951  0              0.016923562    3.1857288e-08  0              0.0015382744   1.1971759e-13  0              4.305894     
   1800000   12727.922      200            200            0.0057264869   0.00025587943  0              0.016923581    1.4977737e-09  0              7.232213e-05   1.1971759e-13  0              4.305894     
   1900000   12727.922      200            200            0.0057264918   0.00025587937  0              0.016923596    2.0330123e-12  0              9.8166888e-08  1.1971759e-13  0              4.305894     
   2000000   12727.922      200            200            0.0057264941   0.00025587934  0              0.016923603    1.8109997e-11  0              8.7446694e-07  1.1971759e-13  0              4.305894     
   2100000   12727.922      200            200            0.005726495    0.00025587933  0              0.016923606    8.8849996e-12  0              4.2902483e-07  1.1971759e-13  0              4.305894     
   2200000   12727.922      200            200            0.0057264953   0.00025587933  0              0.016923607    1.912663e-12   0              9.2355652e-08  1.1971759e-13  0              4.305894     
   2300000   12727.922      200            200            0.0057264954   0.00025587933  0              0.016923607    2.575213e-13   0              1.2434782e-08  1.1971759e-13  0              4.305894     
   2400000   12727.922      200            200            0.0057264954   0.00025587933  0              0.016923607    2.1663751e-14  0              1.046065e-09   1.1971759e-13  0              4.305894     
   2500000   12727.922      200            200            0.0057264954   0.00025587933  0              0.016923607    9.4660249e-16  0              4.5708046e-11  1.1971759e-13  0              4.305894     
   2600000   12727.922      200            200            0.0057264954   0.00025587933  0              0.016923607    1.667571e-16   0              8.0521038e-12  1.1971759e-13  0              4.305894     
   2700000   12727.922      200            200            0.0057264954   0.00025587933  0              0.016923607    9.0897274e-17  0              4.389104e-12   1.1971759e-13  0              4.305894     
   2800000   12727.922      200            200            0.0057264954   0.00025587933  0              0.016923607    5.4794551e-17  0              2.6458328e-12  1.1971759e-13  0              4.305894     
   2900000   12727.922      200            200            0.0057264954   0.00025587933  0              0.016923607    5.5085503e-17  0              2.6598818e-12  1.1971759e-13  0              4.305894     
   3000000   12727.922      200            200            0.0057264954   0.00025587932  0              0.016923607    8.6588029e-18  0              4.181026e-13   1.1971759e-13  0              4.305894     
Loop time of 695.425 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3727217.136 ns/day, 0.000 hours/ns, 4313.909 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.81     | 237.72     | 296.12     | 375.5 | 34.18
Neigh   | 0.84534    | 0.86707    | 0.88856    |   1.8 |  0.12
Comm    | 22.566     | 81.574     | 139.58     | 641.2 | 11.73
Output  | 0.40245    | 0.40309    | 0.40374    |   0.1 |  0.06
Modify  | 200.76     | 269.93     | 339.36     | 417.3 | 38.82
Other   |            | 104.9      |            |       | 15.09

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1481.75 ave        2214 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5927
Ave neighs/atom = 1.185163
Neighbor list builds = 118
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.63                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 205.563729162822
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.73
  ghost atom cutoff = 5.73
  binsize = 2.865, bins = 4443 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.75 | 36.76 | 36.77 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.1835694e-13  3.5507083e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00011329249  3.5507083e-13  0              0.00033987748  2507.162       0              1.2106188e+08  1.1971759e-13  0              4.7610196    
    200000   12727.922      200            200            4.4795329e-05  3.5507083e-13  0              0.00013438599  469.88996      0              22689304       1.1971759e-13  0              4.4231804    
    300000   12727.922      200            200            0.039448807   -0.0015370744   0              0.11988349     14812.036      0              7.1522019e+08  1.1971759e-13  0              4.3040311    
    400000   12727.922      200            200            0.0048407459   0.00031429822  0              0.014207939    9436.6729      0              4.5566316e+08  1.1971759e-13  0              4.3111696    
    500000   12727.922      200            200            0.0045858785   0.00019650099  0              0.013561135    1277.7875      0              61699783       1.1971759e-13  0              4.3113575    
    600000   12727.922      200            200            0.0041381248   0.00026208488  0              0.012152289    1.2500216      0              60359.071      1.1971759e-13  0              4.311524     
    700000   12727.922      200            200            0.0051728248   0.00025114366  0              0.015267331    3.9908935      0              192705.96      1.1971759e-13  0              4.3111023    
    800000   12727.922      200            200            0.005578702    0.00025671593  0              0.01647939     1.7705021      0              85491.21       1.1971759e-13  0              4.3109514    
    900000   12727.922      200            200            0.0057021577   0.00024701383  0              0.016859459    0.39389177     0              19019.624      1.1971759e-13  0              4.3109055    
   1000000   12727.922      200            200            0.0057325446   0.00024763985  0              0.016949994    0.058882834    0              2843.2413      1.1971759e-13  0              4.3108948    
   1100000   12727.922      200            200            0.0057355247   0.00024748164  0              0.016959092    0.0061078584   0              294.92662      1.1971759e-13  0              4.3108939    
   1200000   12727.922      200            200            0.0057335445   0.00024770153  0              0.016952932    0.00039043338  0              18.852631      1.1971759e-13  0              4.3108946    
   1300000   12727.922      200            200            0.0057318007   0.00024779169  0              0.01694761     7.5877344e-06  0              0.36638454     1.1971759e-13  0              4.3108953    
   1400000   12727.922      200            200            0.0057308969   0.00024781228  0              0.016944878    6.4835273e-07  0              0.031306633    1.1971759e-13  0              4.3108956    
   1500000   12727.922      200            200            0.0057305271   0.00024781848  0              0.016943763    8.2566029e-07  0              0.039868181    1.1971759e-13  0              4.3108958    
   1600000   12727.922      200            200            0.005730401    0.00024782063  0              0.016943382    2.5048529e-07  0              0.012095038    1.1971759e-13  0              4.3108958    
   1700000   12727.922      200            200            0.0057303661   0.00024782122  0              0.016943277    4.5484787e-08  0              0.0021962976   1.1971759e-13  0              4.3108958    
   1800000   12727.922      200            200            0.0057303596   0.00024782132  0              0.016943258    5.7283318e-09  0              0.00027660064  1.1971759e-13  0              4.3108958    
   1900000   12727.922      200            200            0.00573036     0.00024782131  0              0.016943259    4.8735613e-10  0              2.3532683e-05  1.1971759e-13  0              4.3108958    
   2000000   12727.922      200            200            0.0057303611   0.0002478213   0              0.016943262    2.1447046e-11  0              1.0356011e-06  1.1971759e-13  0              4.3108958    
   2100000   12727.922      200            200            0.0057303618   0.00024782128  0              0.016943264    2.01346e-14    0              9.7222777e-10  1.1971759e-13  0              4.3108958    
   2200000   12727.922      200            200            0.0057303621   0.00024782128  0              0.016943265    2.7688557e-13  0              1.3369813e-08  1.1971759e-13  0              4.3108958    
   2300000   12727.922      200            200            0.0057303622   0.00024782128  0              0.016943265    1.3590101e-13  0              6.5621733e-09  1.1971759e-13  0              4.3108958    
   2400000   12727.922      200            200            0.0057303623   0.00024782128  0              0.016943266    3.1667385e-14  0              1.5291047e-09  1.1971759e-13  0              4.3108958    
   2500000   12727.922      200            200            0.0057303623   0.00024782127  0              0.016943266    4.8672432e-15  0              2.3502175e-10  1.1971759e-13  0              4.3108958    
   2600000   12727.922      200            200            0.0057303623   0.00024782128  0              0.016943266    6.5180487e-16  0              3.1473325e-11  1.1971759e-13  0              4.3108958    
   2700000   12727.922      200            200            0.0057303623   0.00024782128  0              0.016943266    1.4506506e-17  0              7.0046725e-13  1.1971759e-13  0              4.3108958    
   2800000   12727.922      200            200            0.0057303623   0.00024782127  0              0.016943266    9.4387428e-18  0              4.5576311e-13  1.1971759e-13  0              4.3108958    
   2900000   12727.922      200            200            0.0057303623   0.00024782127  0              0.016943266    3.1740209e-17  0              1.5326211e-12  1.1971759e-13  0              4.3108958    
   3000000   12727.922      200            200            0.0057303623   0.00024782127  0              0.016943266    8.3194003e-18  0              4.0171407e-13  1.1971759e-13  0              4.3108958    
Loop time of 691.045 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3750838.595 ns/day, 0.000 hours/ns, 4341.248 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 177.92     | 234.38     | 291.18     | 363.7 | 33.92
Neigh   | 0.82474    | 0.84597    | 0.8672     |   1.8 |  0.12
Comm    | 23.963     | 79.751     | 137.7      | 620.5 | 11.54
Output  | 0.40399    | 0.40466    | 0.40533    |   0.1 |  0.06
Modify  | 200.22     | 270.91     | 339.87     | 415.8 | 39.20
Other   |            | 104.8      |            |       | 15.16

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1429.25 ave        2109 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5717
Ave neighs/atom = 1.1431714
Neighbor list builds = 115
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.64                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 206.661042133067
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.74
  ghost atom cutoff = 5.74
  binsize = 2.87, bins = 4435 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.7 | 36.72 | 36.73 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.1974511e-13  3.5923534e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00012853634  3.5923534e-13  0              0.00038560901  3197.24        0              1.5438328e+08  1.1971759e-13  0              4.7649877    
    200000   12727.922      200            200            6.519316e-05   3.5923534e-13  0              0.00019557948  979.65298      0              47303936       1.1971759e-13  0              4.4278372    
    300000   12727.922      200            200            0.027907531   -0.0012441575   0              0.08496675     32062.175      0              1.5481677e+09  1.1971759e-13  0              4.3107553    
    400000   12727.922      200            200            0.0022940421   0.00024520742  0              0.0066369188   8504.0495      0              4.1063012e+08  1.1971759e-13  0              4.317333     
    500000   12727.922      200            200            0.0058473719   0.00016921868  0              0.017372897    1365.5786      0              65938906       1.1971759e-13  0              4.3158758    
    600000   12727.922      200            200            0.0042513498   0.00024810263  0              0.012505947    25.868538      0              1249099.1      1.1971759e-13  0              4.3164809    
    700000   12727.922      200            200            0.0051291292   0.00024073236  0              0.015146655    0.13553056     0              6544.2857      1.1971759e-13  0              4.3161229    
    800000   12727.922      200            200            0.0055315461   0.00024120792  0              0.016353431    0.62291536     0              30078.353      1.1971759e-13  0              4.3159714    
    900000   12727.922      200            200            0.0056784146   0.00024049255  0              0.016794751    0.24125196     0              11649.194      1.1971759e-13  0              4.3159177    
   1000000   12727.922      200            200            0.0057237604   0.00024017138  0              0.01693111     0.052112587    0              2516.3303      1.1971759e-13  0              4.3159013    
   1100000   12727.922      200            200            0.0057344799   0.00023956056  0              0.016963879    0.0079068646   0              381.79419      1.1971759e-13  0              4.3158975    
   1200000   12727.922      200            200            0.0057358172   0.00023963775  0              0.016967814    0.00088528399  0              42.747196      1.1971759e-13  0              4.315897     
   1300000   12727.922      200            200            0.0057352695   0.00023969214  0              0.016966116    6.8684612e-05  0              3.3165341      1.1971759e-13  0              4.3158973    
   1400000   12727.922      200            200            0.0057347135   0.00023970338  0              0.016964437    2.6895303e-06  0              0.12986779     1.1971759e-13  0              4.3158975    
   1500000   12727.922      200            200            0.0057344112   0.00023970954  0              0.016963524    6.8660417e-12  0              3.3153658e-07  1.1971759e-13  0              4.3158976    
   1600000   12727.922      200            200            0.0057342804   0.00023971221  0              0.016963129    4.760977e-08   0              0.0022989054   1.1971759e-13  0              4.3158976    
   1700000   12727.922      200            200            0.0057342321   0.00023971319  0              0.016962983    2.2082248e-08  0              0.0010662727   1.1971759e-13  0              4.3158977    
   1800000   12727.922      200            200            0.0057342168   0.0002397135   0              0.016962937    5.1404363e-09  0              0.00024821327  1.1971759e-13  0              4.3158977    
   1900000   12727.922      200            200            0.0057342129   0.00023971358  0              0.016962925    8.2828573e-10  0              3.9994954e-05  1.1971759e-13  0              4.3158977    
   2000000   12727.922      200            200            0.0057342123   0.00023971359  0              0.016962923    9.8754525e-11  0              4.7685026e-06  1.1971759e-13  0              4.3158977    
   2100000   12727.922      200            200            0.0057342124   0.00023971359  0              0.016962924    8.3598652e-12  0              4.0366797e-07  1.1971759e-13  0              4.3158977    
   2200000   12727.922      200            200            0.0057342125   0.00023971359  0              0.016962924    3.9854979e-13  0              1.9244543e-08  1.1971759e-13  0              4.3158977    
   2300000   12727.922      200            200            0.0057342126   0.00023971359  0              0.016962924    1.5918079e-15  0              7.6862709e-11  1.1971759e-13  0              4.3158977    
   2400000   12727.922      200            200            0.0057342127   0.00023971359  0              0.016962924    3.0802056e-15  0              1.4873211e-10  1.1971759e-13  0              4.3158977    
   2500000   12727.922      200            200            0.0057342127   0.00023971359  0              0.016962924    1.9018275e-15  0              9.1832446e-11  1.1971759e-13  0              4.3158977    
   2600000   12727.922      200            200            0.0057342127   0.00023971359  0              0.016962924    1.4108279e-16  0              6.812383e-12   1.1971759e-13  0              4.3158977    
   2700000   12727.922      200            200            0.0057342127   0.00023971358  0              0.016962924    7.8170456e-18  0              3.7745715e-13  1.1971759e-13  0              4.3158977    
   2800000   12727.922      200            200            0.0057342127   0.00023971358  0              0.016962924    1.4125934e-17  0              6.8209081e-13  1.1971759e-13  0              4.3158977    
   2900000   12727.922      200            200            0.0057342127   0.00023971358  0              0.016962924    4.7651519e-17  0              2.3009213e-12  1.1971759e-13  0              4.3158977    
   3000000   12727.922      200            200            0.0057342127   0.00023971358  0              0.016962924    8.6565619e-18  0              4.179944e-13   1.1971759e-13  0              4.3158977    
Loop time of 688.932 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3762346.148 ns/day, 0.000 hours/ns, 4354.567 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.29     | 234.43     | 289.92     | 359.5 | 34.03
Neigh   | 0.80848    | 0.82911    | 0.84982    |   1.8 |  0.12
Comm    | 24.117     | 79.278     | 135.48     | 617.1 | 11.51
Output  | 0.40241    | 0.40305    | 0.40368    |   0.1 |  0.06
Modify  | 198.72     | 269.04     | 338.25     | 418.5 | 39.05
Other   |            | 104.9      |            |       | 15.23

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1435.75 ave        2123 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5743
Ave neighs/atom = 1.1483703
Neighbor list builds = 111
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.65                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 207.762253191476
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.75
  ghost atom cutoff = 5.75
  binsize = 2.875, bins = 4428 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.66 | 36.67 | 36.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.2114007e-13  3.6342021e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00014390507  3.6342021e-13  0              0.0004317152   3970.7203      0              1.9173187e+08  1.1971759e-13  0              4.7689107    
    200000   12727.922      200            200            8.5850353e-05  3.6342021e-13  0              0.00025755106  1673.7357      0              80818707       1.1971759e-13  0              4.4323994    
    300000   12727.922      200            200            0.015727702   -0.0012311096   0              0.048414215    44912.143      0              2.1686466e+09  1.1971759e-13  0              4.317995     
    400000   12727.922      200            200            0.00067589529 -5.3102648e-05  0              0.0020807885   6875.2687      0              3.3198212e+08  1.1971759e-13  0              4.32341      
    500000   12727.922      200            200            0.0071571073  -0.0001447844   0              0.021616106    1225.6353      0              59181541       1.1971759e-13  0              4.3203974    
    600000   12727.922      200            200            0.0044931563   0.00022037592  0              0.013259093    74.011951      0              3573772.3      1.1971759e-13  0              4.3213831    
    700000   12727.922      200            200            0.0051554126   0.00023548937  0              0.015230749    1.6872431      0              81470.93       1.1971759e-13  0              4.3211174    
    800000   12727.922      200            200            0.0055150398   0.00023441277  0              0.016310707    0.020198098    0              975.29387      1.1971759e-13  0              4.3209812    
    900000   12727.922      200            200            0.0056641643   0.00023564678  0              0.016756846    0.076872048    0              3711.8761      1.1971759e-13  0              4.3209266    
   1000000   12727.922      200            200            0.0057173559   0.0002339925   0              0.016918075    0.029618887    0              1430.19        1.1971759e-13  0              4.3209071    
   1100000   12727.922      200            200            0.0057338523   0.00023304087  0              0.016968516    0.0065240743   0              315.0242       1.1971759e-13  0              4.3209011    
   1200000   12727.922      200            200            0.0057381592   0.00023292203  0              0.016981556    0.0010512268   0              50.759979      1.1971759e-13  0              4.3208996    
   1300000   12727.922      200            200            0.0057388897   0.00023290647  0              0.016983763    0.00013135474  0              6.3426504      1.1971759e-13  0              4.3208993    
   1400000   12727.922      200            200            0.0057388136   0.00023290856  0              0.016983532    1.2479894e-05  0              0.60260943     1.1971759e-13  0              4.3208994    
   1500000   12727.922      200            200            0.0057386632   0.00023291208  0              0.016983078    7.9590348e-07  0              0.03843133     1.1971759e-13  0              4.3208994    
   1600000   12727.922      200            200            0.0057385701   0.00023291423  0              0.016982796    1.9508125e-08  0              0.00094197752  1.1971759e-13  0              4.3208995    
   1700000   12727.922      200            200            0.0057385262   0.00023291523  0              0.016982663    5.575679e-10   0              2.6922958e-05  1.1971759e-13  0              4.3208995    
   1800000   12727.922      200            200            0.0057385085   0.00023291564  0              0.01698261     1.2231921e-09  0              5.9063571e-05  1.1971759e-13  0              4.3208995    
   1900000   12727.922      200            200            0.0057385022   0.00023291578  0              0.016982591    4.3612656e-10  0              2.1058991e-05  1.1971759e-13  0              4.3208995    
   2000000   12727.922      200            200            0.0057385002   0.00023291582  0              0.016982585    9.3529648e-11  0              4.516212e-06   1.1971759e-13  0              4.3208995    
   2100000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    1.4819861e-11  0              7.1559805e-07  1.1971759e-13  0              4.3208995    
   2200000   12727.922      200            200            0.0057384997   0.00023291584  0              0.016982583    1.8211259e-12  0              8.7935653e-08  1.1971759e-13  0              4.3208995    
   2300000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    1.6783121e-13  0              8.1039685e-09  1.1971759e-13  0              4.3208995    
   2400000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    1.0068049e-14  0              4.8615004e-10  1.1971759e-13  0              4.3208995    
   2500000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    2.8552087e-16  0              1.3786781e-11  1.1971759e-13  0              4.3208995    
   2600000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    1.1906487e-16  0              5.7492166e-12  1.1971759e-13  0              4.3208995    
   2700000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    9.1902021e-17  0              4.4376197e-12  1.1971759e-13  0              4.3208995    
   2800000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    4.1661845e-17  0              2.0117014e-12  1.1971759e-13  0              4.3208995    
   2900000   12727.922      200            200            0.0057384997   0.00023291584  0              0.016982583    2.2803633e-17  0              1.1011058e-12  1.1971759e-13  0              4.3208995    
   3000000   12727.922      200            200            0.0057384997   0.00023291583  0              0.016982583    1.0016292e-17  0              4.8365091e-13  1.1971759e-13  0              4.3208995    
Loop time of 692.131 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3744957.921 ns/day, 0.000 hours/ns, 4334.442 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.42     | 235.95     | 292.61     | 361.7 | 34.09
Neigh   | 0.79182    | 0.81284    | 0.83449    |   1.8 |  0.12
Comm    | 23.826     | 79.512     | 137.32     | 620.3 | 11.49
Output  | 0.4025     | 0.40314    | 0.40378    |   0.1 |  0.06
Modify  | 200.31     | 270.91     | 339.48     | 414.9 | 39.14
Other   |            | 104.5      |            |       | 15.10

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1442.25 ave        2135 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5769
Ave neighs/atom = 1.1535693
Neighbor list builds = 109
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.66                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 208.867369249554
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.76
  ghost atom cutoff = 5.76
  binsize = 2.88, bins = 4420 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.62 | 36.63 | 36.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.225418e-13   3.6762541e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00015939816  3.6762541e-13  0              0.00047819447  4827.4875      0              2.331021e+08   1.1971759e-13  0              4.7727885    
    200000   12727.922      200            200            0.00010676489  3.6762541e-13  0              0.00032029467  2551.5346      0              1.2320447e+08  1.1971759e-13  0              4.4368668    
    300000   12727.922      200            200            0.0066900934   0.00055413603  0              0.019516144    49506.998      0              2.3905157e+09  1.1971759e-13  0              4.3254816    
    400000   12727.922      200            200            4.6597976e-06  1.0866074e-05  0              3.1133191e-06  5074.6474      0              2.4503656e+08  1.1971759e-13  0              4.3293591    
    500000   12727.922      200            200            0.0084687569  -0.00043181658  0              0.025838087    883.82709      0              42676847       1.1971759e-13  0              4.3249659    
    600000   12727.922      200            200            0.0048672157   0.00022405185  0              0.014377595    128.58659      0              6208986        1.1971759e-13  0              4.3262394    
    700000   12727.922      200            200            0.0052478741   0.00022928617  0              0.015514336    7.9237677      0              382610.38      1.1971759e-13  0              4.3260866    
    800000   12727.922      200            200            0.0055288841   0.00022710464  0              0.016359548    0.27313696     0              13188.806      1.1971759e-13  0              4.3259798    
    900000   12727.922      200            200            0.0056613959   0.0002293174   0              0.01675487     0.00039350968  0              19.001174      1.1971759e-13  0              4.3259312    
   1000000   12727.922      200            200            0.0057146913   0.00022714625  0              0.016916928    0.0071279072   0              344.18113      1.1971759e-13  0              4.3259115    
   1100000   12727.922      200            200            0.0057340318   0.00022590864  0              0.016976187    0.0030948919   0              149.44125      1.1971759e-13  0              4.3259044    
   1200000   12727.922      200            200            0.0057403862   0.00022557654  0              0.016995582    0.00074598646  0              36.021017      1.1971759e-13  0              4.3259021    
   1300000   12727.922      200            200            0.0057422133   0.00022553107  0              0.017001109    0.00013265633  0              6.4054993      1.1971759e-13  0              4.3259014    
   1400000   12727.922      200            200            0.0057426231   0.00022552138  0              0.017002348    1.8841214e-05  0              0.9097748      1.1971759e-13  0              4.3259013    
   1500000   12727.922      200            200            0.0057426627   0.00022552057  0              0.017002468    2.1658509e-06  0              0.10458119     1.1971759e-13  0              4.3259013    
   1600000   12727.922      200            200            0.0057426353   0.00022552129  0              0.017002385    1.9407791e-07  0              0.0093713279   1.1971759e-13  0              4.3259013    
   1700000   12727.922      200            200            0.0057426109   0.0002255219   0              0.017002311    1.182873e-08   0              0.00057116702  1.1971759e-13  0              4.3259013    
   1800000   12727.922      200            200            0.0057425977   0.00022552223  0              0.017002271    2.7198437e-10  0              1.3133152e-05  1.1971759e-13  0              4.3259013    
   1900000   12727.922      200            200            0.0057425917   0.00022552238  0              0.017002253    9.769751e-12   0              4.7174631e-07  1.1971759e-13  0              4.3259013    
   2000000   12727.922      200            200            0.0057425894   0.00022552244  0              0.017002246    1.9238053e-11  0              9.2893672e-07  1.1971759e-13  0              4.3259013    
   2100000   12727.922      200            200            0.0057425885   0.00022552246  0              0.017002243    6.9061127e-12  0              3.3347146e-07  1.1971759e-13  0              4.3259013    
   2200000   12727.922      200            200            0.0057425883   0.00022552246  0              0.017002242    1.5340416e-12  0              7.4073378e-08  1.1971759e-13  0              4.3259013    
   2300000   12727.922      200            200            0.0057425882   0.00022552246  0              0.017002242    2.5813701e-13  0              1.2464513e-08  1.1971759e-13  0              4.3259013    
   2400000   12727.922      200            200            0.0057425882   0.00022552246  0              0.017002242    3.4780554e-14  0              1.6794285e-09  1.1971759e-13  0              4.3259013    
   2500000   12727.922      200            200            0.0057425882   0.00022552246  0              0.017002242    3.8761275e-15  0              1.8716432e-10  1.1971759e-13  0              4.3259013    
   2600000   12727.922      200            200            0.0057425882   0.00022552246  0              0.017002242    6.1174731e-16  0              2.9539088e-11  1.1971759e-13  0              4.3259013    
   2700000   12727.922      200            200            0.0057425882   0.00022552246  0              0.017002242    2.9856131e-17  0              1.4416457e-12  1.1971759e-13  0              4.3259013    
   2800000   12727.922      200            200            0.0057425882   0.00022552246  0              0.017002242    4.1289385e-17  0              1.9937166e-12  1.1971759e-13  0              4.3259013    
   2900000   12727.922      200            200            0.0057425882   0.00022552247  0              0.017002242    3.1202684e-17  0              1.506666e-12   1.1971759e-13  0              4.3259013    
   3000000   12727.922      200            200            0.0057425882   0.00022552246  0              0.017002242    1.0337021e-17  0              4.9913777e-13  1.1971759e-13  0              4.3259013    
Loop time of 690.254 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3755138.597 ns/day, 0.000 hours/ns, 4346.225 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.09     | 235.53     | 290.59     | 358.6 | 34.12
Neigh   | 0.77193    | 0.79173    | 0.81217    |   1.8 |  0.11
Comm    | 23.464     | 79.142     | 135.09     | 619.1 | 11.47
Output  | 0.40631    | 0.40695    | 0.4076     |   0.1 |  0.06
Modify  | 200.06     | 269.59     | 338.9      | 417.0 | 39.06
Other   |            | 104.8      |            |       | 15.18

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1448.75 ave        2149 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5795
Ave neighs/atom = 1.1587682
Neighbor list builds = 107
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.67                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 209.976397218804
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.77
  ghost atom cutoff = 5.77
  binsize = 2.885, bins = 4412 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.58 | 36.59 | 36.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.2395031e-13  3.7185092e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.000175015    3.7185092e-13  0              0.00052504499  5767.4215      0              2.7848815e+08  1.1971759e-13  0              4.776621     
    200000   12727.922      200            200            0.00012793452  3.7185092e-13  0              0.00038380356  3612.4377      0              1.7443169e+08  1.1971759e-13  0              4.4412389    
    300000   12727.922      200            200            0.00094885464 -8.662583e-05   0              0.0029331898   47400.824      0              2.2888162e+09  1.1971759e-13  0              4.332999     
    400000   12727.922      200            200           -0.00011318147  3.7185092e-13  0             -0.0003395444   3446.7014      0              1.6642887e+08  1.1971759e-13  0              4.3351602    
    500000   12727.922      200            200            0.0096180664  -0.00058477677  0              0.029438976    455.78747      0              22008346       1.1971759e-13  0              4.3296247    
    600000   12727.922      200            200            0.0053438647   0.00023520047  0              0.015796394    169.18321      0              8169251.9      1.1971759e-13  0              4.3310631    
    700000   12727.922      200            200            0.0054016737   0.0002326554   0              0.015972366    16.037349      0              774386.2       1.1971759e-13  0              4.3310343    
    800000   12727.922      200            200            0.005571823    0.00021898061  0              0.016496488    1.2413715      0              59941.389      1.1971759e-13  0              4.3309676    
    900000   12727.922      200            200            0.0056713602   0.00022172059  0              0.01679236     0.057656458    0              2784.024       1.1971759e-13  0              4.330931     
   1000000   12727.922      200            200            0.0057170288   0.00021955481  0              0.016931532    0.00034277071  0              16.551171      1.1971759e-13  0              4.330914     
   1100000   12727.922      200            200            0.0057358312   0.00021811228  0              0.016989381    0.00035899969  0              17.33481       1.1971759e-13  0              4.330907     
   1200000   12727.922      200            200            0.0057429681   0.00021768541  0              0.017011219    0.00024840252  0              11.994469      1.1971759e-13  0              4.3309044    
   1300000   12727.922      200            200            0.0057454631   0.0002176182   0              0.017018771    7.2463627e-05  0              3.4990092      1.1971759e-13  0              4.3309035    
   1400000   12727.922      200            200            0.0057462455   0.00021759808  0              0.017021139    1.4873514e-05  0              0.71818875     1.1971759e-13  0              4.3309032    
   1500000   12727.922      200            200            0.0057464596   0.0002175927   0              0.017021786    2.4436798e-06  0              0.11799655     1.1971759e-13  0              4.3309031    
   1600000   12727.922      200            200            0.0057465047   0.00021759159  0              0.017021923    3.3542122e-07  0              0.01619629     1.1971759e-13  0              4.3309031    
   1700000   12727.922      200            200            0.0057465077   0.00021759154  0              0.017021932    3.8628891e-08  0              0.0018652509   1.1971759e-13  0              4.3309031    
   1800000   12727.922      200            200            0.0057465037   0.00021759165  0              0.017021919    3.6206211e-09  0              0.00017482684  1.1971759e-13  0              4.3309031    
   1900000   12727.922      200            200            0.0057465005   0.00021759173  0              0.01702191     2.5099612e-10  0              1.2119704e-05  1.1971759e-13  0              4.3309031    
   2000000   12727.922      200            200            0.0057464988   0.00021759178  0              0.017021905    9.2417286e-12  0              4.4625e-07     1.1971759e-13  0              4.3309031    
   2100000   12727.922      200            200            0.0057464981   0.0002175918   0              0.017021902    4.9921424e-17  0              2.4105269e-12  1.1971759e-13  0              4.3309031    
   2200000   12727.922      200            200            0.0057464977   0.0002175918   0              0.017021901    1.5984472e-13  0              7.7183294e-09  1.1971759e-13  0              4.3309031    
   2300000   12727.922      200            200            0.0057464976   0.00021759181  0              0.017021901    7.9428674e-14  0              3.8353264e-09  1.1971759e-13  0              4.3309031    
   2400000   12727.922      200            200            0.0057464976   0.00021759181  0              0.017021901    2.1017188e-14  0              1.0148448e-09  1.1971759e-13  0              4.3309031    
   2500000   12727.922      200            200            0.0057464976   0.00021759181  0              0.017021901    4.0614026e-15  0              1.961106e-10   1.1971759e-13  0              4.3309031    
   2600000   12727.922      200            200            0.0057464976   0.00021759181  0              0.017021901    3.4382111e-16  0              1.6601891e-11  1.1971759e-13  0              4.3309031    
   2700000   12727.922      200            200            0.0057464976   0.00021759181  0              0.017021901    2.6626747e-18  0              1.2857103e-13  1.1971759e-13  0              4.3309031    
   2800000   12727.922      200            200            0.0057464976   0.00021759181  0              0.017021901    6.2211609e-18  0              3.0039759e-13  1.1971759e-13  0              4.3309031    
   2900000   12727.922      200            200            0.0057464976   0.00021759181  0              0.017021901    1.4545513e-17  0              7.0235078e-13  1.1971759e-13  0              4.3309031    
   3000000   12727.922      200            200            0.0057464976   0.0002175918   0              0.017021901    4.0937356e-18  0              1.9767184e-13  1.1971759e-13  0              4.3309031    
Loop time of 693.689 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3736546.411 ns/day, 0.000 hours/ns, 4324.706 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.92     | 235.98     | 293.52     | 370.4 | 34.02
Neigh   | 0.77419    | 0.79465    | 0.81573    |   1.8 |  0.11
Comm    | 22.913     | 81.015     | 138.1      | 631.3 | 11.68
Output  | 0.40401    | 0.40464    | 0.40529    |   0.1 |  0.06
Modify  | 201.37     | 270.59     | 339.63     | 419.3 | 39.01
Other   |            | 104.9      |            |       | 15.12

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1454.75 ave        2161 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5819
Ave neighs/atom = 1.1635673
Neighbor list builds = 107
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.68                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 211.08934401073
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.78
  ghost atom cutoff = 5.78
  binsize = 2.89, bins = 4405 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.55 | 36.57 | 36.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.2536557e-13  3.7609672e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00019075508  3.7609672e-13  0              0.00057226525  6790.4097      0              3.2788458e+08  1.1971759e-13  0              4.780408     
    200000   12727.922      200            200            0.00014935725  3.7609672e-13  0              0.00044807174  4855.8462      0              2.3447143e+08  1.1971759e-13  0              4.4455155    
    300000   12727.922      200            200           -0.00035782318  3.7609672e-13  0             -0.0010734695   42492.813      0              2.0518259e+09  1.1971759e-13  0              4.3404208    
    400000   12727.922      200            200           -8.9833361e-05  3.7609672e-13  0             -0.00026950008  2127.8259      0              1.027451e+08   1.1971759e-13  0              4.3408081    
    500000   12727.922      200            200            0.010377235   -0.00067556613  0              0.03180727     112.17272      0              5416419.4      1.1971759e-13  0              4.3344114    
    600000   12727.922      200            200            0.0058685383   0.00020034871  0              0.017405266    179.28192      0              8656882.1      1.1971759e-13  0              4.3358712    
    700000   12727.922      200            200            0.0055957104   0.0002264831   0              0.016560648    22.324123      0              1077952        1.1971759e-13  0              4.3359666    
    800000   12727.922      200            200            0.0056377421   0.00020676298  0              0.016706463    2.4051152      0              116134.4       1.1971759e-13  0              4.3359465    
    900000   12727.922      200            200            0.0056929251   0.00021209808  0              0.016866677    0.21253903     0              10262.749      1.1971759e-13  0              4.3359263    
   1000000   12727.922      200            200            0.0057242057   0.00020978205  0              0.016962835    0.013842708    0              668.41484      1.1971759e-13  0              4.3359145    
   1100000   12727.922      200            200            0.005739208    0.00020820427  0              0.01700942     0.00046276358  0              22.345197      1.1971759e-13  0              4.3359088    
   1200000   12727.922      200            200            0.0057457445   0.00020783796  0              0.017029395    3.1991663e-07  0              0.015447629    1.1971759e-13  0              4.3359064    
   1300000   12727.922      200            200            0.0057483443   0.00020776322  0              0.01703727     1.0795519e-05  0              0.52127696     1.1971759e-13  0              4.3359054    
   1400000   12727.922      200            200            0.0057492982   0.00020773692  0              0.017040158    5.0513551e-06  0              0.24391186     1.1971759e-13  0              4.3359051    
   1500000   12727.922      200            200            0.005749624    0.0002077281   0              0.017041144    1.3191919e-06  0              0.063699056    1.1971759e-13  0              4.335905     
   1600000   12727.922      200            200            0.0057497263   0.00020772536  0              0.017041454    2.6081987e-07  0              0.012594058    1.1971759e-13  0              4.3359049    
   1700000   12727.922      200            200            0.005749755    0.0002077246   0              0.017041541    4.2878963e-08  0              0.0020704717   1.1971759e-13  0              4.3359049    
   1800000   12727.922      200            200            0.0057497616   0.00020772443  0              0.01704156     6.0719397e-09  0              0.00029319224  1.1971759e-13  0              4.3359049    
   1900000   12727.922      200            200            0.0057497624   0.00020772441  0              0.017041563    7.4675432e-10  0              3.6058094e-05  1.1971759e-13  0              4.3359049    
   2000000   12727.922      200            200            0.0057497621   0.00020772442  0              0.017041562    7.8666056e-11  0              3.7985023e-06  1.1971759e-13  0              4.3359049    
   2100000   12727.922      200            200            0.0057497617   0.00020772443  0              0.017041561    6.7929118e-12  0              3.280054e-07   1.1971759e-13  0              4.3359049    
   2200000   12727.922      200            200            0.0057497615   0.00020772444  0              0.01704156     4.2750608e-13  0              2.0642739e-08  1.1971759e-13  0              4.3359049    
   2300000   12727.922      200            200            0.0057497614   0.00020772444  0              0.01704156     1.3467713e-14  0              6.5030766e-10  1.1971759e-13  0              4.3359049    
   2400000   12727.922      200            200            0.0057497614   0.00020772444  0              0.01704156     6.0228119e-17  0              2.9082003e-12  1.1971759e-13  0              4.3359049    
   2500000   12727.922      200            200            0.0057497614   0.00020772444  0              0.01704156     4.6239743e-16  0              2.2327517e-11  1.1971759e-13  0              4.3359049    
   2600000   12727.922      200            200            0.0057497614   0.00020772444  0              0.01704156     5.5880709e-19  0              2.6982795e-14  1.1971759e-13  0              4.3359049    
   2700000   12727.922      200            200            0.0057497614   0.00020772444  0              0.01704156     6.46461e-17    0              3.1215288e-12  1.1971759e-13  0              4.3359049    
   2800000   12727.922      200            200            0.0057497614   0.00020772444  0              0.01704156     1.6788282e-18  0              8.1064605e-14  1.1971759e-13  0              4.3359049    
   2900000   12727.922      200            200            0.0057497614   0.00020772444  0              0.01704156     2.9816048e-19  0              1.4397102e-14  1.1971759e-13  0              4.3359049    
   3000000   12727.922      200            200            0.0057497614   0.00020772443  0              0.01704156     7.0213374e-18  0              3.3903526e-13  1.1971759e-13  0              4.3359049    
Loop time of 695.368 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3727524.683 ns/day, 0.000 hours/ns, 4314.265 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.82     | 236.44     | 293.58     | 367.4 | 34.00
Neigh   | 0.74967    | 0.76923    | 0.78884    |   1.8 |  0.11
Comm    | 22.797     | 80.452     | 136.92     | 629.6 | 11.57
Output  | 0.4018     | 0.40242    | 0.40304    |   0.1 |  0.06
Modify  | 203.2      | 272.19     | 341.69     | 417.0 | 39.14
Other   |            | 105.1      |            |       | 15.12

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1461.25 ave        2174 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5845
Ave neighs/atom = 1.1687662
Neighbor list builds = 105
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.69                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 212.206216536837
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.79
  ghost atom cutoff = 5.79
  binsize = 2.895, bins = 4397 70 70
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.51 | 36.52 | 36.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.267876e-13   3.803628e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00020661782  3.803628e-13   0              0.00061985346  7896.3337      0              3.8128569e+08  1.1971759e-13  0              4.7841494    
    200000   12727.922      200            200            0.00017103083  3.803628e-13   0              0.00051309248  6281.1489      0              3.032942e+08   1.1971759e-13  0              4.4496962    
    300000   12727.922      200            200           -0.00034025746  3.803628e-13   0             -0.0010207724   37574.003      0              1.8143142e+09  1.1971759e-13  0              4.3477093    
    400000   12727.922      200            200           -6.6045765e-05  3.803628e-13   0             -0.00019813729  1126.9801      0              54417834       1.1971759e-13  0              4.3463021    
    500000   12727.922      200            200            0.010608867   -0.00066087428  0              0.032487476    1.9263853      0              93018.253      1.1971759e-13  0              4.3393512    
    600000   12727.922      200            200            0.0064060678   0.00016672954  0              0.019051474    153.35683      0              7405052.5      1.1971759e-13  0              4.3406834    
    700000   12727.922      200            200            0.0058106682   0.00021522098  0              0.017216784    23.826543      0              1150498.5      1.1971759e-13  0              4.3408917    
    800000   12727.922      200            200            0.005718955    0.00019260831  0              0.016964257    3.1369541      0              151472.29      1.1971759e-13  0              4.3409197    
    900000   12727.922      200            200            0.0057236438   0.00020158337  0              0.016969348    0.36868868     0              17802.657      1.1971759e-13  0              4.3409182    
   1000000   12727.922      200            200            0.0057360947   0.00019957843  0              0.017008706    0.037901806    0              1830.1426      1.1971759e-13  0              4.3409132    
   1100000   12727.922      200            200            0.0057447257   0.00019798225  0              0.017036195    0.0032795064   0              158.35563      1.1971759e-13  0              4.3409098    
   1200000   12727.922      200            200            0.0057494029   0.00019776814  0              0.017050441    0.00021527401  0              10.394812      1.1971759e-13  0              4.340908     
   1300000   12727.922      200            200            0.0057515341   0.00019770305  0              0.017056899    7.6579152e-06  0              0.36977332     1.1971759e-13  0              4.3409072    
   1400000   12727.922      200            200            0.0057524216   0.00019767682  0              0.017059588    7.1712665e-12  0              3.4627479e-07  1.1971759e-13  0              4.3409069    
   1500000   12727.922      200            200            0.0057527678   0.00019766675  0              0.017060637    1.3637369e-07  0              0.0065849975   1.1971759e-13  0              4.3409068    
   1600000   12727.922      200            200            0.0057528953   0.00019766307  0              0.017061023    6.9357311e-08  0              0.0033490163   1.1971759e-13  0              4.3409068    
   1700000   12727.922      200            200            0.0057529397   0.0001976618   0              0.017061157    1.9050964e-08  0              0.00091990285  1.1971759e-13  0              4.3409067    
   1800000   12727.922      200            200            0.0057529542   0.00019766139  0              0.017061201    3.9655351e-09  0              0.0001914815   1.1971759e-13  0              4.3409067    
   1900000   12727.922      200            200            0.0057529585   0.00019766126  0              0.017061214    6.9348533e-10  0              3.3485925e-05  1.1971759e-13  0              4.3409067    
   2000000   12727.922      200            200            0.0057529597   0.00019766123  0              0.017061218    1.0624142e-10  0              5.1300177e-06  1.1971759e-13  0              4.3409067    
   2100000   12727.922      200            200            0.0057529599   0.00019766122  0              0.017061219    1.4502742e-11  0              7.0028551e-07  1.1971759e-13  0              4.3409067    
   2200000   12727.922      200            200            0.00575296     0.00019766122  0              0.017061219    1.7683951e-12  0              8.5389472e-08  1.1971759e-13  0              4.3409067    
   2300000   12727.922      200            200            0.0057529599   0.00019766123  0              0.017061219    1.9172957e-13  0              9.2579345e-09  1.1971759e-13  0              4.3409067    
   2400000   12727.922      200            200            0.0057529599   0.00019766123  0              0.017061219    1.7665282e-14  0              8.5299327e-10  1.1971759e-13  0              4.3409067    
   2500000   12727.922      200            200            0.0057529599   0.00019766123  0              0.017061219    1.235258e-15   0              5.9646187e-11  1.1971759e-13  0              4.3409067    
   2600000   12727.922      200            200            0.0057529599   0.00019766123  0              0.017061218    3.759774e-16   0              1.8154603e-11  1.1971759e-13  0              4.3409067    
   2700000   12727.922      200            200            0.0057529599   0.00019766123  0              0.017061218    6.7551373e-17  0              3.261814e-12   1.1971759e-13  0              4.3409067    
   2800000   12727.922      200            200            0.0057529599   0.00019766123  0              0.017061218    2.0889225e-17  0              1.0086659e-12  1.1971759e-13  0              4.3409067    
   2900000   12727.922      200            200            0.0057529599   0.00019766123  0              0.017061218    1.2046903e-17  0              5.8170185e-13  1.1971759e-13  0              4.3409067    
   3000000   12727.922      200            200            0.0057529599   0.00019766122  0              0.017061218    4.3005978e-18  0              2.0766048e-13  1.1971759e-13  0              4.3409067    
Loop time of 693.684 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3736573.154 ns/day, 0.000 hours/ns, 4324.737 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.53     | 236.11     | 292.3      | 363.6 | 34.04
Neigh   | 0.7632     | 0.78264    | 0.80305    |   1.8 |  0.11
Comm    | 23.359     | 79.694     | 137.13     | 626.2 | 11.49
Output  | 0.40283    | 0.40347    | 0.40412    |   0.1 |  0.06
Modify  | 199.42     | 270.26     | 341.45     | 421.9 | 38.96
Other   |            | 106.4      |            |       | 15.34

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1466.75 ave        2185 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5867
Ave neighs/atom = 1.1731654
Neighbor list builds = 107
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.7                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 213.327021708627
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.8
  ghost atom cutoff = 5.8
  binsize = 2.9, bins = 4389 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.84 | 35.85 | 35.86 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.2821638e-13  3.8464913e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00022260267  3.8464913e-13  0              0.00066780801  9085.0798      0              4.3868599e+08  1.1971759e-13  0              4.787845     
    200000   12727.922      200            200            0.00019295318  3.8464913e-13  0              0.00057885954  7887.7452      0              3.8087099e+08  1.1971759e-13  0              4.4537807    
    300000   12727.922      200            200           -0.00032222946  3.8464913e-13  0             -0.00096668837  32964.275      0              1.5917269e+09  1.1971759e-13  0              4.3548621    
    400000   12727.922      200            200           -4.1823645e-05  3.8464913e-13  0             -0.00012547094  442.47332      0              21365453       1.1971759e-13  0              4.3516417    
    500000   12727.922      200            200            0.010221436   -0.00066829298  0              0.031332601    173.74231      0              8389394.4      1.1971759e-13  0              4.3444519    
    600000   12727.922      200            200            0.0068577421   2.8068828e-05  0              0.020545158    100.67059      0              4861022.3      1.1971759e-13  0              4.3455198    
    700000   12727.922      200            200            0.0060061032   0.00015226499  0              0.017866045    19.746014      0              953464.35      1.1971759e-13  0              4.3458188    
    800000   12727.922      200            200            0.0058036305   0.00017339212  0              0.017237499    3.0364374      0              146618.7       1.1971759e-13  0              4.3458911    
    900000   12727.922      200            200            0.0057586789   0.00018881329  0              0.017087223    0.42851534     0              20691.472      1.1971759e-13  0              4.3459082    
   1000000   12727.922      200            200            0.0057509078   0.00018840177  0              0.017064321    0.055401744    0              2675.152       1.1971759e-13  0              4.3459107    
   1100000   12727.922      200            200            0.0057518386   0.00018731324  0              0.017068203    0.0065406731   0              315.8257       1.1971759e-13  0              4.3459101    
   1200000   12727.922      200            200            0.0057537538   0.00018724797  0              0.017074014    0.00069622369  0              33.61815       1.1971759e-13  0              4.3459094    
   1300000   12727.922      200            200            0.0057549558   0.00018720913  0              0.017077658    6.4970172e-05  0              3.1371771      1.1971759e-13  0              4.3459089    
   1400000   12727.922      200            200            0.0057555604   0.00018719011  0              0.017079491    5.0035565e-06  0              0.24160384     1.1971759e-13  0              4.3459087    
   1500000   12727.922      200            200            0.0057558324   0.00018718167  0              0.017080316    2.7225677e-07  0              0.013146305    1.1971759e-13  0              4.3459086    
   1600000   12727.922      200            200            0.0057559463   0.00018717817  0              0.017080661    5.4576707e-09  0              0.00026353139  1.1971759e-13  0              4.3459086    
   1700000   12727.922      200            200            0.0057559914   0.00018717679  0              0.017080797    2.9059431e-10  0              1.4031759e-05  1.1971759e-13  0              4.3459085    
   1800000   12727.922      200            200            0.0057560084   0.00018717627  0              0.017080849    4.8952907e-10  0              2.3637607e-05  1.1971759e-13  0              4.3459085    
   1900000   12727.922      200            200            0.0057560146   0.00018717608  0              0.017080868    1.8408668e-10  0              8.8888869e-06  1.1971759e-13  0              4.3459085    
   2000000   12727.922      200            200            0.0057560167   0.00018717602  0              0.017080874    4.5632533e-11  0              2.2034317e-06  1.1971759e-13  0              4.3459085    
   2100000   12727.922      200            200            0.0057560174   0.000187176    0              0.017080876    9.1262534e-12  0              4.4067411e-07  1.1971759e-13  0              4.3459085    
   2200000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    1.5862659e-12  0              7.6595102e-08  1.1971759e-13  0              4.3459085    
   2300000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    2.4705934e-13  0              1.1929612e-08  1.1971759e-13  0              4.3459085    
   2400000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    3.4991977e-14  0              1.6896373e-09  1.1971759e-13  0              4.3459085    
   2500000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    4.5574229e-15  0              2.2006164e-10  1.1971759e-13  0              4.3459085    
   2600000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    6.054521e-16   0              2.9235115e-11  1.1971759e-13  0              4.3459085    
   2700000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    3.9750051e-18  0              1.9193877e-13  1.1971759e-13  0              4.3459085    
   2800000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    3.7817044e-17  0              1.8260497e-12  1.1971759e-13  0              4.3459085    
   2900000   12727.922      200            200            0.0057560177   0.00018717599  0              0.017080877    2.1529822e-17  0              1.039598e-12   1.1971759e-13  0              4.3459085    
   3000000   12727.922      200            200            0.0057560177   0.00018717598  0              0.017080877    3.1472203e-18  0              1.51968e-13    1.1971759e-13  0              4.3459085    
Loop time of 694.701 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3731100.517 ns/day, 0.000 hours/ns, 4318.403 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.42     | 237.22     | 294.9      | 369.7 | 34.15
Neigh   | 0.75406    | 0.77408    | 0.79434    |   1.8 |  0.11
Comm    | 24.865     | 81.515     | 140.33     | 627.2 | 11.73
Output  | 0.40199    | 0.40263    | 0.40328    |   0.1 |  0.06
Modify  | 199.96     | 270.19     | 338.68     | 415.2 | 38.89
Other   |            | 104.6      |            |       | 15.06

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1472.25 ave        2196 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5889
Ave neighs/atom = 1.1775645
Neighbor list builds = 109
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.71                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 214.451766437604
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.81
  ghost atom cutoff = 5.81
  binsize = 2.905, bins = 4382 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.8 | 35.8 | 35.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.296519e-13   3.8895569e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00023870906  3.8895569e-13  0              0.00071612717  10356.533      0              5.0007991e+08  1.1971759e-13  0              4.7914947    
    200000   12727.922      200            200            0.00021512213  3.8895569e-13  0              0.00064536639  9675.0284      0              4.671725e+08   1.1971759e-13  0              4.4577686    
    300000   12727.922      200            200           -0.00030374343  3.8895569e-13  0             -0.0009112303   28662.295      0              1.3839997e+09  1.1971759e-13  0              4.3618789    
    400000   12727.922      200            200           -1.7172093e-05  3.8895569e-13  0             -5.151628e-05   72.623848      0              3506745.7      1.1971759e-13  0              4.3568263    
    500000   12727.922      200            200            0.0093076648  -0.00063677597  0              0.02855977     547.7096       0              26446936       1.1971759e-13  0              4.3497023    
    600000   12727.922      200            200            0.0071809303  -0.00014605944  0              0.02168885     42.919517      0              2072429.9      1.1971759e-13  0              4.350399     
    700000   12727.922      200            200            0.0061752999   9.8616505e-05  0              0.018427283    11.935724      0              576333.39      1.1971759e-13  0              4.3507573    
    800000   12727.922      200            200            0.0058816713   0.00015469143  0              0.017490322    2.1520428      0              103914.44      1.1971759e-13  0              4.3508651    
    900000   12727.922      200            200            0.0057936186   0.00017649497  0              0.017204361    0.35410631     0              17098.527      1.1971759e-13  0              4.3508984    
   1000000   12727.922      200            200            0.0057670339   0.00017807001  0              0.017123032    0.053918493    0              2603.5311      1.1971759e-13  0              4.3509078    
   1100000   12727.922      200            200            0.0057602308   0.0001778391   0              0.017102853    0.0076476308   0              369.27672      1.1971759e-13  0              4.3509101    
   1200000   12727.922      200            200            0.0057590206   0.00017787402  0              0.017099188    0.0010151409   0              49.017523      1.1971759e-13  0              4.3509105    
   1300000   12727.922      200            200            0.0057590418   0.00017787192  0              0.017099253    0.00012599894  0              6.0840377      1.1971759e-13  0              4.3509105    
   1400000   12727.922      200            200            0.0057592195   0.0001778657   0              0.017099793    1.4542114e-05  0              0.70218665     1.1971759e-13  0              4.3509104    
   1500000   12727.922      200            200            0.0057593447   0.00017786151  0              0.017100173    1.5419486e-06  0              0.074455181    1.1971759e-13  0              4.3509104    
   1600000   12727.922      200            200            0.005759411    0.00017785933  0              0.017100374    1.4678082e-07  0              0.0070875205   1.1971759e-13  0              4.3509103    
   1700000   12727.922      200            200            0.0057594421   0.00017785832  0              0.017100468    1.1981539e-08  0              0.00057854565  1.1971759e-13  0              4.3509103    
   1800000   12727.922      200            200            0.0057594555   0.00017785788  0              0.017100509    7.5469056e-10  0              3.6441306e-05  1.1971759e-13  0              4.3509103    
   1900000   12727.922      200            200            0.005759461    0.0001778577   0              0.017100525    2.612186e-11   0              1.2613312e-06  1.1971759e-13  0              4.3509103    
   2000000   12727.922      200            200            0.0057594632   0.00017785763  0              0.017100532    5.0918654e-18  0              2.4586796e-13  1.1971759e-13  0              4.3509103    
   2100000   12727.922      200            200            0.0057594641   0.0001778576   0              0.017100535    4.7310461e-13  0              2.2844528e-08  1.1971759e-13  0              4.3509103    
   2200000   12727.922      200            200            0.0057594644   0.00017785759  0              0.017100535    2.4676173e-13  0              1.1915241e-08  1.1971759e-13  0              4.3509103    
   2300000   12727.922      200            200            0.0057594645   0.00017785759  0              0.017100536    7.16665e-14    0              3.4605188e-09  1.1971759e-13  0              4.3509103    
   2400000   12727.922      200            200            0.0057594645   0.00017785759  0              0.017100536    1.5700802e-14  0              7.5813553e-10  1.1971759e-13  0              4.3509103    
   2500000   12727.922      200            200            0.0057594645   0.00017785759  0              0.017100536    3.004427e-15   0              1.4507303e-10  1.1971759e-13  0              4.3509103    
   2600000   12727.922      200            200            0.0057594645   0.00017785759  0              0.017100536    1.3246135e-16  0              6.3960847e-12  1.1971759e-13  0              4.3509103    
   2700000   12727.922      200            200            0.0057594645   0.00017785759  0              0.017100536    2.6573036e-17  0              1.2831168e-12  1.1971759e-13  0              4.3509103    
   2800000   12727.922      200            200            0.0057594645   0.00017785759  0              0.017100536    4.6602436e-17  0              2.2502648e-12  1.1971759e-13  0              4.3509103    
   2900000   12727.922      200            200            0.0057594645   0.00017785759  0              0.017100536    2.2866984e-17  0              1.1041648e-12  1.1971759e-13  0              4.3509103    
   3000000   12727.922      200            200            0.0057594645   0.00017785758  0              0.017100536    2.2225985e-18  0              1.0732133e-13  1.1971759e-13  0              4.3509103    
Loop time of 695.47 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3726976.676 ns/day, 0.000 hours/ns, 4313.630 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.87     | 237.2      | 295.11     | 370.3 | 34.11
Neigh   | 0.76259    | 0.7817     | 0.80154    |   1.8 |  0.11
Comm    | 22.661     | 81.088     | 138.9      | 633.0 | 11.66
Output  | 0.40623    | 0.40687    | 0.4075     |   0.1 |  0.06
Modify  | 201.44     | 270.55     | 340.36     | 419.6 | 38.90
Other   |            | 105.4      |            |       | 15.16

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1478.25 ave        2208 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5913
Ave neighs/atom = 1.1823635
Neighbor list builds = 111
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.72                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 215.580457635273
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.82
  ghost atom cutoff = 5.82
  binsize = 2.91, bins = 4374 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.76 | 35.76 | 35.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.3109415e-13  3.9328246e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00025493644  3.9328246e-13  0              0.00076480933  11710.581      0              5.6546203e+08  1.1971759e-13  0              4.7950983    
    200000   12727.922      200            200            0.00023753562  3.9328246e-13  0              0.00071260685  11642.403      0              5.6216996e+08  1.1971759e-13  0              4.4616595    
    300000   12727.922      200            200           -0.00028480353  3.9328246e-13  0             -0.00085441058  24666.708      0              1.1910671e+09  1.1971759e-13  0              4.3687591    
    400000   12727.922      200            200            7.903958e-06   3.9328246e-13  0              2.3711874e-05  15.751339      0              760575.79      1.1971759e-13  0              4.3618555    
    500000   12727.922      200            200            0.0080462545  -0.00053984201  0              0.024678605    958.45788      0              46280501       1.1971759e-13  0              4.3550742    
    600000   12727.922      200            200            0.0073676293  -0.0002114167   0              0.022314304    5.3407041      0              257883.49      1.1971759e-13  0              4.355335     
    700000   12727.922      200            200            0.0063020411   7.9704739e-05  0              0.018826419    4.1246772      0              199165.9       1.1971759e-13  0              4.3557149    
    800000   12727.922      200            200            0.0059440291   0.0001435493   0              0.017688538    0.96424823     0              46560.096      1.1971759e-13  0              4.3558456    
    900000   12727.922      200            200            0.0058222052   0.00016195515  0              0.01730466     0.19177428     0              9260.0938      1.1971759e-13  0              4.3558905    
   1000000   12727.922      200            200            0.005781069    0.00016564474  0              0.017177562    0.034504433    0              1666.0956      1.1971759e-13  0              4.3559054    
   1100000   12727.922      200            200            0.0057677733   0.00016631494  0              0.017137005    0.0057262262   0              276.49897      1.1971759e-13  0              4.3559102    
   1200000   12727.922      200            200            0.0057637036   0.00016644211  0              0.017124669    0.00089116418  0              43.031129      1.1971759e-13  0              4.3559116    
   1300000   12727.922      200            200            0.0057625522   0.00016647891  0              0.017121178    0.00013123214  0              6.3367303      1.1971759e-13  0              4.355912     
   1400000   12727.922      200            200            0.0057622647   0.000166488    0              0.017120306    1.8376012e-05  0              0.88731188     1.1971759e-13  0              4.3559121    
   1500000   12727.922      200            200            0.005762211    0.0001664896   0              0.017120143    2.4519343e-06  0              0.11839513     1.1971759e-13  0              4.3559121    
   1600000   12727.922      200            200            0.0057622107   0.00016648954  0              0.017120143    3.1167221e-07  0              0.015049535    1.1971759e-13  0              4.3559121    
   1700000   12727.922      200            200            0.0057622177   0.00016648928  0              0.017120164    3.7638993e-08  0              0.0018174523   1.1971759e-13  0              4.3559121    
   1800000   12727.922      200            200            0.0057622228   0.0001664891   0              0.017120179    4.2936098e-09  0              0.00020732305  1.1971759e-13  0              4.3559121    
   1900000   12727.922      200            200            0.0057622256   0.00016648901  0              0.017120188    4.5798346e-10  0              2.2114382e-05  1.1971759e-13  0              4.3559121    
   2000000   12727.922      200            200            0.0057622269   0.00016648896  0              0.017120192    4.4892923e-11  0              2.1677186e-06  1.1971759e-13  0              4.3559121    
   2100000   12727.922      200            200            0.0057622275   0.00016648894  0              0.017120193    3.9091296e-12  0              1.8875788e-07  1.1971759e-13  0              4.3559121    
   2200000   12727.922      200            200            0.0057622277   0.00016648893  0              0.017120194    2.8466277e-13  0              1.3745347e-08  1.1971759e-13  0              4.3559121    
   2300000   12727.922      200            200            0.0057622278   0.00016648893  0              0.017120195    1.3747767e-14  0              6.6383045e-10  1.1971759e-13  0              4.3559121    
   2400000   12727.922      200            200            0.0057622279   0.00016648893  0              0.017120195    1.7019795e-16  0              8.2182497e-12  1.1971759e-13  0              4.3559121    
   2500000   12727.922      200            200            0.0057622279   0.00016648893  0              0.017120195    5.8658265e-17  0              2.8323977e-12  1.1971759e-13  0              4.3559121    
   2600000   12727.922      200            200            0.0057622279   0.00016648893  0              0.017120195    8.6491524e-17  0              4.1763661e-12  1.1971759e-13  0              4.3559121    
   2700000   12727.922      200            200            0.0057622279   0.00016648893  0              0.017120195    9.1270292e-17  0              4.4071158e-12  1.1971759e-13  0              4.3559121    
   2800000   12727.922      200            200            0.0057622279   0.00016648893  0              0.017120195    1.0042662e-17  0              4.8492419e-13  1.1971759e-13  0              4.3559121    
   2900000   12727.922      200            200            0.0057622279   0.00016648893  0              0.017120195    3.1545688e-18  0              1.5232284e-13  1.1971759e-13  0              4.3559121    
   3000000   12727.922      200            200            0.0057622279   0.00016648893  0              0.017120195    5.9697013e-18  0              2.8825551e-13  1.1971759e-13  0              4.3559121    
Loop time of 699.197 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3707107.435 ns/day, 0.000 hours/ns, 4290.634 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.69     | 238.66     | 299.04     | 379.3 | 34.13
Neigh   | 0.80824    | 0.82856    | 0.84995    |   1.8 |  0.12
Comm    | 24.633     | 83.435     | 144.12     | 634.8 | 11.93
Output  | 0.40086    | 0.40148    | 0.40211    |   0.1 |  0.06
Modify  | 200.24     | 271        | 339.21     | 412.9 | 38.76
Other   |            | 104.9      |            |       | 15.00

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1482.75 ave        2217 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5931
Ave neighs/atom = 1.1859628
Neighbor list builds = 117
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.73                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 216.713102213138
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.83
  ghost atom cutoff = 5.83
  binsize = 2.915, bins = 4367 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.71 | 35.73 | 35.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.3254314e-13  3.9762943e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00027128427  3.9762943e-13  0              0.0008138528   13147.11       0              6.3482689e+08  1.1971759e-13  0              4.7986556    
    200000   12727.922      200            200            0.00026019147  3.9762943e-13  0              0.00078057441  13789.265      0              6.6583427e+08  1.1971759e-13  0              4.4654531    
    300000   12727.922      200            200           -0.00026541396  3.9762943e-13  0             -0.00079624189  20976.18       0              1.0128647e+09  1.1971759e-13  0              4.3755022    
    400000   12727.922      200            200            3.3399448e-05  3.9762943e-13  0              0.00010019834  270.18208      0              13046126       1.1971759e-13  0              4.3667286    
    500000   12727.922      200            200            0.0067575739  -5.7391597e-05  0              0.020330113    1240.1419      0              59882012       1.1971759e-13  0              4.3605272    
    600000   12727.922      200            200            0.0073658721  -0.00022610299  0              0.022323719    4.8201928      0              232749.86      1.1971759e-13  0              4.3603359    
    700000   12727.922      200            200            0.0063552788   5.7575494e-05  0              0.019008261    0.12227534     0              5904.2388      1.1971759e-13  0              4.3606975    
    800000   12727.922      200            200            0.0059782309   0.00012963512  0              0.017805058    0.12693959     0              6129.4584      1.1971759e-13  0              4.3608357    
    900000   12727.922      200            200            0.005840076    0.00014563672  0              0.017374591    0.043594515    0              2105.0231      1.1971759e-13  0              4.3608862    
   1000000   12727.922      200            200            0.0057908453   0.0001511775   0              0.017221358    0.010955644    0              529.00886      1.1971759e-13  0              4.3609043    
   1100000   12727.922      200            200            0.0057733786   0.00015252255  0              0.017167613    0.0023081392   0              111.45178      1.1971759e-13  0              4.3609106    
   1200000   12727.922      200            200            0.0057672707   0.00015271994  0              0.017149092    0.00043514427  0              21.011559      1.1971759e-13  0              4.3609128    
   1300000   12727.922      200            200            0.0057652105   0.00015278954  0              0.017142842    7.5869952e-05  0              3.6634885      1.1971759e-13  0              4.3609136    
   1400000   12727.922      200            200            0.0057645327   0.00015281272  0              0.017140785    1.2459488e-05  0              0.60162407     1.1971759e-13  0              4.3609138    
   1500000   12727.922      200            200            0.0057643165   0.00015282011  0              0.01714013     1.9486582e-06  0              0.094093732    1.1971759e-13  0              4.3609139    
   1600000   12727.922      200            200            0.0057642505   0.00015282236  0              0.017139929    2.9229401e-07  0              0.014113832    1.1971759e-13  0              4.3609139    
   1700000   12727.922      200            200            0.0057642314   0.000152823    0              0.017139871    4.2236665e-08  0              0.0020394574   1.1971759e-13  0              4.3609139    
   1800000   12727.922      200            200            0.0057642265   0.00015282316  0              0.017139856    5.8955235e-09  0              0.00028467373  1.1971759e-13  0              4.3609139    
   1900000   12727.922      200            200            0.0057642254   0.0001528232   0              0.017139853    7.9599147e-10  0              3.8435579e-05  1.1971759e-13  0              4.3609139    
   2000000   12727.922      200            200            0.0057642253   0.0001528232   0              0.017139853    1.0395776e-10  0              5.0197479e-06  1.1971759e-13  0              4.3609139    
   2100000   12727.922      200            200            0.0057642254   0.0001528232   0              0.017139853    1.3122203e-11  0              6.3362422e-07  1.1971759e-13  0              4.3609139    
   2200000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    1.5957928e-12  0              7.7055125e-08  1.1971759e-13  0              4.3609139    
   2300000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    1.8673512e-13  0              9.0167704e-09  1.1971759e-13  0              4.3609139    
   2400000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    2.0643045e-14  0              9.9677876e-10  1.1971759e-13  0              4.3609139    
   2500000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    2.158491e-15   0              1.0422581e-10  1.1971759e-13  0              4.3609139    
   2600000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    5.630384e-16   0              2.7187109e-11  1.1971759e-13  0              4.3609139    
   2700000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    1.8151919e-17  0              8.764912e-13   1.1971759e-13  0              4.3609139    
   2800000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    3.3507977e-17  0              1.6179803e-12  1.1971759e-13  0              4.3609139    
   2900000   12727.922      200            200            0.0057642255   0.00015282319  0              0.017139853    9.9238951e-18  0              4.7918938e-13  1.1971759e-13  0              4.3609139    
   3000000   12727.922      200            200            0.0057642255   0.0001528232   0              0.017139853    3.7105069e-18  0              1.791671e-13   1.1971759e-13  0              4.3609139    
Loop time of 689.986 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3756596.660 ns/day, 0.000 hours/ns, 4347.913 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.48     | 234.55     | 290.62     | 359.8 | 33.99
Neigh   | 0.77233    | 0.79304    | 0.81413    |   1.8 |  0.11
Comm    | 24.553     | 79.514     | 136.87     | 614.6 | 11.52
Output  | 0.40411    | 0.40475    | 0.40543    |   0.1 |  0.06
Modify  | 199.57     | 270.19     | 338.92     | 415.9 | 39.16
Other   |            | 104.5      |            |       | 15.15

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1430.25 ave        2112 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5721
Ave neighs/atom = 1.1439712
Neighbor list builds = 112
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.74                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 217.849707082701
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.84
  ghost atom cutoff = 5.84
  binsize = 2.92, bins = 4359 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.67 | 35.68 | 35.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.3399886e-13  4.0199657e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00028775195  4.0199657e-13  0              0.00086325585  14666.006      0              7.0816896e+08  1.1971759e-13  0              4.8021666    
    200000   12727.922      200            200            0.00028308749  4.0199657e-13  0              0.00084926248  16115.01       0              7.7813616e+08  1.1971759e-13  0              4.4691489    
    300000   12727.922      200            200           -0.000245579    4.0199657e-13  0             -0.00073673701  17589.383      0              8.4932835e+08  1.1971759e-13  0              4.3821078    
    400000   12727.922      200            200            5.9309312e-05  4.0199657e-13  0              0.00017792793  834.24438      0              40282675       1.1971759e-13  0              4.3714451    
    500000   12727.922      200            200            0.0054686176   0.00029214275  0              0.01611371     1298.8581      0              62717208       1.1971759e-13  0              4.3660157    
    600000   12727.922      200            200            0.0071643435  -0.00022136693  0              0.021714397    41.343837      0              1996345.9      1.1971759e-13  0              4.3654018    
    700000   12727.922      200            200            0.0063305024   4.3511622e-05  0              0.018947996    1.8845814      0              90999.69       1.1971759e-13  0              4.3657074    
    800000   12727.922      200            200            0.0059793908   0.00011340093  0              0.017824771    0.10211937     0              4930.979       1.1971759e-13  0              4.3658372    
    900000   12727.922      200            200            0.0058451851   0.0001300632   0              0.017405492    0.0029607541   0              142.96422      1.1971759e-13  0              4.3658865    
   1000000   12727.922      200            200            0.005795223    0.00013584871  0              0.01724982     1.6827355e-05  0              0.81253274     1.1971759e-13  0              4.365905     
   1100000   12727.922      200            200            0.0057765912   0.00013740957  0              0.017192364    0.00010779413  0              5.2049927      1.1971759e-13  0              4.3659118    
   1200000   12727.922      200            200            0.0057696625   0.00013764617  0              0.017171341    4.9119907e-05  0              2.3718245      1.1971759e-13  0              4.3659143    
   1300000   12727.922      200            200            0.0057671539   0.00013773607  0              0.017163726    1.37942e-05    0              0.66607255     1.1971759e-13  0              4.3659152    
   1400000   12727.922      200            200            0.0057662549   0.00013776883  0              0.017160996    3.1195991e-06  0              0.15063428     1.1971759e-13  0              4.3659155    
   1500000   12727.922      200            200            0.0057659362   0.00013778049  0              0.017160028    6.2225028e-07  0              0.030046239    1.1971759e-13  0              4.3659156    
   1600000   12727.922      200            200            0.0057658246   0.00013778458  0              0.017159689    1.1416544e-07  0              0.0055126403   1.1971759e-13  0              4.3659157    
   1700000   12727.922      200            200            0.0057657859   0.00013778599  0              0.017159572    1.9711542e-08  0              0.00095179982  1.1971759e-13  0              4.3659157    
   1800000   12727.922      200            200            0.0057657728   0.00013778647  0              0.017159532    3.2469803e-09  0              0.00015678506  1.1971759e-13  0              4.3659157    
   1900000   12727.922      200            200            0.0057657684   0.00013778663  0              0.017159519    5.1474208e-10  0              2.4855053e-05  1.1971759e-13  0              4.3659157    
   2000000   12727.922      200            200            0.0057657669   0.00013778668  0              0.017159514    7.8991818e-11  0              3.8142322e-06  1.1971759e-13  0              4.3659157    
   2100000   12727.922      200            200            0.0057657665   0.0001377867   0              0.017159513    1.1793649e-11  0              5.6947311e-07  1.1971759e-13  0              4.3659157    
   2200000   12727.922      200            200            0.0057657663   0.0001377867   0              0.017159512    1.7151323e-12  0              8.2817599e-08  1.1971759e-13  0              4.3659157    
   2300000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    2.4324969e-13  0              1.1745657e-08  1.1971759e-13  0              4.3659157    
   2400000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    3.3882644e-14  0              1.6360716e-09  1.1971759e-13  0              4.3659157    
   2500000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    4.6307696e-15  0              2.2360329e-10  1.1971759e-13  0              4.3659157    
   2600000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    4.4432767e-16  0              2.1454993e-11  1.1971759e-13  0              4.3659157    
   2700000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    2.2646164e-18  0              1.0935022e-13  1.1971759e-13  0              4.3659157    
   2800000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    4.2434825e-17  0              2.0490258e-12  1.1971759e-13  0              4.3659157    
   2900000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    2.7651349e-17  0              1.3351847e-12  1.1971759e-13  0              4.3659157    
   3000000   12727.922      200            200            0.0057657663   0.00013778671  0              0.017159512    2.8484656e-18  0              1.3754221e-13  1.1971759e-13  0              4.3659157    
Loop time of 691.423 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3748787.955 ns/day, 0.000 hours/ns, 4338.875 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.96     | 234.97     | 290.51     | 359.8 | 33.98
Neigh   | 0.76971    | 0.78973    | 0.81074    |   1.8 |  0.11
Comm    | 23.717     | 79.116     | 134.45     | 619.8 | 11.44
Output  | 0.4024     | 0.40306    | 0.40373    |   0.1 |  0.06
Modify  | 200.83     | 271.02     | 340.15     | 419.1 | 39.20
Other   |            | 105.1      |            |       | 15.20

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1437.25 ave        2126 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5749
Ave neighs/atom = 1.1495701
Neighbor list builds = 110
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.75                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 218.990279155467
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.85
  ghost atom cutoff = 5.85
  binsize = 2.925, bins = 4352 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.63 | 35.64 | 35.65 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.3546129e-13  4.0638387e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00030433893  4.0638387e-13  0              0.0009130168   16267.158      0              7.8548286e+08  1.1971759e-13  0              4.8056309    
    200000   12727.922      200            200            0.00030622157  4.0638387e-13  0              0.00091866471  18619.039      0              8.9904677e+08  1.1971759e-13  0              4.4727468    
    300000   12727.922      200            200           -0.00022530287  4.0638387e-13  0             -0.0006759086   14504.981      0              7.0039364e+08  1.1971759e-13  0              4.3885752    
    400000   12727.922      200            200            8.5628515e-05  4.0638387e-13  0              0.00025688555  1706.2697      0              82389655       1.1971759e-13  0              4.3760046    
    500000   12727.922      200            200            0.004235786    0.00025043614  0              0.012456922    1136.3222      0              54868932       1.1971759e-13  0              4.3714947    
    600000   12727.922      200            200            0.0067912312  -0.0002072955   0              0.020580989    97.864358      0              4725519.6      1.1971759e-13  0              4.3705254    
    700000   12727.922      200            200            0.006230459    3.5231937e-05  0              0.018656145    8.485137       0              409716.9       1.1971759e-13  0              4.3707438    
    800000   12727.922      200            200            0.0059490791   9.9957958e-05  0              0.017747279    0.8967312      0              43299.941      1.1971759e-13  0              4.3708499    
    900000   12727.922      200            200            0.0058372715   0.00011651605  0              0.017395298    0.094745757    0              4574.9335      1.1971759e-13  0              4.3708917    
   1000000   12727.922      200            200            0.0057944179   0.00012206293  0              0.017261191    0.0094203568   0              454.87532      1.1971759e-13  0              4.3709077    
   1100000   12727.922      200            200            0.0057778914   0.00012351471  0              0.017210159    0.00086325275  0              41.683386      1.1971759e-13  0              4.3709138    
   1200000   12727.922      200            200            0.0057715164   0.00012374555  0              0.017190804    7.1388953e-05  0              3.447117       1.1971759e-13  0              4.3709161    
   1300000   12727.922      200            200            0.0057691156   0.00012383619  0              0.017183511    4.9762522e-06  0              0.24028541     1.1971759e-13  0              4.370917     
   1400000   12727.922      200            200            0.0057682169   0.00012387063  0              0.01718078     2.4603199e-07  0              0.011880004    1.1971759e-13  0              4.3709173    
   1500000   12727.922      200            200            0.0057678825   0.00012388351  0              0.017179764    3.9767827e-09  0              0.00019202461  1.1971759e-13  0              4.3709174    
   1600000   12727.922      200            200            0.0057677588   0.00012388828  0              0.017179388    4.1912336e-10  0              2.0237967e-05  1.1971759e-13  0              4.3709175    
   1700000   12727.922      200            200            0.0057677134   0.00012389003  0              0.01717925     5.4801928e-10  0              2.646189e-05   1.1971759e-13  0              4.3709175    
   1800000   12727.922      200            200            0.0057676967   0.00012389067  0              0.0171792      2.0595905e-10  0              9.9450254e-06  1.1971759e-13  0              4.3709175    
   1900000   12727.922      200            200            0.0057676907   0.0001238909   0              0.017179181    5.3887989e-11  0              2.6020581e-06  1.1971759e-13  0              4.3709175    
   2000000   12727.922      200            200            0.0057676885   0.00012389098  0              0.017179174    1.1811423e-11  0              5.7033133e-07  1.1971759e-13  0              4.3709175    
   2100000   12727.922      200            200            0.0057676877   0.00012389101  0              0.017179172    2.3256983e-12  0              1.1229965e-07  1.1971759e-13  0              4.3709175    
   2200000   12727.922      200            200            0.0057676874   0.00012389103  0              0.017179171    4.2741994e-13  0              2.0638579e-08  1.1971759e-13  0              4.3709175    
   2300000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    7.3596605e-14  0              3.5537167e-09  1.1971759e-13  0              4.3709175    
   2400000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    1.1926682e-14  0              5.7589679e-10  1.1971759e-13  0              4.3709175    
   2500000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    2.1511537e-15  0              1.0387151e-10  1.1971759e-13  0              4.3709175    
   2600000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    2.1508506e-17  0              1.0385688e-12  1.1971759e-13  0              4.3709175    
   2700000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    5.2143402e-17  0              2.5178183e-12  1.1971759e-13  0              4.3709175    
   2800000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    3.2322066e-17  0              1.5607169e-12  1.1971759e-13  0              4.3709175    
   2900000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    5.6033449e-17  0              2.7056547e-12  1.1971759e-13  0              4.3709175    
   3000000   12727.922      200            200            0.0057676873   0.00012389103  0              0.017179171    3.6571409e-18  0              1.7659024e-13  1.1971759e-13  0              4.3709175    
Loop time of 692.625 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3742284.269 ns/day, 0.000 hours/ns, 4331.348 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.35     | 235.73     | 291.96     | 365.5 | 34.03
Neigh   | 0.73665    | 0.75651    | 0.77728    |   1.8 |  0.11
Comm    | 23.809     | 80.37      | 136.4      | 624.6 | 11.60
Output  | 0.40285    | 0.4035     | 0.40414    |   0.1 |  0.06
Modify  | 201.46     | 270.77     | 339.27     | 416.1 | 39.09
Other   |            | 104.6      |            |       | 15.10

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1443.75 ave        2139 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5775
Ave neighs/atom = 1.154769
Neighbor list builds = 106
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.76                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 220.13482534294
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.86
  ghost atom cutoff = 5.86
  binsize = 2.93, bins = 4345 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.61 | 35.62 | 35.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.3693044e-13  4.1079132e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00032104466  4.1079132e-13  0              0.00096313397  17950.455      0              8.6676323e+08  1.1971759e-13  0              4.8090485    
    200000   12727.922      200            200            0.00032959156  4.1079132e-13  0              0.00098877467  21300.755      0              1.0285372e+09  1.1971759e-13  0              4.4762462    
    300000   12727.922      200            200           -0.00020458973  4.1079132e-13  0             -0.00061376919  11721.636      0              5.6599584e+08  1.1971759e-13  0              4.3949041    
    400000   12727.922      200            200            0.00011235209  4.1079132e-13  0              0.00033705628  2884.5961      0              1.3928682e+08  1.1971759e-13  0              4.3804063    
    500000   12727.922      200            200            0.0032283812   0.00010041053  0              0.0095847332   827.30269      0              39947486       1.1971759e-13  0              4.3769246    
    600000   12727.922      200            200            0.0063514168  -3.8758226e-05  0              0.019093009    148.8019       0              7185111.4      1.1971759e-13  0              4.3756923    
    700000   12727.922      200            200            0.006072148    3.9438551e-05  0              0.018177005    16.584573      0              800809.67      1.1971759e-13  0              4.3758021    
    800000   12727.922      200            200            0.0058922535   8.9645254e-05  0              0.017587115    2.057058       0              99327.97       1.1971759e-13  0              4.3758725    
    900000   12727.922      200            200            0.0058183456   0.00010606774  0              0.017348969    0.259078       0              12509.949      1.1971759e-13  0              4.3759011    
   1000000   12727.922      200            200            0.0057894025   0.00011127714  0              0.01725693     0.032261788    0              1557.8063      1.1971759e-13  0              4.3759122    
   1100000   12727.922      200            200            0.005777937    0.00011246042  0              0.01722135     0.0039490681   0              190.68636      1.1971759e-13  0              4.3759165    
   1200000   12727.922      200            200            0.0057733839   0.00011263901  0              0.017207513    0.00047874264  0              23.116769      1.1971759e-13  0              4.3759182    
   1300000   12727.922      200            200            0.0057716235   0.00011270996  0              0.017202161    5.7429276e-05  0              2.7730542      1.1971759e-13  0              4.3759189    
   1400000   12727.922      200            200            0.0057709464   0.00011273752  0              0.017200102    6.8074119e-06  0              0.32870556     1.1971759e-13  0              4.3759191    
   1500000   12727.922      200            200            0.0057706871   0.0001127481   0              0.017199313    7.9605435e-07  0              0.038438615    1.1971759e-13  0              4.3759192    
   1600000   12727.922      200            200            0.0057705883   0.00011275214  0              0.017199013    9.1650922e-08  0              0.004425495    1.1971759e-13  0              4.3759192    
   1700000   12727.922      200            200            0.0057705508   0.00011275367  0              0.017198899    1.0361764e-08  0              0.00050033252  1.1971759e-13  0              4.3759193    
   1800000   12727.922      200            200            0.0057705366   0.00011275425  0              0.017198856    1.1464276e-09  0              5.5356886e-05  1.1971759e-13  0              4.3759193    
   1900000   12727.922      200            200            0.0057705312   0.00011275447  0              0.017198839    1.2363252e-10  0              5.969772e-06   1.1971759e-13  0              4.3759193    
   2000000   12727.922      200            200            0.0057705292   0.00011275455  0              0.017198833    1.2901625e-11  0              6.2297328e-07  1.1971759e-13  0              4.3759193    
   2100000   12727.922      200            200            0.0057705285   0.00011275458  0              0.017198831    1.2881174e-12  0              6.219858e-08   1.1971759e-13  0              4.3759193    
   2200000   12727.922      200            200            0.0057705282   0.00011275459  0              0.01719883     1.2227648e-13  0              5.9042936e-09  1.1971759e-13  0              4.3759193    
   2300000   12727.922      200            200            0.0057705281   0.00011275459  0              0.01719883     1.1087445e-14  0              5.3537302e-10  1.1971759e-13  0              4.3759193    
   2400000   12727.922      200            200            0.005770528    0.0001127546   0              0.01719883     9.8411228e-16  0              4.751926e-11   1.1971759e-13  0              4.3759193    
   2500000   12727.922      200            200            0.005770528    0.0001127546   0              0.017198829    5.480083e-17   0              2.6461359e-12  1.1971759e-13  0              4.3759193    
   2600000   12727.922      200            200            0.005770528    0.0001127546   0              0.017198829    2.4937237e-16  0              1.2041299e-11  1.1971759e-13  0              4.3759193    
   2700000   12727.922      200            200            0.005770528    0.0001127546   0              0.017198829    6.1582405e-17  0              2.9735939e-12  1.1971759e-13  0              4.3759193    
   2800000   12727.922      200            200            0.005770528    0.0001127546   0              0.017198829    1.370153e-17   0              6.6159787e-13  1.1971759e-13  0              4.3759193    
   2900000   12727.922      200            200            0.005770528    0.0001127546   0              0.017198829    5.349762e-17   0              2.5832086e-12  1.1971759e-13  0              4.3759193    
   3000000   12727.922      200            200            0.005770528    0.0001127546   0              0.017198829    2.9948182e-18  0              1.4460905e-13  1.1971759e-13  0              4.3759193    
Loop time of 693.944 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3735171.488 ns/day, 0.000 hours/ns, 4323.115 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.57     | 235.2      | 290.76     | 360.8 | 33.89
Neigh   | 0.70717    | 0.72457    | 0.74339    |   1.7 |  0.10
Comm    | 23.292     | 79.095     | 135.5      | 622.2 | 11.40
Output  | 0.40305    | 0.40369    | 0.40434    |   0.1 |  0.06
Modify  | 201.64     | 272.2      | 343.2      | 420.0 | 39.22
Other   |            | 106.3      |            |       | 15.32

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1449.75 ave        2151 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5799
Ave neighs/atom = 1.1595681
Neighbor list builds = 102
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.77                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 221.283352556625
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.87
  ghost atom cutoff = 5.87
  binsize = 2.935, bins = 4337 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.57 | 35.58 | 35.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.3840629e-13  4.1521888e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00033786857  4.1521888e-13  0              0.0010136057   19715.786      0              9.5200474e+08  1.1971759e-13  0              4.8124193    
    200000   12727.922      200            200            0.00035319531  4.1521888e-13  0              0.0010595859   24159.56       0              1.1665787e+09  1.1971759e-13  0              4.4796468    
    300000   12727.922      200            200           -0.00018344382  4.1521888e-13  0             -0.00055033146  9238.0171      0              4.4607079e+08  1.1971759e-13  0              4.4010939    
    400000   12727.922      200            200            0.00017994507 -3.1125322e-06  0              0.00054294773  4365.8394      0              2.1081076e+08  1.1971759e-13  0              4.3846499    
    500000   12727.922      200            200            0.0025591846   0.00013020111  0              0.0075473526   477.21732      0              23043116       1.1971759e-13  0              4.3822738    
    600000   12727.922      200            200            0.0058594578   0.00012360068  0              0.017454773    172.28371      0              8318963.6      1.1971759e-13  0              4.3808838    
    700000   12727.922      200            200            0.0058868683   8.0231363e-05  0              0.017580374    22.15235       0              1069657.7      1.1971759e-13  0              4.3808751    
    800000   12727.922      200            200            0.0058203917   8.9840664e-05  0              0.017371334    2.926615       0              141315.76      1.1971759e-13  0              4.3809018    
    900000   12727.922      200            200            0.0057914881   9.6821191e-05  0              0.017277643    0.38979562     0              18821.835      1.1971759e-13  0              4.3809136    
   1000000   12727.922      200            200            0.0057811034   0.00010177804  0              0.017241532    0.051835439    0              2502.9479      1.1971759e-13  0              4.3809181    
   1100000   12727.922      200            200            0.0057767647   0.00010263339  0              0.017227661    0.0068610677   0              331.2964       1.1971759e-13  0              4.3809199    
   1200000   12727.922      200            200            0.0057749502   0.00010271268  0              0.017222138    0.00090592106  0              43.743686      1.1971759e-13  0              4.3809206    
   1300000   12727.922      200            200            0.0057742248   0.00010274457  0              0.01721993     0.00011945982  0              5.7682871      1.1971759e-13  0              4.3809209    
   1400000   12727.922      200            200            0.0057739371   0.00010275722  0              0.017219054    1.573099e-05   0              0.75959321     1.1971759e-13  0              4.380921     
   1500000   12727.922      200            200            0.0057738238   0.00010276219  0              0.017218709    2.0685916e-06  0              0.099884885    1.1971759e-13  0              4.380921     
   1600000   12727.922      200            200            0.0057737794   0.00010276413  0              0.017218574    2.7162004e-07  0              0.01311556     1.1971759e-13  0              4.380921     
   1700000   12727.922      200            200            0.0057737621   0.00010276489  0              0.017218521    3.5612645e-08  0              0.0017196072   1.1971759e-13  0              4.380921     
   1800000   12727.922      200            200            0.0057737554   0.00010276518  0              0.017218501    4.6620915e-09  0              0.00022511571  1.1971759e-13  0              4.380921     
   1900000   12727.922      200            200            0.0057737528   0.00010276529  0              0.017218493    6.0938795e-10  0              2.9425163e-05  1.1971759e-13  0              4.380921     
   2000000   12727.922      200            200            0.0057737518   0.00010276534  0              0.01721849     7.9512525e-11  0              3.8393753e-06  1.1971759e-13  0              4.380921     
   2100000   12727.922      200            200            0.0057737514   0.00010276535  0              0.017218489    1.0358124e-11  0              5.0015674e-07  1.1971759e-13  0              4.380921     
   2200000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    1.3466766e-12  0              6.5026196e-08  1.1971759e-13  0              4.380921     
   2300000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    1.7410759e-13  0              8.4070322e-09  1.1971759e-13  0              4.380921     
   2400000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    2.2408493e-14  0              1.0820259e-09  1.1971759e-13  0              4.380921     
   2500000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    2.8800042e-15  0              1.390651e-10   1.1971759e-13  0              4.380921     
   2600000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    6.2336618e-16  0              3.0100122e-11  1.1971759e-13  0              4.380921     
   2700000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    2.6259773e-18  0              1.2679905e-13  1.1971759e-13  0              4.380921     
   2800000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    1.0007892e-18  0              4.832453e-14   1.1971759e-13  0              4.380921     
   2900000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    2.4583987e-18  0              1.1870727e-13  1.1971759e-13  0              4.380921     
   3000000   12727.922      200            200            0.0057737512   0.00010276536  0              0.017218488    8.7426214e-18  0              4.221499e-13   1.1971759e-13  0              4.380921     
Loop time of 697.727 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3714919.587 ns/day, 0.000 hours/ns, 4299.675 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.44     | 236.28     | 292.98     | 366.9 | 33.86
Neigh   | 0.71109    | 0.72973    | 0.74959    |   1.8 |  0.10
Comm    | 22.834     | 80.125     | 137.03     | 629.6 | 11.48
Output  | 0.40234    | 0.40302    | 0.40368    |   0.1 |  0.06
Modify  | 203.51     | 274.05     | 344.54     | 422.1 | 39.28
Other   |            | 106.1      |            |       | 15.21

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1455.75 ave        2162 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5823
Ave neighs/atom = 1.1643671
Neighbor list builds = 104
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.78                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 222.435867708023
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.88
  ghost atom cutoff = 5.88
  binsize = 2.94, bins = 4330 69 69
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.53 | 35.53 | 35.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.3988885e-13  4.1966655e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00035481011  4.1966655e-13  0              0.0010644303   21563.043      0              1.0412022e+09  1.1971759e-13  0              4.8157429    
    200000   12727.922      200            200            0.00037703071  4.1966655e-13  0              0.0011310921   27194.863      0              1.3131426e+09  1.1971759e-13  0              4.4829482    
    300000   12727.922      200            200           -0.00016186932  4.1966655e-13  0             -0.00048560795  7052.7934      0              3.4055415e+08  1.1971759e-13  0              4.4071441    
    400000   12727.922      200            200            0.0007131378  -1.0462493e-05  0              0.0021498759   6068.624       0              2.9303214e+08  1.1971759e-13  0              4.3887371    
    500000   12727.922      200            200            0.002167374    0.00021288019  0              0.0062892419   184.88931      0              8927643        1.1971759e-13  0              4.3875193    
    600000   12727.922      200            200            0.0053170546   8.606125e-05   0              0.015865102    159.47918      0              7700678.6      1.1971759e-13  0              4.3860789    
    700000   12727.922      200            200            0.0056817191   9.62852e-05    0              0.016948872    22.492267      0              1086071.1      1.1971759e-13  0              4.3859537    
    800000   12727.922      200            200            0.005745296    0.00010084106  0              0.017135047    3.0181229      0              145734.35      1.1971759e-13  0              4.3859337    
    900000   12727.922      200            200            0.0057639406   9.5128107e-05  0              0.017196694    0.40281403     0              19450.448      1.1971759e-13  0              4.3859272    
   1000000   12727.922      200            200            0.005772454    9.5658754e-05  0              0.017221703    0.053760005    0              2595.8783      1.1971759e-13  0              4.3859246    
   1100000   12727.922      200            200            0.0057759579   9.6019651e-05  0              0.017231854    0.0071884581   0              347.10492      1.1971759e-13  0              4.3859235    
   1200000   12727.922      200            200            0.0057772562   9.5967721e-05  0              0.017235801    0.00096289085  0              46.494553      1.1971759e-13  0              4.3859231    
   1300000   12727.922      200            200            0.0057777444   9.594827e-05   0              0.017237285    0.00012912115  0              6.2347984      1.1971759e-13  0              4.3859229    
   1400000   12727.922      200            200            0.0057779239   9.5941133e-05  0              0.017237831    1.7316647e-05  0              0.83615893     1.1971759e-13  0              4.3859228    
   1500000   12727.922      200            200            0.0057779898   9.5938518e-05  0              0.017238031    2.3223505e-06  0              0.11213799     1.1971759e-13  0              4.3859228    
   1600000   12727.922      200            200            0.0057780139   9.5937558e-05  0              0.017238104    3.1145309e-07  0              0.015038955    1.1971759e-13  0              4.3859228    
   1700000   12727.922      200            200            0.0057780228   9.5937206e-05  0              0.017238131    4.1769008e-08  0              0.0020168759   1.1971759e-13  0              4.3859228    
   1800000   12727.922      200            200            0.005778026    9.5937077e-05  0              0.017238141    5.6014457e-09  0              0.00027047377  1.1971759e-13  0              4.3859228    
   1900000   12727.922      200            200            0.0057780272   9.593703e-05   0              0.017238145    7.5128564e-10  0              3.6276895e-05  1.1971759e-13  0              4.3859228    
   2000000   12727.922      200            200            0.0057780277   9.5937012e-05  0              0.017238146    1.0073411e-10  0              4.8640895e-06  1.1971759e-13  0              4.3859228    
   2100000   12727.922      200            200            0.0057780278   9.5937006e-05  0              0.017238146    1.3504678e-11  0              6.5209255e-07  1.1971759e-13  0              4.3859228    
   2200000   12727.922      200            200            0.0057780279   9.5937003e-05  0              0.017238147    1.812061e-12   0              8.7497939e-08  1.1971759e-13  0              4.3859228    
   2300000   12727.922      200            200            0.0057780279   9.5937003e-05  0              0.017238147    2.4396037e-13  0              1.1779973e-08  1.1971759e-13  0              4.3859228    
   2400000   12727.922      200            200            0.0057780279   9.5937002e-05  0              0.017238147    3.2797235e-14  0              1.5836611e-09  1.1971759e-13  0              4.3859228    
   2500000   12727.922      200            200            0.0057780279   9.5937002e-05  0              0.017238147    4.4737262e-15  0              2.1602023e-10  1.1971759e-13  0              4.3859228    
   2600000   12727.922      200            200            0.0057780279   9.5937002e-05  0              0.017238147    2.7837259e-16  0              1.3441616e-11  1.1971759e-13  0              4.3859228    
   2700000   12727.922      200            200            0.0057780279   9.5937002e-05  0              0.017238147    2.0448758e-17  0              9.8739734e-13  1.1971759e-13  0              4.3859228    
   2800000   12727.922      200            200            0.0057780279   9.5937002e-05  0              0.017238147    2.0765827e-17  0              1.0027075e-12  1.1971759e-13  0              4.3859228    
   2900000   12727.922      200            200            0.0057780279   9.5937003e-05  0              0.017238147    4.2227037e-18  0              2.0389925e-13  1.1971759e-13  0              4.3859228    
   3000000   12727.922      200            200            0.0057780279   9.5936998e-05  0              0.017238147    5.8811552e-18  0              2.8397994e-13  1.1971759e-13  0              4.3859228    
Loop time of 696.434 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3721817.924 ns/day, 0.000 hours/ns, 4307.660 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.53     | 235.88     | 293.07     | 367.8 | 33.87
Neigh   | 0.69706    | 0.71578    | 0.73438    |   1.7 |  0.10
Comm    | 22.676     | 80.385     | 138        | 629.8 | 11.54
Output  | 0.40457    | 0.4052     | 0.40584    |   0.1 |  0.06
Modify  | 202.53     | 272.44     | 343.3      | 423.5 | 39.12
Other   |            | 106.6      |            |       | 15.31

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1462.25 ave        2176 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5849
Ave neighs/atom = 1.1695661
Neighbor list builds = 102
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.79                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 223.592377708638
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.89
  ghost atom cutoff = 5.89
  binsize = 2.945, bins = 4322 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.88 | 34.88 | 34.88 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.413781e-13   4.2413431e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0003718687   4.2413431e-13  0              0.0011156061   23492.112      0              1.13435e+09    1.1971759e-13  0              4.8190194    
    200000   12727.922      200            200            0.0004010955   4.2413431e-13  0              0.0012032865   30406.053      0              1.4681995e+09  1.1971759e-13  0              4.48615      
    300000   12727.922      200            200           -0.00013987056  4.2413431e-13  0             -0.00041961169  5164.6482      0              2.4938238e+08  1.1971759e-13  0              4.4130541    
    400000   12727.922      200            200            0.0020458229  -3.8402351e-06  0              0.006141309    7700.128       0              3.7181162e+08  1.1971759e-13  0              4.3926822    
    500000   12727.922      200            200            0.0019685223   0.0001860867   0              0.0057194801   21.156135      0              1021554.1      1.1971759e-13  0              4.3926464    
    600000   12727.922      200            200            0.0048624745   0.00010050293  0              0.014486921    117.05417      0              5652127        1.1971759e-13  0              4.3912571    
    700000   12727.922      200            200            0.0054863893   9.4109688e-05  0              0.016365058    17.519649      0              845961.17      1.1971759e-13  0              4.3910282    
    800000   12727.922      200            200            0.0056758829   0.00011210759  0              0.016915541    2.2848188      0              110325.72      1.1971759e-13  0              4.390964     
    900000   12727.922      200            200            0.0057396034   9.5806695e-05  0              0.017123004    0.29003983     0              14004.985      1.1971759e-13  0              4.3909401    
   1000000   12727.922      200            200            0.0057657217   9.2095301e-05  0              0.01720507     0.036581419    0              1766.3858      1.1971759e-13  0              4.3909307    
   1100000   12727.922      200            200            0.0057764297   9.1932016e-05  0              0.017237357    0.0046008983   0              222.16091      1.1971759e-13  0              4.3909269    
   1200000   12727.922      200            200            0.0057805588   9.1773592e-05  0              0.017249903    0.00057381405  0              27.707427      1.1971759e-13  0              4.3909255    
   1300000   12727.922      200            200            0.0057821618   9.1723709e-05  0              0.017254762    7.0910847e-05  0              3.424031       1.1971759e-13  0              4.3909249    
   1400000   12727.922      200            200            0.0057827782   9.1696499e-05  0              0.017256638    8.6913712e-06  0              0.41967521     1.1971759e-13  0              4.3909247    
   1500000   12727.922      200            200            0.0057830154   9.1686596e-05  0              0.01725736     1.0560066e-06  0              0.050990778    1.1971759e-13  0              4.3909246    
   1600000   12727.922      200            200            0.0057831062   9.1682793e-05  0              0.017257636    1.270789e-07   0              0.0061361854   1.1971759e-13  0              4.3909246    
   1700000   12727.922      200            200            0.0057831408   9.1681341e-05  0              0.017257741    1.5129443e-08  0              0.00073054663  1.1971759e-13  0              4.3909246    
   1800000   12727.922      200            200            0.0057831539   9.1680788e-05  0              0.017257781    1.7796148e-09  0              8.593123e-05   1.1971759e-13  0              4.3909246    
   1900000   12727.922      200            200            0.0057831589   9.1680578e-05  0              0.017257796    2.0645171e-10  0              9.968814e-06   1.1971759e-13  0              4.3909246    
   2000000   12727.922      200            200            0.0057831608   9.1680499e-05  0              0.017257802    2.3564597e-11  0              1.1378501e-06  1.1971759e-13  0              4.3909246    
   2100000   12727.922      200            200            0.0057831615   9.1680469e-05  0              0.017257804    2.6394992e-12  0              1.2745197e-07  1.1971759e-13  0              4.3909246    
   2200000   12727.922      200            200            0.0057831618   9.1680458e-05  0              0.017257805    2.9006861e-13  0              1.4006375e-08  1.1971759e-13  0              4.3909246    
   2300000   12727.922      200            200            0.0057831619   9.1680454e-05  0              0.017257805    3.1399219e-14  0              1.5161559e-09  1.1971759e-13  0              4.3909246    
   2400000   12727.922      200            200            0.0057831619   9.1680452e-05  0              0.017257805    3.2776607e-15  0              1.582665e-10   1.1971759e-13  0              4.3909246    
   2500000   12727.922      200            200            0.0057831619   9.1680451e-05  0              0.017257805    4.4946105e-16  0              2.1702866e-11  1.1971759e-13  0              4.3909246    
   2600000   12727.922      200            200            0.0057831619   9.1680451e-05  0              0.017257805    8.8523821e-17  0              4.2744985e-12  1.1971759e-13  0              4.3909246    
   2700000   12727.922      200            200            0.0057831619   9.1680451e-05  0              0.017257805    8.1211064e-17  0              3.9213916e-12  1.1971759e-13  0              4.3909246    
   2800000   12727.922      200            200            0.0057831619   9.1680451e-05  0              0.017257805    6.0334151e-17  0              2.9133202e-12  1.1971759e-13  0              4.3909246    
   2900000   12727.922      200            200            0.0057831619   9.1680452e-05  0              0.017257805    2.3031368e-17  0              1.1121023e-12  1.1971759e-13  0              4.3909246    
   3000000   12727.922      200            200            0.0057831619   9.1680445e-05  0              0.017257805    2.8923272e-18  0              1.3966013e-13  1.1971759e-13  0              4.3909246    
Loop time of 695.385 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3727433.613 ns/day, 0.000 hours/ns, 4314.159 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.23     | 236.83     | 294.72     | 373.1 | 34.06
Neigh   | 0.71131    | 0.73184    | 0.75294    |   1.9 |  0.11
Comm    | 24.015     | 81.406     | 139.82     | 634.3 | 11.71
Output  | 0.40415    | 0.40478    | 0.40542    |   0.1 |  0.06
Modify  | 200.63     | 270.87     | 339.87     | 418.1 | 38.95
Other   |            | 105.1      |            |       | 15.12

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1468.25 ave        2188 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5873
Ave neighs/atom = 1.1743651
Neighbor list builds = 106
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.8                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 224.752889469977
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.9
  ghost atom cutoff = 5.9
  binsize = 2.95, bins = 4315 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.83 | 34.85 | 34.86 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.4287404e-13  4.2862213e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00038904378  4.2862213e-13  0              0.0011671314   25502.888      0              1.2314432e+09  1.1971759e-13  0              4.8222485    
    200000   12727.922      200            200            0.00042538762  4.2862213e-13  0              0.0012761629   33792.548      0              1.6317212e+09  1.1971759e-13  0              4.4892519    
    300000   12727.922      200            200           -0.00011745167  4.2862213e-13  0             -0.000352355    3572.2462      0              1.7249099e+08  1.1971759e-13  0              4.4188235    
    400000   12727.922      200            200            0.0044089658   3.2084093e-05  0              0.013194813    8758.7407      0              4.2292824e+08  1.1971759e-13  0              4.3965221    
    500000   12727.922      200            200            0.0019899152   0.00018948504  0              0.0057802605   21.424653      0              1034519.8      1.1971759e-13  0              4.3976479    
    600000   12727.922      200            200            0.0045044945   7.5656556e-05  0              0.013437827    62.915145      0              3037947.2      1.1971759e-13  0              4.3964002    
    700000   12727.922      200            200            0.0053427702   0.00012819248  0              0.015900118    9.6936982      0              468074         1.1971759e-13  0              4.3960896    
    800000   12727.922      200            200            0.0056216433   0.00011789656  0              0.016747033    1.139954       0              55044.301      1.1971759e-13  0              4.3959885    
    900000   12727.922      200            200            0.0057245863   0.00010157509  0              0.017072184    0.12414523     0              5994.5289      1.1971759e-13  0              4.3959503    
   1000000   12727.922      200            200            0.0057645638   9.5004028e-05  0              0.017198687    0.01292421     0              624.06383      1.1971759e-13  0              4.3959355    
   1100000   12727.922      200            200            0.0057806115   9.4385017e-05  0              0.01724745     0.0012668979   0              61.173966      1.1971759e-13  0              4.3959298    
   1200000   12727.922      200            200            0.0057867714   9.4206183e-05  0              0.017266108    0.00011386454  0              5.4981109      1.1971759e-13  0              4.3959277    
   1300000   12727.922      200            200            0.0057891095   9.4129151e-05  0              0.017273199    9.0737896e-06  0              0.43814083     1.1971759e-13  0              4.3959268    
   1400000   12727.922      200            200            0.005789989    9.4093084e-05  0              0.017275874    5.8918533e-07  0              0.028449651    1.1971759e-13  0              4.3959265    
   1500000   12727.922      200            200            0.0057903182   9.4079531e-05  0              0.017276875    2.4433653e-08  0              0.0011798136   1.1971759e-13  0              4.3959264    
   1600000   12727.922      200            200            0.0057904406   9.4074481e-05  0              0.017277247    1.2452749e-10  0              6.012987e-06   1.1971759e-13  0              4.3959264    
   1700000   12727.922      200            200            0.0057904858   9.4072614e-05  0              0.017277385    1.6433675e-10  0              7.9352338e-06  1.1971759e-13  0              4.3959263    
   1800000   12727.922      200            200            0.0057905024   9.4071928e-05  0              0.017277435    1.1780475e-10  0              5.68837e-06    1.1971759e-13  0              4.3959263    
   1900000   12727.922      200            200            0.0057905084   9.4071678e-05  0              0.017277454    3.8494796e-11  0              1.8587759e-06  1.1971759e-13  0              4.3959263    
   2000000   12727.922      200            200            0.0057905106   9.4071587e-05  0              0.01727746     9.4420515e-12  0              4.5592287e-07  1.1971759e-13  0              4.3959263    
   2100000   12727.922      200            200            0.0057905114   9.4071554e-05  0              0.017277463    1.9935612e-12  0              9.6261935e-08  1.1971759e-13  0              4.3959263    
   2200000   12727.922      200            200            0.0057905117   9.4071543e-05  0              0.017277464    3.853024e-13   0              1.8604874e-08  1.1971759e-13  0              4.3959263    
   2300000   12727.922      200            200            0.0057905118   9.4071539e-05  0              0.017277464    7.0263739e-14  0              3.3927845e-09  1.1971759e-13  0              4.3959263    
   2400000   12727.922      200            200            0.0057905118   9.4071537e-05  0              0.017277464    1.2309752e-14  0              5.9439386e-10  1.1971759e-13  0              4.3959263    
   2500000   12727.922      200            200            0.0057905118   9.4071537e-05  0              0.017277464    1.7824033e-15  0              8.6065875e-11  1.1971759e-13  0              4.3959263    
   2600000   12727.922      200            200            0.0057905118   9.4071536e-05  0              0.017277464    6.0013109e-16  0              2.8978182e-11  1.1971759e-13  0              4.3959263    
   2700000   12727.922      200            200            0.0057905118   9.4071536e-05  0              0.017277464    3.8296927e-18  0              1.8492215e-13  1.1971759e-13  0              4.3959263    
   2800000   12727.922      200            200            0.0057905118   9.4071536e-05  0              0.017277464    2.4032888e-20  0              1.1604621e-15  1.1971759e-13  0              4.3959263    
   2900000   12727.922      200            200            0.0057905118   9.4071535e-05  0              0.017277464    1.4528295e-17  0              7.0151937e-13  1.1971759e-13  0              4.3959263    
   3000000   12727.922      200            200            0.0057905118   9.4071537e-05  0              0.017277464    9.0724208e-18  0              4.3807473e-13  1.1971759e-13  0              4.3959263    
Loop time of 695.009 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3729449.057 ns/day, 0.000 hours/ns, 4316.492 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.29     | 237.78     | 295.28     | 371.4 | 34.21
Neigh   | 0.72753    | 0.74809    | 0.76911    |   1.9 |  0.11
Comm    | 22.783     | 80.922     | 138.59     | 636.8 | 11.64
Output  | 0.40318    | 0.40382    | 0.40448    |   0.1 |  0.06
Modify  | 200.5      | 270.08     | 339.21     | 418.8 | 38.86
Other   |            | 105.1      |            |       | 15.12

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1473.75 ave        2198 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5895
Ave neighs/atom = 1.1787642
Neighbor list builds = 108
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.81                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 225.917409903541
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.91
  ghost atom cutoff = 5.91
  binsize = 2.955, bins = 4308 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.79 | 34.81 | 34.82 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.4437667e-13  4.3313002e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0004063348   4.3313002e-13  0              0.0012190044   27595.263      0              1.3324765e+09  1.1971759e-13  0              4.82543      
    200000   12727.922      200            200            0.00044990487  4.3313002e-13  0              0.0013497146   37353.749      0              1.8036789e+09  1.1971759e-13  0              4.4922535    
    300000   12727.922      200            200           -9.4616896e-05  4.3313002e-13  0             -0.00028385069  2274.2682      0              1.0981627e+08  1.1971759e-13  0              4.4244516    
    400000   12727.922      200            200            0.0077315825  -0.0002386591   0              0.023433406    8654.4328      0              4.1789159e+08  1.1971759e-13  0              4.4003226    
    500000   12727.922      200            200            0.0022226617   0.00019467169  0              0.0064733133   184.65217      0              8916192.5      1.1971759e-13  0              4.4025233    
    600000   12727.922      200            200            0.0043150409   0.0001565332   0              0.01278859     18.34592       0              885858.82      1.1971759e-13  0              4.4014942    
    700000   12727.922      200            200            0.0052494712   0.00013973722  0              0.015608676    2.767233       0              133619.78      1.1971759e-13  0              4.4011304    
    800000   12727.922      200            200            0.0055924746   0.00012148819  0              0.016655936    0.22158838     0              10699.71       1.1971759e-13  0              4.4010039    
    900000   12727.922      200            200            0.0057214612   0.00010837569  0              0.017056008    0.011554001    0              557.90134      1.1971759e-13  0              4.4009565    
   1000000   12727.922      200            200            0.0057693796   0.00010048437  0              0.017207654    0.00020185945  0              9.7470706      1.1971759e-13  0              4.4009386    
   1100000   12727.922      200            200            0.0057879803   9.95932e-05    0              0.017264348    1.9847879e-05  0              0.95838302     1.1971759e-13  0              4.400932     
   1200000   12727.922      200            200            0.0057949048   9.9437334e-05  0              0.017285277    2.6923315e-05  0              1.3000305      1.1971759e-13  0              4.4009295    
   1300000   12727.922      200            200            0.005797412    9.9336608e-05  0              0.017292899    1.0113073e-05  0              0.4883241      1.1971759e-13  0              4.4009286    
   1400000   12727.922      200            200            0.0057983128   9.9300218e-05  0              0.017295638    2.6186753e-06  0              0.12644646     1.1971759e-13  0              4.4009283    
   1500000   12727.922      200            200            0.0057986321   9.9287284e-05  0              0.017296609    5.6404411e-07  0              0.027235671    1.1971759e-13  0              4.4009282    
   1600000   12727.922      200            200            0.0057987435   9.9282757e-05  0              0.017296948    1.0854619e-07  0              0.0052413072   1.1971759e-13  0              4.4009281    
   1700000   12727.922      200            200            0.0057987818   9.9281197e-05  0              0.017297064    1.932437e-08   0              0.00093310467  1.1971759e-13  0              4.4009281    
   1800000   12727.922      200            200            0.0057987948   9.9280669e-05  0              0.017297104    3.2453477e-09  0              0.00015670623  1.1971759e-13  0              4.4009281    
   1900000   12727.922      200            200            0.005798799    9.9280494e-05  0              0.017297117    5.2028252e-10  0              2.5122581e-05  1.1971759e-13  0              4.4009281    
   2000000   12727.922      200            200            0.0057988004   9.9280438e-05  0              0.017297121    8.0221e-11     0              3.873585e-06   1.1971759e-13  0              4.4009281    
   2100000   12727.922      200            200            0.0057988008   9.928042e-05   0              0.017297122    1.1967886e-11  0              5.778864e-07   1.1971759e-13  0              4.4009281    
   2200000   12727.922      200            200            0.005798801    9.9280415e-05  0              0.017297122    1.7295788e-12  0              8.351517e-08   1.1971759e-13  0              4.4009281    
   2300000   12727.922      200            200            0.005798801    9.9280414e-05  0              0.017297123    2.4348161e-13  0              1.1756855e-08  1.1971759e-13  0              4.4009281    
   2400000   12727.922      200            200            0.005798801    9.9280413e-05  0              0.017297123    3.3429068e-14  0              1.6141701e-09  1.1971759e-13  0              4.4009281    
   2500000   12727.922      200            200            0.005798801    9.9280413e-05  0              0.017297123    4.4621106e-15  0              2.1545935e-10  1.1971759e-13  0              4.4009281    
   2600000   12727.922      200            200            0.005798801    9.9280413e-05  0              0.017297123    2.6231734e-16  0              1.2666366e-11  1.1971759e-13  0              4.4009281    
   2700000   12727.922      200            200            0.005798801    9.9280413e-05  0              0.017297123    3.2778743e-17  0              1.5827682e-12  1.1971759e-13  0              4.4009281    
   2800000   12727.922      200            200            0.005798801    9.9280413e-05  0              0.017297123    4.7218816e-19  0              2.2800277e-14  1.1971759e-13  0              4.4009281    
   2900000   12727.922      200            200            0.005798801    9.9280412e-05  0              0.017297123    3.3056962e-17  0              1.5962024e-12  1.1971759e-13  0              4.4009281    
   3000000   12727.922      200            200            0.005798801    9.9280412e-05  0              0.017297123    7.9205716e-18  0              3.8245606e-13  1.1971759e-13  0              4.4009281    
Loop time of 696.15 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3723336.175 ns/day, 0.000 hours/ns, 4309.417 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.7      | 237.73     | 295.87     | 374.3 | 34.15
Neigh   | 0.72736    | 0.74835    | 0.76977    |   1.9 |  0.11
Comm    | 23.867     | 81.8       | 139.99     | 637.5 | 11.75
Output  | 0.40381    | 0.40444    | 0.40508    |   0.1 |  0.06
Modify  | 199.95     | 270.19     | 339.08     | 419.1 | 38.81
Other   |            | 105.3      |            |       | 15.12

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1479.25 ave        2210 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5917
Ave neighs/atom = 1.1831634
Neighbor list builds = 110
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.82                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 227.085945920836
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.92
  ghost atom cutoff = 5.92
  binsize = 2.96, bins = 4300 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.75 | 34.76 | 34.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.4588598e-13  4.3765793e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00042374118  4.3765793e-13  0              0.0012712235   29769.127      0              1.4374446e+09  1.1971759e-13  0              4.8285637    
    200000   12727.922      200            200            0.00047464507  4.3765793e-13  0              0.0014239352   41089.061      0              1.9840437e+09  1.1971759e-13  0              4.4951544    
    300000   12727.922      200            200           -7.137051e-05   4.3765793e-13  0             -0.00021411153  1269.3936      0              61294475       1.1971759e-13  0              4.429938     
    400000   12727.922      200            200            0.011758299   -0.00067608354  0              0.035950982    7047.1458      0              3.4028145e+08  1.1971759e-13  0              4.40418      
    500000   12727.922      200            200            0.0026758082   0.00016685033  0              0.0078605743   473.21484      0              22849851       1.1971759e-13  0              4.4072792    
    600000   12727.922      200            200            0.0042528719   0.00018284769  0              0.012575768    0.055778403    0              2693.3395      1.1971759e-13  0              4.4065303    
    700000   12727.922      200            200            0.0052198259   0.00013537415  0              0.015524104    0.00022186404  0              10.71302       1.1971759e-13  0              4.406146     
    800000   12727.922      200            200            0.0055943262   0.00012516415  0              0.016657814    0.037126396    0              1792.7008      1.1971759e-13  0              4.4060081    
    900000   12727.922      200            200            0.0057310068   0.00011251216  0              0.017080508    0.023939027    0              1155.9299      1.1971759e-13  0              4.4059578    
   1000000   12727.922      200            200            0.0057794603   0.00010428574  0              0.017234095    0.0076963754   0              371.63042      1.1971759e-13  0              4.4059396    
   1100000   12727.922      200            200            0.0057974493   0.0001037358   0              0.017288612    0.0018677586   0              90.18738       1.1971759e-13  0              4.4059332    
   1200000   12727.922      200            200            0.0058036911   0.00010360919  0              0.017307464    0.00038310854  0              18.49894       1.1971759e-13  0              4.405931     
   1300000   12727.922      200            200            0.0058057776   0.00010352511  0              0.017313808    7.0378054e-05  0              3.3983043      1.1971759e-13  0              4.4059302    
   1400000   12727.922      200            200            0.0058064578   0.00010349757  0              0.017315876    1.1934081e-05  0              0.57625404     1.1971759e-13  0              4.40593      
   1500000   12727.922      200            200            0.0058066709   0.0001034889   0              0.017316524    1.9000591e-06  0              0.091747054    1.1971759e-13  0              4.4059299    
   1600000   12727.922      200            200            0.0058067341   0.0001034863   0              0.017316716    2.8691068e-07  0              0.01385389     1.1971759e-13  0              4.4059299    
   1700000   12727.922      200            200            0.0058067514   0.00010348559  0              0.017316769    4.1335877e-08  0              0.0019959616   1.1971759e-13  0              4.4059299    
   1800000   12727.922      200            200            0.0058067554   0.00010348542  0              0.017316781    5.7009588e-09  0              0.0002752789   1.1971759e-13  0              4.4059299    
   1900000   12727.922      200            200            0.005806756    0.00010348539  0              0.017316783    7.5358767e-10  0              3.6388052e-05  1.1971759e-13  0              4.4059299    
   2000000   12727.922      200            200            0.0058067559   0.00010348539  0              0.017316782    9.5411568e-11  0              4.6070831e-06  1.1971759e-13  0              4.4059299    
   2100000   12727.922      200            200            0.0058067557   0.0001034854   0              0.017316782    1.1539104e-11  0              5.5718203e-07  1.1971759e-13  0              4.4059299    
   2200000   12727.922      200            200            0.0058067556   0.0001034854   0              0.017316781    1.325653e-12   0              6.4011038e-08  1.1971759e-13  0              4.4059299    
   2300000   12727.922      200            200            0.0058067556   0.00010348541  0              0.017316781    1.4360566e-13  0              6.9342034e-09  1.1971759e-13  0              4.4059299    
   2400000   12727.922      200            200            0.0058067555   0.00010348541  0              0.017316781    1.4484193e-14  0              6.9938983e-10  1.1971759e-13  0              4.4059299    
   2500000   12727.922      200            200            0.0058067555   0.00010348541  0              0.017316781    1.484338e-15   0              7.1673371e-11  1.1971759e-13  0              4.4059299    
   2600000   12727.922      200            200            0.0058067555   0.00010348541  0              0.017316781    2.5703476e-17  0              1.2411289e-12  1.1971759e-13  0              4.4059299    
   2700000   12727.922      200            200            0.0058067555   0.00010348541  0              0.017316781    8.4361788e-17  0              4.0735288e-12  1.1971759e-13  0              4.4059299    
   2800000   12727.922      200            200            0.0058067555   0.00010348541  0              0.017316781    5.638524e-18   0              2.7226415e-13  1.1971759e-13  0              4.4059299    
   2900000   12727.922      200            200            0.0058067555   0.0001034854   0              0.017316781    6.4787691e-18  0              3.1283657e-13  1.1971759e-13  0              4.4059299    
   3000000   12727.922      200            200            0.0058067555   0.00010348541  0              0.017316781    8.4502552e-18  0              4.0803258e-13  1.1971759e-13  0              4.4059299    
Loop time of 698.115 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3712857.250 ns/day, 0.000 hours/ns, 4297.288 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.48     | 238.29     | 297.72     | 380.1 | 34.13
Neigh   | 0.77171    | 0.79402    | 0.81688    |   1.9 |  0.11
Comm    | 24.284     | 82.729     | 142.61     | 642.5 | 11.85
Output  | 0.40183    | 0.40249    | 0.40313    |   0.1 |  0.06
Modify  | 199.74     | 270.13     | 339.96     | 418.2 | 38.69
Other   |            | 105.8      |            |       | 15.15

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1484.25 ave        2220 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5937
Ave neighs/atom = 1.1871626
Neighbor list builds = 114
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.83                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 228.258504433366
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.93
  ghost atom cutoff = 5.93
  binsize = 2.965, bins = 4293 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.73 | 34.74 | 34.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.4740196e-13  4.4220587e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00044126235  4.4220587e-13  0              0.0013237871   32024.375      0              1.5463425e+09  1.1971759e-13  0              4.8316496    
    200000   12727.922      200            200            0.00049960606  4.4220587e-13  0              0.0014988182   44997.891      0              2.1727871e+09  1.1971759e-13  0              4.4979541    
    300000   12727.922      200            200           -4.7716698e-05  4.4220587e-13  0             -0.00014315009  556.30128      0              26861798       1.1971759e-13  0              4.4352821    
    400000   12727.922      200            200            0.015781619   -0.0013051951   0              0.048650051    4266.6697      0              2.0602221e+08  1.1971759e-13  0              4.4082122    
    500000   12727.922      200            200            0.0033774398   9.4568963e-05  0              0.01003775     813.75812      0              39293467       1.1971759e-13  0              4.4119302    
    600000   12727.922      200            200            0.0043327434   0.00018668667  0              0.012811543    14.624606      0              706169.87      1.1971759e-13  0              4.4115049    
    700000   12727.922      200            200            0.0052658662   0.00013958563  0              0.015658013    2.6615515      0              128516.8       1.1971759e-13  0              4.4111345    
    800000   12727.922      200            200            0.0056282513   0.00012930577  0              0.016755448    0.68285686     0              32972.714      1.1971759e-13  0              4.4110009    
    900000   12727.922      200            200            0.0057532613   0.00011479149  0              0.017144992    0.15209863     0              7344.2983      1.1971759e-13  0              4.4109544    
   1000000   12727.922      200            200            0.0057945613   0.00010696457  0              0.017276719    0.029625418    0              1430.5054      1.1971759e-13  0              4.4109387    
   1100000   12727.922      200            200            0.0058086204   0.0001067095   0              0.017319152    0.0051962561   0              250.90861      1.1971759e-13  0              4.4109337    
   1200000   12727.922      200            200            0.0058128767   0.00010664289  0              0.017331987    0.00083569232  0              40.352591      1.1971759e-13  0              4.4109321    
   1300000   12727.922      200            200            0.0058140475   0.00010659504  0              0.017335548    0.00012499373  0              6.0354998      1.1971759e-13  0              4.4109317    
   1400000   12727.922      200            200            0.0058143256   0.00010658344  0              0.017336393    1.7519977e-05  0              0.84597697     1.1971759e-13  0              4.4109316    
   1500000   12727.922      200            200            0.0058143692   0.00010658149  0              0.017336526    2.3079754e-06  0              0.11144387     1.1971759e-13  0              4.4109316    
   1600000   12727.922      200            200            0.0058143633   0.00010658164  0              0.017336508    2.8542308e-07  0              0.013782059    1.1971759e-13  0              4.4109316    
   1700000   12727.922      200            200            0.0058143532   0.00010658201  0              0.017336478    3.2956642e-08  0              0.0015913583   1.1971759e-13  0              4.4109316    
   1800000   12727.922      200            200            0.0058143467   0.00010658225  0              0.017336458    3.513193e-09   0              0.00016963952  1.1971759e-13  0              4.4109316    
   1900000   12727.922      200            200            0.0058143434   0.00010658238  0              0.017336448    3.384687e-10   0              1.6343442e-05  1.1971759e-13  0              4.4109316    
   2000000   12727.922      200            200            0.0058143418   0.00010658244  0              0.017336443    2.8287979e-11  0              1.3659253e-06  1.1971759e-13  0              4.4109316    
   2100000   12727.922      200            200            0.0058143412   0.00010658247  0              0.017336441    1.8773388e-12  0              9.0649972e-08  1.1971759e-13  0              4.4109316    
   2200000   12727.922      200            200            0.0058143409   0.00010658248  0              0.01733644     7.5492095e-14  0              3.6452431e-09  1.1971759e-13  0              4.4109316    
   2300000   12727.922      200            200            0.0058143408   0.00010658248  0              0.01733644     3.0810004e-16  0              1.4877048e-11  1.1971759e-13  0              4.4109316    
   2400000   12727.922      200            200            0.0058143408   0.00010658248  0              0.01733644     6.1556957e-16  0              2.9723652e-11  1.1971759e-13  0              4.4109316    
   2500000   12727.922      200            200            0.0058143407   0.00010658248  0              0.01733644     2.9624654e-16  0              1.4304685e-11  1.1971759e-13  0              4.4109316    
   2600000   12727.922      200            200            0.0058143407   0.00010658248  0              0.01733644     4.739119e-16   0              2.2883509e-11  1.1971759e-13  0              4.4109316    
   2700000   12727.922      200            200            0.0058143407   0.00010658248  0              0.01733644     9.6206402e-18  0              4.6454628e-13  1.1971759e-13  0              4.4109316    
   2800000   12727.922      200            200            0.0058143407   0.00010658248  0              0.01733644     5.6720533e-17  0              2.7388315e-12  1.1971759e-13  0              4.4109316    
   2900000   12727.922      200            200            0.0058143407   0.00010658248  0              0.01733644     8.8202942e-18  0              4.2590044e-13  1.1971759e-13  0              4.4109316    
   3000000   12727.922      200            200            0.0058143407   0.00010658249  0              0.01733644     4.1087605e-18  0              1.9839734e-13  1.1971759e-13  0              4.4109316    
Loop time of 692.182 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3744682.167 ns/day, 0.000 hours/ns, 4334.123 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.63     | 235.85     | 293.13     | 363.8 | 34.07
Neigh   | 0.71282    | 0.73253    | 0.75186    |   1.8 |  0.11
Comm    | 22.395     | 80.098     | 137.06     | 622.6 | 11.57
Output  | 0.40676    | 0.4074     | 0.40805    |   0.1 |  0.06
Modify  | 201.37     | 270.24     | 339.13     | 416.2 | 39.04
Other   |            | 104.9      |            |       | 15.15

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1431.25 ave        2114 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5725
Ave neighs/atom = 1.144771
Neighbor list builds = 109
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.84                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 229.435092352631
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.94
  ghost atom cutoff = 5.94
  binsize = 2.97, bins = 4286 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.69 | 34.69 | 34.69 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.4892461e-13  4.4677382e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00045889776  4.4677382e-13  0              0.0013766933   34360.901      0              1.6591649e+09  1.1971759e-13  0              4.8346874    
    200000   12727.922      200            200            0.00052478568  4.4677382e-13  0              0.001574357    49079.65       0              2.3698807e+09  1.1971759e-13  0              4.5006523    
    300000   12727.922      200            200           -2.3659733e-05  4.4677382e-13  0             -7.09792e-05    133.67467      0              6454671.5      1.1971759e-13  0              4.4404834    
    400000   12727.922      200            200            0.019094179   -0.0013011341   0              0.058583672    1447.1657      0              69878454       1.1971759e-13  0              4.4125402    
    500000   12727.922      200            200            0.0044403787   0.00025846472  0              0.013062671    1104.9783      0              53355447       1.1971759e-13  0              4.4164995    
    600000   12727.922      200            200            0.0045549785   0.00017741744  0              0.013487518    56.397586      0              2723237.6      1.1971759e-13  0              4.4164205    
    700000   12727.922      200            200            0.0053814995   0.00014513427  0              0.015999364    9.447078       0              456165.59      1.1971759e-13  0              4.4160977    
    800000   12727.922      200            200            0.0056903958   0.00013278884  0              0.016938398    1.7894786      0              86407.516      1.1971759e-13  0              4.4159835    
    900000   12727.922      200            200            0.0057865616   0.00011759559  0              0.017242089    0.31179311     0              15055.373      1.1971759e-13  0              4.4159471    
   1000000   12727.922      200            200            0.0058138499   0.00011051886  0              0.017331031    0.04948728     0              2389.5636      1.1971759e-13  0              4.4159364    
   1100000   12727.922      200            200            0.0058213401   0.00011051255  0              0.017353508    0.007182643    0              346.82413      1.1971759e-13  0              4.4159337    
   1200000   12727.922      200            200            0.0058227111   0.00011052858  0              0.017357605    0.00095728347  0              46.223793      1.1971759e-13  0              4.4159332    
   1300000   12727.922      200            200            0.0058226845   0.00011052793  0              0.017357526    0.00011708549  0              5.6536394      1.1971759e-13  0              4.4159332    
   1400000   12727.922      200            200            0.005822485    0.00011053514  0              0.01735692     1.3031957e-05  0              0.62926655     1.1971759e-13  0              4.4159333    
   1500000   12727.922      200            200            0.0058223454   0.00011054041  0              0.017356496    1.293981e-06   0              0.062481713    1.1971759e-13  0              4.4159333    
   1600000   12727.922      200            200            0.0058222722   0.00011054321  0              0.017356273    1.0994399e-07  0              0.0053088018   1.1971759e-13  0              4.4159333    
   1700000   12727.922      200            200            0.0058222383   0.00011054452  0              0.01735617     7.2617883e-09  0              0.00035064577  1.1971759e-13  0              4.4159333    
   1800000   12727.922      200            200            0.0058222239   0.00011054508  0              0.017356127    2.7681449e-10  0              1.3366381e-05  1.1971759e-13  0              4.4159334    
   1900000   12727.922      200            200            0.0058222181   0.0001105453   0              0.017356109    2.5287955e-13  0              1.2210649e-08  1.1971759e-13  0              4.4159334    
   2000000   12727.922      200            200            0.0058222158   0.00011054539  0              0.017356102    3.5071776e-12  0              1.6934905e-07  1.1971759e-13  0              4.4159334    
   2100000   12727.922      200            200            0.005822215    0.00011054542  0              0.0173561      1.9864084e-12  0              9.5916551e-08  1.1971759e-13  0              4.4159334    
   2200000   12727.922      200            200            0.0058222147   0.00011054544  0              0.017356099    5.7941069e-13  0              2.7977668e-08  1.1971759e-13  0              4.4159334    
   2300000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    1.251787e-13   0              6.0444313e-09  1.1971759e-13  0              4.4159334    
   2400000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    2.3303661e-14  0              1.1252504e-09  1.1971759e-13  0              4.4159334    
   2500000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    3.6916612e-15  0              1.7825711e-10  1.1971759e-13  0              4.4159334    
   2600000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    4.8233999e-16  0              2.3290472e-11  1.1971759e-13  0              4.4159334    
   2700000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    8.0602058e-18  0              3.8919849e-13  1.1971759e-13  0              4.4159334    
   2800000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    2.8661216e-19  0              1.3839475e-14  1.1971759e-13  0              4.4159334    
   2900000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    2.1634019e-17  0              1.0446293e-12  1.1971759e-13  0              4.4159334    
   3000000   12727.922      200            200            0.0058222146   0.00011054544  0              0.017356098    9.4160201e-18  0              4.5466591e-13  1.1971759e-13  0              4.4159334    
Loop time of 691.481 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3748474.544 ns/day, 0.000 hours/ns, 4338.512 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 177.69     | 234.45     | 291.75     | 363.3 | 33.91
Neigh   | 0.71385    | 0.73319    | 0.75299    |   1.8 |  0.11
Comm    | 24.413     | 80.109     | 138.62     | 614.9 | 11.59
Output  | 0.40347    | 0.4041     | 0.40474    |   0.1 |  0.06
Modify  | 199.49     | 270.75     | 339.77     | 415.5 | 39.15
Other   |            | 105        |            |       | 15.19

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1438.25 ave        2128 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5753
Ave neighs/atom = 1.1503699
Neighbor list builds = 107
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.85                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 230.615716590138
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.95
  ghost atom cutoff = 5.95
  binsize = 2.975, bins = 4279 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.65 | 34.66 | 34.67 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.5045392e-13  4.5136175e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00047664683  4.5136175e-13  0              0.0014299405   36778.598      0              1.7759069e+09  1.1971759e-13  0              4.8376769    
    200000   12727.922      200            200            0.00055018171  4.5136175e-13  0              0.0016505451   53333.739      0              2.5752954e+09  1.1971759e-13  0              4.5032486    
    300000   12727.922      200            200            7.9613328e-07  4.5136175e-13  0              2.3883994e-06  0.19734282     0              9528.9784      1.1971759e-13  0              4.4455413    
    400000   12727.922      200            200            0.0206205     -0.0010996933   0              0.062961192    27.436554      0              1324813        1.1971759e-13  0              4.4172595    
    500000   12727.922      200            200            0.005719642    0.00028222237  0              0.016876704    1240.6348      0              59905814       1.1971759e-13  0              4.4210203    
    600000   12727.922      200            200            0.0049100367   0.00015935419  0              0.014570756    109.16972      0              5271414.9      1.1971759e-13  0              4.4212854    
    700000   12727.922      200            200            0.0055582209   0.00015991901  0              0.016514744    17.057316      0              823636.77      1.1971759e-13  0              4.4210401    
    800000   12727.922      200            200            0.0057715044   0.00013045898  0              0.017184054    2.7249662      0              131578.86      1.1971759e-13  0              4.4209588    
    900000   12727.922      200            200            0.0058259901   0.0001190731   0              0.017358897    0.39813404     0              19224.468      1.1971759e-13  0              4.4209375    
   1000000   12727.922      200            200            0.0058350007   0.0001147654   0              0.017390237    0.052437613    0              2532.0247      1.1971759e-13  0              4.4209336    
   1100000   12727.922      200            200            0.0058344365   0.00011490887  0              0.0173884      0.006169369    0              297.89675      1.1971759e-13  0              4.4209337    
   1200000   12727.922      200            200            0.0058326072   0.00011499878  0              0.017382823    0.00063767289  0              30.790942      1.1971759e-13  0              4.4209343    
   1300000   12727.922      200            200            0.0058313803   0.00011504541  0              0.017379095    5.5630417e-05  0              2.6861938      1.1971759e-13  0              4.4209347    
   1400000   12727.922      200            200            0.0058307525   0.00011506961  0              0.017377188    3.7160514e-06  0              0.17943482     1.1971759e-13  0              4.4209349    
   1500000   12727.922      200            200            0.0058304698   0.00011508059  0              0.017376329    1.3928906e-07  0              0.0067257703   1.1971759e-13  0              4.420935     
   1600000   12727.922      200            200            0.0058303525   0.00011508517  0              0.017375972    5.4486698e-11  0              2.6309676e-06  1.1971759e-13  0              4.4209351    
   1700000   12727.922      200            200            0.0058303069   0.00011508696  0              0.017375834    2.0066626e-09  0              9.6894555e-05  1.1971759e-13  0              4.4209351    
   1800000   12727.922      200            200            0.0058302901   0.00011508762  0              0.017375783    1.0830553e-09  0              5.2296863e-05  1.1971759e-13  0              4.4209351    
   1900000   12727.922      200            200            0.0058302843   0.00011508785  0              0.017375765    3.0422604e-10  0              1.4689987e-05  1.1971759e-13  0              4.4209351    
   2000000   12727.922      200            200            0.0058302824   0.00011508793  0              0.017375759    6.4230997e-11  0              3.101485e-06   1.1971759e-13  0              4.4209351    
   2100000   12727.922      200            200            0.0058302818   0.00011508795  0              0.017375757    1.1367662e-11  0              5.4890373e-07  1.1971759e-13  0              4.4209351    
   2200000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    1.7621045e-12  0              8.5085721e-08  1.1971759e-13  0              4.4209351    
   2300000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    2.4360392e-13  0              1.1762761e-08  1.1971759e-13  0              4.4209351    
   2400000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    3.0007397e-14  0              1.4489498e-09  1.1971759e-13  0              4.4209351    
   2500000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    3.5306939e-15  0              1.7048457e-10  1.1971759e-13  0              4.4209351    
   2600000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    2.1571379e-17  0              1.0416047e-12  1.1971759e-13  0              4.4209351    
   2700000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    8.1546267e-17  0              3.9375774e-12  1.1971759e-13  0              4.4209351    
   2800000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    2.8398286e-18  0              1.3712516e-13  1.1971759e-13  0              4.4209351    
   2900000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    5.9337901e-17  0              2.8652149e-12  1.1971759e-13  0              4.4209351    
   3000000   12727.922      200            200            0.0058302816   0.00011508796  0              0.017375757    4.9920767e-18  0              2.4104952e-13  1.1971759e-13  0              4.4209351    
Loop time of 692.637 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3742222.611 ns/day, 0.000 hours/ns, 4331.276 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.18     | 235.37     | 292.81     | 364.9 | 33.98
Neigh   | 0.69975    | 0.71885    | 0.73843    |   1.8 |  0.10
Comm    | 23.817     | 79.91      | 137.39     | 621.3 | 11.54
Output  | 0.40314    | 0.40379    | 0.40444    |   0.1 |  0.06
Modify  | 199.09     | 270.56     | 340.01     | 418.5 | 39.06
Other   |            | 105.7      |            |       | 15.26

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1444.25 ave        2139 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5777
Ave neighs/atom = 1.155169
Neighbor list builds = 105
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.86                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 231.800384057389
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.96
  ghost atom cutoff = 5.96
  binsize = 2.98, bins = 4272 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.61 | 34.62 | 34.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.5198988e-13  4.5596965e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00049450899  4.5596965e-13  0              0.001483527    39277.363      0              1.8965633e+09  1.1971759e-13  0              4.8406181    
    200000   12727.922      200            200            0.00057579205  4.5596965e-13  0              0.0017273762   57759.579      0              2.7890034e+09  1.1971759e-13  0              4.5057425    
    300000   12727.922      200            200            2.5646766e-05  4.5596965e-13  0              7.6940297e-05  154.55555      0              7462934.3      1.1971759e-13  0              4.4504552    
    400000   12727.922      200            200            0.019756333   -0.0011248772   0              0.060393876    801.47598      0              38700407       1.1971759e-13  0              4.4224141    
    500000   12727.922      200            200            0.007102974    8.1917752e-05  0              0.021227004    1150.0445      0              55531535       1.1971759e-13  0              4.4255347    
    600000   12727.922      200            200            0.0053993436   0.00020487584  0              0.015993155    151.51403      0              7316070.4      1.1971759e-13  0              4.4261132    
    700000   12727.922      200            200            0.0057711593   0.00016534523  0              0.017148133    21.722358      0              1048894.9      1.1971759e-13  0              4.4259692    
    800000   12727.922      200            200            0.0058623789   0.00012711526  0              0.017460021    2.9492558      0              142409.01      1.1971759e-13  0              4.4259306    
    900000   12727.922      200            200            0.0058680884   0.0001254095   0              0.017478856    0.35404132     0              17095.388      1.1971759e-13  0              4.4259276    
   1000000   12727.922      200            200            0.0058569656   0.00012432665  0              0.01744657     0.036323185    0              1753.9166      1.1971759e-13  0              4.425931     
   1100000   12727.922      200            200            0.0058483173   0.00012449933  0              0.017420453    0.0030229345   0              145.96669      1.1971759e-13  0              4.425934     
   1200000   12727.922      200            200            0.0058436468   0.00012467421  0              0.017406266    0.00017781843  0              8.5862156      1.1971759e-13  0              4.4259356    
   1300000   12727.922      200            200            0.0058414965   0.00012475588  0              0.017399734    4.244083e-06   0              0.20493158     1.1971759e-13  0              4.4259363    
   1400000   12727.922      200            200            0.0058406017   0.00012479015  0              0.017397015    1.0954229e-07  0              0.005289405    1.1971759e-13  0              4.4259367    
   1500000   12727.922      200            200            0.0058402571   0.00012480342  0              0.017395968    2.6055011e-07  0              0.012581033    1.1971759e-13  0              4.4259368    
   1600000   12727.922      200            200            0.0058401333   0.00012480821  0              0.017395592    1.0031112e-07  0              0.0048436649   1.1971759e-13  0              4.4259368    
   1700000   12727.922      200            200            0.0058400919   0.00012480982  0              0.017395466    2.4211509e-08  0              0.0011690871   1.1971759e-13  0              4.4259368    
   1800000   12727.922      200            200            0.0058400793   0.00012481032  0              0.017395428    4.5700104e-09  0              0.00022066945  1.1971759e-13  0              4.4259368    
   1900000   12727.922      200            200            0.0058400759   0.00012481045  0              0.017395417    7.2656121e-10  0              3.5083041e-05  1.1971759e-13  0              4.4259368    
   2000000   12727.922      200            200            0.0058400752   0.00012481048  0              0.017395415    1.0003849e-10  0              4.8305004e-06  1.1971759e-13  0              4.4259368    
   2100000   12727.922      200            200            0.0058400751   0.00012481048  0              0.017395415    1.197637e-11   0              5.7829604e-07  1.1971759e-13  0              4.4259368    
   2200000   12727.922      200            200            0.0058400752   0.00012481048  0              0.017395415    1.2275728e-12  0              5.9275099e-08  1.1971759e-13  0              4.4259368    
   2300000   12727.922      200            200            0.0058400752   0.00012481048  0              0.017395415    1.0058778e-13  0              4.8570238e-09  1.1971759e-13  0              4.4259368    
   2400000   12727.922      200            200            0.0058400753   0.00012481048  0              0.017395415    5.3785661e-15  0              2.5971171e-10  1.1971759e-13  0              4.4259368    
   2500000   12727.922      200            200            0.0058400753   0.00012481048  0              0.017395415    1.8541978e-16  0              8.9532574e-12  1.1971759e-13  0              4.4259368    
   2600000   12727.922      200            200            0.0058400753   0.00012481048  0              0.017395415    2.5628413e-16  0              1.2375043e-11  1.1971759e-13  0              4.4259368    
   2700000   12727.922      200            200            0.0058400753   0.00012481048  0              0.017395415    2.594161e-17   0              1.2526275e-12  1.1971759e-13  0              4.4259368    
   2800000   12727.922      200            200            0.0058400753   0.00012481048  0              0.017395415    5.9140831e-17  0              2.8556991e-12  1.1971759e-13  0              4.4259368    
   2900000   12727.922      200            200            0.0058400753   0.00012481048  0              0.017395415    1.9400979e-17  0              9.3680386e-13  1.1971759e-13  0              4.4259368    
   3000000   12727.922      200            200            0.0058400753   0.00012481047  0              0.017395415    3.4183662e-18  0              1.6506067e-13  1.1971759e-13  0              4.4259368    
Loop time of 691.82 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3746639.477 ns/day, 0.000 hours/ns, 4336.388 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.43     | 234.97     | 291.45     | 361.9 | 33.96
Neigh   | 0.66389    | 0.68174    | 0.7002     |   1.8 |  0.10
Comm    | 23.913     | 79.375     | 137.33     | 620.6 | 11.47
Output  | 0.40454    | 0.40519    | 0.40584    |   0.1 |  0.06
Modify  | 199.58     | 270.52     | 340.79     | 418.8 | 39.10
Other   |            | 105.9      |            |       | 15.30

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1451.25 ave        2154 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5805
Ave neighs/atom = 1.1607678
Neighbor list builds = 101
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.87                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 232.98910166589
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.97
  ghost atom cutoff = 5.97
  binsize = 2.985, bins = 4264 68 68
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.78 | 35.79 | 35.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.5353251e-13  4.6059752e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00051248368  4.6059752e-13  0              0.001537451    41857.09       0              2.0211291e+09  1.1971759e-13  0              4.8435106    
    200000   12727.922      200            200            0.00060161445  4.6059752e-13  0              0.0018048433   62356.571      0              3.0109756e+09  1.1971759e-13  0              4.5081337    
    300000   12727.922      200            200            5.0887787e-05  4.6059752e-13  0              0.00015266336  595.43663      0              28751504       1.1971759e-13  0              4.4552246    
    400000   12727.922      200            200            0.016666173   -0.0016054719   0              0.05160399     3309.9438      0              1.5982534e+08  1.1971759e-13  0              4.4279827    
    500000   12727.922      200            200            0.0084652079  -0.00023574769  0              0.025631371    843.59263      0              40734069       1.1971759e-13  0              4.430091     
    600000   12727.922      200            200            0.0059372848   0.0001752164   0              0.017636638    164.87378      0              7961165        1.1971759e-13  0              4.4309221    
    700000   12727.922      200            200            0.0059963095   0.00016329261  0              0.017825636    21.037624      0              1015831.6      1.1971759e-13  0              4.4308943    
    800000   12727.922      200            200            0.0059513207   0.00012585714  0              0.017728105    2.3264751      0              112337.16      1.1971759e-13  0              4.4309034    
    900000   12727.922      200            200            0.0059060997   0.00013371687  0              0.017584582    0.20830447     0              10058.277      1.1971759e-13  0              4.4309192    
   1000000   12727.922      200            200            0.0058761112   0.00013552626  0              0.017492807    0.013206519    0              637.69555      1.1971759e-13  0              4.4309296    
   1100000   12727.922      200            200            0.0058608636   0.00013566073  0              0.01744693     0.00037561956  0              18.137324      1.1971759e-13  0              4.4309349    
   1200000   12727.922      200            200            0.0058543039   0.0001359025   0              0.017427009    3.2740916e-06  0              0.15809417     1.1971759e-13  0              4.4309372    
   1300000   12727.922      200            200            0.0058517259   0.00013599891  0              0.017419179    1.4968825e-05  0              0.72279099     1.1971759e-13  0              4.4309381    
   1400000   12727.922      200            200            0.0058507961   0.00013603397  0              0.017416354    6.1148736e-06  0              0.29526536     1.1971759e-13  0              4.4309384    
   1500000   12727.922      200            200            0.0058504892   0.00013604562  0              0.017415422    1.4804155e-06  0              0.071483965    1.1971759e-13  0              4.4309385    
   1600000   12727.922      200            200            0.0058503985   0.0001360491   0              0.017415147    2.7283302e-07  0              0.01317413     1.1971759e-13  0              4.4309386    
   1700000   12727.922      200            200            0.005850376    0.00013604997  0              0.017415078    4.1383177e-08  0              0.0019982455   1.1971759e-13  0              4.4309386    
   1800000   12727.922      200            200            0.0058503724   0.00013605012  0              0.017415067    5.2893112e-09  0              0.00025540191  1.1971759e-13  0              4.4309386    
   1900000   12727.922      200            200            0.0058503729   0.0001360501   0              0.017415069    5.6458301e-10  0              2.7261693e-05  1.1971759e-13  0              4.4309386    
   2000000   12727.922      200            200            0.0058503737   0.00013605007  0              0.017415071    4.7955734e-11  0              2.3156107e-06  1.1971759e-13  0              4.4309386    
   2100000   12727.922      200            200            0.0058503742   0.00013605005  0              0.017415073    2.8006122e-12  0              1.3523154e-07  1.1971759e-13  0              4.4309386    
   2200000   12727.922      200            200            0.0058503745   0.00013605004  0              0.017415073    6.0682062e-14  0              2.9301196e-09  1.1971759e-13  0              4.4309386    
   2300000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    2.7323736e-15  0              1.3193654e-10  1.1971759e-13  0              4.4309386    
   2400000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    5.171219e-15   0              2.4969966e-10  1.1971759e-13  0              4.4309386    
   2500000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    1.6760896e-15  0              8.0932366e-11  1.1971759e-13  0              4.4309386    
   2600000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    5.9762575e-16  0              2.8857209e-11  1.1971759e-13  0              4.4309386    
   2700000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    1.5574478e-18  0              7.520358e-14   1.1971759e-13  0              4.4309386    
   2800000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    3.5915294e-17  0              1.734221e-12   1.1971759e-13  0              4.4309386    
   2900000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    4.3687798e-20  0              2.1095274e-15  1.1971759e-13  0              4.4309386    
   3000000   12727.922      200            200            0.0058503746   0.00013605004  0              0.017415074    6.8558821e-18  0              3.3104601e-13  1.1971759e-13  0              4.4309386    
Loop time of 692.009 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3745618.045 ns/day, 0.000 hours/ns, 4335.206 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.36     | 236.06     | 292.93     | 366.1 | 34.11
Neigh   | 0.71566    | 0.73427    | 0.75319    |   1.8 |  0.11
Comm    | 23.833     | 80.092     | 136.81     | 627.1 | 11.57
Output  | 0.40111    | 0.40175    | 0.40239    |   0.1 |  0.06
Modify  | 199.66     | 269.87     | 338.48     | 417.7 | 39.00
Other   |            | 104.9      |            |       | 15.15

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1457.25 ave        2166 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5829
Ave neighs/atom = 1.1655669
Neighbor list builds = 103
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.88                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 234.181876327144
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.98
  ghost atom cutoff = 5.98
  binsize = 2.99, bins = 4257 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.96 | 33.97 | 33.98 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.5508177e-13  4.6524532e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00053057032  4.6524532e-13  0              0.001591711    44517.676      0              2.1495993e+09  1.1971759e-13  0              4.8463543    
    200000   12727.922      200            200            0.00062764672  4.6524532e-13  0              0.0018829402   67124.125      0              3.2411838e+09  1.1971759e-13  0              4.5104218    
    300000   12727.922      200            200            7.6514997e-05  4.6524532e-13  0              0.00022954499  1321.53        0              63811952       1.1971759e-13  0              4.459849     
    400000   12727.922      200            200            0.012599056   -0.0012966884   0              0.039093856    6177.622       0              2.9829526e+08  1.1971759e-13  0              4.433884     
    500000   12727.922      200            200            0.0096463528  -0.00047976814  0              0.029418826    433.7107       0              20942337       1.1971759e-13  0              4.4347387    
    600000   12727.922      200            200            0.0064888014   0.00013422966  0              0.019332175    141.96438      0              6854951.9      1.1971759e-13  0              4.4357336    
    700000   12727.922      200            200            0.0061958691   0.00012764096  0              0.018459966    15.251416      0              736436.3       1.1971759e-13  0              4.4358255    
    800000   12727.922      200            200            0.0060268165   0.00013057904  0              0.017949871    1.2137512      0              58607.702      1.1971759e-13  0              4.4358816    
    900000   12727.922      200            200            0.0059354905   0.00014553836  0              0.017660933    0.057123429    0              2758.2859      1.1971759e-13  0              4.4359143    
   1000000   12727.922      200            200            0.0058909577   0.00014917009  0              0.017523703    0.0002884714   0              13.929252      1.1971759e-13  0              4.43593      
   1100000   12727.922      200            200            0.0058718895   0.00014932669  0              0.017466342    0.00041289894  0              19.937412      1.1971759e-13  0              4.4359366    
   1200000   12727.922      200            200            0.005864795    0.00014958505  0              0.0174448      0.00026961365  0              13.018678      1.1971759e-13  0              4.4359391    
   1300000   12727.922      200            200            0.005862391    0.00014967402  0              0.017437499    7.5702437e-05  0              3.6553998      1.1971759e-13  0              4.43594      
   1400000   12727.922      200            200            0.0058616695   0.00014970101  0              0.017435307    1.4839566e-05  0              0.71654956     1.1971759e-13  0              4.4359402    
   1500000   12727.922      200            200            0.0058614897   0.00014970783  0              0.017434761    2.2910752e-06  0              0.11062782     1.1971759e-13  0              4.4359403    
   1600000   12727.922      200            200            0.0058614615   0.00014970895  0              0.017434675    2.8793623e-07  0              0.01390341     1.1971759e-13  0              4.4359403    
   1700000   12727.922      200            200            0.0058614659   0.00014970882  0              0.017434689    2.9030222e-08  0              0.0014017655   1.1971759e-13  0              4.4359403    
   1800000   12727.922      200            200            0.0058614728   0.00014970857  0              0.01743471     2.170856e-09   0              0.00010482287  1.1971759e-13  0              4.4359403    
   1900000   12727.922      200            200            0.0058614769   0.00014970842  0              0.017434722    9.1546171e-11  0              4.4204369e-06  1.1971759e-13  0              4.4359403    
   2000000   12727.922      200            200            0.0058614789   0.00014970835  0              0.017434728    1.6796386e-13  0              8.1103735e-09  1.1971759e-13  0              4.4359403    
   2100000   12727.922      200            200            0.0058614798   0.00014970832  0              0.017434731    9.952072e-13   0              4.8054994e-08  1.1971759e-13  0              4.4359403    
   2200000   12727.922      200            200            0.0058614801   0.00014970831  0              0.017434732    5.6227157e-13  0              2.7150082e-08  1.1971759e-13  0              4.4359403    
   2300000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    1.5092609e-13  0              7.2876807e-09  1.1971759e-13  0              4.4359403    
   2400000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    2.8650788e-14  0              1.383444e-09   1.1971759e-13  0              4.4359403    
   2500000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    4.2946228e-15  0              2.0737196e-10  1.1971759e-13  0              4.4359403    
   2600000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    1.9955966e-16  0              9.6360216e-12  1.1971759e-13  0              4.4359403    
   2700000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    6.505006e-17   0              3.1410346e-12  1.1971759e-13  0              4.4359403    
   2800000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    1.7417688e-17  0              8.4103783e-13  1.1971759e-13  0              4.4359403    
   2900000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    1.9207193e-17  0              9.274466e-13   1.1971759e-13  0              4.4359403    
   3000000   12727.922      200            200            0.0058614802   0.0001497083   0              0.017434732    2.4761713e-18  0              1.1956545e-13  1.1971759e-13  0              4.4359403    
Loop time of 691.365 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3749106.471 ns/day, 0.000 hours/ns, 4339.244 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.53     | 235.69     | 292.27     | 365.4 | 34.09
Neigh   | 0.63472    | 0.65241    | 0.67029    |   1.8 |  0.09
Comm    | 22.474     | 79.621     | 135.74     | 629.0 | 11.52
Output  | 0.4463     | 0.44695    | 0.44759    |   0.1 |  0.06
Modify  | 200.42     | 270.12     | 339.08     | 419.6 | 39.07
Other   |            | 104.8      |            |       | 15.16

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:        1463.25 ave        2178 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5853
Ave neighs/atom = 1.1703659
Neighbor list builds = 101
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.89                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 235.378714952656
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.99
  ghost atom cutoff = 5.99
  binsize = 2.995, bins = 4250 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.92 | 33.92 | 33.92 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.5663769e-13  4.6991306e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00054876835  4.6991306e-13  0              0.001646305    47259.018      0              2.2819689e+09  1.1971759e-13  0              4.8491491    
    200000   12727.922      200            200            0.00065388671  4.6991306e-13  0              0.0019616601   72061.66       0              3.4795996e+09  1.1971759e-13  0              4.5126063    
    300000   12727.922      200            200            0.00010252415  4.6991306e-13  0              0.00030757244  2331.5268      0              1.1258109e+08  1.1971759e-13  0              4.4643277    
    400000   12727.922      200            200            0.0085900434  -0.00020670834  0              0.025976838    8074.6189      0              3.8989445e+08  1.1971759e-13  0              4.4399999    
    500000   12727.922      200            200            0.010446478   -0.00054983036  0              0.031889264    100.62092      0              4858623.9      1.1971759e-13  0              4.4395207    
    600000   12727.922      200            200            0.0069759653   5.9188357e-05  0              0.020868708    91.648063      0              4425357        1.1971759e-13  0              4.4405696    
    700000   12727.922      200            200            0.0063507796   8.8533502e-05  0              0.018963805    7.2766779      0              351364.73      1.1971759e-13  0              4.4407723    
    800000   12727.922      200            200            0.0060756638   0.00013386318  0              0.018093128    0.2602444      0              12566.271      1.1971759e-13  0              4.4408689    
    900000   12727.922      200            200            0.0059506334   0.0001541116   0              0.017697789    0.00037416332  0              18.067008      1.1971759e-13  0              4.4409139    
   1000000   12727.922      200            200            0.0058984187   0.0001582142   0              0.017537042    0.0070346509   0              339.67811      1.1971759e-13  0              4.4409324    
   1100000   12727.922      200            200            0.0058790597   0.00015841416  0              0.017478765    0.0030620691   0              147.85636      1.1971759e-13  0              4.4409392    
   1200000   12727.922      200            200            0.005872917    0.00015863744  0              0.017460114    0.00072391711  0              34.955366      1.1971759e-13  0              4.4409414    
   1300000   12727.922      200            200            0.0058712554   0.000158699    0              0.017455067    0.0001238186   0              5.9787571      1.1971759e-13  0              4.440942     
   1400000   12727.922      200            200            0.0058709336   0.00015871127  0              0.01745409     1.6503468e-05  0              0.79689343     1.1971759e-13  0              4.4409421    
   1500000   12727.922      200            200            0.0058709346   0.00015871145  0              0.017454092    1.7112424e-06  0              0.082629773    1.1971759e-13  0              4.4409421    
   1600000   12727.922      200            200            0.0058709785   0.00015870993  0              0.017454226    1.2740632e-07  0              0.0061519953   1.1971759e-13  0              4.4409421    
   1700000   12727.922      200            200            0.0058710086   0.00015870886  0              0.017454317    4.9865493e-09  0              0.00024078262  1.1971759e-13  0              4.4409421    
   1800000   12727.922      200            200            0.0058710234   0.00015870832  0              0.017454362    6.5166989e-13  0              3.1466807e-08  1.1971759e-13  0              4.4409421    
   1900000   12727.922      200            200            0.0058710297   0.00015870809  0              0.017454381    7.944755e-11   0              3.8362379e-06  1.1971759e-13  0              4.440942     
   2000000   12727.922      200            200            0.0058710319   0.00015870801  0              0.017454388    3.9104105e-11  0              1.8881973e-06  1.1971759e-13  0              4.440942     
   2100000   12727.922      200            200            0.0058710327   0.00015870798  0              0.01745439     9.6967173e-12  0              4.6821977e-07  1.1971759e-13  0              4.440942     
   2200000   12727.922      200            200            0.0058710329   0.00015870798  0              0.017454391    1.7120923e-12  0              8.2670811e-08  1.1971759e-13  0              4.440942     
   2300000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    2.3486779e-13  0              1.1340925e-08  1.1971759e-13  0              4.440942     
   2400000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    2.5781065e-14  0              1.2448753e-09  1.1971759e-13  0              4.440942     
   2500000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    2.2675014e-15  0              1.0948953e-10  1.1971759e-13  0              4.440942     
   2600000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    2.873944e-17   0              1.3877247e-12  1.1971759e-13  0              4.440942     
   2700000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    7.0681799e-17  0              3.4129711e-12  1.1971759e-13  0              4.440942     
   2800000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    4.2864295e-19  0              2.0697634e-14  1.1971759e-13  0              4.440942     
   2900000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    4.4755437e-17  0              2.1610799e-12  1.1971759e-13  0              4.440942     
   3000000   12727.922      200            200            0.0058710329   0.00015870797  0              0.017454391    7.3818331e-18  0              3.564423e-13   1.1971759e-13  0              4.440942     
Loop time of 695.943 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3724444.819 ns/day, 0.000 hours/ns, 4310.700 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.35     | 237.05     | 294.43     | 371.8 | 34.06
Neigh   | 0.65643    | 0.67464    | 0.69261    |   1.8 |  0.10
Comm    | 22.808     | 80.732     | 138.08     | 636.6 | 11.60
Output  | 0.44591    | 0.44656    | 0.44722    |   0.1 |  0.06
Modify  | 201.98     | 271.68     | 341.07     | 418.7 | 39.04
Other   |            | 105.4      |            |       | 15.14

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:        1469.25 ave        2189 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5877
Ave neighs/atom = 1.175165
Neighbor list builds = 103
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.9                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 236.579624453927
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  binsize = 3, bins = 4243 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.88 | 33.89 | 33.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.5820023e-13  4.746007e-13   0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00056707718  4.746007e-13   0              0.0017012315   50081.014      0              2.4182329e+09  1.1971759e-13  0              4.8518948    
    200000   12727.922      200            200            0.0006803322   4.746007e-13   0              0.0020409966   77168.583      0              3.7261947e+09  1.1971759e-13  0              4.5146868    
    300000   12727.922      200            200            0.00012891097  4.746007e-13   0              0.00038673291  3624.1195      0              1.7499576e+08  1.1971759e-13  0              4.4686601    
    400000   12727.922      200            200            0.0050129125   0.00027529175  0              0.014763446    8434.6245      0              4.0727783e+08  1.1971759e-13  0              4.4462041    
    500000   12727.922      200            200            0.010652783   -0.00056294284  0              0.032521293    4.2001227      0              202808.89      1.1971759e-13  0              4.4444656    
    600000   12727.922      200            200            0.0073157705  -7.7177353e-05  0              0.022024489    36.586091      0              1766611.4      1.1971759e-13  0              4.4454505    
    700000   12727.922      200            200            0.0064454221   7.2608198e-05  0              0.019263658    1.2585504      0              60770.892      1.1971759e-13  0              4.4457421    
    800000   12727.922      200            200            0.0060925324   0.00013997446  0              0.018137623    0.025176751    0              1215.6952      1.1971759e-13  0              4.4458675    
    900000   12727.922      200            200            0.0059513691   0.0001621094   0              0.017691998    0.074759027    0              3609.8459      1.1971759e-13  0              4.4459184    
   1000000   12727.922      200            200            0.0059000499   0.00016605883  0              0.017534091    0.028149399    0              1359.2337      1.1971759e-13  0              4.4459367    
   1100000   12727.922      200            200            0.0058840059   0.00016619751  0              0.01748582     0.0060792255   0              293.54404      1.1971759e-13  0              4.4459424    
   1200000   12727.922      200            200            0.0058801236   0.00016633954  0              0.017474031    0.0009437481   0              45.570218      1.1971759e-13  0              4.4459438    
   1300000   12727.922      200            200            0.0058796059   0.00016635966  0              0.017472458    0.00011045067  0              5.3332674      1.1971759e-13  0              4.445944     
   1400000   12727.922      200            200            0.0058797733   0.00016635424  0              0.017472966    9.3162346e-06  0              0.44984763     1.1971759e-13  0              4.4459439    
   1500000   12727.922      200            200            0.005879957    0.00016634784  0              0.017473523    4.5361399e-07  0              0.021903396    1.1971759e-13  0              4.4459438    
   1600000   12727.922      200            200            0.0058800599   0.0001663442   0              0.017473836    2.5276833e-09  0              0.00012205278  1.1971759e-13  0              4.4459438    
   1700000   12727.922      200            200            0.0058801055   0.00016634257  0              0.017473974    3.1382193e-09  0              0.00015153338  1.1971759e-13  0              4.4459438    
   1800000   12727.922      200            200            0.0058801228   0.00016634195  0              0.017474027    2.0227043e-09  0              9.7669153e-05  1.1971759e-13  0              4.4459438    
   1900000   12727.922      200            200            0.0058801285   0.00016634175  0              0.017474044    5.373659e-10   0              2.5947476e-05  1.1971759e-13  0              4.4459438    
   2000000   12727.922      200            200            0.0058801301   0.00016634169  0              0.017474049    9.5795209e-11  0              4.6256078e-06  1.1971759e-13  0              4.4459438    
   2100000   12727.922      200            200            0.0058801304   0.00016634168  0              0.01747405     1.2755923e-11  0              6.1593788e-07  1.1971759e-13  0              4.4459438    
   2200000   12727.922      200            200            0.0058801304   0.00016634168  0              0.01747405     1.2674335e-12  0              6.1199827e-08  1.1971759e-13  0              4.4459438    
   2300000   12727.922      200            200            0.0058801304   0.00016634168  0              0.017474049    8.6302556e-14  0              4.1672416e-09  1.1971759e-13  0              4.4459438    
   2400000   12727.922      200            200            0.0058801303   0.00016634168  0              0.017474049    2.3441002e-15  0              1.1318821e-10  1.1971759e-13  0              4.4459438    
   2500000   12727.922      200            200            0.0058801303   0.00016634168  0              0.017474049    4.3786509e-18  0              2.1142938e-13  1.1971759e-13  0              4.4459438    
   2600000   12727.922      200            200            0.0058801303   0.00016634168  0              0.017474049    4.3621445e-16  0              2.1063235e-11  1.1971759e-13  0              4.4459438    
   2700000   12727.922      200            200            0.0058801303   0.00016634168  0              0.017474049    5.1902324e-18  0              2.5061775e-13  1.1971759e-13  0              4.4459438    
   2800000   12727.922      200            200            0.0058801303   0.00016634168  0              0.017474049    4.8522748e-18  0              2.3429898e-13  1.1971759e-13  0              4.4459438    
   2900000   12727.922      200            200            0.0058801303   0.00016634168  0              0.017474049    3.0229429e-17  0              1.4596709e-12  1.1971759e-13  0              4.4459438    
   3000000   12727.922      200            200            0.0058801303   0.00016634168  0              0.017474049    8.0600839e-18  0              3.8919261e-13  1.1971759e-13  0              4.4459438    
Loop time of 699.386 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3706107.358 ns/day, 0.000 hours/ns, 4289.476 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.94     | 237.77     | 295.39     | 371.6 | 34.00
Neigh   | 0.66582    | 0.68467    | 0.70316    |   1.8 |  0.10
Comm    | 23.909     | 81.572     | 138.97     | 632.2 | 11.66
Output  | 0.50465    | 0.50529    | 0.50594    |   0.1 |  0.07
Modify  | 203.94     | 274.05     | 342.69     | 413.8 | 39.18
Other   |            | 104.8      |            |       | 14.99

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1474.25 ave        2200 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5897
Ave neighs/atom = 1.1791642
Neighbor list builds = 105
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.91                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 237.784611742462
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.01
  ghost atom cutoff = 6.01
  binsize = 3.005, bins = 4236 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.84 | 33.85 | 33.86 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.5976942e-13  4.7930825e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00058549626  4.7930825e-13  0              0.0017564888   52983.563      0              2.5583867e+09  1.1971759e-13  0              4.8545911    
    200000   12727.922      200            200            0.000706981    4.7930825e-13  0              0.002120943    82444.31       0              3.9809407e+09  1.1971759e-13  0              4.516663     
    300000   12727.922      200            200            0.00015567122  4.7930825e-13  0              0.00046701366  5198.0031      0              2.5099297e+08  1.1971759e-13  0              4.4728457    
    400000   12727.922      200            200            0.0023212859   0.00021723314  0              0.0067466245   7485.7373      0              3.6145946e+08  1.1971759e-13  0              4.452387     
    500000   12727.922      200            200            0.010195751   -0.00057669845  0              0.03116395     191.43465      0              9243694.4      1.1971759e-13  0              4.4495814    
    600000   12727.922      200            200            0.0074827729  -0.00016677484  0              0.022615093    3.0888121      0              149147.68      1.1971759e-13  0              4.4503916    
    700000   12727.922      200            200            0.0064635232   7.5534893e-05  0              0.019315035    0.36719019     0              17730.3        1.1971759e-13  0              4.4507395    
    800000   12727.922      200            200            0.0060756399   0.00014801974  0              0.0180789      0.64156119     0              30978.694      1.1971759e-13  0              4.4508778    
    900000   12727.922      200            200            0.0059393537   0.00017003443  0              0.017648027    0.22914735     0              11064.705      1.1971759e-13  0              4.4509273    
   1000000   12727.922      200            200            0.0058976551   0.00017362014  0              0.017519345    0.047637172    0              2300.2285      1.1971759e-13  0              4.4509424    
   1100000   12727.922      200            200            0.0058879741   0.00017361552  0              0.017490307    0.0069381234   0              335.01715      1.1971759e-13  0              4.4509458    
   1200000   12727.922      200            200            0.0058872053   0.00017364694  0              0.017487969    0.00072755827  0              35.131185      1.1971759e-13  0              4.4509461    
   1300000   12727.922      200            200            0.00588797     0.00017362149  0              0.017490288    4.9557216e-05  0              2.3929406      1.1971759e-13  0              4.4509459    
   1400000   12727.922      200            200            0.0058885896   0.00017360011  0              0.017492169    1.2884092e-06  0              0.06221267     1.1971759e-13  0              4.4509457    
   1500000   12727.922      200            200            0.0058889055   0.0001735891   0              0.017493127    3.1626953e-08  0              0.0015271524   1.1971759e-13  0              4.4509456    
   1600000   12727.922      200            200            0.0058890356   0.00017358453  0              0.017493522    7.4150544e-08  0              0.0035804644   1.1971759e-13  0              4.4509455    
   1700000   12727.922      200            200            0.0058890811   0.00017358292  0              0.01749366     2.5598423e-08  0              0.0012360562   1.1971759e-13  0              4.4509455    
   1800000   12727.922      200            200            0.0058890944   0.00017358245  0              0.017493701    5.1119954e-09  0              0.00024683996  1.1971759e-13  0              4.4509455    
   1900000   12727.922      200            200            0.0058890972   0.00017358235  0              0.017493709    7.1893036e-10  0              3.4714574e-05  1.1971759e-13  0              4.4509455    
   2000000   12727.922      200            200            0.0058890974   0.00017358234  0              0.01749371     7.2465512e-11  0              3.4991002e-06  1.1971759e-13  0              4.4509455    
   2100000   12727.922      200            200            0.0058890971   0.00017358235  0              0.017493709    4.6338224e-12  0              2.237507e-07   1.1971759e-13  0              4.4509455    
   2200000   12727.922      200            200            0.0058890969   0.00017358236  0              0.017493708    9.6301964e-14  0              4.6500772e-09  1.1971759e-13  0              4.4509455    
   2300000   12727.922      200            200            0.0058890968   0.00017358236  0              0.017493708    6.0393563e-15  0              2.916189e-10   1.1971759e-13  0              4.4509455    
   2400000   12727.922      200            200            0.0058890967   0.00017358236  0              0.017493708    8.9869859e-15  0              4.3394939e-10  1.1971759e-13  0              4.4509455    
   2500000   12727.922      200            200            0.0058890967   0.00017358236  0              0.017493708    2.5380591e-15  0              1.2255379e-10  1.1971759e-13  0              4.4509455    
   2600000   12727.922      200            200            0.0058890967   0.00017358236  0              0.017493708    4.9908522e-16  0              2.4099039e-11  1.1971759e-13  0              4.4509455    
   2700000   12727.922      200            200            0.0058890967   0.00017358236  0              0.017493708    1.8119239e-17  0              8.7491322e-13  1.1971759e-13  0              4.4509455    
   2800000   12727.922      200            200            0.0058890967   0.00017358236  0              0.017493708    2.0738735e-17  0              1.0013993e-12  1.1971759e-13  0              4.4509455    
   2900000   12727.922      200            200            0.0058890967   0.00017358236  0              0.017493708    3.037398e-18   0              1.4666508e-13  1.1971759e-13  0              4.4509455    
   3000000   12727.922      200            200            0.0058890967   0.00017358237  0              0.017493708    8.3594521e-18  0              4.0364802e-13  1.1971759e-13  0              4.4509455    
Loop time of 697.123 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3718140.237 ns/day, 0.000 hours/ns, 4303.403 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.17     | 237.99     | 295.44     | 371.4 | 34.14
Neigh   | 0.65677    | 0.67557    | 0.69385    |   1.8 |  0.10
Comm    | 23.807     | 81.524     | 138.63     | 632.1 | 11.69
Output  | 0.43929    | 0.43993    | 0.44058    |   0.1 |  0.06
Modify  | 202.41     | 271.99     | 341.04     | 414.7 | 39.02
Other   |            | 104.5      |            |       | 14.99

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1480.25 ave        2212 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5921
Ave neighs/atom = 1.1839632
Neighbor list builds = 105
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.92                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 238.993683729766
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.02
  ghost atom cutoff = 6.02
  binsize = 3.01, bins = 4229 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.82 | 33.83 | 33.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.6134522e-13  4.8403567e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00060402503  4.8403567e-13  0              0.0018120751   55966.566      0              2.7024252e+09  1.1971759e-13  0              4.8572379    
    200000   12727.922      200            200            0.00073383096  4.8403567e-13  0              0.0022014929   87888.265      0              4.2438098e+09  1.1971759e-13  0              4.5185342    
    300000   12727.922      200            200            0.0001828007   4.8403567e-13  0              0.00054840211  7051.8794      0              3.4051002e+08  1.1971759e-13  0              4.4768839    
    400000   12727.922      200            200            0.00066677966 -4.8811117e-05  0              0.0020491501   5837.7242      0              2.8188281e+08  1.1971759e-13  0              4.4584684    
    500000   12727.922      200            200            0.0091747706  -0.00057419527  0              0.028098507    566.22287      0              27340876       1.1971759e-13  0              4.4548537    
    600000   12727.922      200            200            0.0074574894  -0.00016670396  0              0.022539172    7.5810696      0              366062.72      1.1971759e-13  0              4.4554011    
    700000   12727.922      200            200            0.0064002509   8.9268327e-05  0              0.019111484    5.0386116      0              243296.52      1.1971759e-13  0              4.455765     
    800000   12727.922      200            200            0.0060291138   0.00015801412  0              0.017929327    1.7338927      0              83723.472      1.1971759e-13  0              4.4558985    
    900000   12727.922      200            200            0.0059186541   0.00017880963  0              0.017577153    0.35911464     0              17340.361      1.1971759e-13  0              4.4559394    
   1000000   12727.922      200            200            0.0058937565   0.00018164451  0              0.017499625    0.050847418    0              2455.2398      1.1971759e-13  0              4.4559486    
   1100000   12727.922      200            200            0.0058923266   0.00018139892  0              0.017495581    0.0049318604   0              238.14189      1.1971759e-13  0              4.4559492    
   1200000   12727.922      200            200            0.0058948811   0.00018131276  0              0.017503331    0.00027656941  0              13.354547      1.1971759e-13  0              4.4559484    
   1300000   12727.922      200            200            0.0058967668   0.0001812476   0              0.017509053    2.8220534e-06  0              0.13626686     1.1971759e-13  0              4.4559477    
   1400000   12727.922      200            200            0.005897683    0.0001812157   0              0.017511833    1.2308277e-06  0              0.059432265    1.1971759e-13  0              4.4559474    
   1500000   12727.922      200            200            0.0058980416   0.00018120315  0              0.017512922    9.3273012e-07  0              0.0450382      1.1971759e-13  0              4.4559473    
   1600000   12727.922      200            200            0.005898158    0.00018119904  0              0.017513275    2.4580326e-07  0              0.01186896     1.1971759e-13  0              4.4559472    
   1700000   12727.922      200            200            0.0058981877   0.00018119798  0              0.017513365    4.0549081e-08  0              0.00195797     1.1971759e-13  0              4.4559472    
   1800000   12727.922      200            200            0.0058981918   0.00018119783  0              0.017513378    4.6106759e-09  0              0.00022263304  1.1971759e-13  0              4.4559472    
   1900000   12727.922      200            200            0.0058981906   0.00018119786  0              0.017513374    3.3528572e-10  0              1.6189747e-05  1.1971759e-13  0              4.4559472    
   2000000   12727.922      200            200            0.0058981892   0.00018119791  0              0.01751337     9.6921843e-12  0              4.6800089e-07  1.1971759e-13  0              4.4559472    
   2100000   12727.922      200            200            0.0058981885   0.00018119794  0              0.017513368    1.4244455e-13  0              6.8781374e-09  1.1971759e-13  0              4.4559472    
   2200000   12727.922      200            200            0.0058981882   0.00018119795  0              0.017513367    4.4761436e-13  0              2.1613696e-08  1.1971759e-13  0              4.4559472    
   2300000   12727.922      200            200            0.0058981881   0.00018119795  0              0.017513366    1.5898318e-13  0              7.6767286e-09  1.1971759e-13  0              4.4559472    
   2400000   12727.922      200            200            0.005898188    0.00018119795  0              0.017513366    3.081634e-14   0              1.4880108e-09  1.1971759e-13  0              4.4559472    
   2500000   12727.922      200            200            0.005898188    0.00018119795  0              0.017513366    4.0551767e-15  0              1.9580997e-10  1.1971759e-13  0              4.4559472    
   2600000   12727.922      200            200            0.005898188    0.00018119795  0              0.017513366    4.1826298e-17  0              2.0196422e-12  1.1971759e-13  0              4.4559472    
   2700000   12727.922      200            200            0.005898188    0.00018119795  0              0.017513366    8.6539415e-17  0              4.1786787e-12  1.1971759e-13  0              4.4559472    
   2800000   12727.922      200            200            0.005898188    0.00018119795  0              0.017513366    4.9379551e-17  0              2.3843618e-12  1.1971759e-13  0              4.4559472    
   2900000   12727.922      200            200            0.005898188    0.00018119795  0              0.017513366    7.2019403e-18  0              3.4775592e-13  1.1971759e-13  0              4.4559472    
   3000000   12727.922      200            200            0.005898188    0.00018119796  0              0.017513366    4.7039919e-18  0              2.2713893e-13  1.1971759e-13  0              4.4559472    
Loop time of 702.95 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3687315.610 ns/day, 0.000 hours/ns, 4267.726 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.6      | 239.34     | 298.9      | 378.7 | 34.05
Neigh   | 0.71015    | 0.72963    | 0.74858    |   1.8 |  0.10
Comm    | 24.981     | 83.115     | 142.33     | 637.7 | 11.82
Output  | 0.40312    | 0.40378    | 0.40443    |   0.1 |  0.06
Modify  | 200.62     | 272.29     | 344.5      | 422.3 | 38.73
Other   |            | 107.1      |            |       | 15.23

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1485.75 ave        2223 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5943
Ave neighs/atom = 1.1883623
Neighbor list builds = 111
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.93                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 240.206847327341
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.03
  ghost atom cutoff = 6.03
  binsize = 3.015, bins = 4222 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.78 | 33.78 | 33.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.6292766e-13  4.8878297e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00062266287  4.8878297e-13  0              0.0018679886   59029.92       0              2.8503436e+09  1.1971759e-13  0              4.859835     
    200000   12727.922      200            200            0.0007608798   4.8878297e-13  0              0.0022826394   93499.849      0              4.5147731e+09  1.1971759e-13  0              4.5203002    
    300000   12727.922      200            200            0.00021029505  4.8878297e-13  0              0.00063088516  9184.4398      0              4.4348373e+08  1.1971759e-13  0              4.4807741    
    400000   12727.922      200            200            8.5460533e-06  2.4400705e-05  0              1.2374545e-06  4065.8086      0              1.9632335e+08  1.1971759e-13  0              4.4643997    
    500000   12727.922      200            200            0.0078324137  -0.00044062932  0              0.023937871    946.40117      0              45698326       1.1971759e-13  0              4.4602484    
    600000   12727.922      200            200            0.0072203095  -0.00014764067  0              0.021808569    47.5271        0              2294913.6      1.1971759e-13  0              4.4604779    
    700000   12727.922      200            200            0.0062645832   0.00010682531  0              0.018686924    12.712664      0              613849.03      1.1971759e-13  0              4.4608154    
    800000   12727.922      200            200            0.0059612617   0.00016782061  0              0.017715965    2.6442247      0              127680.15      1.1971759e-13  0              4.4609267    
    900000   12727.922      200            200            0.0058942815   0.00018745265  0              0.017495392    0.37727449     0              18217.235      1.1971759e-13  0              4.4609528    
   1000000   12727.922      200            200            0.0058911978   0.00019087859  0              0.017482715    0.035425253    0              1710.5587      1.1971759e-13  0              4.4609546    
   1100000   12727.922      200            200            0.0058984071   0.00019040714  0              0.017504814    0.0017415744   0              84.094395      1.1971759e-13  0              4.4609522    
   1200000   12727.922      200            200            0.0059037965   0.00019022418  0              0.017521165    5.1257939e-06  0              0.24750624     1.1971759e-13  0              4.4609503    
   1300000   12727.922      200            200            0.0059063752   0.00019013654  0              0.017528989    1.6857303e-05  0              0.81397884     1.1971759e-13  0              4.4609494    
   1400000   12727.922      200            200            0.0059073526   0.00019010321  0              0.017531955    9.0645187e-06  0              0.43769317     1.1971759e-13  0              4.4609491    
   1500000   12727.922      200            200            0.0059076511   0.00019009295  0              0.01753286     2.0573231e-06  0              0.099340772    1.1971759e-13  0              4.460949     
   1600000   12727.922      200            200            0.0059077168   0.00019009065  0              0.01753306     2.9362383e-07  0              0.014178044    1.1971759e-13  0              4.4609489    
   1700000   12727.922      200            200            0.0059077201   0.00019009051  0              0.01753307     2.7188166e-08  0              0.0013128192   1.1971759e-13  0              4.4609489    
   1800000   12727.922      200            200            0.0059077135   0.00019009073  0              0.01753305     1.2986886e-09  0              6.2709023e-05  1.1971759e-13  0              4.4609489    
   1900000   12727.922      200            200            0.0059077087   0.00019009089  0              0.017533035    2.7033089e-12  0              1.3053311e-07  1.1971759e-13  0              4.4609489    
   2000000   12727.922      200            200            0.0059077064   0.00019009097  0              0.017533028    1.4056057e-11  0              6.7871667e-07  1.1971759e-13  0              4.4609489    
   2100000   12727.922      200            200            0.0059077055   0.000190091    0              0.017533026    7.2564311e-12  0              3.5038709e-07  1.1971759e-13  0              4.4609489    
   2200000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    1.6204756e-12  0              7.8246966e-08  1.1971759e-13  0              4.4609489    
   2300000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    2.2761034e-13  0              1.0990489e-08  1.1971759e-13  0              4.4609489    
   2400000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    2.0417906e-14  0              9.8590759e-10  1.1971759e-13  0              4.4609489    
   2500000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    1.0150473e-15  0              4.9013001e-11  1.1971759e-13  0              4.4609489    
   2600000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    1.9657319e-16  0              9.4918157e-12  1.1971759e-13  0              4.4609489    
   2700000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    1.7658788e-17  0              8.5267968e-13  1.1971759e-13  0              4.4609489    
   2800000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    1.2231427e-17  0              5.9061183e-13  1.1971759e-13  0              4.4609489    
   2900000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    2.7664974e-17  0              1.3358426e-12  1.1971759e-13  0              4.4609489    
   3000000   12727.922      200            200            0.0059077052   0.00019009101  0              0.017533025    2.0308927e-18  0              9.8064538e-14  1.1971759e-13  0              4.4609489    
Loop time of 694.338 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3733052.904 ns/day, 0.000 hours/ns, 4320.663 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.42     | 235.82     | 291.18     | 360.4 | 33.96
Neigh   | 0.66895    | 0.68807    | 0.70714    |   1.8 |  0.10
Comm    | 23.702     | 79.666     | 135.41     | 618.1 | 11.47
Output  | 0.43188    | 0.43251    | 0.43315    |   0.1 |  0.06
Modify  | 201.61     | 271.66     | 341.97     | 419.2 | 39.12
Other   |            | 106.1      |            |       | 15.28

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1432.25 ave        2116 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5729
Ave neighs/atom = 1.1455709
Neighbor list builds = 106
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.94                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 241.424109446694
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.04
  ghost atom cutoff = 6.04
  binsize = 3.02, bins = 4215 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.74 | 33.75 | 33.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.6451671e-13  4.9355012e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00064140923  4.9355012e-13  0              0.0019242277   62173.523      0              3.0021369e+09  1.1971759e-13  0              4.8623823    
    200000   12727.922      200            200            0.0007881253   4.9355012e-13  0              0.0023643759   99278.474      0              4.7938022e+09  1.1971759e-13  0              4.5219606    
    300000   12727.922      200            200            0.00023814998  4.9355012e-13  0              0.00071444995  11594.382      0              5.5985122e+08  1.1971759e-13  0              4.4845157    
    400000   12727.922      200            200           -0.00010061808  4.9355012e-13  0             -0.00030185425  2526.7835      0              1.2200933e+08  1.1971759e-13  0              4.4701585    
    500000   12727.922      200            200            0.0064954013   6.959947e-05   0              0.019416605    1165.3009      0              56268208       1.1971759e-13  0              4.4657184    
    600000   12727.922      200            200            0.0068121281  -0.00010999518  0              0.020546379    102.67812      0              4957958.8      1.1971759e-13  0              4.4656125    
    700000   12727.922      200            200            0.0060840169   0.00014351017  0              0.01810854     19.249733      0              929500.7       1.1971759e-13  0              4.465884     
    800000   12727.922      200            200            0.0058880772   0.00018844534  0              0.017475786    2.828584       0              136582.2       1.1971759e-13  0              4.4659583    
    900000   12727.922      200            200            0.0058723885   0.00019657078  0              0.017420595    0.27177302     0              13122.946      1.1971759e-13  0              4.4659655    
   1000000   12727.922      200            200            0.0058912233   0.00019784333  0              0.017475827    0.012981875    0              626.84828      1.1971759e-13  0              4.4659594    
   1100000   12727.922      200            200            0.0059058941   0.00019738336  0              0.017520299    1.7310999e-05  0              0.83588621     1.1971759e-13  0              4.4659544    
   1200000   12727.922      200            200            0.0059130188   0.00019714329  0              0.017541913    0.00015840645  0              7.6488803      1.1971759e-13  0              4.4659519    
   1300000   12727.922      200            200            0.0059156904   0.00019705362  0              0.017550018    7.6566838e-05  0              3.6971386      1.1971759e-13  0              4.465951     
   1400000   12727.922      200            200            0.0059164734   0.0001970272   0              0.017552393    1.6054447e-05  0              0.77521181     1.1971759e-13  0              4.4659507    
   1500000   12727.922      200            200            0.0059166246   0.00019702198  0              0.017552852    2.0566833e-06  0              0.099309874    1.1971759e-13  0              4.4659506    
   1600000   12727.922      200            200            0.0059166179   0.00019702213  0              0.017552832    1.5678534e-07  0              0.0075706028   1.1971759e-13  0              4.4659506    
   1700000   12727.922      200            200            0.0059165934   0.00019702292  0              0.017552757    4.2716846e-09  0              0.00020626436  1.1971759e-13  0              4.4659506    
   1800000   12727.922      200            200            0.0059165782   0.00019702342  0              0.017552711    1.1171325e-10  0              5.3942331e-06  1.1971759e-13  0              4.4659506    
   1900000   12727.922      200            200            0.0059165717   0.00019702363  0              0.017552691    2.4474236e-10  0              1.1817733e-05  1.1971759e-13  0              4.4659506    
   2000000   12727.922      200            200            0.0059165695   0.00019702371  0              0.017552685    7.6789943e-11  0              3.7079115e-06  1.1971759e-13  0              4.4659507    
   2100000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    1.3001652e-11  0              6.2780323e-07  1.1971759e-13  0              4.4659507    
   2200000   12727.922      200            200            0.0059165688   0.00019702373  0              0.017552683    1.3720956e-12  0              6.6253586e-08  1.1971759e-13  0              4.4659507    
   2300000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    7.6968015e-14  0              3.71651e-09    1.1971759e-13  0              4.4659507    
   2400000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    6.6146202e-16  0              3.1939634e-11  1.1971759e-13  0              4.4659507    
   2500000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    3.3264249e-16  0              1.6062116e-11  1.1971759e-13  0              4.4659507    
   2600000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    5.8222075e-16  0              2.8113356e-11  1.1971759e-13  0              4.4659507    
   2700000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    1.4676975e-18  0              7.0869861e-14  1.1971759e-13  0              4.4659507    
   2800000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    3.6145599e-17  0              1.7453416e-12  1.1971759e-13  0              4.4659507    
   2900000   12727.922      200            200            0.0059165689   0.00019702373  0              0.017552683    5.9824061e-19  0              2.8886898e-14  1.1971759e-13  0              4.4659507    
   3000000   12727.922      200            200            0.0059165689   0.00019702372  0              0.017552683    6.2742051e-18  0              3.0295891e-13  1.1971759e-13  0              4.4659507    
Loop time of 692.097 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3745137.609 ns/day, 0.000 hours/ns, 4334.650 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.11     | 235.84     | 291.78     | 360.1 | 34.08
Neigh   | 0.66388    | 0.68343    | 0.70266    |   1.8 |  0.10
Comm    | 23.026     | 79.531     | 134.94     | 618.3 | 11.49
Output  | 0.41888    | 0.41952    | 0.42016    |   0.1 |  0.06
Modify  | 202.21     | 270.83     | 339.21     | 415.5 | 39.13
Other   |            | 104.8      |            |       | 15.14

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1438.75 ave        2129 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5755
Ave neighs/atom = 1.1507698
Neighbor list builds = 104
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.95                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 242.645476999325
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.05
  ghost atom cutoff = 6.05
  binsize = 3.025, bins = 4208 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.7 | 33.71 | 33.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.6611237e-13  4.9833712e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00066026356  4.9833712e-13  0              0.0019807907   65397.284      0              3.1578008e+09  1.1971759e-13  0              4.8648794    
    200000   12727.922      200            200            0.00081556536  4.9833712e-13  0              0.0024466961   105223.58      0              5.0808702e+09  1.1971759e-13  0              4.5235147    
    300000   12727.922      200            200            0.00026636137  4.9833712e-13  0              0.00079908411  14280.422      0              6.8955045e+08  1.1971759e-13  0              4.488108     
    400000   12727.922      200            200           -7.4289588e-05  4.9833712e-13  0             -0.00022286876  1348.752       0              65126407       1.1971759e-13  0              4.4757389    
    500000   12727.922      200            200            0.0051631959   0.00030730442  0              0.015182283    1148.1971      0              55442328       1.1971759e-13  0              4.4712118    
    600000   12727.922      200            200            0.0063443502   7.8860237e-05  0              0.01895419     146.00216      0              7049921.6      1.1971759e-13  0              4.4707881    
    700000   12727.922      200            200            0.005885589    0.0001924892   0              0.017464278    21.197051      0              1023529.7      1.1971759e-13  0              4.4709615    
    800000   12727.922      200            200            0.0058212046   0.00021423502  0              0.017249379    2.1807218      0              105299.25      1.1971759e-13  0              4.4709886    
    900000   12727.922      200            200            0.0058589219   0.00020747524  0              0.017369291    0.11369585     0              5489.9657      1.1971759e-13  0              4.4709755    
   1000000   12727.922      200            200            0.0058964963   0.00020530036  0              0.017484189    0.00030429221  0              14.693182      1.1971759e-13  0              4.4709625    
   1100000   12727.922      200            200            0.005915911    0.0002047851   0              0.017542948    0.0011670616   0              56.353226      1.1971759e-13  0              4.4709558    
   1200000   12727.922      200            200            0.0059232789   0.00020453734  0              0.017565299    0.00058959104  0              28.469241      1.1971759e-13  0              4.4709532    
   1300000   12727.922      200            200            0.0059254099   0.0002044658   0              0.017571764    0.00012113552  0              5.8492009      1.1971759e-13  0              4.4709524    
   1400000   12727.922      200            200            0.0059257893   0.00020445276  0              0.017572915    1.4507613e-05  0              0.70052071     1.1971759e-13  0              4.4709523    
   1500000   12727.922      200            200            0.005925747    0.00020445395  0              0.017572787    9.3905297e-07  0              0.045343507    1.1971759e-13  0              4.4709523    
   1600000   12727.922      200            200            0.005925669    0.00020445646  0              0.017572551    1.2378486e-08  0              0.00059771277  1.1971759e-13  0              4.4709523    
   1700000   12727.922      200            200            0.0059256246   0.00020445792  0              0.017572416    3.4271186e-09  0              0.00016548329  1.1971759e-13  0              4.4709524    
   1800000   12727.922      200            200            0.0059256066   0.00020445851  0              0.017572361    2.7567445e-09  0              0.00013311332  1.1971759e-13  0              4.4709524    
   1900000   12727.922      200            200            0.0059256009   0.0002044587   0              0.017572344    6.6841998e-10  0              3.2275609e-05  1.1971759e-13  0              4.4709524    
   2000000   12727.922      200            200            0.0059255997   0.00020445874  0              0.01757234     9.1303814e-11  0              4.4087344e-06  1.1971759e-13  0              4.4709524    
   2100000   12727.922      200            200            0.0059255997   0.00020445874  0              0.01757234     7.1101962e-12  0              3.4332593e-07  1.1971759e-13  0              4.4709524    
   2200000   12727.922      200            200            0.0059255999   0.00020445874  0              0.017572341    1.8309162e-13  0              8.8408391e-09  1.1971759e-13  0              4.4709524    
   2300000   12727.922      200            200            0.0059256      0.00020445874  0              0.017572341    6.687447e-15   0              3.2291288e-10  1.1971759e-13  0              4.4709524    
   2400000   12727.922      200            200            0.0059256      0.00020445873  0              0.017572341    1.1617634e-14  0              5.6097399e-10  1.1971759e-13  0              4.4709524    
   2500000   12727.922      200            200            0.0059256      0.00020445873  0              0.017572341    3.3787788e-15  0              1.6314914e-10  1.1971759e-13  0              4.4709524    
   2600000   12727.922      200            200            0.0059256      0.00020445873  0              0.017572341    3.2772478e-16  0              1.5824657e-11  1.1971759e-13  0              4.4709524    
   2700000   12727.922      200            200            0.0059256      0.00020445873  0              0.017572341    5.351101e-17   0              2.5838552e-12  1.1971759e-13  0              4.4709524    
   2800000   12727.922      200            200            0.0059256      0.00020445873  0              0.017572341    2.1903119e-17  0              1.0576232e-12  1.1971759e-13  0              4.4709524    
   2900000   12727.922      200            200            0.0059256      0.00020445874  0              0.017572341    6.0384355e-18  0              2.9157444e-13  1.1971759e-13  0              4.4709524    
   3000000   12727.922      200            200            0.0059256      0.00020445873  0              0.017572341    7.8140736e-18  0              3.7731365e-13  1.1971759e-13  0              4.4709524    
Loop time of 694.273 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3733399.138 ns/day, 0.000 hours/ns, 4321.064 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.89     | 236.73     | 292.7      | 361.8 | 34.10
Neigh   | 0.66102    | 0.67982    | 0.69826    |   1.8 |  0.10
Comm    | 23.337     | 79.952     | 135.79     | 621.2 | 11.52
Output  | 0.44376    | 0.44441    | 0.44506    |   0.1 |  0.06
Modify  | 202.26     | 271.69     | 340.9      | 416.9 | 39.13
Other   |            | 104.8      |            |       | 15.09

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1445.75 ave        2143 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5783
Ave neighs/atom = 1.1563687
Neighbor list builds = 104
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.96                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 243.870956896739
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.06
  ghost atom cutoff = 6.06
  binsize = 3.03, bins = 4201 67 67
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.68 | 33.69 | 33.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.6771465e-13  5.0314394e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00067922523  5.0314394e-13  0              0.0020376757   68701.098      0              3.3173302e+09  1.1971759e-13  0              4.8673263    
    200000   12727.922      200            200            0.00084319765  5.0314394e-13  0              0.0025295929   111334.57      0              5.3759477e+09  1.1971759e-13  0              4.5249623    
    300000   12727.922      200            200            0.00029492481  5.0314394e-13  0              0.00088477444  17241.251      0              8.325183e+08   1.1971759e-13  0              4.4915505    
    400000   12727.922      200            200           -4.7460127e-05  5.0314394e-13  0             -0.00014238038  538.65755      0              26009846       1.1971759e-13  0              4.4811401    
    500000   12727.922      200            200            0.0039419679   0.00016858679  0              0.011657317    925.51119      0              44689623       1.1971759e-13  0              4.4766791    
    600000   12727.922      200            200            0.0058307486   0.00022895187  0              0.017263294    157.52945      0              7606533.4      1.1971759e-13  0              4.475983     
    700000   12727.922      200            200            0.0056894808   0.00022183979  0              0.016846602    17.598395      0              849763.5       1.1971759e-13  0              4.4760375    
    800000   12727.922      200            200            0.0057702246   0.00023618545  0              0.017074488    1.0897706      0              52621.122      1.1971759e-13  0              4.4760132    
    900000   12727.922      200            200            0.0058570619   0.0002173265   0              0.017353859    0.008914999    0              430.4734       1.1971759e-13  0              4.4759814    
   1000000   12727.922      200            200            0.0059079265   0.00021374806  0              0.017510031    0.0067440573   0              325.64639      1.1971759e-13  0              4.4759635    
   1100000   12727.922      200            200            0.0059284106   0.00021313724  0              0.017572095    0.0041952208   0              202.5722       1.1971759e-13  0              4.4759564    
   1200000   12727.922      200            200            0.0059344483   0.00021293937  0              0.017590405    0.00089842905  0              43.381924      1.1971759e-13  0              4.4759543    
   1300000   12727.922      200            200            0.0059355215   0.00021290359  0              0.017593661    0.00010565065  0              5.1014919      1.1971759e-13  0              4.4759539    
   1400000   12727.922      200            200            0.0059353907   0.00021290724  0              0.017593265    6.1696225e-06  0              0.29790899     1.1971759e-13  0              4.4759539    
   1500000   12727.922      200            200            0.0059351639   0.00021291434  0              0.017592577    3.7315679e-08  0              0.0018018406   1.1971759e-13  0              4.475954     
   1600000   12727.922      200            200            0.005935038    0.00021291835  0              0.017592196    4.4476963e-08  0              0.0021476334   1.1971759e-13  0              4.475954     
   1700000   12727.922      200            200            0.0059349887   0.00021291993  0              0.017592046    2.5394065e-08  0              0.0012261885   1.1971759e-13  0              4.4759541    
   1800000   12727.922      200            200            0.0059349744   0.00021292039  0              0.017592003    5.2636085e-09  0              0.00025416082  1.1971759e-13  0              4.4759541    
   1900000   12727.922      200            200            0.005934972    0.00021292048  0              0.017591996    6.0203834e-10  0              2.9070277e-05  1.1971759e-13  0              4.4759541    
   2000000   12727.922      200            200            0.0059349724   0.00021292046  0              0.017591997    3.3582194e-11  0              1.621564e-06   1.1971759e-13  0              4.4759541    
   2100000   12727.922      200            200            0.0059349729   0.00021292045  0              0.017591998    1.4098826e-13  0              6.8078187e-09  1.1971759e-13  0              4.4759541    
   2200000   12727.922      200            200            0.0059349733   0.00021292044  0              0.017591999    2.8974063e-13  0              1.3990538e-08  1.1971759e-13  0              4.4759541    
   2300000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       1.51441e-13    0              7.3125438e-09  1.1971759e-13  0              4.4759541    
   2400000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       3.0667076e-14  0              1.4808034e-09  1.1971759e-13  0              4.4759541    
   2500000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       3.6384274e-15  0              1.7568664e-10  1.1971759e-13  0              4.4759541    
   2600000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       1.4445048e-18  0              6.9749966e-14  1.1971759e-13  0              4.4759541    
   2700000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       7.6085519e-17  0              3.6738974e-12  1.1971759e-13  0              4.4759541    
   2800000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       1.8049512e-17  0              8.7154635e-13  1.1971759e-13  0              4.4759541    
   2900000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       1.2966715e-17  0              6.2611628e-13  1.1971759e-13  0              4.4759541    
   3000000   12727.922      200            200            0.0059349734   0.00021292043  0              0.017592       8.5075572e-18  0              4.1079949e-13  1.1971759e-13  0              4.4759541    
Loop time of 693.572 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3737172.746 ns/day, 0.000 hours/ns, 4325.431 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.69     | 235.97     | 292.38     | 365.0 | 34.02
Neigh   | 0.64126    | 0.6593     | 0.67718    |   1.8 |  0.10
Comm    | 23.429     | 80.495     | 136.47     | 623.0 | 11.61
Output  | 0.43785    | 0.43849    | 0.43912    |   0.1 |  0.06
Modify  | 200.54     | 270.61     | 340.42     | 420.3 | 39.02
Other   |            | 105.4      |            |       | 15.20

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           5 max           3 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:        1452.25 ave        2155 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5809
Ave neighs/atom = 1.1615677
Neighbor list builds = 100
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.97                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 245.100556050442
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.07
  ghost atom cutoff = 6.07
  binsize = 3.035, bins = 4194 66 66
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.06 | 33.07 | 33.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.6932353e-13  5.0797058e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00069829373  5.0797058e-13  0              0.0020948812   72084.875      0              3.4807206e+09  1.1971759e-13  0              4.8697227    
    200000   12727.922      200            200            0.00087102002  5.0797058e-13  0              0.0026130601   117610.86      0              5.6790076e+09  1.1971759e-13  0              4.5263028    
    300000   12727.922      200            200            0.00032383608  5.0797058e-13  0              0.00097150823  20475.58       0              9.8869246e+08  1.1971759e-13  0              4.4948426    
    400000   12727.922      200            200           -2.0135898e-05  5.0797058e-13  0             -6.0407695e-05  94.439805      0              4560160.2      1.1971759e-13  0              4.4863613    
    500000   12727.922      200            200            0.0030538897   0.00013398754  0              0.0090276814   595.89197      0              28773491       1.1971759e-13  0              4.4820785    
    600000   12727.922      200            200            0.0052997952   0.0002110955   0              0.01568829     133.23252      0              6433321.5      1.1971759e-13  0              4.481174     
    700000   12727.922      200            200            0.0055248688   0.00023560056  0              0.016339006    10.40205       0              502277.76      1.1971759e-13  0              4.4811021    
    800000   12727.922      200            200            0.0057436658   0.00025066841  0              0.016980329    0.20359948     0              9831.0903      1.1971759e-13  0              4.4810285    
    900000   12727.922      200            200            0.0058688079   0.00022596689  0              0.017380457    0.026947686    0              1301.2073      1.1971759e-13  0              4.4809825    
   1000000   12727.922      200            200            0.0059248233   0.00022232325  0              0.017552147    0.027230703    0              1314.8732      1.1971759e-13  0              4.4809627    
   1100000   12727.922      200            200            0.0059424611   0.00022174595  0              0.017605637    0.0065480245   0              316.18067      1.1971759e-13  0              4.4809565    
   1200000   12727.922      200            200            0.0059458427   0.00022163587  0              0.017615892    0.00080061478  0              38.658823      1.1971759e-13  0              4.4809553    
   1300000   12727.922      200            200            0.0059455822   0.00022164256  0              0.017615104    4.5977437e-05  0              2.2200859      1.1971759e-13  0              4.4809554    
   1400000   12727.922      200            200            0.0059449664   0.00022166145  0              0.017613238    1.8582536e-07  0              0.0089728418   1.1971759e-13  0              4.4809556    
   1500000   12727.922      200            200            0.0059446176   0.00022167234  0              0.01761218     4.1052708e-07  0              0.019822884    1.1971759e-13  0              4.4809557    
   1600000   12727.922      200            200            0.0059444828   0.00022167659  0              0.017611772    2.0897049e-07  0              0.010090437    1.1971759e-13  0              4.4809558    
   1700000   12727.922      200            200            0.0059444456   0.00022167777  0              0.017611659    3.9588206e-08  0              0.0019115728   1.1971759e-13  0              4.4809558    
   1800000   12727.922      200            200            0.0059444404   0.00022167794  0              0.017611643    3.9305134e-09  0              0.00018979042  1.1971759e-13  0              4.4809558    
   1900000   12727.922      200            200            0.0059444422   0.00022167789  0              0.017611649    1.5347859e-10  0              7.4109319e-06  1.1971759e-13  0              4.4809558    
   2000000   12727.922      200            200            0.0059444441   0.00022167784  0              0.017611654    4.7178838e-13  0              2.2780972e-08  1.1971759e-13  0              4.4809558    
   2100000   12727.922      200            200            0.0059444449   0.00022167781  0              0.017611657    4.3627524e-12  0              2.106617e-07   1.1971759e-13  0              4.4809558    
   2200000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    1.4620653e-12  0              7.05979e-08    1.1971759e-13  0              4.4809558    
   2300000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    2.2550195e-13  0              1.0888682e-08  1.1971759e-13  0              4.4809558    
   2400000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    1.8409353e-14  0              8.8892179e-10  1.1971759e-13  0              4.4809558    
   2500000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    6.405061e-16   0              3.0927747e-11  1.1971759e-13  0              4.4809558    
   2600000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    2.8126232e-16  0              1.3581151e-11  1.1971759e-13  0              4.4809558    
   2700000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    4.8816693e-18  0              2.3571834e-13  1.1971759e-13  0              4.4809558    
   2800000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    4.0389966e-17  0              1.9502869e-12  1.1971759e-13  0              4.4809558    
   2900000   12727.922      200            200            0.0059444453   0.0002216778   0              0.017611658    1.6866222e-20  0              8.144095e-16   1.1971759e-13  0              4.4809558    
   3000000   12727.922      200            200            0.0059444453   0.00022167779  0              0.017611658    5.9916075e-18  0              2.8931328e-13  1.1971759e-13  0              4.4809558    
Loop time of 694.504 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3732158.270 ns/day, 0.000 hours/ns, 4319.628 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.7      | 236.1      | 293.86     | 367.7 | 34.00
Neigh   | 0.63551    | 0.65316    | 0.67092    |   1.8 |  0.09
Comm    | 24.891     | 81.101     | 139.94     | 621.5 | 11.68
Output  | 0.47126    | 0.47191    | 0.47257    |   0.1 |  0.07
Modify  | 200.24     | 271.06     | 339.74     | 415.6 | 39.03
Other   |            | 105.1      |            |       | 15.14

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1458.25 ave        2168 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5833
Ave neighs/atom = 1.1663667
Neighbor list builds = 102
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.98                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 246.334281371935
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.08
  ghost atom cutoff = 6.08
  binsize = 3.04, bins = 4187 66 66
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.03 | 33.04 | 33.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.70939e-13    5.1281701e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00071746841  5.1281701e-13  0              0.0021524052   75548.509      0              3.6479671e+09  1.1971759e-13  0              4.8720685    
    200000   12727.922      200            200            0.00089903018  5.1281701e-13  0              0.0026970905   124051.87      0              5.9900207e+09  1.1971759e-13  0              4.5275359    
    300000   12727.922      200            200            0.00035309079  5.1281701e-13  0              0.0010592724   23982.105      0              1.15801e+09    1.1971759e-13  0              4.4979836    
    400000   12727.922      200            200            7.6768052e-06  5.1281701e-13  0              2.3030415e-05  14.044232      0              678145.7       1.1971759e-13  0              4.491402     
    500000   12727.922      200            200            0.0024815855   0.00014412536  0              0.007300631    275.21966      0              13289372       1.1971759e-13  0              4.4873781    
    600000   12727.922      200            200            0.0048714555   0.00021882666  0              0.01439554     85.267357      0              4117255.5      1.1971759e-13  0              4.4863393    
    700000   12727.922      200            200            0.0054258201   0.0002714621   0              0.016005998    3.3500504      0              161761.95      1.1971759e-13  0              4.4861467    
    800000   12727.922      200            200            0.0057480556   0.0002601916   0              0.016983975    0.043896462    0              2119.6031      1.1971759e-13  0              4.4860324    
    900000   12727.922      200            200            0.0058939024   0.00023373104  0              0.017447976    0.15433779     0              7452.4194      1.1971759e-13  0              4.4859788    
   1000000   12727.922      200            200            0.0059455784   0.00023063223  0              0.017606103    0.046132867    0              2227.591       1.1971759e-13  0              4.4859605    
   1100000   12727.922      200            200            0.0059569228   0.00023026991  0              0.017640498    0.0062527222   0              301.92158      1.1971759e-13  0              4.4859565    
   1200000   12727.922      200            200            0.0059568654   0.00023026769  0              0.017640329    0.0003876018   0              18.715904      1.1971759e-13  0              4.4859564    
   1300000   12727.922      200            200            0.0059553087   0.00023031424  0              0.017635612    2.1622803e-06  0              0.10440878     1.1971759e-13  0              4.485957     
   1400000   12727.922      200            200            0.0059543619   0.00023034318  0              0.017632742    3.0218579e-06  0              0.1459147      1.1971759e-13  0              4.4859573    
   1500000   12727.922      200            200            0.0059539899   0.00023035468  0              0.017631615    1.5962896e-06  0              0.077079111    1.1971759e-13  0              4.4859574    
   1600000   12727.922      200            200            0.0059538887   0.00023035786  0              0.017631308    2.9356557e-07  0              0.014175231    1.1971759e-13  0              4.4859575    
   1700000   12727.922      200            200            0.0059538766   0.00023035826  0              0.017631271    2.6531597e-08  0              0.0012811159   1.1971759e-13  0              4.4859575    
   1800000   12727.922      200            200            0.0059538827   0.00023035808  0              0.01763129     7.4210891e-10  0              3.5833783e-05  1.1971759e-13  0              4.4859575    
   1900000   12727.922      200            200            0.0059538881   0.00023035791  0              0.017631306    2.639313e-11   0              1.2744298e-06  1.1971759e-13  0              4.4859575    
   2000000   12727.922      200            200            0.0059538905   0.00023035784  0              0.017631314    4.6300047e-11  0              2.2356635e-06  1.1971759e-13  0              4.4859575    
   2100000   12727.922      200            200            0.0059538913   0.00023035781  0              0.017631316    1.2141937e-11  0              5.8629071e-07  1.1971759e-13  0              4.4859575    
   2200000   12727.922      200            200            0.0059538915   0.00023035781  0              0.017631317    1.4980089e-12  0              7.2333487e-08  1.1971759e-13  0              4.4859575    
   2300000   12727.922      200            200            0.0059538915   0.00023035781  0              0.017631317    7.8768366e-14  0              3.8034425e-09  1.1971759e-13  0              4.4859575    
   2400000   12727.922      200            200            0.0059538915   0.00023035781  0              0.017631317    7.4026246e-17  0              3.5744625e-12  1.1971759e-13  0              4.4859575    
   2500000   12727.922      200            200            0.0059538914   0.00023035781  0              0.017631317    8.4010188e-16  0              4.0565513e-11  1.1971759e-13  0              4.4859575    
   2600000   12727.922      200            200            0.0059538914   0.00023035781  0              0.017631316    5.7189516e-16  0              2.7614771e-11  1.1971759e-13  0              4.4859575    
   2700000   12727.922      200            200            0.0059538914   0.00023035781  0              0.017631317    1.5839716e-17  0              7.6484321e-13  1.1971759e-13  0              4.4859575    
   2800000   12727.922      200            200            0.0059538914   0.00023035781  0              0.017631316    4.8968862e-19  0              2.3645311e-14  1.1971759e-13  0              4.4859575    
   2900000   12727.922      200            200            0.0059538914   0.00023035781  0              0.017631316    5.7949409e-17  0              2.7981696e-12  1.1971759e-13  0              4.4859575    
   3000000   12727.922      200            200            0.0059538914   0.00023035781  0              0.017631316    4.1199053e-18  0              1.9893548e-13  1.1971759e-13  0              4.4859575    
Loop time of 692.398 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3743512.800 ns/day, 0.000 hours/ns, 4332.769 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.88     | 236.45     | 292.91     | 366.9 | 34.15
Neigh   | 0.62323    | 0.64109    | 0.65901    |   1.8 |  0.09
Comm    | 23.298     | 80.433     | 136.84     | 627.3 | 11.62
Output  | 0.44751    | 0.44815    | 0.44879    |   0.1 |  0.06
Modify  | 200.59     | 269.82     | 338.3      | 416.0 | 38.97
Other   |            | 104.6      |            |       | 15.11

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1464.75 ave        2181 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5859
Ave neighs/atom = 1.1715657
Neighbor list builds = 100
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(200*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 5.99                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 247.572139772725
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.09
  ghost atom cutoff = 6.09
  binsize = 3.045, bins = 4180 66 66
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.99 | 33 | 33.01 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            1.7256108e-13  5.1768324e-13  0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00073674873  5.1768324e-13  0              0.0022102462   79091.909      0              3.8190653e+09  1.1971759e-13  0              4.8743635    
    200000   12727.922      200            200            0.00092722592  5.1768324e-13  0              0.0027816778   130657.02      0              6.3089597e+09  1.1971759e-13  0              4.528661     
    300000   12727.922      200            200            0.00038268476  5.1768324e-13  0              0.0011480543   27759.546      0              1.3404091e+09  1.1971759e-13  0              4.5009728    
    400000   12727.922      200            200            3.5971856e-05  5.1768324e-13  0              0.00010791557  295.42013      0              14264781       1.1971759e-13  0              4.4962614    
    500000   12727.922      200            200            0.002206501    0.0002231307   0              0.0063963724   58.742478      0              2836464        1.1971759e-13  0              4.4925564    
    600000   12727.922      200            200            0.0045677707   0.00020510634  0              0.013498206    35.11805       0              1695725        1.1971759e-13  0              4.4914607    
    700000   12727.922      200            200            0.0053900866   0.00028078433  0              0.015889475    0.039077649    0              1886.9198      1.1971759e-13  0              4.4911657    
    800000   12727.922      200            200            0.0057843774   0.00026498392  0              0.017088148    0.69873377     0              33739.353      1.1971759e-13  0              4.4910246    
    900000   12727.922      200            200            0.00592873     0.00023803373  0              0.017548156    0.30367766     0              14663.507      1.1971759e-13  0              4.4909713    
   1000000   12727.922      200            200            0.0059668857   0.00023556765  0              0.017665089    0.049076202    0              2369.7142      1.1971759e-13  0              4.4909577    
   1100000   12727.922      200            200            0.0059695918   0.00023547491  0              0.0176733      0.0035628155   0              172.03561      1.1971759e-13  0              4.4909567    
   1200000   12727.922      200            200            0.0059660404   0.00023557905  0              0.017662542    3.9562835e-05  0              1.9103477      1.1971759e-13  0              4.4909578    
   1300000   12727.922      200            200            0.0059635374   0.00023565489  0              0.017654957    1.7727094e-05  0              0.85597791     1.1971759e-13  0              4.4909587    
   1400000   12727.922      200            200            0.0059625041   0.00023568669  0              0.017651826    1.144518e-05   0              0.55264677     1.1971759e-13  0              4.4909591    
   1500000   12727.922      200            200            0.0059622166   0.00023569567  0              0.017650954    2.1784654e-06  0              0.1051903      1.1971759e-13  0              4.4909592    
   1600000   12727.922      200            200            0.0059621817   0.00023569682  0              0.017650848    1.9058835e-07  0              0.0092028293   1.1971759e-13  0              4.4909592    
   1700000   12727.922      200            200            0.0059621992   0.0002356963   0              0.017650901    4.2746073e-09  0              0.00020640549  1.1971759e-13  0              4.4909592    
   1800000   12727.922      200            200            0.0059622144   0.00023569584  0              0.017650947    3.652997e-10   0              1.7639015e-05  1.1971759e-13  0              4.4909592    
   1900000   12727.922      200            200            0.0059622213   0.00023569563  0              0.017650968    4.1192927e-10  0              1.989059e-05   1.1971759e-13  0              4.4909592    
   2000000   12727.922      200            200            0.0059622234   0.00023569556  0              0.017650974    9.3692792e-11  0              4.5240896e-06  1.1971759e-13  0              4.4909592    
   2100000   12727.922      200            200            0.0059622237   0.00023569555  0              0.017650976    9.7128851e-12  0              4.6900046e-07  1.1971759e-13  0              4.4909592    
   2200000   12727.922      200            200            0.0059622236   0.00023569556  0              0.017650975    3.3875377e-13  0              1.6357207e-08  1.1971759e-13  0              4.4909592    
   2300000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    5.1789934e-15  0              2.5007506e-10  1.1971759e-13  0              4.4909592    
   2400000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    1.4593199e-14  0              7.0465333e-10  1.1971759e-13  0              4.4909592    
   2500000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    3.8867961e-15  0              1.8767948e-10  1.1971759e-13  0              4.4909592    
   2600000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    1.4841512e-16  0              7.1664352e-12  1.1971759e-13  0              4.4909592    
   2700000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    8.4105988e-17  0              4.0611771e-12  1.1971759e-13  0              4.4909592    
   2800000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    1.6721439e-19  0              8.0741845e-15  1.1971759e-13  0              4.4909592    
   2900000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    3.0257161e-17  0              1.46101e-12    1.1971759e-13  0              4.4909592    
   3000000   12727.922      200            200            0.0059622235   0.00023569556  0              0.017650975    1.8328234e-18  0              8.850048e-14   1.1971759e-13  0              4.4909592    
Loop time of 695.755 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3725447.362 ns/day, 0.000 hours/ns, 4311.860 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.38     | 236.44     | 293.87     | 368.7 | 33.98
Neigh   | 0.64391    | 0.66202    | 0.68015    |   1.8 |  0.10
Comm    | 24.423     | 80.999     | 139        | 626.8 | 11.64
Output  | 0.45342    | 0.45406    | 0.4547     |   0.1 |  0.07
Modify  | 201.08     | 271.57     | 341.1      | 418.0 | 39.03
Other   |            | 105.6      |            |       | 15.18

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           4.25 ave           6 max           3 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:        1470.25 ave        2192 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5881
Ave neighs/atom = 1.1759648
Neighbor list builds = 102
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 19:20:39

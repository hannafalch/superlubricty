LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.003 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4106 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 84.53 | 84.56 | 84.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0031900369   1.5672759e-46  0              0.0095701108   583701.27      0              5.6369691e+10  1.1965779e-13  0              3.3276395    
    200000   6363.961       200            200            0.0011191705   2.1076267e-41  0              0.0033575116   140074.29      0              1.3527373e+10  1.1965779e-13  0              3.076224     
    300000   6363.961       200            200            6.0779916e-05 -5.077221e-35   0              0.00018233975  866.61424      0              83691400       1.1965779e-13  0              3.0454899    
    400000   6363.961       200            200            0.00016740651 -7.615915e-35   0              0.00050221953  5990.6498      0              5.7853408e+08  1.1965779e-13  0              3.0010204    
    500000   6363.961       200            200            0.00076075288 -0.00025478339  0              0.002537042    403.89098      0              39004899       1.1965779e-13  0              2.9978269    
    600000   6363.961       200            200            0.0023471316  -0.002401275    0              0.0094426697   158.49071      0              15305898       1.1965779e-13  0              2.9957225    
    700000   6363.961       200            200            0.003609145   -0.0027939709   0              0.013621406    0.00015190424  0              14.669824      1.1965779e-13  0              2.9948351    
    800000   6363.961       200            200            0.0028566185  -0.0028011027   0              0.011370958    2.3658711      0              228478.9       1.1965779e-13  0              2.9952824    
    900000   6363.961       200            200            0.0029743032  -0.0027943934   0              0.011717303    0.47711998     0              46076.832      1.1965779e-13  0              2.9952133    
   1000000   6363.961       200            200            0.0030230242  -0.0027909039   0              0.011859977    0.0099710799   0              962.93552      1.1965779e-13  0              2.995183     
   1100000   6363.961       200            200            0.002987239   -0.002788032    0              0.011749749    0.0023766102   0              229.516        1.1965779e-13  0              2.9952057    
   1200000   6363.961       200            200            0.0029968677  -0.0027889624   0              0.011779565    0.001235163    0              119.2832       1.1965779e-13  0              2.9951997    
   1300000   6363.961       200            200            0.0029973754  -0.0027890223   0              0.011781148    8.2156117e-05  0              7.9340498      1.1965779e-13  0              2.9951993    
   1400000   6363.961       200            200            0.002995852   -0.0027888678   0              0.011776424    4.9690892e-07  0              0.047987907    1.1965779e-13  0              2.9952003    
   1500000   6363.961       200            200            0.0029964616  -0.0027889284   0              0.011778313    2.3583719e-06  0              0.22775468     1.1965779e-13  0              2.9951999    
   1600000   6363.961       200            200            0.0029963957  -0.0027889222   0              0.011778109    3.4615286e-07  0              0.033428966    1.1965779e-13  0              2.9951999    
   1700000   6363.961       200            200            0.0029963428  -0.0027889168   0              0.011777945    2.9994655e-09  0              0.00028966691  1.1965779e-13  0              2.9952       
   1800000   6363.961       200            200            0.0029963752  -0.00278892     0              0.011778046    3.0196827e-09  0              0.00029161934  1.1965779e-13  0              2.9951999    
   1900000   6363.961       200            200            0.0029963679  -0.0027889193   0              0.011778023    1.0136517e-09  0              9.7891222e-05  1.1965779e-13  0              2.9951999    
   2000000   6363.961       200            200            0.0029963668  -0.0027889192   0              0.01177802     4.5674466e-11  0              4.410913e-06   1.1965779e-13  0              2.9951999    
   2100000   6363.961       200            200            0.0029963683  -0.0027889193   0              0.011778024    1.6510877e-12  0              1.5945023e-07  1.1965779e-13  0              2.9951999    
   2200000   6363.961       200            200            0.0029963678  -0.0027889193   0              0.011778023    2.200729e-12   0              2.1253065e-07  1.1965779e-13  0              2.9951999    
   2300000   6363.961       200            200            0.0029963678  -0.0027889193   0              0.011778023    2.3685315e-13  0              2.2873582e-08  1.1965779e-13  0              2.9951999    
   2400000   6363.961       200            200            0.0029963679  -0.0027889193   0              0.011778023    2.8449357e-16  0              2.7474353e-11  1.1965779e-13  0              2.9951999    
   2500000   6363.961       200            200            0.0029963678  -0.0027889193   0              0.011778023    3.3166533e-15  0              3.2029863e-10  1.1965779e-13  0              2.9951999    
   2600000   6363.961       200            200            0.0029963679  -0.0027889193   0              0.011778023    7.8266145e-16  0              7.558384e-11   1.1965779e-13  0              2.9951999    
   2700000   6363.961       200            200            0.0029963679  -0.0027889193   0              0.011778023    2.1743188e-17  0              2.0998015e-12  1.1965779e-13  0              2.9951999    
   2800000   6363.961       200            200            0.0029963679  -0.0027889193   0              0.011778023    2.5213951e-19  0              2.4349829e-14  1.1965779e-13  0              2.9951999    
   2900000   6363.961       200            200            0.0029963679  -0.0027889193   0              0.011778023    4.5879052e-18  0              4.4306705e-13  1.1965779e-13  0              2.9951999    
   3000000   6363.961       200            200            0.0029963679  -0.0027889193   0              0.011778023    4.2797368e-18  0              4.1330635e-13  1.1965779e-13  0              2.9951999    
Loop time of 311.081 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8332232.684 ns/day, 0.000 hours/ns, 9643.788 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.327     | 40.328     | 70.017     | 449.7 | 12.96
Neigh   | 3.4613     | 3.4861     | 3.5075     |   0.9 |  1.12
Comm    | 16.318     | 21.303     | 25.002     |  81.7 |  6.85
Output  | 0.24111    | 0.24148    | 0.24191    |   0.1 |  0.08
Modify  | 180.25     | 186.33     | 193.05     |  39.6 | 59.90
Other   |            | 59.39      |            |       | 19.09

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.25 ave         687 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1373
Ave neighs/atom = 0.54898041
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.01                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.4138228207373
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.11
  ghost atom cutoff = 3.11
  binsize = 1.555, bins = 4093 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.32 | 83.33 | 83.33 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0031993863  -3.3002433e-34  0              0.009598159    585985.55      0              5.659029e+10   1.1965779e-13  0              3.3278778    
    200000   6363.961       200            200            0.0011327053   2.5386518e-34  0              0.0033981159   142544.43      0              1.3765921e+10  1.1965779e-13  0              3.0780905    
    300000   6363.961       200            200            7.1052312e-05 -2.3799843e-36  0              0.00021315694  1166.3987      0              1.1264243e+08  1.1965779e-13  0              3.050183     
    400000   6363.961       200            200            0.00017965571  1.7770589e-34  0              0.00053896714  6798.3489      0              6.5653587e+08  1.1965779e-13  0              3.0051847    
    500000   6363.961       200            200            0.00097978071 -0.00028241924  0              0.0032217614   612.73282      0              59173350       1.1965779e-13  0              3.002556     
    600000   6363.961       200            200            0.0026212624  -0.0025060524   0              0.01036984     191.27194      0              18471674       1.1965779e-13  0              3.0005239    
    700000   6363.961       200            200            0.0035926328  -0.0027901678   0              0.013568066    2.0771063      0              200592.06      1.1965779e-13  0              2.9998523    
    800000   6363.961       200            200            0.0028179336  -0.0027993232   0              0.011253124    1.2001087      0              115897.91      1.1965779e-13  0              3.0003154    
    900000   6363.961       200            200            0.0030116038  -0.0027892729   0              0.011824084    0.50534128     0              48802.244      1.1965779e-13  0              3.0001994    
   1000000   6363.961       200            200            0.0030241902  -0.0027866492   0              0.01185922     0.035322939    0              3411.2367      1.1965779e-13  0              3.0001911    
   1100000   6363.961       200            200            0.002993626   -0.002784262    0              0.01176514     5.5081779e-05  0              5.3194039      1.1965779e-13  0              3.0002106    
   1200000   6363.961       200            200            0.0030064117  -0.0027855009   0              0.011804736    0.00083015318  0              80.170252      1.1965779e-13  0              3.0002025    
   1300000   6363.961       200            200            0.0030044873  -0.0027853172   0              0.011798779    0.00015775681  0              15.235024      1.1965779e-13  0              3.0002037    
   1400000   6363.961       200            200            0.00300367    -0.0027852332   0              0.011796243    4.1129496e-06  0              0.39719923     1.1965779e-13  0              3.0002042    
   1500000   6363.961       200            200            0.0030043143  -0.0027852973   0              0.01179824     5.4569225e-07  0              0.052699052    1.1965779e-13  0              3.0002038    
   1600000   6363.961       200            200            0.0030041212  -0.0027852784   0              0.011797642    3.8584182e-07  0              0.037261841    1.1965779e-13  0              3.0002039    
   1700000   6363.961       200            200            0.0030041252  -0.0027852787   0              0.011797654    3.7172979e-08  0              0.0035899002   1.1965779e-13  0              3.0002039    
   1800000   6363.961       200            200            0.0030041494  -0.0027852811   0              0.011797729    4.9141977e-11  0              4.7457804e-06  1.1965779e-13  0              3.0002039    
   1900000   6363.961       200            200            0.0030041375  -0.0027852799   0              0.011797692    5.1503949e-10  0              4.9738827e-05  1.1965779e-13  0              3.0002039    
   2000000   6363.961       200            200            0.0030041398  -0.0027852801   0              0.0117977      1.3521892e-10  0              1.3058475e-05  1.1965779e-13  0              3.0002039    
   2100000   6363.961       200            200            0.0030041403  -0.0027852802   0              0.011797701    5.827893e-12   0              5.6281619e-07  1.1965779e-13  0              3.0002039    
   2200000   6363.961       200            200            0.0030041398  -0.0027852801   0              0.011797699    1.857925e-13   0              1.794251e-08   1.1965779e-13  0              3.0002039    
   2300000   6363.961       200            200            0.00300414    -0.0027852802   0              0.0117977      2.7900746e-13  0              2.6944544e-08  1.1965779e-13  0              3.0002039    
   2400000   6363.961       200            200            0.0030041399  -0.0027852802   0              0.0117977      3.6198061e-14  0              3.4957496e-09  1.1965779e-13  0              3.0002039    
   2500000   6363.961       200            200            0.0030041399  -0.0027852802   0              0.0117977      3.2290119e-16  0              3.1183485e-11  1.1965779e-13  0              3.0002039    
   2600000   6363.961       200            200            0.0030041399  -0.0027852802   0              0.0117977      3.3843506e-16  0              3.2683636e-11  1.1965779e-13  0              3.0002039    
   2700000   6363.961       200            200            0.0030041399  -0.0027852802   0              0.0117977      1.0837524e-16  0              1.0466105e-11  1.1965779e-13  0              3.0002039    
   2800000   6363.961       200            200            0.0030041399  -0.0027852802   0              0.0117977      7.1973761e-18  0              6.9507107e-13  1.1965779e-13  0              3.0002039    
   2900000   6363.961       200            200            0.0030041399  -0.0027852802   0              0.0117977      1.1710323e-18  0              1.1308991e-13  1.1965779e-13  0              3.0002039    
   3000000   6363.961       200            200            0.0030041399  -0.0027852802   0              0.0117977      3.5237412e-18  0              3.402977e-13   1.1965779e-13  0              3.0002039    
Loop time of 295.169 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8781403.895 ns/day, 0.000 hours/ns, 10163.662 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.311     | 39.455     | 67.404     | 443.4 | 13.37
Neigh   | 3.4769     | 3.5013     | 3.5252     |   0.9 |  1.19
Comm    | 16.11      | 21.055     | 25.745     |  83.8 |  7.13
Output  | 0.24102    | 0.24137    | 0.24177    |   0.1 |  0.08
Modify  | 170.62     | 175.07     | 179.23     |  28.9 | 59.31
Other   |            | 55.84      |            |       | 18.92

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         345.75 ave         692 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1383
Ave neighs/atom = 0.55297881
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.02                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.7279587335909
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.12
  ghost atom cutoff = 3.12
  binsize = 1.56, bins = 4080 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.05 | 83.05 | 83.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032087379   1.2693313e-35  0              0.0096262137   588273.22      0              5.6811217e+10  1.1965779e-13  0              3.3281048    
    200000   6363.961       200            200            0.0011462857   5.0773209e-35  0              0.003438857    145033.99      0              1.4006345e+10  1.1965779e-13  0              3.0799266    
    300000   6363.961       200            200            8.1456995e-05 -2.5386079e-35  0              0.00024437098  1510.2119      0              1.4584546e+08  1.1965779e-13  0              3.0548305    
    400000   6363.961       200            200            0.00027671682 -2.9184679e-06  0              0.00083306893  7650.5308      0              7.3883351e+08  1.1965779e-13  0              3.009295     
    500000   6363.961       200            200            0.0012406718  -0.00042066032  0              0.0041426756   841.1331       0              81230614       1.1965779e-13  0              3.00723      
    600000   6363.961       200            200            0.0029263893  -0.002626362    0              0.01140553     208.62565      0              20147572       1.1965779e-13  0              3.005311     
    700000   6363.961       200            200            0.0035325405  -0.0027844366   0              0.013382058    7.6098135      0              734901.32      1.1965779e-13  0              3.004895     
    800000   6363.961       200            200            0.002799718   -0.0027886402   0              0.011187794    0.30199898     0              29164.9        1.1965779e-13  0              3.0053376    
    900000   6363.961       200            200            0.0030475012  -0.0027853322   0              0.011927836    0.40748401     0              39351.889      1.1965779e-13  0              3.0051861    
   1000000   6363.961       200            200            0.0030214791  -0.0027838671   0              0.011848305    0.059969564    0              5791.4312      1.1965779e-13  0              3.0052012    
   1100000   6363.961       200            200            0.0030015538  -0.0027824287   0              0.01178709     0.0012446516   0              120.19954      1.1965779e-13  0              3.0052141    
   1200000   6363.961       200            200            0.0030148281  -0.0027837191   0              0.011828204    0.00024089389  0              23.263808      1.1965779e-13  0              3.0052057    
   1300000   6363.961       200            200            0.0030109203  -0.0027833382   0              0.011816099    0.00015487661  0              14.956875      1.1965779e-13  0              3.0052081    
   1400000   6363.961       200            200            0.003011067   -0.0027833494   0              0.01181655     1.6585156e-05  0              1.6016756      1.1965779e-13  0              3.005208     
   1500000   6363.961       200            200            0.0030115213  -0.0027833949   0              0.011817959    1.1523693e-07  0              0.011128758    1.1965779e-13  0              3.0052077    
   1600000   6363.961       200            200            0.0030112765  -0.0027833708   0              0.0118172      1.4509632e-07  0              0.014012364    1.1965779e-13  0              3.0052079    
   1700000   6363.961       200            200            0.0030113365  -0.0027833766   0              0.011817386    5.4970183e-08  0              0.0053086268   1.1965779e-13  0              3.0052079    
   1800000   6363.961       200            200            0.0030113398  -0.002783377    0              0.011817396    4.1968708e-09  0              0.00040530374  1.1965779e-13  0              3.0052079    
   1900000   6363.961       200            200            0.0030113301  -0.002783376    0              0.011817366    2.310153e-13   0              2.2309804e-08  1.1965779e-13  0              3.0052079    
   2000000   6363.961       200            200            0.0030113344  -0.0027833765   0              0.01181738     7.2188277e-11  0              6.9714271e-06  1.1965779e-13  0              3.0052079    
   2100000   6363.961       200            200            0.0030113336  -0.0027833764   0              0.011817377    1.8262516e-11  0              1.7636631e-06  1.1965779e-13  0              3.0052079    
   2200000   6363.961       200            200            0.0030113334  -0.0027833764   0              0.011817377    9.4300738e-13  0              9.1068903e-08  1.1965779e-13  0              3.0052079    
   2300000   6363.961       200            200            0.0030113336  -0.0027833764   0              0.011817377    9.1835126e-15  0              8.8687792e-10  1.1965779e-13  0              3.0052079    
   2400000   6363.961       200            200            0.0030113335  -0.0027833764   0              0.011817377    3.1746532e-14  0              3.0658528e-09  1.1965779e-13  0              3.0052079    
   2500000   6363.961       200            200            0.0030113335  -0.0027833764   0              0.011817377    5.6315517e-15  0              5.4385495e-10  1.1965779e-13  0              3.0052079    
   2600000   6363.961       200            200            0.0030113335  -0.0027833764   0              0.011817377    1.641941e-16   0              1.5856691e-11  1.1965779e-13  0              3.0052079    
   2700000   6363.961       200            200            0.0030113335  -0.0027833764   0              0.011817377    1.2251079e-17  0              1.1831216e-12  1.1965779e-13  0              3.0052079    
   2800000   6363.961       200            200            0.0030113335  -0.0027833764   0              0.011817377    7.78252e-18    0              7.5158008e-13  1.1965779e-13  0              3.0052079    
   2900000   6363.961       200            200            0.0030113335  -0.0027833764   0              0.011817377    5.2214038e-18  0              5.0424581e-13  1.1965779e-13  0              3.0052079    
   3000000   6363.961       200            200            0.0030113335  -0.0027833764   0              0.011817377    7.1683458e-18  0              6.9226753e-13  1.1965779e-13  0              3.0052079    
Loop time of 303.158 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8550007.025 ns/day, 0.000 hours/ns, 9895.841 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.227     | 40.88      | 71.696     | 460.8 | 13.48
Neigh   | 3.456      | 3.4803     | 3.5032     |   0.9 |  1.15
Comm    | 16.308     | 21.218     | 27.58      |  92.7 |  7.00
Output  | 0.2443     | 0.24466    | 0.24508    |   0.1 |  0.08
Modify  | 175.8      | 179.56     | 183.54     |  23.6 | 59.23
Other   |            | 57.77      |            |       | 19.06

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         347.75 ave         696 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1391
Ave neighs/atom = 0.55617753
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.03                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.0441819206036
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.13
  ghost atom cutoff = 3.13
  binsize = 1.565, bins = 4067 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.8 | 81.81 | 81.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032180916   6.3466542e-36  0              0.0096542747   590564.28      0              5.7032471e+10  1.1965779e-13  0              3.3283205    
    200000   6363.961       200            200            0.0011599113   5.0773216e-35  0              0.0034797339   147542.92      0              1.4248639e+10  1.1965779e-13  0              3.0817323    
    300000   6363.961       200            200            9.1993098e-05 -7.6159045e-35  0              0.00027597929  1897.9015      0              1.8328575e+08  1.1965779e-13  0              3.0594323    
    400000   6363.961       200            200            0.00062337107 -0.00014217906  0              0.0020122923   8496.0707      0              8.204897e+08   1.1965779e-13  0              3.0133526    
    500000   6363.961       200            200            0.0016015914  -0.00052751501  0              0.0053322892   1070.1878      0              1.0335108e+08  1.1965779e-13  0              3.0118548    
    600000   6363.961       200            200            0.0032424347  -0.0027831635   0              0.012510468    206.62761      0              19954616       1.1965779e-13  0              3.0100938    
    700000   6363.961       200            200            0.0034399173  -0.0027613104   0              0.013081062    14.955457      0              1444291        1.1965779e-13  0              3.0099602    
    800000   6363.961       200            200            0.0027987654  -0.0027860568   0              0.011182353    0.0022171735   0              214.11874      1.1965779e-13  0              3.0103472    
    900000   6363.961       200            200            0.0030783162  -0.0027825701   0              0.012017519    0.23295492     0              22497.118      1.1965779e-13  0              3.0101757    
   1000000   6363.961       200            200            0.0030168206  -0.0027818083   0              0.01183227     0.068352062    0              6600.9529      1.1965779e-13  0              3.0102124    
   1100000   6363.961       200            200            0.0030112077  -0.0027815219   0              0.011815145    0.0050097418   0              483.805        1.1965779e-13  0              3.0102163    
   1200000   6363.961       200            200            0.0030221536  -0.0027825909   0              0.011849052    2.2018416e-06  0              0.2126381      1.1965779e-13  0              3.0102093    
   1300000   6363.961       200            200            0.0030172241  -0.0027821111   0              0.011833784    7.6999371e-05  0              7.4360481      1.1965779e-13  0              3.0102124    
   1400000   6363.961       200            200            0.0030183067  -0.0027822133   0              0.011837134    2.2593145e-05  0              2.1818842      1.1965779e-13  0              3.0102118    
   1500000   6363.961       200            200            0.0030184097  -0.0027822245   0              0.011837454    1.6465226e-06  0              0.15900937     1.1965779e-13  0              3.0102117    
   1600000   6363.961       200            200            0.0030182103  -0.0027822049   0              0.011836836    6.2217806e-10  0              6.0085504e-05  1.1965779e-13  0              3.0102118    
   1700000   6363.961       200            200            0.0030182999  -0.0027822136   0              0.011837113    2.5618394e-08  0              0.0024740411   1.1965779e-13  0              3.0102118    
   1800000   6363.961       200            200            0.0030182803  -0.0027822117   0              0.011837053    7.466805e-09   0              0.00072109058  1.1965779e-13  0              3.0102118    
   1900000   6363.961       200            200            0.0030182784  -0.0027822115   0              0.011837047    5.4082846e-10  0              5.2229342e-05  1.1965779e-13  0              3.0102118    
   2000000   6363.961       200            200            0.003018282   -0.0027822119   0              0.011837058    1.7328202e-13  0              1.6734337e-08  1.1965779e-13  0              3.0102118    
   2100000   6363.961       200            200            0.0030182804  -0.0027822117   0              0.011837053    8.5228176e-12  0              8.2307272e-07  1.1965779e-13  0              3.0102118    
   2200000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    2.4671658e-12  0              2.3826121e-07  1.1965779e-13  0              3.0102118    
   2300000   6363.961       200            200            0.0030182808  -0.0027822117   0              0.011837054    1.7731187e-13  0              1.7123511e-08  1.1965779e-13  0              3.0102118    
   2400000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    5.2012149e-17  0              5.0229611e-12  1.1965779e-13  0              3.0102118    
   2500000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    2.7502777e-15  0              2.6560214e-10  1.1965779e-13  0              3.0102118    
   2600000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    8.1668488e-16  0              7.886958e-11   1.1965779e-13  0              3.0102118    
   2700000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    5.8837615e-17  0              5.6821157e-12  1.1965779e-13  0              3.0102118    
   2800000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    7.4165719e-19  0              7.1623943e-14  1.1965779e-13  0              3.0102118    
   2900000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    1.6278473e-18  0              1.5720584e-13  1.1965779e-13  0              3.0102118    
   3000000   6363.961       200            200            0.0030182807  -0.0027822117   0              0.011837054    1.0002242e-18  0              9.6594492e-14  1.1965779e-13  0              3.0102118    
Loop time of 299.897 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8642961.230 ns/day, 0.000 hours/ns, 10003.427 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.783     | 41.236     | 74.103     | 456.4 | 13.75
Neigh   | 3.3889     | 3.4153     | 3.441      |   1.0 |  1.14
Comm    | 16.035     | 21.945     | 31.951     | 132.4 |  7.32
Output  | 0.24337    | 0.24373    | 0.24415    |   0.1 |  0.08
Modify  | 174.97     | 176.77     | 178.64     |  10.3 | 58.94
Other   |            | 56.29      |            |       | 18.77

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         325.75 ave         652 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1303
Ave neighs/atom = 0.5209916
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.04                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.3624992932791
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.14
  ghost atom cutoff = 3.14
  binsize = 1.57, bins = 4054 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.54 | 81.57 | 81.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032274473  -1.2693148e-35  0              0.0096823418   592858.71      0              5.7254051e+10  1.1965779e-13  0              3.3285247    
    200000   6363.961       200            200            0.0011735818  -2.8559811e-35  0              0.0035207455   150071.18      0              1.44928e+10    1.1965779e-13  0              3.0835075    
    300000   6363.961       200            200            0.00010265984 -1.2693111e-35  0              0.00030797952  2329.319       0              2.2494896e+08  1.1965779e-13  0              3.0639884    
    400000   6363.961       200            200            0.0012735125  -0.00043707626  0              0.0042576138   9242.1178      0              8.9253758e+08  1.1965779e-13  0              3.0173629    
    500000   6363.961       200            200            0.0020117516  -0.00078334953  0              0.0068186044   1277.3905      0              1.2336123e+08  1.1965779e-13  0              3.0164377    
    600000   6363.961       200            200            0.0035804247  -0.0028909579   0              0.013632232    184.80846      0              17847479       1.1965779e-13  0              3.0148829    
    700000   6363.961       200            200            0.0033105914  -0.002760355    0              0.012692129    21.9783        0              2122506.9      1.1965779e-13  0              3.0150434    
    800000   6363.961       200            200            0.002817351   -0.0027869468   0              0.011239       0.40659713     0              39266.24       1.1965779e-13  0              3.0153438    
    900000   6363.961       200            200            0.0031014476  -0.0027795156   0              0.012083859    0.06977105     0              6737.9886      1.1965779e-13  0              3.01517      
   1000000   6363.961       200            200            0.0030129897  -0.0027780093   0              0.011816978    0.055215485    0              5332.3163      1.1965779e-13  0              3.0152235    
   1100000   6363.961       200            200            0.0030228274  -0.0027791531   0              0.011847635    0.0084591936   0              816.92837      1.1965779e-13  0              3.0152177    
   1200000   6363.961       200            200            0.0030290735  -0.0027797768   0              0.011866997    0.00032710177  0              31.589148      1.1965779e-13  0              3.0152136    
   1300000   6363.961       200            200            0.0030243608  -0.0027793177   0              0.0118524      6.8335792e-06  0              0.65993817     1.1965779e-13  0              3.0152166    
   1400000   6363.961       200            200            0.00302607    -0.0027794809   0              0.011857691    1.4845772e-05  0              1.4336984      1.1965779e-13  0              3.0152155    
   1500000   6363.961       200            200            0.0030257804  -0.002779454    0              0.011856795    3.0028026e-06  0              0.28998918     1.1965779e-13  0              3.0152157    
   1600000   6363.961       200            200            0.0030257067  -0.0027794465   0              0.011856567    1.7505549e-07  0              0.016905606    1.1965779e-13  0              3.0152157    
   1700000   6363.961       200            200            0.0030257856  -0.0027794542   0              0.011856811    5.1578126e-11  0              4.9810462e-06  1.1965779e-13  0              3.0152157    
   1800000   6363.961       200            200            0.0030257528  -0.002779451    0              0.01185671     3.6356135e-09  0              0.00035110153  1.1965779e-13  0              3.0152157    
   1900000   6363.961       200            200            0.0030257599  -0.0027794517   0              0.011856732    1.0026871e-09  0              9.683234e-05   1.1965779e-13  0              3.0152157    
   2000000   6363.961       200            200            0.0030257605  -0.0027794518   0              0.011856733    8.1154121e-11  0              7.8372841e-06  1.1965779e-13  0              3.0152157    
   2100000   6363.961       200            200            0.0030257593  -0.0027794516   0              0.011856729    3.678577e-13   0              3.5525064e-08  1.1965779e-13  0              3.0152157    
   2200000   6363.961       200            200            0.0030257599  -0.0027794517   0              0.011856731    7.8568771e-13  0              7.5876095e-08  1.1965779e-13  0              3.0152157    
   2300000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    3.1478702e-13  0              3.0399877e-08  1.1965779e-13  0              3.0152157    
   2400000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    3.3948945e-14  0              3.2785462e-09  1.1965779e-13  0              3.0152157    
   2500000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    5.8535026e-16  0              5.6528938e-11  1.1965779e-13  0              3.0152157    
   2600000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    1.7558745e-16  0              1.6956979e-11  1.1965779e-13  0              3.0152157    
   2700000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    9.0802764e-17  0              8.769081e-12   1.1965779e-13  0              3.0152157    
   2800000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    1.3905773e-17  0              1.34292e-12    1.1965779e-13  0              3.0152157    
   2900000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    7.8393426e-22  0              7.5706759e-17  1.1965779e-13  0              3.0152157    
   3000000   6363.961       200            200            0.0030257597  -0.0027794517   0              0.011856731    8.7336759e-20  0              8.4343591e-15  1.1965779e-13  0              3.0152157    
Loop time of 297.894 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8701083.388 ns/day, 0.000 hours/ns, 10070.698 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.22      | 38.734     | 66.193     | 438.0 | 13.00
Neigh   | 3.2912     | 3.3157     | 3.3395     |   1.0 |  1.11
Comm    | 15.737     | 20.64      | 25.177     |  82.7 |  6.93
Output  | 0.24129    | 0.24166    | 0.24208    |   0.1 |  0.08
Modify  | 171.07     | 177.51     | 184.44     |  44.9 | 59.59
Other   |            | 57.46      |            |       | 19.29

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         328.75 ave         658 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1315
Ave neighs/atom = 0.52578968
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.05                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.6829177631213
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.15
  ghost atom cutoff = 3.15
  binsize = 1.575, bins = 4041 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.37 | 80.37 | 80.38 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.003236805    1.2693361e-35  0              0.009710415    595156.53      0              5.7475958e+10  1.1965779e-13  0              3.3287176    
    200000   6363.961       200            200            0.0011872969   5.6516336e-42  0              0.0035618908   152618.69      0              1.4738821e+10  1.1965779e-13  0              3.0852523    
    300000   6363.961       200            200            0.0001134563  -5.0772752e-35  0              0.00034036889  2804.3109      0              2.7082027e+08  1.1965779e-13  0              3.0684987    
    400000   6363.961       200            200            0.0022288329  -0.00097432827  0              0.007660827    9771.6618      0              9.4367715e+08  1.1965779e-13  0              3.0213363    
    500000   6363.961       200            200            0.0024939541  -0.0011366723   0              0.0086185346   1438.3831      0              1.3890874e+08  1.1965779e-13  0              3.020988     
    600000   6363.961       200            200            0.003908929   -0.0029787995   0              0.014705587    146.78143      0              14175099       1.1965779e-13  0              3.0196892    
    700000   6363.961       200            200            0.0031564626  -0.0027792222   0              0.01224861     26.691147      0              2577639.9      1.1965779e-13  0              3.0201386    
    800000   6363.961       200            200            0.0028552447  -0.0027888331   0              0.011354567    1.3600764      0              131346.45      1.1965779e-13  0              3.0203281    
    900000   6363.961       200            200            0.0031146592  -0.0027764953   0              0.012120473    0.0001322767   0              12.774337      1.1965779e-13  0              3.0201704    
   1000000   6363.961       200            200            0.0030114247  -0.0027738949   0              0.011808169    0.02884632     0              2785.7711      1.1965779e-13  0              3.0202333    
   1100000   6363.961       200            200            0.0030353273  -0.0027760199   0              0.011882002    0.0089515865   0              864.48015      1.1965779e-13  0              3.0202186    
   1200000   6363.961       200            200            0.0030354656  -0.0027760573   0              0.011882454    0.0009171958   0              88.576205      1.1965779e-13  0              3.0202183    
   1300000   6363.961       200            200            0.0030321712  -0.0027757374   0              0.011872251    1.8285754e-05  0              1.7659073      1.1965779e-13  0              3.0202205    
   1400000   6363.961       200            200            0.0030340061  -0.0027759119   0              0.01187793     2.8147558e-06  0              0.27182897     1.1965779e-13  0              3.0202193    
   1500000   6363.961       200            200            0.0030334184  -0.0027758566   0              0.011876112    2.310706e-06   0              0.22315145     1.1965779e-13  0              3.0202197    
   1600000   6363.961       200            200            0.0030335016  -0.0027758641   0              0.011876369    3.9531268e-07  0              0.038176469    1.1965779e-13  0              3.0202196    
   1700000   6363.961       200            200            0.003033534   -0.0027758673   0              0.011876469    2.2101781e-08  0              0.0021344318   1.1965779e-13  0              3.0202196    
   1800000   6363.961       200            200            0.0030335046  -0.0027758645   0              0.011876378    1.3374132e-12  0              1.2915779e-07  1.1965779e-13  0              3.0202196    
   1900000   6363.961       200            200            0.0030335168  -0.0027758657   0              0.011876416    4.2823988e-10  0              4.1356342e-05  1.1965779e-13  0              3.0202196    
   2000000   6363.961       200            200            0.0030335139  -0.0027758654   0              0.011876407    1.3184485e-10  0              1.2732632e-05  1.1965779e-13  0              3.0202196    
   2100000   6363.961       200            200            0.0030335138  -0.0027758654   0              0.011876407    1.3452403e-11  0              1.2991368e-06  1.1965779e-13  0              3.0202196    
   2200000   6363.961       200            200            0.0030335142  -0.0027758654   0              0.011876408    2.6545556e-13  0              2.5635798e-08  1.1965779e-13  0              3.0202196    
   2300000   6363.961       200            200            0.003033514   -0.0027758654   0              0.011876407    4.1783992e-14  0              4.0351989e-09  1.1965779e-13  0              3.0202196    
   2400000   6363.961       200            200            0.0030335141  -0.0027758654   0              0.011876408    3.4107635e-14  0              3.2938712e-09  1.1965779e-13  0              3.0202196    
   2500000   6363.961       200            200            0.0030335141  -0.0027758654   0              0.011876408    5.7679417e-15  0              5.5702653e-10  1.1965779e-13  0              3.0202196    
   2600000   6363.961       200            200            0.0030335141  -0.0027758654   0              0.011876408    3.027451e-16   0              2.9236955e-11  1.1965779e-13  0              3.0202196    
   2700000   6363.961       200            200            0.0030335141  -0.0027758654   0              0.011876408    7.7282189e-20  0              7.4633606e-15  1.1965779e-13  0              3.0202196    
   2800000   6363.961       200            200            0.0030335141  -0.0027758654   0              0.011876408    1.7452546e-18  0              1.685442e-13   1.1965779e-13  0              3.0202196    
   2900000   6363.961       200            200            0.0030335141  -0.0027758654   0              0.011876408    6.5386561e-18  0              6.314566e-13   1.1965779e-13  0              3.0202196    
   3000000   6363.961       200            200            0.0030335141  -0.0027758654   0              0.011876408    5.1967801e-18  0              5.0186782e-13  1.1965779e-13  0              3.0202196    
Loop time of 296.7 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8736089.205 ns/day, 0.000 hours/ns, 10111.214 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.203     | 38.484     | 66.211     | 437.3 | 12.97
Neigh   | 3.1528     | 3.175      | 3.1969     |   0.9 |  1.07
Comm    | 15.484     | 21.06      | 27.329     | 105.5 |  7.10
Output  | 0.2422     | 0.24253    | 0.24288    |   0.1 |  0.08
Modify  | 170.4      | 175.6      | 181.71     |  35.6 | 59.18
Other   |            | 58.14      |            |       | 19.60

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         331.25 ave         663 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1325
Ave neighs/atom = 0.52978808
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.06                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.005444241634
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.16
  ghost atom cutoff = 3.16
  binsize = 1.58, bins = 4028 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.1 | 80.11 | 80.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032461647   3.8079818e-35  0              0.009738494    597457.72      0              5.769819e+10   1.1965779e-13  0              3.3288992    
    200000   6363.961       200            200            0.0012010562  -5.0772931e-35  0              0.0036031685   155185.4       0              1.4986695e+10  1.1965779e-13  0              3.0869665    
    300000   6363.961       200            200            0.00012438156 -1.3962564e-34  0              0.00037314468  3322.7231      0              3.2088481e+08  1.1965779e-13  0              3.0729631    
    400000   6363.961       200            200            0.0034231413  -0.0019797518   0              0.012249176    9959.9674      0              9.6186236e+08  1.1965779e-13  0              3.0252886    
    500000   6363.961       200            200            0.0030496615  -0.0015858624   0              0.010734847    1529.2113      0              1.4768029e+08  1.1965779e-13  0              3.0255171    
    600000   6363.961       200            200            0.004213614   -0.0030213338   0              0.015662176    99.828577      0              9640729.4      1.1965779e-13  0              3.0245231    
    700000   6363.961       200            200            0.0029931295  -0.0028076179   0              0.011787006    27.82269       0              2686916.2      1.1965779e-13  0              3.0252393    
    800000   6363.961       200            200            0.0029112452  -0.0027869886   0              0.011520724    2.5041694      0              241834.76      1.1965779e-13  0              3.025302     
    900000   6363.961       200            200            0.0031178301  -0.0027715309   0              0.012125021    0.05857906     0              5657.1463      1.1965779e-13  0              3.0251771    
   1000000   6363.961       200            200            0.0030140287  -0.0027684708   0              0.011810557    0.0058697568   0              566.8591       1.1965779e-13  0              3.0252407    
   1100000   6363.961       200            200            0.0030479381  -0.0027714822   0              0.011915297    0.006103161    0              589.39961      1.1965779e-13  0              3.0252197    
   1200000   6363.961       200            200            0.0030418361  -0.0027709242   0              0.011896433    0.0012349261   0              119.26033      1.1965779e-13  0              3.0252234    
   1300000   6363.961       200            200            0.003040823   -0.0027708207   0              0.01189329     9.872836e-05   0              9.5344783      1.1965779e-13  0              3.0252241    
   1400000   6363.961       200            200            0.0030422365  -0.0027709553   0              0.011897665    1.1012441e-06  0              0.10635027     1.1965779e-13  0              3.0252232    
   1500000   6363.961       200            200            0.00304155    -0.0027708908   0              0.011895541    5.3068932e-07  0              0.051250176    1.1965779e-13  0              3.0252236    
   1600000   6363.961       200            200            0.0030417593  -0.0027709102   0              0.011896188    3.2008803e-07  0              0.030911811    1.1965779e-13  0              3.0252235    
   1700000   6363.961       200            200            0.00304173    -0.0027709076   0              0.011896097    5.3495487e-08  0              0.0051662112   1.1965779e-13  0              3.0252235    
   1800000   6363.961       200            200            0.0030417188  -0.0027709065   0              0.011896063    3.4140725e-09  0              0.00032970668  1.1965779e-13  0              3.0252235    
   1900000   6363.961       200            200            0.0030417293  -0.0027709075   0              0.011896095    8.1046728e-12  0              7.8269129e-07  1.1965779e-13  0              3.0252235    
   2000000   6363.961       200            200            0.0030417247  -0.002770907    0              0.011896081    3.8681114e-11  0              3.7355451e-06  1.1965779e-13  0              3.0252235    
   2100000   6363.961       200            200            0.0030417259  -0.0027709071   0              0.011896085    1.6049994e-11  0              1.5499935e-06  1.1965779e-13  0              3.0252235    
   2200000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896085    2.2337014e-12  0              2.1571489e-07  1.1965779e-13  0              3.0252235    
   2300000   6363.961       200            200            0.0030417257  -0.0027709071   0              0.011896084    1.0961896e-13  0              1.0586215e-08  1.1965779e-13  0              3.0252235    
   2400000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896085    7.4827336e-17  0              7.2262886e-12  1.1965779e-13  0              3.0252235    
   2500000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896084    2.4196599e-15  0              2.3367344e-10  1.1965779e-13  0              3.0252235    
   2600000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896084    7.7402341e-16  0              7.4749641e-11  1.1965779e-13  0              3.0252235    
   2700000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896084    9.1434914e-17  0              8.8301295e-12  1.1965779e-13  0              3.0252235    
   2800000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896084    6.0912972e-18  0              5.8825389e-13  1.1965779e-13  0              3.0252235    
   2900000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896084    2.1826276e-22  0              2.1078255e-17  1.1965779e-13  0              3.0252235    
   3000000   6363.961       200            200            0.0030417258  -0.0027709071   0              0.011896084    4.9663468e-19  0              4.7961423e-14  1.1965779e-13  0              3.0252235    
Loop time of 292.157 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8871950.028 ns/day, 0.000 hours/ns, 10268.461 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.149     | 37.791     | 65.756     | 432.4 | 12.94
Neigh   | 3.1785     | 3.2014     | 3.2238     |   0.9 |  1.10
Comm    | 15.258     | 21.327     | 26.887     | 112.1 |  7.30
Output  | 0.23901    | 0.23935    | 0.2397     |   0.1 |  0.08
Modify  | 170.13     | 174.09     | 177.55     |  25.3 | 59.59
Other   |            | 55.51      |            |       | 19.00

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         333.75 ave         668 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1335
Ave neighs/atom = 0.53378649
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.07                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.3300856403214
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.17
  ghost atom cutoff = 3.17
  binsize = 1.585, bins = 4016 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.9 | 79.91 | 79.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032555262   2.7339914e-41  0              0.0097665787   599762.29      0              5.7920749e+10  1.1965779e-13  0              3.3290692    
    200000   6363.961       200            200            0.0012148593   5.0774094e-35  0              0.003644578    157771.29      0              1.5236422e+10  1.1965779e-13  0              3.0886501    
    300000   6363.961       200            200            0.00013543495 -1.2693098e-35  0              0.00040630484  3884.4139      0              3.7512889e+08  1.1965779e-13  0              3.0773817    
    400000   6363.961       200            200            0.0050015076  -0.0029407891   0              0.017945312    9694.4198      0              9.3621767e+08  1.1965779e-13  0              3.0292412    
    500000   6363.961       200            200            0.0036922968  -0.0020412873   0              0.013118178    1530.9081      0              1.4784415e+08  1.1965779e-13  0              3.0300382    
    600000   6363.961       200            200            0.0044643714  -0.003041807    0              0.016434921    53.605111      0              5176797.9      1.1965779e-13  0              3.0293937    
    700000   6363.961       200            200            0.0028381308  -0.0028273372   0              0.01134173     25.140882      0              2427926.4      1.1965779e-13  0              3.0303385    
    800000   6363.961       200            200            0.0029814852  -0.0027797302   0              0.011724186    3.4087233      0              329190.1       1.1965779e-13  0              3.0302684    
    900000   6363.961       200            200            0.0031122514  -0.0027627618   0              0.012099516    0.21456741     0              20721.384      1.1965779e-13  0              3.0301899    
   1000000   6363.961       200            200            0.0030220428  -0.0027609773   0              0.011827106    0.000864938    0              83.529521      1.1965779e-13  0              3.0302453    
   1100000   6363.961       200            200            0.0030601384  -0.0027643341   0              0.011944749    0.0020893554   0              201.77499      1.1965779e-13  0              3.0302216    
   1200000   6363.961       200            200            0.0030489977  -0.002763309    0              0.011910302    0.00098944224  0              95.553249      1.1965779e-13  0              3.0302284    
   1300000   6363.961       200            200            0.0030505636  -0.0027634443   0              0.011915135    0.00016261143  0              15.703848      1.1965779e-13  0              3.0302275    
   1400000   6363.961       200            200            0.0030511248  -0.0027634989   0              0.011916873    1.1734028e-05  0              1.1331884      1.1965779e-13  0              3.0302271    
   1500000   6363.961       200            200            0.0030505764  -0.0027634478   0              0.011915177    1.1570779e-07  0              0.01117423     1.1965779e-13  0              3.0302275    
   1600000   6363.961       200            200            0.0030508304  -0.0027634711   0              0.011915962    6.6212227e-08  0              0.0063943029   1.1965779e-13  0              3.0302273    
   1700000   6363.961       200            200            0.0030507516  -0.002763464    0              0.011915719    4.022492e-08   0              0.0038846349   1.1965779e-13  0              3.0302274    
   1800000   6363.961       200            200            0.0030507648  -0.0027634651   0              0.011915759    7.3766538e-09  0              0.00071238443  1.1965779e-13  0              3.0302274    
   1900000   6363.961       200            200            0.0030507675  -0.0027634654   0              0.011915768    6.0494681e-10  0              5.8421433e-05  1.1965779e-13  0              3.0302274    
   2000000   6363.961       200            200            0.0030507641  -0.0027634651   0              0.011915757    1.0286882e-11  0              9.9343343e-07  1.1965779e-13  0              3.0302274    
   2100000   6363.961       200            200            0.0030507658  -0.0027634652   0              0.011915763    1.9250172e-12  0              1.8590438e-07  1.1965779e-13  0              3.0302274    
   2200000   6363.961       200            200            0.0030507652  -0.0027634652   0              0.011915761    1.6042945e-12  0              1.5493128e-07  1.1965779e-13  0              3.0302274    
   2300000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    3.2992036e-13  0              3.1861347e-08  1.1965779e-13  0              3.0302274    
   2400000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    3.0546784e-14  0              2.9499898e-09  1.1965779e-13  0              3.0302274    
   2500000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    8.0655936e-16  0              7.789173e-11   1.1965779e-13  0              3.0302274    
   2600000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    7.107347e-17   0              6.863767e-12   1.1965779e-13  0              3.0302274    
   2700000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    5.7518139e-17  0              5.5546902e-12  1.1965779e-13  0              3.0302274    
   2800000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    1.2454791e-17  0              1.2027946e-12  1.1965779e-13  0              3.0302274    
   2900000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    1.6176061e-18  0              1.5621682e-13  1.1965779e-13  0              3.0302274    
   3000000   6363.961       200            200            0.0030507653  -0.0027634652   0              0.011915761    2.3440324e-18  0              2.2636987e-13  1.1965779e-13  0              3.0302274    
Loop time of 288.638 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8980096.677 ns/day, 0.000 hours/ns, 10393.630 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.975     | 37.726     | 65.348     | 432.7 | 13.07
Neigh   | 3.1754     | 3.2004     | 3.2248     |   1.0 |  1.11
Comm    | 15.324     | 20.357     | 24.318     |  86.8 |  7.05
Output  | 0.24115    | 0.24147    | 0.24181    |   0.1 |  0.08
Modify  | 166.46     | 171.79     | 176.97     |  35.2 | 59.52
Other   |            | 55.32      |            |       | 19.17

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.25 ave         673 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1345
Ave neighs/atom = 0.53778489
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.08                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.6568488706868
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.18
  ghost atom cutoff = 3.18
  binsize = 1.59, bins = 4003 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.69 | 78.7 | 78.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032648897  -2.5386283e-35  0              0.0097946691   602070.23      0              5.8143633e+10  1.1965779e-13  0              3.3292279    
    200000   6363.961       200            200            0.001228706    5.0773356e-35  0              0.0036861179   160376.28      0              1.5487993e+10  1.1965779e-13  0              3.0903031    
    300000   6363.961       200            200            0.00014661552  5.0773177e-35  0              0.00043984656  4489.2297      0              4.3353767e+08  1.1965779e-13  0              3.0817542    
    400000   6363.961       200            200            0.006904952   -0.0038665769   0              0.024581433    8906.3515      0              8.6011168e+08  1.1965779e-13  0              3.0332208    
    500000   6363.961       200            200            0.0043746989  -0.0025731111   0              0.015697208    1434.1059      0              1.3849568e+08  1.1965779e-13  0              3.0345663    
    600000   6363.961       200            200            0.004640742   -0.0030448919   0              0.016967118    18.009325      0              1739211.7      1.1965779e-13  0              3.0343084    
    700000   6363.961       200            200            0.0027111404  -0.0028103964   0              0.010943818    19.451922      0              1878527.4      1.1965779e-13  0              3.0354297    
    800000   6363.961       200            200            0.0030600256  -0.0027677551   0              0.011947832    3.7317977      0              360390.31      1.1965779e-13  0              3.035231     
    900000   6363.961       200            200            0.0030992039  -0.0027524017   0              0.012050013    0.38850076     0              37518.623      1.1965779e-13  0              3.0352074    
   1000000   6363.961       200            200            0.0030345774  -0.0027547497   0              0.011858482    0.017044933    0              1646.0777      1.1965779e-13  0              3.0352469    
   1100000   6363.961       200            200            0.003070133   -0.0027578998   0              0.011968299    1.3890758e-05  0              1.34147        1.1965779e-13  0              3.0352246    
   1200000   6363.961       200            200            0.003056281   -0.0027566299   0              0.011925473    0.00040125205  0              38.750051      1.1965779e-13  0              3.0352332    
   1300000   6363.961       200            200            0.0030600699  -0.002756966    0              0.011937176    0.00014147686  0              13.662822      1.1965779e-13  0              3.0352309    
   1400000   6363.961       200            200            0.0030595934  -0.0027569258   0              0.011935706    2.170513e-05   0              2.0961261      1.1965779e-13  0              3.0352312    
   1500000   6363.961       200            200            0.0030593775  -0.0027569051   0              0.011935038    1.6364177e-06  0              0.15803351     1.1965779e-13  0              3.0352313    
   1600000   6363.961       200            200            0.0030595753  -0.0027569233   0              0.011935649    2.6716619e-08  0              0.0025800998   1.1965779e-13  0              3.0352312    
   1700000   6363.961       200            200            0.003059482   -0.0027569148   0              0.011935361    5.0876225e-09  0              0.00049132616  1.1965779e-13  0              3.0352312    
   1800000   6363.961       200            200            0.0030595131  -0.0027569176   0              0.011935457    4.3788857e-09  0              0.00042288144  1.1965779e-13  0              3.0352312    
   1900000   6363.961       200            200            0.0030595064  -0.002756917    0              0.011935436    9.8156242e-10  0              9.4792273e-05  1.1965779e-13  0              3.0352312    
   2000000   6363.961       200            200            0.0030595064  -0.002756917    0              0.011935436    1.0951596e-10  0              1.0576267e-05  1.1965779e-13  0              3.0352312    
   2100000   6363.961       200            200            0.0030595073  -0.0027569171   0              0.011935439    5.071647e-12   0              4.8978337e-07  1.1965779e-13  0              3.0352312    
   2200000   6363.961       200            200            0.0030595067  -0.0027569171   0              0.011935437    3.0682865e-16  0              2.9631315e-11  1.1965779e-13  0              3.0352312    
   2300000   6363.961       200            200            0.003059507   -0.0027569171   0              0.011935438    9.9280716e-14  0              9.5878209e-09  1.1965779e-13  0              3.0352312    
   2400000   6363.961       200            200            0.0030595069  -0.0027569171   0              0.011935438    3.7206843e-14  0              3.5931706e-09  1.1965779e-13  0              3.0352312    
   2500000   6363.961       200            200            0.0030595069  -0.0027569171   0              0.011935438    5.8323846e-15  0              5.6324996e-10  1.1965779e-13  0              3.0352312    
   2600000   6363.961       200            200            0.0030595069  -0.0027569171   0              0.011935438    4.4253173e-16  0              4.2736547e-11  1.1965779e-13  0              3.0352312    
   2700000   6363.961       200            200            0.0030595069  -0.0027569171   0              0.011935438    1.0108765e-17  0              9.7623216e-13  1.1965779e-13  0              3.0352312    
   2800000   6363.961       200            200            0.0030595069  -0.0027569171   0              0.011935438    8.4619484e-20  0              8.1719441e-15  1.1965779e-13  0              3.0352312    
   2900000   6363.961       200            200            0.0030595069  -0.0027569171   0              0.011935438    2.8781485e-18  0              2.7795098e-13  1.1965779e-13  0              3.0352312    
   3000000   6363.961       200            200            0.0030595069  -0.0027569171   0              0.011935438    2.1704391e-18  0              2.0960547e-13  1.1965779e-13  0              3.0352312    
Loop time of 288.209 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8993478.042 ns/day, 0.000 hours/ns, 10409.118 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.918     | 37.581     | 64.737     | 431.9 | 13.04
Neigh   | 3.1078     | 3.1312     | 3.1552     |   1.0 |  1.09
Comm    | 15.21      | 20.045     | 24.196     |  83.9 |  6.96
Output  | 0.24158    | 0.2419     | 0.24227    |   0.1 |  0.08
Modify  | 166.59     | 171.97     | 177.01     |  36.0 | 59.67
Other   |            | 55.24      |            |       | 19.17

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         339.25 ave         679 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1357
Ave neighs/atom = 0.54258297
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.09                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.9857408442343
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.19
  ghost atom cutoff = 3.19
  binsize = 1.595, bins = 3990 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.44 | 78.47 | 78.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032742549   1.494351e-40   0              0.0098227648   604381.53      0              5.8366842e+10  1.1965779e-13  0              3.3293751    
    200000   6363.961       200            200            0.0012425957   2.5386743e-35  0              0.0037277872   163000.31      0              1.5741403e+10  1.1965779e-13  0              3.0919253    
    300000   6363.961       200            200            0.00015792239  2.5386809e-35  0              0.00047376716  5137.0184      0              4.9609647e+08  1.1965779e-13  0              3.0860808    
    400000   6363.961       200            200            0.0088855764  -0.0052033782   0              0.031860107    7599.5867      0              7.3391368e+08  1.1965779e-13  0              3.0372588    
    500000   6363.961       200            200            0.0051030997  -0.0030503913   0              0.01835969     1243.3666      0              1.2007545e+08  1.1965779e-13  0              3.0391178    
    600000   6363.961       200            200            0.0047214376  -0.0030523107   0              0.017216623    0.86099307     0              83148.548      1.1965779e-13  0              3.0392721    
    700000   6363.961       200            200            0.0026149283  -0.0027732821   0              0.010618067    12.330155      0              1190758.2      1.1965779e-13  0              3.0405071    
    800000   6363.961       200            200            0.0031391345  -0.0027550462   0              0.01217245     3.3487413      0              323397.46      1.1965779e-13  0              3.0401938    
    900000   6363.961       200            200            0.0030807481  -0.0027434819   0              0.011985726    0.49256219     0              47568.131      1.1965779e-13  0              3.0402281    
   1000000   6363.961       200            200            0.003050928   -0.00275008     0              0.011902864    0.044005572    0              4249.7432      1.1965779e-13  0              3.0402458    
   1100000   6363.961       200            200            0.0030774674  -0.0027525498   0              0.011984952    0.0015615309   0              150.80148      1.1965779e-13  0              3.040229     
   1200000   6363.961       200            200            0.0030639525  -0.0027512302   0              0.011943088    1.1847067e-05  0              1.144105       1.1965779e-13  0              3.0402375    
   1300000   6363.961       200            200            0.0030690189  -0.0027516781   0              0.011958735    5.6588928e-05  0              5.4649536      1.1965779e-13  0              3.0402343    
   1400000   6363.961       200            200            0.003067627   -0.0027515558   0              0.011954437    1.8604721e-05  0              1.7967108      1.1965779e-13  0              3.0402352    
   1500000   6363.961       200            200            0.003067828   -0.0027515726   0              0.011955057    2.976834e-06   0              0.28748132     1.1965779e-13  0              3.0402351    
   1600000   6363.961       200            200            0.003067888   -0.0027515784   0              0.011955242    2.6448157e-07  0              0.025541737    1.1965779e-13  0              3.040235     
   1700000   6363.961       200            200            0.0030678228  -0.0027515725   0              0.011955041    8.8385947e-09  0              0.00085356821  1.1965779e-13  0              3.0402351    
   1800000   6363.961       200            200            0.0030678561  -0.0027515754   0              0.011955144    9.2645161e-11  0              8.9470065e-06  1.1965779e-13  0              3.040235     
   1900000   6363.961       200            200            0.0030678438  -0.0027515743   0              0.011955106    3.5299297e-10  0              3.4089535e-05  1.1965779e-13  0              3.040235     
   2000000   6363.961       200            200            0.0030678471  -0.0027515746   0              0.011955116    1.1309844e-10  0              1.0922238e-05  1.1965779e-13  0              3.040235     
   2100000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955115    1.782135e-11   0              1.7210584e-06  1.1965779e-13  0              3.040235     
   2200000   6363.961       200            200            0.0030678465  -0.0027515746   0              0.011955114    1.5567275e-12  0              1.503376e-07   1.1965779e-13  0              3.040235     
   2300000   6363.961       200            200            0.0030678467  -0.0027515746   0              0.011955115    4.9668815e-14  0              4.7966586e-09  1.1965779e-13  0              3.040235     
   2400000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955114    7.2869857e-16  0              7.0372492e-11  1.1965779e-13  0              3.040235     
   2500000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955114    2.2849111e-15  0              2.2066036e-10  1.1965779e-13  0              3.040235     
   2600000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955114    6.9423666e-16  0              6.7044407e-11  1.1965779e-13  0              3.040235     
   2700000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955114    1.0446946e-16  0              1.0088913e-11  1.1965779e-13  0              3.040235     
   2800000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955114    1.1747394e-17  0              1.1344793e-12  1.1965779e-13  0              3.040235     
   2900000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955114    6.9099345e-20  0              6.6731202e-15  1.1965779e-13  0              3.040235     
   3000000   6363.961       200            200            0.0030678466  -0.0027515746   0              0.011955114    6.9855936e-19  0              6.7461863e-14  1.1965779e-13  0              3.040235     
Loop time of 287.495 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9015805.826 ns/day, 0.000 hours/ns, 10434.960 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.96      | 37.557     | 64.636     | 430.6 | 13.06
Neigh   | 3.1867     | 3.2096     | 3.2326     |   0.9 |  1.12
Comm    | 15.262     | 20.255     | 24.441     |  84.7 |  7.05
Output  | 0.24149    | 0.24182    | 0.24216    |   0.1 |  0.08
Modify  | 165.8      | 171.2      | 177.03     |  36.7 | 59.55
Other   |            | 55.03      |            |       | 19.14

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         341.75 ave         684 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1367
Ave neighs/atom = 0.54658137
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.1                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.3167684724676
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.2
  ghost atom cutoff = 3.2
  binsize = 1.6, bins = 3978 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.26 | 80.29 | 80.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.003283622   -1.2693138e-35  0              0.0098508659   606696.19      0              5.8590375e+10  1.1965779e-13  0              3.3295108    
    200000   6363.961       200            200            0.0012565284  -1.0154544e-34  0              0.0037695851   165643.36      0              1.599665e+10   1.1965779e-13  0              3.0935168    
    300000   6363.961       200            200            0.00016935482  1.8601032e-40  0              0.00050806447  5827.6384      0              5.627916e+08   1.1965779e-13  0              3.0903612    
    400000   6363.961       200            200            0.010903102   -0.0065655403   0              0.039274846    5880.4875      0              5.6789539e+08  1.1965779e-13  0              3.0413896    
    500000   6363.961       200            200            0.0058538928  -0.0034176757   0              0.020979354    979.10991      0              94555427       1.1965779e-13  0              3.0437095    
    600000   6363.961       200            200            0.0047050155  -0.0030473345   0              0.017162381    5.9348486      0              573145.19      1.1965779e-13  0              3.0442872    
    700000   6363.961       200            200            0.0025515029  -0.0027299444   0              0.010384453    5.6722049      0              547780.95      1.1965779e-13  0              3.0455656    
    800000   6363.961       200            200            0.0032107968  -0.0027454497   0              0.01237784     2.4013607      0              231906.23      1.1965779e-13  0              3.0451607    
    900000   6363.961       200            200            0.0030590649  -0.0027405201   0              0.011917715    0.47504588     0              45876.531      1.1965779e-13  0              3.0452495    
   1000000   6363.961       200            200            0.0030701054  -0.002745881    0              0.011956197    0.06429923     0              6209.5593      1.1965779e-13  0              3.0452429    
   1100000   6363.961       200            200            0.003082579   -0.002747305    0              0.011995042    0.0055797972   0              538.85688      1.1965779e-13  0              3.0452347    
   1200000   6363.961       200            200            0.0030725789  -0.0027461372   0              0.011963874    0.00021759499  0              21.013766      1.1965779e-13  0              3.0452411    
   1300000   6363.961       200            200            0.0030775423  -0.0027466023   0              0.011979229    1.9175661e-07  0              0.018518481    1.1965779e-13  0              3.045238     
   1400000   6363.961       200            200            0.003075649   -0.0027464095   0              0.011973357    5.1890134e-06  0              0.50111777     1.1965779e-13  0              3.0452392    
   1500000   6363.961       200            200            0.0030762228  -0.0027464641   0              0.011975132    2.0494224e-06  0              0.19791855     1.1965779e-13  0              3.0452388    
   1600000   6363.961       200            200            0.0030761024  -0.0027464533   0              0.01197476     3.9805306e-07  0              0.038441115    1.1965779e-13  0              3.0452389    
   1700000   6363.961       200            200            0.0030761039  -0.0027464533   0              0.011974765    4.860695e-08   0              0.0046941113   1.1965779e-13  0              3.0452389    
   1800000   6363.961       200            200            0.0030761191  -0.0027464547   0              0.011974812    3.5316198e-09  0              0.00034105856  1.1965779e-13  0              3.0452389    
   1900000   6363.961       200            200            0.0030761089  -0.0027464538   0              0.011974781    8.5057592e-11  0              8.2142535e-06  1.1965779e-13  0              3.0452389    
   2000000   6363.961       200            200            0.0030761136  -0.0027464542   0              0.011974795    3.8715696e-12  0              3.7388848e-07  1.1965779e-13  0              3.0452389    
   2100000   6363.961       200            200            0.0030761119  -0.002746454    0              0.01197479     6.4161126e-12  0              6.1962223e-07  1.1965779e-13  0              3.0452389    
   2200000   6363.961       200            200            0.0030761124  -0.0027464541   0              0.011974791    1.9441966e-12  0              1.8775659e-07  1.1965779e-13  0              3.0452389    
   2300000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    3.2778325e-13  0              3.165496e-08   1.1965779e-13  0              3.0452389    
   2400000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    3.513951e-14   0              3.3935224e-09  1.1965779e-13  0              3.0452389    
   2500000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    2.1650573e-15  0              2.0908574e-10  1.1965779e-13  0              3.0452389    
   2600000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    1.2055809e-17  0              1.1642638e-12  1.1965779e-13  0              3.0452389    
   2700000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    8.0361083e-18  0              7.7606982e-13  1.1965779e-13  0              3.0452389    
   2800000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    1.8005333e-18  0              1.7388262e-13  1.1965779e-13  0              3.0452389    
   2900000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    5.077998e-18   0              4.903967e-13   1.1965779e-13  0              3.0452389    
   3000000   6363.961       200            200            0.0030761123  -0.0027464541   0              0.011974791    4.7709006e-18  0              4.6073943e-13  1.1965779e-13  0              3.0452389    
Loop time of 289.163 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8963794.799 ns/day, 0.000 hours/ns, 10374.762 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.915     | 37.792     | 65.213     | 434.0 | 13.07
Neigh   | 3.218      | 3.2418     | 3.2658     |   1.0 |  1.12
Comm    | 15.137     | 20.103     | 24.309     |  86.9 |  6.95
Output  | 0.23987    | 0.2402     | 0.24054    |   0.1 |  0.08
Modify  | 167.42     | 172.61     | 177.57     |  34.5 | 59.69
Other   |            | 55.18      |            |       | 19.08

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.75 ave         688 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1375
Ave neighs/atom = 0.54978009
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.11                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.6499386668908
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.21
  ghost atom cutoff = 3.21
  binsize = 1.605, bins = 3966 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.05 | 77.08 | 77.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0032929907   3.9005199e-40  0              0.009878972    609014.21      0              5.8814233e+10  1.1965779e-13  0              3.3296351    
    200000   6363.961       200            200            0.0012705034  -4.3157029e-34  0              0.0038115101   168305.33      0              1.6253724e+10  1.1965779e-13  0              3.0950774    
    300000   6363.961       200            200            0.00018091186  8.0719905e-43  0              0.00054273558  6560.9336      0              6.33608e+08    1.1965779e-13  0              3.0945954    
    400000   6363.961       200            200            0.013015478   -0.0072104651   0              0.0462569      3963.8191      0              3.8279728e+08  1.1965779e-13  0              3.0456483    
    500000   6363.961       200            200            0.0065663292  -0.0036840104   0              0.023382998    677.2478       0              65403745       1.1965779e-13  0              3.048358     
    600000   6363.961       200            200            0.0045942149  -0.0030265325   0              0.016809177    31.966457      0              3087091.6      1.1965779e-13  0              3.0493529    
    700000   6363.961       200            200            0.0025271643  -0.0026753215   0              0.010256814    1.206331       0              116498.81      1.1965779e-13  0              3.0506019    
    800000   6363.961       200            200            0.0032690656  -0.0027377023   0              0.012544899    1.2492065      0              120639.43      1.1965779e-13  0              3.0501353    
    900000   6363.961       200            200            0.0030391204  -0.0027398834   0              0.011857245    0.34555657     0              33371.38       1.1965779e-13  0              3.0502695    
   1000000   6363.961       200            200            0.0030902252  -0.0027421935   0              0.012012869    0.064706285    0              6248.8698      1.1965779e-13  0              3.0502393    
   1100000   6363.961       200            200            0.0030862108  -0.0027418635   0              0.012000496    0.0087412886   0              844.17108      1.1965779e-13  0              3.0502414    
   1200000   6363.961       200            200            0.0030822273  -0.0027412231   0              0.011987905    0.00085402819  0              82.47593       1.1965779e-13  0              3.050244     
   1300000   6363.961       200            200            0.0030854882  -0.0027416414   0              0.011998106    5.3080089e-05  0              5.1260951      1.1965779e-13  0              3.0502419    
   1400000   6363.961       200            200            0.0030838033  -0.0027414669   0              0.011992877    1.0341939e-06  0              0.099875043    1.1965779e-13  0              3.050243     
   1500000   6363.961       200            200            0.0030845084  -0.0027415337   0              0.011995059    8.4209683e-08  0              0.0081323685   1.1965779e-13  0              3.0502426    
   1600000   6363.961       200            200            0.0030842564  -0.0027415101   0              0.011994279    1.1191784e-07  0              0.010808224    1.1965779e-13  0              3.0502427    
   1700000   6363.961       200            200            0.0030843328  -0.0027415172   0              0.011994516    3.5529634e-08  0              0.0034311977   1.1965779e-13  0              3.0502427    
   1800000   6363.961       200            200            0.0030843148  -0.0027415156   0              0.01199446     6.9129327e-09  0              0.00066760156  1.1965779e-13  0              3.0502427    
   1900000   6363.961       200            200            0.0030843167  -0.0027415157   0              0.011994466    9.7076948e-10  0              9.3749968e-05  1.1965779e-13  0              3.0502427    
   2000000   6363.961       200            200            0.0030843178  -0.0027415158   0              0.011994469    9.9782235e-11  0              9.636254e-06   1.1965779e-13  0              3.0502427    
   2100000   6363.961       200            200            0.0030843168  -0.0027415157   0              0.011994466    6.7382967e-12  0              6.5073646e-07  1.1965779e-13  0              3.0502427    
   2200000   6363.961       200            200            0.0030843174  -0.0027415158   0              0.011994468    1.7584672e-13  0              1.6982018e-08  1.1965779e-13  0              3.0502427    
   2300000   6363.961       200            200            0.0030843171  -0.0027415158   0              0.011994467    4.2325543e-15  0              4.087498e-10   1.1965779e-13  0              3.0502427    
   2400000   6363.961       200            200            0.0030843172  -0.0027415158   0              0.011994467    1.0326049e-14  0              9.9721589e-10  1.1965779e-13  0              3.0502427    
   2500000   6363.961       200            200            0.0030843172  -0.0027415158   0              0.011994467    3.7090524e-15  0              3.5819373e-10  1.1965779e-13  0              3.0502427    
   2600000   6363.961       200            200            0.0030843172  -0.0027415158   0              0.011994467    7.4080734e-16  0              7.1541871e-11  1.1965779e-13  0              3.0502427    
   2700000   6363.961       200            200            0.0030843172  -0.0027415158   0              0.011994467    1.0539462e-16  0              1.0178258e-11  1.1965779e-13  0              3.0502427    
   2800000   6363.961       200            200            0.0030843172  -0.0027415158   0              0.011994467    1.4027263e-17  0              1.3546526e-12  1.1965779e-13  0              3.0502427    
   2900000   6363.961       200            200            0.0030843172  -0.0027415158   0              0.011994467    1.0405213e-21  0              1.004861e-16   1.1965779e-13  0              3.0502427    
   3000000   6363.961       200            200            0.0030843172  -0.0027415158   0              0.011994467    4.4656382e-20  0              4.3125938e-15  1.1965779e-13  0              3.0502427    
Loop time of 290.068 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8935851.055 ns/day, 0.000 hours/ns, 10342.420 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.12      | 37.973     | 65.282     | 434.3 | 13.09
Neigh   | 3.1531     | 3.1768     | 3.2003     |   0.9 |  1.10
Comm    | 14.943     | 20.824     | 26.044     | 106.4 |  7.18
Output  | 0.2427     | 0.24302    | 0.24337    |   0.1 |  0.08
Modify  | 168.93     | 172.81     | 177.31     |  25.3 | 59.58
Other   |            | 55.04      |            |       | 18.97

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         346.25 ave         693 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1385
Ave neighs/atom = 0.55377849
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.12                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.9852583390075
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.22
  ghost atom cutoff = 3.22
  binsize = 1.61, bins = 3953 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.91 | 76.92 | 76.92 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033023611   7.615957e-35   0              0.0099070832   611335.59      0              5.9038415e+10  1.1965779e-13  0              3.3297478    
    200000   6363.961       200            200            0.0012845206  -1.2693101e-35  0              0.0038535617   170986.22      0              1.6512626e+10  1.1965779e-13  0              3.0966072    
    300000   6363.961       200            200            0.00019259282 -1.2693183e-35  0              0.00057777846  7336.7676      0              7.085325e+08   1.1965779e-13  0              3.0987834    
    400000   6363.961       200            200            0.014810286   -0.0077295892   0              0.052160447    2146.96        0              2.0733803e+08  1.1965779e-13  0              3.0500684    
    500000   6363.961       200            200            0.0071252908  -0.0040265186   0              0.025402391    384.83715      0              37164817       1.1965779e-13  0              3.0530786    
    600000   6363.961       200            200            0.0043830095  -0.0030380525   0              0.016187081    72.980962      0              7047978.9      1.1965779e-13  0              3.0544656    
    700000   6363.961       200            200            0.0025263842  -0.0026636571   0              0.01024281     0.064234077    0              6203.2674      1.1965779e-13  0              3.0556138    
    800000   6363.961       200            200            0.0033082193  -0.0027335814   0              0.012658239    0.33233357     0              32094.397      1.1965779e-13  0              3.0551205    
    900000   6363.961       200            200            0.0030255806  -0.0027377793   0              0.011814521    0.16915797     0              16336.066      1.1965779e-13  0              3.055286     
   1000000   6363.961       200            200            0.0031091475  -0.0027391595   0              0.012066602    0.04488124     0              4334.3089      1.1965779e-13  0              3.0552363    
   1100000   6363.961       200            200            0.0030893758  -0.0027363983   0              0.012004526    0.0083285046   0              804.30736      1.1965779e-13  0              3.0552483    
   1200000   6363.961       200            200            0.0030923912  -0.0027366265   0              0.0120138      0.001218913    0              117.71389      1.1965779e-13  0              3.0552466    
   1300000   6363.961       200            200            0.0030929625  -0.0027367848   0              0.012015672    0.00014420862  0              13.926636      1.1965779e-13  0              3.0552461    
   1400000   6363.961       200            200            0.0030921409  -0.0027367026   0              0.012013125    1.3374615e-05  0              1.2916246      1.1965779e-13  0              3.0552467    
   1500000   6363.961       200            200            0.0030926321  -0.0027367509   0              0.012014647    8.6185161e-07  0              0.08323146     1.1965779e-13  0              3.0552464    
   1600000   6363.961       200            200            0.0030924007  -0.0027367284   0              0.012013931    2.357846e-08   0              0.0022770389   1.1965779e-13  0              3.0552465    
   1700000   6363.961       200            200            0.0030924956  -0.0027367376   0              0.012014224    3.3150666e-10  0              3.201454e-05   1.1965779e-13  0              3.0552465    
   1800000   6363.961       200            200            0.0030924607  -0.0027367342   0              0.012014116    1.1144776e-09  0              0.00010762827  1.1965779e-13  0              3.0552465    
   1900000   6363.961       200            200            0.0030924722  -0.0027367353   0              0.012014152    4.3254349e-10  0              4.1771954e-05  1.1965779e-13  0              3.0552465    
   2000000   6363.961       200            200            0.0030924689  -0.002736735    0              0.012014142    9.9702284e-11  0              9.6285329e-06  1.1965779e-13  0              3.0552465    
   2100000   6363.961       200            200            0.0030924697  -0.0027367351   0              0.012014144    1.7228292e-11  0              1.6637851e-06  1.1965779e-13  0              3.0552465    
   2200000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    2.3862826e-12  0              2.3045009e-07  1.1965779e-13  0              3.0552465    
   2300000   6363.961       200            200            0.0030924695  -0.0027367351   0              0.012014144    2.6650396e-13  0              2.5737045e-08  1.1965779e-13  0              3.0552465    
   2400000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    2.2969859e-14  0              2.2182646e-09  1.1965779e-13  0              3.0552465    
   2500000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    1.3498186e-15  0              1.3035582e-10  1.1965779e-13  0              3.0552465    
   2600000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    1.3363465e-17  0              1.2905478e-12  1.1965779e-13  0              3.0552465    
   2700000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    9.7392755e-19  0              9.4054952e-14  1.1965779e-13  0              3.0552465    
   2800000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    6.4378507e-20  0              6.2172154e-15  1.1965779e-13  0              3.0552465    
   2900000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    4.2195035e-18  0              4.0748945e-13  1.1965779e-13  0              3.0552465    
   3000000   6363.961       200            200            0.0030924696  -0.0027367351   0              0.012014144    3.1645794e-18  0              3.0561242e-13  1.1965779e-13  0              3.0552465    
Loop time of 288.259 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8991906.987 ns/day, 0.000 hours/ns, 10407.300 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.903     | 38.189     | 65.784     | 438.2 | 13.25
Neigh   | 3.142      | 3.1662     | 3.1902     |   1.0 |  1.10
Comm    | 15.2       | 20.235     | 24.618     |  85.6 |  7.02
Output  | 0.24115    | 0.24151    | 0.24188    |   0.1 |  0.08
Modify  | 166.94     | 171.49     | 176.58     |  30.2 | 59.49
Other   |            | 54.94      |            |       | 19.06

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         348.75 ave         698 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1395
Ave neighs/atom = 0.55777689
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.13                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.3227344003217
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.23
  ghost atom cutoff = 3.23
  binsize = 1.615, bins = 3941 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.74 | 75.74 | 75.75 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033117331   2.1573044e-41  0              0.0099351993   613660.31      0              5.9262921e+10  1.1965779e-13  0              3.329849     
    200000   6363.961       200            200            0.0012985794   1.7409451e-41  0              0.0038957383   173685.95      0              1.6773346e+10  1.1965779e-13  0              3.098106     
    300000   6363.961       200            200            0.00020439666 -1.0154577e-34  0              0.00061318999  8154.9796      0              7.8754956e+08  1.1965779e-13  0              3.102925     
    400000   6363.961       200            200            0.016109266   -0.0080393086   0              0.056367107    752.64374      0              72684946       1.1965779e-13  0              3.0546783    
    500000   6363.961       200            200            0.0075401794  -0.0042551009   0              0.026875639    151.60587      0              14641010       1.1965779e-13  0              3.057884     
    600000   6363.961       200            200            0.0041202723  -0.0029847764   0              0.015345593    119.83622      0              11572925       1.1965779e-13  0              3.059619     
    700000   6363.961       200            200            0.0025589915  -0.0026672484   0              0.010344223    2.5137058      0              242755.72      1.1965779e-13  0              3.0606008    
    800000   6363.961       200            200            0.0033253606  -0.0027318633   0              0.012707945    0.00041252706  0              39.838911      1.1965779e-13  0              3.0601181    
    900000   6363.961       200            200            0.0030206956  -0.0027353105   0              0.011797397    0.033362501    0              3221.9116      1.1965779e-13  0              3.0602973    
   1000000   6363.961       200            200            0.0031249585  -0.0027366059   0              0.012111481    0.017744651    0              1713.6514      1.1965779e-13  0              3.060235     
   1100000   6363.961       200            200            0.0030930325  -0.0027316767   0              0.012010774    0.0047147839   0              455.32008      1.1965779e-13  0              3.0602547    
   1200000   6363.961       200            200            0.0031023104  -0.0027327805   0              0.012039712    0.00093962516  0              90.742272      1.1965779e-13  0              3.0602491    
   1300000   6363.961       200            200            0.0031000389  -0.002732631    0              0.012032748    0.000155323    0              14.999983      1.1965779e-13  0              3.0602504    
   1400000   6363.961       200            200            0.0031003752  -0.0027326603   0              0.012033786    2.2116069e-05  0              2.1358117      1.1965779e-13  0              3.0602503    
   1500000   6363.961       200            200            0.0031004404  -0.0027326679   0              0.012033989    2.7342199e-06  0              0.26405139     1.1965779e-13  0              3.0602502    
   1600000   6363.961       200            200            0.0031003488  -0.0027326586   0              0.012033705    2.8963341e-07  0              0.027970721    1.1965779e-13  0              3.0602503    
   1700000   6363.961       200            200            0.0031004049  -0.0027326642   0              0.012033879    2.5149404e-08  0              0.0024287494   1.1965779e-13  0              3.0602502    
   1800000   6363.961       200            200            0.0031003775  -0.0027326615   0              0.012033794    1.5892406e-09  0              0.00015347748  1.1965779e-13  0              3.0602503    
   1900000   6363.961       200            200            0.0031003894  -0.0027326626   0              0.012033831    4.7338504e-11  0              4.5716139e-06  1.1965779e-13  0              3.0602502    
   2000000   6363.961       200            200            0.0031003847  -0.0027326622   0              0.012033816    2.4690501e-13  0              2.3844319e-08  1.1965779e-13  0              3.0602502    
   2100000   6363.961       200            200            0.0031003864  -0.0027326623   0              0.012033822    1.6375844e-12  0              1.5814618e-07  1.1965779e-13  0              3.0602502    
   2200000   6363.961       200            200            0.0031003858  -0.0027326623   0              0.01203382     7.049563e-13   0              6.8079633e-08  1.1965779e-13  0              3.0602502    
   2300000   6363.961       200            200            0.003100386   -0.0027326623   0              0.01203382     1.7916825e-13  0              1.7302787e-08  1.1965779e-13  0              3.0602502    
   2400000   6363.961       200            200            0.0031003859  -0.0027326623   0              0.01203382     3.4794417e-14  0              3.3601958e-09  1.1965779e-13  0              3.0602502    
   2500000   6363.961       200            200            0.003100386   -0.0027326623   0              0.01203382     5.6714235e-15  0              5.4770549e-10  1.1965779e-13  0              3.0602502    
   2600000   6363.961       200            200            0.003100386   -0.0027326623   0              0.01203382     7.9536392e-16  0              7.6810554e-11  1.1965779e-13  0              3.0602502    
   2700000   6363.961       200            200            0.003100386   -0.0027326623   0              0.01203382     9.7640504e-17  0              9.429421e-12   1.1965779e-13  0              3.0602502    
   2800000   6363.961       200            200            0.003100386   -0.0027326623   0              0.01203382     1.3595921e-17  0              1.3129967e-12  1.1965779e-13  0              3.0602502    
   2900000   6363.961       200            200            0.003100386   -0.0027326623   0              0.01203382     1.2381675e-19  0              1.1957336e-14  1.1965779e-13  0              3.0602502    
   3000000   6363.961       200            200            0.003100386   -0.0027326623   0              0.01203382     9.1618051e-19  0              8.8478156e-14  1.1965779e-13  0              3.0602502    
Loop time of 285.476 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9079564.442 ns/day, 0.000 hours/ns, 10508.755 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.953     | 37.129     | 63.748     | 426.3 | 13.01
Neigh   | 3.0539     | 3.08       | 3.1056     |   1.0 |  1.08
Comm    | 15.069     | 19.939     | 24.155     |  85.5 |  6.98
Output  | 0.24042    | 0.24074    | 0.24109    |   0.1 |  0.08
Modify  | 164.29     | 169.99     | 175.5      |  38.7 | 59.55
Other   |            | 55.09      |            |       | 19.30

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         326.25 ave         653 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1305
Ave neighs/atom = 0.52179128
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.14                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.6623737623371
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.24
  ghost atom cutoff = 3.24
  binsize = 1.62, bins = 3929 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.55 | 75.55 | 75.56 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033211067  -2.5386384e-35  0              0.00996332     615988.39      0              5.948775e+10   1.1965779e-13  0              3.3299386    
    200000   6363.961       200            200            0.0013126797  -5.0772769e-35  0              0.0039380391   176404.46      0              1.703588e+10   1.1965779e-13  0              3.0995739    
    300000   6363.961       200            200            0.00021632265 -6.3466249e-36  0              0.00064896794  9015.4288      0              8.7064559e+08  1.1965779e-13  0              3.1070203    
    400000   6363.961       200            200            0.016748858   -0.0081546325   0              0.058401206    50.818375      0              4907674.9      1.1965779e-13  0              3.0594983    
    500000   6363.961       200            200            0.0077594174  -0.0043947135   0              0.027672966    19.611761      0              1893963.5      1.1965779e-13  0              3.0627838    
    600000   6363.961       200            200            0.0037858983  -0.0029882742   0              0.014345969    162.47639      0              15690807       1.1965779e-13  0              3.0648047    
    700000   6363.961       200            200            0.0026266197  -0.0026771577   0              0.010557017    7.9009842      0              763020.5       1.1965779e-13  0              3.0655643    
    800000   6363.961       200            200            0.0033207117  -0.0027286688   0              0.012690804    0.37633077     0              36343.332      1.1965779e-13  0              3.0651286    
    900000   6363.961       200            200            0.003025931   -0.0027326594   0              0.011810452    0.0047075208   0              454.61867      1.1965779e-13  0              3.0653026    
   1000000   6363.961       200            200            0.0031360043  -0.0027350992   0              0.012143112    0.0010229849   0              98.792563      1.1965779e-13  0              3.0652363    
   1100000   6363.961       200            200            0.0030977714  -0.0027288618   0              0.012022176    0.0009717465   0              93.844322      1.1965779e-13  0              3.0652602    
   1200000   6363.961       200            200            0.0031111138  -0.0027306042   0              0.012063946    0.00032514289  0              31.399973      1.1965779e-13  0              3.065252     
   1300000   6363.961       200            200            0.0031066743  -0.002730191    0              0.012050214    7.6447588e-05  0              7.3827609      1.1965779e-13  0              3.0652547    
   1400000   6363.961       200            200            0.0031080408  -0.002730324    0              0.012054446    1.4833471e-05  0              1.4325105      1.1965779e-13  0              3.0652538    
   1500000   6363.961       200            200            0.0031076565  -0.0027302871   0              0.012053257    2.5222869e-06  0              0.24358441     1.1965779e-13  0              3.0652541    
   1600000   6363.961       200            200            0.0031077483  -0.0027302957   0              0.012053541    3.8662831e-07  0              0.037337795    1.1965779e-13  0              3.065254     
   1700000   6363.961       200            200            0.0031077342  -0.0027302945   0              0.012053497    5.4109184e-08  0              0.0052254777   1.1965779e-13  0              3.065254     
   1800000   6363.961       200            200            0.003107732   -0.0027302942   0              0.01205349     6.9376369e-09  0              0.00066998732  1.1965779e-13  0              3.065254     
   1900000   6363.961       200            200            0.0031077354  -0.0027302946   0              0.012053501    8.1115633e-10  0              7.8335672e-05  1.1965779e-13  0              3.065254     
   2000000   6363.961       200            200            0.0031077332  -0.0027302944   0              0.012053494    8.5241631e-11  0              8.2320266e-06  1.1965779e-13  0              3.065254     
   2100000   6363.961       200            200            0.0031077344  -0.0027302945   0              0.012053498    7.8030854e-12  0              7.5356614e-07  1.1965779e-13  0              3.065254     
   2200000   6363.961       200            200            0.0031077338  -0.0027302944   0              0.012053496    5.8068531e-13  0              5.6078431e-08  1.1965779e-13  0              3.065254     
   2300000   6363.961       200            200            0.0031077341  -0.0027302945   0              0.012053497    2.902672e-14   0              2.8031928e-09  1.1965779e-13  0              3.065254     
   2400000   6363.961       200            200            0.003107734   -0.0027302944   0              0.012053496    3.658374e-16   0              3.5329958e-11  1.1965779e-13  0              3.065254     
   2500000   6363.961       200            200            0.003107734   -0.0027302945   0              0.012053496    1.0717044e-16  0              1.0349754e-11  1.1965779e-13  0              3.065254     
   2600000   6363.961       200            200            0.003107734   -0.0027302945   0              0.012053496    8.9403164e-17  0              8.6339177e-12  1.1965779e-13  0              3.065254     
   2700000   6363.961       200            200            0.003107734   -0.0027302945   0              0.012053496    2.1366452e-17  0              2.063419e-12   1.1965779e-13  0              3.065254     
   2800000   6363.961       200            200            0.003107734   -0.0027302945   0              0.012053496    8.9971181e-19  0              8.6887726e-14  1.1965779e-13  0              3.065254     
   2900000   6363.961       200            200            0.003107734   -0.0027302944   0              0.012053496    2.8909771e-18  0              2.7918988e-13  1.1965779e-13  0              3.065254     
   3000000   6363.961       200            200            0.003107734   -0.0027302945   0              0.012053496    1.1655263e-18  0              1.1255819e-13  1.1965779e-13  0              3.065254     
Loop time of 286.767 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9038711.220 ns/day, 0.000 hours/ns, 10461.471 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.971     | 37.327     | 64.069     | 428.5 | 13.02
Neigh   | 2.9875     | 3.0116     | 3.0358     |   1.0 |  1.05
Comm    | 14.885     | 19.833     | 24.164     |  86.3 |  6.92
Output  | 0.23785    | 0.23818    | 0.23853    |   0.1 |  0.08
Modify  | 165.94     | 171.44     | 177.18     |  37.4 | 59.78
Other   |            | 54.92      |            |       | 19.15

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.52738904
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.15                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.0041833365577
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.25
  ghost atom cutoff = 3.25
  binsize = 1.625, bins = 3917 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.36 | 75.36 | 75.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033304818  -3.1733099e-36  0              0.0099914453   618319.81      0              5.9712902e+10  1.1965779e-13  0              3.3300167    
    200000   6363.961       200            200            0.0013268211  -5.0772383e-35  0              0.0039804632   179141.71      0              1.7300224e+10  1.1965779e-13  0              3.1010108    
    300000   6363.961       200            200            0.00022837     2.5387179e-35  0              0.00068511     9917.9744      0              9.5780698e+08  1.1965779e-13  0              3.1110692    
    400000   6363.961       200            200            0.016624796   -0.00814178     0              0.058016169    183.45862      0              17717120       1.1965779e-13  0              3.0645388    
    500000   6363.961       200            200            0.0077696238  -0.0044105591   0              0.027719431    13.424776      0              1296468.8      1.1965779e-13  0              3.067783     
    600000   6363.961       200            200            0.0034098629  -0.0030294637   0              0.013259052    192.22953      0              18564152       1.1965779e-13  0              3.070013     
    700000   6363.961       200            200            0.0027276472  -0.0026882026   0              0.010871144    14.811502      0              1430388.8      1.1965779e-13  0              3.0705068    
    800000   6363.961       200            200            0.0032957931  -0.0027233163   0              0.012610696    1.3095878      0              126470.62      1.1965779e-13  0              3.0701513    
    900000   6363.961       200            200            0.0030414822  -0.0027300469   0              0.011854494    0.096361024    0              9305.858       1.1965779e-13  0              3.0703016    
   1000000   6363.961       200            200            0.0031423542  -0.0027323618   0              0.012159424    0.0055262517   0              533.68583      1.1965779e-13  0              3.0702406    
   1100000   6363.961       200            200            0.0031048003  -0.0027260199   0              0.012040421    0.00016275822  0              15.718023      1.1965779e-13  0              3.0702643    
   1200000   6363.961       200            200            0.0031191303  -0.0027279396   0              0.012085331    4.8776174e-07  0              0.047104537    1.1965779e-13  0              3.0702554    
   1300000   6363.961       200            200            0.0031137865  -0.0027274115   0              0.012068771    4.9458776e-06  0              0.47763746     1.1965779e-13  0              3.0702586    
   1400000   6363.961       200            200            0.0031157083  -0.0027276029   0              0.012074728    2.3090696e-06  0              0.22299341     1.1965779e-13  0              3.0702575    
   1500000   6363.961       200            200            0.0031150338  -0.0027275362   0              0.012072638    6.442666e-07   0              0.062218657    1.1965779e-13  0              3.0702579    
   1600000   6363.961       200            200            0.0031152641  -0.0027275589   0              0.012073351    1.4253455e-07  0              0.013764967    1.1965779e-13  0              3.0702577    
   1700000   6363.961       200            200            0.003115188   -0.0027275514   0              0.012073115    2.7461914e-08  0              0.0026520751   1.1965779e-13  0              3.0702578    
   1800000   6363.961       200            200            0.0031152121  -0.0027275538   0              0.01207319     4.8081172e-09  0              0.00046433354  1.1965779e-13  0              3.0702578    
   1900000   6363.961       200            200            0.0031152049  -0.0027275531   0              0.012073168    7.8229729e-10  0              7.5548673e-05  1.1965779e-13  0              3.0702578    
   2000000   6363.961       200            200            0.0031152069  -0.0027275533   0              0.012073174    1.1981092e-10  0              1.1570481e-05  1.1965779e-13  0              3.0702578    
   2100000   6363.961       200            200            0.0031152064  -0.0027275533   0              0.012073172    1.7399028e-11  0              1.6802736e-06  1.1965779e-13  0              3.0702578    
   2200000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    2.4043864e-12  0              2.3219843e-07  1.1965779e-13  0              3.0702578    
   2300000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    3.1672364e-13  0              3.0586902e-08  1.1965779e-13  0              3.0702578    
   2400000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    3.9780179e-14  0              3.841685e-09   1.1965779e-13  0              3.0702578    
   2500000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    4.7781202e-15  0              4.6143665e-10  1.1965779e-13  0              3.0702578    
   2600000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    5.0023084e-16  0              4.8308714e-11  1.1965779e-13  0              3.0702578    
   2700000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    5.5058174e-17  0              5.3171243e-12  1.1965779e-13  0              3.0702578    
   2800000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    1.0591988e-17  0              1.0228984e-12  1.1965779e-13  0              3.0702578    
   2900000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    2.4363166e-18  0              2.3528202e-13  1.1965779e-13  0              3.0702578    
   3000000   6363.961       200            200            0.0031152065  -0.0027275533   0              0.012073173    4.5566982e-18  0              4.400533e-13   1.1965779e-13  0              3.0702578    
Loop time of 287.196 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9025182.469 ns/day, 0.000 hours/ns, 10445.813 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.967     | 37.524     | 64.578     | 430.8 | 13.07
Neigh   | 2.8992     | 2.9229     | 2.9467     |   1.0 |  1.02
Comm    | 14.819     | 19.624     | 23.755     |  84.6 |  6.83
Output  | 0.24083    | 0.24114    | 0.24148    |   0.1 |  0.08
Modify  | 166.64     | 171.63     | 176.6      |  35.1 | 59.76
Other   |            | 55.25      |            |       | 19.24

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.75 ave         664 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1327
Ave neighs/atom = 0.53058776
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.16                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.3481700344871
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.26
  ghost atom cutoff = 3.26
  binsize = 1.63, bins = 3905 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.2 | 74.21 | 74.21 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033398583   3.8079821e-35  0              0.010019575    620654.58      0              5.9938376e+10  1.1965779e-13  0              3.3300832    
    200000   6363.961       200            200            0.0013410031   1.3559587e-40  0              0.0040230093   181897.65      0              1.7566373e+10  1.1965779e-13  0              3.1024166    
    300000   6363.961       200            200            0.00024053779  6.3466305e-36  0              0.00072161337  10862.463      0              1.0490189e+09  1.1965779e-13  0              3.1150715    
    400000   6363.961       200            200            0.015706817   -0.0081137952   0              0.055234246    1122.0577      0              1.083603e+08   1.1965779e-13  0              3.0697985    
    500000   6363.961       200            200            0.0075431899  -0.0043773311   0              0.027006901    133.90601      0              12931684       1.1965779e-13  0              3.0728819    
    600000   6363.961       200            200            0.0030749438  -0.0029273697   0              0.012152201    203.61264      0              19663451       1.1965779e-13  0              3.0752331    
    700000   6363.961       200            200            0.0028541046  -0.0027079856   0              0.011270299    21.417337      0              2068333.1      1.1965779e-13  0              3.0754326    
    800000   6363.961       200            200            0.00325563    -0.0027111977   0              0.012478088    2.4376495      0              235410.74      1.1965779e-13  0              3.0751843    
    900000   6363.961       200            200            0.0030659849  -0.0027285225   0              0.011926477    0.26219839     0              25321.244      1.1965779e-13  0              3.0752951    
   1000000   6363.961       200            200            0.0031438219  -0.0027296014   0              0.012161067    0.028064068    0              2710.2268      1.1965779e-13  0              3.0752479    
   1100000   6363.961       200            200            0.0031139034  -0.0027239895   0              0.0120657      0.002874144    0              277.56426      1.1965779e-13  0              3.0752669    
   1200000   6363.961       200            200            0.0031259356  -0.0027256762   0              0.012103483    0.00027729389  0              26.779059      1.1965779e-13  0              3.0752594    
   1300000   6363.961       200            200            0.0031211824  -0.0027251961   0              0.012088743    2.4341062e-05  0              2.3506856      1.1965779e-13  0              3.0752623    
   1400000   6363.961       200            200            0.003123011   -0.0027253819   0              0.012094415    1.8488076e-06  0              0.17854461     1.1965779e-13  0              3.0752612    
   1500000   6363.961       200            200            0.0031223157  -0.0027253116   0              0.012092259    1.0762298e-07  0              0.010393457    1.1965779e-13  0              3.0752616    
   1600000   6363.961       200            200            0.003122577   -0.002725338    0              0.012093069    3.1742547e-09  0              0.0003065468   1.1965779e-13  0              3.0752615    
   1700000   6363.961       200            200            0.0031224798  -0.0027253282   0              0.012092768    9.4362183e-12  0              9.1128242e-07  1.1965779e-13  0              3.0752615    
   1800000   6363.961       200            200            0.0031225156  -0.0027253318   0              0.012092879    9.6828128e-11  0              9.3509675e-06  1.1965779e-13  0              3.0752615    
   1900000   6363.961       200            200            0.0031225026  -0.0027253305   0              0.012092838    4.5883971e-11  0              4.4311455e-06  1.1965779e-13  0              3.0752615    
   2000000   6363.961       200            200            0.0031225073  -0.0027253309   0              0.012092853    1.3119985e-11  0              1.2670342e-06  1.1965779e-13  0              3.0752615    
   2100000   6363.961       200            200            0.0031225056  -0.0027253308   0              0.012092848    3.000467e-12   0              2.8976363e-07  1.1965779e-13  0              3.0752615    
   2200000   6363.961       200            200            0.0031225062  -0.0027253308   0              0.012092849    6.0425925e-13  0              5.8355033e-08  1.1965779e-13  0              3.0752615    
   2300000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    1.1214006e-13  0              1.0829684e-08  1.1965779e-13  0              3.0752615    
   2400000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    1.9424551e-14  0              1.8758841e-09  1.1965779e-13  0              3.0752615    
   2500000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    3.2031268e-15  0              3.0933506e-10  1.1965779e-13  0              3.0752615    
   2600000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    5.1956062e-16  0              5.0175446e-11  1.1965779e-13  0              3.0752615    
   2700000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    7.2359395e-17  0              6.9879525e-12  1.1965779e-13  0              3.0752615    
   2800000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    4.5305568e-18  0              4.3752875e-13  1.1965779e-13  0              3.0752615    
   2900000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    6.4059764e-19  0              6.1864334e-14  1.1965779e-13  0              3.0752615    
   3000000   6363.961       200            200            0.003122506   -0.0027253308   0              0.012092849    7.882393e-22   0              7.612251e-17   1.1965779e-13  0              3.0752615    
Loop time of 287.237 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9023910.172 ns/day, 0.000 hours/ns, 10444.340 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.097     | 37.446     | 64.325     | 429.1 | 13.04
Neigh   | 2.8433     | 2.8656     | 2.8876     |   0.9 |  1.00
Comm    | 14.291     | 20.182     | 25.394     | 109.7 |  7.03
Output  | 0.24386    | 0.24422    | 0.24458    |   0.1 |  0.09
Modify  | 167.58     | 171.74     | 176.01     |  26.8 | 59.79
Other   |            | 54.76      |            |       | 19.07

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         334.75 ave         670 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1339
Ave neighs/atom = 0.53538585
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.17                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.6943407676294
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.27
  ghost atom cutoff = 3.27
  binsize = 1.635, bins = 3893 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.01 | 74.02 | 74.03 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033492363   8.4105083e-42  0              0.010047709    622992.68      0              6.0164174e+10  1.1965779e-13  0              3.330138     
    200000   6363.961       200            200            0.0013552255   3.1733172e-36  0              0.0040656765   184672.23      0              1.7834322e+10  1.1965779e-13  0              3.1037912    
    300000   6363.961       200            200            0.00025282524  7.6159591e-34  0              0.00075847571  11848.754      0              1.1442678e+09  1.1965779e-13  0              3.1190272    
    400000   6363.961       200            200            0.013954172   -0.0084880584   0              0.050350574    2674.17        0              2.5825219e+08  1.1965779e-13  0              3.0752646    
    500000   6363.961       200            200            0.0071083055  -0.0042704621   0              0.025595379    357.81395      0              34555110       1.1965779e-13  0              3.0780761    
    600000   6363.961       200            200            0.002743408   -0.0028597013   0              0.011089925    195.16318      0              18847463       1.1965779e-13  0              3.080454     
    700000   6363.961       200            200            0.0030166898  -0.0026831457   0              0.011733215    25.93718       0              2504827.2      1.1965779e-13  0              3.0803468    
    800000   6363.961       200            200            0.0032025387  -0.0027010818   0              0.012308698    3.3291106      0              321501.67      1.1965779e-13  0              3.0802246    
    900000   6363.961       200            200            0.0030969503  -0.0027290549   0              0.012019906    0.41985585     0              40546.673      1.1965779e-13  0              3.0802843    
   1000000   6363.961       200            200            0.0031413026  -0.0027273174   0              0.012151225    0.053809614    0              5196.5474      1.1965779e-13  0              3.0802573    
   1100000   6363.961       200            200            0.0031245423  -0.002723101    0              0.012096728    0.0068572956   0              662.22852      1.1965779e-13  0              3.0802684    
   1200000   6363.961       200            200            0.0031315343  -0.0027242613   0              0.012118864    0.00087085185  0              84.100638      1.1965779e-13  0              3.0802639    
   1300000   6363.961       200            200            0.0031286803  -0.0027239632   0              0.012110004    0.00010971065  0              10.59507       1.1965779e-13  0              3.0802657    
   1400000   6363.961       200            200            0.0031298124  -0.0027240816   0              0.012113519    1.3719228e-05  0              1.3249048      1.1965779e-13  0              3.080265     
   1500000   6363.961       200            200            0.0031293669  -0.0027240352   0              0.012112136    1.7009395e-06  0              0.16426457     1.1965779e-13  0              3.0802653    
   1600000   6363.961       200            200            0.003129541   -0.0027240533   0              0.012112676    2.0897474e-07  0              0.020181284    1.1965779e-13  0              3.0802652    
   1700000   6363.961       200            200            0.0031294734  -0.0027240463   0              0.012112466    2.5416694e-08  0              0.0024545624   1.1965779e-13  0              3.0802652    
   1800000   6363.961       200            200            0.0031294995  -0.002724049    0              0.012112548    3.0570756e-09  0              0.00029523048  1.1965779e-13  0              3.0802652    
   1900000   6363.961       200            200            0.0031294895  -0.002724048    0              0.012112516    3.6311844e-10  0              3.506738e-05   1.1965779e-13  0              3.0802652    
   2000000   6363.961       200            200            0.0031294933  -0.0027240484   0              0.012112528    4.2528307e-11  0              4.1070795e-06  1.1965779e-13  0              3.0802652    
   2100000   6363.961       200            200            0.0031294918  -0.0027240482   0              0.012112524    4.9002062e-12  0              4.7322684e-07  1.1965779e-13  0              3.0802652    
   2200000   6363.961       200            200            0.0031294924  -0.0027240483   0              0.012112525    5.5424527e-13  0              5.3525041e-08  1.1965779e-13  0              3.0802652    
   2300000   6363.961       200            200            0.0031294922  -0.0027240482   0              0.012112525    6.0940013e-14  0              5.8851503e-09  1.1965779e-13  0              3.0802652    
   2400000   6363.961       200            200            0.0031294923  -0.0027240482   0              0.012112525    6.3808709e-15  0              6.1621884e-10  1.1965779e-13  0              3.0802652    
   2500000   6363.961       200            200            0.0031294922  -0.0027240482   0              0.012112525    6.0609599e-16  0              5.8532412e-11  1.1965779e-13  0              3.0802652    
   2600000   6363.961       200            200            0.0031294923  -0.0027240482   0              0.012112525    5.4949684e-17  0              5.3066472e-12  1.1965779e-13  0              3.0802652    
   2700000   6363.961       200            200            0.0031294923  -0.0027240482   0              0.012112525    1.0361482e-17  0              1.0006378e-12  1.1965779e-13  0              3.0802652    
   2800000   6363.961       200            200            0.0031294923  -0.0027240482   0              0.012112525    3.8064674e-18  0              3.6760137e-13  1.1965779e-13  0              3.0802652    
   2900000   6363.961       200            200            0.0031294923  -0.0027240482   0              0.012112525    5.1121107e-18  0              4.9369106e-13  1.1965779e-13  0              3.0802652    
   3000000   6363.961       200            200            0.0031294923  -0.0027240482   0              0.012112525    7.4465335e-18  0              7.1913291e-13  1.1965779e-13  0              3.0802652    
Loop time of 287.129 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9027315.793 ns/day, 0.000 hours/ns, 10448.282 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.12      | 37.62      | 64.516     | 430.6 | 13.10
Neigh   | 2.8749     | 2.8976     | 2.9201     |   0.9 |  1.01
Comm    | 14.337     | 20.132     | 25.414     | 108.7 |  7.01
Output  | 0.24187    | 0.2422     | 0.24256    |   0.1 |  0.08
Modify  | 167.56     | 171.53     | 175.55     |  25.5 | 59.74
Other   |            | 54.7       |            |       | 19.05

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         337.25 ave         675 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1349
Ave neighs/atom = 0.53938425
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.18                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.0427024474883
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.28
  ghost atom cutoff = 3.28
  binsize = 1.64, bins = 3881 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.88 | 72.88 | 72.89 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033586157   1.2693404e-35  0              0.010075847    625334.11      0              6.0390293e+10  1.1965779e-13  0              3.3301813    
    200000   6363.961       200            200            0.0013694879   6.3466549e-36  0              0.0041084636   187465.39      0              1.8104065e+10  1.1965779e-13  0              3.1051346    
    300000   6363.961       200            200            0.00026523142  2.5387258e-35  0              0.00079569427  12876.694      0              1.243539e+09   1.1965779e-13  0              3.1229363    
    400000   6363.961       200            200            0.011756885   -0.008619817    0              0.043890471    4537.3256      0              4.3818243e+08  1.1965779e-13  0              3.0809143    
    500000   6363.961       200            200            0.0064675007  -0.0042042785   0              0.023606781    643.43063      0              62137925       1.1965779e-13  0              3.0833566    
    600000   6363.961       200            200            0.0024759848  -0.0026915955   0              0.01011955     169.34165      0              16353804       1.1965779e-13  0              3.0856653    
    700000   6363.961       200            200            0.0031846695  -0.0026780929   0              0.012232101    27.104258      0              2617535.2      1.1965779e-13  0              3.0852556    
    800000   6363.961       200            200            0.0031389213  -0.0027048431   0              0.012121607    3.6497072      0              352462.6       1.1965779e-13  0              3.0852687    
    900000   6363.961       200            200            0.0031314201  -0.0027313563   0              0.012125617    0.49116788     0              47433.478      1.1965779e-13  0              3.0852711    
   1000000   6363.961       200            200            0.0031369936  -0.0027239918   0              0.012134973    0.066176725    0              6390.8744      1.1965779e-13  0              3.0852681    
   1100000   6363.961       200            200            0.0031362122  -0.0027224173   0              0.012131054    0.008917033    0              861.14322      1.1965779e-13  0              3.0852693    
   1200000   6363.961       200            200            0.0031365973  -0.0027228366   0              0.012132628    0.0012020537   0              116.08574      1.1965779e-13  0              3.0852688    
   1300000   6363.961       200            200            0.0031364103  -0.0027228075   0              0.012132038    0.00016203726  0              15.648399      1.1965779e-13  0              3.085269     
   1400000   6363.961       200            200            0.0031364813  -0.0027228184   0              0.012132262    2.1843277e-05  0              2.1094673      1.1965779e-13  0              3.0852689    
   1500000   6363.961       200            200            0.0031364545  -0.0027228143   0              0.012132178    2.9445243e-06  0              0.28436108     1.1965779e-13  0              3.0852689    
   1600000   6363.961       200            200            0.0031364647  -0.0027228158   0              0.01213221     3.9693005e-07  0              0.038332663    1.1965779e-13  0              3.0852689    
   1700000   6363.961       200            200            0.0031364608  -0.0027228153   0              0.012132198    5.3506993e-08  0              0.0051673224   1.1965779e-13  0              3.0852689    
   1800000   6363.961       200            200            0.0031364623  -0.0027228155   0              0.012132202    7.2128041e-09  0              0.000696561    1.1965779e-13  0              3.0852689    
   1900000   6363.961       200            200            0.0031364617  -0.0027228154   0              0.012132201    9.722633e-10   0              9.389423e-05   1.1965779e-13  0              3.0852689    
   2000000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    1.3106012e-10  0              1.2656848e-05  1.1965779e-13  0              3.0852689    
   2100000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    1.7668386e-11  0              1.7062863e-06  1.1965779e-13  0              3.0852689    
   2200000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    2.381638e-12   0              2.3000155e-07  1.1965779e-13  0              3.0852689    
   2300000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    3.2114718e-13  0              3.1014096e-08  1.1965779e-13  0              3.0852689    
   2400000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    4.3305356e-14  0              4.1821213e-09  1.1965779e-13  0              3.0852689    
   2500000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    5.8363372e-15  0              5.6363167e-10  1.1965779e-13  0              3.0852689    
   2600000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    7.7885697e-16  0              7.5216431e-11  1.1965779e-13  0              3.0852689    
   2700000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    1.0385818e-16  0              1.002988e-11   1.1965779e-13  0              3.0852689    
   2800000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    1.0582048e-17  0              1.0219384e-12  1.1965779e-13  0              3.0852689    
   2900000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    2.3010935e-19  0              2.2222314e-14  1.1965779e-13  0              3.0852689    
   3000000   6363.961       200            200            0.0031364619  -0.0027228154   0              0.012132201    8.216686e-19   0              7.9350873e-14  1.1965779e-13  0              3.0852689    
Loop time of 287.743 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9008049.117 ns/day, 0.000 hours/ns, 10425.983 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.141     | 37.668     | 64.464     | 431.2 | 13.09
Neigh   | 2.7715     | 2.7931     | 2.8148     |   0.9 |  0.97
Comm    | 14.21      | 19.972     | 25.406     | 109.3 |  6.94
Output  | 0.24292    | 0.24324    | 0.24358    |   0.1 |  0.08
Modify  | 168.24     | 172.19     | 176.01     |  25.5 | 59.84
Other   |            | 54.88      |            |       | 19.07

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         340.25 ave         681 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1361
Ave neighs/atom = 0.54418233
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.19                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.3932619855676
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.29
  ghost atom cutoff = 3.29
  binsize = 1.645, bins = 3869 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.69 | 72.7 | 72.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033679964   1.3745514e-40  0              0.010103989    627678.88      0              6.0616734e+10  1.1965779e-13  0              3.3302129    
    200000   6363.961       200            200            0.0013837899  -2.5386179e-35  0              0.0041513698   190277.08      0              1.8375598e+10  1.1965779e-13  0              3.1064468    
    300000   6363.961       200            200            0.00027775562  1.3320921e-39  0              0.00083326685  13946.149      0              1.3468192e+09  1.1965779e-13  0              3.1267986    
    400000   6363.961       200            200            0.0091751709  -0.0089712076   0              0.03649672     6380.4591      0              6.1617907e+08  1.1965779e-13  0              3.0867173    
    500000   6363.961       200            200            0.00563324    -0.0043003147   0              0.021200035    940.3355       0              90810872       1.1965779e-13  0              3.0887108    
    600000   6363.961       200            200            0.0022865039  -0.0024186819   0              0.0092781936   131.55875      0              12705002       1.1965779e-13  0              3.0908575    
    700000   6363.961       200            200            0.003355143   -0.002669355    0              0.012734784    24.53617       0              2369527.7      1.1965779e-13  0              3.0901656    
    800000   6363.961       200            200            0.0030749337  -0.0027123521   0              0.011937153    3.2860068      0              317339.02      1.1965779e-13  0              3.0903127    
    900000   6363.961       200            200            0.0031672027  -0.0027309933   0              0.012232601    0.44079683     0              42569.002      1.1965779e-13  0              3.0902576    
   1000000   6363.961       200            200            0.0031322936  -0.0027214746   0              0.012118355    0.057440906    0              5547.2315      1.1965779e-13  0              3.0902789    
   1100000   6363.961       200            200            0.0031475608  -0.0027229102   0              0.012165593    0.0074531583   0              719.77269      1.1965779e-13  0              3.09027      
   1200000   6363.961       200            200            0.0031412511  -0.0027225519   0              0.012146305    0.00095940253  0              92.652229      1.1965779e-13  0              3.0902737    
   1300000   6363.961       200            200            0.0031437696  -0.0027228041   0              0.012154113    0.00012286644  0              11.865561      1.1965779e-13  0              3.0902722    
   1400000   6363.961       200            200            0.0031427617  -0.0027227031   0              0.012150988    1.5632755e-05  0              1.5096996      1.1965779e-13  0              3.0902728    
   1500000   6363.961       200            200            0.0031431615  -0.0027227433   0              0.012152228    1.9762769e-06  0              0.19085468     1.1965779e-13  0              3.0902726    
   1600000   6363.961       200            200            0.0031430041  -0.0027227275   0              0.01215174     2.4808715e-07  0              0.023958482    1.1965779e-13  0              3.0902726    
   1700000   6363.961       200            200            0.0031430656  -0.0027227337   0              0.012151931    3.0910738e-08  0              0.0029851379   1.1965779e-13  0              3.0902726    
   1800000   6363.961       200            200            0.0031430417  -0.0027227313   0              0.012151856    3.8202163e-09  0              0.00036892914  1.1965779e-13  0              3.0902726    
   1900000   6363.961       200            200            0.003143051   -0.0027227322   0              0.012151885    4.6797275e-10  0              4.5193459e-05  1.1965779e-13  0              3.0902726    
   2000000   6363.961       200            200            0.0031430474  -0.0027227318   0              0.012151874    5.6763092e-11  0              5.4817731e-06  1.1965779e-13  0              3.0902726    
   2100000   6363.961       200            200            0.0031430488  -0.002722732    0              0.012151878    6.8121103e-12  0              6.5786485e-07  1.1965779e-13  0              3.0902726    
   2200000   6363.961       200            200            0.0031430482  -0.0027227319   0              0.012151877    8.0775384e-13  0              7.8007084e-08  1.1965779e-13  0              3.0902726    
   2300000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    9.4136243e-14  0              9.0910046e-09  1.1965779e-13  0              3.0902726    
   2400000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    1.0721745e-14  0              1.0354294e-09  1.1965779e-13  0              3.0902726    
   2500000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    1.1766005e-15  0              1.1362765e-10  1.1965779e-13  0              3.0902726    
   2600000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    1.3708518e-16  0              1.3238705e-11  1.1965779e-13  0              3.0902726    
   2700000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    1.0460724e-17  0              1.0102219e-12  1.1965779e-13  0              3.0902726    
   2800000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    1.6889848e-19  0              1.6311006e-14  1.1965779e-13  0              3.0902726    
   2900000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    3.9759895e-18  0              3.8397261e-13  1.1965779e-13  0              3.0902726    
   3000000   6363.961       200            200            0.0031430484  -0.0027227319   0              0.012151877    1.2888617e-18  0              1.2446904e-13  1.1965779e-13  0              3.0902726    
Loop time of 286.032 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9061934.253 ns/day, 0.000 hours/ns, 10488.350 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.953     | 37.809     | 64.843     | 433.4 | 13.22
Neigh   | 2.7932     | 2.8147     | 2.8372     |   0.9 |  0.98
Comm    | 14.593     | 19.412     | 23.769     |  84.4 |  6.79
Output  | 0.24325    | 0.24356    | 0.2439     |   0.1 |  0.09
Modify  | 165.84     | 170.77     | 175.75     |  33.1 | 59.70
Other   |            | 54.98      |            |       | 19.22

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.25 ave         685 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1369
Ave neighs/atom = 0.54738105
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.2                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.7460262933712
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.3
  ghost atom cutoff = 3.3
  binsize = 1.65, bins = 3857 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.51 | 72.51 | 72.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033773783  -1.2693235e-35  0              0.010132135    630026.98      0              6.0843496e+10  1.1965779e-13  0              3.3302329    
    200000   6363.961       200            200            0.0013981313  -1.2693156e-35  0              0.0041943938   193107.25      0              1.8648916e+10  1.1965779e-13  0              3.1077276    
    300000   6363.961       200            200            0.00029039692 -5.0772561e-35  0              0.00087119077  15056.967      0              1.4540941e+09  1.1965779e-13  0              3.1306141    
    400000   6363.961       200            200            0.0070117788  -0.0077970246   0              0.028832361    7920.9645      0              7.6495005e+08  1.1965779e-13  0              3.0926384    
    500000   6363.961       200            200            0.0046958731  -0.0044599322   0              0.018547551    1200.154       0              1.1590228e+08  1.1965779e-13  0              3.0941233    
    600000   6363.961       200            200            0.0020948893  -0.0023066779   0              0.0085913459   88.968027      0              8591895.3      1.1965779e-13  0              3.0960222    
    700000   6363.961       200            200            0.0035110672  -0.0026713738   0              0.013204575    18.891391      0              1824395.3      1.1965779e-13  0              3.0950835    
    800000   6363.961       200            200            0.0030159968  -0.0027266001   0              0.01177459     2.3814165      0              229980.16      1.1965779e-13  0              3.0953527    
    900000   6363.961       200            200            0.0031995046  -0.0027310756   0              0.01232959     0.29384276     0              28377.231      1.1965779e-13  0              3.0952462    
   1000000   6363.961       200            200            0.0031294039  -0.00271915     0              0.012107362    0.033368042    0              3222.4467      1.1965779e-13  0              3.0952886    
   1100000   6363.961       200            200            0.0031580407  -0.0027231483   0              0.01219727     0.0036563524   0              353.10435      1.1965779e-13  0              3.0952713    
   1200000   6363.961       200            200            0.0031464331  -0.0027221066   0              0.012161406    0.0003806555   0              36.760984      1.1965779e-13  0              3.0952783    
   1300000   6363.961       200            200            0.0031509759  -0.0027225761   0              0.012175504    3.7365903e-05  0              3.6085315      1.1965779e-13  0              3.0952755    
   1400000   6363.961       200            200            0.0031492131  -0.0027223944   0              0.012170034    3.3733255e-06  0              0.32577164     1.1965779e-13  0              3.0952766    
   1500000   6363.961       200            200            0.0031498888  -0.0027224644   0              0.012172131    2.6870869e-07  0              0.025949962    1.1965779e-13  0              3.0952762    
   1600000   6363.961       200            200            0.0031496326  -0.0027224378   0              0.012171336    1.7226219e-08  0              0.001663585    1.1965779e-13  0              3.0952763    
   1700000   6363.961       200            200            0.0031497288  -0.0027224478   0              0.012171634    6.783057e-10   0              6.5505909e-05  1.1965779e-13  0              3.0952763    
   1800000   6363.961       200            200            0.003149693   -0.0027224441   0              0.012171523    1.7982044e-12  0              1.7365771e-07  1.1965779e-13  0              3.0952763    
   1900000   6363.961       200            200            0.0031497062  -0.0027224455   0              0.012171564    6.4084119e-12  0              6.1887856e-07  1.1965779e-13  0              3.0952763    
   2000000   6363.961       200            200            0.0031497014  -0.002722445    0              0.012171549    4.1246384e-12  0              3.9832805e-07  1.1965779e-13  0              3.0952763    
   2100000   6363.961       200            200            0.0031497031  -0.0027224451   0              0.012171554    1.3060586e-12  0              1.2612979e-07  1.1965779e-13  0              3.0952763    
   2200000   6363.961       200            200            0.0031497025  -0.0027224451   0              0.012171553    3.1556948e-13  0              3.0475442e-08  1.1965779e-13  0              3.0952763    
   2300000   6363.961       200            200            0.0031497027  -0.0027224451   0              0.012171553    6.6214857e-14  0              6.3945569e-09  1.1965779e-13  0              3.0952763    
   2400000   6363.961       200            200            0.0031497026  -0.0027224451   0              0.012171553    1.2257936e-14  0              1.1837837e-09  1.1965779e-13  0              3.0952763    
   2500000   6363.961       200            200            0.0031497027  -0.0027224451   0              0.012171553    2.084002e-15   0              2.01258e-10    1.1965779e-13  0              3.0952763    
   2600000   6363.961       200            200            0.0031497027  -0.0027224451   0              0.012171553    3.4175865e-16  0              3.3004605e-11  1.1965779e-13  0              3.0952763    
   2700000   6363.961       200            200            0.0031497027  -0.0027224451   0              0.012171553    6.6100259e-17  0              6.3834899e-12  1.1965779e-13  0              3.0952763    
   2800000   6363.961       200            200            0.0031497027  -0.0027224451   0              0.012171553    1.3858487e-17  0              1.3383535e-12  1.1965779e-13  0              3.0952763    
   2900000   6363.961       200            200            0.0031497027  -0.0027224451   0              0.012171553    8.1139735e-19  0              7.8358948e-14  1.1965779e-13  0              3.0952763    
   3000000   6363.961       200            200            0.0031497027  -0.0027224451   0              0.012171553    3.0802473e-18  0              2.9746824e-13  1.1965779e-13  0              3.0952763    
Loop time of 287.949 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9001608.386 ns/day, 0.000 hours/ns, 10418.528 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.981     | 37.952     | 65.44      | 435.0 | 13.18
Neigh   | 2.7965     | 2.818      | 2.8395     |   0.9 |  0.98
Comm    | 14.506     | 19.545     | 23.787     |  87.5 |  6.79
Output  | 0.23978    | 0.24009    | 0.24043    |   0.1 |  0.08
Modify  | 166.98     | 172.08     | 177.96     |  34.6 | 59.76
Other   |            | 55.32      |            |       | 19.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         344.25 ave         689 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1377
Ave neighs/atom = 0.55057977
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.21                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.1010022824028
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.31
  ghost atom cutoff = 3.31
  binsize = 1.655, bins = 3846 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.34 | 71.36 | 71.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033867615   4.1020374e-40  0              0.010160285    632378.41      0              6.107058e+10   1.1965779e-13  0              3.3302411    
    200000   6363.961       200            200            0.0014125116   3.173314e-36   0              0.0042375347   195955.85      0              1.8924014e+10  1.1965779e-13  0              3.1089771    
    300000   6363.961       200            200            0.00030315451  1.7102758e-41  0              0.00090946352  16209.005      0              1.5653497e+09  1.1965779e-13  0              3.1343828    
    400000   6363.961       200            200            0.004933969   -0.0066767591   0              0.021478666    8975.3988      0              8.6677977e+08  1.1965779e-13  0              3.098641     
    500000   6363.961       200            200            0.0039127804  -0.0040916937   0              0.015830035    1385.5351      0              1.3380506e+08  1.1965779e-13  0              3.0995772    
    600000   6363.961       200            200            0.0019594518  -0.0021972932   0              0.0080756486   49.058816      0              4737749.3      1.1965779e-13  0              3.1011525    
    700000   6363.961       200            200            0.0036422014  -0.0026791651   0              0.013605769    11.727754      0              1132582.6      1.1965779e-13  0              3.1000155    
    800000   6363.961       200            200            0.0029720867  -0.0027340609   0              0.011650321    1.2748554      0              123116.41      1.1965779e-13  0              3.1003853    
    900000   6363.961       200            200            0.003225632   -0.0027296178   0              0.012406514    0.12326249     0              11903.809      1.1965779e-13  0              3.1002386    
   1000000   6363.961       200            200            0.0031303468  -0.0027159135   0              0.012106954    0.0092268185   0              891.06009      1.1965779e-13  0              3.1002963    
   1100000   6363.961       200            200            0.0031673477  -0.0027216076   0              0.012223651    0.0005006286   0              48.347126      1.1965779e-13  0              3.1002737    
   1200000   6363.961       200            200            0.0031529659  -0.0027201542   0              0.012179052    1.0648361e-05  0              1.0283425      1.1965779e-13  0              3.1002823    
   1300000   6363.961       200            200            0.0031583306  -0.002720718    0              0.01219571     4.1494806e-07  0              0.040072713    1.1965779e-13  0              3.1002791    
   1400000   6363.961       200            200            0.0031563677  -0.0027205124   0              0.012189615    8.2461072e-07  0              0.079635001    1.1965779e-13  0              3.1002803    
   1500000   6363.961       200            200            0.0031570704  -0.0027205863   0              0.012191797    3.2832715e-07  0              0.031707486    1.1965779e-13  0              3.1002799    
   1600000   6363.961       200            200            0.0031568244  -0.0027205604   0              0.012191033    8.6386344e-08  0              0.0083425748   1.1965779e-13  0              3.10028      
   1700000   6363.961       200            200            0.0031569084  -0.0027205693   0              0.012191294    1.8581553e-08  0              0.0017944734   1.1965779e-13  0              3.1002799    
   1800000   6363.961       200            200            0.0031568805  -0.0027205663   0              0.012191208    3.5310353e-09  0              0.00034100212  1.1965779e-13  0              3.10028      
   1900000   6363.961       200            200            0.0031568894  -0.0027205673   0              0.012191236    6.1500568e-10  0              5.9392846e-05  1.1965779e-13  0              3.10028      
   2000000   6363.961       200            200            0.0031568867  -0.002720567    0              0.012191227    1.0016052e-10  0              9.6727864e-06  1.1965779e-13  0              3.10028      
   2100000   6363.961       200            200            0.0031568875  -0.002720567    0              0.012191229    1.5434518e-11  0              1.4905553e-06  1.1965779e-13  0              3.10028      
   2200000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    2.2668968e-12  0              2.1892067e-07  1.1965779e-13  0              3.10028      
   2300000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    3.1851129e-13  0              3.0759541e-08  1.1965779e-13  0              3.10028      
   2400000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    4.285784e-14   0              4.1389035e-09  1.1965779e-13  0              3.10028      
   2500000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    5.4725587e-15  0              5.2850054e-10  1.1965779e-13  0              3.10028      
   2600000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    6.973981e-16   0              6.7349717e-11  1.1965779e-13  0              3.10028      
   2700000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    7.4547166e-17  0              7.1992317e-12  1.1965779e-13  0              3.10028      
   2800000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    1.5420126e-18  0              1.4891654e-13  1.1965779e-13  0              3.10028      
   2900000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    1.4152417e-18  0              1.3667392e-13  1.1965779e-13  0              3.10028      
   3000000   6363.961       200            200            0.0031568873  -0.002720567    0              0.012191229    4.8304784e-19  0              4.6649303e-14  1.1965779e-13  0              3.10028      
Loop time of 289.564 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8951401.290 ns/day, 0.000 hours/ns, 10360.418 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.08      | 37.937     | 65.265     | 434.7 | 13.10
Neigh   | 2.8206     | 2.8427     | 2.8651     |   0.9 |  0.98
Comm    | 14.17      | 20.113     | 25.437     | 111.2 |  6.95
Output  | 0.23857    | 0.23889    | 0.23924    |   0.1 |  0.08
Modify  | 169.24     | 173.3      | 177.54     |  26.1 | 59.85
Other   |            | 55.13      |            |       | 19.04

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         346.75 ave         694 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1387
Ave neighs/atom = 0.55457817
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.22                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.4581968641666
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.32
  ghost atom cutoff = 3.32
  binsize = 1.66, bins = 3834 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.16 | 71.18 | 71.21 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0033961459  -5.0772914e-35  0              0.010188438    634733.15      0              6.1297984e+10  1.1965779e-13  0              3.3302377    
    200000   6363.961       200            200            0.0014269304   3.5603873e-40  0              0.0042807913   198822.83      0              1.9200886e+10  1.1965779e-13  0              3.1101952    
    300000   6363.961       200            200            0.00031602761  3.1733153e-36  0              0.00094808282  17402.127      0              1.6805728e+09  1.1965779e-13  0              3.1381045    
    400000   6363.961       200            200            0.0031565257  -0.0054528355   0              0.014922413    9477.4336      0              9.152627e+08   1.1965779e-13  0              3.1046898    
    500000   6363.961       200            200            0.003200951   -0.0035862809   0              0.013189134    1475.3535      0              1.4247908e+08  1.1965779e-13  0              3.105055     
    600000   6363.961       200            200            0.0018620472  -0.0021528649   0              0.0077390065   18.466376      0              1783350.4      1.1965779e-13  0              3.1062435    
    700000   6363.961       200            200            0.0037380836  -0.0026926223   0              0.013906873    5.0738038      0              489991.65      1.1965779e-13  0              3.1049666    
    800000   6363.961       200            200            0.0029466726  -0.0027371301   0              0.011577148    0.3727993      0              36002.288      1.1965779e-13  0              3.1054078    
    900000   6363.961       200            200            0.0032425585  -0.0027282089   0              0.012455884    0.013387582    0              1292.8769      1.1965779e-13  0              3.1052364    
   1000000   6363.961       200            200            0.0031354924  -0.0027138273   0              0.012120305    3.3097226e-05  0              3.1962932      1.1965779e-13  0              3.1053013    
   1100000   6363.961       200            200            0.0031744588  -0.0027200379   0              0.012243414    0.00040187438  0              38.810151      1.1965779e-13  0              3.1052773    
   1200000   6363.961       200            200            0.0031603843  -0.0027185618   0              0.012199715    0.00018727862  0              18.086029      1.1965779e-13  0              3.1052858    
   1300000   6363.961       200            200            0.0031651724  -0.0027190729   0              0.01221459     5.1327792e-05  0              4.9568708      1.1965779e-13  0              3.1052829    
   1400000   6363.961       200            200            0.0031636169  -0.0027189069   0              0.012209758    1.1009686e-05  0              1.0632367      1.1965779e-13  0              3.1052838    
   1500000   6363.961       200            200            0.0031640923  -0.0027189581   0              0.012211235    2.0325991e-06  0              0.19629387     1.1965779e-13  0              3.1052835    
   1600000   6363.961       200            200            0.0031639593  -0.0027189436   0              0.012210822    3.366393e-07   0              0.032510214    1.1965779e-13  0              3.1052836    
   1700000   6363.961       200            200            0.003163991   -0.0027189472   0              0.01221092     5.1063061e-08  0              0.004931305    1.1965779e-13  0              3.1052836    
   1800000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    7.1647235e-09  0              0.00069191772  1.1965779e-13  0              3.1052836    
   1900000   6363.961       200            200            0.0031639854  -0.0027189465   0              0.012210903    9.3283346e-10  0              9.0086378e-05  1.1965779e-13  0              3.1052836    
   2000000   6363.961       200            200            0.0031639866  -0.0027189466   0              0.012210906    1.1239727e-10  0              1.0854524e-05  1.1965779e-13  0              3.1052836    
   2100000   6363.961       200            200            0.0031639858  -0.0027189466   0              0.012210904    1.2414788e-11  0              1.1989313e-06  1.1965779e-13  0              3.1052836    
   2200000   6363.961       200            200            0.0031639862  -0.0027189466   0              0.012210905    1.2325732e-12  0              1.190331e-07   1.1965779e-13  0              3.1052836    
   2300000   6363.961       200            200            0.003163986   -0.0027189466   0              0.012210905    1.0580542e-13  0              1.021793e-08   1.1965779e-13  0              3.1052836    
   2400000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    7.1439748e-15  0              6.8991395e-10  1.1965779e-13  0              3.1052836    
   2500000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    2.7167747e-16  0              2.6236666e-11  1.1965779e-13  0              3.1052836    
   2600000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    1.2525609e-18  0              1.2096337e-13  1.1965779e-13  0              3.1052836    
   2700000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    4.4147249e-18  0              4.2634253e-13  1.1965779e-13  0              3.1052836    
   2800000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    6.2296264e-18  0              6.0161272e-13  1.1965779e-13  0              3.1052836    
   2900000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    6.660259e-18   0              6.4320014e-13  1.1965779e-13  0              3.1052836    
   3000000   6363.961       200            200            0.0031639861  -0.0027189466   0              0.012210905    4.2271246e-18  0              4.0822544e-13  1.1965779e-13  0              3.1052836    
Loop time of 288.897 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8972045.042 ns/day, 0.000 hours/ns, 10384.311 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.106     | 38.097     | 65.693     | 436.6 | 13.19
Neigh   | 2.8407     | 2.8622     | 2.8838     |   0.9 |  0.99
Comm    | 14.281     | 20.211     | 25.41      | 109.8 |  7.00
Output  | 0.23598    | 0.23631    | 0.23666    |   0.1 |  0.08
Modify  | 168.77     | 172.38     | 176.79     |  23.7 | 59.67
Other   |            | 55.11      |            |       | 19.08

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         349.25 ave         699 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1397
Ave neighs/atom = 0.55857657
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.23                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.8176169501661
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.33
  ghost atom cutoff = 3.33
  binsize = 1.665, bins = 3823 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.02 | 71.03 | 71.04 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034055314  -3.1733108e-35  0              0.010216594    637091.22      0              6.152571e+10   1.1965779e-13  0              3.3302225    
    200000   6363.961       200            200            0.0035302028  -0.00095258215  0              0.011543191    200994.01      0              1.9410563e+10  1.1965779e-13  0              3.1113834    
    300000   6363.961       200            200            0.00032901534  6.3466292e-36  0              0.00098704603  18636.183      0              1.7997491e+09  1.1965779e-13  0              3.1417791    
    400000   6363.961       200            200            0.0019574416  -0.0035521616   0              0.0094244865   9460.2889      0              9.1360699e+08  1.1965779e-13  0              3.1107533    
    500000   6363.961       200            200            0.0024433179  -0.0034113577   0              0.010741311    1465.1301      0              1.4149178e+08  1.1965779e-13  0              3.1105397    
    600000   6363.961       200            200            0.0018222736  -0.0021173657   0              0.0075841864   2.0319952      0              196235.55      1.1965779e-13  0              3.1112915    
    700000   6363.961       200            200            0.0037868198  -0.002723581    0              0.01408404     0.83799699     0              80927.751      1.1965779e-13  0              3.1099409    
    800000   6363.961       200            200            0.0029417717  -0.0027378232   0              0.011563138    0.001345202    0              129.90998      1.1965779e-13  0              3.1104186    
    900000   6363.961       200            200            0.003248653   -0.0027278751   0              0.012473834    0.017870265    0              1725.7823      1.1965779e-13  0              3.1102402    
   1000000   6363.961       200            200            0.0031449991  -0.0027133443   0              0.012148342    0.011265606    0              1087.9515      1.1965779e-13  0              3.1103033    
   1100000   6363.961       200            200            0.003179161   -0.0027191197   0              0.012256603    0.0033851921   0              326.91762      1.1965779e-13  0              3.1102821    
   1200000   6363.961       200            200            0.003168383   -0.0027179708   0              0.01222312     0.00073866511  0              71.334989      1.1965779e-13  0              3.1102887    
   1300000   6363.961       200            200            0.0031713662  -0.0027182956   0              0.012232394    0.00013337489  0              12.880392      1.1965779e-13  0              3.1102869    
   1400000   6363.961       200            200            0.0031706906  -0.0027182207   0              0.012230292    2.0915843e-05  0              2.0199024      1.1965779e-13  0              3.1102873    
   1500000   6363.961       200            200            0.0031707704  -0.0027182305   0              0.012230542    2.9083983e-06  0              0.28087229     1.1965779e-13  0              3.1102873    
   1600000   6363.961       200            200            0.0031708045  -0.0027182336   0              0.012230647    3.599302e-07   0              0.034759482    1.1965779e-13  0              3.1102872    
   1700000   6363.961       200            200            0.0031707694  -0.0027182301   0              0.012230538    3.9219061e-08  0              0.0037874962   1.1965779e-13  0              3.1102873    
   1800000   6363.961       200            200            0.0031707899  -0.0027182322   0              0.012230602    3.6463273e-09  0              0.00035213619  1.1965779e-13  0              3.1102872    
   1900000   6363.961       200            200            0.00317078    -0.0027182312   0              0.012230571    2.6815062e-10  0              2.5896068e-05  1.1965779e-13  0              3.1102873    
   2000000   6363.961       200            200            0.0031707843  -0.0027182316   0              0.012230584    1.2535031e-11  0              1.2105436e-06  1.1965779e-13  0              3.1102872    
   2100000   6363.961       200            200            0.0031707826  -0.0027182314   0              0.012230579    1.0100917e-13  0              9.7547422e-09  1.1965779e-13  0              3.1102872    
   2200000   6363.961       200            200            0.0031707832  -0.0027182315   0              0.012230581    6.2627701e-14  0              6.0481351e-09  1.1965779e-13  0              3.1102872    
   2300000   6363.961       200            200            0.003170783   -0.0027182315   0              0.01223058     4.8929659e-14  0              4.7252762e-09  1.1965779e-13  0              3.1102872    
   2400000   6363.961       200            200            0.0031707831  -0.0027182315   0              0.012230581    1.5416464e-14  0              1.4888118e-09  1.1965779e-13  0              3.1102872    
   2500000   6363.961       200            200            0.003170783   -0.0027182315   0              0.012230581    3.3716812e-15  0              3.2561284e-10  1.1965779e-13  0              3.1102872    
   2600000   6363.961       200            200            0.003170783   -0.0027182315   0              0.012230581    6.208897e-16   0              5.9961083e-11  1.1965779e-13  0              3.1102872    
   2700000   6363.961       200            200            0.003170783   -0.0027182315   0              0.012230581    1.0213762e-16  0              9.8637199e-12  1.1965779e-13  0              3.1102872    
   2800000   6363.961       200            200            0.003170783   -0.0027182315   0              0.012230581    8.5732888e-18  0              8.2794686e-13  1.1965779e-13  0              3.1102872    
   2900000   6363.961       200            200            0.003170783   -0.0027182315   0              0.012230581    2.7241396e-19  0              2.630779e-14   1.1965779e-13  0              3.1102872    
   3000000   6363.961       200            200            0.003170783   -0.0027182315   0              0.012230581    2.9397029e-18  0              2.8389546e-13  1.1965779e-13  0              3.1102872    
Loop time of 287.024 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9030588.651 ns/day, 0.000 hours/ns, 10452.070 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.939     | 37.195     | 63.824     | 426.3 | 12.96
Neigh   | 2.8118     | 2.8344     | 2.857      |   0.9 |  0.99
Comm    | 14.614     | 19.536     | 23.689     |  84.7 |  6.81
Output  | 0.22897    | 0.2293     | 0.22965    |   0.1 |  0.08
Modify  | 165.16     | 171.6      | 178.4      |  44.3 | 59.79
Other   |            | 55.63      |            |       | 19.38

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         327.25 ave         655 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1309
Ave neighs/atom = 0.52339064
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.24                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.1792694519052
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.34
  ghost atom cutoff = 3.34
  binsize = 1.67, bins = 3811 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.92 | 69.93 | 69.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.003414918    1.4880011e-41  0              0.010244754    639452.6       0              6.1753755e+10  1.1965779e-13  0              3.3301956    
    200000   6363.961       200            200            0.0099472369  -0.0047245517   0              0.034566262    198430.13      0              1.9162962e+10  1.1965779e-13  0              3.1125655    
    300000   6363.961       200            200            0.00034211686  3.4429462e-40  0              0.0010263506   19911.029      0              1.9228646e+09  1.1965779e-13  0              3.1454067    
    400000   6363.961       200            200            0.0011192906  -0.0017962911   0              0.0051541628   9022.716       0              8.7134933e+08  1.1965779e-13  0              3.1168047    
    500000   6363.961       200            200            0.0018846508  -0.0029169318   0              0.0085708841   1365.1562      0              1.3183701e+08  1.1965779e-13  0              3.1160156    
    600000   6363.961       200            200            0.0018330617  -0.0021125193   0              0.0076117045   2.239707       0              216294.87      1.1965779e-13  0              3.116295     
    700000   6363.961       200            200            0.0037982151  -0.0027280969   0              0.014122742    0.23746483     0              22932.654      1.1965779e-13  0              3.1149403    
    800000   6363.961       200            200            0.0029580039  -0.0027371625   0              0.011611174    0.2905511      0              28059.346      1.1965779e-13  0              3.1154169    
    900000   6363.961       200            200            0.0032449162  -0.0027259085   0              0.012460657    0.1332834      0              12871.557      1.1965779e-13  0              3.1152499    
   1000000   6363.961       200            200            0.0031588807  -0.0027130018   0              0.012189644    0.035708407    0              3448.4623      1.1965779e-13  0              3.1153028    
   1100000   6363.961       200            200            0.0031822986  -0.002717682    0              0.012264578    0.0071313108   0              688.69095      1.1965779e-13  0              3.115288     
   1200000   6363.961       200            200            0.003177076   -0.0027171049   0              0.012248333    0.0011554527   0              111.58535      1.1965779e-13  0              3.1152913    
   1300000   6363.961       200            200            0.0031775055  -0.0027171608   0              0.012249677    0.00015784334  0              15.24338       1.1965779e-13  0              3.115291     
   1400000   6363.961       200            200            0.0031779078  -0.0027171997   0              0.012250923    1.8212337e-05  0              1.7588171      1.1965779e-13  0              3.1152907    
   1500000   6363.961       200            200            0.0031775666  -0.0027171648   0              0.012249865    1.7224961e-06  0              0.16634634     1.1965779e-13  0              3.1152909    
   1600000   6363.961       200            200            0.0031777527  -0.0027171842   0              0.012250442    1.2194518e-07  0              0.011776593    1.1965779e-13  0              3.1152908    
   1700000   6363.961       200            200            0.0031776676  -0.0027171752   0              0.012250178    4.7687245e-09  0              0.00046052927  1.1965779e-13  0              3.1152909    
   1800000   6363.961       200            200            0.0031777025  -0.0027171789   0              0.012250286    2.4575868e-12  0              2.3733614e-07  1.1965779e-13  0              3.1152909    
   1900000   6363.961       200            200            0.0031776894  -0.0027171775   0              0.012250246    6.7326981e-11  0              6.5019579e-06  1.1965779e-13  0              3.1152909    
   2000000   6363.961       200            200            0.0031776939  -0.002717178    0              0.01225026     3.5892975e-11  0              3.4662867e-06  1.1965779e-13  0              3.1152909    
   2100000   6363.961       200            200            0.0031776925  -0.0027171779   0              0.012250255    9.6968483e-12  0              9.364522e-07   1.1965779e-13  0              3.1152909    
   2200000   6363.961       200            200            0.0031776929  -0.0027171779   0              0.012250257    1.9209668e-12  0              1.8551322e-07  1.1965779e-13  0              3.1152909    
   2300000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    3.0969209e-13  0              2.9907846e-08  1.1965779e-13  0              3.1152909    
   2400000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    4.2212863e-14  0              4.0766162e-09  1.1965779e-13  0              3.1152909    
   2500000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    4.8197075e-15  0              4.6545285e-10  1.1965779e-13  0              3.1152909    
   2600000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    4.8058271e-16  0              4.6411238e-11  1.1965779e-13  0              3.1152909    
   2700000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    2.4827723e-17  0              2.3976838e-12  1.1965779e-13  0              3.1152909    
   2800000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    4.4178638e-19  0              4.2664566e-14  1.1965779e-13  0              3.1152909    
   2900000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    6.3892183e-18  0              6.1702497e-13  1.1965779e-13  0              3.1152909    
   3000000   6363.961       200            200            0.0031776928  -0.0027171779   0              0.012250256    5.8642845e-18  0              5.6633062e-13  1.1965779e-13  0              3.1152909    
Loop time of 286.682 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9041381.738 ns/day, 0.000 hours/ns, 10464.562 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.096     | 37.221     | 63.845     | 427.3 | 12.98
Neigh   | 2.657      | 2.6794     | 2.7018     |   1.0 |  0.93
Comm    | 14.096     | 19.863     | 25.102     | 109.9 |  6.93
Output  | 0.23482    | 0.23515    | 0.2355     |   0.1 |  0.08
Modify  | 167.03     | 171.66     | 175.95     |  29.8 | 59.88
Other   |            | 55.02      |            |       | 19.19

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.52738904
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.25                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.5431612808879
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.35
  ghost atom cutoff = 3.35
  binsize = 1.675, bins = 3800 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.74 | 69.75 | 69.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034243056  -6.3466215e-36  0              0.010272917    641817.29      0              6.198212e+10   1.1965779e-13  0              3.3301569    
    200000   6363.961       200            200            0.021525319   -0.0081300858   0              0.072706044    186484.7       0              1.8009357e+10  1.1965779e-13  0              3.1138103    
    300000   6363.961       200            200            0.00035533138  2.5386575e-35  0              0.0010659941   21226.527      0              2.049906e+09   1.1965779e-13  0              3.1489871    
    400000   6363.961       200            200            0.00050060834 -0.00063380942  0              0.0021356344   8296.496       0              8.012162e+08   1.1965779e-13  0              3.1228233    
    500000   6363.961       200            200            0.0015538792  -0.0020682976   0              0.0067299351   1195.8339      0              1.1548508e+08  1.1965779e-13  0              3.1214687    
    600000   6363.961       200            200            0.0018994792  -0.0021234302   0              0.0078218677   18.961892      0              1831203.8      1.1965779e-13  0              3.121254     
    700000   6363.961       200            200            0.0037658918  -0.0027232008   0              0.014020876    3.4240161      0              330666.96      1.1965779e-13  0              3.1199652    
    800000   6363.961       200            200            0.0029934892  -0.0027383519   0              0.011718819    1.1301902      0              109145.68      1.1965779e-13  0              3.1204035    
    900000   6363.961       200            200            0.003232758   -0.0027224562   0              0.01242073     0.30159531     0              29125.916      1.1965779e-13  0              3.1202648    
   1000000   6363.961       200            200            0.0031759962  -0.0027127059   0              0.012240695    0.058138906    0              5614.6394      1.1965779e-13  0              3.1203004    
   1100000   6363.961       200            200            0.0031846106  -0.0027158879   0              0.01226972     0.0087915609   0              849.02602      1.1965779e-13  0              3.1202944    
   1200000   6363.961       200            200            0.003185998   -0.0027160076   0              0.012274002    0.0010611074   0              102.47416      1.1965779e-13  0              3.1202937    
   1300000   6363.961       200            200            0.0031837838  -0.0027157809   0              0.012267132    9.9376526e-05  0              9.5970736      1.1965779e-13  0              3.120295     
   1400000   6363.961       200            200            0.0031851347  -0.0027159224   0              0.012271326    6.3941237e-06  0              0.6174987      1.1965779e-13  0              3.1202942    
   1500000   6363.961       200            200            0.0031844956  -0.0027158548   0              0.012269342    1.6908197e-07  0              0.016328726    1.1965779e-13  0              3.1202946    
   1600000   6363.961       200            200            0.0031847571  -0.0027158827   0              0.012270154    3.0764288e-09  0              0.00029709947  1.1965779e-13  0              3.1202944    
   1700000   6363.961       200            200            0.0031846617  -0.0027158725   0              0.012269858    8.8236521e-09  0              0.00085212516  1.1965779e-13  0              3.1202945    
   1800000   6363.961       200            200            0.0031846927  -0.0027158758   0              0.012269954    3.3321561e-09  0              0.00032179578  1.1965779e-13  0              3.1202945    
   1900000   6363.961       200            200            0.003184684   -0.0027158749   0              0.012269927    7.5101003e-10  0              7.2527173e-05  1.1965779e-13  0              3.1202945    
   2000000   6363.961       200            200            0.0031846859  -0.0027158751   0              0.012269933    1.2633744e-10  0              1.2200765e-05  1.1965779e-13  0              3.1202945    
   2100000   6363.961       200            200            0.0031846858  -0.0027158751   0              0.012269932    1.6875071e-11  0              1.6296736e-06  1.1965779e-13  0              3.1202945    
   2200000   6363.961       200            200            0.0031846856  -0.002715875    0              0.012269932    1.7845945e-12  0              1.7234336e-07  1.1965779e-13  0              3.1202945    
   2300000   6363.961       200            200            0.0031846857  -0.002715875    0              0.012269932    1.3992024e-13  0              1.3512495e-08  1.1965779e-13  0              3.1202945    
   2400000   6363.961       200            200            0.0031846856  -0.002715875    0              0.012269932    6.1947988e-15  0              5.9824933e-10  1.1965779e-13  0              3.1202945    
   2500000   6363.961       200            200            0.0031846857  -0.002715875    0              0.012269932    1.1697583e-17  0              1.1296689e-12  1.1965779e-13  0              3.1202945    
   2600000   6363.961       200            200            0.0031846857  -0.002715875    0              0.012269932    5.1854673e-17  0              5.0077531e-12  1.1965779e-13  0              3.1202945    
   2700000   6363.961       200            200            0.0031846857  -0.002715875    0              0.012269932    3.9577315e-17  0              3.8220938e-12  1.1965779e-13  0              3.1202945    
   2800000   6363.961       200            200            0.0031846857  -0.002715875    0              0.012269932    1.378268e-17   0              1.3310326e-12  1.1965779e-13  0              3.1202945    
   2900000   6363.961       200            200            0.0031846857  -0.002715875    0              0.012269932    4.4068458e-18  0              4.2558163e-13  1.1965779e-13  0              3.1202945    
   3000000   6363.961       200            200            0.0031846857  -0.002715875    0              0.012269932    5.1193821e-18  0              4.9439328e-13  1.1965779e-13  0              3.1202945    
Loop time of 285.692 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9072694.729 ns/day, 0.000 hours/ns, 10500.804 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.939     | 37.567     | 64.831     | 430.8 | 13.15
Neigh   | 2.6165     | 2.638      | 2.6588     |   0.9 |  0.92
Comm    | 14.328     | 19.258     | 23.254     |  86.6 |  6.74
Output  | 0.23571    | 0.23604    | 0.23638    |   0.1 |  0.08
Modify  | 165.73     | 170.97     | 176.29     |  35.3 | 59.85
Other   |            | 55.02      |            |       | 19.26

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.25 ave         665 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1329
Ave neighs/atom = 0.53138745
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.26                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.9092993486176
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.36
  ghost atom cutoff = 3.36
  binsize = 1.68, bins = 3789 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.62 | 69.63 | 69.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034336942  -1.2693187e-35  0              0.010301083    644185.3       0              6.2210805e+10  1.1965779e-13  0              3.3301064    
    200000   6363.961       200            200            0.037461238   -0.010911816    0              0.12329553     162018.88      0              1.5646624e+10  1.1965779e-13  0              3.1152318    
    300000   6363.961       200            200            0.00036865808 -5.077248e-35   0              0.0011059742   22582.536      0              2.1808596e+09  1.1965779e-13  0              3.1525202    
    400000   6363.961       200            200            8.7497093e-05 -7.5591151e-05  0              0.00033808243  7414.7047      0              7.160591e+08   1.1965779e-13  0              3.1287942    
    500000   6363.961       200            200            0.0012086756  -0.0016010538   0              0.0052270805   982.86373      0              94917944       1.1965779e-13  0              3.1268868    
    600000   6363.961       200            200            0.0020196998  -0.0021555047   0              0.0082146041   49.481621      0              4778580.8      1.1965779e-13  0              3.1261703    
    700000   6363.961       200            200            0.0036916369  -0.002714094    0              0.013789005    9.4389206      0              911543.39      1.1965779e-13  0              3.1250138    
    800000   6363.961       200            200            0.0030478167  -0.0027349976   0              0.011878448    2.210629       0              213486.72      1.1965779e-13  0              3.1253798    
    900000   6363.961       200            200            0.0032149749  -0.0027169238   0              0.012361849    0.4396713      0              42460.307      1.1965779e-13  0              3.1252834    
   1000000   6363.961       200            200            0.0031945509  -0.0027127972   0              0.01229645     0.064784562    0              6256.4293      1.1965779e-13  0              3.1252971    
   1100000   6363.961       200            200            0.0031870664  -0.0027137313   0              0.012274931    0.0071396412   0              689.49545      1.1965779e-13  0              3.1253008    
   1200000   6363.961       200            200            0.00319472    -0.0027145251   0              0.012298685    0.0005462663   0              52.754489      1.1965779e-13  0              3.1252964    
   1300000   6363.961       200            200            0.0031904382  -0.0027140755   0              0.01228539     2.0745779e-05  0              2.0034789      1.1965779e-13  0              3.1252989    
   1400000   6363.961       200            200            0.0031923287  -0.0027142763   0              0.012291262    1.7524351e-09  0              0.00016923764  1.1965779e-13  0              3.1252978    
   1500000   6363.961       200            200            0.0031916156  -0.0027142001   0              0.012289047    4.1298805e-07  0              0.03988343     1.1965779e-13  0              3.1252982    
   1600000   6363.961       200            200            0.0031918474  -0.0027142251   0              0.012289767    1.8743615e-07  0              0.018101242    1.1965779e-13  0              3.125298     
   1700000   6363.961       200            200            0.0031917853  -0.0027142183   0              0.012289574    4.360874e-08   0              0.00421142     1.1965779e-13  0              3.1252981    
   1800000   6363.961       200            200            0.0031917964  -0.0027142196   0              0.012289609    7.0814126e-09  0              0.00068387214  1.1965779e-13  0              3.1252981    
   1900000   6363.961       200            200            0.0031917972  -0.0027142197   0              0.012289611    8.5715247e-10  0              8.2777651e-05  1.1965779e-13  0              3.1252981    
   2000000   6363.961       200            200            0.0031917952  -0.0027142194   0              0.012289605    7.4586277e-11  0              7.2030088e-06  1.1965779e-13  0              3.1252981    
   2100000   6363.961       200            200            0.0031917965  -0.0027142196   0              0.012289609    3.7891933e-12  0              3.6593317e-07  1.1965779e-13  0              3.1252981    
   2200000   6363.961       200            200            0.0031917959  -0.0027142195   0              0.012289607    2.7119655e-14  0              2.6190222e-09  1.1965779e-13  0              3.1252981    
   2300000   6363.961       200            200            0.0031917961  -0.0027142195   0              0.012289608    2.2654275e-14  0              2.1877877e-09  1.1965779e-13  0              3.1252981    
   2400000   6363.961       200            200            0.003191796   -0.0027142195   0              0.012289608    1.5583715e-14  0              1.5049637e-09  1.1965779e-13  0              3.1252981    
   2500000   6363.961       200            200            0.0031917961  -0.0027142195   0              0.012289608    4.1865751e-15  0              4.0430945e-10  1.1965779e-13  0              3.1252981    
   2600000   6363.961       200            200            0.003191796   -0.0027142195   0              0.012289608    7.5208247e-16  0              7.2630741e-11  1.1965779e-13  0              3.1252981    
   2700000   6363.961       200            200            0.003191796   -0.0027142195   0              0.012289608    8.8959327e-17  0              8.591055e-12   1.1965779e-13  0              3.1252981    
   2800000   6363.961       200            200            0.003191796   -0.0027142195   0              0.012289608    1.0619796e-18  0              1.0255839e-13  1.1965779e-13  0              3.1252981    
   2900000   6363.961       200            200            0.003191796   -0.0027142195   0              0.012289608    5.2178896e-19  0              5.0390643e-14  1.1965779e-13  0              3.1252981    
   3000000   6363.961       200            200            0.003191796   -0.0027142195   0              0.012289608    6.9365441e-20  0              6.6988178e-15  1.1965779e-13  0              3.1252981    
Loop time of 289.147 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8964307.805 ns/day, 0.000 hours/ns, 10375.356 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.155     | 37.624     | 64.83      | 430.5 | 13.01
Neigh   | 2.606      | 2.6273     | 2.6486     |   0.9 |  0.91
Comm    | 13.937     | 19.882     | 25.05      | 113.8 |  6.88
Output  | 0.23445    | 0.23479    | 0.23514    |   0.1 |  0.08
Modify  | 169.25     | 173.57     | 177.31     |  27.5 | 60.03
Other   |            | 55.21      |            |       | 19.09

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         335.75 ave         672 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1343
Ave neighs/atom = 0.53698521
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.27                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.2776905665988
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.37
  ghost atom cutoff = 3.37
  binsize = 1.685, bins = 3777 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.54 | 68.55 | 68.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034430838  -3.17331e-36    0              0.010329251    646556.61      0              6.2439809e+10  1.1965779e-13  0              3.3300441    
    200000   6363.961       200            200            0.05453973    -0.017814013    0              0.1814332      125205.21      0              1.2091423e+10  1.1965779e-13  0              3.1169822    
    300000   6363.961       200            200            0.00038209604  1.2693281e-35  0              0.0011462881   23978.904      0              2.3157109e+09  1.1965779e-13  0              3.1560061    
    400000   6363.961       200            200           -0.00012639304  1.5735106e-05  0             -0.00039491423  6491.7737      0              6.2692904e+08  1.1965779e-13  0              3.1347085    
    500000   6363.961       200            200            0.00091767437 -0.0012880472   0              0.0040410703   752.16389      0              72638605       1.1965779e-13  0              3.1322602    
    600000   6363.961       200            200            0.0022006603  -0.002185763    0              0.0087877438   88.791496      0              8574847.1      1.1965779e-13  0              3.1310475    
    700000   6363.961       200            200            0.0035870952  -0.0026875849   0              0.013448871    16.516067      0              1595003.5      1.1965779e-13  0              3.1300828    
    800000   6363.961       200            200            0.0031161306  -0.0027294389   0              0.012077831    3.1343758      0              302695.58      1.1965779e-13  0              3.1303484    
    900000   6363.961       200            200            0.0031956247  -0.00270724     0              0.012294114    0.48041615     0              46395.153      1.1965779e-13  0              3.1303038    
   1000000   6363.961       200            200            0.0032127805  -0.002712802    0              0.012351143    0.051694961    0              4992.3293      1.1965779e-13  0              3.1302939    
   1100000   6363.961       200            200            0.0031906822  -0.0027110065   0              0.012283053    0.0034439462   0              332.59167      1.1965779e-13  0              3.1303066    
   1200000   6363.961       200            200            0.003202963   -0.0027123113   0              0.0123212      7.514364e-05   0              7.2568349      1.1965779e-13  0              3.1302994    
   1300000   6363.961       200            200            0.0031976971  -0.0027117513   0              0.012304843    4.4610337e-06  0              0.4308147      1.1965779e-13  0              3.1303025    
   1400000   6363.961       200            200            0.0031995659  -0.0027119524   0              0.01231065     6.6699234e-06  0              0.64413346     1.1965779e-13  0              3.1303014    
   1500000   6363.961       200            200            0.0031990244  -0.0027118936   0              0.012308967    2.0859085e-06  0              0.20144211     1.1965779e-13  0              3.1303017    
   1600000   6363.961       200            200            0.003199135   -0.0027119059   0              0.012309311    3.8288357e-07  0              0.036976154    1.1965779e-13  0              3.1303016    
   1700000   6363.961       200            200            0.0031991339  -0.0027119056   0              0.012309307    4.8208083e-08  0              0.0046555916   1.1965779e-13  0              3.1303017    
   1800000   6363.961       200            200            0.0031991197  -0.0027119042   0              0.012309263    4.0422601e-09  0              0.00039037254  1.1965779e-13  0              3.1303017    
   1900000   6363.961       200            200            0.0031991294  -0.0027119052   0              0.012309293    1.6812487e-10  0              1.6236296e-05  1.1965779e-13  0              3.1303017    
   2000000   6363.961       200            200            0.0031991248  -0.0027119047   0              0.012309279    1.1945982e-14  0              1.1536574e-09  1.1965779e-13  0              3.1303017    
   2100000   6363.961       200            200            0.0031991266  -0.0027119049   0              0.012309285    2.8068954e-12  0              2.7106987e-07  1.1965779e-13  0              3.1303017    
   2200000   6363.961       200            200            0.003199126   -0.0027119048   0              0.012309283    1.2890557e-12  0              1.2448777e-07  1.1965779e-13  0              3.1303017    
   2300000   6363.961       200            200            0.0031991262  -0.0027119048   0              0.012309283    2.8604038e-13  0              2.7623732e-08  1.1965779e-13  0              3.1303017    
   2400000   6363.961       200            200            0.0031991261  -0.0027119048   0              0.012309283    4.2024107e-14  0              4.0583875e-09  1.1965779e-13  0              3.1303017    
   2500000   6363.961       200            200            0.0031991261  -0.0027119048   0              0.012309283    4.3102564e-15  0              4.1625371e-10  1.1965779e-13  0              3.1303017    
   2600000   6363.961       200            200            0.0031991261  -0.0027119048   0              0.012309283    3.0343864e-16  0              2.9303932e-11  1.1965779e-13  0              3.1303017    
   2700000   6363.961       200            200            0.0031991261  -0.0027119048   0              0.012309283    1.9061556e-18  0              1.8408286e-13  1.1965779e-13  0              3.1303017    
   2800000   6363.961       200            200            0.0031991261  -0.0027119048   0              0.012309283    5.5517653e-18  0              5.3614976e-13  1.1965779e-13  0              3.1303017    
   2900000   6363.961       200            200            0.0031991261  -0.0027119048   0              0.012309283    5.657688e-18   0              5.4637901e-13  1.1965779e-13  0              3.1303017    
   3000000   6363.961       200            200            0.0031991261  -0.0027119048   0              0.012309283    3.53794e-18    0              3.4166892e-13  1.1965779e-13  0              3.1303017    
Loop time of 286.024 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9062187.292 ns/day, 0.000 hours/ns, 10488.643 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.017     | 37.772     | 65.027     | 432.6 | 13.21
Neigh   | 2.6012     | 2.6238     | 2.6454     |   1.0 |  0.92
Comm    | 14.138     | 19.088     | 23.361     |  89.2 |  6.67
Output  | 0.23126    | 0.23159    | 0.23195    |   0.1 |  0.08
Modify  | 166.43     | 171.33     | 176.1      |  32.4 | 59.90
Other   |            | 54.98      |            |       | 19.22

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.25 ave         677 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1353
Ave neighs/atom = 0.54098361
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.28                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.6483418463349
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.38
  ghost atom cutoff = 3.38
  binsize = 1.69, bins = 3766 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.32 | 68.34 | 68.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034524742   3.1733215e-36  0              0.010357423    648931.22      0              6.2669133e+10  1.1965779e-13  0              3.32997      
    200000   6363.961       200            200            0.071483507   -0.025194501    0              0.23964502     80853.503      0              7.8082526e+09  1.1965779e-13  0              3.119237     
    300000   6363.961       200            200            0.00039564451 -1.2693103e-35  0              0.0011869335   25415.497      0              2.4544468e+09  1.1965779e-13  0              3.1594445    
    400000   6363.961       200            200           -0.00013909886  1.2693406e-35  0             -0.00041729659  5608.5743      0              5.4163596e+08  1.1965779e-13  0              3.1405623    
    500000   6363.961       200            200            0.00072299554 -0.00097681657  0              0.0031458032   527.29839      0              50922704       1.1965779e-13  0              3.1375811    
    600000   6363.961       200            200            0.0024196687  -0.0022739963   0              0.0095330024   130.19695      0              12573489       1.1965779e-13  0              3.1358909    
    700000   6363.961       200            200            0.0034499148  -0.0026800509   0              0.013029795    22.621022      0              2184576.4      1.1965779e-13  0              3.1351673    
    800000   6363.961       200            200            0.0031912685  -0.0027272382   0              0.012301044    3.5589838      0              343701.18      1.1965779e-13  0              3.1353128    
    900000   6363.961       200            200            0.0031767297  -0.002698372    0              0.012228561    0.40499197     0              39111.225      1.1965779e-13  0              3.1353237    
   1000000   6363.961       200            200            0.0032288373  -0.002712692    0              0.012399204    0.026980207    0              2605.5553      1.1965779e-13  0              3.135292     
   1100000   6363.961       200            200            0.0031958859  -0.0027086623   0              0.01229632     0.00046454555  0              44.862484      1.1965779e-13  0              3.1353115    
   1200000   6363.961       200            200            0.0032102282  -0.0027102088   0              0.012340893    6.4003553e-05  0              6.1810051      1.1965779e-13  0              3.1353029    
   1300000   6363.961       200            200            0.0032052881  -0.002709677    0              0.012325541    6.6404038e-05  0              6.4128267      1.1965779e-13  0              3.1353059    
   1400000   6363.961       200            200            0.00320659    -0.0027098196   0              0.01232959     1.8162956e-05  0              1.7540483      1.1965779e-13  0              3.1353051    
   1500000   6363.961       200            200            0.0032064027  -0.0027097982   0              0.012329006    2.8698977e-06  0              0.27715418     1.1965779e-13  0              3.1353052    
   1600000   6363.961       200            200            0.0032063499  -0.002709793    0              0.012328843    2.8683938e-07  0              0.027700894    1.1965779e-13  0              3.1353052    
   1700000   6363.961       200            200            0.0032064097  -0.0027097993   0              0.012329028    1.5024668e-08  0              0.0014509749   1.1965779e-13  0              3.1353052    
   1800000   6363.961       200            200            0.0032063776  -0.0027097959   0              0.012328929    6.5938291e-11  0              6.3678482e-06  1.1965779e-13  0              3.1353052    
   1900000   6363.961       200            200            0.0032063906  -0.0027097972   0              0.012328969    1.2553334e-10  0              1.2123111e-05  1.1965779e-13  0              3.1353052    
   2000000   6363.961       200            200            0.0032063864  -0.0027097968   0              0.012328956    7.1177453e-11  0              6.8738089e-06  1.1965779e-13  0              3.1353052    
   2100000   6363.961       200            200            0.0032063874  -0.0027097969   0              0.012328959    1.6142283e-11  0              1.5589062e-06  1.1965779e-13  0              3.1353052    
   2200000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    2.2368302e-12  0              2.1601705e-07  1.1965779e-13  0              3.1353052    
   2300000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    1.9216193e-13  0              1.8557624e-08  1.1965779e-13  0              3.1353052    
   2400000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    7.1797776e-15  0              6.9337153e-10  1.1965779e-13  0              3.1353052    
   2500000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    1.7805647e-17  0              1.7195419e-12  1.1965779e-13  0              3.1353052    
   2600000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    1.7335522e-16  0              1.6741406e-11  1.1965779e-13  0              3.1353052    
   2700000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    7.8798213e-17  0              7.6097674e-12  1.1965779e-13  0              3.1353052    
   2800000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    1.0601621e-17  0              1.0238287e-12  1.1965779e-13  0              3.1353052    
   2900000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    5.9450687e-18  0              5.7413218e-13  1.1965779e-13  0              3.1353052    
   3000000   6363.961       200            200            0.0032063873  -0.0027097969   0              0.012328959    4.3042074e-18  0              4.1566954e-13  1.1965779e-13  0              3.1353052    
Loop time of 285.235 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9087231.431 ns/day, 0.000 hours/ns, 10517.629 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.013     | 37.666     | 64.851     | 431.8 | 13.21
Neigh   | 2.5507     | 2.5731     | 2.5962     |   1.0 |  0.90
Comm    | 14         | 18.986     | 23.253     |  89.3 |  6.66
Output  | 0.23312    | 0.23344    | 0.23381    |   0.1 |  0.08
Modify  | 165.85     | 170.87     | 176.13     |  33.6 | 59.91
Other   |            | 54.9       |            |       | 19.25

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         340.75 ave         682 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1363
Ave neighs/atom = 0.54498201
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.29                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.0212600993298
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.39
  ghost atom cutoff = 3.39
  binsize = 1.695, bins = 3755 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.3 | 67.3 | 67.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034618654   2.3903815e-40  0              0.010385596    651309.14      0              6.2898775e+10  1.1965779e-13  0              3.3298841    
    200000   6363.961       200            200            0.085102454   -0.033593913    0              0.28890128     38241.432      0              3.6930838e+09  1.1965779e-13  0              3.1221724    
    300000   6363.961       200            200            0.00040930272 -2.5386133e-35  0              0.0012279082   26892.183      0              2.5970546e+09  1.1965779e-13  0              3.1628354    
    400000   6363.961       200            200           -0.00012985529 -1.2693121e-35  0             -0.00038956588  4790.7619      0              4.6265749e+08  1.1965779e-13  0              3.1463549    
    500000   6363.961       200            200            0.00059756756 -0.00071056003  0              0.0025032627   327.67631      0              31644633       1.1965779e-13  0              3.1428435    
    600000   6363.961       200            200            0.0026839586  -0.0023825709   0              0.010434447    166.28414      0              16058532       1.1965779e-13  0              3.1407074    
    700000   6363.961       200            200            0.0032903843  -0.0026955428   0              0.012566696    26.048372      0              2515565.3      1.1965779e-13  0              3.1402613    
    800000   6363.961       200            200            0.0032676313  -0.0027260073   0              0.012528901    3.3242084      0              321028.25      1.1965779e-13  0              3.1402766    
    900000   6363.961       200            200            0.0031593509  -0.002697693    0              0.012175746    0.25079859     0              24220.333      1.1965779e-13  0              3.1403413    
   1000000   6363.961       200            200            0.003241213   -0.0027125035   0              0.012436143    0.0056943398   0              549.91858      1.1965779e-13  0              3.1402922    
   1100000   6363.961       200            200            0.0032029034  -0.0027072275   0              0.012315938    0.0003831528   0              37.002155      1.1965779e-13  0              3.1403151    
   1200000   6363.961       200            200            0.003216365   -0.0027086881   0              0.012357783    0.00051544819  0              49.778297      1.1965779e-13  0              3.140307     
   1300000   6363.961       200            200            0.0032129576  -0.0027083171   0              0.01234719     0.00014128771  0              13.644556      1.1965779e-13  0              3.1403091    
   1400000   6363.961       200            200            0.0032133218  -0.0027083597   0              0.012348325    2.0665191e-05  0              1.9956962      1.1965779e-13  0              3.1403088    
   1500000   6363.961       200            200            0.0032135481  -0.0027083826   0              0.012349027    1.7068175e-06  0              0.16483222     1.1965779e-13  0              3.1403087    
   1600000   6363.961       200            200            0.0032133542  -0.0027083622   0              0.012348425    4.9793473e-08  0              0.0048086972   1.1965779e-13  0              3.1403088    
   1700000   6363.961       200            200            0.0032134477  -0.0027083722   0              0.012348715    1.1111359e-09  0              0.00010730555  1.1965779e-13  0              3.1403088    
   1800000   6363.961       200            200            0.003213414   -0.0027083685   0              0.012348611    2.6432522e-09  0              0.00025526638  1.1965779e-13  0              3.1403088    
   1900000   6363.961       200            200            0.003213423   -0.0027083695   0              0.012348638    8.0684814e-10  0              7.7919618e-05  1.1965779e-13  0              3.1403088    
   2000000   6363.961       200            200            0.0032134218  -0.0027083694   0              0.012348635    1.2645405e-10  0              1.2212027e-05  1.1965779e-13  0              3.1403088    
   2100000   6363.961       200            200            0.0032134213  -0.0027083693   0              0.012348633    1.1331384e-11  0              1.094304e-06   1.1965779e-13  0              3.1403088    
   2200000   6363.961       200            200            0.0032134218  -0.0027083694   0              0.012348635    4.0677211e-13  0              3.9283138e-08  1.1965779e-13  0              3.1403088    
   2300000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    2.076149e-15   0              2.0049961e-10  1.1965779e-13  0              3.1403088    
   2400000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    1.331275e-14   0              1.2856501e-09  1.1965779e-13  0              3.1403088    
   2500000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    4.5995408e-15  0              4.4419073e-10  1.1965779e-13  0              3.1403088    
   2600000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    7.6270254e-16  0              7.3656352e-11  1.1965779e-13  0              3.1403088    
   2700000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    5.4968713e-17  0              5.3084849e-12  1.1965779e-13  0              3.1403088    
   2800000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    2.7804336e-19  0              2.6851438e-14  1.1965779e-13  0              3.1403088    
   2900000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    6.1800539e-18  0              5.9682537e-13  1.1965779e-13  0              3.1403088    
   3000000   6363.961       200            200            0.0032134216  -0.0027083694   0              0.012348634    2.7721271e-18  0              2.6771219e-13  1.1965779e-13  0              3.1403088    
Loop time of 286.76 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9038919.345 ns/day, 0.000 hours/ns, 10461.712 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.059     | 37.665     | 64.722     | 431.8 | 13.13
Neigh   | 2.5321     | 2.5539     | 2.5759     |   1.0 |  0.89
Comm    | 13.704     | 19.591     | 24.827     | 110.6 |  6.83
Output  | 0.24021    | 0.24054    | 0.2409     |   0.1 |  0.08
Modify  | 168.12     | 172.01     | 176.01     |  24.9 | 59.98
Other   |            | 54.7       |            |       | 19.07

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         342.75 ave         686 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1371
Ave neighs/atom = 0.54818073
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.3964522370874
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.4
  ghost atom cutoff = 3.4
  binsize = 1.7, bins = 3744 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.13 | 67.13 | 67.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034712575   6.3466406e-36  0              0.010413772    653690.36      0              6.3128736e+10  1.1965779e-13  0              3.3297863    
    200000   6363.961       200            200            0.094247387   -0.037958657    0              0.32070082     8493.2814      0              8.2022032e+08  1.1965779e-13  0              3.1259387    
    300000   6363.961       200            200            0.00042306979  1.1083674e-40  0              0.0012692094   28408.813      0              2.7435198e+09  1.1965779e-13  0              3.1661788    
    400000   6363.961       200            200           -0.00012041217 -5.0772663e-35  0             -0.00036123652  4038.441       0              3.9000372e+08  1.1965779e-13  0              3.1520863    
    500000   6363.961       200            200            0.00052038294 -0.00051648768  0              0.0020776365   168.03444      0              16227564       1.1965779e-13  0              3.1480431    
    600000   6363.961       200            200            0.0029960542  -0.0024770703   0              0.011465233    190.11243      0              18359698       1.1965779e-13  0              3.1455054    
    700000   6363.961       200            200            0.0031296014  -0.002707439    0              0.012096243    25.895013      0              2500755        1.1965779e-13  0              3.1453585    
    800000   6363.961       200            200            0.0033399276  -0.0027214957   0              0.012741278    2.5147864      0              242860.07      1.1965779e-13  0              3.1452436    
    900000   6363.961       200            200            0.0031491882  -0.0026969097   0              0.012144474    0.092320254    0              8915.6294      1.1965779e-13  0              3.1453548    
   1000000   6363.961       200            200            0.0032493707  -0.0027111544   0              0.012459267    0.00061648266  0              59.535483      1.1965779e-13  0              3.145295     
   1100000   6363.961       200            200            0.0032120046  -0.002705862    0              0.012341876    0.0032176074   0              310.73349      1.1965779e-13  0              3.1453174    
   1200000   6363.961       200            200            0.0032218665  -0.0027069424   0              0.012372542    0.0010266145   0              99.143076      1.1965779e-13  0              3.1453115    
   1300000   6363.961       200            200            0.003220805   -0.0027068194   0              0.012369234    0.00015185515  0              14.665084      1.1965779e-13  0              3.1453122    
   1400000   6363.961       200            200            0.0032201369  -0.0027067516   0              0.012367162    1.1305569e-05  0              1.0918109      1.1965779e-13  0              3.1453125    
   1500000   6363.961       200            200            0.0032206966  -0.0027068105   0              0.0123689      1.8903425e-07  0              0.018255575    1.1965779e-13  0              3.1453122    
   1600000   6363.961       200            200            0.0032204378  -0.0027067829   0              0.012368096    3.3220757e-08  0              0.003208223    1.1965779e-13  0              3.1453124    
   1700000   6363.961       200            200            0.0032205237  -0.0027067921   0              0.012368363    2.966362e-08   0              0.0028647001   1.1965779e-13  0              3.1453123    
   1800000   6363.961       200            200            0.003220505   -0.0027067901   0              0.012368305    6.8544204e-09  0              0.00066195086  1.1965779e-13  0              3.1453123    
   1900000   6363.961       200            200            0.0032205051  -0.0027067901   0              0.012368305    8.0602492e-10  0              7.7840117e-05  1.1965779e-13  0              3.1453123    
   2000000   6363.961       200            200            0.0032205075  -0.0027067904   0              0.012368313    4.2732784e-11  0              4.1268264e-06  1.1965779e-13  0              3.1453123    
   2100000   6363.961       200            200            0.003220506   -0.0027067902   0              0.012368308    6.1309946e-14  0              5.9208758e-09  1.1965779e-13  0              3.1453123    
   2200000   6363.961       200            200            0.0032205066  -0.0027067903   0              0.01236831     5.2890545e-13  0              5.1077902e-08  1.1965779e-13  0              3.1453123    
   2300000   6363.961       200            200            0.0032205064  -0.0027067903   0              0.01236831     2.3704193e-13  0              2.2891813e-08  1.1965779e-13  0              3.1453123    
   2400000   6363.961       200            200            0.0032205065  -0.0027067903   0              0.01236831     4.2084709e-14  0              4.06424e-09    1.1965779e-13  0              3.1453123    
   2500000   6363.961       200            200            0.0032205065  -0.0027067903   0              0.01236831     3.9131583e-15  0              3.7790482e-10  1.1965779e-13  0              3.1453123    
   2600000   6363.961       200            200            0.0032205065  -0.0027067903   0              0.01236831     1.4432983e-16  0              1.3938342e-11  1.1965779e-13  0              3.1453123    
   2700000   6363.961       200            200            0.0032205065  -0.0027067903   0              0.01236831     5.4450502e-18  0              5.2584397e-13  1.1965779e-13  0              3.1453123    
   2800000   6363.961       200            200            0.0032205065  -0.0027067903   0              0.01236831     1.2834416e-17  0              1.239456e-12   1.1965779e-13  0              3.1453123    
   2900000   6363.961       200            200            0.0032205065  -0.0027067903   0              0.01236831     3.0826117e-18  0              2.9769657e-13  1.1965779e-13  0              3.1453123    
   3000000   6363.961       200            200            0.0032205065  -0.0027067903   0              0.01236831     3.1722549e-19  0              3.0635367e-14  1.1965779e-13  0              3.1453123    
Loop time of 286.471 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9048039.194 ns/day, 0.000 hours/ns, 10472.268 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.972     | 38.058     | 65.577     | 435.9 | 13.28
Neigh   | 2.5266     | 2.5491     | 2.5713     |   1.0 |  0.89
Comm    | 14.081     | 18.985     | 23.244     |  88.0 |  6.63
Output  | 0.24122    | 0.24155    | 0.2419     |   0.1 |  0.08
Modify  | 166.57     | 171.52     | 176.33     |  32.5 | 59.87
Other   |            | 55.12      |            |       | 19.24

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         345.25 ave         691 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1381
Ave neighs/atom = 0.55217913
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.31                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.7739251711113
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.41
  ghost atom cutoff = 3.41
  binsize = 1.705, bins = 3733 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.01 | 67.02 | 67.02 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034806502  -6.3466135e-35  0              0.010441951    656074.86      0              6.3359014e+10  1.1965779e-13  0              3.3296765    
    200000   6363.961       200            200            0.096656682   -0.03909289     0              0.32906294     341.40606      0              32970554       1.1965779e-13  0              3.1306342    
    300000   6363.961       200            200            0.00043694488 -6.3466154e-36  0              0.0013108346   29965.245      0              2.8938289e+09  1.1965779e-13  0              3.1694746    
    400000   6363.961       200            200           -0.00011077101 -5.0772559e-35  0             -0.00033231302  3351.3214      0              3.2364664e+08  1.1965779e-13  0              3.1577565    
    500000   6363.961       200            200            0.00046216662 -0.00044373711  0              0.001830237    58.468713      0              5646489.8      1.1965779e-13  0              3.1531769    
    600000   6363.961       200            200            0.0033545808  -0.0025257539   0              0.012589496    196.59206      0              18985454       1.1965779e-13  0              3.1502945    
    700000   6363.961       200            200            0.002970473   -0.0027424007   0              0.01165382     22.276755      0              2151329.5      1.1965779e-13  0              3.1504521    
    800000   6363.961       200            200            0.003400865   -0.0027164694   0              0.012919064    1.4315248      0              138246.42      1.1965779e-13  0              3.1502172    
    900000   6363.961       200            200            0.0031487848  -0.0026944657   0              0.01214082     0.0049364667   0              476.72862      1.1965779e-13  0              3.150363     
   1000000   6363.961       200            200            0.003253263   -0.0027083042   0              0.012468093    0.014589289    0              1408.9291      1.1965779e-13  0              3.1503005    
   1100000   6363.961       200            200            0.0032230222  -0.0027038284   0              0.012372895    0.0068568761   0              662.18801      1.1965779e-13  0              3.1503188    
   1200000   6363.961       200            200            0.0032273364  -0.0027043175   0              0.012386327    0.0011501541   0              111.07365      1.1965779e-13  0              3.1503161    
   1300000   6363.961       200            200            0.0032288508  -0.0027044692   0              0.012391022    8.7975015e-05  0              8.4959973      1.1965779e-13  0              3.1503153    
   1400000   6363.961       200            200            0.0032273523  -0.0027043118   0              0.012386369    1.2308757e-06  0              0.11886917     1.1965779e-13  0              3.1503161    
   1500000   6363.961       200            200            0.003228056   -0.0027043868   0              0.012388555    3.5085348e-07  0              0.033882918    1.1965779e-13  0              3.1503157    
   1600000   6363.961       200            200            0.0032278317  -0.0027043626   0              0.012387858    2.5844721e-07  0              0.024958982    1.1965779e-13  0              3.1503159    
   1700000   6363.961       200            200            0.0032278727  -0.0027043671   0              0.012387985    5.2032111e-08  0              0.0050248888   1.1965779e-13  0              3.1503158    
   1800000   6363.961       200            200            0.0032278781  -0.0027043676   0              0.012388002    4.8501764e-09  0              0.00046839532  1.1965779e-13  0              3.1503158    
   1900000   6363.961       200            200            0.0032278693  -0.0027043667   0              0.012387975    1.3079062e-10  0              1.2630822e-05  1.1965779e-13  0              3.1503158    
   2000000   6363.961       200            200            0.0032278739  -0.0027043672   0              0.012387989    6.0545493e-12  0              5.8470504e-07  1.1965779e-13  0              3.1503158    
   2100000   6363.961       200            200            0.0032278723  -0.002704367    0              0.012387984    9.194674e-12   0              8.879558e-07   1.1965779e-13  0              3.1503158    
   2200000   6363.961       200            200            0.0032278727  -0.0027043671   0              0.012387985    2.2652793e-12  0              2.1876446e-07  1.1965779e-13  0              3.1503158    
   2300000   6363.961       200            200            0.0032278727  -0.0027043671   0              0.012387985    2.529207e-13   0              2.4425271e-08  1.1965779e-13  0              3.1503158    
   2400000   6363.961       200            200            0.0032278726  -0.0027043671   0              0.012387985    1.0568404e-14  0              1.0206209e-09  1.1965779e-13  0              3.1503158    
   2500000   6363.961       200            200            0.0032278727  -0.0027043671   0              0.012387985    4.4569e-17     0              4.304155e-12   1.1965779e-13  0              3.1503158    
   2600000   6363.961       200            200            0.0032278726  -0.0027043671   0              0.012387985    2.7277146e-16  0              2.6342315e-11  1.1965779e-13  0              3.1503158    
   2700000   6363.961       200            200            0.0032278727  -0.0027043671   0              0.012387985    9.732524e-17   0              9.3989751e-12  1.1965779e-13  0              3.1503158    
   2800000   6363.961       200            200            0.0032278726  -0.0027043671   0              0.012387985    4.1208912e-18  0              3.9796618e-13  1.1965779e-13  0              3.1503158    
   2900000   6363.961       200            200            0.0032278726  -0.0027043671   0              0.012387985    5.6012883e-19  0              5.4093233e-14  1.1965779e-13  0              3.1503158    
   3000000   6363.961       200            200            0.0032278727  -0.0027043671   0              0.012387985    5.5746391e-18  0              5.3835874e-13  1.1965779e-13  0              3.1503158    
Loop time of 285.985 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9063417.888 ns/day, 0.000 hours/ns, 10490.067 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.938     | 38.209     | 66.025     | 437.5 | 13.36
Neigh   | 2.5541     | 2.5758     | 2.5959     |   0.9 |  0.90
Comm    | 14.2       | 19.169     | 23.246     |  86.7 |  6.70
Output  | 0.24148    | 0.2418     | 0.24215    |   0.1 |  0.08
Modify  | 166.53     | 170.99     | 175.83     |  29.6 | 59.79
Other   |            | 54.8       |            |       | 19.16

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         347.75 ave         696 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1391
Ave neighs/atom = 0.55617753
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.32                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.1536858129059
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.42
  ghost atom cutoff = 3.42
  binsize = 1.71, bins = 3722 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.91 | 65.94 | 65.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034900437   1.5231924e-34  0              0.010470131    658462.67      0              6.3589611e+10  1.1965779e-13  0              3.3295549    
    200000   6363.961       200            200            0.090978358   -0.039242209    0              0.31217728     16271.99       0              1.5714323e+09  1.1965779e-13  0              3.1362864    
    300000   6363.961       200            200            0.00045092724 -5.07726e-35    0              0.0013527817   31561.348      0              3.047969e+09   1.1965779e-13  0              3.1727226    
    400000   6363.961       200            200           -0.00010093321  7.6159955e-35  0             -0.00030279964  2729.1096      0              2.6355787e+08  1.1965779e-13  0              3.1633654    
    500000   6363.961       200            200            0.00044236994 -0.00040714109  0              0.0017342509   5.0003151      0              482894.64      1.1965779e-13  0              3.1582431    
    600000   6363.961       200            200            0.0036900505  -0.0026853915   0              0.013755543    183.65098      0              17735697       1.1965779e-13  0              3.1550852    
    700000   6363.961       200            200            0.002840342   -0.0027477367   0              0.011268763    16.240024      0              1568345.2      1.1965779e-13  0              3.155536     
    800000   6363.961       200            200            0.0034446041  -0.002712421    0              0.013046233    0.47960792     0              46317.1        1.1965779e-13  0              3.1552004    
    900000   6363.961       200            200            0.0031585166  -0.0026919451   0              0.012167495    0.029265979    0              2826.2987      1.1965779e-13  0              3.1553654    
   1000000   6363.961       200            200            0.003253156   -0.002704933    0              0.012464401    0.03899288     0              3765.6532      1.1965779e-13  0              3.1553084    
   1100000   6363.961       200            200            0.0032349985  -0.0027018035   0              0.012406799    0.0086388027   0              834.27373      1.1965779e-13  0              3.1553196    
   1200000   6363.961       200            200            0.0032329629  -0.0027016135   0              0.012400502    0.00078271275  0              75.588795      1.1965779e-13  0              3.1553207    
   1300000   6363.961       200            200            0.0032366591  -0.0027020001   0              0.012411977    1.5195832e-05  0              1.4675047      1.1965779e-13  0              3.1553185    
   1400000   6363.961       200            200            0.0032347639  -0.0027017991   0              0.012406091    2.2001351e-06  0              0.2124733      1.1965779e-13  0              3.1553197    
   1500000   6363.961       200            200            0.0032353783  -0.0027018651   0              0.012408       1.9499389e-06  0              0.18831115     1.1965779e-13  0              3.1553193    
   1600000   6363.961       200            200            0.003235273   -0.0027018535   0              0.012407673    3.8429511e-07  0              0.037112471    1.1965779e-13  0              3.1553194    
   1700000   6363.961       200            200            0.003235252   -0.0027018514   0              0.012407607    3.0880672e-08  0              0.0029822342   1.1965779e-13  0              3.1553194    
   1800000   6363.961       200            200            0.0032352785  -0.0027018542   0              0.01240769     3.8443779e-10  0              3.712625e-05   1.1965779e-13  0              3.1553194    
   1900000   6363.961       200            200            0.0032352658  -0.0027018529   0              0.01240765     1.483052e-10   0              1.4322254e-05  1.1965779e-13  0              3.1553194    
   2000000   6363.961       200            200            0.0032352697  -0.0027018533   0              0.012407662    9.5915455e-11  0              9.2628281e-06  1.1965779e-13  0              3.1553194    
   2100000   6363.961       200            200            0.0032352691  -0.0027018532   0              0.012407661    1.6875716e-11  0              1.6297359e-06  1.1965779e-13  0              3.1553194    
   2200000   6363.961       200            200            0.0032352689  -0.0027018532   0              0.01240766     1.192056e-12   0              1.1512024e-07  1.1965779e-13  0              3.1553194    
   2300000   6363.961       200            200            0.0032352691  -0.0027018532   0              0.012407661    7.5445161e-15  0              7.2859536e-10  1.1965779e-13  0              3.1553194    
   2400000   6363.961       200            200            0.003235269   -0.0027018532   0              0.01240766     9.3934262e-15  0              9.0714987e-10  1.1965779e-13  0              3.1553194    
   2500000   6363.961       200            200            0.003235269   -0.0027018532   0              0.01240766     4.6988337e-15  0              4.5377972e-10  1.1965779e-13  0              3.1553194    
   2600000   6363.961       200            200            0.003235269   -0.0027018532   0              0.01240766     7.2807665e-16  0              7.0312431e-11  1.1965779e-13  0              3.1553194    
   2700000   6363.961       200            200            0.003235269   -0.0027018532   0              0.01240766     2.7968082e-17  0              2.7009572e-12  1.1965779e-13  0              3.1553194    
   2800000   6363.961       200            200            0.003235269   -0.0027018532   0              0.01240766     3.1716379e-18  0              3.0629409e-13  1.1965779e-13  0              3.1553194    
   2900000   6363.961       200            200            0.003235269   -0.0027018532   0              0.01240766     9.7743428e-19  0              9.4393606e-14  1.1965779e-13  0              3.1553194    
   3000000   6363.961       200            200            0.003235269   -0.0027018532   0              0.01240766     6.1769208e-20  0              5.965228e-15   1.1965779e-13  0              3.1553194    
Loop time of 288.429 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8986621.479 ns/day, 0.000 hours/ns, 10401.182 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.967     | 38.254     | 65.923     | 438.5 | 13.26
Neigh   | 2.5295     | 2.5509     | 2.5708     |   0.9 |  0.88
Comm    | 14.081     | 19.042     | 23.493     |  90.4 |  6.60
Output  | 0.23956    | 0.23987    | 0.24022    |   0.1 |  0.08
Modify  | 168.35     | 173.13     | 177.58     |  31.0 | 60.02
Other   |            | 55.22      |            |       | 19.14

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         350.25 ave         701 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1401
Ave neighs/atom = 0.56017593
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.33                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.5357410739745
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.43
  ghost atom cutoff = 3.43
  binsize = 1.715, bins = 3711 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.79 | 65.8 | 65.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0034994378   3.8079894e-35  0              0.010498313    660853.76      0              6.3820526e+10  1.1965779e-13  0              3.3294214    
    200000   6363.961       200            200            0.078902051   -0.036334517    0              0.27304067     51308.872      0              4.9550436e+09  1.1965779e-13  0              3.1428465    
    300000   6363.961       200            200            0.00046501592 -1.2693137e-35  0              0.0013950478   33196.968      0              3.2059256e+09  1.1965779e-13  0              3.1759228    
    400000   6363.961       200            200           -9.0900403e-05 -3.8079695e-35  0             -0.00027270121  2171.525       0              2.0971034e+08  1.1965779e-13  0              3.1689129    
    500000   6363.961       200            200            0.00045763435 -0.00040511616  0              0.0017780192   10.206522      0              985672.84      1.1965779e-13  0              3.1632408    
    600000   6363.961       200            200            0.0040246411  -0.0028246258   0              0.014898549    153.15074      0              14790202       1.1965779e-13  0              3.1598885    
    700000   6363.961       200            200            0.0027480262  -0.0027215962   0              0.010965675    9.4336413      0              911033.56      1.1965779e-13  0              3.1606048    
    800000   6363.961       200            200            0.0034674215  -0.0027094505   0              0.013111715    0.015097694    0              1458.0272      1.1965779e-13  0              3.160195     
    900000   6363.961       200            200            0.0031777893  -0.0026902264   0              0.012223594    0.15258414     0              14735.484      1.1965779e-13  0              3.1603621    
   1000000   6363.961       200            200            0.0032502663  -0.0027011133   0              0.012451912    0.059112478    0              5708.66        1.1965779e-13  0              3.1603179    
   1100000   6363.961       200            200            0.0032470478  -0.0026997197   0              0.012440863    0.0072864081   0              703.66914      1.1965779e-13  0              3.1603204    
   1200000   6363.961       200            200            0.0032391407  -0.0026989025   0              0.012416325    0.00024568681  0              23.726673      1.1965779e-13  0              3.1603249    
   1300000   6363.961       200            200            0.0032441107  -0.0026994287   0              0.012431761    6.8029247e-06  0              0.65697778     1.1965779e-13  0              3.160322     
   1400000   6363.961       200            200            0.0032423559  -0.002699241    0              0.012426309    1.2913864e-05  0              1.2471286      1.1965779e-13  0              3.1603231    
   1500000   6363.961       200            200            0.0032426817  -0.0026992768   0              0.012427322    2.8492735e-06  0              0.27516244     1.1965779e-13  0              3.1603229    
   1600000   6363.961       200            200            0.0032427333  -0.0026992818   0              0.012427482    2.2426061e-07  0              0.021657484    1.1965779e-13  0              3.1603228    
   1700000   6363.961       200            200            0.0032426601  -0.0026992742   0              0.012427254    1.6985841e-09  0              0.0001640371   1.1965779e-13  0              3.1603229    
   1800000   6363.961       200            200            0.0032426947  -0.0026992778   0              0.012427362    1.6361106e-09  0              0.00015800385  1.1965779e-13  0              3.1603229    
   1900000   6363.961       200            200            0.0032426849  -0.0026992768   0              0.012427332    8.1298647e-10  0              7.8512414e-05  1.1965779e-13  0              3.1603229    
   2000000   6363.961       200            200            0.0032426858  -0.0026992769   0              0.012427334    1.1512671e-10  0              1.1118113e-05  1.1965779e-13  0              3.1603229    
   2100000   6363.961       200            200            0.0032426866  -0.002699277    0              0.012427337    5.0439212e-12  0              4.8710581e-07  1.1965779e-13  0              3.1603229    
   2200000   6363.961       200            200            0.003242686   -0.0026992769   0              0.012427335    2.9484231e-14  0              2.847376e-09   1.1965779e-13  0              3.1603229    
   2300000   6363.961       200            200            0.0032426863  -0.0026992769   0              0.012427336    1.5997694e-13  0              1.5449427e-08  1.1965779e-13  0              3.1603229    
   2400000   6363.961       200            200            0.0032426862  -0.0026992769   0              0.012427336    4.1628648e-14  0              4.0201968e-09  1.1965779e-13  0              3.1603229    
   2500000   6363.961       200            200            0.0032426862  -0.0026992769   0              0.012427336    3.8404421e-15  0              3.7088241e-10  1.1965779e-13  0              3.1603229    
   2600000   6363.961       200            200            0.0032426862  -0.0026992769   0              0.012427336    6.3375282e-17  0              6.1203311e-12  1.1965779e-13  0              3.1603229    
   2700000   6363.961       200            200            0.0032426862  -0.0026992769   0              0.012427336    2.637045e-17   0              2.5466694e-12  1.1965779e-13  0              3.1603229    
   2800000   6363.961       200            200            0.0032426862  -0.0026992769   0              0.012427336    1.2329466e-17  0              1.1906916e-12  1.1965779e-13  0              3.1603229    
   2900000   6363.961       200            200            0.0032426862  -0.0026992769   0              0.012427336    5.8206418e-18  0              5.6211593e-13  1.1965779e-13  0              3.1603229    
   3000000   6363.961       200            200            0.0032426862  -0.0026992769   0              0.012427336    1.5002383e-18  0              1.4488227e-13  1.1965779e-13  0              3.1603229    
Loop time of 285.057 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9092926.521 ns/day, 0.000 hours/ns, 10524.221 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.933     | 37.238     | 64.072     | 427.7 | 13.06
Neigh   | 2.511      | 2.5322     | 2.5523     |   0.9 |  0.89
Comm    | 13.905     | 18.993     | 23.25      |  89.8 |  6.66
Output  | 0.24055    | 0.2409     | 0.24125    |   0.1 |  0.08
Modify  | 165.47     | 171.01     | 177.2      |  37.7 | 59.99
Other   |            | 55.04      |            |       | 19.31

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         327.75 ave         656 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1311
Ave neighs/atom = 0.52419032
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.34                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.920097865821
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.44
  ghost atom cutoff = 3.44
  binsize = 1.72, bins = 3700 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.62 | 65.63 | 65.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035088325   2.5386726e-35  0              0.010526497    663248.13      0              6.4051757e+10  1.1965779e-13  0              3.3292759    
    200000   6363.961       200            200            0.063249747   -0.028924067    0              0.21867331     95235.412      0              9.1971544e+09  1.1965779e-13  0              3.1501979    
    300000   6363.961       200            200            0.00047921018 -3.1733083e-36  0              0.0014376305   34871.974      0              3.3676857e+09  1.1965779e-13  0              3.1790752    
    400000   6363.961       200            200           -8.0673969e-05  7.2037751e-41  0             -0.00024202191  1678.2757      0              1.6207586e+08  1.1965779e-13  0              3.1743989    
    500000   6363.961       200            200            0.00051491701 -0.00041802499  0              0.001962776    73.543739      0              7102328        1.1965779e-13  0              3.1681701    
    600000   6363.961       200            200            0.004358313   -0.0028708787   0              0.015945818    110.86291      0              10706346       1.1965779e-13  0              3.1647149    
    700000   6363.961       200            200            0.0026883824  -0.0026968301   0              0.010761977    3.656087       0              353078.71      1.1965779e-13  0              3.1656542    
    800000   6363.961       200            200            0.0034679222  -0.0027069719   0              0.013110739    0.20897439     0              20181.251      1.1965779e-13  0              3.165202     
    900000   6363.961       200            200            0.0032048148  -0.0026902719   0              0.012304716    0.31550238     0              30468.961      1.1965779e-13  0              3.165354     
   1000000   6363.961       200            200            0.0032459296  -0.0026978834   0              0.012435672    0.063006815    0              6084.7472      1.1965779e-13  0              3.1653282    
   1100000   6363.961       200            200            0.0032580172  -0.0026983049   0              0.012472357    0.0038005858   0              367.03337      1.1965779e-13  0              3.1653216    
   1200000   6363.961       200            200            0.0032458774  -0.0026970266   0              0.012434659    1.6656851e-08  0              0.0016085995   1.1965779e-13  0              3.1653287    
   1300000   6363.961       200            200            0.0032509278  -0.0026975692   0              0.012450353    7.0211336e-05  0              6.7805083      1.1965779e-13  0              3.1653257    
   1400000   6363.961       200            200            0.0032498007  -0.002697446    0              0.012446848    2.0851274e-05  0              2.0136667      1.1965779e-13  0              3.1653264    
   1500000   6363.961       200            200            0.0032497363  -0.0026974405   0              0.012446649    1.8727284e-06  0              0.18085471     1.1965779e-13  0              3.1653264    
   1600000   6363.961       200            200            0.0032499235  -0.0026974601   0              0.012447231    1.7702814e-08  0              0.0017096111   1.1965779e-13  0              3.1653263    
   1700000   6363.961       200            200            0.0032498297  -0.0026974501   0              0.012446939    1.2476258e-08  0              0.0012048677   1.1965779e-13  0              3.1653264    
   1800000   6363.961       200            200            0.0032498558  -0.0026974529   0              0.01244702     6.2474616e-09  0              0.00060333512  1.1965779e-13  0              3.1653263    
   1900000   6363.961       200            200            0.0032498542  -0.0026974527   0              0.012447015    7.9425277e-10  0              7.6703247e-05  1.1965779e-13  0              3.1653263    
   2000000   6363.961       200            200            0.0032498515  -0.0026974525   0              0.012447007    2.2677376e-11  0              2.1900186e-06  1.1965779e-13  0              3.1653263    
   2100000   6363.961       200            200            0.0032498532  -0.0026974527   0              0.012447012    1.4263312e-12  0              1.3774486e-07  1.1965779e-13  0              3.1653263    
   2200000   6363.961       200            200            0.0032498526  -0.0026974526   0              0.012447011    1.6782674e-12  0              1.6207505e-07  1.1965779e-13  0              3.1653263    
   2300000   6363.961       200            200            0.0032498527  -0.0026974526   0              0.012447011    2.998816e-13   0              2.8960419e-08  1.1965779e-13  0              3.1653263    
   2400000   6363.961       200            200            0.0032498528  -0.0026974526   0              0.012447011    1.5721551e-14  0              1.5182749e-09  1.1965779e-13  0              3.1653263    
   2500000   6363.961       200            200            0.0032498527  -0.0026974526   0              0.012447011    2.8585085e-17  0              2.7605429e-12  1.1965779e-13  0              3.1653263    
   2600000   6363.961       200            200            0.0032498527  -0.0026974526   0              0.012447011    3.6362065e-16  0              3.511588e-11   1.1965779e-13  0              3.1653263    
   2700000   6363.961       200            200            0.0032498527  -0.0026974526   0              0.012447011    1.0006125e-16  0              9.6631992e-12  1.1965779e-13  0              3.1653263    
   2800000   6363.961       200            200            0.0032498527  -0.0026974526   0              0.012447011    4.9297838e-19  0              4.7608323e-14  1.1965779e-13  0              3.1653263    
   2900000   6363.961       200            200            0.0032498527  -0.0026974526   0              0.012447011    1.0285155e-18  0              9.9326664e-14  1.1965779e-13  0              3.1653263    
   3000000   6363.961       200            200            0.0032498527  -0.0026974526   0              0.012447011    6.1075454e-18  0              5.8982302e-13  1.1965779e-13  0              3.1653263    
Loop time of 286.98 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9031977.153 ns/day, 0.000 hours/ns, 10453.677 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.078     | 37.283     | 63.98      | 427.5 | 12.99
Neigh   | 2.4356     | 2.4563     | 2.4758     |   0.9 |  0.86
Comm    | 13.636     | 19.476     | 24.647     | 110.5 |  6.79
Output  | 0.24077    | 0.24109    | 0.24144    |   0.1 |  0.08
Modify  | 168.29     | 172.51     | 176.99     |  29.2 | 60.11
Other   |            | 55.01      |            |       | 19.17

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         330.25 ave         661 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1321
Ave neighs/atom = 0.52818872
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.35                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.3067630999496
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.45
  ghost atom cutoff = 3.45
  binsize = 1.725, bins = 3690 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.6 | 64.62 | 64.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035182277  -1.015458e-34   0              0.010554683    665645.79      0              6.4283306e+10  1.1965779e-13  0              3.3291184    
    200000   6363.961       200            200            0.043893799   -0.02636485     0              0.15804625     136919.88      0              1.3222742e+10  1.1965779e-13  0              3.1581775    
    300000   6363.961       200            200            0.00049350922 -1.2693175e-35  0              0.0014805277   36586.232      0              3.5332364e+09  1.1965779e-13  0              3.1821796    
    400000   6363.961       200            200           -7.0255393e-05  3.1733161e-36  0             -0.00021076618  1249.077       0              1.2062692e+08  1.1965779e-13  0              3.1798235    
    500000   6363.961       200            200            0.00063067479 -0.00041079338  0              0.0023028177   191.34096      0              18478340       1.1965779e-13  0              3.173032     
    600000   6363.961       200            200            0.0046401126  -0.0029060009   0              0.016826339    65.541448      0              6329523.9      1.1965779e-13  0              3.1695742    
    700000   6363.961       200            200            0.0026621417  -0.0026833718   0              0.010669797    0.39706059     0              38345.27       1.1965779e-13  0              3.1706812    
    800000   6363.961       200            200            0.0034475785  -0.0027026796   0              0.013045415    0.98259574     0              94892.064      1.1965779e-13  0              3.1702208    
    900000   6363.961       200            200            0.0032366885  -0.0026933842   0              0.01240345     0.44038157     0              42528.9        1.1965779e-13  0              3.1703425    
   1000000   6363.961       200            200            0.0032421158  -0.0026948908   0              0.012421238    0.048510803    0              4684.8261      1.1965779e-13  0              3.1703381    
   1100000   6363.961       200            200            0.0032673912  -0.0026968837   0              0.012499057    0.0006982827   0              67.435145      1.1965779e-13  0              3.1703238    
   1200000   6363.961       200            200            0.0032534631  -0.0026954025   0              0.012455792    0.00025042934  0              24.184673      1.1965779e-13  0              3.1703319    
   1300000   6363.961       200            200            0.0032574064  -0.0026958321   0              0.012468051    0.00014117366  0              13.633542      1.1965779e-13  0              3.1703295    
   1400000   6363.961       200            200            0.0032572098  -0.0026958075   0              0.012467437    1.6912727e-05  0              1.6333102      1.1965779e-13  0              3.1703297    
   1500000   6363.961       200            200            0.0032567815  -0.0026957626   0              0.012466107    3.138265e-07   0              0.030307117    1.1965779e-13  0              3.1703299    
   1600000   6363.961       200            200            0.0032570332  -0.0026957895   0              0.012466889    6.7546337e-08  0              0.0065231418   1.1965779e-13  0              3.1703298    
   1700000   6363.961       200            200            0.0032569586  -0.0026957814   0              0.012466657    4.5007161e-08  0              0.0043464694   1.1965779e-13  0              3.1703298    
   1800000   6363.961       200            200            0.0032569639  -0.0026957821   0              0.012466674    5.8508278e-09  0              0.00056503107  1.1965779e-13  0              3.1703298    
   1900000   6363.961       200            200            0.0032569712  -0.0026957828   0              0.012466696    1.3483651e-10  0              1.3021545e-05  1.1965779e-13  0              3.1703298    
   2000000   6363.961       200            200            0.0032569666  -0.0026957823   0              0.012466682    1.770142e-11   0              1.7094764e-06  1.1965779e-13  0              3.1703298    
   2100000   6363.961       200            200            0.003256968   -0.0026957825   0              0.012466687    1.4264037e-11  0              1.3775186e-06  1.1965779e-13  0              3.1703298    
   2200000   6363.961       200            200            0.0032569679  -0.0026957825   0              0.012466686    2.0122523e-12  0              1.9432892e-07  1.1965779e-13  0              3.1703298    
   2300000   6363.961       200            200            0.0032569678  -0.0026957825   0              0.012466686    5.568653e-14   0              5.3778065e-09  1.1965779e-13  0              3.1703298    
   2400000   6363.961       200            200            0.0032569679  -0.0026957825   0              0.012466686    4.3769589e-15  0              4.2269536e-10  1.1965779e-13  0              3.1703298    
   2500000   6363.961       200            200            0.0032569678  -0.0026957825   0              0.012466686    4.5214587e-15  0              4.3665012e-10  1.1965779e-13  0              3.1703298    
   2600000   6363.961       200            200            0.0032569678  -0.0026957825   0              0.012466686    6.9347014e-16  0              6.6970382e-11  1.1965779e-13  0              3.1703298    
   2700000   6363.961       200            200            0.0032569678  -0.0026957825   0              0.012466686    1.1971826e-17  0              1.1561532e-12  1.1965779e-13  0              3.1703298    
   2800000   6363.961       200            200            0.0032569678  -0.0026957825   0              0.012466686    7.8292039e-18  0              7.5608847e-13  1.1965779e-13  0              3.1703298    
   2900000   6363.961       200            200            0.0032569678  -0.0026957825   0              0.012466686    3.8798851e-18  0              3.7469153e-13  1.1965779e-13  0              3.1703298    
   3000000   6363.961       200            200            0.0032569678  -0.0026957825   0              0.012466686    5.1521533e-19  0              4.9755808e-14  1.1965779e-13  0              3.1703298    
Loop time of 285.276 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9085951.919 ns/day, 0.000 hours/ns, 10516.148 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.969     | 37.49      | 64.398     | 429.9 | 13.14
Neigh   | 2.3335     | 2.352      | 2.3698     |   0.8 |  0.82
Comm    | 13.528     | 18.518     | 22.808     |  88.9 |  6.49
Output  | 0.24131    | 0.24163    | 0.24198    |   0.1 |  0.08
Modify  | 165.93     | 171.49     | 177.63     |  38.2 | 60.11
Other   |            | 55.18      |            |       | 19.34

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.53298681
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.36                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.6957436878637
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.46
  ghost atom cutoff = 3.46
  binsize = 1.73, bins = 3679 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.48 | 64.48 | 64.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035276234  -3.1733013e-36  0              0.01058287     668046.73      0              6.4515171e+10  1.1965779e-13  0              3.3289489    
    200000   6363.961       200            200            0.026375819   -0.021139633    0              0.10026709     168317.6       0              1.6254909e+10  1.1965779e-13  0              3.1666021    
    300000   6363.961       200            200            0.00050791228  1.2693279e-35  0              0.0015237368   38339.608      0              3.7025649e+09  1.1965779e-13  0              3.185236     
    400000   6363.961       200            200           -5.9646076e-05  3.8079858e-35  0             -0.00017893823  883.6427       0              85335887       1.1965779e-13  0              3.1851866    
    500000   6363.961       200            200            0.00080627733 -0.00040968627  0              0.0028285183   356.452        0              34423583       1.1965779e-13  0              3.1778284    
    600000   6363.961       200            200            0.0048478414  -0.002931341    0              0.017474865    27.037445      0              2611082.9      1.1965779e-13  0              3.1744746    
    700000   6363.961       200            200            0.0026706681  -0.0026830515   0              0.010695056    0.47609782     0              45978.119      1.1965779e-13  0              3.1756844    
    800000   6363.961       200            200            0.003408769   -0.002698159    0              0.012924466    2.0398457      0              196993.7       1.1965779e-13  0              3.1752499    
    900000   6363.961       200            200            0.0032702308  -0.0026995167   0              0.012510209    0.46805672     0              45201.568      1.1965779e-13  0              3.1753296    
   1000000   6363.961       200            200            0.0032401141  -0.0026934773   0              0.01241382     0.024308873    0              2347.5769      1.1965779e-13  0              3.1753468    
   1100000   6363.961       200            200            0.0032743709  -0.0026965534   0              0.012519666    0.00018488074  0              17.854458      1.1965779e-13  0              3.175327     
   1200000   6363.961       200            200            0.003261403   -0.0026951681   0              0.012479377    0.00077764786  0              75.099664      1.1965779e-13  0              3.1753346    
   1300000   6363.961       200            200            0.0032633351  -0.0026953839   0              0.012485389    0.00014911567  0              14.400524      1.1965779e-13  0              3.1753334    
   1400000   6363.961       200            200            0.0032641095  -0.0026954633   0              0.012487792    5.7094657e-06  0              0.55137934     1.1965779e-13  0              3.175333     
   1500000   6363.961       200            200            0.0032634591  -0.0026953943   0              0.012485772    1.9627152e-07  0              0.018954499    1.1965779e-13  0              3.1753334    
   1600000   6363.961       200            200            0.0032636822  -0.0026954183   0              0.012486465    2.9724194e-07  0              0.028705499    1.1965779e-13  0              3.1753333    
   1700000   6363.961       200            200            0.0032636576  -0.0026954155   0              0.012486388    4.6143136e-08  0              0.0044561738   1.1965779e-13  0              3.1753333    
   1800000   6363.961       200            200            0.0032636399  -0.0026954137   0              0.012486333    1.2019921e-09  0              0.00011607979  1.1965779e-13  0              3.1753333    
   1900000   6363.961       200            200            0.0032636521  -0.002695415    0              0.012486371    1.3225416e-10  0              1.277216e-05   1.1965779e-13  0              3.1753333    
   2000000   6363.961       200            200            0.0032636484  -0.0026954146   0              0.01248636     1.0950824e-10  0              1.0575522e-05  1.1965779e-13  0              3.1753333    
   2100000   6363.961       200            200            0.0032636486  -0.0026954146   0              0.01248636     1.383157e-11   0              1.335754e-06   1.1965779e-13  0              3.1753333    
   2200000   6363.961       200            200            0.003263649   -0.0026954146   0              0.012486362    2.1382824e-13  0              2.065e-08      1.1965779e-13  0              3.1753333    
   2300000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    7.2684391e-14  0              7.0193382e-09  1.1965779e-13  0              3.1753333    
   2400000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    3.9165705e-14  0              3.7823434e-09  1.1965779e-13  0              3.1753333    
   2500000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    3.9186633e-15  0              3.7843645e-10  1.1965779e-13  0              3.1753333    
   2600000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    2.1698406e-17  0              2.0954767e-12  1.1965779e-13  0              3.1753333    
   2700000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    5.0993151e-17  0              4.9245535e-12  1.1965779e-13  0              3.1753333    
   2800000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    8.062334e-18   0              7.7860251e-13  1.1965779e-13  0              3.1753333    
   2900000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    6.5214154e-19  0              6.2979163e-14  1.1965779e-13  0              3.1753333    
   3000000   6363.961       200            200            0.0032636488  -0.0026954146   0              0.012486361    2.076853e-18   0              2.005676e-13   1.1965779e-13  0              3.1753333    
Loop time of 286.682 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9041375.158 ns/day, 0.000 hours/ns, 10464.555 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.927     | 37.561     | 64.81      | 431.3 | 13.10
Neigh   | 2.3613     | 2.3824     | 2.4026     |   0.9 |  0.83
Comm    | 13.747     | 18.74      | 22.766     |  86.9 |  6.54
Output  | 0.24104    | 0.24136    | 0.24172    |   0.1 |  0.08
Modify  | 166.95     | 172.4      | 178.92     |  37.7 | 60.14
Other   |            | 55.35      |            |       | 19.31

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.25 ave         673 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1345
Ave neighs/atom = 0.53778489
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.37                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.0870465410674
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.47
  ghost atom cutoff = 3.47
  binsize = 1.735, bins = 3668 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.31 | 64.31 | 64.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035370196   2.8701288e-40  0              0.010611059    670450.94      0              6.4747353e+10  1.1965779e-13  0              3.3287674    
    200000   6363.961       200            200            0.011967664   -0.016410484    0              0.052313476    186355.96      0              1.7996925e+10  1.1965779e-13  0              3.1752968    
    300000   6363.961       200            200            0.00052241843  1.5232052e-34  0              0.0015672553   40131.953      0              3.8756568e+09  1.1965779e-13  0              3.1882442    
    400000   6363.961       200            200           -4.8847575e-05  1.0154703e-34  0             -0.00014654272  581.6937       0              56175814       1.1965779e-13  0              3.190488     
    500000   6363.961       200            200            0.0010519511  -0.00042523575  0              0.0035810892   557.61496      0              53850462       1.1965779e-13  0              3.1825625    
    600000   6363.961       200            200            0.0049615788  -0.0029532537   0              0.01783799     4.0097336      0              387231.37      1.1965779e-13  0              3.1794221    
    700000   6363.961       200            200            0.0027157143  -0.0026904636   0              0.010837607    3.8497431      0              371780.63      1.1965779e-13  0              3.1806638    
    800000   6363.961       200            200            0.003359081   -0.0026848983   0              0.012762141    2.9822127      0              288000.75      1.1965779e-13  0              3.1802869    
    900000   6363.961       200            200            0.0033028     -0.0027059537   0              0.012614354    0.38566815     0              37245.069      1.1965779e-13  0              3.1803172    
   1000000   6363.961       200            200            0.0032418195  -0.0026920389   0              0.012417497    0.004636357    0              447.74617      1.1965779e-13  0              3.1803533    
   1100000   6363.961       200            200            0.0032792283  -0.0026963547   0              0.01253404     0.00259052     0              250.17388      1.1965779e-13  0              3.1803314    
   1200000   6363.961       200            200            0.0032697334  -0.0026953242   0              0.012504524    0.0011324933   0              109.36809      1.1965779e-13  0              3.180337     
   1300000   6363.961       200            200            0.0032692356  -0.0026952806   0              0.012502987    8.6795155e-05  0              8.3820548      1.1965779e-13  0              3.1803373    
   1400000   6363.961       200            200            0.0032707546  -0.0026954413   0              0.012507705    3.4386354e-09  0              0.00033207879  1.1965779e-13  0              3.1803364    
   1500000   6363.961       200            200            0.0032700917  -0.00269537     0              0.012505645    1.6490564e-06  0              0.15925406     1.1965779e-13  0              3.1803368    
   1600000   6363.961       200            200            0.0032702055  -0.0026953826   0              0.012505999    3.7127724e-07  0              0.035855299    1.1965779e-13  0              3.1803367    
   1700000   6363.961       200            200            0.0032702402  -0.0026953862   0              0.012506107    1.4341494e-08  0              0.0013849988   1.1965779e-13  0              3.1803367    
   1800000   6363.961       200            200            0.0032702082  -0.0026953828   0              0.012506007    6.0424369e-10  0              5.835353e-05   1.1965779e-13  0              3.1803367    
   1900000   6363.961       200            200            0.0032702189  -0.0026953839   0              0.012506041    7.8171351e-10  0              7.5492295e-05  1.1965779e-13  0              3.1803367    
   2000000   6363.961       200            200            0.003270218   -0.0026953838   0              0.012506038    1.0251175e-10  0              9.8998508e-06  1.1965779e-13  0              3.1803367    
   2100000   6363.961       200            200            0.003270217   -0.0026953837   0              0.012506035    1.2036064e-12  0              1.1623569e-07  1.1965779e-13  0              3.1803367    
   2200000   6363.961       200            200            0.0032702176  -0.0026953838   0              0.012506037    7.0145709e-13  0              6.7741705e-08  1.1965779e-13  0              3.1803367    
   2300000   6363.961       200            200            0.0032702174  -0.0026953838   0              0.012506036    3.0295006e-13  0              2.9256749e-08  1.1965779e-13  0              3.1803367    
   2400000   6363.961       200            200            0.0032702174  -0.0026953838   0              0.012506036    2.3196572e-14  0              2.2401588e-09  1.1965779e-13  0              3.1803367    
   2500000   6363.961       200            200            0.0032702175  -0.0026953838   0              0.012506036    8.7245415e-20  0              8.4255377e-15  1.1965779e-13  0              3.1803367    
   2600000   6363.961       200            200            0.0032702175  -0.0026953838   0              0.012506036    4.1148126e-16  0              3.9737915e-11  1.1965779e-13  0              3.1803367    
   2700000   6363.961       200            200            0.0032702175  -0.0026953838   0              0.012506036    9.3907771e-17  0              9.0689404e-12  1.1965779e-13  0              3.1803367    
   2800000   6363.961       200            200            0.0032702175  -0.0026953838   0              0.012506036    2.0093881e-19  0              1.9405232e-14  1.1965779e-13  0              3.1803367    
   2900000   6363.961       200            200            0.0032702175  -0.0026953838   0              0.012506036    7.1488773e-20  0              6.903874e-15   1.1965779e-13  0              3.1803367    
   3000000   6363.961       200            200            0.0032702175  -0.0026953838   0              0.012506036    4.9111572e-18  0              4.7428441e-13  1.1965779e-13  0              3.1803367    
Loop time of 287.105 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9028044.229 ns/day, 0.000 hours/ns, 10449.125 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.941     | 37.708     | 64.96      | 432.4 | 13.13
Neigh   | 2.3774     | 2.3994     | 2.4205     |   1.0 |  0.84
Comm    | 13.875     | 18.686     | 22.867     |  87.2 |  6.51
Output  | 0.23973    | 0.24004    | 0.24038    |   0.1 |  0.08
Modify  | 166.4      | 172.02     | 177.43     |  37.9 | 59.91
Other   |            | 56.05      |            |       | 19.52

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.75 ave         678 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1355
Ave neighs/atom = 0.54178329
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.38                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.4806785710646
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.48
  ghost atom cutoff = 3.48
  binsize = 1.74, bins = 3658 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 63.31 | 63.33 | 63.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035464162  -1.2693083e-35  0              0.010639248    672858.43      0              6.4979851e+10  1.1965779e-13  0              3.3285739    
    200000   6363.961       200            200            0.0039786574  -0.0066988221   0              0.018634794    192418.22      0              1.8582375e+10  1.1965779e-13  0              3.1841157    
    300000   6363.961       200            200            0.00053702688  1.5231954e-34  0              0.0016110806   41963.132      0              4.0524989e+09  1.1965779e-13  0              3.1912043    
    400000   6363.961       200            200           -3.7861331e-05  1.2693378e-35  0             -0.00011358399  342.94787      0              33119450       1.1965779e-13  0              3.1957277    
    500000   6363.961       200            200            0.0013695505  -0.00048991239  0              0.0045985638   778.9762       0              75227946       1.1965779e-13  0              3.187239     
    600000   6363.961       200            200            0.0049760622  -0.0029571048   0              0.017885291    1.7133177      0              165459.96      1.1965779e-13  0              3.1844198    
    700000   6363.961       200            200            0.002795615   -0.0027043414   0              0.011091186    9.6261559      0              929625.24      1.1965779e-13  0              3.185621     
    800000   6363.961       200            200            0.0033006259  -0.0026746424   0              0.01257652     3.4602652      0              334167.65      1.1965779e-13  0              3.1853285    
    900000   6363.961       200            200            0.0033324807  -0.0027080393   0              0.012705481    0.23251888     0              22455.01       1.1965779e-13  0              3.1853072    
   1000000   6363.961       200            200            0.0032475241  -0.0026920664   0              0.012434639    0.00088209672  0              85.186588      1.1965779e-13  0              3.1853573    
   1100000   6363.961       200            200            0.0032823353  -0.0026961951   0              0.012543201    0.0061723076   0              596.07729      1.1965779e-13  0              3.1853368    
   1200000   6363.961       200            200            0.0032780962  -0.0026957158   0              0.012530004    0.0010177528   0              98.287285      1.1965779e-13  0              3.1853394    
   1300000   6363.961       200            200            0.0032753215  -0.0026954252   0              0.01252139     1.5932845e-05  0              1.5386801      1.1965779e-13  0              3.185341     
   1400000   6363.961       200            200            0.0032771614  -0.0026956231   0              0.012527107    6.1305635e-06  0              0.59204595     1.1965779e-13  0              3.1853399    
   1500000   6363.961       200            200            0.0032766945  -0.0026955719   0              0.012525656    2.7881522e-06  0              0.26925978     1.1965779e-13  0              3.1853402    
   1600000   6363.961       200            200            0.0032766599  -0.0026955687   0              0.012525548    1.8438464e-07  0              0.017806548    1.1965779e-13  0              3.1853402    
   1700000   6363.961       200            200            0.0032767387  -0.0026955771   0              0.012525793    8.3170703e-10  0              8.0320312e-05  1.1965779e-13  0              3.1853401    
   1800000   6363.961       200            200            0.0032767073  -0.0026955737   0              0.012525696    5.0506497e-09  0              0.0004877556   1.1965779e-13  0              3.1853402    
   1900000   6363.961       200            200            0.003276711   -0.0026955741   0              0.012525707    8.1759679e-10  0              7.8957646e-05  1.1965779e-13  0              3.1853402    
   2000000   6363.961       200            200            0.0032767136  -0.0026955744   0              0.012525715    1.2171478e-11  0              1.1754342e-06  1.1965779e-13  0              3.1853402    
   2100000   6363.961       200            200            0.0032767119  -0.0026955742   0              0.01252571     5.1085662e-12  0              4.9334876e-07  1.1965779e-13  0              3.1853402    
   2200000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    2.2598348e-12  0              2.1823867e-07  1.1965779e-13  0              3.1853402    
   2300000   6363.961       200            200            0.0032767124  -0.0026955742   0              0.012525711    1.4621107e-13  0              1.4120018e-08  1.1965779e-13  0              3.1853402    
   2400000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    7.1274186e-16  0              6.8831508e-11  1.1965779e-13  0              3.1853402    
   2500000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    4.1641719e-15  0              4.0214592e-10  1.1965779e-13  0              3.1853402    
   2600000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    6.6295049e-16  0              6.4023013e-11  1.1965779e-13  0              3.1853402    
   2700000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    2.7987587e-18  0              2.7028409e-13  1.1965779e-13  0              3.1853402    
   2800000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    1.2048886e-17  0              1.1635952e-12  1.1965779e-13  0              3.1853402    
   2900000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    1.6717052e-18  0              1.6144132e-13  1.1965779e-13  0              3.1853402    
   3000000   6363.961       200            200            0.0032767123  -0.0026955742   0              0.012525711    2.0551074e-19  0              1.9846757e-14  1.1965779e-13  0              3.1853402    
Loop time of 284.506 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9110539.608 ns/day, 0.000 hours/ns, 10544.606 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.925     | 37.635     | 64.818     | 431.3 | 13.23
Neigh   | 2.3129     | 2.3322     | 2.3503     |   0.9 |  0.82
Comm    | 13.693     | 18.555     | 22.6       |  86.6 |  6.52
Output  | 0.2408     | 0.24112    | 0.24146    |   0.1 |  0.08
Modify  | 165.35     | 170.68     | 175.82     |  35.7 | 59.99
Other   |            | 55.06      |            |       | 19.35

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         341.25 ave         683 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1365
Ave neighs/atom = 0.54578169
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.39                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.8766466893589
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.49
  ghost atom cutoff = 3.49
  binsize = 1.745, bins = 3647 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 63.18 | 63.19 | 63.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.003555813    1.7180162e-40  0              0.010667439    675269.19      0              6.5212665e+10  1.1965779e-13  0              3.3283683    
    200000   6363.961       200            200            0.00018793605 -0.00061790782  0              0.001181716    190654.45      0              1.8412042e+10  1.1965779e-13  0              3.192956     
    300000   6363.961       200            200            0.00069966998 -8.3316302e-06  0              0.0021073416   43822.245      0              4.2320388e+09  1.1965779e-13  0              3.1941161    
    400000   6363.961       200            200           -2.6688793e-05 -5.0772101e-35  0             -8.0066379e-05  167.12488      0              16139725       1.1965779e-13  0              3.2009057    
    500000   6363.961       200            200            0.0017509087  -0.00067005979  0              0.0059227859   1000.1203      0              96584460       1.1965779e-13  0              3.191864     
    600000   6363.961       200            200            0.0048881864  -0.0029483114   0              0.017612871    20.583848      0              1987840.7      1.1965779e-13  0              3.1894682    
    700000   6363.961       200            200            0.002909959   -0.0027136782   0              0.011443555    16.283046      0              1572500        1.1965779e-13  0              3.1905593    
    800000   6363.961       200            200            0.0032368445  -0.0026769399   0              0.012387474    3.3023697      0              318919.23      1.1965779e-13  0              3.190371     
    900000   6363.961       200            200            0.0033553106  -0.0027088102   0              0.012774742    0.081178902    0              7839.6773      1.1965779e-13  0              3.1903013    
   1000000   6363.961       200            200            0.0032576087  -0.0026927464   0              0.012465573    0.015031727    0              1451.6566      1.1965779e-13  0              3.1903587    
   1100000   6363.961       200            200            0.003284447   -0.0026957901   0              0.012549131    0.0083842871   0              809.69444      1.1965779e-13  0              3.1903428    
   1200000   6363.961       200            200            0.0032861921  -0.0026959513   0              0.012554528    0.00053340004  0              51.511958      1.1965779e-13  0              3.1903419    
   1300000   6363.961       200            200            0.0032818128  -0.0026954846   0              0.012540923    5.5126348e-06  0              0.53237081     1.1965779e-13  0              3.1903444    
   1400000   6363.961       200            200            0.0032834735  -0.0026956652   0              0.012546086    1.7051855e-05  0              1.6467461      1.1965779e-13  0              3.1903434    
   1500000   6363.961       200            200            0.003283345   -0.00269565     0              0.012545685    2.1630984e-06  0              0.20889656     1.1965779e-13  0              3.1903435    
   1600000   6363.961       200            200            0.0032831767  -0.0026956323   0              0.012545162    6.3841353e-09  0              0.00061653409  1.1965779e-13  0              3.1903436    
   1700000   6363.961       200            200            0.0032832669  -0.002695642    0              0.012545443    2.6792547e-08  0              0.0025874325   1.1965779e-13  0              3.1903436    
   1800000   6363.961       200            200            0.0032832505  -0.0026956402   0              0.012545392    6.6613805e-09  0              0.00064330845  1.1965779e-13  0              3.1903436    
   1900000   6363.961       200            200            0.0032832454  -0.0026956397   0              0.012545376    1.7583107e-10  0              1.6980507e-05  1.1965779e-13  0              3.1903436    
   2000000   6363.961       200            200            0.0032832498  -0.0026956401   0              0.01254539     2.7705083e-11  0              2.6755586e-06  1.1965779e-13  0              3.1903436    
   2100000   6363.961       200            200            0.0032832486  -0.00269564     0              0.012545386    1.6531538e-11  0              1.5964976e-06  1.1965779e-13  0              3.1903436    
   2200000   6363.961       200            200            0.0032832486  -0.00269564     0              0.012545386    1.102965e-12   0              1.0651646e-07  1.1965779e-13  0              3.1903436    
   2300000   6363.961       200            200            0.0032832488  -0.00269564     0              0.012545386    8.7980967e-15  0              8.4965721e-10  1.1965779e-13  0              3.1903436    
   2400000   6363.961       200            200            0.0032832487  -0.00269564     0              0.012545386    3.322033e-14   0              3.2081817e-09  1.1965779e-13  0              3.1903436    
   2500000   6363.961       200            200            0.0032832487  -0.00269564     0              0.012545386    4.352033e-15   0              4.2028819e-10  1.1965779e-13  0              3.1903436    
   2600000   6363.961       200            200            0.0032832487  -0.00269564     0              0.012545386    1.5758422e-17  0              1.5218356e-12  1.1965779e-13  0              3.1903436    
   2700000   6363.961       200            200            0.0032832487  -0.00269564     0              0.012545386    6.822404e-17   0              6.5885894e-12  1.1965779e-13  0              3.1903436    
   2800000   6363.961       200            200            0.0032832487  -0.00269564     0              0.012545386    2.646146e-18   0              2.5554584e-13  1.1965779e-13  0              3.1903436    
   2900000   6363.961       200            200            0.0032832487  -0.00269564     0              0.012545386    1.6375458e-18  0              1.5814245e-13  1.1965779e-13  0              3.1903436    
   3000000   6363.961       200            200            0.0032832487  -0.00269564     0              0.012545386    7.0109081e-18  0              6.7706332e-13  1.1965779e-13  0              3.1903436    
Loop time of 285.014 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9094275.007 ns/day, 0.000 hours/ns, 10525.781 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.948     | 37.795     | 65.122     | 433.3 | 13.26
Neigh   | 2.3387     | 2.3603     | 2.3809     |   1.0 |  0.83
Comm    | 13.6       | 18.516     | 22.707     |  89.1 |  6.50
Output  | 0.24022    | 0.24054    | 0.24088    |   0.1 |  0.08
Modify  | 165.87     | 170.99     | 175.98     |  34.2 | 59.99
Other   |            | 55.12      |            |       | 19.34

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.25 ave         687 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1373
Ave neighs/atom = 0.54898041
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.4                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.2749578074541
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.5
  ghost atom cutoff = 3.5
  binsize = 1.75, bins = 3637 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 63.07 | 63.08 | 63.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035652102  -7.9332803e-36  0              0.010695631    677683.23      0              6.5445795e+10  1.1965779e-13  0              3.3281507    
    200000   6363.961       200            200           -0.00041534978  2.5386819e-35  0             -0.0012460494   186071.91      0              1.7969493e+10  1.1965779e-13  0              3.2017645    
    300000   6363.961       200            200            0.0021330754  -0.00060117103  0              0.0070003972   45314.193      0              4.3761204e+09  1.1965779e-13  0              3.196983     
    400000   6363.961       200            200           -1.533133e-05   1.5866593e-36  0             -4.599399e-05   53.945356      0              5209656.3      1.1965779e-13  0              3.206022     
    500000   6363.961       200            200            0.0022318202  -0.00088452844  0              0.0075799891   1196.8264      0              1.1558092e+08  1.1965779e-13  0              3.196446     
    600000   6363.961       200            200            0.0047106872  -0.0029117845   0              0.017043846    56.110205      0              5418722        1.1965779e-13  0              3.1945645    
    700000   6363.961       200            200            0.0030570315  -0.0027056937   0              0.011876788    22.039951      0              2128460.7      1.1965779e-13  0              3.1954828    
    800000   6363.961       200            200            0.0031790282  -0.0026775257   0              0.01221461     2.5731665      0              248498         1.1965779e-13  0              3.1954109    
    900000   6363.961       200            200            0.0033695836  -0.0027072335   0              0.012815984    0.0028641697   0              276.60101      1.1965779e-13  0              3.1953005    
   1000000   6363.961       200            200            0.0032723772  -0.002691434    0              0.012508566    0.03867453     0              3734.9093      1.1965779e-13  0              3.1953578    
   1100000   6363.961       200            200            0.0032870915  -0.0026931107   0              0.012554385    0.0076811952   0              741.79485      1.1965779e-13  0              3.1953489    
   1200000   6363.961       200            200            0.0032943849  -0.0026938738   0              0.012577028    8.5382059e-05  0              8.2455881      1.1965779e-13  0              3.1953448    
   1300000   6363.961       200            200            0.0032894252  -0.0026933407   0              0.012561616    6.4749697e-05  0              6.2530622      1.1965779e-13  0              3.1953476    
   1400000   6363.961       200            200            0.0032904658  -0.0026934558   0              0.012564853    2.0508834e-05  0              1.9805964      1.1965779e-13  0              3.195347     
   1500000   6363.961       200            200            0.0032907097  -0.0026934808   0              0.01256561     5.8203933e-07  0              0.056209193    1.1965779e-13  0              3.1953469    
   1600000   6363.961       200            200            0.0032904699  -0.0026934551   0              0.012564865    8.9537853e-08  0              0.0086469249   1.1965779e-13  0              3.195347     
   1700000   6363.961       200            200            0.0032905349  -0.0026934622   0              0.012565067    5.0594395e-08  0              0.0048860445   1.1965779e-13  0              3.195347     
   1800000   6363.961       200            200            0.0032905407  -0.0026934628   0              0.012565085    2.6454984e-09  0              0.0002554833   1.1965779e-13  0              3.195347     
   1900000   6363.961       200            200            0.0032905296  -0.0026934616   0              0.01256505     8.7176493e-11  0              8.4188817e-06  1.1965779e-13  0              3.195347     
   2000000   6363.961       200            200            0.0032905334  -0.002693462    0              0.012565062    1.1542916e-10  0              1.1147322e-05  1.1965779e-13  0              3.195347     
   2100000   6363.961       200            200            0.0032905333  -0.002693462    0              0.012565062    9.7603966e-12  0              9.4258924e-07  1.1965779e-13  0              3.195347     
   2200000   6363.961       200            200            0.0032905328  -0.002693462    0              0.01256506     3.0250082e-14  0              2.9213364e-09  1.1965779e-13  0              3.195347     
   2300000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    2.4208866e-13  0              2.337919e-08   1.1965779e-13  0              3.195347     
   2400000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    3.1221321e-14  0              3.0151317e-09  1.1965779e-13  0              3.195347     
   2500000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    2.7835751e-17  0              2.6881776e-12  1.1965779e-13  0              3.195347     
   2600000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    4.6105756e-16  0              4.4525639e-11  1.1965779e-13  0              3.195347     
   2700000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    7.4297854e-17  0              7.1751549e-12  1.1965779e-13  0              3.195347     
   2800000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    2.2216282e-18  0              2.1454895e-13  1.1965779e-13  0              3.195347     
   2900000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    4.944867e-19   0              4.7753986e-14  1.1965779e-13  0              3.195347     
   3000000   6363.961       200            200            0.003290533   -0.002693462    0              0.012565061    6.1808855e-18  0              5.9690568e-13  1.1965779e-13  0              3.195347     
Loop time of 286.647 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9042471.282 ns/day, 0.000 hours/ns, 10465.823 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.027     | 38.117     | 65.773     | 436.2 | 13.30
Neigh   | 2.2849     | 2.3056     | 2.3256     |   0.9 |  0.80
Comm    | 13.537     | 18.481     | 22.692     |  90.2 |  6.45
Output  | 0.23919    | 0.23952    | 0.23986    |   0.1 |  0.08
Modify  | 167.62     | 172.45     | 177.12     |  31.8 | 60.16
Other   |            | 55.05      |            |       | 19.20

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.25 ave         693 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1385
Ave neighs/atom = 0.55377849
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.41                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.6756188368544
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.51
  ghost atom cutoff = 3.51
  binsize = 1.755, bins = 3627 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 62.08 | 62.08 | 62.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035746076  -3.1733121e-36  0              0.010723823    680100.52      0              6.567924e+10   1.1965779e-13  0              3.3279209    
    200000   6363.961       200            200           -0.00041861878  4.7433614e-41  0             -0.0012558563   181421.16      0              1.7520357e+10  1.1965779e-13  0              3.2105295    
    300000   6363.961       200            200            0.0049656403  -0.0023612952   0              0.017258216    45521.759      0              4.3961657e+09  1.1965779e-13  0              3.1998249    
    400000   6363.961       200            200           -3.7905586e-06  1.89571e-40    0             -1.1371676e-05  3.1333582      0              302597.3       1.1965779e-13  0              3.2110763    
    500000   6363.961       200            200            0.0027764301  -0.0012662823   0              0.0095955725   1342.9966      0              1.2969699e+08  1.1965779e-13  0              3.2009955    
    600000   6363.961       200            200            0.0044383978  -0.0029113122   0              0.016226506    100.03694      0              9660851.7      1.1965779e-13  0              3.1997032    
    700000   6363.961       200            200            0.0032258982  -0.0026885444   0              0.012366239    25.31688       0              2444923.1      1.1965779e-13  0              3.2003972    
    800000   6363.961       200            200            0.0031307843  -0.0026831114   0              0.012075464    1.5437346      0              149082.84      1.1965779e-13  0              3.2004446    
    900000   6363.961       200            200            0.0033736508  -0.0027056089   0              0.012826561    0.033707164    0              3255.1966      1.1965779e-13  0              3.2003054    
   1000000   6363.961       200            200            0.0032896705  -0.0026910799   0              0.012560091    0.05801148     0              5602.3335      1.1965779e-13  0              3.2003553    
   1100000   6363.961       200            200            0.0032901374  -0.0026912029   0              0.012561615    0.0045788037   0              442.18809      1.1965779e-13  0              3.2003546    
   1200000   6363.961       200            200            0.0033014935  -0.0026924164   0              0.012596897    4.325951e-05   0              4.1776938      1.1965779e-13  0              3.2003481    
   1300000   6363.961       200            200            0.0032970872  -0.002691938    0              0.0125832      0.00013551371  0              13.086944      1.1965779e-13  0              3.2003507    
   1400000   6363.961       200            200            0.0032972421  -0.0026919582   0              0.012583684    1.2729951e-05  0              1.2293676      1.1965779e-13  0              3.2003506    
   1500000   6363.961       200            200            0.0032977767  -0.0026920151   0              0.012585345    4.1642011e-08  0              0.0040214873   1.1965779e-13  0              3.2003503    
   1600000   6363.961       200            200            0.0032975513  -0.0026919906   0              0.012584644    3.1255563e-07  0              0.030184386    1.1965779e-13  0              3.2003504    
   1700000   6363.961       200            200            0.0032975655  -0.0026919923   0              0.012584689    3.47507e-08    0              0.0033559738   1.1965779e-13  0              3.2003504    
   1800000   6363.961       200            200            0.0032975904  -0.002691995    0              0.012584766    1.628175e-11   0              1.5723749e-06  1.1965779e-13  0              3.2003504    
   1900000   6363.961       200            200            0.0032975789  -0.0026919937   0              0.012584731    7.1150696e-10  0              6.8712249e-05  1.1965779e-13  0              3.2003504    
   2000000   6363.961       200            200            0.00329758    -0.0026919939   0              0.012584734    9.3371403e-11  0              9.0171417e-06  1.1965779e-13  0              3.2003504    
   2100000   6363.961       200            200            0.0032975811  -0.002691994    0              0.012584737    1.035625e-14   0              1.0001325e-09  1.1965779e-13  0              3.2003504    
   2200000   6363.961       200            200            0.0032975805  -0.0026919939   0              0.012584736    1.5974089e-12  0              1.5426631e-07  1.1965779e-13  0              3.2003504    
   2300000   6363.961       200            200            0.0032975806  -0.0026919939   0              0.012584736    2.4730995e-13  0              2.3883425e-08  1.1965779e-13  0              3.2003504    
   2400000   6363.961       200            200            0.0032975807  -0.0026919939   0              0.012584736    4.2227569e-16  0              4.0780364e-11  1.1965779e-13  0              3.2003504    
   2500000   6363.961       200            200            0.0032975806  -0.0026919939   0              0.012584736    3.4539123e-15  0              3.3355413e-10  1.1965779e-13  0              3.2003504    
   2600000   6363.961       200            200            0.0032975806  -0.0026919939   0              0.012584736    6.5862119e-16  0              6.360492e-11   1.1965779e-13  0              3.2003504    
   2700000   6363.961       200            200            0.0032975806  -0.0026919939   0              0.012584736    2.0943766e-19  0              2.022599e-14   1.1965779e-13  0              3.2003504    
   2800000   6363.961       200            200            0.0032975806  -0.0026919939   0              0.012584736    1.3434501e-17  0              1.297408e-12   1.1965779e-13  0              3.2003504    
   2900000   6363.961       200            200            0.0032975806  -0.0026919939   0              0.012584736    1.0707146e-18  0              1.0340196e-13  1.1965779e-13  0              3.2003504    
   3000000   6363.961       200            200            0.0032975806  -0.0026919939   0              0.012584736    8.0059202e-19  0              7.7315447e-14  1.1965779e-13  0              3.2003504    
Loop time of 285.785 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9069742.357 ns/day, 0.000 hours/ns, 10497.387 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.024     | 38.262     | 66.067     | 438.4 | 13.39
Neigh   | 2.3064     | 2.3274     | 2.3471     |   0.9 |  0.81
Comm    | 13.643     | 18.526     | 22.759     |  90.1 |  6.48
Output  | 0.24082    | 0.24114    | 0.24149    |   0.1 |  0.08
Modify  | 166.8      | 171.31     | 175.45     |  29.2 | 59.94
Other   |            | 55.12      |            |       | 19.29

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         348.75 ave         698 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1395
Ave neighs/atom = 0.55777689
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.42                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.0786366890634
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.52
  ghost atom cutoff = 3.52
  binsize = 1.76, bins = 3616 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 61.91 | 61.92 | 61.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0035840053   1.6814521e-40  0              0.010752016    682521.08      0              6.5913001e+10  1.1965779e-13  0              3.327679     
    200000   6363.961       200            200           -0.00042165897  5.0775e-35     0             -0.0012649769   176833.48      0              1.7077312e+10  1.1965779e-13  0              3.2192508    
    300000   6363.961       200            200            0.009359069   -0.0045810813   0              0.032658288    43541.097      0              4.2048875e+09  1.1965779e-13  0              3.2026835    
    400000   6363.961       200            200            7.9321793e-06 -3.8079707e-35  0              2.3796538e-05  14.411525      0              1391761.9      1.1965779e-13  0              3.2160687    
    500000   6363.961       200            200            0.0034297015  -0.0016587417   0              0.011947846    1413.8454      0              1.3653907e+08  1.1965779e-13  0              3.2055251    
    600000   6363.961       200            200            0.0041148622  -0.0028806009   0              0.015225188    142.51368      0              13762952       1.1965779e-13  0              3.2048764    
    700000   6363.961       200            200            0.0034012701  -0.0026774862   0              0.012881297    25.16549       0              2430302.9      1.1965779e-13  0              3.2053085    
    800000   6363.961       200            200            0.0030989893  -0.002687071    0              0.011984039    0.58858349     0              56841.18       1.1965779e-13  0              3.2054694    
    900000   6363.961       200            200            0.0033683025  -0.0027027621   0              0.012807669    0.15803043     0              15261.448      1.1965779e-13  0              3.2053157    
   1000000   6363.961       200            200            0.0033081431  -0.0026909287   0              0.012615358    0.06187648     0              5975.5875      1.1965779e-13  0              3.205352     
   1100000   6363.961       200            200            0.0032945241  -0.0026895117   0              0.012573084    0.0012551247   0              121.21096      1.1965779e-13  0              3.2053595    
   1200000   6363.961       200            200            0.0033077199  -0.0026909455   0              0.012614105    0.00043619013  0              42.124121      1.1965779e-13  0              3.205352     
   1300000   6363.961       200            200            0.0033048495  -0.0026906273   0              0.012605176    0.00014955621  0              14.443068      1.1965779e-13  0              3.2053536    
   1400000   6363.961       200            200            0.0033040941  -0.0026905485   0              0.012602831    2.3971915e-06  0              0.23150359     1.1965779e-13  0              3.2053541    
   1500000   6363.961       200            200            0.0033047505  -0.0026906196   0              0.012604871    1.2015114e-06  0              0.11603337     1.1965779e-13  0              3.2053537    
   1600000   6363.961       200            200            0.0033046181  -0.0026906049   0              0.012604459    3.5979194e-07  0              0.034746131    1.1965779e-13  0              3.2053538    
   1700000   6363.961       200            200            0.0033045769  -0.0026906006   0              0.012604331    4.3897719e-09  0              0.00042393275  1.1965779e-13  0              3.2053538    
   1800000   6363.961       200            200            0.0033046094  -0.0026906041   0              0.012604432    3.2741557e-09  0              0.00031619452  1.1965779e-13  0              3.2053538    
   1900000   6363.961       200            200            0.0033046034  -0.0026906034   0              0.012604414    8.6131515e-10  0              8.3179652e-05  1.1965779e-13  0              3.2053538    
   2000000   6363.961       200            200            0.0033046012  -0.0026906032   0              0.012604407    7.6075019e-12  0              7.3467808e-07  1.1965779e-13  0              3.2053538    
   2100000   6363.961       200            200            0.0033046028  -0.0026906034   0              0.012604412    8.8315808e-12  0              8.5289086e-07  1.1965779e-13  0              3.2053538    
   2200000   6363.961       200            200            0.0033046025  -0.0026906033   0              0.012604411    2.0506947e-12  0              1.9804142e-07  1.1965779e-13  0              3.2053538    
   2300000   6363.961       200            200            0.0033046024  -0.0026906033   0              0.01260441     1.2114586e-14  0              1.16994e-09    1.1965779e-13  0              3.2053538    
   2400000   6363.961       200            200            0.0033046025  -0.0026906033   0              0.012604411    2.3359955e-14  0              2.2559372e-09  1.1965779e-13  0              3.2053538    
   2500000   6363.961       200            200            0.0033046024  -0.0026906033   0              0.012604411    4.881646e-15   0              4.7143443e-10  1.1965779e-13  0              3.2053538    
   2600000   6363.961       200            200            0.0033046024  -0.0026906033   0              0.012604411    1.9514747e-17  0              1.8845945e-12  1.1965779e-13  0              3.2053538    
   2700000   6363.961       200            200            0.0033046024  -0.0026906033   0              0.012604411    7.7028717e-17  0              7.4388821e-12  1.1965779e-13  0              3.2053538    
   2800000   6363.961       200            200            0.0033046024  -0.0026906033   0              0.012604411    8.7376904e-19  0              8.438236e-14   1.1965779e-13  0              3.2053538    
   2900000   6363.961       200            200            0.0033046024  -0.0026906033   0              0.012604411    6.8400827e-18  0              6.6056623e-13  1.1965779e-13  0              3.2053538    
   3000000   6363.961       200            200            0.0033046024  -0.0026906033   0              0.012604411    2.4758432e-18  0              2.3909921e-13  1.1965779e-13  0              3.2053538    
Loop time of 286.53 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9046157.677 ns/day, 0.000 hours/ns, 10470.090 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.918     | 38.302     | 66.194     | 439.2 | 13.37
Neigh   | 2.3275     | 2.3478     | 2.3679     |   0.9 |  0.82
Comm    | 13.837     | 18.72      | 22.85      |  87.8 |  6.53
Output  | 0.23978    | 0.24009    | 0.24044    |   0.1 |  0.08
Modify  | 167.55     | 171.87     | 176.15     |  28.6 | 59.98
Other   |            | 55.05      |            |       | 19.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         350.75 ave         702 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1403
Ave neighs/atom = 0.56097561
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.43                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.4840182755848
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.53
  ghost atom cutoff = 3.53
  binsize = 1.765, bins = 3606 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 61.76 | 61.79 | 61.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.003593403    2.6671818e-41  0              0.010780209    684944.9       0              6.6147076e+10  1.1965779e-13  0              3.327425     
    200000   6363.961       200            200           -0.00042447131  1.2935573e-41  0             -0.0012734139   172308.71      0              1.6640342e+10  1.1965779e-13  0              3.2279283    
    300000   6363.961       200            200            0.015219457   -0.0068577428   0              0.052516115    38733.38       0              3.7405926e+09  1.1965779e-13  0              3.2056218    
    400000   6363.961       200            200            1.983548e-05  -5.0772e-35     0              5.9506441e-05  87.505299      0              8450635.4      1.1965779e-13  0              3.220999     
    500000   6363.961       200            200            0.004187016   -0.0020209715   0              0.01458202     1391.3395      0              1.3436561e+08  1.1965779e-13  0              3.2100498    
    600000   6363.961       200            200            0.0037270368  -0.0029292402   0              0.014110351    174.4636       0              16848446       1.1965779e-13  0              3.2100746    
    700000   6363.961       200            200            0.0035703995  -0.0026748234   0              0.013386022    21.572323      0              2083300.5      1.1965779e-13  0              3.2102233    
    800000   6363.961       200            200            0.0030878755  -0.0026862204   0              0.011949847    0.049650115    0              4794.8528      1.1965779e-13  0              3.2104834    
    900000   6363.961       200            200            0.0033557266  -0.0026969804   0              0.01276416     0.31641655     0              30557.246      1.1965779e-13  0              3.2103306    
   1000000   6363.961       200            200            0.0033268769  -0.0026883917   0              0.012669023    0.048124626    0              4647.5319      1.1965779e-13  0              3.2103491    
   1100000   6363.961       200            200            0.0033015183  -0.0026857071   0              0.012590262    9.6754256e-06  0              0.93438335     1.1965779e-13  0              3.2103634    
   1200000   6363.961       200            200            0.0033140432  -0.0026870759   0              0.012629205    0.00093570286  0              90.363485      1.1965779e-13  0              3.2103562    
   1300000   6363.961       200            200            0.0033133218  -0.0026869887   0              0.012626954    9.3921904e-05  0              9.0703053      1.1965779e-13  0              3.2103566    
   1400000   6363.961       200            200            0.0033118709  -0.0026868341   0              0.012622447    8.4671526e-07  0              0.081769699    1.1965779e-13  0              3.2103574    
   1500000   6363.961       200            200            0.0033124478  -0.002686897    0              0.01262424     2.5938857e-06  0              0.25049892     1.1965779e-13  0              3.2103571    
   1600000   6363.961       200            200            0.0033124527  -0.0026868971   0              0.012624255    1.6670029e-07  0              0.016098721    1.1965779e-13  0              3.2103571    
   1700000   6363.961       200            200            0.0033123733  -0.0026868886   0              0.012624008    6.75027e-09    0              0.00065189276  1.1965779e-13  0              3.2103572    
   1800000   6363.961       200            200            0.0033123989  -0.0026868914   0              0.012624088    6.7562344e-09  0              0.00065246876  1.1965779e-13  0              3.2103571    
   1900000   6363.961       200            200            0.0033124011  -0.0026868916   0              0.012624095    2.589761e-10   0              2.5010058e-05  1.1965779e-13  0              3.2103571    
   2000000   6363.961       200            200            0.0033123969  -0.0026868911   0              0.012624082    3.3188952e-11  0              3.2051514e-06  1.1965779e-13  0              3.2103571    
   2100000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    1.6597261e-11  0              1.6028446e-06  1.1965779e-13  0              3.2103571    
   2200000   6363.961       200            200            0.0033123982  -0.0026868913   0              0.012624086    3.2509693e-13  0              3.1395535e-08  1.1965779e-13  0              3.2103571    
   2300000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    1.3042825e-13  0              1.2595827e-08  1.1965779e-13  0              3.2103571    
   2400000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    3.8338535e-14  0              3.7024613e-09  1.1965779e-13  0              3.2103571    
   2500000   6363.961       200            200            0.0033123981  -0.0026868913   0              0.012624085    2.4934652e-16  0              2.4080102e-11  1.1965779e-13  0              3.2103571    
   2600000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    4.4539319e-16  0              4.3012886e-11  1.1965779e-13  0              3.2103571    
   2700000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    5.9663996e-17  0              5.7619217e-12  1.1965779e-13  0              3.2103571    
   2800000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    5.6845508e-18  0              5.4897323e-13  1.1965779e-13  0              3.2103571    
   2900000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    4.0167537e-19  0              3.8790932e-14  1.1965779e-13  0              3.2103571    
   3000000   6363.961       200            200            0.003312398   -0.0026868913   0              0.012624085    1.4157082e-18  0              1.3671897e-13  1.1965779e-13  0              3.2103571    
Loop time of 284.739 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9103084.023 ns/day, 0.000 hours/ns, 10535.977 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.099     | 37.162     | 63.639     | 425.9 | 13.05
Neigh   | 2.2879     | 2.3076     | 2.3266     |   0.9 |  0.81
Comm    | 13.322     | 19.217     | 24.5       | 112.2 |  6.75
Output  | 0.23827    | 0.23859    | 0.23895    |   0.1 |  0.08
Modify  | 166.63     | 171.13     | 175.76     |  29.2 | 60.10
Other   |            | 54.68      |            |       | 19.20

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         328.25 ave         657 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1313
Ave neighs/atom = 0.52499
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.44                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.8917705079228
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.54
  ghost atom cutoff = 3.54
  binsize = 1.77, bins = 3596 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 60.83 | 60.83 | 60.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036028008   1.983321e-37   0              0.010808403    687371.98      0              6.6381466e+10  1.1965779e-13  0              3.3271587    
    200000   6363.961       200            200           -0.00042705678 -1.9039867e-35  0             -0.0012811703   167846.69      0              1.6209432e+10  1.1965779e-13  0              3.236562     
    300000   6363.961       200            200            0.022485684   -0.0077776818   0              0.075234733    31064.419      0              2.9999793e+09  1.1965779e-13  0              3.2087212    
    400000   6363.961       200            200            3.1917876e-05 -1.5866553e-36  0              9.5753628e-05  222.14109      0              21452797       1.1965779e-13  0              3.2258673    
    500000   6363.961       200            200            0.0049918689  -0.0024181831   0              0.01739379     1269.2908      0              1.2257902e+08  1.1965779e-13  0              3.2145865    
    600000   6363.961       200            200            0.0033510388  -0.0029050418   0              0.012958158    189.56822      0              18307142       1.1965779e-13  0              3.2152871    
    700000   6363.961       200            200            0.0037250118  -0.0026683409   0              0.013843376    15.503676      0              1497234.1      1.1965779e-13  0              3.215148     
    800000   6363.961       200            200            0.0030985479  -0.0026817453   0              0.011977389    0.11590575     0              11193.348      1.1965779e-13  0              3.2154856    
    900000   6363.961       200            200            0.0033379836  -0.0026899176   0              0.012703868    0.43427136     0              41938.82       1.1965779e-13  0              3.2153486    
   1000000   6363.961       200            200            0.0033437377  -0.0026847772   0              0.01271599     0.024753945    0              2390.5589      1.1965779e-13  0              3.2153474    
   1100000   6363.961       200            200            0.0033107598  -0.0026812956   0              0.012613575    0.001674468    0              161.70813      1.1965779e-13  0              3.2153661    
   1200000   6363.961       200            200            0.0033202869  -0.0026823402   0              0.012643201    0.0011312441   0              109.24746      1.1965779e-13  0              3.2153606    
   1300000   6363.961       200            200            0.0033218343  -0.0026824971   0              0.012648       2.2116412e-05  0              2.1358448      1.1965779e-13  0              3.2153597    
   1400000   6363.961       200            200            0.0033200792  -0.0026823094   0              0.012642547    9.6413671e-06  0              0.93109423     1.1965779e-13  0              3.2153607    
   1500000   6363.961       200            200            0.003320404   -0.0026823453   0              0.012643557    2.4884451e-06  0              0.24031622     1.1965779e-13  0              3.2153605    
   1600000   6363.961       200            200            0.0033205419  -0.0026823597   0              0.012643985    3.6929086e-09  0              0.00035663468  1.1965779e-13  0              3.2153605    
   1700000   6363.961       200            200            0.0033204562  -0.0026823505   0              0.012643719    3.7708664e-08  0              0.0036416329   1.1965779e-13  0              3.2153605    
   1800000   6363.961       200            200            0.0033204636  -0.0026823514   0              0.012643742    4.5159234e-09  0              0.00043611556  1.1965779e-13  0              3.2153605    
   1900000   6363.961       200            200            0.0033204729  -0.0026823524   0              0.012643771    3.314227e-11   0              3.2006432e-06  1.1965779e-13  0              3.2153605    
   2000000   6363.961       200            200            0.0033204691  -0.0026823519   0              0.012643759    1.16822e-10    0              1.1281832e-05  1.1965779e-13  0              3.2153605    
   2100000   6363.961       200            200            0.003320469   -0.0026823519   0              0.012643759    6.2923437e-12  0              6.0766952e-07  1.1965779e-13  0              3.2153605    
   2200000   6363.961       200            200            0.0033204695  -0.002682352    0              0.012643761    4.8325016e-13  0              4.6668841e-08  1.1965779e-13  0              3.2153605    
   2300000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     3.0169601e-13  0              2.9135641e-08  1.1965779e-13  0              3.2153605    
   2400000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     5.1911777e-15  0              5.0132679e-10  1.1965779e-13  0              3.2153605    
   2500000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     2.7069976e-15  0              2.6142245e-10  1.1965779e-13  0              3.2153605    
   2600000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     6.563583e-16   0              6.3386387e-11  1.1965779e-13  0              3.2153605    
   2700000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     5.2653788e-19  0              5.084926e-14   1.1965779e-13  0              3.2153605    
   2800000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     1.218555e-17   0              1.1767932e-12  1.1965779e-13  0              3.2153605    
   2900000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     5.1906528e-18  0              5.012761e-13   1.1965779e-13  0              3.2153605    
   3000000   6363.961       200            200            0.0033204694  -0.002682352    0              0.01264376     2.422e-19      0              2.3389943e-14  1.1965779e-13  0              3.2153605    
Loop time of 285.53 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9077848.921 ns/day, 0.000 hours/ns, 10506.770 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.938     | 37.404     | 64.361     | 430.0 | 13.10
Neigh   | 2.1726     | 2.1924     | 2.212      |   0.9 |  0.77
Comm    | 13.371     | 18.333     | 22.569     |  89.2 |  6.42
Output  | 0.24045    | 0.24077    | 0.24111    |   0.1 |  0.08
Modify  | 167.46     | 172.67     | 178.34     |  35.1 | 60.47
Other   |            | 54.69      |            |       | 19.15

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.25 ave         663 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1325
Ave neighs/atom = 0.52978808
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.45                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.3019002975809
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.55
  ghost atom cutoff = 3.55
  binsize = 1.775, bins = 3586 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 60.68 | 60.7 | 60.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036121987   5.0773418e-35  0              0.010836596    689802.32      0              6.661617e+10   1.1965779e-13  0              3.3268803    
    200000   6363.961       200            200           -0.00042941631  4.3682344e-39  0             -0.0012882489   163447.26      0              1.5784567e+10  1.1965779e-13  0              3.2451518    
    300000   6363.961       200            200            0.029960764   -0.0083747211   0              0.098257014    21409.045      0              2.0675323e+09  1.1965779e-13  0              3.2120754    
    400000   6363.961       200            200            4.417786e-05   6.3466547e-36  0              0.00013253358  418.04506      0              40371800       1.1965779e-13  0              3.2306735    
    500000   6363.961       200            200            0.0057821834  -0.0029099406   0              0.020256491    1057.6759      0              1.0214277e+08  1.1965779e-13  0              3.2191531    
    600000   6363.961       200            200            0.0030176106  -0.0027824926   0              0.011835325    185.42094      0              17906627       1.1965779e-13  0              3.2205028    
    700000   6363.961       200            200            0.0038477138  -0.0026759747   0              0.014219116    8.6589034      0              836214.91      1.1965779e-13  0              3.2200881    
    800000   6363.961       200            200            0.0031287913  -0.0026797006   0              0.012066075    0.75875437     0              73275.066      1.1965779e-13  0              3.2204763    
    900000   6363.961       200            200            0.0033184233  -0.0026812969   0              0.012636567    0.45692349     0              44126.4        1.1965779e-13  0              3.220368     
   1000000   6363.961       200            200            0.0033570163  -0.0026811337   0              0.012752183    0.0051950069   0              501.69658      1.1965779e-13  0              3.2203476    
   1100000   6363.961       200            200            0.0033216463  -0.0026774025   0              0.012642341    0.0050680252   0              489.4336       1.1965779e-13  0              3.2203678    
   1200000   6363.961       200            200            0.00332646    -0.0026779424   0              0.012657322    0.0008658543   0              83.61801       1.1965779e-13  0              3.2203649    
   1300000   6363.961       200            200            0.0033298894  -0.0026783022   0              0.01266797     2.1059536e-06  0              0.20337792     1.1965779e-13  0              3.220363     
   1400000   6363.961       200            200            0.0033282908  -0.0026781303   0              0.012663003    1.9086156e-05  0              1.8432043      1.1965779e-13  0              3.2203639    
   1500000   6363.961       200            200            0.0033282712  -0.0026781295   0              0.012662943    1.028209e-06   0              0.099297063    1.1965779e-13  0              3.2203639    
   1600000   6363.961       200            200            0.0033284921  -0.0026781529   0              0.012663629    9.4973409e-08  0              0.009171852    1.1965779e-13  0              3.2203638    
   1700000   6363.961       200            200            0.0033284336  -0.0026781465   0              0.012663447    4.9293837e-08  0              0.004760446    1.1965779e-13  0              3.2203638    
   1800000   6363.961       200            200            0.00332842    -0.0026781451   0              0.012663405    3.9720398e-10  0              3.8359118e-05  1.1965779e-13  0              3.2203639    
   1900000   6363.961       200            200            0.0033284316  -0.0026781464   0              0.012663441    5.9593419e-10  0              5.7551059e-05  1.1965779e-13  0              3.2203638    
   2000000   6363.961       200            200            0.0033284302  -0.0026781462   0              0.012663437    8.922393e-11   0              8.6166085e-06  1.1965779e-13  0              3.2203638    
   2100000   6363.961       200            200            0.0033284291  -0.0026781461   0              0.012663433    4.5662847e-13  0              4.4097909e-08  1.1965779e-13  0              3.2203639    
   2200000   6363.961       200            200            0.0033284296  -0.0026781461   0              0.012663435    2.1326405e-12  0              2.0595516e-07  1.1965779e-13  0              3.2203638    
   2300000   6363.961       200            200            0.0033284296  -0.0026781461   0              0.012663435    9.8468604e-14  0              9.5093929e-09  1.1965779e-13  0              3.2203638    
   2400000   6363.961       200            200            0.0033284295  -0.0026781461   0              0.012663435    1.1918474e-14  0              1.1510009e-09  1.1965779e-13  0              3.2203638    
   2500000   6363.961       200            200            0.0033284295  -0.0026781461   0              0.012663435    5.3281902e-15  0              5.1455847e-10  1.1965779e-13  0              3.2203638    
   2600000   6363.961       200            200            0.0033284295  -0.0026781461   0              0.012663435    4.0208756e-17  0              3.8830738e-12  1.1965779e-13  0              3.2203638    
   2700000   6363.961       200            200            0.0033284295  -0.0026781461   0              0.012663435    8.0235108e-17  0              7.7485325e-12  1.1965779e-13  0              3.2203638    
   2800000   6363.961       200            200            0.0033284295  -0.0026781461   0              0.012663435    3.5872645e-19  0              3.4643233e-14  1.1965779e-13  0              3.2203638    
   2900000   6363.961       200            200            0.0033284295  -0.0026781461   0              0.012663435    3.2492621e-18  0              3.1379048e-13  1.1965779e-13  0              3.2203638    
   3000000   6363.961       200            200            0.0033284295  -0.0026781461   0              0.012663435    3.497379e-18   0              3.3775183e-13  1.1965779e-13  0              3.2203638    
Loop time of 285.35 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9083586.049 ns/day, 0.000 hours/ns, 10513.410 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.058     | 37.381     | 64.182     | 429.2 | 13.10
Neigh   | 2.1243     | 2.1426     | 2.1601     |   0.9 |  0.75
Comm    | 13.181     | 18.948     | 24.086     | 111.4 |  6.64
Output  | 0.24105    | 0.24137    | 0.24171    |   0.1 |  0.08
Modify  | 167.45     | 171.65     | 175.73     |  27.7 | 60.15
Other   |            | 54.99      |            |       | 19.27

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         333.75 ave         668 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1335
Ave neighs/atom = 0.53378649
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.46                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.7144145560632
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.56
  ghost atom cutoff = 3.56
  binsize = 1.78, bins = 3576 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 60.56 | 60.57 | 60.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036215966  -1.2693064e-35  0              0.01086479     692235.9       0              6.6851189e+10  1.1965779e-13  0              3.3265897    
    200000   6363.961       200            200           -0.00043155088 -5.077174e-35   0             -0.0012946526   159110.24      0              1.5365728e+10  1.1965779e-13  0              3.2536976    
    300000   6363.961       200            200            0.03622602    -0.0099919596   0              0.11867002     11544.737      0              1.114908e+09   1.1965779e-13  0              3.2157797    
    400000   6363.961       200            200            5.6614098e-05  1.269333e-35   0              0.00016984229  674.94702      0              65181552       1.1965779e-13  0              3.2354174    
    500000   6363.961       200            200            0.0065851024  -0.0032369634   0              0.022992271    784.07458      0              75720311       1.1965779e-13  0              3.2237681    
    600000   6363.961       200            200            0.0027129375  -0.0026636589   0              0.010802471    163.65003      0              15804149       1.1965779e-13  0              3.2257111    
    700000   6363.961       200            200            0.0039348619  -0.002678023    0              0.014482609    2.9953006      0              289264.7       1.1965779e-13  0              3.2250485    
    800000   6363.961       200            200            0.003176881   -0.0026794902   0              0.012210133    1.7433611      0              168361.33      1.1965779e-13  0              3.2254565    
    900000   6363.961       200            200            0.0033021447  -0.0026662887   0              0.012572723    0.37462689     0              36178.784      1.1965779e-13  0              3.2253868    
   1000000   6363.961       200            200            0.0033668819  -0.0026745056   0              0.012775151    0.00055561907  0              53.657713      1.1965779e-13  0              3.2253503    
   1100000   6363.961       200            200            0.0033346004  -0.002671105    0              0.012674906    0.0078389604   0              757.03068      1.1965779e-13  0              3.2253688    
   1200000   6363.961       200            200            0.0033339018  -0.0026710554   0              0.012672761    0.00035838774  0              34.610523      1.1965779e-13  0              3.2253691    
   1300000   6363.961       200            200            0.0033384214  -0.0026715328   0              0.012686797    5.1997523e-05  0              5.0215486      1.1965779e-13  0              3.2253665    
   1400000   6363.961       200            200            0.0033373878  -0.0026714206   0              0.012683584    1.8941291e-05  0              1.8292143      1.1965779e-13  0              3.2253671    
   1500000   6363.961       200            200            0.0033370365  -0.0026713843   0              0.012682494    1.305785e-08   0              0.0012610337   1.1965779e-13  0              3.2253673    
   1600000   6363.961       200            200            0.0033372635  -0.0026714085   0              0.012683199    3.1155174e-07  0              0.030087438    1.1965779e-13  0              3.2253672    
   1700000   6363.961       200            200            0.0033372542  -0.0026714074   0              0.01268317     2.3939421e-08  0              0.0023118979   1.1965779e-13  0              3.2253672    
   1800000   6363.961       200            200            0.0033372259  -0.0026714044   0              0.012683082    1.3413324e-09  0              0.00012953628  1.1965779e-13  0              3.2253672    
   1900000   6363.961       200            200            0.0033372342  -0.0026714053   0              0.012683108    8.9992377e-10  0              8.6908196e-05  1.1965779e-13  0              3.2253672    
   2000000   6363.961       200            200            0.003337236   -0.0026714055   0              0.012683113    6.5063369e-12  0              6.2833544e-07  1.1965779e-13  0              3.2253672    
   2100000   6363.961       200            200            0.0033372344  -0.0026714053   0              0.012683109    1.1610138e-11  0              1.121224e-06   1.1965779e-13  0              3.2253672    
   2200000   6363.961       200            200            0.0033372346  -0.0026714053   0              0.012683109    1.4269024e-12  0              1.3780002e-07  1.1965779e-13  0              3.2253672    
   2300000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.01268311     2.5877964e-14  0              2.4991086e-09  1.1965779e-13  0              3.2253672    
   2400000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.012683109    4.047005e-14   0              3.9083078e-09  1.1965779e-13  0              3.2253672    
   2500000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.012683109    8.4413032e-16  0              8.1520064e-11  1.1965779e-13  0              3.2253672    
   2600000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.012683109    3.8389264e-16  0              3.7073603e-11  1.1965779e-13  0              3.2253672    
   2700000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.012683109    5.6812909e-17  0              5.4865841e-12  1.1965779e-13  0              3.2253672    
   2800000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.012683109    8.6119345e-18  0              8.3167899e-13  1.1965779e-13  0              3.2253672    
   2900000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.012683109    7.6486844e-19  0              7.3865519e-14  1.1965779e-13  0              3.2253672    
   3000000   6363.961       200            200            0.0033372347  -0.0026714053   0              0.012683109    5.591214e-19   0              5.3995943e-14  1.1965779e-13  0              3.2253672    
Loop time of 286.631 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9042978.466 ns/day, 0.000 hours/ns, 10466.410 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.064     | 37.482     | 64.445     | 430.2 | 13.08
Neigh   | 2.1507     | 2.1712     | 2.191      |   1.0 |  0.76
Comm    | 13.028     | 18.942     | 24.177     | 113.9 |  6.61
Output  | 0.24018    | 0.24055    | 0.24093    |   0.1 |  0.08
Modify  | 167.98     | 172.59     | 177.27     |  29.8 | 60.21
Other   |            | 55.21      |            |       | 19.26

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         336.25 ave         673 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1345
Ave neighs/atom = 0.53778489
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.47                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.1293201948733
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.57
  ghost atom cutoff = 3.57
  binsize = 1.785, bins = 3566 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 60.41 | 60.43 | 60.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036309944  -2.5386079e-35  0              0.010892983    694672.74      0              6.7086521e+10  1.1965779e-13  0              3.3262869    
    200000   6363.961       200            200           -0.00043346143  1.2988076e-39  0             -0.0013003843   154835.46      0              1.4952901e+10  1.1965779e-13  0              3.2621994    
    300000   6363.961       200            200            0.040500672   -0.01185352     0              0.13335553     3760.9341      0              3.632041e+08   1.1965779e-13  0              3.2199191    
    400000   6363.961       200            200            6.9225153e-05  3.5541204e-34  0              0.00020767546  992.57671      0              95855954       1.1965779e-13  0              3.240099     
    500000   6363.961       200            200            0.007275165   -0.0035784639   0              0.025403959    491.94465      0              47508493       1.1965779e-13  0              3.228449     
    600000   6363.961       200            200            0.0024672855  -0.0024966272   0              0.0098984836   129.14275      0              12471683       1.1965779e-13  0              3.2309021    
    700000   6363.961       200            200            0.0039788976  -0.0026754423   0              0.014612135    0.15314979     0              14790.111      1.1965779e-13  0              3.2300321    
    800000   6363.961       200            200            0.0032400455  -0.0026787241   0              0.012398861    2.7119961      0              261905.17      1.1965779e-13  0              3.2304285    
    900000   6363.961       200            200            0.0032898952  -0.0026525402   0              0.012522226    0.22618956     0              21843.769      1.1965779e-13  0              3.2304032    
   1000000   6363.961       200            200            0.0033725287  -0.0026668563   0              0.012784442    0.013306524    0              1285.0489      1.1965779e-13  0              3.2303554    
   1100000   6363.961       200            200            0.0033482176  -0.0026642912   0              0.012708944    0.0080915205   0              781.42113      1.1965779e-13  0              3.2303695    
   1200000   6363.961       200            200            0.0033422435  -0.0026636834   0              0.012690414    1.9767007e-05  0              1.908956       1.1965779e-13  0              3.2303728    
   1300000   6363.961       200            200            0.0033468432  -0.0026641698   0              0.012704699    0.0001240525   0              11.980102      1.1965779e-13  0              3.2303701    
   1400000   6363.961       200            200            0.0033466275  -0.0026641439   0              0.012704026    9.443414e-06   0              0.91197733     1.1965779e-13  0              3.2303703    
   1500000   6363.961       200            200            0.0033460552  -0.0026640842   0              0.01270225     6.7065671e-07  0              0.064767224    1.1965779e-13  0              3.2303706    
   1600000   6363.961       200            200            0.0033462114  -0.0026641009   0              0.012702735    3.553641e-07   0              0.034318521    1.1965779e-13  0              3.2303705    
   1700000   6363.961       200            200            0.0033462538  -0.0026641052   0              0.012702867    4.8372216e-10  0              4.6714424e-05  1.1965779e-13  0              3.2303705    
   1800000   6363.961       200            200            0.0033462234  -0.002664102    0              0.012702772    5.6965503e-09  0              0.00055013206  1.1965779e-13  0              3.2303705    
   1900000   6363.961       200            200            0.0033462244  -0.0026641022   0              0.012702775    3.8915794e-10  0              3.7582089e-05  1.1965779e-13  0              3.2303705    
   2000000   6363.961       200            200            0.0033462283  -0.0026641026   0              0.012702787    3.3565625e-11  0              3.2415278e-06  1.1965779e-13  0              3.2303705    
   2100000   6363.961       200            200            0.0033462273  -0.0026641025   0              0.012702784    1.5567694e-11  0              1.5034165e-06  1.1965779e-13  0              3.2303705    
   2200000   6363.961       200            200            0.003346227   -0.0026641024   0              0.012702783    9.0282044e-15  0              8.7187936e-10  1.1965779e-13  0              3.2303705    
   2300000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    2.608472e-13   0              2.5190755e-08  1.1965779e-13  0              3.2303705    
   2400000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    1.5834123e-14  0              1.5291462e-09  1.1965779e-13  0              3.2303705    
   2500000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    1.7174377e-15  0              1.6585784e-10  1.1965779e-13  0              3.2303705    
   2600000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    6.6540116e-16  0              6.4259682e-11  1.1965779e-13  0              3.2303705    
   2700000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    3.5896253e-18  0              3.4666032e-13  1.1965779e-13  0              3.2303705    
   2800000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    6.978496e-18   0              6.739332e-13   1.1965779e-13  0              3.2303705    
   2900000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    6.4122281e-19  0              6.1924709e-14  1.1965779e-13  0              3.2303705    
   3000000   6363.961       200            200            0.0033462272  -0.0026641024   0              0.012702784    3.5413919e-18  0              3.4200228e-13  1.1965779e-13  0              3.2303705    
Loop time of 286.118 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9059198.407 ns/day, 0.000 hours/ns, 10485.183 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.082     | 37.619     | 64.767     | 431.3 | 13.15
Neigh   | 2.1924     | 2.2108     | 2.2288     |   0.9 |  0.77
Comm    | 13.317     | 19.173     | 24.293     | 112.7 |  6.70
Output  | 0.24025    | 0.24058    | 0.24094    |   0.1 |  0.08
Modify  | 168.32     | 171.98     | 175.55     |  24.3 | 60.11
Other   |            | 54.89      |            |       | 19.19

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         339.75 ave         680 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1359
Ave neighs/atom = 0.54338265
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.48                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.5466241255151
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.58
  ghost atom cutoff = 3.58
  binsize = 1.79, bins = 3556 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 59.49 | 59.5 | 59.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036403921  -1.5866556e-36  0              0.010921176    697112.82      0              6.7322167e+10  1.1965779e-13  0              3.3259718    
    200000   6363.961       200            200           -0.00043514893 -5.0772799e-35  0             -0.0013054468   150622.78      0              1.454607e+10   1.1965779e-13  0              3.2706571    
    300000   6363.961       200            200            0.042369712   -0.012777105    0              0.13988624     116.97843      0              11296940       1.1965779e-13  0              3.2245554    
    400000   6363.961       200            200            8.2009557e-05  3.1733163e-35  0              0.00024602867  1370.6637      0              1.3236889e+08  1.1965779e-13  0              3.2447183    
    500000   6363.961       200            200            0.0078165101  -0.0038448751   0              0.027294405    233.21805      0              22522530       1.1965779e-13  0              3.2332114    
    600000   6363.961       200            200            0.0022966267  -0.0022654706   0              0.0091553506   88.758534      0              8571663.9      1.1965779e-13  0              3.2360669    
    700000   6363.961       200            200            0.0039763434  -0.0026685707   0              0.014597601    0.94997923     0              91742.194      1.1965779e-13  0              3.2350405    
    800000   6363.961       200            200            0.0033147129  -0.0026731542   0              0.012617293    3.3115714      0              319807.86      1.1965779e-13  0              3.2353952    
    900000   6363.961       200            200            0.0032840299  -0.0026411673   0              0.012493257    0.080243202    0              7749.3141      1.1965779e-13  0              3.2354156    
   1000000   6363.961       200            200            0.0033744121  -0.0026584114   0              0.012781648    0.035997283    0              3476.36        1.1965779e-13  0              3.2353628    
   1100000   6363.961       200            200            0.0033616135  -0.0026570404   0              0.012741881    0.005669967    0              547.56483      1.1965779e-13  0              3.2353703    
   1200000   6363.961       200            200            0.003351563   -0.0026560115   0              0.012710701    0.00011921993  0              11.513408      1.1965779e-13  0              3.235376     
   1300000   6363.961       200            200            0.0033552417  -0.0026564      0              0.012722125    0.00015057726  0              14.541674      1.1965779e-13  0              3.2353739    
   1400000   6363.961       200            200            0.0033558816  -0.0026564635   0              0.012724108    8.3387199e-07  0              0.080529388    1.1965779e-13  0              3.2353735    
   1500000   6363.961       200            200            0.0033552612  -0.0026563989   0              0.012722183    2.1806034e-06  0              0.21058707     1.1965779e-13  0              3.2353739    
   1600000   6363.961       200            200            0.0033552956  -0.0026564029   0              0.01272229     1.682092e-07   0              0.016244441    1.1965779e-13  0              3.2353738    
   1700000   6363.961       200            200            0.0033553725  -0.0026564108   0              0.012722528    1.4242577e-08  0              0.0013754461   1.1965779e-13  0              3.2353738    
   1800000   6363.961       200            200            0.003355353   -0.0026564087   0              0.012722468    6.1599696e-09  0              0.00059488577  1.1965779e-13  0              3.2353738    
   1900000   6363.961       200            200            0.0033553464  -0.0026564081   0              0.012722447    6.9174195e-13  0              6.6803486e-08  1.1965779e-13  0              3.2353738    
   2000000   6363.961       200            200            0.0033553503  -0.0026564085   0              0.012722459    1.1539174e-10  0              1.1143708e-05  1.1965779e-13  0              3.2353738    
   2100000   6363.961       200            200            0.0033553504  -0.0026564085   0              0.01272246     3.9045917e-12  0              3.7707752e-07  1.1965779e-13  0              3.2353738    
   2200000   6363.961       200            200            0.0033553499  -0.0026564084   0              0.012722458    1.1318364e-12  0              1.0930466e-07  1.1965779e-13  0              3.2353738    
   2300000   6363.961       200            200            0.00335535    -0.0026564084   0              0.012722458    2.2411278e-13  0              2.1643208e-08  1.1965779e-13  0              3.2353738    
   2400000   6363.961       200            200            0.00335535    -0.0026564085   0              0.012722459    2.7445626e-15  0              2.6505021e-10  1.1965779e-13  0              3.2353738    
   2500000   6363.961       200            200            0.00335535    -0.0026564084   0              0.012722458    5.4404137e-15  0              5.2539622e-10  1.1965779e-13  0              3.2353738    
   2600000   6363.961       200            200            0.00335535    -0.0026564084   0              0.012722458    5.7299829e-17  0              5.5336074e-12  1.1965779e-13  0              3.2353738    
   2700000   6363.961       200            200            0.00335535    -0.0026564085   0              0.012722458    8.4509647e-17  0              8.1613368e-12  1.1965779e-13  0              3.2353738    
   2800000   6363.961       200            200            0.00335535    -0.0026564085   0              0.012722458    7.4212431e-23  0              7.1669054e-18  1.1965779e-13  0              3.2353738    
   2900000   6363.961       200            200            0.00335535    -0.0026564085   0              0.012722458    2.1720256e-19  0              2.0975869e-14  1.1965779e-13  0              3.2353738    
   3000000   6363.961       200            200            0.00335535    -0.0026564084   0              0.012722458    3.4628589e-18  0              3.3441813e-13  1.1965779e-13  0              3.2353738    
Loop time of 286.663 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9041980.028 ns/day, 0.000 hours/ns, 10465.255 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.034     | 37.613     | 64.775     | 431.5 | 13.12
Neigh   | 2.1139     | 2.1328     | 2.1507     |   0.9 |  0.74
Comm    | 13.015     | 19.017     | 24.157     | 113.1 |  6.63
Output  | 0.24391    | 0.24425    | 0.2446     |   0.1 |  0.09
Modify  | 168.18     | 172.41     | 177.43     |  28.3 | 60.14
Other   |            | 55.24      |            |       | 19.27

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         341.75 ave         684 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1367
Ave neighs/atom = 0.54658137
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.49                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.9663332594927
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.59
  ghost atom cutoff = 3.59
  binsize = 1.795, bins = 3546 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 59.35 | 59.37 | 59.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036497897   8.3910692e-43  0              0.010949369    699556.15      0              6.7558126e+10  1.1965779e-13  0              3.3256444    
    200000   6363.961       200            200           -0.00043661432  5.0773154e-35  0             -0.001309843    146472.03      0              1.414522e+10   1.1965779e-13  0              3.2790706    
    300000   6363.961       200            200            0.041419465   -0.012811486    0              0.13706988     1637.8654      0              1.5817331e+08  1.1965779e-13  0              3.2297174    
    400000   6363.961       200            200            9.4965856e-05 -2.5386231e-35  0              0.00028489757  1808.9383      0              1.7469431e+08  1.1965779e-13  0              3.2492751    
    500000   6363.961       200            200            0.0081499469  -0.0040379208   0              0.028487762    57.546851      0              5557463        1.1965779e-13  0              3.2380675    
    600000   6363.961       200            200            0.0021260024  -0.0022128916   0              0.0085908988   49.966816      0              4825437.5      1.1965779e-13  0              3.2411985    
    700000   6363.961       200            200            0.0039283066  -0.0026567286   0              0.014441648    5.1267608      0              495105.86      1.1965779e-13  0              3.2400733    
    800000   6363.961       200            200            0.0033935195  -0.0026667493   0              0.012847308    3.3214755      0              320764.33      1.1965779e-13  0              3.2403601    
    900000   6363.961       200            200            0.0032862591  -0.0026326305   0              0.012491408    0.003385523    0              326.94958      1.1965779e-13  0              3.2404231    
   1000000   6363.961       200            200            0.0033737899  -0.0026487742   0              0.012770144    0.055635158    0              5372.8454      1.1965779e-13  0              3.2403717    
   1100000   6363.961       200            200            0.0033741999  -0.0026487534   0              0.012771353    0.0022374544   0              216.07733      1.1965779e-13  0              3.2403718    
   1200000   6363.961       200            200            0.0033619903  -0.0026475074   0              0.012733478    0.00057151498  0              55.192826      1.1965779e-13  0              3.2403787    
   1300000   6363.961       200            200            0.0033639722  -0.0026477193   0              0.012739636    0.00010723598  0              10.356083      1.1965779e-13  0              3.2403776    
   1400000   6363.961       200            200            0.0033652876  -0.0026478526   0              0.012743715    2.2455664e-06  0              0.21686073     1.1965779e-13  0              3.2403768    
   1500000   6363.961       200            200            0.0033648014  -0.0026478019   0              0.012742206    2.707803e-06   0              0.26150023     1.1965779e-13  0              3.2403771    
   1600000   6363.961       200            200            0.003364705   -0.0026477924   0              0.012741907    5.1870068e-09  0              0.00050092399  1.1965779e-13  0              3.2403772    
   1700000   6363.961       200            200            0.0033647866  -0.0026478008   0              0.012742161    4.4029487e-08  0              0.0042520527   1.1965779e-13  0              3.2403771    
   1800000   6363.961       200            200            0.003364786   -0.0026478007   0              0.012742159    1.9937208e-09  0              0.00019253928  1.1965779e-13  0              3.2403771    
   1900000   6363.961       200            200            0.0033647751  -0.0026477995   0              0.012742125    4.347432e-10   0              4.1984386e-05  1.1965779e-13  0              3.2403771    
   2000000   6363.961       200            200            0.003364777   -0.0026477997   0              0.012742131    9.008235e-11   0              8.6995086e-06  1.1965779e-13  0              3.2403771    
   2100000   6363.961       200            200            0.0033647782  -0.0026477999   0              0.012742134    1.5125126e-12  0              1.4606764e-07  1.1965779e-13  0              3.2403771    
   2200000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    2.2028387e-12  0              2.127344e-07   1.1965779e-13  0              3.2403771    
   2300000   6363.961       200            200            0.0033647776  -0.0026477998   0              0.012742133    6.6688866e-15  0              6.4403333e-10  1.1965779e-13  0              3.2403771    
   2400000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    3.4663638e-14  0              3.347566e-09   1.1965779e-13  0              3.2403771    
   2500000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    1.8360477e-15  0              1.7731234e-10  1.1965779e-13  0              3.2403771    
   2600000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    3.1754233e-16  0              3.0665966e-11  1.1965779e-13  0              3.2403771    
   2700000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    5.274576e-17   0              5.093808e-12   1.1965779e-13  0              3.2403771    
   2800000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    1.1220142e-17  0              1.083561e-12   1.1965779e-13  0              3.2403771    
   2900000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    6.8910953e-19  0              6.6549266e-14  1.1965779e-13  0              3.2403771    
   3000000   6363.961       200            200            0.0033647777  -0.0026477998   0              0.012742133    4.0468816e-18  0              3.9081886e-13  1.1965779e-13  0              3.2403771    
Loop time of 286.114 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9059331.790 ns/day, 0.000 hours/ns, 10485.338 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.122     | 37.821     | 65.171     | 433.4 | 13.22
Neigh   | 2.1102     | 2.1286     | 2.1462     |   0.9 |  0.74
Comm    | 13.192     | 18.968     | 24.05      | 112.5 |  6.63
Output  | 0.23943    | 0.23974    | 0.24008    |   0.1 |  0.08
Modify  | 168.46     | 172.02     | 175.32     |  23.0 | 60.12
Other   |            | 54.94      |            |       | 19.20

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         344.25 ave         689 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1377
Ave neighs/atom = 0.55057977
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.5                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.3884545083096
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.6
  ghost atom cutoff = 3.6
  binsize = 1.8, bins = 3536 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 59.23 | 59.24 | 59.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.003659187    2.8706445e-40  0              0.010977561    702002.72      0              6.7794398e+10  1.1965779e-13  0              3.3253047    
    200000   6363.961       200            200           -0.00043785856 -1.5231875e-34  0             -0.0013135757   142383.01      0              1.3750332e+10  1.1965779e-13  0              3.2874399    
    300000   6363.961       200            200            0.037867015   -0.011710092    0              0.12531114     7875.8009      0              7.6058848e+08  1.1965779e-13  0              3.2353949    
    400000   6363.961       200            200            0.00010809283  4.4508858e-40  0              0.00032427848  2307.1403      0              2.228071e+08   1.1965779e-13  0              3.2537694    
    500000   6363.961       200            200            0.008256228   -0.004098971    0              0.028867655    0.24149735     0              23322.086      1.1965779e-13  0              3.2430251    
    600000   6363.961       200            200            0.0020315208  -0.0021218832   0              0.0082164456   19.533455      0              1886401.2      1.1965779e-13  0              3.2462914    
    700000   6363.961       200            200            0.0038401338  -0.0026389889   0              0.01415939     11.431565      0              1103978.7      1.1965779e-13  0              3.2451281    
    800000   6363.961       200            200            0.0034696093  -0.0026603262   0              0.013069154    2.7357641      0              264200.51      1.1965779e-13  0              3.2453266    
    900000   6363.961       200            200            0.0032983176  -0.002624154    0              0.012519107    0.029926327    0              2890.0705      1.1965779e-13  0              3.245425     
   1000000   6363.961       200            200            0.0033717365  -0.0026393525   0              0.012754562    0.061118917    0              5902.4275      1.1965779e-13  0              3.2453814    
   1100000   6363.961       200            200            0.0033849946  -0.0026406449   0              0.012795629    0.00012155958  0              11.739354      1.1965779e-13  0              3.2453743    
   1200000   6363.961       200            200            0.0033728909  -0.0026394087   0              0.012758081    0.0010112923   0              97.663374      1.1965779e-13  0              3.2453811    
   1300000   6363.961       200            200            0.0033727866  -0.0026394064   0              0.012757766    3.4720559e-05  0              3.3530631      1.1965779e-13  0              3.2453811    
   1400000   6363.961       200            200            0.0033744317  -0.0026395742   0              0.012762869    1.2044646e-05  0              1.1631857      1.1965779e-13  0              3.2453802    
   1500000   6363.961       200            200            0.0033742179  -0.0026395513   0              0.012762205    1.6263263e-06  0              0.15705896     1.1965779e-13  0              3.2453803    
   1600000   6363.961       200            200            0.0033740257  -0.0026395319   0              0.012761609    8.4750249e-08  0              0.0081845725   1.1965779e-13  0              3.2453804    
   1700000   6363.961       200            200            0.0033740812  -0.0026395376   0              0.012761781    4.5050693e-08  0              0.0043506735   1.1965779e-13  0              3.2453804    
   1800000   6363.961       200            200            0.0033740994  -0.0026395395   0              0.012761838    9.6663544e-11  0              9.3350732e-06  1.1965779e-13  0              3.2453804    
   1900000   6363.961       200            200            0.0033740894  -0.0026395384   0              0.012761807    8.9850627e-10  0              8.6771305e-05  1.1965779e-13  0              3.2453804    
   2000000   6363.961       200            200            0.0033740883  -0.0026395383   0              0.012761803    7.9984612e-12  0              7.7243413e-07  1.1965779e-13  0              3.2453804    
   2100000   6363.961       200            200            0.0033740898  -0.0026395385   0              0.012761808    1.3313024e-11  0              1.2856766e-06  1.1965779e-13  0              3.2453804    
   2200000   6363.961       200            200            0.0033740898  -0.0026395385   0              0.012761808    7.8657454e-13  0              7.5961739e-08  1.1965779e-13  0              3.2453804    
   2300000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    1.3591153e-13  0              1.3125363e-08  1.1965779e-13  0              3.2453804    
   2400000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    2.9288164e-14  0              2.8284413e-09  1.1965779e-13  0              3.2453804    
   2500000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    6.714791e-16   0              6.4846645e-11  1.1965779e-13  0              3.2453804    
   2600000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    7.0489466e-16  0              6.8073681e-11  1.1965779e-13  0              3.2453804    
   2700000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    4.0796734e-18  0              3.9398565e-13  1.1965779e-13  0              3.2453804    
   2800000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    5.0826132e-18  0              4.9084241e-13  1.1965779e-13  0              3.2453804    
   2900000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    1.4324806e-18  0              1.3833872e-13  1.1965779e-13  0              3.2453804    
   3000000   6363.961       200            200            0.0033740896  -0.0026395385   0              0.012761807    2.7316862e-18  0              2.638067e-13   1.1965779e-13  0              3.2453804    
Loop time of 285.111 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9091188.409 ns/day, 0.000 hours/ns, 10522.209 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.957     | 38.065     | 65.795     | 436.6 | 13.35
Neigh   | 2.1073     | 2.1271     | 2.1462     |   0.9 |  0.75
Comm    | 13.286     | 18.199     | 22.315     |  90.1 |  6.38
Output  | 0.24       | 0.24032    | 0.24066    |   0.1 |  0.08
Modify  | 166.88     | 171.54     | 176.06     |  30.7 | 60.17
Other   |            | 54.94      |            |       | 19.27

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.75 ave         694 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1387
Ave neighs/atom = 0.55457817
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.51                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.8129947834697
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.61
  ghost atom cutoff = 3.61
  binsize = 1.805, bins = 3526 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 58.3 | 58.32 | 58.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036685841   5.0773057e-35  0              0.011005752    704452.53      0              6.8030983e+10  1.1965779e-13  0              3.3249526    
    200000   6363.961       200            200           -0.0004388826   1.5231994e-34  0             -0.0013166478   138355.59      0              1.3361392e+10  1.1965779e-13  0              3.2957649    
    300000   6363.961       200            200            0.03203446    -0.010398627    0              0.10650201     17083.967      0              1.6498473e+09  1.1965779e-13  0              3.2415408    
    400000   6363.961       200            200            0.00012138892 -3.0463689e-34  0              0.00036416675  2864.9993      0              2.7668112e+08  1.1965779e-13  0              3.2582011    
    500000   6363.961       200            200            0.0081027663  -0.0040860234   0              0.028394322    72.858568      0              7036159        1.1965779e-13  0              3.2480869    
    600000   6363.961       200            200            0.0019784271  -0.0021016859   0              0.0080369671   2.533497       0              244667.01      1.1965779e-13  0              3.2513417    
    700000   6363.961       200            200            0.0037240105  -0.0026046907   0              0.013776722    18.011181      0              1739391        1.1965779e-13  0              3.250201     
    800000   6363.961       200            200            0.0035372243  -0.0026516411   0              0.013263314    1.7679858      0              170739.41      1.1965779e-13  0              3.2502983    
    900000   6363.961       200            200            0.0033190675  -0.0026181901   0              0.012575393    0.14674434     0              14171.518      1.1965779e-13  0              3.2504217    
   1000000   6363.961       200            200            0.0033695362  -0.0026314772   0              0.012740086    0.049457901    0              4776.2901      1.1965779e-13  0              3.2503909    
   1100000   6363.961       200            200            0.0033933502  -0.0026338585   0              0.012813909    0.00073183325  0              70.675217      1.1965779e-13  0              3.2503777    
   1200000   6363.961       200            200            0.0033835374  -0.0026328533   0              0.012783465    0.0010881618   0              105.08687      1.1965779e-13  0              3.2503834    
   1300000   6363.961       200            200            0.0033814159  -0.0026326449   0              0.012776893    3.1258604e-12  0              3.0187322e-07  1.1965779e-13  0              3.2503845    
   1400000   6363.961       200            200            0.0033829724  -0.0026328042   0              0.012781721    1.9771401e-05  0              1.9093804      1.1965779e-13  0              3.2503836    
   1500000   6363.961       200            200            0.0033830864  -0.0026328147   0              0.012782074    2.4190258e-07  0              0.023361219    1.1965779e-13  0              3.2503836    
   1600000   6363.961       200            200            0.0033828639  -0.0026327921   0              0.012781384    2.9705215e-07  0              0.02868717     1.1965779e-13  0              3.2503837    
   1700000   6363.961       200            200            0.0033828732  -0.0026327932   0              0.012781413    1.6016739e-08  0              0.001546782    1.1965779e-13  0              3.2503837    
   1800000   6363.961       200            200            0.0033829021  -0.0026327961   0              0.012781503    3.5377574e-09  0              0.00034165129  1.1965779e-13  0              3.2503837    
   1900000   6363.961       200            200            0.0033828977  -0.0026327956   0              0.012781489    5.5867626e-10  0              5.3952955e-05  1.1965779e-13  0              3.2503837    
   2000000   6363.961       200            200            0.0033828943  -0.0026327953   0              0.012781478    2.9209948e-11  0              2.8208877e-06  1.1965779e-13  0              3.2503837    
   2100000   6363.961       200            200            0.0033828953  -0.0026327954   0              0.012781481    1.4320322e-11  0              1.3829542e-06  1.1965779e-13  0              3.2503837    
   2200000   6363.961       200            200            0.0033828956  -0.0026327954   0              0.012781482    9.6299367e-14  0              9.2999036e-09  1.1965779e-13  0              3.2503837    
   2300000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    2.9611556e-13  0              2.8596722e-08  1.1965779e-13  0              3.2503837    
   2400000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    3.2102629e-16  0              3.1002421e-11  1.1965779e-13  0              3.2503837    
   2500000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    5.1147643e-15  0              4.9394733e-10  1.1965779e-13  0              3.2503837    
   2600000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    9.7200846e-17  0              9.386962e-12   1.1965779e-13  0              3.2503837    
   2700000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    8.583644e-17   0              8.289469e-12   1.1965779e-13  0              3.2503837    
   2800000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    4.951059e-19   0              4.7813784e-14  1.1965779e-13  0              3.2503837    
   2900000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    7.7454963e-18  0              7.480046e-13   1.1965779e-13  0              3.2503837    
   3000000   6363.961       200            200            0.0033828954  -0.0026327954   0              0.012781482    5.3778535e-20  0              5.193546e-15   1.1965779e-13  0              3.2503837    
Loop time of 287.072 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9029102.036 ns/day, 0.000 hours/ns, 10450.350 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.923     | 38.288     | 65.973     | 439.5 | 13.34
Neigh   | 2.1274     | 2.1456     | 2.1635     |   0.9 |  0.75
Comm    | 13.276     | 18.276     | 22.705     |  90.7 |  6.37
Output  | 0.24409    | 0.2444     | 0.24474    |   0.1 |  0.09
Modify  | 167.73     | 172.68     | 178.03     |  33.1 | 60.15
Other   |            | 55.44      |            |       | 19.31

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         349.25 ave         699 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1397
Ave neighs/atom = 0.55857657
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.52                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.2399609964769
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.62
  ghost atom cutoff = 3.62
  binsize = 1.81, bins = 3517 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 58.23 | 58.24 | 58.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036779808  -5.3311648e-34  0              0.011033942    706905.58      0              6.8267881e+10  1.1965779e-13  0              3.3245882    
    200000   6363.961       200            200           -0.0004396874  -2.5386237e-35  0             -0.0013190622   134389.6       0              1.2978386e+10  1.1965779e-13  0              3.3040455    
    300000   6363.961       200            200            0.023894582   -0.01191515     0              0.083598895    26914.162      0              2.5991771e+09  1.1965779e-13  0              3.2480786    
    400000   6363.961       200            200            0.00013485272 -5.0772914e-35  0              0.00040455817  3482.2502      0              3.362908e+08   1.1965779e-13  0              3.2625701    
    500000   6363.961       200            200            0.0076963674  -0.0040184882   0              0.02710759     259.92689      0              25101878       1.1965779e-13  0              3.2532499    
    600000   6363.961       200            200            0.0019853188  -0.002097305    0              0.0080532613   1.6808271      0              162322.25      1.1965779e-13  0              3.2563476    
    700000   6363.961       200            200            0.0035788817  -0.0025905497   0              0.013327195    22.978389      0              2219088.3      1.1965779e-13  0              3.2552869    
    800000   6363.961       200            200            0.0035898763  -0.0026429284   0              0.013412557    0.77412928     0              74759.864      1.1965779e-13  0              3.2552782    
    900000   6363.961       200            200            0.0033476932  -0.0026129473   0              0.012656027    0.29972357     0              28945.157      1.1965779e-13  0              3.255414     
   1000000   6363.961       200            200            0.0033693589  -0.002623608    0              0.012731685    0.027313533    0              2637.7455      1.1965779e-13  0              3.2553994    
   1100000   6363.961       200            200            0.0033999214  -0.0026266994   0              0.012826464    0.003624731    0              350.05058      1.1965779e-13  0              3.2553823    
   1200000   6363.961       200            200            0.0033941119  -0.0026260958   0              0.012808431    0.00074377269  0              71.828243      1.1965779e-13  0              3.2553856    
   1300000   6363.961       200            200            0.0033904706  -0.0026257324   0              0.012797144    3.4367041e-05  0              3.3189229      1.1965779e-13  0              3.2553877    
   1400000   6363.961       200            200            0.003391554   -0.0026258443   0              0.012800506    1.7304488e-05  0              1.6711436      1.1965779e-13  0              3.255387     
   1500000   6363.961       200            200            0.0033919555  -0.0026258841   0              0.01280175     1.9978803e-07  0              0.019294098    1.1965779e-13  0              3.2553868    
   1600000   6363.961       200            200            0.0033917763  -0.0026258657   0              0.012801195    3.5719268e-07  0              0.034495112    1.1965779e-13  0              3.2553869    
   1700000   6363.961       200            200            0.0033917369  -0.0026258619   0              0.012801073    1.1941135e-10  0              1.1531893e-05  1.1965779e-13  0              3.2553869    
   1800000   6363.961       200            200            0.0033917643  -0.0026258647   0              0.012801158    6.6370313e-09  0              0.00064095697  1.1965779e-13  0              3.2553869    
   1900000   6363.961       200            200            0.0033917674  -0.002625865    0              0.012801167    2.7571679e-11  0              2.6626754e-06  1.1965779e-13  0              3.2553869    
   2000000   6363.961       200            200            0.0033917634  -0.0026258646   0              0.012801155    1.1127824e-10  0              1.0746456e-05  1.1965779e-13  0              3.2553869    
   2100000   6363.961       200            200            0.0033917634  -0.0026258646   0              0.012801155    2.4909436e-12  0              2.4055751e-07  1.1965779e-13  0              3.2553869    
   2200000   6363.961       200            200            0.0033917639  -0.0026258646   0              0.012801156    1.6680923e-12  0              1.6109241e-07  1.1965779e-13  0              3.2553869    
   2300000   6363.961       200            200            0.0033917639  -0.0026258646   0              0.012801156    1.0224446e-13  0              9.8740381e-09  1.1965779e-13  0              3.2553869    
   2400000   6363.961       200            200            0.0033917638  -0.0026258646   0              0.012801156    2.1976054e-14  0              2.12229e-09    1.1965779e-13  0              3.2553869    
   2500000   6363.961       200            200            0.0033917638  -0.0026258646   0              0.012801156    3.0562683e-15  0              2.9515252e-10  1.1965779e-13  0              3.2553869    
   2600000   6363.961       200            200            0.0033917638  -0.0026258646   0              0.012801156    2.3156951e-16  0              2.2363326e-11  1.1965779e-13  0              3.2553869    
   2700000   6363.961       200            200            0.0033917638  -0.0026258646   0              0.012801156    5.5551207e-17  0              5.364738e-12   1.1965779e-13  0              3.2553869    
   2800000   6363.961       200            200            0.0033917638  -0.0026258646   0              0.012801156    1.1112691e-17  0              1.0731842e-12  1.1965779e-13  0              3.2553869    
   2900000   6363.961       200            200            0.0033917638  -0.0026258646   0              0.012801156    1.6605578e-18  0              1.6036479e-13  1.1965779e-13  0              3.2553869    
   3000000   6363.961       200            200            0.0033917638  -0.0026258646   0              0.012801156    3.359622e-18   0              3.2444824e-13  1.1965779e-13  0              3.2553869    
Loop time of 286.262 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9054642.526 ns/day, 0.000 hours/ns, 10479.910 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.972     | 38.33      | 66.259     | 438.7 | 13.39
Neigh   | 2.1557     | 2.1758     | 2.195      |   0.9 |  0.76
Comm    | 13.396     | 18.478     | 22.677     |  91.0 |  6.45
Output  | 0.24183    | 0.24216    | 0.24251    |   0.1 |  0.08
Modify  | 167.51     | 171.95     | 177.06     |  29.6 | 60.07
Other   |            | 55.08      |            |       | 19.24

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         351.75 ave         704 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1407
Ave neighs/atom = 0.56257497
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.53                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.6693600588351
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.63
  ghost atom cutoff = 3.63
  binsize = 1.815, bins = 3507 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 58.08 | 58.08 | 58.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036873772  -3.1733074e-36  0              0.011062132    709361.86      0              6.8505091e+10  1.1965779e-13  0              3.3242115    
    200000   6363.961       200            200           -0.0004402739  -1.523188e-34   0             -0.0013208217   130484.88      0              1.2601295e+10  1.1965779e-13  0              3.3122817    
    300000   6363.961       200            200            0.015560191   -0.013095246    0              0.059775821    35264.64       0              3.4056066e+09  1.1965779e-13  0              3.2549141    
    400000   6363.961       200            200            0.0001484829   5.0773314e-35  0              0.00044544871  4158.6324      0              4.0161095e+08  1.1965779e-13  0              3.2668763    
    500000   6363.961       200            200            0.007076681   -0.0038956392   0              0.025125682    522.88628      0              50496614       1.1965779e-13  0              3.2585058    
    600000   6363.961       200            200            0.0020542282  -0.0021030418   0              0.0082657264   17.024242      0              1644079.4      1.1965779e-13  0              3.261309     
    700000   6363.961       200            200            0.0034160931  -0.0025983677   0              0.012846647    24.955991      0              2410071        1.1965779e-13  0              3.2603797    
    800000   6363.961       200            200            0.0036229241  -0.0026350763   0              0.013503849    0.12065966     0              11652.446      1.1965779e-13  0              3.2602684    
    900000   6363.961       200            200            0.0033819138  -0.0026082049   0              0.012753946    0.41861372     0              40426.717      1.1965779e-13  0              3.2604031    
   1000000   6363.961       200            200            0.0033725448  -0.0026157679   0              0.012733402    0.0071193673   0              687.53754      1.1965779e-13  0              3.2604059    
   1100000   6363.961       200            200            0.0034051663  -0.0026190708   0              0.01283457     0.0068308841   0              659.67789      1.1965779e-13  0              3.2603876    
   1200000   6363.961       200            200            0.0034043044  -0.0026189636   0              0.012831877    0.00025284697  0              24.418151      1.1965779e-13  0              3.2603882    
   1300000   6363.961       200            200            0.0033999482  -0.0026185298   0              0.012818374    0.0001055147   0              10.189854      1.1965779e-13  0              3.2603906    
   1400000   6363.961       200            200            0.0034003024  -0.0026185681   0              0.012819475    7.3080828e-06  0              0.70576233     1.1965779e-13  0              3.2603904    
   1500000   6363.961       200            200            0.0034008702  -0.0026186246   0              0.012821235    1.5309686e-06  0              0.14784999     1.1965779e-13  0              3.2603901    
   1600000   6363.961       200            200            0.0034007915  -0.0026186163   0              0.012820991    1.8653543e-07  0              0.018014257    1.1965779e-13  0              3.2603902    
   1700000   6363.961       200            200            0.0034007193  -0.0026186092   0              0.012820767    2.0518212e-08  0              0.0019815021   1.1965779e-13  0              3.2603902    
   1800000   6363.961       200            200            0.0034007338  -0.0026186107   0              0.012820812    4.3602654e-09  0              0.00042108322  1.1965779e-13  0              3.2603902    
   1900000   6363.961       200            200            0.0034007428  -0.0026186116   0              0.01282084     2.4674628e-10  0              2.382899e-05   1.1965779e-13  0              3.2603902    
   2000000   6363.961       200            200            0.0034007403  -0.0026186113   0              0.012820832    9.5217833e-11  0              9.1954568e-06  1.1965779e-13  0              3.2603902    
   2100000   6363.961       200            200            0.0034007392  -0.0026186112   0              0.012820829    2.5121762e-12  0              2.42608e-07    1.1965779e-13  0              3.2603902    
   2200000   6363.961       200            200            0.0034007396  -0.0026186113   0              0.01282083     1.9651441e-12  0              1.8977955e-07  1.1965779e-13  0              3.2603902    
   2300000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     1.8790921e-14  0              1.8146926e-09  1.1965779e-13  0              3.2603902    
   2400000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     3.865888e-14   0              3.7333979e-09  1.1965779e-13  0              3.2603902    
   2500000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     5.0781003e-17  0              4.9040658e-12  1.1965779e-13  0              3.2603902    
   2600000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     7.2206138e-16  0              6.9731519e-11  1.1965779e-13  0              3.2603902    
   2700000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     3.7135728e-18  0              3.5863028e-13  1.1965779e-13  0              3.2603902    
   2800000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     3.5478001e-18  0              3.4262114e-13  1.1965779e-13  0              3.2603902    
   2900000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     5.5545796e-19  0              5.3642154e-14  1.1965779e-13  0              3.2603902    
   3000000   6363.961       200            200            0.0034007397  -0.0026186113   0              0.01282083     4.2330668e-18  0              4.0879929e-13  1.1965779e-13  0              3.2603902    
Loop time of 284.859 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9099225.421 ns/day, 0.000 hours/ns, 10531.511 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.931     | 37.293     | 64.184     | 428.4 | 13.09
Neigh   | 2.1064     | 2.1274     | 2.1473     |   1.0 |  0.75
Comm    | 13.305     | 18.18      | 22.286     |  88.8 |  6.38
Output  | 0.24548    | 0.24579    | 0.24612    |   0.1 |  0.09
Modify  | 166.01     | 171.78     | 177.46     |  39.4 | 60.30
Other   |            | 55.23      |            |       | 19.39

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.25 ave         659 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1317
Ave neighs/atom = 0.52658936
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.54                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.1011988820483
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.64
  ghost atom cutoff = 3.64
  binsize = 1.82, bins = 3497 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 57.2 | 57.2 | 57.21 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0036967732   7.6824479e-41  0              0.01109032     711821.37      0              6.8742613e+10  1.1965779e-13  0              3.3238223    
    200000   6363.961       200            200           -0.00044064305  5.0773824e-35  0             -0.0013219291   126641.25      0              1.2230106e+10  1.1965779e-13  0              3.3204734    
    300000   6363.961       200            200            0.0085774482  -0.012134326    0              0.03786667     40855.46       0              3.9455279e+09  1.1965779e-13  0              3.2619486    
    400000   6363.961       200            200            0.00016227798  2.5386888e-35  0              0.00048683395  4893.8798      0              4.7261588e+08  1.1965779e-13  0              3.2711197    
    500000   6363.961       200            200            0.0062747778  -0.0038039173   0              0.022628251    810.08764      0              78232466       1.1965779e-13  0              3.263842     
    600000   6363.961       200            200            0.0021872671  -0.0021125319   0              0.0086743333   45.947971      0              4437326.2      1.1965779e-13  0              3.2662277    
    700000   6363.961       200            200            0.0032584643  -0.0025969172   0              0.01237231     23.445286      0              2264177.9      1.1965779e-13  0              3.2654731    
    800000   6363.961       200            200            0.0036339769  -0.0026279539   0              0.013529885    0.047027001    0              4541.5311      1.1965779e-13  0              3.2652701    
    900000   6363.961       200            200            0.0034181392  -0.0026056068   0              0.012860024    0.44904641     0              43365.688      1.1965779e-13  0              3.2653907    
   1000000   6363.961       200            200            0.0033795818  -0.0026090493   0              0.012747795    7.0924043e-05  0              6.8493364      1.1965779e-13  0              3.2654102    
   1100000   6363.961       200            200            0.0034093938  -0.0026120945   0              0.012840276    0.0081968341   0              791.59156      1.1965779e-13  0              3.2653934    
   1200000   6363.961       200            200            0.0034135129  -0.0026124849   0              0.012853024    1.6355995e-06  0              0.15795449     1.1965779e-13  0              3.2653912    
   1300000   6363.961       200            200            0.0034093766  -0.0026120704   0              0.0128402      0.00014811946  0              14.304318      1.1965779e-13  0              3.2653935    
   1400000   6363.961       200            200            0.0034089322  -0.0026120288   0              0.012838825    2.4608961e-07  0              0.023765573    1.1965779e-13  0              3.2653937    
   1500000   6363.961       200            200            0.0034095014  -0.0026120859   0              0.01284059     2.6484734e-06  0              0.2557706      1.1965779e-13  0              3.2653934    
   1600000   6363.961       200            200            0.0034095462  -0.00261209     0              0.012840729    1.2135404e-08  0              0.0011719504   1.1965779e-13  0              3.2653934    
   1700000   6363.961       200            200            0.0034094683  -0.0026120822   0              0.012840487    4.6849786e-08  0              0.004524417    1.1965779e-13  0              3.2653934    
   1800000   6363.961       200            200            0.0034094643  -0.0026120818   0              0.012840475    4.2467286e-10  0              4.1011865e-05  1.1965779e-13  0              3.2653934    
   1900000   6363.961       200            200            0.0034094749  -0.0026120829   0              0.012840508    8.1966727e-10  0              7.9157598e-05  1.1965779e-13  0              3.2653934    
   2000000   6363.961       200            200            0.0034094752  -0.0026120829   0              0.012840508    1.2527251e-11  0              1.2097922e-06  1.1965779e-13  0              3.2653934    
   2100000   6363.961       200            200            0.0034094738  -0.0026120827   0              0.012840504    1.4177946e-11  0              1.3692045e-06  1.1965779e-13  0              3.2653934    
   2200000   6363.961       200            200            0.0034094738  -0.0026120827   0              0.012840504    3.331225e-13   0              3.2170587e-08  1.1965779e-13  0              3.2653934    
   2300000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    2.4284647e-13  0              2.3452374e-08  1.1965779e-13  0              3.2653934    
   2400000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    8.4014415e-15  0              8.1135109e-10  1.1965779e-13  0              3.2653934    
   2500000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    4.0894877e-15  0              3.9493345e-10  1.1965779e-13  0              3.2653934    
   2600000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    1.8285559e-16  0              1.7658884e-11  1.1965779e-13  0              3.2653934    
   2700000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    8.441957e-17   0              8.1526379e-12  1.1965779e-13  0              3.2653934    
   2800000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    9.1880381e-19  0              8.8731496e-14  1.1965779e-13  0              3.2653934    
   2900000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    5.9218795e-18  0              5.7189273e-13  1.1965779e-13  0              3.2653934    
   3000000   6363.961       200            200            0.0034094739  -0.0026120828   0              0.012840505    5.5137189e-19  0              5.324755e-14   1.1965779e-13  0              3.2653934    
Loop time of 284.554 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9108990.040 ns/day, 0.000 hours/ns, 10542.813 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.913     | 37.433     | 64.494     | 430.3 | 13.15
Neigh   | 1.9982     | 2.0185     | 2.0377     |   1.0 |  0.71
Comm    | 13.177     | 18.049     | 22.179     |  89.7 |  6.34
Output  | 0.24012    | 0.24045    | 0.24081    |   0.1 |  0.08
Modify  | 165.92     | 171.46     | 176.44     |  37.2 | 60.25
Other   |            | 55.36      |            |       | 19.45

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.25 ave         663 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1325
Ave neighs/atom = 0.52978808
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.55                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.5354843776197
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.65
  ghost atom cutoff = 3.65
  binsize = 1.825, bins = 3488 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 57.05 | 57.05 | 57.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037061687  -3.8079723e-35  0              0.011118506    714284.11      0              6.8980447e+10  1.1965779e-13  0              3.3234208    
    200000   6363.961       200            200           -0.0004407958  -1.6247345e-33  0             -0.0013223874   122858.56      0              1.18648e+10    1.1965779e-13  0              3.3286205    
    300000   6363.961       200            200            0.004344232   -0.0070404402   0              0.020073136    43407.728      0              4.1920077e+09  1.1965779e-13  0              3.2690911    
    400000   6363.961       200            200            0.00017623668  1.2693304e-35  0              0.00052871003  5687.7371      0              5.4928094e+08  1.1965779e-13  0              3.2753002    
    500000   6363.961       200            200            0.0052524873  -0.0040602371   0              0.019817699    1069.246       0              1.0326012e+08  1.1965779e-13  0              3.2692423    
    600000   6363.961       200            200            0.0023742491  -0.0021523016   0              0.0092750488   83.475039      0              8061421.8      1.1965779e-13  0              3.2711073    
    700000   6363.961       200            200            0.0031044926  -0.0026253997   0              0.011938877    18.927639      0              1827895.9      1.1965779e-13  0              3.2705605    
    800000   6363.961       200            200            0.0036231819  -0.0026204259   0              0.013489971    0.57580786     0              55607.401      1.1965779e-13  0              3.2702835    
    900000   6363.961       200            200            0.0034523969  -0.002606905    0              0.012964096    0.3772516      0              36432.259      1.1965779e-13  0              3.2703787    
   1000000   6363.961       200            200            0.0033906467  -0.0026036466   0              0.012775587    0.0099328539   0              959.24393      1.1965779e-13  0              3.270412     
   1100000   6363.961       200            200            0.003413349   -0.0026059857   0              0.012846033    0.0068232343   0              658.93913      1.1965779e-13  0              3.2703991    
   1200000   6363.961       200            200            0.0034215947  -0.0026067921   0              0.012871576    0.00018348023  0              17.719207      1.1965779e-13  0              3.2703946    
   1300000   6363.961       200            200            0.0034185383  -0.002606483    0              0.012862098    0.00012366863  0              11.943031      1.1965779e-13  0              3.2703963    
   1400000   6363.961       200            200            0.0034174236  -0.002606374    0              0.012858645    3.3831187e-06  0              0.32671739     1.1965779e-13  0              3.2703969    
   1500000   6363.961       200            200            0.0034178341  -0.0026064157   0              0.012859918    2.2403642e-06  0              0.21635834     1.1965779e-13  0              3.2703967    
   1600000   6363.961       200            200            0.0034179849  -0.0026064304   0              0.012860385    6.2393573e-08  0              0.0060255247   1.1965779e-13  0              3.2703966    
   1700000   6363.961       200            200            0.0034179298  -0.0026064248   0              0.012860214    4.0587816e-08  0              0.0039196808   1.1965779e-13  0              3.2703966    
   1800000   6363.961       200            200            0.0034179094  -0.0026064228   0              0.012860151    1.1504696e-09  0              0.00011110412  1.1965779e-13  0              3.2703967    
   1900000   6363.961       200            200            0.0034179168  -0.0026064236   0              0.012860174    7.3528802e-10  0              7.1008854e-05  1.1965779e-13  0              3.2703967    
   2000000   6363.961       200            200            0.0034179195  -0.0026064238   0              0.012860182    2.1209977e-11  0              2.0483078e-06  1.1965779e-13  0              3.2703966    
   2100000   6363.961       200            200            0.0034179185  -0.0026064237   0              0.012860179    1.3319472e-11  0              1.2862993e-06  1.1965779e-13  0              3.2703966    
   2200000   6363.961       200            200            0.0034179182  -0.0026064237   0              0.012860178    3.9132536e-13  0              3.7791403e-08  1.1965779e-13  0              3.2703966    
   2300000   6363.961       200            200            0.0034179183  -0.0026064237   0              0.012860179    2.4134869e-13  0              2.3307729e-08  1.1965779e-13  0              3.2703966    
   2400000   6363.961       200            200            0.0034179184  -0.0026064237   0              0.012860179    7.2632437e-15  0              7.0143209e-10  1.1965779e-13  0              3.2703966    
   2500000   6363.961       200            200            0.0034179183  -0.0026064237   0              0.012860179    4.3369197e-15  0              4.1882867e-10  1.1965779e-13  0              3.2703966    
   2600000   6363.961       200            200            0.0034179183  -0.0026064237   0              0.012860179    1.439223e-16   0              1.3898986e-11  1.1965779e-13  0              3.2703966    
   2700000   6363.961       200            200            0.0034179183  -0.0026064237   0              0.012860179    5.512907e-17   0              5.323971e-12   1.1965779e-13  0              3.2703966    
   2800000   6363.961       200            200            0.0034179183  -0.0026064237   0              0.012860179    1.2258744e-17  0              1.1838617e-12  1.1965779e-13  0              3.2703966    
   2900000   6363.961       200            200            0.0034179183  -0.0026064237   0              0.012860179    1.0127965e-19  0              9.7808633e-15  1.1965779e-13  0              3.2703966    
   3000000   6363.961       200            200            0.0034179183  -0.0026064237   0              0.012860179    2.6425833e-18  0              2.5520178e-13  1.1965779e-13  0              3.2703966    
Loop time of 283.077 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9156526.889 ns/day, 0.000 hours/ns, 10597.832 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.883     | 37.559     | 64.571     | 431.9 | 13.27
Neigh   | 1.9642     | 1.9842     | 2.0033     |   1.0 |  0.70
Comm    | 12.882     | 17.83      | 22.143     |  90.1 |  6.30
Output  | 0.24069    | 0.24104    | 0.24139    |   0.1 |  0.09
Modify  | 165.51     | 170.67     | 175.87     |  33.9 | 60.29
Other   |            | 54.79      |            |       | 19.36

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         334.25 ave         669 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1337
Ave neighs/atom = 0.53458617
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.56                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.9722234570539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.66
  ghost atom cutoff = 3.66
  binsize = 1.83, bins = 3478 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 56.91 | 56.93 | 56.95 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037155637   3.8079804e-35  0              0.011146691    716750.08      0              6.9218592e+10  1.1965779e-13  0              3.3230067    
    200000   6363.961       200            200           -0.0004407331   3.1733144e-36  0             -0.0013221993   119136.65      0              1.1505365e+10  1.1965779e-13  0              3.3367229    
    300000   6363.961       200            200            0.0016086621  -0.0026750823   0              0.0075010685   43422.34       0              4.1934188e+09  1.1965779e-13  0              3.2762671    
    400000   6363.961       200            200            0.00025878831 -3.0365086e-06  0              0.00077940144  6536.7116      0              6.3126881e+08  1.1965779e-13  0              3.2794178    
    500000   6363.961       200            200            0.0043499187  -0.0038471767   0              0.016896933    1258.2663      0              1.2151435e+08  1.1965779e-13  0              3.2746885    
    600000   6363.961       200            200            0.0026172701  -0.0022058741   0              0.010057684    122.92787      0              11871494       1.1965779e-13  0              3.2759533    
    700000   6363.961       200            200            0.0029809972  -0.0026329367   0              0.011575928    12.686978      0              1225217.5      1.1965779e-13  0              3.2756362    
    800000   6363.961       200            200            0.0035931189  -0.002610758    0              0.013390115    1.5054673      0              145387.26      1.1965779e-13  0              3.2753075    
    900000   6363.961       200            200            0.0034830069  -0.0026071192   0              0.01305614     0.23623947     0              22814.317      1.1965779e-13  0              3.2753688    
   1000000   6363.961       200            200            0.0034058007  -0.0025981843   0              0.012815587    0.031054823    0              2999.0526      1.1965779e-13  0              3.2754116    
   1100000   6363.961       200            200            0.0034182579  -0.0025994887   0              0.012854262    0.0036417455   0              351.69371      1.1965779e-13  0              3.2754044    
   1200000   6363.961       200            200            0.003429074   -0.0026005553   0              0.012887777    0.00065109339  0              62.877939      1.1965779e-13  0              3.2753984    
   1300000   6363.961       200            200            0.0034277063  -0.0026004129   0              0.012883532    5.4765325e-05  0              5.2888431      1.1965779e-13  0              3.2753992    
   1400000   6363.961       200            200            0.0034262085  -0.0026002655   0              0.012878891    1.3345981e-05  0              1.2888593      1.1965779e-13  0              3.2754       
   1500000   6363.961       200            200            0.0034263496  -0.0026002804   0              0.012879329    7.9551991e-07  0              0.076825619    1.1965779e-13  0              3.2754       
   1600000   6363.961       200            200            0.0034265555  -0.0026003008   0              0.012879967    2.6858196e-07  0              0.025937723    1.1965779e-13  0              3.2753998    
   1700000   6363.961       200            200            0.0034265425  -0.0026002993   0              0.012879927    1.107794e-08   0              0.0010698282   1.1965779e-13  0              3.2753999    
   1800000   6363.961       200            200            0.0034265143  -0.0026002965   0              0.01287984     5.314908e-09   0              0.00051327578  1.1965779e-13  0              3.2753999    
   1900000   6363.961       200            200            0.0034265153  -0.0026002967   0              0.012879843    1.4593969e-10  0              1.409381e-05   1.1965779e-13  0              3.2753999    
   2000000   6363.961       200            200            0.0034265191  -0.002600297    0              0.012879854    1.035636e-10   0              1.0001431e-05  1.1965779e-13  0              3.2753999    
   2100000   6363.961       200            200            0.0034265191  -0.002600297    0              0.012879854    1.78014e-12    0              1.7191318e-07  1.1965779e-13  0              3.2753999    
   2200000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    1.9899806e-12  0              1.9217808e-07  1.1965779e-13  0              3.2753999    
   2300000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    1.9219737e-14  0              1.8561046e-09  1.1965779e-13  0              3.2753999    
   2400000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    3.7831102e-14  0              3.653457e-09   1.1965779e-13  0              3.2753999    
   2500000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    1.7992975e-16  0              1.7376327e-11  1.1965779e-13  0              3.2753999    
   2600000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    7.0282846e-16  0              6.7874142e-11  1.1965779e-13  0              3.2753999    
   2700000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    1.4556767e-18  0              1.4057883e-13  1.1965779e-13  0              3.2753999    
   2800000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    3.1593821e-18  0              3.0511051e-13  1.1965779e-13  0              3.2753999    
   2900000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    1.4349637e-18  0              1.3857852e-13  1.1965779e-13  0              3.2753999    
   3000000   6363.961       200            200            0.0034265186  -0.002600297    0              0.012879853    1.2588112e-18  0              1.2156697e-13  1.1965779e-13  0              3.2753999    
Loop time of 286.286 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9053869.893 ns/day, 0.000 hours/ns, 10479.016 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.048     | 37.759     | 64.96      | 432.1 | 13.19
Neigh   | 1.937      | 1.9545     | 1.9717     |   0.9 |  0.68
Comm    | 13.336     | 17.921     | 22.007     |  86.6 |  6.26
Output  | 0.24238    | 0.24269    | 0.24303    |   0.1 |  0.08
Modify  | 166.02     | 171.87     | 177.77     |  39.3 | 60.04
Other   |            | 56.53      |            |       | 19.75

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         337.25 ave         675 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1349
Ave neighs/atom = 0.53938425
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.57                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.411423031854
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.67
  ghost atom cutoff = 3.67
  binsize = 1.835, bins = 3469 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 56.08 | 56.09 | 56.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037249581  -3.173311e-36   0              0.011174874    719219.27      0              6.9457049e+10  1.1965779e-13  0              3.3225802    
    200000   6363.961       200            200           -0.0004404559  -7.615894e-35   0             -0.0013213677   115475.35      0              1.1151783e+10  1.1965779e-13  0              3.3447806    
    300000   6363.961       200            200            4.4469052e-05 -0.00039422857  0              0.00052763573  41797.498      0              4.0365032e+09  1.1965779e-13  0              3.2834237    
    400000   6363.961       200            200            0.00063429036 -0.00013107899  0              0.0020339501   7392.5871      0              7.1392314e+08  1.1965779e-13  0              3.2834737    
    500000   6363.961       200            200            0.0035299863  -0.0034588532   0              0.014048812    1352.3712      0              1.3060233e+08  1.1965779e-13  0              3.2801616    
    600000   6363.961       200            200            0.0028936043  -0.0023246334   0              0.011005446    156.90276      0              15152546       1.1965779e-13  0              3.2807726    
    700000   6363.961       200            200            0.0028920525  -0.0026291925   0              0.01130535     6.4233552      0              620321.67      1.1965779e-13  0              3.2806954    
    800000   6363.961       200            200            0.0035471794  -0.0026007454   0              0.013242283    2.4881693      0              240289.58      1.1965779e-13  0              3.2803401    
    900000   6363.961       200            200            0.0035070096  -0.0026064715   0              0.0131275      0.090548672    0              8744.5426      1.1965779e-13  0              3.2803627    
   1000000   6363.961       200            200            0.0034235784  -0.0025941275   0              0.012864863    0.051609657    0              4984.0913      1.1965779e-13  0              3.2804096    
   1100000   6363.961       200            200            0.0034242298  -0.0025942484   0              0.012866938    0.00076888743  0              74.253645      1.1965779e-13  0              3.2804089    
   1200000   6363.961       200            200            0.0034356562  -0.002595383    0              0.012902352    0.0010368475   0              100.13131      1.1965779e-13  0              3.2804025    
   1300000   6363.961       200            200            0.0034362168  -0.0025954309   0              0.012904081    3.7005129e-06  0              0.35736905     1.1965779e-13  0              3.2804023    
   1400000   6363.961       200            200            0.0034347071  -0.0025952813   0              0.012899403    1.9793131e-05  0              1.9114789      1.1965779e-13  0              3.2804031    
   1500000   6363.961       200            200            0.0034345465  -0.0025952664   0              0.012898906    6.9888019e-11  0              6.7492846e-06  1.1965779e-13  0              3.2804032    
   1600000   6363.961       200            200            0.003434741   -0.0025952858   0              0.012899509    3.6023481e-07  0              0.0347889      1.1965779e-13  0              3.2804031    
   1700000   6363.961       200            200            0.0034347736  -0.0025952889   0              0.01289961     1.0709882e-09  0              0.00010342838  1.1965779e-13  0              3.2804031    
   1800000   6363.961       200            200            0.0034347492  -0.0025952864   0              0.012899534    6.2507686e-09  0              0.00060365449  1.1965779e-13  0              3.2804031    
   1900000   6363.961       200            200            0.0034347434  -0.0025952859   0              0.012899516    7.8679938e-11  0              7.5983452e-06  1.1965779e-13  0              3.2804031    
   2000000   6363.961       200            200            0.0034347464  -0.0025952862   0              0.012899525    1.0316924e-10  0              9.9633465e-06  1.1965779e-13  0              3.2804031    
   2100000   6363.961       200            200            0.0034347473  -0.0025952863   0              0.012899528    3.1269312e-12  0              3.0197664e-07  1.1965779e-13  0              3.2804031    
   2200000   6363.961       200            200            0.003434747   -0.0025952862   0              0.012899527    1.6118851e-12  0              1.5566432e-07  1.1965779e-13  0              3.2804031    
   2300000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    9.642416e-14   0              9.3119552e-09  1.1965779e-13  0              3.2804031    
   2400000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    2.3691324e-14  0              2.2879385e-09  1.1965779e-13  0              3.2804031    
   2500000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    2.503677e-15   0              2.417872e-10   1.1965779e-13  0              3.2804031    
   2600000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    3.1417948e-16  0              3.0341205e-11  1.1965779e-13  0              3.2804031    
   2700000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    8.0867372e-17  0              7.809592e-12   1.1965779e-13  0              3.2804031    
   2800000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    1.9235431e-18  0              1.8576203e-13  1.1965779e-13  0              3.2804031    
   2900000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    3.0461001e-18  0              2.9417054e-13  1.1965779e-13  0              3.2804031    
   3000000   6363.961       200            200            0.0034347469  -0.0025952862   0              0.012899527    8.5166554e-19  0              8.2247762e-14  1.1965779e-13  0              3.2804031    
Loop time of 284.662 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9105544.949 ns/day, 0.000 hours/ns, 10538.825 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.207     | 37.641     | 64.58      | 430.4 | 13.22
Neigh   | 1.9289     | 1.9491     | 1.9685     |   1.0 |  0.68
Comm    | 12.574     | 18.435     | 23.775     | 115.7 |  6.48
Output  | 0.24024    | 0.24058    | 0.24093    |   0.1 |  0.08
Modify  | 167.64     | 171.64     | 175.64     |  25.4 | 60.30
Other   |            | 54.76      |            |       | 19.24

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         340.25 ave         681 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1361
Ave neighs/atom = 0.54418233
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.58                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.8530900135247
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.68
  ghost atom cutoff = 3.68
  binsize = 1.84, bins = 3459 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 55.93 | 55.94 | 55.94 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037343519  -1.5866543e-36  0              0.011203056    721691.68      0              6.9695817e+10  1.1965779e-13  0              3.3221413    
    200000   6363.961       200            200           -0.00043996513 -1.0154562e-34  0             -0.0013198954   111874.49      0              1.0804038e+10  1.1965779e-13  0              3.3527936    
    300000   6363.961       200            200           -0.00032411605 -5.0772756e-35  0             -0.00097234815  39533.373      0              3.8178502e+09  1.1965779e-13  0              3.2905315    
    400000   6363.961       200            200            0.0013853555  -0.00041522874  0              0.0045712953   8153.3383      0              7.8739105e+08  1.1965779e-13  0              3.287474     
    500000   6363.961       200            200            0.0027470121  -0.00316272     0              0.011403756    1345.2934      0              1.299188e+08   1.1965779e-13  0              3.2856429    
    600000   6363.961       200            200            0.003239034   -0.0023704437   0              0.012087546    178.56972      0              17244985       1.1965779e-13  0              3.2855739    
    700000   6363.961       200            200            0.0028442616  -0.0026108039   0              0.011143589    1.7960889      0              173453.41      1.1965779e-13  0              3.2857343    
    800000   6363.961       200            200            0.0034928831  -0.0025843459   0              0.013062995    3.161256       0              305291.47      1.1965779e-13  0              3.2853785    
    900000   6363.961       200            200            0.0035223275  -0.0026049814   0              0.013171964    0.0065352856   0              631.1311       1.1965779e-13  0              3.2853613    
   1000000   6363.961       200            200            0.0034426006  -0.0025913599   0              0.012919162    0.06019094     0              5812.8102      1.1965779e-13  0              3.2854066    
   1100000   6363.961       200            200            0.0034316409  -0.002590329    0              0.012885252    9.1153133e-05  0              8.8029171      1.1965779e-13  0              3.2854124    
   1200000   6363.961       200            200            0.003441674   -0.0025913289   0              0.012916351    0.0010414724   0              100.57795      1.1965779e-13  0              3.2854067    
   1300000   6363.961       200            200            0.0034439968  -0.0025915508   0              0.012923541    1.5904071e-05  0              1.5359013      1.1965779e-13  0              3.2854055    
   1400000   6363.961       200            200            0.0034428376  -0.0025914353   0              0.012919948    1.6134225e-05  0              1.558128       1.1965779e-13  0              3.2854061    
   1500000   6363.961       200            200            0.0034424276  -0.0025913957   0              0.012918678    7.6331655e-07  0              0.073715649    1.1965779e-13  0              3.2854064    
   1600000   6363.961       200            200            0.0034425495  -0.002591408    0              0.012919057    2.1934474e-07  0              0.021182745    1.1965779e-13  0              3.2854063    
   1700000   6363.961       200            200            0.003442615   -0.0025914144   0              0.012919259    2.4638251e-08  0              0.002379386    1.1965779e-13  0              3.2854062    
   1800000   6363.961       200            200            0.003442604   -0.0025914132   0              0.012919225    2.4998079e-09  0              0.00024141356  1.1965779e-13  0              3.2854063    
   1900000   6363.961       200            200            0.0034425943  -0.0025914123   0              0.012919195    6.4226162e-10  0              6.202503e-05   1.1965779e-13  0              3.2854063    
   2000000   6363.961       200            200            0.003442595   -0.0025914124   0              0.012919197    2.1335846e-11  0              2.0604633e-06  1.1965779e-13  0              3.2854063    
   2100000   6363.961       200            200            0.0034425963  -0.0025914125   0              0.012919201    1.4465761e-11  0              1.3969996e-06  1.1965779e-13  0              3.2854063    
   2200000   6363.961       200            200            0.0034425963  -0.0025914125   0              0.012919202    9.2542554e-14  0              8.9370974e-09  1.1965779e-13  0              3.2854063    
   2300000   6363.961       200            200            0.0034425962  -0.0025914125   0              0.012919201    2.8962036e-13  0              2.7969461e-08  1.1965779e-13  0              3.2854063    
   2400000   6363.961       200            200            0.0034425961  -0.0025914125   0              0.012919201    9.2955957e-18  0              8.977021e-13   1.1965779e-13  0              3.2854063    
   2500000   6363.961       200            200            0.0034425962  -0.0025914125   0              0.012919201    5.2135331e-15  0              5.0348571e-10  1.1965779e-13  0              3.2854063    
   2600000   6363.961       200            200            0.0034425962  -0.0025914125   0              0.012919201    4.8274115e-17  0              4.6619685e-12  1.1965779e-13  0              3.2854063    
   2700000   6363.961       200            200            0.0034425962  -0.0025914125   0              0.012919201    6.1327907e-17  0              5.9226103e-12  1.1965779e-13  0              3.2854063    
   2800000   6363.961       200            200            0.0034425962  -0.0025914125   0              0.012919201    1.3036158e-17  0              1.2589389e-12  1.1965779e-13  0              3.2854063    
   2900000   6363.961       200            200            0.0034425962  -0.0025914125   0              0.012919201    2.0743659e-19  0              2.0032741e-14  1.1965779e-13  0              3.2854063    
   3000000   6363.961       200            200            0.0034425962  -0.0025914125   0              0.012919201    5.4700329e-18  0              5.2825662e-13  1.1965779e-13  0              3.2854063    
Loop time of 285.853 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9067604.736 ns/day, 0.000 hours/ns, 10494.913 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.994     | 37.727     | 64.873     | 432.0 | 13.20
Neigh   | 1.9188     | 1.9392     | 1.9588     |   1.0 |  0.68
Comm    | 12.942     | 17.94      | 22.241     |  90.9 |  6.28
Output  | 0.2398     | 0.24012    | 0.24047    |   0.1 |  0.08
Modify  | 168.25     | 173.25     | 178.55     |  33.5 | 60.61
Other   |            | 54.76      |            |       | 19.16

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.25 ave         685 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1369
Ave neighs/atom = 0.54738105
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.59                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.2972313135691
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.69
  ghost atom cutoff = 3.69
  binsize = 1.845, bins = 3450 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 55.8 | 55.81 | 55.83 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037437451   3.9666415e-37  0              0.011231235    724167.32      0              6.9934896e+10  1.1965779e-13  0              3.3216898    
    200000   6363.961       200            200           -0.00043926174 -5.0771216e-35  0             -0.0013177852   108333.93      0              1.0462115e+10  1.1965779e-13  0              3.3607616    
    300000   6363.961       200            200           -0.00031853176 -3.0463546e-34  0             -0.00095559527  37276.169      0              3.5998655e+09  1.1965779e-13  0              3.2975821    
    400000   6363.961       200            200            0.0025069897  -0.00099232809  0              0.0085132972   8685.7678      0              8.3880929e+08  1.1965779e-13  0              3.2914313    
    500000   6363.961       200            200            0.0020859507  -0.0028093702   0              0.0090672224   1247.1615      0              1.2044193e+08  1.1965779e-13  0              3.2911152    
    600000   6363.961       200            200            0.003613313   -0.0024255332   0              0.013265472    183.01668      0              17674441       1.1965779e-13  0              3.2903672    
    700000   6363.961       200            200            0.0028326276  -0.0026021371   0              0.01110002     0.0035850624   0              346.21966      1.1965779e-13  0              3.2907505    
    800000   6363.961       200            200            0.0034342903  -0.0025685764   0              0.012871447    3.2811691      0              316871.83      1.1965779e-13  0              3.2904194    
    900000   6363.961       200            200            0.0035278084  -0.0026031294   0              0.013186555    0.021924752    0              2117.3356      1.1965779e-13  0              3.2903652    
   1000000   6363.961       200            200            0.0034609207  -0.002590749    0              0.012973511    0.052100418    0              5031.4855      1.1965779e-13  0              3.2904035    
   1100000   6363.961       200            200            0.0034402232  -0.0025887499   0              0.012909419    0.0020281316   0              195.86243      1.1965779e-13  0              3.2904148    
   1200000   6363.961       200            200            0.0034471609  -0.002589453    0              0.012930936    0.0006640317   0              64.127428      1.1965779e-13  0              3.2904108    
   1300000   6363.961       200            200            0.0034507224  -0.0025898005   0              0.012941968    7.9671845e-05  0              7.6941365      1.1965779e-13  0              3.2904089    
   1400000   6363.961       200            200            0.0034501809  -0.0025897447   0              0.012940288    6.1796699e-06  0              0.59678828     1.1965779e-13  0              3.2904092    
   1500000   6363.961       200            200            0.0034496409  -0.0025896917   0              0.012938614    2.1855819e-06  0              0.21106785     1.1965779e-13  0              3.2904095    
   1600000   6363.961       200            200            0.0034496541  -0.0025896934   0              0.012938656    2.9386982e-08  0              0.0028379843   1.1965779e-13  0              3.2904095    
   1700000   6363.961       200            200            0.0034497284  -0.0025897007   0              0.012938886    4.7639074e-08  0              0.0046006408   1.1965779e-13  0              3.2904094    
   1800000   6363.961       200            200            0.0034497348  -0.0025897013   0              0.012938906    1.1130685e-12  0              1.0749219e-07  1.1965779e-13  0              3.2904094    
   1900000   6363.961       200            200            0.0034497255  -0.0025897004   0              0.012938877    8.588136e-10   0              8.293807e-05   1.1965779e-13  0              3.2904094    
   2000000   6363.961       200            200            0.0034497236  -0.0025897002   0              0.012938871    1.1468369e-11  0              1.107533e-06   1.1965779e-13  0              3.2904094    
   2100000   6363.961       200            200            0.0034497247  -0.0025897003   0              0.012938874    1.2787165e-11  0              1.2348928e-06  1.1965779e-13  0              3.2904094    
   2200000   6363.961       200            200            0.003449725   -0.0025897004   0              0.012938875    7.2651326e-13  0              7.016145e-08   1.1965779e-13  0              3.2904094    
   2300000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    1.5036156e-13  0              1.4520843e-08  1.1965779e-13  0              3.2904094    
   2400000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    2.4801395e-14  0              2.3951412e-09  1.1965779e-13  0              3.2904094    
   2500000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    1.196603e-15   0              1.1555935e-10  1.1965779e-13  0              3.2904094    
   2600000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    6.3594039e-16  0              6.1414571e-11  1.1965779e-13  0              3.2904094    
   2700000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    4.2515635e-19  0              4.1058557e-14  1.1965779e-13  0              3.2904094    
   2800000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    3.1084565e-18  0              3.0019248e-13  1.1965779e-13  0              3.2904094    
   2900000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    8.9024112e-19  0              8.5973116e-14  1.1965779e-13  0              3.2904094    
   3000000   6363.961       200            200            0.0034497249  -0.0025897003   0              0.012938875    4.7177888e-18  0              4.5561027e-13  1.1965779e-13  0              3.2904094    
Loop time of 286.873 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9035348.099 ns/day, 0.000 hours/ns, 10457.579 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.08      | 37.949     | 65.244     | 434.5 | 13.23
Neigh   | 1.9541     | 1.9727     | 1.9903     |   0.9 |  0.69
Comm    | 12.811     | 18.624     | 23.887     | 113.8 |  6.49
Output  | 0.241      | 0.24133    | 0.24168    |   0.1 |  0.08
Modify  | 169.04     | 172.91     | 176.42     |  24.5 | 60.27
Other   |            | 55.17      |            |       | 19.23

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         345.25 ave         691 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1381
Ave neighs/atom = 0.55217913
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.6                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.7438538434912
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.7
  ghost atom cutoff = 3.7
  binsize = 1.85, bins = 3440 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 55.68 | 55.69 | 55.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037531375  -1.2693191e-35  0              0.011259412    726646.17      0              7.0174286e+10  1.1965779e-13  0              3.3212257    
    200000   6363.961       200            200           -0.00043834668 -8.1236785e-34  0             -0.00131504     104853.48      0              1.0125999e+10  1.1965779e-13  0              3.3686848    
    300000   6363.961       200            200           -0.00031272151  2.5387047e-35  0             -0.00093816452  35087.828      0              3.3885312e+09  1.1965779e-13  0              3.3045752    
    400000   6363.961       200            200            0.0040103897  -0.0018754412   0              0.01390661     8845.8744      0              8.5427124e+08  1.1965779e-13  0              3.295365     
    500000   6363.961       200            200            0.0016521916  -0.0021368284   0              0.0070934031   1079.5268      0              1.0425297e+08  1.1965779e-13  0              3.2965629    
    600000   6363.961       200            200            0.0039749347  -0.0025527887   0              0.014477593    168.56399      0              16278704       1.1965779e-13  0              3.2951633    
    700000   6363.961       200            200            0.0028582872  -0.0026031538   0              0.011178016    1.4922698      0              144112.74      1.1965779e-13  0              3.2957432    
    800000   6363.961       200            200            0.0033731239  -0.0025681236   0              0.012687495    2.8096244      0              271333.42      1.1965779e-13  0              3.2954592    
    900000   6363.961       200            200            0.0035237663  -0.0026006108   0              0.01317191     0.12873971     0              12432.76       1.1965779e-13  0              3.2953743    
   1000000   6363.961       200            200            0.0034774827  -0.0025904816   0              0.01302293     0.031874864    0              3078.2462      1.1965779e-13  0              3.2954013    
   1100000   6363.961       200            200            0.0034502759  -0.0025878255   0              0.012938653    0.005278622    0              509.77153      1.1965779e-13  0              3.2954162    
   1200000   6363.961       200            200            0.0034530072  -0.0025881164   0              0.012947138    0.00019773288  0              19.095626      1.1965779e-13  0              3.2954146    
   1300000   6363.961       200            200            0.0034570483  -0.0025885169   0              0.012959662    0.00013757105  0              13.285628      1.1965779e-13  0              3.2954124    
   1400000   6363.961       200            200            0.0034572358  -0.0025885328   0              0.01296024     8.0493901e-08  0              0.0077735248   1.1965779e-13  0              3.2954123    
   1500000   6363.961       200            200            0.0034567168  -0.0025884811   0              0.012958631    2.6245775e-06  0              0.25346291     1.1965779e-13  0              3.2954126    
   1600000   6363.961       200            200            0.0034566201  -0.0025884719   0              0.012958332    3.4012853e-08  0              0.0032847179   1.1965779e-13  0              3.2954126    
   1700000   6363.961       200            200            0.0034566768  -0.0025884776   0              0.012958508    3.7262616e-08  0              0.0035985567   1.1965779e-13  0              3.2954126    
   1800000   6363.961       200            200            0.0034566977  -0.0025884796   0              0.012958573    2.6412164e-09  0              0.00025506977  1.1965779e-13  0              3.2954126    
   1900000   6363.961       200            200            0.0034566929  -0.0025884791   0              0.012958558    3.5938695e-10  0              3.4707019e-05  1.1965779e-13  0              3.2954126    
   2000000   6363.961       200            200            0.0034566894  -0.0025884788   0              0.012958547    9.0884504e-11  0              8.7769749e-06  1.1965779e-13  0              3.2954126    
   2100000   6363.961       200            200            0.0034566896  -0.0025884788   0              0.012958548    1.5509362e-12  0              1.4977832e-07  1.1965779e-13  0              3.2954126    
   2200000   6363.961       200            200            0.0034566901  -0.0025884788   0              0.012958549    2.1197991e-12  0              2.0471502e-07  1.1965779e-13  0              3.2954126    
   2300000   6363.961       200            200            0.0034566901  -0.0025884788   0              0.012958549    1.0725464e-15  0              1.0357885e-10  1.1965779e-13  0              3.2954126    
   2400000   6363.961       200            200            0.0034566901  -0.0025884788   0              0.012958549    3.6619295e-14  0              3.5364294e-09  1.1965779e-13  0              3.2954126    
   2500000   6363.961       200            200            0.00345669    -0.0025884788   0              0.012958549    9.4390864e-16  0              9.115594e-11   1.1965779e-13  0              3.2954126    
   2600000   6363.961       200            200            0.00345669    -0.0025884788   0              0.012958549    4.6150811e-16  0              4.456915e-11   1.1965779e-13  0              3.2954126    
   2700000   6363.961       200            200            0.00345669    -0.0025884788   0              0.012958549    7.2795986e-17  0              7.0301153e-12  1.1965779e-13  0              3.2954126    
   2800000   6363.961       200            200            0.00345669    -0.0025884788   0              0.012958549    2.4074996e-18  0              2.3249907e-13  1.1965779e-13  0              3.2954126    
   2900000   6363.961       200            200            0.00345669    -0.0025884788   0              0.012958549    6.801738e-18   0              6.5686317e-13  1.1965779e-13  0              3.2954126    
   3000000   6363.961       200            200            0.00345669    -0.0025884788   0              0.012958549    1.1114039e-18  0              1.0733143e-13  1.1965779e-13  0              3.2954126    
Loop time of 284.472 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9111608.411 ns/day, 0.000 hours/ns, 10545.843 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.932     | 38.109     | 65.708     | 436.7 | 13.40
Neigh   | 1.9497     | 1.9688     | 1.9873     |   1.0 |  0.69
Comm    | 13.081     | 17.993     | 22.157     |  88.8 |  6.33
Output  | 0.24098    | 0.24129    | 0.24163    |   0.1 |  0.08
Modify  | 166.64     | 171.26     | 176.11     |  30.7 | 60.20
Other   |            | 54.9       |            |       | 19.30

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         347.25 ave         695 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1389
Ave neighs/atom = 0.55537785
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.61                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.1929645147953
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.71
  ghost atom cutoff = 3.71
  binsize = 1.855, bins = 3431 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 54.84 | 54.84 | 54.85 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037625291   6.3466466e-36  0              0.011287587    729128.24      0              7.0413986e+10  1.1965779e-13  0              3.3207491    
    200000   6363.961       200            200           -0.00043722089  1.4763507e-40  0             -0.0013116627   101433.03      0              9.795676e+09   1.1965779e-13  0              3.3765629    
    300000   6363.961       200            200           -0.0003066867   2.0309324e-34  0             -0.00092006011  32968.14       0              3.183827e+09   1.1965779e-13  0              3.3115106    
    400000   6363.961       200            200            0.0059360384  -0.0028139081   0              0.020622023    8508.1894      0              8.2166003e+08  1.1965779e-13  0              3.299302     
    500000   6363.961       200            200            0.001280933   -0.001657749    0              0.005500548    869.79603      0              83998675       1.1965779e-13  0              3.3019731    
    600000   6363.961       200            200            0.0043155364  -0.0027078219   0              0.015654431    137.54064      0              13282690       1.1965779e-13  0              3.2999731    
    700000   6363.961       200            200            0.0029214847  -0.0026104592   0              0.011374913    5.8532039      0              565260.54      1.1965779e-13  0              3.3007133    
    800000   6363.961       200            200            0.0033197945  -0.0025703652   0              0.012529749    1.9225166      0              185662.89      1.1965779e-13  0              3.3004946    
    900000   6363.961       200            200            0.0035107813  -0.0025998435   0              0.013132187    0.27739106     0              26788.443      1.1965779e-13  0              3.3003878    
   1000000   6363.961       200            200            0.0034903051  -0.0025922293   0              0.013063144    0.010700927    0              1033.4189      1.1965779e-13  0              3.3004008    
   1100000   6363.961       200            200            0.0034606599  -0.0025893222   0              0.012971302    0.0076959077   0              743.21568      1.1965779e-13  0              3.3004171    
   1200000   6363.961       200            200            0.0034588317  -0.0025891595   0              0.012965655    1.9507714e-07  0              0.018839154    1.1965779e-13  0              3.300418     
   1300000   6363.961       200            200            0.0034625217  -0.002589529    0              0.012977094    0.00013815416  0              13.34194       1.1965779e-13  0              3.300416     
   1400000   6363.961       200            200            0.0034633737  -0.0025896114   0              0.012979732    3.9428151e-06  0              0.38076887     1.1965779e-13  0              3.3004155    
   1500000   6363.961       200            200            0.0034630157  -0.0025895752   0              0.012978622    1.585263e-06   0              0.15309335     1.1965779e-13  0              3.3004157    
   1600000   6363.961       200            200            0.0034628422  -0.0025895582   0              0.012978085    2.246567e-07   0              0.021695736    1.1965779e-13  0              3.3004158    
   1700000   6363.961       200            200            0.003462862   -0.0025895603   0              0.012978146    8.4736544e-09  0              0.00081832489  1.1965779e-13  0              3.3004158    
   1800000   6363.961       200            200            0.0034628887  -0.0025895629   0              0.012978229    6.2373728e-09  0              0.00060236082  1.1965779e-13  0              3.3004158    
   1900000   6363.961       200            200            0.0034628904  -0.002589563    0              0.012978234    2.8410409e-13  0              2.7436739e-08  1.1965779e-13  0              3.3004158    
   2000000   6363.961       200            200            0.0034628871  -0.0025895627   0              0.012978224    1.1148594e-10  0              1.0766514e-05  1.1965779e-13  0              3.3004158    
   2100000   6363.961       200            200            0.0034628863  -0.0025895626   0              0.012978222    3.2467057e-12  0              3.1354359e-07  1.1965779e-13  0              3.3004158    
   2200000   6363.961       200            200            0.0034628866  -0.0025895627   0              0.012978223    1.2727202e-12  0              1.2291021e-07  1.1965779e-13  0              3.3004158    
   2300000   6363.961       200            200            0.0034628868  -0.0025895627   0              0.012978223    1.8249471e-13  0              1.7624032e-08  1.1965779e-13  0              3.3004158    
   2400000   6363.961       200            200            0.0034628867  -0.0025895627   0              0.012978223    6.6440672e-15  0              6.4163645e-10  1.1965779e-13  0              3.3004158    
   2500000   6363.961       200            200            0.0034628867  -0.0025895627   0              0.012978223    5.0332721e-15  0              4.860774e-10   1.1965779e-13  0              3.3004158    
   2600000   6363.961       200            200            0.0034628867  -0.0025895627   0              0.012978223    5.6937838e-19  0              5.4986488e-14  1.1965779e-13  0              3.3004158    
   2700000   6363.961       200            200            0.0034628867  -0.0025895627   0              0.012978223    6.9938456e-17  0              6.7541555e-12  1.1965779e-13  0              3.3004158    
   2800000   6363.961       200            200            0.0034628867  -0.0025895627   0              0.012978223    1.3024253e-17  0              1.2577891e-12  1.1965779e-13  0              3.3004158    
   2900000   6363.961       200            200            0.0034628867  -0.0025895627   0              0.012978223    7.352522e-19   0              7.1005395e-14  1.1965779e-13  0              3.3004158    
   3000000   6363.961       200            200            0.0034628867  -0.0025895627   0              0.012978223    5.9806251e-18  0              5.7756597e-13  1.1965779e-13  0              3.3004158    
Loop time of 287.048 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9029835.359 ns/day, 0.000 hours/ns, 10451.198 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.081     | 38.243     | 65.894     | 437.5 | 13.32
Neigh   | 1.9194     | 1.9385     | 1.957      |   1.0 |  0.68
Comm    | 12.764     | 18.661     | 23.905     | 114.8 |  6.50
Output  | 0.23928    | 0.23961    | 0.23995    |   0.1 |  0.08
Modify  | 169.49     | 172.85     | 176.18     |  21.7 | 60.22
Other   |            | 55.11      |            |       | 19.20

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         350.25 ave         701 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1401
Ave neighs/atom = 0.56017593
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.62                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.6445702389847
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.72
  ghost atom cutoff = 3.72
  binsize = 1.86, bins = 3422 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 54.7 | 54.72 | 54.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.00377192    -1.9833204e-36  0              0.01131576     731613.52      0              7.0653997e+10  1.1965779e-13  0              3.3202599    
    200000   6363.961       200            200           -0.00043588531 -2.5386125e-35  0             -0.0013076559   98072.36       0              9.4711265e+09  1.1965779e-13  0              3.3843959    
    300000   6363.961       200            200           -0.00030042856  3.1047454e-40  0             -0.00090128569  30916.837      0              2.9857268e+09  1.1965779e-13  0              3.3183884    
    400000   6363.961       200            200            0.0082203478  -0.0037642176   0              0.028425261    7606.876       0              7.3461764e+08  1.1965779e-13  0              3.3032761    
    500000   6363.961       200            200            0.00099505205 -0.0012745275   0              0.0042596837   645.59314      0              62346765       1.1965779e-13  0              3.3073349    
    600000   6363.961       200            200            0.0046472873  -0.0027758992   0              0.016717761    96.190778      0              9289416.9      1.1965779e-13  0              3.3048077    
    700000   6363.961       200            200            0.0030226379  -0.0026139569   0              0.01168187     11.921714      0              1151313.8      1.1965779e-13  0              3.3056629    
    800000   6363.961       200            200            0.0032802774  -0.0025731405   0              0.012413973    0.94179112     0              90951.445      1.1965779e-13  0              3.3055226    
    900000   6363.961       200            200            0.0034925148  -0.0025969666   0              0.013074511    0.39979573     0              38609.41       1.1965779e-13  0              3.3054046    
   1000000   6363.961       200            200            0.0034996     -0.0025924119   0              0.013091212    0.00019147811  0              18.491585      1.1965779e-13  0              3.3054024    
   1100000   6363.961       200            200            0.0034718199  -0.0025896794   0              0.013005139    0.0077007321   0              743.68159      1.1965779e-13  0              3.3054177    
   1200000   6363.961       200            200            0.0034658685  -0.0025891051   0              0.012986711    0.00021893747  0              21.143414      1.1965779e-13  0              3.3054209    
   1300000   6363.961       200            200            0.0034684749  -0.0025893692   0              0.012994794    8.1309336e-05  0              7.8522737      1.1965779e-13  0              3.3054195    
   1400000   6363.961       200            200            0.0034697729  -0.0025894967   0              0.012998815    1.3746231e-05  0              1.3275126      1.1965779e-13  0              3.3054187    
   1500000   6363.961       200            200            0.003469668   -0.0025894854   0              0.012998489    2.6148973e-07  0              0.025252806    1.1965779e-13  0              3.3054188    
   1600000   6363.961       200            200            0.0034694731  -0.0025894661   0              0.012997885    3.5629068e-07  0              0.034408003    1.1965779e-13  0              3.3054189    
   1700000   6363.961       200            200            0.0034694503  -0.0025894639   0              0.012997815    1.9750139e-09  0              0.00019073271  1.1965779e-13  0              3.3054189    
   1800000   6363.961       200            200            0.0034694722  -0.0025894661   0              0.012997883    5.1870093e-09  0              0.00050092423  1.1965779e-13  0              3.3054189    
   1900000   6363.961       200            200            0.0034694794  -0.0025894668   0              0.012997905    3.8689155e-10  0              3.7363216e-05  1.1965779e-13  0              3.3054189    
   2000000   6363.961       200            200            0.0034694779  -0.0025894667   0              0.0129979      3.5670825e-11  0              3.444833e-06   1.1965779e-13  0              3.3054189    
   2100000   6363.961       200            200            0.0034694766  -0.0025894665   0              0.012997896    1.433297e-11   0              1.3841757e-06  1.1965779e-13  0              3.3054189    
   2200000   6363.961       200            200            0.0034694765  -0.0025894665   0              0.012997896    7.3827411e-15  0              7.1297229e-10  1.1965779e-13  0              3.3054189    
   2300000   6363.961       200            200            0.0034694767  -0.0025894666   0              0.012997897    2.7739895e-13  0              2.6789205e-08  1.1965779e-13  0              3.3054189    
   2400000   6363.961       200            200            0.0034694768  -0.0025894666   0              0.012997897    7.6921793e-15  0              7.4285562e-10  1.1965779e-13  0              3.3054189    
   2500000   6363.961       200            200            0.0034694767  -0.0025894666   0              0.012997897    2.9404245e-15  0              2.8396515e-10  1.1965779e-13  0              3.3054189    
   2600000   6363.961       200            200            0.0034694767  -0.0025894666   0              0.012997897    4.9975756e-16  0              4.8263008e-11  1.1965779e-13  0              3.3054189    
   2700000   6363.961       200            200            0.0034694767  -0.0025894666   0              0.012997897    7.9728994e-19  0              7.6996556e-14  1.1965779e-13  0              3.3054189    
   2800000   6363.961       200            200            0.0034694767  -0.0025894666   0              0.012997897    3.6239319e-18  0              3.4997341e-13  1.1965779e-13  0              3.3054189    
   2900000   6363.961       200            200            0.0034694767  -0.0025894666   0              0.012997897    1.4363734e-20  0              1.3871466e-15  1.1965779e-13  0              3.3054189    
   3000000   6363.961       200            200            0.0034694767  -0.0025894666   0              0.012997897    6.3734006e-18  0              6.1549741e-13  1.1965779e-13  0              3.3054189    
Loop time of 286.991 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9031645.525 ns/day, 0.000 hours/ns, 10453.293 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.881     | 38.388     | 66.531     | 440.3 | 13.38
Neigh   | 1.9626     | 1.9813     | 1.9999     |   0.9 |  0.69
Comm    | 13.08      | 18.163     | 22.271     |  91.2 |  6.33
Output  | 0.23978    | 0.2401     | 0.24044    |   0.1 |  0.08
Modify  | 168.81     | 173.18     | 177.84     |  29.4 | 60.34
Other   |            | 55.04      |            |       | 19.18

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         352.25 ave         705 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1409
Ave neighs/atom = 0.56337465
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.63                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.0986779275632
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.73
  ghost atom cutoff = 3.73
  binsize = 1.865, bins = 3413 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 54.64 | 54.65 | 54.65 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0037813099   1.2693348e-35  0              0.01134393     734102.01      0              7.0894317e+10  1.1965779e-13  0              3.3197581    
    200000   6363.961       200            200           -0.00043434088  1.5866573e-35  0             -0.0013030226   94771.352      0              9.1523388e+09  1.1965779e-13  0              3.3921838    
    300000   6363.961       200            200           -0.0002939485   2.5386886e-35  0             -0.0008818455   28933.708      0              2.7942104e+09  1.1965779e-13  0              3.3252084    
    400000   6363.961       200            200            0.010557913   -0.0051358013   0              0.03680954     6177.7725      0              5.9660505e+08  1.1965779e-13  0              3.3073266    
    500000   6363.961       200            200            0.00077584092 -0.0010130552   0              0.0033405779   431.61994      0              41682765       1.1965779e-13  0              3.3126401    
    600000   6363.961       200            200            0.0049278122  -0.0028092668   0              0.017592704    53.496999      0              5166357.2      1.1965779e-13  0              3.3096765    
    700000   6363.961       200            200            0.0031586634  -0.0026070905   0              0.012083081    18.064809      0              1744570        1.1965779e-13  0              3.3105956    
    800000   6363.961       200            200            0.0032587568  -0.0025756445   0              0.012351915    0.21798362     0              21051.297      1.1965779e-13  0              3.3105409    
    900000   6363.961       200            200            0.0034715284  -0.0025934725   0              0.013008058    0.44054887     0              42545.057      1.1965779e-13  0              3.310423     
   1000000   6363.961       200            200            0.0035046826  -0.0025918966   0              0.013105944    0.0059954351   0              578.9962       1.1965779e-13  0              3.3104063    
   1100000   6363.961       200            200            0.0034826754  -0.002589717    0              0.013037743    0.0053031133   0              512.13672      1.1965779e-13  0              3.3104186    
   1200000   6363.961       200            200            0.0034737252  -0.0025888427   0              0.013010018    0.00068220252  0              65.882236      1.1965779e-13  0              3.3104234    
   1300000   6363.961       200            200            0.003474757   -0.0025889517   0              0.013013223    1.7485807e-05  0              1.6886541      1.1965779e-13  0              3.3104228    
   1400000   6363.961       200            200            0.0034761859  -0.0025890933   0              0.013017651    1.9561433e-05  0              1.8891032      1.1965779e-13  0              3.310422     
   1500000   6363.961       200            200            0.003476355   -0.0025891091   0              0.013018174    1.5207591e-07  0              0.014686403    1.1965779e-13  0              3.3104219    
   1600000   6363.961       200            200            0.0034761988  -0.0025890935   0              0.01301769     2.6225446e-07  0              0.025326659    1.1965779e-13  0              3.310422     
   1700000   6363.961       200            200            0.0034761423  -0.002589088    0              0.013017515    2.6565877e-08  0              0.0025655423   1.1965779e-13  0              3.3104221    
   1800000   6363.961       200            200            0.0034761512  -0.0025890889   0              0.013017542    1.1483318e-09  0              0.00011089766  1.1965779e-13  0              3.3104221    
   1900000   6363.961       200            200            0.0034761607  -0.0025890898   0              0.013017572    8.571715e-10   0              8.2779488e-05  1.1965779e-13  0              3.310422     
   2000000   6363.961       200            200            0.0034761616  -0.0025890899   0              0.013017575    3.0459951e-12  0              2.941604e-07   1.1965779e-13  0              3.310422     
   2100000   6363.961       200            200            0.0034761605  -0.0025890898   0              0.013017571    1.2747956e-11  0              1.2311064e-06  1.1965779e-13  0              3.3104221    
   2200000   6363.961       200            200            0.0034761601  -0.0025890898   0              0.01301757     1.0108327e-12  0              9.761899e-08   1.1965779e-13  0              3.3104221    
   2300000   6363.961       200            200            0.0034761602  -0.0025890898   0              0.01301757     6.9690705e-14  0              6.7302294e-09  1.1965779e-13  0              3.3104221    
   2400000   6363.961       200            200            0.0034761603  -0.0025890898   0              0.013017571    3.7097193e-14  0              3.5825814e-09  1.1965779e-13  0              3.3104221    
   2500000   6363.961       200            200            0.0034761603  -0.0025890898   0              0.013017571    3.435725e-17   0              3.3179772e-12  1.1965779e-13  0              3.3104221    
   2600000   6363.961       200            200            0.0034761603  -0.0025890898   0              0.013017571    5.9796406e-16  0              5.7747089e-11  1.1965779e-13  0              3.3104221    
   2700000   6363.961       200            200            0.0034761603  -0.0025890898   0              0.013017571    5.9877882e-17  0              5.7825772e-12  1.1965779e-13  0              3.3104221    
   2800000   6363.961       200            200            0.0034761603  -0.0025890898   0              0.013017571    2.0056113e-18  0              1.9368758e-13  1.1965779e-13  0              3.3104221    
   2900000   6363.961       200            200            0.0034761603  -0.0025890898   0              0.013017571    3.042868e-18   0              2.9385841e-13  1.1965779e-13  0              3.3104221    
   3000000   6363.961       200            200            0.0034761603  -0.0025890898   0              0.013017571    8.1028325e-19  0              7.8251357e-14  1.1965779e-13  0              3.3104221    
Loop time of 284.292 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9117382.379 ns/day, 0.000 hours/ns, 10552.526 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.94      | 37.338     | 64.158     | 428.5 | 13.13
Neigh   | 1.9218     | 1.9411     | 1.9592     |   1.0 |  0.68
Comm    | 13.031     | 17.861     | 22.017     |  88.8 |  6.28
Output  | 0.24122    | 0.24158    | 0.24193    |   0.1 |  0.08
Modify  | 165.49     | 171.46     | 177.16     |  40.3 | 60.31
Other   |            | 55.45      |            |       | 19.50

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.52738904
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.64                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.5552944920351
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.74
  ghost atom cutoff = 3.74
  binsize = 1.87, bins = 3404 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 53.76 | 53.76 | 53.77 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0039078209  -7.5408754e-06  0              0.011731004    736586.64      0              7.1134265e+10  1.1965779e-13  0              3.3192436    
    200000   6363.961       200            200           -0.00043258855 -2.5385975e-35  0             -0.0012977656   91529.826      0              8.8392955e+09  1.1965779e-13  0              3.3999264    
    300000   6363.961       200            200           -0.00028724781  2.5386675e-35  0             -0.00086174342  27018.512      0              2.6092545e+09  1.1965779e-13  0              3.3319705    
    400000   6363.961       200            200            0.013061156   -0.0058935988   0              0.045077068    4392.0481      0              4.2415257e+08  1.1965779e-13  0              3.3114959    
    500000   6363.961       200            200            0.00062945267 -0.00080989047  0              0.0026982485   247.86075      0              23936617       1.1965779e-13  0              3.3178824    
    600000   6363.961       200            200            0.0051069511  -0.0028870488   0              0.018207902    19.208094      0              1854980.3      1.1965779e-13  0              3.3145878    
    700000   6363.961       200            200            0.0033182916  -0.0026021653   0              0.01255704     22.594398      0              2182005.2      1.1965779e-13  0              3.3155164    
    800000   6363.961       200            200            0.0032582577  -0.0025757776   0              0.012350551    0.0060617635   0              585.40173      1.1965779e-13  0              3.3155482    
    900000   6363.961       200            200            0.0034508469  -0.0025903784   0              0.012942919    0.38177545     0              36869.141      1.1965779e-13  0              3.3154412    
   1000000   6363.961       200            200            0.0035056399  -0.0025911566   0              0.013108076    0.024761416    0              2391.2803      1.1965779e-13  0              3.3154125    
   1100000   6363.961       200            200            0.003492365   -0.0025898171   0              0.013066912    0.0020757738   0              200.46338      1.1965779e-13  0              3.31542      
   1200000   6363.961       200            200            0.0034820138  -0.0025887999   0              0.013034841    0.001034393    0              99.894276      1.1965779e-13  0              3.3154256    
   1300000   6363.961       200            200            0.0034813103  -0.002588737    0              0.013032668    2.5877939e-06  0              0.24991061     1.1965779e-13  0              3.315426     
   1400000   6363.961       200            200            0.0034825353  -0.0025888595   0              0.013036465    1.5586106e-05  0              1.5051946      1.1965779e-13  0              3.3154253    
   1500000   6363.961       200            200            0.0034829254  -0.0025888974   0              0.013037674    1.3641177e-06  0              0.13173672     1.1965779e-13  0              3.3154251    
   1600000   6363.961       200            200            0.0034828542  -0.0025888901   0              0.013037453    6.2907576e-08  0              0.0060751634   1.1965779e-13  0              3.3154251    
   1700000   6363.961       200            200            0.0034827845  -0.0025888832   0              0.013037237    4.746351e-08   0              0.004583686    1.1965779e-13  0              3.3154252    
   1800000   6363.961       200            200            0.0034827773  -0.0025888825   0              0.013037214    3.4876639e-10  0              3.3681362e-05  1.1965779e-13  0              3.3154252    
   1900000   6363.961       200            200            0.003482785   -0.0025888833   0              0.013037238    6.1846703e-10  0              5.9727119e-05  1.1965779e-13  0              3.3154252    
   2000000   6363.961       200            200            0.0034827878  -0.0025888836   0              0.013037247    7.2404919e-11  0              6.9923488e-06  1.1965779e-13  0              3.3154252    
   2100000   6363.961       200            200            0.0034827874  -0.0025888835   0              0.013037246    1.6975166e-12  0              1.6393401e-07  1.1965779e-13  0              3.3154252    
   2200000   6363.961       200            200            0.003482787   -0.0025888835   0              0.013037244    2.1328894e-12  0              2.059792e-07   1.1965779e-13  0              3.3154252    
   2300000   6363.961       200            200            0.0034827869  -0.0025888835   0              0.013037244    3.0959226e-14  0              2.9898205e-09  1.1965779e-13  0              3.3154252    
   2400000   6363.961       200            200            0.0034827869  -0.0025888835   0              0.013037244    2.3644134e-14  0              2.2833812e-09  1.1965779e-13  0              3.3154252    
   2500000   6363.961       200            200            0.003482787   -0.0025888835   0              0.013037244    3.7099724e-15  0              3.5828258e-10  1.1965779e-13  0              3.3154252    
   2600000   6363.961       200            200            0.003482787   -0.0025888835   0              0.013037244    3.4105211e-17  0              3.2936372e-12  1.1965779e-13  0              3.3154252    
   2700000   6363.961       200            200            0.003482787   -0.0025888835   0              0.013037244    8.0579836e-17  0              7.7818237e-12  1.1965779e-13  0              3.3154252    
   2800000   6363.961       200            200            0.003482787   -0.0025888835   0              0.013037244    1.3004113e-17  0              1.2558442e-12  1.1965779e-13  0              3.3154252    
   2900000   6363.961       200            200            0.003482787   -0.0025888835   0              0.013037244    3.615638e-18   0              3.4917244e-13  1.1965779e-13  0              3.3154252    
   3000000   6363.961       200            200            0.003482787   -0.0025888835   0              0.013037244    2.0830153e-18  0              2.0116271e-13  1.1965779e-13  0              3.3154252    
Loop time of 283.443 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9144694.352 ns/day, 0.000 hours/ns, 10584.137 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.905     | 37.432     | 64.374     | 429.8 | 13.21
Neigh   | 1.8125     | 1.8316     | 1.8497     |   1.0 |  0.65
Comm    | 12.696     | 17.716     | 21.904     |  90.5 |  6.25
Output  | 0.24061    | 0.24092    | 0.24125    |   0.1 |  0.08
Modify  | 165.14     | 170.89     | 177.18     |  39.2 | 60.29
Other   |            | 55.33      |            |       | 19.52

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.75 ave         664 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1327
Ave neighs/atom = 0.53058776
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.65                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.0144268439039
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.75
  ghost atom cutoff = 3.75
  binsize = 1.875, bins = 3395 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 53.66 | 53.67 | 53.67 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.01087002    -0.0032320355   0              0.035842096    735136.75      0              7.0994245e+10  1.1965779e-13  0              3.3187207    
    200000   6363.961       200            200           -0.00043062924 -1.332791e-34   0             -0.0012918877   88347.632      0              8.5319819e+09  1.1965779e-13  0              3.4076237    
    300000   6363.961       200            200           -0.0002803278   8.8064668e-41  0             -0.0008409834   25171.016      0              2.4308366e+09  1.1965779e-13  0              3.3386746    
    400000   6363.961       200            200            0.015322703   -0.006430672    0              0.052398782    2546.7773      0              2.4594952e+08  1.1965779e-13  0              3.3158261    
    500000   6363.961       200            200            0.00054986992 -0.00064359329  0              0.002293203    109.03559      0              10529877       1.1965779e-13  0              3.3230572    
    600000   6363.961       200            200            0.0052057883  -0.0028944026   0              0.018511767    1.4066702      0              135846.14      1.1965779e-13  0              3.319547     
    700000   6363.961       200            200            0.0034903457  -0.0026029722   0              0.013074009    24.223114      0              2339294.9      1.1965779e-13  0              3.320431     
    800000   6363.961       200            200            0.003278706   -0.0025755893   0              0.012411707    0.37715479     0              36422.91       1.1965779e-13  0              3.3205442    
    900000   6363.961       200            200            0.0034348838  -0.0025842511   0              0.012888903    0.25057023     0              24198.279      1.1965779e-13  0              3.3204574    
   1000000   6363.961       200            200            0.0035034836  -0.0025896934   0              0.013100144    0.046079194    0              4449.9988      1.1965779e-13  0              3.3204204    
   1100000   6363.961       200            200            0.0035005599  -0.0025893574   0              0.013091037    0.00011382644  0              10.992543      1.1965779e-13  0              3.3204223    
   1200000   6363.961       200            200            0.0034905915  -0.0025883696   0              0.013060144    0.0010083549   0              97.379696      1.1965779e-13  0              3.3204278    
   1300000   6363.961       200            200            0.0034883421  -0.0025881521   0              0.013053179    4.9007648e-05  0              4.7328079      1.1965779e-13  0              3.320429     
   1400000   6363.961       200            200            0.003489087   -0.0025882281   0              0.013055489    5.8553323e-06  0              0.56546608     1.1965779e-13  0              3.3204285    
   1500000   6363.961       200            200            0.0034895883  -0.0025882776   0              0.013057042    2.5178685e-06  0              0.24315772     1.1965779e-13  0              3.3204283    
   1600000   6363.961       200            200            0.0034896211  -0.0025882805   0              0.013057144    9.1206778e-09  0              0.00088080978  1.1965779e-13  0              3.3204282    
   1700000   6363.961       200            200            0.0034895622  -0.0025882746   0              0.013056961    3.5537978e-08  0              0.0034320035   1.1965779e-13  0              3.3204283    
   1800000   6363.961       200            200            0.0034895422  -0.0025882726   0              0.013056899    3.9654341e-09  0              0.00038295324  1.1965779e-13  0              3.3204283    
   1900000   6363.961       200            200            0.0034895448  -0.0025882729   0              0.013056907    7.5281759e-11  0              7.2701734e-06  1.1965779e-13  0              3.3204283    
   2000000   6363.961       200            200            0.0034895482  -0.0025882732   0              0.013056918    1.1651807e-10  0              1.1252481e-05  1.1965779e-13  0              3.3204283    
   2100000   6363.961       200            200            0.0034895487  -0.0025882733   0              0.013056919    2.8858526e-12  0              2.7869499e-07  1.1965779e-13  0              3.3204283    
   2200000   6363.961       200            200            0.0034895484  -0.0025882733   0              0.013056919    1.0070277e-12  0              9.7251528e-08  1.1965779e-13  0              3.3204283    
   2300000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    2.4591414e-13  0              2.3748628e-08  1.1965779e-13  0              3.3204283    
   2400000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    5.3005664e-18  0              5.1189076e-13  1.1965779e-13  0              3.3204283    
   2500000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    4.6085758e-15  0              4.4506327e-10  1.1965779e-13  0              3.3204283    
   2600000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    3.1029049e-16  0              2.9965634e-11  1.1965779e-13  0              3.3204283    
   2700000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    3.3572303e-18  0              3.2421728e-13  1.1965779e-13  0              3.3204283    
   2800000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    2.706136e-18   0              2.6133925e-13  1.1965779e-13  0              3.3204283    
   2900000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    3.9737082e-21  0              3.837523e-16   1.1965779e-13  0              3.3204283    
   3000000   6363.961       200            200            0.0034895483  -0.0025882733   0              0.013056918    6.850496e-18   0              6.6157187e-13  1.1965779e-13  0              3.3204283    
Loop time of 284.164 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9121482.736 ns/day, 0.000 hours/ns, 10557.272 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.1       | 37.512     | 64.444     | 429.7 | 13.20
Neigh   | 1.8004     | 1.8171     | 1.8339     |   0.9 |  0.64
Comm    | 12.477     | 18.311     | 23.477     | 114.6 |  6.44
Output  | 0.24055    | 0.24088    | 0.24125    |   0.1 |  0.08
Modify  | 167.87     | 171.64     | 175.56     |  24.9 | 60.40
Other   |            | 54.64      |            |       | 19.23

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         335.25 ave         671 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1341
Ave neighs/atom = 0.53618553
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.66                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.4760818946735
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.76
  ghost atom cutoff = 3.76
  binsize = 1.88, bins = 3386 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 53.53 | 53.55 | 53.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.029775201   -0.0076181108   0              0.096943713    715688.33      0              6.9116057e+10  1.1965779e-13  0              3.3182291    
    200000   6363.961       200            200           -0.0004284639  -7.6158767e-35  0             -0.0012853917   85224.607      0              8.2303825e+09  1.1965779e-13  0              3.4152756    
    300000   6363.961       200            200           -0.00027318982  6.3466294e-36  0             -0.00081956947  23390.992      0              2.2589346e+09  1.1965779e-13  0              3.3453207    
    400000   6363.961       200            200            0.017052202   -0.0067546279   0              0.057911233    1010.271       0              97564742       1.1965779e-13  0              3.3203546    
    500000   6363.961       200            200            0.00051518456 -0.00054114839  0              0.0020867021   24.798048      0              2394818        1.1965779e-13  0              3.3281616    
    600000   6363.961       200            200            0.0051947781  -0.0028925258   0              0.01847686     4.32433        0              417612.83      1.1965779e-13  0              3.3245568    
    700000   6363.961       200            200            0.0036729515  -0.0025802775   0              0.013599132    22.44664       0              2167735.8      1.1965779e-13  0              3.3253456    
    800000   6363.961       200            200            0.0033186635  -0.0025759661   0              0.012531957    1.1949197      0              115396.79      1.1965779e-13  0              3.3255295    
    900000   6363.961       200            200            0.003425911   -0.0025766917   0              0.012854425    0.10615858     0              10252.036      1.1965779e-13  0              3.3254703    
   1000000   6363.961       200            200            0.0034997675  -0.0025868025   0              0.013086105    0.058255773    0              5625.9256      1.1965779e-13  0              3.3254294    
   1100000   6363.961       200            200            0.003507292   -0.0025874975   0              0.013109373    0.00067074979  0              64.776214      1.1965779e-13  0              3.3254256    
   1200000   6363.961       200            200            0.0034993659  -0.0025867041   0              0.013084802    0.00062610822  0              60.46505       1.1965779e-13  0              3.32543      
   1300000   6363.961       200            200            0.003496059   -0.0025863793   0              0.013074556    0.00011553109  0              11.157166      1.1965779e-13  0              3.3254318    
   1400000   6363.961       200            200            0.0034961673  -0.0025863925   0              0.013074895    6.4518646e-08  0              0.006230749    1.1965779e-13  0              3.3254317    
   1500000   6363.961       200            200            0.0034966445  -0.0025864402   0              0.013076374    2.3183453e-06  0              0.22388919     1.1965779e-13  0              3.3254314    
   1600000   6363.961       200            200            0.0034967684  -0.0025864522   0              0.013076757    1.6607744e-07  0              0.01603857     1.1965779e-13  0              3.3254314    
   1700000   6363.961       200            200            0.00349674    -0.0025864493   0              0.013076669    7.5705543e-09  0              0.00073110994  1.1965779e-13  0              3.3254314    
   1800000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    6.4285089e-09  0              0.00062081938  1.1965779e-13  0              3.3254314    
   1900000   6363.961       200            200            0.0034967116  -0.0025864465   0              0.013076581    1.3302331e-10  0              1.2846439e-05  1.1965779e-13  0              3.3254314    
   2000000   6363.961       200            200            0.003496714   -0.0025864467   0              0.013076589    5.5669958e-11  0              5.376206e-06   1.1965779e-13  0              3.3254314    
   2100000   6363.961       200            200            0.0034967152  -0.0025864468   0              0.013076592    1.383441e-11   0              1.3360283e-06  1.1965779e-13  0              3.3254314    
   2200000   6363.961       200            200            0.0034967152  -0.0025864468   0              0.013076592    5.3831051e-15  0              5.1986176e-10  1.1965779e-13  0              3.3254314    
   2300000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    2.3029094e-13  0              2.2239851e-08  1.1965779e-13  0              3.3254314    
   2400000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    2.2033179e-14  0              2.1278067e-09  1.1965779e-13  0              3.3254314    
   2500000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    4.5935774e-16  0              4.4361482e-11  1.1965779e-13  0              3.3254314    
   2600000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    6.8501818e-16  0              6.6154153e-11  1.1965779e-13  0              3.3254314    
   2700000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    4.265227e-17   0              4.119051e-12   1.1965779e-13  0              3.3254314    
   2800000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    9.3190376e-19  0              8.9996594e-14  1.1965779e-13  0              3.3254314    
   2900000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    1.1887752e-18  0              1.148034e-13   1.1965779e-13  0              3.3254314    
   3000000   6363.961       200            200            0.003496715   -0.0025864468   0              0.013076592    5.7615603e-18  0              5.5641025e-13  1.1965779e-13  0              3.3254314    
Loop time of 285.1 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9091533.626 ns/day, 0.000 hours/ns, 10522.608 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.099     | 37.606     | 64.542     | 431.0 | 13.19
Neigh   | 1.7865     | 1.8041     | 1.8209     |   0.9 |  0.63
Comm    | 12.456     | 18.232     | 23.455     | 113.6 |  6.40
Output  | 0.24135    | 0.24167    | 0.24202    |   0.1 |  0.08
Modify  | 168.76     | 172.54     | 176.42     |  24.7 | 60.52
Other   |            | 54.67      |            |       | 19.18

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         338.25 ave         677 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1353
Ave neighs/atom = 0.54098361
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.67                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.9402665558481
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.77
  ghost atom cutoff = 3.77
  binsize = 1.885, bins = 3377 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 53.47 | 53.48 | 53.48 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.058853405   -0.015856581    0              0.19241679     664257.16      0              6.4149202e+10  1.1965779e-13  0              3.3178663    
    200000   6363.961       200            200           -0.00042609348 -8.8852643e-35  0             -0.0012782804   82160.597      0              7.9344824e+09  1.1965779e-13  0              3.4228821    
    300000   6363.961       200            200           -0.0002658352   2.5743276e-40  0             -0.00079750559  21678.208      0              2.0935262e+09  1.1965779e-13  0              3.3519085    
    400000   6363.961       200            200            0.018005704   -0.0068809166   0              0.06089803     125.396        0              12109848       1.1965779e-13  0              3.3251102    
    500000   6363.961       200            200            0.000513713   -0.00051332508  0              0.0020544641   0.30300428     0              29261.985      1.1965779e-13  0              3.333194     
    600000   6363.961       200            200            0.005068892   -0.0028995619   0              0.018106238    27.148671      0              2621824.4      1.1965779e-13  0              3.3296169    
    700000   6363.961       200            200            0.0038362793  -0.0025864484   0              0.014095286    17.720111      0              1711281.4      1.1965779e-13  0              3.3302667    
    800000   6363.961       200            200            0.0033741422  -0.0025803468   0              0.012702774    2.1638088      0              208965.17      1.1965779e-13  0              3.3305058    
    900000   6363.961       200            200            0.0034255586  -0.0025689288   0              0.012845605    0.013014731    0              1256.8696      1.1965779e-13  0              3.3304786    
   1000000   6363.961       200            200            0.0034967329  -0.0025805538   0              0.013070752    0.054700865    0              5282.618       1.1965779e-13  0              3.3304387    
   1100000   6363.961       200            200            0.0035133392  -0.0025821451   0              0.013122163    0.0033588698   0              324.3756       1.1965779e-13  0              3.3304299    
   1200000   6363.961       200            200            0.0035087154  -0.0025816779   0              0.013107824    0.00017808543  0              17.198216      1.1965779e-13  0              3.3304325    
   1300000   6363.961       200            200            0.003505029   -0.0025813168   0              0.013096404    0.00014400016  0              13.906505      1.1965779e-13  0              3.3304345    
   1400000   6363.961       200            200            0.0035044948  -0.0025812666   0              0.013094751    3.8798288e-06  0              0.37468609     1.1965779e-13  0              3.3304348    
   1500000   6363.961       200            200            0.0035048239  -0.0025812995   0              0.013095771    9.9799868e-07  0              0.096379569    1.1965779e-13  0              3.3304346    
   1600000   6363.961       200            200            0.0035049992  -0.0025813167   0              0.013096314    3.3551809e-07  0              0.032401935    1.1965779e-13  0              3.3304345    
   1700000   6363.961       200            200            0.0035050099  -0.0025813176   0              0.013096347    2.231115e-09   0              0.00021546512  1.1965779e-13  0              3.3304345    
   1800000   6363.961       200            200            0.0035049897  -0.0025813156   0              0.013096285    4.0000806e-09  0              0.00038629915  1.1965779e-13  0              3.3304345    
   1900000   6363.961       200            200            0.0035049819  -0.0025813148   0              0.01309626     6.8795441e-10  0              6.6437712e-05  1.1965779e-13  0              3.3304345    
   2000000   6363.961       200            200            0.0035049821  -0.0025813149   0              0.013096261    8.3393869e-14  0              8.053583e-09   1.1965779e-13  0              3.3304345    
   2100000   6363.961       200            200            0.0035049833  -0.002581315    0              0.013096265    1.3147482e-11  0              1.2696897e-06  1.1965779e-13  0              3.3304345    
   2200000   6363.961       200            200            0.0035049836  -0.002581315    0              0.013096266    1.2091346e-12  0              1.1676957e-07  1.1965779e-13  0              3.3304345    
   2300000   6363.961       200            200            0.0035049836  -0.002581315    0              0.013096266    2.0818878e-14  0              2.0105382e-09  1.1965779e-13  0              3.3304345    
   2400000   6363.961       200            200            0.0035049835  -0.002581315    0              0.013096265    3.7525957e-14  0              3.6239883e-09  1.1965779e-13  0              3.3304345    
   2500000   6363.961       200            200            0.0035049835  -0.002581315    0              0.013096265    1.686617e-15   0              1.628814e-10   1.1965779e-13  0              3.3304345    
   2600000   6363.961       200            200            0.0035049835  -0.002581315    0              0.013096265    1.5381213e-16  0              1.4854075e-11  1.1965779e-13  0              3.3304345    
   2700000   6363.961       200            200            0.0035049835  -0.002581315    0              0.013096265    8.7450648e-17  0              8.4453576e-12  1.1965779e-13  0              3.3304345    
   2800000   6363.961       200            200            0.0035049835  -0.002581315    0              0.013096265    1.2803886e-17  0              1.2365077e-12  1.1965779e-13  0              3.3304345    
   2900000   6363.961       200            200            0.0035049835  -0.002581315    0              0.013096265    6.822833e-18   0              6.5890037e-13  1.1965779e-13  0              3.3304345    
   3000000   6363.961       200            200            0.0035049835  -0.002581315    0              0.013096265    6.9876598e-21  0              6.7481817e-16  1.1965779e-13  0              3.3304345    
Loop time of 284.875 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9098740.869 ns/day, 0.000 hours/ns, 10530.950 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.108     | 37.517     | 64.452     | 430.1 | 13.17
Neigh   | 1.7403     | 1.7589     | 1.7769     |   1.0 |  0.62
Comm    | 12.334     | 18.267     | 23.535     | 116.2 |  6.41
Output  | 0.24702    | 0.24736    | 0.24773    |   0.1 |  0.09
Modify  | 167.64     | 172.02     | 176.58     |  28.3 | 60.38
Other   |            | 55.07      |            |       | 19.33

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         340.75 ave         682 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1363
Ave neighs/atom = 0.54498201
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.68                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.4069877389307
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.78
  ghost atom cutoff = 3.78
  binsize = 1.89, bins = 3368 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 52.61 | 52.61 | 52.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.094598266   -0.031628099    0              0.3154229      572438.68      0              5.5282031e+10  1.1965779e-13  0              3.3177852    
    200000   6363.961       200            200           -0.00042351889  3.8079813e-35  0             -0.0012705567   79155.433      0              7.6442651e+09  1.1965779e-13  0              3.4304431    
    300000   6363.961       200            200           -0.0002582652   2.5386929e-35  0             -0.00077479561  20032.426      0              1.9345883e+09  1.1965779e-13  0              3.3584381    
    400000   6363.961       200            200            0.018026743   -0.0068726842   0              0.060952912    101.44319      0              9796657.5      1.1965779e-13  0              3.3301085    
    500000   6363.961       200            200            0.00055669291 -0.00051937072  0              0.0021894495   36.773566      0              3551327.8      1.1965779e-13  0              3.3381538    
    600000   6363.961       200            200            0.0048614973  -0.0028488023   0              0.017433294    64.236634      0              6203514.4      1.1965779e-13  0              3.3347237    
    700000   6363.961       200            200            0.0039804497  -0.0025839001   0              0.014525249    11.360279      0              1097094.4      1.1965779e-13  0              3.3352002    
    800000   6363.961       200            200            0.003439396   -0.0025928357   0              0.012911024    2.9333258      0              283279.61      1.1965779e-13  0              3.3354756    
    900000   6363.961       200            200            0.0034332752  -0.0025658105   0              0.012865636    0.012128813    0              1171.314       1.1965779e-13  0              3.3354818    
   1000000   6363.961       200            200            0.0034941717  -0.002576515    0              0.01305903     0.037436802    0              3615.3784      1.1965779e-13  0              3.3354473    
   1100000   6363.961       200            200            0.0035172763  -0.0025787554   0              0.013130584    0.0064206019   0              620.05577      1.1965779e-13  0              3.3354349    
   1200000   6363.961       200            200            0.0035166254  -0.002578675    0              0.013128551    8.654067e-07   0              0.083574785    1.1965779e-13  0              3.3354354    
   1300000   6363.961       200            200            0.0035132902  -0.0025783479   0              0.013118218    0.00010994857  0              10.618046      1.1965779e-13  0              3.3354372    
   1400000   6363.961       200            200            0.0035122534  -0.0025782483   0              0.013115008    1.3419561e-05  0              1.2959652      1.1965779e-13  0              3.3354377    
   1500000   6363.961       200            200            0.003512353   -0.0025782588   0              0.013115318    3.1449322e-08  0              0.0030371504   1.1965779e-13  0              3.3354377    
   1600000   6363.961       200            200            0.0035125264  -0.0025782758   0              0.013115855    3.0652027e-07  0              0.029601534    1.1965779e-13  0              3.3354376    
   1700000   6363.961       200            200            0.0035125714  -0.0025782801   0              0.013115994    2.6537255e-08  0              0.0025627782   1.1965779e-13  0              3.3354376    
   1800000   6363.961       200            200            0.0035125633  -0.0025782793   0              0.013115969    3.8666354e-10  0              3.7341197e-05  1.1965779e-13  0              3.3354376    
   1900000   6363.961       200            200            0.0035125544  -0.0025782784   0              0.013115942    8.1761028e-10  0              7.8958949e-05  1.1965779e-13  0              3.3354376    
   2000000   6363.961       200            200            0.0035125526  -0.0025782782   0              0.013115936    4.895702e-11   0              4.7279186e-06  1.1965779e-13  0              3.3354376    
   2100000   6363.961       200            200            0.0035125531  -0.0025782783   0              0.013115938    2.2304745e-12  0              2.1540326e-07  1.1965779e-13  0              3.3354376    
   2200000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    2.0939754e-12  0              2.0222115e-07  1.1965779e-13  0              3.3354376    
   2300000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    8.2508091e-14  0              7.9680409e-09  1.1965779e-13  0              3.3354376    
   2400000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    9.4706363e-15  0              9.1460627e-10  1.1965779e-13  0              3.3354376    
   2500000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    5.1568197e-15  0              4.9800873e-10  1.1965779e-13  0              3.3354376    
   2600000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    1.2626271e-16  0              1.2193548e-11  1.1965779e-13  0              3.3354376    
   2700000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    1.1789818e-17  0              1.1385762e-12  1.1965779e-13  0              3.3354376    
   2800000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    3.0630758e-18  0              2.9580993e-13  1.1965779e-13  0              3.3354376    
   2900000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    3.3624302e-19  0              3.2471944e-14  1.1965779e-13  0              3.3354376    
   3000000   6363.961       200            200            0.0035125536  -0.0025782783   0              0.013115939    3.2434245e-18  0              3.1322672e-13  1.1965779e-13  0              3.3354376    
Loop time of 282.982 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9159588.742 ns/day, 0.000 hours/ns, 10601.376 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.9       | 37.683     | 64.956     | 432.8 | 13.32
Neigh   | 1.7499     | 1.767      | 1.7835     |   0.9 |  0.62
Comm    | 12.65      | 17.57      | 21.693     |  90.5 |  6.21
Output  | 0.24034    | 0.24065    | 0.24099    |   0.1 |  0.09
Modify  | 165.78     | 170.81     | 175.92     |  33.9 | 60.36
Other   |            | 54.91      |            |       | 19.40

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.75 ave         686 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1371
Ave neighs/atom = 0.54818073
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.69                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.8762523554259
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.79
  ghost atom cutoff = 3.79
  binsize = 1.895, bins = 3359 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 52.51 | 52.52 | 52.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.13615129    -0.045183056    0              0.45363693     442478.88      0              4.2731443e+10  1.1965779e-13  0              3.3181837    
    200000   6363.961       200            200           -0.00042074108 -3.1733116e-36  0             -0.0012622232   76208.964      0              7.3597163e+09  1.1965779e-13  0              3.4379584    
    300000   6363.961       200            200           -0.00025048118  5.8554872e-41  0             -0.00075144354  18453.42       0              1.7820992e+09  1.1965779e-13  0              3.3649093    
    400000   6363.961       200            200            0.017054674   -0.0068793278   0              0.058043351    942.57949      0              91027581       1.1965779e-13  0              3.3353508    
    500000   6363.961       200            200            0.00065377194 -0.00054136831  0              0.0025026841   131.69395      0              12718059       1.1965779e-13  0              3.3430417    
    600000   6363.961       200            200            0.0045678363  -0.0028113653   0              0.016514874    106.66856      0              10301286       1.1965779e-13  0              3.3398707    
    700000   6363.961       200            200            0.0040889188  -0.0025871448   0              0.014853901    5.1976715      0              501953.91      1.1965779e-13  0              3.3401513    
    800000   6363.961       200            200            0.0035152796  -0.0025940085   0              0.013139847    3.2231725      0              311270.93      1.1965779e-13  0              3.340442     
    900000   6363.961       200            200            0.0034496186  -0.0025656172   0              0.012914473    0.10306041     0              9952.8363      1.1965779e-13  0              3.3404798    
   1000000   6363.961       200            200            0.0034935387  -0.0025747186   0              0.013055335    0.015887281    0              1534.2799      1.1965779e-13  0              3.3404546    
   1100000   6363.961       200            200            0.0035197498  -0.0025772964   0              0.013136546    0.0078772885   0              760.73214      1.1965779e-13  0              3.3404404    
   1200000   6363.961       200            200            0.0035230594  -0.002577603    0              0.013146781    0.00022396968  0              21.629388      1.1965779e-13  0              3.3404387    
   1300000   6363.961       200            200            0.0035207129  -0.0025773696   0              0.013139508    4.3204484e-05  0              4.1723798      1.1965779e-13  0              3.34044      
   1400000   6363.961       200            200            0.0035194222  -0.0025772441   0              0.013135511    1.9228101e-05  0              1.8569124      1.1965779e-13  0              3.3404407    
   1500000   6363.961       200            200            0.0035192735  -0.0025772304   0              0.013135051    4.8132691e-07  0              0.046483108    1.1965779e-13  0              3.3404407    
   1600000   6363.961       200            200            0.0035193939  -0.0025772424   0              0.013135424    1.1637559e-07  0              0.011238721    1.1965779e-13  0              3.3404407    
   1700000   6363.961       200            200            0.0035194573  -0.0025772485   0              0.01313562     4.683778e-08   0              0.0045232575   1.1965779e-13  0              3.3404406    
   1800000   6363.961       200            200            0.0035194639  -0.0025772491   0              0.013135641    1.022955e-09   0              9.8789673e-05  1.1965779e-13  0              3.3404406    
   1900000   6363.961       200            200            0.0035194577  -0.0025772485   0              0.013135622    3.1152685e-10  0              3.0085033e-05  1.1965779e-13  0              3.3404406    
   2000000   6363.961       200            200            0.0035194546  -0.0025772482   0              0.013135612    1.1384677e-10  0              1.0994506e-05  1.1965779e-13  0              3.3404406    
   2100000   6363.961       200            200            0.0035194543  -0.0025772482   0              0.013135611    2.1463407e-12  0              2.0727822e-07  1.1965779e-13  0              3.3404406    
   2200000   6363.961       200            200            0.0035194547  -0.0025772482   0              0.013135612    8.2900432e-13  0              8.0059304e-08  1.1965779e-13  0              3.3404406    
   2300000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    2.7625668e-13  0              2.6678892e-08  1.1965779e-13  0              3.3404406    
   2400000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    4.5922155e-15  0              4.434833e-10   1.1965779e-13  0              3.3404406    
   2500000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    2.2199975e-15  0              2.1439147e-10  1.1965779e-13  0              3.3404406    
   2600000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    6.6999132e-16  0              6.4702967e-11  1.1965779e-13  0              3.3404406    
   2700000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    3.0740544e-17  0              2.9687017e-12  1.1965779e-13  0              3.3404406    
   2800000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    1.545731e-18   0              1.4927563e-13  1.1965779e-13  0              3.3404406    
   2900000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    1.9249209e-21  0              1.8589508e-16  1.1965779e-13  0              3.3404406    
   3000000   6363.961       200            200            0.0035194548  -0.0025772482   0              0.013135613    5.0783972e-18  0              4.9043525e-13  1.1965779e-13  0              3.3404406    
Loop time of 284.057 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9124942.294 ns/day, 0.000 hours/ns, 10561.276 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.946     | 38.053     | 65.547     | 436.1 | 13.40
Neigh   | 1.7526     | 1.7712     | 1.7889     |   1.0 |  0.62
Comm    | 12.744     | 17.718     | 21.98      |  91.0 |  6.24
Output  | 0.24041    | 0.24073    | 0.24107    |   0.1 |  0.08
Modify  | 166.45     | 171.24     | 176.44     |  32.2 | 60.28
Other   |            | 55.04      |            |       | 19.38

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.25 ave         693 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1385
Ave neighs/atom = 0.55377849
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.7                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.3480673168373
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.8
  ghost atom cutoff = 3.8
  binsize = 1.9, bins = 3350 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 52.38 | 52.4 | 52.42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.17858072    -0.055309508    0              0.59105167     290327.05      0              2.8037709e+10  1.1965779e-13  0              3.319285     
    200000   6363.961       200            200           -0.00041776098  2.0309287e-34  0             -0.0012532829   73321.032      0              7.0808204e+09  1.1965779e-13  0              3.445428     
    300000   6363.961       200            200           -0.00024248445 -1.0154398e-34  0             -0.00072745336  16940.963      0              1.636037e+09   1.1965779e-13  0              3.371322     
    400000   6363.961       200            200            0.015130535   -0.0071339237   0              0.052525529    2444.2072      0              2.3604404e+08  1.1965779e-13  0              3.3408229    
    500000   6363.961       200            200            0.0008206811  -0.00056056427  0              0.0030226076   278.56388      0              26901706       1.1965779e-13  0              3.3478594    
    600000   6363.961       200            200            0.0042060887  -0.0028078313   0              0.015426097    144.62991      0              13967322       1.1965779e-13  0              3.3450495    
    700000   6363.961       200            200            0.0041536045  -0.0025933097   0              0.015054123    1.0368952      0              100135.92      1.1965779e-13  0              3.3451239    
    800000   6363.961       200            200            0.0035913665  -0.002595887    0              0.013369986    2.9255567      0              282529.33      1.1965779e-13  0              3.3454083    
    900000   6363.961       200            200            0.0034738998  -0.0025671388   0              0.012988838    0.24446291     0              23608.478      1.1965779e-13  0              3.3454734    
   1000000   6363.961       200            200            0.0034963745  -0.0025737926   0              0.013062916    0.0016942295   0              163.61656      1.1965779e-13  0              3.3454598    
   1100000   6363.961       200            200            0.003522007   -0.0025763367   0              0.013142358    0.0068014836   0              656.83861      1.1965779e-13  0              3.3454459    
   1200000   6363.961       200            200            0.0035286127  -0.0025769692   0              0.013162807    0.0006758773   0              65.271392      1.1965779e-13  0              3.3454424    
   1300000   6363.961       200            200            0.0035276777  -0.0025768722   0              0.013159905    1.3776956e-06  0              0.13304798     1.1965779e-13  0              3.3454429    
   1400000   6363.961       200            200            0.0035264298  -0.0025767499   0              0.013156039    1.5627281e-05  0              1.509171       1.1965779e-13  0              3.3454436    
   1500000   6363.961       200            200            0.0035260785  -0.0025767162   0              0.013154952    1.8335826e-06  0              0.17707429     1.1965779e-13  0              3.3454438    
   1600000   6363.961       200            200            0.0035261123  -0.0025767198   0              0.013155057    2.2009545e-10  0              2.1255243e-05  1.1965779e-13  0              3.3454437    
   1700000   6363.961       200            200            0.0035261726  -0.0025767258   0              0.013155243    3.5420887e-08  0              0.0034206957   1.1965779e-13  0              3.3454437    
   1800000   6363.961       200            200            0.0035261911  -0.0025767275   0              0.013155301    4.8999904e-09  0              0.000473206    1.1965779e-13  0              3.3454437    
   1900000   6363.961       200            200            0.00352619    -0.0025767274   0              0.013155297    1.9870786e-12  0              1.9189783e-07  1.1965779e-13  0              3.3454437    
   2000000   6363.961       200            200            0.0035261871  -0.0025767271   0              0.013155289    7.9144503e-11  0              7.6432096e-06  1.1965779e-13  0              3.3454437    
   2100000   6363.961       200            200            0.0035261862  -0.002576727    0              0.013155286    1.2916057e-11  0              1.2473404e-06  1.1965779e-13  0              3.3454437    
   2200000   6363.961       200            200            0.0035261862  -0.002576727    0              0.013155286    3.0702761e-14  0              2.9650529e-09  1.1965779e-13  0              3.3454437    
   2300000   6363.961       200            200            0.0035261863  -0.0025767271   0              0.013155286    1.7451852e-13  0              1.6853749e-08  1.1965779e-13  0              3.3454437    
   2400000   6363.961       200            200            0.0035261864  -0.0025767271   0              0.013155286    3.3548401e-14  0              3.2398644e-09  1.1965779e-13  0              3.3454437    
   2500000   6363.961       200            200            0.0035261864  -0.0025767271   0              0.013155286    1.9936906e-16  0              1.9253637e-11  1.1965779e-13  0              3.3454437    
   2600000   6363.961       200            200            0.0035261864  -0.0025767271   0              0.013155286    3.4877528e-16  0              3.368222e-11   1.1965779e-13  0              3.3454437    
   2700000   6363.961       200            200            0.0035261864  -0.0025767271   0              0.013155286    9.2268044e-17  0              8.9105873e-12  1.1965779e-13  0              3.3454437    
   2800000   6363.961       200            200            0.0035261864  -0.0025767271   0              0.013155286    1.2027007e-17  0              1.1614822e-12  1.1965779e-13  0              3.3454437    
   2900000   6363.961       200            200            0.0035261864  -0.0025767271   0              0.013155286    3.3031108e-18  0              3.189908e-13   1.1965779e-13  0              3.3454437    
   3000000   6363.961       200            200            0.0035261864  -0.0025767271   0              0.013155286    4.4602221e-18  0              4.3073633e-13  1.1965779e-13  0              3.3454437    
Loop time of 286.411 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9049946.125 ns/day, 0.000 hours/ns, 10474.475 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.065     | 38.041     | 65.726     | 436.2 | 13.28
Neigh   | 1.7699     | 1.7872     | 1.8038     |   0.9 |  0.62
Comm    | 12.319     | 18.368     | 23.52      | 117.4 |  6.41
Output  | 0.24294    | 0.24327    | 0.24362    |   0.1 |  0.08
Modify  | 169.53     | 173.07     | 177.15     |  22.7 | 60.43
Other   |            | 54.9       |            |       | 19.17

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         348.25 ave         697 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1393
Ave neighs/atom = 0.55697721
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.71                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.8224395346687
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.81
  ghost atom cutoff = 3.81
  binsize = 1.905, bins = 3341 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.61 | 51.62 | 51.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.21820751    -0.05406234     0              0.70868488     144380.42      0              1.3943227e+10  1.1965779e-13  0              3.3213119    
    200000   6363.961       200            200           -0.00041457953 -5.0771287e-35  0             -0.0012437386   70491.48       0              6.8075626e+09  1.1965779e-13  0              3.4528518    
    300000   6363.961       200            200           -0.00023427633  1.8719568e-40  0             -0.00070282899  15494.825      0              1.4963793e+09  1.1965779e-13  0              3.3776762    
    400000   6363.961       200            200            0.012576419   -0.0073618516   0              0.04509111     4259.9368      0              4.113942e+08   1.1965779e-13  0              3.3464974    
    500000   6363.961       200            200            0.0010724694  -0.00057364521  0              0.0037910535   466.30421      0              45032323       1.1965779e-13  0              3.3526102    
    600000   6363.961       200            200            0.0038021688  -0.0028377677   0              0.014244274    169.82171      0              16400165       1.1965779e-13  0              3.3502496    
    700000   6363.961       200            200            0.004171528   -0.0025949915   0              0.015109576    0.10141499     0              9793.9334      1.1965779e-13  0              3.3501203    
    800000   6363.961       200            200            0.0036612026  -0.0025978843   0              0.013581492    2.146907       0              207332.91      1.1965779e-13  0              3.3503781    
    900000   6363.961       200            200            0.0035043279  -0.0025695762   0              0.01308256     0.37266367     0              35989.19       1.1965779e-13  0              3.3504636    
   1000000   6363.961       200            200            0.0035032754  -0.0025736146   0              0.013083441    0.0024207615   0              233.77981      1.1965779e-13  0              3.3504628    
   1100000   6363.961       200            200            0.0035248546  -0.002575777    0              0.013150341    0.0038964938   0              376.29548      1.1965779e-13  0              3.350451     
   1200000   6363.961       200            200            0.0035335768  -0.0025766239   0              0.013177354    0.0010162308   0              98.140293      1.1965779e-13  0              3.3504463    
   1300000   6363.961       200            200            0.0035341898  -0.0025766777   0              0.013179247    1.9989738e-05  0              1.9304658      1.1965779e-13  0              3.350446     
   1400000   6363.961       200            200            0.0035332614  -0.0025765856   0              0.01317637     6.1978094e-06  0              0.59854007     1.1965779e-13  0              3.3504465    
   1500000   6363.961       200            200            0.0035328036  -0.0025765411   0              0.013174952    2.5892477e-06  0              0.25005101     1.1965779e-13  0              3.3504467    
   1600000   6363.961       200            200            0.0035327436  -0.0025765356   0              0.013174766    9.9203071e-08  0              0.0095803225   1.1965779e-13  0              3.3504468    
   1700000   6363.961       200            200            0.0035327811  -0.0025765393   0              0.013174883    8.0222816e-09  0              0.00077473453  1.1965779e-13  0              3.3504468    
   1800000   6363.961       200            200            0.0035328043  -0.0025765416   0              0.013174955    6.1885265e-09  0              0.00059764359  1.1965779e-13  0              3.3504467    
   1900000   6363.961       200            200            0.0035328087  -0.002576542    0              0.013174968    3.8930224e-10  0              3.7596024e-05  1.1965779e-13  0              3.3504467    
   2000000   6363.961       200            200            0.0035328073  -0.0025765419   0              0.013174964    6.9049316e-12  0              6.6682887e-07  1.1965779e-13  0              3.3504467    
   2100000   6363.961       200            200            0.0035328061  -0.0025765417   0              0.01317496     1.3854036e-11  0              1.3379237e-06  1.1965779e-13  0              3.3504467    
   2200000   6363.961       200            200            0.0035328059  -0.0025765417   0              0.013174959    1.3247884e-12  0              1.2793859e-07  1.1965779e-13  0              3.3504467    
   2300000   6363.961       200            200            0.0035328059  -0.0025765417   0              0.013174959    1.2825671e-15  0              1.2386115e-10  1.1965779e-13  0              3.3504467    
   2400000   6363.961       200            200            0.003532806   -0.0025765417   0              0.01317496     2.9048657e-14  0              2.8053114e-09  1.1965779e-13  0              3.3504467    
   2500000   6363.961       200            200            0.003532806   -0.0025765417   0              0.01317496     4.0454599e-15  0              3.9068156e-10  1.1965779e-13  0              3.3504467    
   2600000   6363.961       200            200            0.003532806   -0.0025765417   0              0.01317496     1.3951533e-17  0              1.3473392e-12  1.1965779e-13  0              3.3504467    
   2700000   6363.961       200            200            0.003532806   -0.0025765417   0              0.01317496     2.2828484e-17  0              2.2046116e-12  1.1965779e-13  0              3.3504467    
   2800000   6363.961       200            200            0.003532806   -0.0025765417   0              0.01317496     3.1828831e-18  0              3.0738007e-13  1.1965779e-13  0              3.3504467    
   2900000   6363.961       200            200            0.003532806   -0.0025765417   0              0.01317496     4.7512983e-18  0              4.5884638e-13  1.1965779e-13  0              3.3504467    
   3000000   6363.961       200            200            0.003532806   -0.0025765417   0              0.01317496     1.2069119e-19  0              1.1655492e-14  1.1965779e-13  0              3.3504467    
Loop time of 285.071 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9092462.352 ns/day, 0.000 hours/ns, 10523.683 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.933     | 38.335     | 66.117     | 439.1 | 13.45
Neigh   | 1.7305     | 1.7491     | 1.7667     |   1.0 |  0.61
Comm    | 12.688     | 17.608     | 21.872     |  91.3 |  6.18
Output  | 0.2427     | 0.24301    | 0.24335    |   0.1 |  0.09
Modify  | 167.09     | 171.81     | 176.06     |  30.5 | 60.27
Other   |            | 55.33      |            |       | 19.41

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         350.75 ave         702 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1403
Ave neighs/atom = 0.56097561
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.72                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.299375920424
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.82
  ghost atom cutoff = 3.82
  binsize = 1.91, bins = 3332 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.47 | 51.48 | 51.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.24600804    -0.049940604    0              0.78796473     38419.733      0              3.7103028e+09  1.1965779e-13  0              3.3244557    
    200000   6363.961       200            200           -0.00041119765  1.0493462e-39  0             -0.001233593    67720.149      0              6.5399273e+09  1.1965779e-13  0              3.4602298    
    300000   6363.961       200            200           -0.0002258581   2.5386721e-35  0             -0.0006775743   14114.772      0              1.3631036e+09  1.1965779e-13  0              3.3839717    
    400000   6363.961       200            200            0.0096239217  -0.0077468559   0              0.036618621    6011.0684      0              5.8050596e+08  1.1965779e-13  0              3.3523369    
    500000   6363.961       200            200            0.0014185757  -0.00059481479  0              0.0048505418   678.76195      0              65549970       1.1965779e-13  0              3.3572987    
    600000   6363.961       200            200            0.0034108809  -0.0028163801   0              0.013049023    177.23776      0              17116354       1.1965779e-13  0              3.35546      
    700000   6363.961       200            200            0.0041409633  -0.0025937505   0              0.015016641    2.6502565      0              255942.8       1.1965779e-13  0              3.355141     
    800000   6363.961       200            200            0.0037183279  -0.0026007206   0              0.013755704    1.1713697      0              113122.5       1.1965779e-13  0              3.3553544    
    900000   6363.961       200            200            0.0035379742  -0.0025732918   0              0.013187214    0.43008829     0              41534.848      1.1965779e-13  0              3.3554518    
   1000000   6363.961       200            200            0.0035138573  -0.0025752051   0              0.013116777    0.017528214    0              1692.7494      1.1965779e-13  0              3.3554635    
   1100000   6363.961       200            200            0.0035285783  -0.002576706    0              0.013162441    0.0010261099   0              99.094346      1.1965779e-13  0              3.3554553    
   1200000   6363.961       200            200            0.0035379353  -0.0025776277   0              0.013191434    0.00099158708  0              95.760383      1.1965779e-13  0              3.3554503    
   1300000   6363.961       200            200            0.0035399316  -0.0025778186   0              0.013197613    8.23918e-05    0              7.9568103      1.1965779e-13  0              3.3554493    
   1400000   6363.961       200            200            0.0035395187  -0.002577776    0              0.013196332    1.4706431e-07  0              0.014202419    1.1965779e-13  0              3.3554495    
   1500000   6363.961       200            200            0.003539074   -0.0025777322   0              0.013194954    1.9227861e-06  0              0.18568892     1.1965779e-13  0              3.3554497    
   1600000   6363.961       200            200            0.0035389404  -0.0025777193   0              0.013194541    2.8966147e-07  0              0.027973432    1.1965779e-13  0              3.3554498    
   1700000   6363.961       200            200            0.0035389436  -0.0025777197   0              0.01319455     1.7676172e-09  0              0.00017070382  1.1965779e-13  0              3.3554498    
   1800000   6363.961       200            200            0.0035389629  -0.0025777216   0              0.01319461     2.9879356e-09  0              0.00028855343  1.1965779e-13  0              3.3554498    
   1900000   6363.961       200            200            0.0035389707  -0.0025777224   0              0.013194635    8.3640971e-10  0              8.0774463e-05  1.1965779e-13  0              3.3554498    
   2000000   6363.961       200            200            0.0035389714  -0.0025777225   0              0.013194637    2.4354982e-11  0              2.3520298e-06  1.1965779e-13  0              3.3554498    
   2100000   6363.961       200            200            0.0035389707  -0.0025777224   0              0.013194634    3.2369624e-12  0              3.1260266e-07  1.1965779e-13  0              3.3554498    
   2200000   6363.961       200            200            0.0035389703  -0.0025777223   0              0.013194633    2.0460446e-12  0              1.9759234e-07  1.1965779e-13  0              3.3554498    
   2300000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    1.3421913e-13  0              1.2961923e-08  1.1965779e-13  0              3.3554498    
   2400000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    1.3452809e-15  0              1.299176e-10   1.1965779e-13  0              3.3554498    
   2500000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    4.2035698e-15  0              4.0595068e-10  1.1965779e-13  0              3.3554498    
   2600000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    5.2235811e-16  0              5.0445607e-11  1.1965779e-13  0              3.3554498    
   2700000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    1.5647611e-17  0              1.5111343e-12  1.1965779e-13  0              3.3554498    
   2800000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    9.9574296e-19  0              9.6161728e-14  1.1965779e-13  0              3.3554498    
   2900000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    1.0193844e-20  0              9.8444844e-16  1.1965779e-13  0              3.3554498    
   3000000   6363.961       200            200            0.0035389702  -0.0025777223   0              0.013194633    6.8494898e-18  0              6.614747e-13   1.1965779e-13  0              3.3554498    
Loop time of 285.145 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9090112.959 ns/day, 0.000 hours/ns, 10520.964 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.029     | 38.43      | 66.586     | 439.4 | 13.48
Neigh   | 1.7969     | 1.8161     | 1.8345     |   1.0 |  0.64
Comm    | 12.739     | 17.753     | 21.725     |  91.0 |  6.23
Output  | 0.24193    | 0.24225    | 0.24259    |   0.1 |  0.08
Modify  | 167.45     | 171.89     | 176.89     |  29.1 | 60.28
Other   |            | 55.02      |            |       | 19.29

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         352.75 ave         706 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1411
Ave neighs/atom = 0.56417433
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.73                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.7788833856071
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.83
  ghost atom cutoff = 3.83
  binsize = 1.915, bins = 3324 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.38 | 51.39 | 51.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.25567125    -0.048582832    0              0.81559658     2.4272197      0              234403.51      1.1965779e-13  0              3.3288465    
    200000   6363.961       200            200           -0.00040761628  3.8079836e-35  0             -0.0012228489   65006.878      0              6.277899e+09   1.1965779e-13  0              3.4675619    
    300000   6363.961       200            200           -0.00021723108  1.2693271e-34  0             -0.00065169325  12800.58       0              1.2361884e+09  1.1965779e-13  0              3.3902084    
    400000   6363.961       200            200            0.0071289203  -0.0065908177   0              0.027977579    7389.4008      0              7.1361544e+08  1.1965779e-13  0              3.3582984    
    500000   6363.961       200            200            0.0018461927  -0.000711246    0              0.006249824    894.57812      0              86391952       1.1965779e-13  0              3.3619318    
    600000   6363.961       200            200            0.0030731381  -0.0026899643   0              0.011909379    166.02359      0              16033370       1.1965779e-13  0              3.3606694    
    700000   6363.961       200            200            0.0040655778  -0.0025882038   0              0.014784937    7.8972476      0              762659.65      1.1965779e-13  0              3.3601846    
    800000   6363.961       200            200            0.0037589262  -0.0026006509   0              0.01387743     0.35707382     0              34483.634      1.1965779e-13  0              3.3603397    
    900000   6363.961       200            200            0.0035721699  -0.0025765251   0              0.013293035    0.39097705     0              37757.765      1.1965779e-13  0              3.3604399    
   1000000   6363.961       200            200            0.0035282056  -0.0025764008   0              0.013161018    0.038744639    0              3741.68        1.1965779e-13  0              3.3604623    
   1100000   6363.961       200            200            0.0035342874  -0.0025770468   0              0.013179909    1.2814345e-05  0              1.2375178      1.1965779e-13  0              3.3604588    
   1200000   6363.961       200            200            0.0035427514  -0.0025778874   0              0.013206142    0.00062238713  0              60.105694      1.1965779e-13  0              3.3604542    
   1300000   6363.961       200            200            0.0035457097  -0.0025781748   0              0.013215304    0.000134756    0              13.01377       1.1965779e-13  0              3.3604526    
   1400000   6363.961       200            200            0.0035458873  -0.00257819     0              0.013215852    3.2881855e-06  0              0.31754942     1.1965779e-13  0              3.3604525    
   1500000   6363.961       200            200            0.0035455677  -0.0025781581   0              0.013214861    5.7176878e-07  0              0.055217336    1.1965779e-13  0              3.3604527    
   1600000   6363.961       200            200            0.0035454012  -0.0025781419   0              0.013214346    3.3827617e-07  0              0.032668291    1.1965779e-13  0              3.3604528    
   1700000   6363.961       200            200            0.0035453701  -0.0025781389   0              0.013214249    2.4784838e-08  0              0.0023935423   1.1965779e-13  0              3.3604528    
   1800000   6363.961       200            200            0.0035453786  -0.0025781398   0              0.013214276    6.7168924e-11  0              6.4866939e-06  1.1965779e-13  0              3.3604528    
   1900000   6363.961       200            200            0.0035453866  -0.0025781406   0              0.0132143      6.1881805e-10  0              5.9761018e-05  1.1965779e-13  0              3.3604528    
   2000000   6363.961       200            200            0.0035453891  -0.0025781408   0              0.013214308    9.9771688e-11  0              9.6352355e-06  1.1965779e-13  0              3.3604528    
   2100000   6363.961       200            200            0.0035453891  -0.0025781408   0              0.013214308    1.2117638e-12  0              1.1702347e-07  1.1965779e-13  0              3.3604528    
   2200000   6363.961       200            200            0.0035453887  -0.0025781408   0              0.013214307    7.3139908e-13  0              7.0633288e-08  1.1965779e-13  0              3.3604528    
   2300000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    2.8106726e-13  0              2.7143464e-08  1.1965779e-13  0              3.3604528    
   2400000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    1.4798233e-14  0              1.4291074e-09  1.1965779e-13  0              3.3604528    
   2500000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    3.2084453e-16  0              3.0984868e-11  1.1965779e-13  0              3.3604528    
   2600000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    5.6412674e-16  0              5.4479323e-11  1.1965779e-13  0              3.3604528    
   2700000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    8.8478518e-17  0              8.5446219e-12  1.1965779e-13  0              3.3604528    
   2800000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    1.1403537e-17  0              1.1012719e-12  1.1965779e-13  0              3.3604528    
   2900000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    8.184757e-19   0              7.9042525e-14  1.1965779e-13  0              3.3604528    
   3000000   6363.961       200            200            0.0035453886  -0.0025781407   0              0.013214306    7.6392821e-18  0              7.3774718e-13  1.1965779e-13  0              3.3604528    
Loop time of 283.9 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9129975.928 ns/day, 0.000 hours/ns, 10567.102 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.936     | 37.441     | 64.553     | 429.5 | 13.19
Neigh   | 1.7651     | 1.7838     | 1.8019     |   1.0 |  0.63
Comm    | 12.537     | 17.562     | 21.595     |  90.7 |  6.19
Output  | 0.24247    | 0.2428     | 0.24317    |   0.1 |  0.09
Modify  | 166.51     | 171.89     | 177.9      |  36.8 | 60.55
Other   |            | 54.98      |            |       | 19.37

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.52738904
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.74                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.2609688417216
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.84
  ghost atom cutoff = 3.84
  binsize = 1.92, bins = 3315 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.29 | 51.3 | 51.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.24599456    -0.04844673     0              0.78643042     39527.386      0              3.817272e+09   1.1965779e-13  0              3.3345307    
    200000   6363.961       200            200           -0.00040383638 -2.5386061e-35  0             -0.0012115091   62351.529      0              6.0214644e+09  1.1965779e-13  0              3.474848     
    300000   6363.961       200            200           -0.00020839666  4.1083912e-40  0             -0.00062518997  11552.03       0              1.1156124e+09  1.1965779e-13  0              3.3963862    
    400000   6363.961       200            200            0.0047417017  -0.0056842889   0              0.019909394    8218.0558      0              7.9364101e+08  1.1965779e-13  0              3.3643378    
    500000   6363.961       200            200            0.0023304208  -0.0010280884   0              0.0080193508   1088.062       0              1.0507724e+08  1.1965779e-13  0              3.3665184    
    600000   6363.961       200            200            0.0027663227  -0.0025867161   0              0.010885684    139.23676      0              13446490       1.1965779e-13  0              3.365867     
    700000   6363.961       200            200            0.0039536561  -0.0025752233   0              0.014436192    14.261246      0              1377249.1      1.1965779e-13  0              3.3652479    
    800000   6363.961       200            200            0.0037786355  -0.0026002244   0              0.013936131    0.0032468874   0              313.56114      1.1965779e-13  0              3.3653358    
    900000   6363.961       200            200            0.0036038468  -0.0025784697   0              0.01339001     0.27294275     0              26358.857      1.1965779e-13  0              3.3654295    
   1000000   6363.961       200            200            0.0035453713  -0.0025766295   0              0.013212743    0.054571607    0              5270.1352      1.1965779e-13  0              3.3654598    
   1100000   6363.961       200            200            0.0035422452  -0.0025763653   0              0.013203101    0.0014801507   0              142.94236      1.1965779e-13  0              3.3654612    
   1200000   6363.961       200            200            0.0035484853  -0.0025769897   0              0.013222446    0.00018406843  0              17.776012      1.1965779e-13  0              3.3654578    
   1300000   6363.961       200            200            0.0035518181  -0.0025773154   0              0.01323277     0.00013243449  0              12.789575      1.1965779e-13  0              3.365456     
   1400000   6363.961       200            200            0.0035525294  -0.0025773831   0              0.013234971    1.2472763e-05  0              1.2045302      1.1965779e-13  0              3.3654556    
   1500000   6363.961       200            200            0.0035524113  -0.0025773708   0              0.013234605    8.8068448e-09  0              0.00085050203  1.1965779e-13  0              3.3654557    
   1600000   6363.961       200            200            0.0035522604  -0.002577356    0              0.013234137    1.8691484e-07  0              0.018050897    1.1965779e-13  0              3.3654558    
   1700000   6363.961       200            200            0.0035522061  -0.0025773507   0              0.013233969    4.5812353e-08  0              0.0044242291   1.1965779e-13  0              3.3654558    
   1800000   6363.961       200            200            0.0035522011  -0.0025773503   0              0.013233954    1.7160399e-09  0              0.00016572285  1.1965779e-13  0              3.3654558    
   1900000   6363.961       200            200            0.0035522061  -0.0025773508   0              0.013233969    9.1303111e-11  0              8.8174009e-06  1.1965779e-13  0              3.3654558    
   2000000   6363.961       200            200            0.0035522091  -0.0025773511   0              0.013233978    1.0069525e-10  0              9.7244264e-06  1.1965779e-13  0              3.3654558    
   2100000   6363.961       200            200            0.0035522098  -0.0025773511   0              0.013233981    1.1467768e-11  0              1.107475e-06   1.1965779e-13  0              3.3654558    
   2200000   6363.961       200            200            0.0035522098  -0.0025773511   0              0.01323398     5.0370204e-14  0              4.8643938e-09  1.1965779e-13  0              3.3654558    
   2300000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     1.2382148e-13  0              1.1957792e-08  1.1965779e-13  0              3.3654558    
   2400000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     3.7662473e-14  0              3.6371721e-09  1.1965779e-13  0              3.3654558    
   2500000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     1.8761174e-15  0              1.8118199e-10  1.1965779e-13  0              3.3654558    
   2600000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     2.7134774e-17  0              2.6204823e-12  1.1965779e-13  0              3.3654558    
   2700000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     4.5954095e-17  0              4.4379176e-12  1.1965779e-13  0              3.3654558    
   2800000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     5.3773301e-18  0              5.1930405e-13  1.1965779e-13  0              3.3654558    
   2900000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     6.0121353e-18  0              5.8060899e-13  1.1965779e-13  0              3.3654558    
   3000000   6363.961       200            200            0.0035522096  -0.0025773511   0              0.01323398     1.0395188e-19  0              1.0038928e-14  1.1965779e-13  0              3.3654558    
Loop time of 285.525 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9078020.257 ns/day, 0.000 hours/ns, 10506.968 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.083     | 37.451     | 64.227     | 428.8 | 13.12
Neigh   | 1.656      | 1.6737     | 1.6907     |   1.0 |  0.59
Comm    | 12.162     | 18.096     | 23.35      | 115.1 |  6.34
Output  | 0.23865    | 0.23897    | 0.23932    |   0.1 |  0.08
Modify  | 168.1      | 172.8      | 178        |  31.4 | 60.52
Other   |            | 55.27      |            |       | 19.36

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         332.75 ave         666 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1331
Ave neighs/atom = 0.53218713
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.75                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.7456392002713
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.85
  ghost atom cutoff = 3.85
  binsize = 1.925, bins = 3306 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 50.47 | 50.48 | 50.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.21500122    -0.060093763    0              0.70509742     145757.85      0              1.407625e+10   1.1965779e-13  0              3.3414626    
    200000   6363.961       200            200           -0.00039985884 -1.52316e-34    0             -0.0011995765   59753.925      0              5.7706064e+09  1.1965779e-13  0              3.4820879    
    300000   6363.961       200            200           -0.00019935602  1.4346786e-40  0             -0.00059806805  10368.88       0              1.0013522e+09  1.1965779e-13  0              3.402505     
    400000   6363.961       200            200            0.0028902039  -0.0043006343   0              0.012971246    8463.5941      0              8.1735334e+08  1.1965779e-13  0              3.3704136    
    500000   6363.961       200            200            0.0029548827  -0.0013251324   0              0.01018978     1231.1486      0              1.1889552e+08  1.1965779e-13  0              3.37107      
    600000   6363.961       200            200            0.0025247472  -0.0024410978   0              0.010015339    102.80742      0              9928404.4      1.1965779e-13  0              3.3710432    
    700000   6363.961       200            200            0.0038219018  -0.0025359847   0              0.01400169     19.860735      0              1918007.6      1.1965779e-13  0              3.3703263    
    800000   6363.961       200            200            0.0037760892  -0.0025993657   0              0.013927633    0.23788731     0              22973.454      1.1965779e-13  0              3.3703432    
    900000   6363.961       200            200            0.0036285623  -0.0025833751   0              0.013469062    0.12906534     0              12464.207      1.1965779e-13  0              3.3704222    
   1000000   6363.961       200            200            0.0035632643  -0.0025776948   0              0.013267488    0.056483287    0              5454.7515      1.1965779e-13  0              3.3704567    
   1100000   6363.961       200            200            0.0035516118  -0.0025765888   0              0.013231424    0.004470841    0              431.76182      1.1965779e-13  0              3.3704627    
   1200000   6363.961       200            200            0.0035546967  -0.0025769073   0              0.013240997    1.6754213e-07  0              0.016180019    1.1965779e-13  0              3.370461     
   1300000   6363.961       200            200            0.0035577663  -0.0025772108   0              0.01325051     7.7726517e-05  0              7.5062707      1.1965779e-13  0              3.3704594    
   1400000   6363.961       200            200            0.0035588398  -0.0025773151   0              0.013253835    1.876406e-05   0              1.8120986      1.1965779e-13  0              3.3704588    
   1500000   6363.961       200            200            0.0035589467  -0.0025773249   0              0.013254165    8.3308052e-07  0              0.080452954    1.1965779e-13  0              3.3704587    
   1600000   6363.961       200            200            0.0035588538  -0.0025773155   0              0.013253877    1.9928924e-08  0              0.0019245928   1.1965779e-13  0              3.3704588    
   1700000   6363.961       200            200            0.0035587943  -0.0025773097   0              0.013253693    3.6675073e-08  0              0.003541816    1.1965779e-13  0              3.3704588    
   1800000   6363.961       200            200            0.003558778   -0.0025773081   0              0.013253642    5.4558067e-09  0              0.00052688276  1.1965779e-13  0              3.3704588    
   1900000   6363.961       200            200            0.0035587781  -0.0025773081   0              0.013253643    1.0028193e-10  0              9.6845108e-06  1.1965779e-13  0              3.3704588    
   2000000   6363.961       200            200            0.0035587804  -0.0025773084   0              0.013253649    2.6001918e-11  0              2.5110791e-06  1.1965779e-13  0              3.3704588    
   2100000   6363.961       200            200            0.0035587814  -0.0025773085   0              0.013253653    1.4616573e-11  0              1.411564e-06   1.1965779e-13  0              3.3704588    
   2200000   6363.961       200            200            0.0035587817  -0.0025773085   0              0.013253653    1.3619636e-12  0              1.315287e-07   1.1965779e-13  0              3.3704588    
   2300000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    2.5631369e-15  0              2.4752942e-10  1.1965779e-13  0              3.3704588    
   2400000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    1.7892703e-14  0              1.7279491e-09  1.1965779e-13  0              3.3704588    
   2500000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    5.0683993e-15  0              4.8946973e-10  1.1965779e-13  0              3.3704588    
   2600000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    2.9828278e-16  0              2.8806015e-11  1.1965779e-13  0              3.3704588    
   2700000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    3.5457491e-18  0              3.4242306e-13  1.1965779e-13  0              3.3704588    
   2800000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    6.4217506e-19  0              6.2016671e-14  1.1965779e-13  0              3.3704588    
   2900000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    3.6313329e-19  0              3.5068813e-14  1.1965779e-13  0              3.3704588    
   3000000   6363.961       200            200            0.0035587816  -0.0025773085   0              0.013253653    2.7194826e-18  0              2.6262817e-13  1.1965779e-13  0              3.3704588    
Loop time of 283.521 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9142178.880 ns/day, 0.000 hours/ns, 10581.226 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.929     | 37.603     | 64.92      | 431.7 | 13.26
Neigh   | 1.6226     | 1.6386     | 1.6543     |   0.9 |  0.58
Comm    | 12.376     | 17.296     | 21.338     |  92.6 |  6.10
Output  | 0.2399     | 0.24022    | 0.24057    |   0.1 |  0.08
Modify  | 166.39     | 171.6      | 176.46     |  34.5 | 60.53
Other   |            | 55.14      |            |       | 19.45

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.75 ave         672 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1343
Ave neighs/atom = 0.53698521
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.76                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.2329013727605
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.86
  ghost atom cutoff = 3.86
  binsize = 1.93, bins = 3298 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 50.38 | 50.39 | 50.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.17271414    -0.066780251    0              0.58492266     290364.59      0              2.8041333e+10  1.1965779e-13  0              3.3495114    
    200000   6363.961       200            200           -0.0003956846   1.0154729e-34  0             -0.0011870538   57213.918      0              5.5253107e+09  1.1965779e-13  0              3.4892817    
    300000   6363.961       200            200           -0.00019011053  7.9829859e-44  0             -0.00057033158  9250.9115      0              8.9338682e+08  1.1965779e-13  0              3.4085647    
    400000   6363.961       200            200            0.0016323818  -0.0025300647   0              0.00742721     8201.4868      0              7.9204089e+08  1.1965779e-13  0              3.3764898    
    500000   6363.961       200            200            0.003683282   -0.001679765    0              0.012729611    1297.4644      0              1.2529982e+08  1.1965779e-13  0              3.3756007    
    600000   6363.961       200            200            0.0023579083  -0.0022531467   0              0.0093268716   64.063992      0              6186841.8      1.1965779e-13  0              3.3761895    
    700000   6363.961       200            200            0.0036610562  -0.0025359818   0              0.01351915     23.085249      0              2229408.1      1.1965779e-13  0              3.3754142    
    800000   6363.961       200            200            0.0037527965  -0.0025963121   0              0.013854702    0.96929389     0              93607.466      1.1965779e-13  0              3.3753615    
    900000   6363.961       200            200            0.0036455478  -0.0025865089   0              0.013523152    0.023950348    0              2312.9532      1.1965779e-13  0              3.3754191    
   1000000   6363.961       200            200            0.0035804558  -0.0025789843   0              0.013320352    0.043488421    0              4199.8004      1.1965779e-13  0              3.375454     
   1100000   6363.961       200            200            0.0035620779  -0.0025772062   0              0.01326344     0.0070702831   0              682.79733      1.1965779e-13  0              3.3754636    
   1200000   6363.961       200            200            0.0035616112  -0.0025771757   0              0.013262009    0.00020319469  0              19.623089      1.1965779e-13  0              3.3754638    
   1300000   6363.961       200            200            0.0035638521  -0.0025774012   0              0.013268957    1.7264448e-05  0              1.6672768      1.1965779e-13  0              3.3754626    
   1400000   6363.961       200            200            0.0035650442  -0.0025775189   0              0.013272652    1.6115729e-05  0              1.5563417      1.1965779e-13  0              3.3754619    
   1500000   6363.961       200            200            0.0035653426  -0.0025775477   0              0.013273575    2.1367914e-06  0              0.20635602     1.1965779e-13  0              3.3754618    
   1600000   6363.961       200            200            0.0035653321  -0.0025775464   0              0.013273543    3.8059992e-08  0              0.0036755616   1.1965779e-13  0              3.3754618    
   1700000   6363.961       200            200            0.0035652867  -0.0025775419   0              0.013273402    9.758355e-09   0              0.00094239208  1.1965779e-13  0              3.3754618    
   1800000   6363.961       200            200            0.0035652652  -0.0025775398   0              0.013273335    5.783447e-09   0              0.00055852391  1.1965779e-13  0              3.3754618    
   1900000   6363.961       200            200            0.0035652605  -0.0025775393   0              0.013273321    6.2433287e-10  0              6.02936e-05    1.1965779e-13  0              3.3754618    
   2000000   6363.961       200            200            0.003565261   -0.0025775394   0              0.013273322    5.4440517e-12  0              5.2574755e-07  1.1965779e-13  0              3.3754618    
   2100000   6363.961       200            200            0.0035652619  -0.0025775395   0              0.013273325    4.8118834e-12  0              4.6469726e-07  1.1965779e-13  0              3.3754618    
   2200000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273326    2.0137776e-12  0              1.9447623e-07  1.1965779e-13  0              3.3754618    
   2300000   6363.961       200            200            0.0035652624  -0.0025775395   0              0.013273327    1.7566574e-13  0              1.696454e-08   1.1965779e-13  0              3.3754618    
   2400000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273327    3.3687901e-16  0              3.2533363e-11  1.1965779e-13  0              3.3754618    
   2500000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273326    2.2011168e-15  0              2.1256811e-10  1.1965779e-13  0              3.3754618    
   2600000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273326    6.8164777e-16  0              6.5828663e-11  1.1965779e-13  0              3.3754618    
   2700000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273326    7.2495711e-17  0              7.0011169e-12  1.1965779e-13  0              3.3754618    
   2800000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273326    1.0825958e-17  0              1.0454936e-12  1.1965779e-13  0              3.3754618    
   2900000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273326    1.4892579e-18  0              1.4382187e-13  1.1965779e-13  0              3.3754618    
   3000000   6363.961       200            200            0.0035652623  -0.0025775395   0              0.013273326    6.6798477e-18  0              6.4509188e-13  1.1965779e-13  0              3.3754618    
Loop time of 283.756 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9134619.164 ns/day, 0.000 hours/ns, 10572.476 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.934     | 37.673     | 64.823     | 432.3 | 13.28
Neigh   | 1.6238     | 1.6394     | 1.6549     |   0.9 |  0.58
Comm    | 12.466     | 17.381     | 21.599     |  91.1 |  6.13
Output  | 0.24093    | 0.24125    | 0.2416     |   0.1 |  0.09
Modify  | 166.23     | 171.53     | 177.22     |  36.4 | 60.45
Other   |            | 55.3       |            |       | 19.49

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.25 ave         677 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1353
Ave neighs/atom = 0.54098361
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.77                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.7227622706926
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.87
  ghost atom cutoff = 3.87
  binsize = 1.935, bins = 3289 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 50.32 | 50.33 | 50.33 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.12716028    -0.063204875    0              0.44468571     439082.9       0              4.2403484e+10  1.1965779e-13  0              3.3584832    
    200000   6363.961       200            200           -0.0003913146   1.5231986e-34  0             -0.0011739438   54731.356      0              5.2855626e+09  1.1965779e-13  0              3.4964293    
    300000   6363.961       200            200           -0.0001806615   4.4718478e-40  0             -0.00054198449  8197.8993      0              7.9169443e+08  1.1965779e-13  0              3.4145653    
    400000   6363.961       200            200            0.00077260365 -0.0011012181   0              0.003419029    7569.472       0              7.3100543e+08  1.1965779e-13  0              3.3825376    
    500000   6363.961       200            200            0.0045151371  -0.0020265026   0              0.015571914    1268.2879      0              1.2248216e+08  1.1965779e-13  0              3.3801271    
    600000   6363.961       200            200            0.0022272543  -0.002154903    0              0.0088366661   30.334516      0              2929490.4      1.1965779e-13  0              3.3812994    
    700000   6363.961       200            200            0.00349206    -0.0025506436   0              0.013026823    23.056763      0              2226657.1      1.1965779e-13  0              3.3805053    
    800000   6363.961       200            200            0.0037117905  -0.0025913399   0              0.013726712    1.9218233      0              185595.94      1.1965779e-13  0              3.3803892    
    900000   6363.961       200            200            0.0036537116  -0.0025870308   0              0.013548166    0.0045157666   0              436.10042      1.1965779e-13  0              3.380421     
   1000000   6363.961       200            200            0.0035956619  -0.0025796998   0              0.013366686    0.022619061    0              2184.387       1.1965779e-13  0              3.3804523    
   1100000   6363.961       200            200            0.003573196   -0.0025775133   0              0.013297101    0.0076279631   0              736.65408      1.1965779e-13  0              3.3804642    
   1200000   6363.961       200            200            0.0035693562  -0.0025771477   0              0.013285216    0.00063955259  0              61.763411      1.1965779e-13  0              3.3804662    
   1300000   6363.961       200            200            0.0035703773  -0.002577254    0              0.013288386    2.0132454e-06  0              0.19442483     1.1965779e-13  0              3.3804656    
   1400000   6363.961       200            200            0.0035714279  -0.0025773588   0              0.013291642    7.1237968e-06  0              0.68796531     1.1965779e-13  0              3.380465     
   1500000   6363.961       200            200            0.0035718382  -0.0025773991   0              0.013292914    2.5070547e-06  0              0.2421134      1.1965779e-13  0              3.3804648    
   1600000   6363.961       200            200            0.0035719106  -0.002577406    0              0.013293138    2.1720548e-07  0              0.020976151    1.1965779e-13  0              3.3804648    
   1700000   6363.961       200            200            0.0035718931  -0.0025774042   0              0.013293083    8.7889378e-10  0              8.4877271e-05  1.1965779e-13  0              3.3804648    
   1800000   6363.961       200            200            0.0035718741  -0.0025774023   0              0.013293025    2.2428457e-09  0              0.00021659799  1.1965779e-13  0              3.3804648    
   1900000   6363.961       200            200            0.0035718666  -0.0025774015   0              0.013293001    8.2352019e-10  0              7.9529686e-05  1.1965779e-13  0              3.3804648    
   2000000   6363.961       200            200            0.0035718653  -0.0025774014   0              0.013292997    7.3674827e-11  0              7.1149875e-06  1.1965779e-13  0              3.3804648    
   2100000   6363.961       200            200            0.0035718656  -0.0025774014   0              0.013292998    3.699575e-13   0              3.5727847e-08  1.1965779e-13  0              3.3804648    
   2200000   6363.961       200            200            0.0035718659  -0.0025774015   0              0.013292999    7.0502429e-13  0              6.8086199e-08  1.1965779e-13  0              3.3804648    
   2300000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       2.7024322e-13  0              2.6098156e-08  1.1965779e-13  0              3.3804648    
   2400000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       2.5222541e-14  0              2.4358125e-09  1.1965779e-13  0              3.3804648    
   2500000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       1.5909056e-16  0              1.5363828e-11  1.1965779e-13  0              3.3804648    
   2600000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       1.9490302e-16  0              1.8822338e-11  1.1965779e-13  0              3.3804648    
   2700000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       6.298961e-17   0              6.0830857e-12  1.1965779e-13  0              3.3804648    
   2800000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       5.9301604e-18  0              5.7269245e-13  1.1965779e-13  0              3.3804648    
   2900000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       2.5530688e-18  0              2.4655711e-13  1.1965779e-13  0              3.3804648    
   3000000   6363.961       200            200            0.0035718661  -0.0025774015   0              0.013293       7.1305395e-18  0              6.8861647e-13  1.1965779e-13  0              3.3804648    
Loop time of 282.475 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9176044.814 ns/day, 0.000 hours/ns, 10620.422 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.937     | 37.661     | 64.92      | 432.3 | 13.33
Neigh   | 1.6068     | 1.6242     | 1.6406     |   1.0 |  0.57
Comm    | 12.266     | 17.25      | 21.428     |  92.9 |  6.11
Output  | 0.24084    | 0.24119    | 0.24156    |   0.1 |  0.09
Modify  | 165.66     | 170.73     | 176.22     |  34.3 | 60.44
Other   |            | 54.97      |            |       | 19.46

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         341.25 ave         683 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1365
Ave neighs/atom = 0.54578169
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.78                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.2152288055716
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.88
  ghost atom cutoff = 3.88
  binsize = 1.94, bins = 3281 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 50.23 | 50.23 | 50.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.083402362   -0.053549623    0              0.30375671     563496.38      0              5.4418447e+10  1.1965779e-13  0              3.3681508    
    200000   6363.961       200            200           -0.00038674978 -1.0154484e-34  0             -0.0011602493   52306.084      0              5.0513472e+09  1.1965779e-13  0              3.5035305    
    300000   6363.961       200            200           -0.00017101023 -2.5386442e-34  0             -0.0005130307   7209.6187      0              6.9625336e+08  1.1965779e-13  0              3.4205065    
    400000   6363.961       200            200            0.00019040403 -0.00032587616  0              0.00089708826  6722.6842      0              6.4922873e+08  1.1965779e-13  0              3.3885359    
    500000   6363.961       200            200            0.0053893559  -0.0024249351   0              0.018593003    1138.6317      0              1.0996089e+08  1.1965779e-13  0              3.3846679    
    600000   6363.961       200            200            0.0021405195  -0.0021316812   0              0.0085532398   7.6779098      0              741477.57      1.1965779e-13  0              3.386368     
    700000   6363.961       200            200            0.0033341006  -0.0025592046   0              0.012561506    19.840097      0              1916014.6      1.1965779e-13  0              3.3855933    
    800000   6363.961       200            200            0.0036574668  -0.0025860537   0              0.013558454    2.7413089      0              264735.99      1.1965779e-13  0              3.3854239    
    900000   6363.961       200            200            0.0036522528  -0.0025866773   0              0.013543436    0.078823084    0              7612.1692      1.1965779e-13  0              3.385428     
   1000000   6363.961       200            200            0.003607389   -0.0025805774   0              0.013402744    0.0051029419   0              492.8056       1.1965779e-13  0              3.3854524    
   1100000   6363.961       200            200            0.0035839347  -0.0025782885   0              0.013330093    0.0057984729   0              559.97501      1.1965779e-13  0              3.3854649    
   1200000   6363.961       200            200            0.0035774245  -0.0025776571   0              0.013309931    0.00098575796  0              95.197448      1.1965779e-13  0              3.3854683    
   1300000   6363.961       200            200            0.0035770731  -0.0025776279   0              0.013308847    4.4281378e-05  0              4.2763785      1.1965779e-13  0              3.3854685    
   1400000   6363.961       200            200            0.0035777612  -0.0025776975   0              0.013310981    4.1818724e-07  0              0.040385531    1.1965779e-13  0              3.3854681    
   1500000   6363.961       200            200            0.0035781794  -0.0025777389   0              0.013312277    1.5511344e-06  0              0.14979746     1.1965779e-13  0              3.3854679    
   1600000   6363.961       200            200            0.0035783119  -0.0025777518   0              0.013312688    3.4091448e-07  0              0.032923081    1.1965779e-13  0              3.3854678    
   1700000   6363.961       200            200            0.003578327   -0.0025777532   0              0.013312734    2.1524874e-08  0              0.0020787183   1.1965779e-13  0              3.3854678    
   1800000   6363.961       200            200            0.0035783172  -0.0025777522   0              0.013312704    1.1944193e-13  0              1.1534847e-08  1.1965779e-13  0              3.3854678    
   1900000   6363.961       200            200            0.0035783099  -0.0025777515   0              0.013312681    3.8376942e-10  0              3.7061704e-05  1.1965779e-13  0              3.3854678    
   2000000   6363.961       200            200            0.0035783073  -0.0025777512   0              0.013312673    1.1240263e-10  0              1.0855042e-05  1.1965779e-13  0              3.3854678    
   2100000   6363.961       200            200            0.0035783069  -0.0025777512   0              0.013312672    9.4357447e-12  0              9.1123668e-07  1.1965779e-13  0              3.3854678    
   2200000   6363.961       200            200            0.003578307   -0.0025777512   0              0.013312672    5.1116111e-14  0              4.9364282e-09  1.1965779e-13  0              3.3854678    
   2300000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    8.5631776e-14  0              8.269704e-09   1.1965779e-13  0              3.3854678    
   2400000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    3.5322992e-14  0              3.4112417e-09  1.1965779e-13  0              3.3854678    
   2500000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    3.8041807e-15  0              3.6738054e-10  1.1965779e-13  0              3.3854678    
   2600000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    7.426477e-17   0              7.17196e-12    1.1965779e-13  0              3.3854678    
   2700000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    1.5603724e-18  0              1.506896e-13   1.1965779e-13  0              3.3854678    
   2800000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    8.883988e-21   0              8.5795197e-16  1.1965779e-13  0              3.3854678    
   2900000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    6.354689e-18   0              6.1369038e-13  1.1965779e-13  0              3.3854678    
   3000000   6363.961       200            200            0.0035783072  -0.0025777512   0              0.013312673    1.3591837e-18  0              1.3126024e-13  1.1965779e-13  0              3.3854678    
Loop time of 284.669 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9105296.318 ns/day, 0.000 hours/ns, 10538.537 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.97      | 37.998     | 65.66      | 434.8 | 13.35
Neigh   | 1.6106     | 1.6276     | 1.6438     |   0.9 |  0.57
Comm    | 12.29      | 17.331     | 21.34      |  92.2 |  6.09
Output  | 0.24144    | 0.24175    | 0.24209    |   0.1 |  0.08
Modify  | 167.64     | 172.54     | 177.74     |  32.8 | 60.61
Other   |            | 54.94      |            |       | 19.30

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.75 ave         688 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1375
Ave neighs/atom = 0.54978009
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.79                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.7103078889014
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.89
  ghost atom cutoff = 3.89
  binsize = 1.945, bins = 3272 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.41 | 49.42 | 49.42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.047244183   -0.036951643    0              0.17868419     648148.66      0              6.2593558e+10  1.1965779e-13  0              3.3782861    
    200000   6363.961       200            200           -0.00038199103  2.5387218e-35  0             -0.0011459731   49937.936      0              4.8226484e+09  1.1965779e-13  0              3.5105852    
    300000   6363.961       200            200           -0.00016115799 -1.015441e-34   0             -0.00048347397  6285.8401      0              6.0704145e+08  1.1965779e-13  0              3.4263883    
    400000   6363.961       200            200           -0.00010270491 -3.0638915e-05  0             -0.00027747581  5801.1731      0              5.6023577e+08  1.1965779e-13  0              3.3944712    
    500000   6363.961       200            200            0.0063091682  -0.0027122968   0              0.021639801    921.56463      0              88998115       1.1965779e-13  0              3.3892431    
    600000   6363.961       200            200            0.0021246188  -0.0021068774   0              0.0084807337   0.0067761723   0              654.39421      1.1965779e-13  0              3.3913925    
    700000   6363.961       200            200            0.0031915048  -0.0025819199   0              0.012156434    14.386543      0              1389349.4      1.1965779e-13  0              3.390672     
    800000   6363.961       200            200            0.0035972548  -0.0025763107   0              0.013368075    3.1273364      0              302015.76      1.1965779e-13  0              3.3904626    
    900000   6363.961       200            200            0.0036418767  -0.0025862058   0              0.013511836    0.21261534     0              20532.867      1.1965779e-13  0              3.3904396    
   1000000   6363.961       200            200            0.0036147044  -0.0025821087   0              0.013426222    0.00029801433  0              28.780091      1.1965779e-13  0              3.3904547    
   1100000   6363.961       200            200            0.003593398   -0.0025800164   0              0.01336021     0.0027480602   0              265.38799      1.1965779e-13  0              3.390466     
   1200000   6363.961       200            200            0.0035853166  -0.0025792256   0              0.013335175    0.00098754429  0              95.369959      1.1965779e-13  0              3.3904703    
   1300000   6363.961       200            200            0.0035836974  -0.0025790704   0              0.013330163    0.00010788521  0              10.418781      1.1965779e-13  0              3.3904711    
   1400000   6363.961       200            200            0.003583887   -0.0025790911   0              0.013330752    2.3485528e-06  0              0.22680642     1.1965779e-13  0              3.390471     
   1500000   6363.961       200            200            0.0035842105  -0.0025791235   0              0.013331755    3.0143867e-07  0              0.029110789    1.1965779e-13  0              3.3904709    
   1600000   6363.961       200            200            0.0035843647  -0.0025791387   0              0.013332233    2.6160923e-07  0              0.025264347    1.1965779e-13  0              3.3904708    
   1700000   6363.961       200            200            0.0035844066  -0.0025791428   0              0.013332363    4.4115378e-08  0              0.0042603475   1.1965779e-13  0              3.3904708    
   1800000   6363.961       200            200            0.0035844092  -0.002579143    0              0.013332371    2.2750218e-09  0              0.00021970532  1.1965779e-13  0              3.3904708    
   1900000   6363.961       200            200            0.0035844049  -0.0025791426   0              0.013332357    3.3247968e-12  0              3.2108507e-07  1.1965779e-13  0              3.3904708    
   2000000   6363.961       200            200            0.0035844022  -0.0025791423   0              0.013332349    5.5380062e-11  0              5.34821e-06    1.1965779e-13  0              3.3904708    
   2100000   6363.961       200            200            0.0035844013  -0.0025791423   0              0.013332346    1.5107903e-11  0              1.4590131e-06  1.1965779e-13  0              3.3904708    
   2200000   6363.961       200            200            0.0035844012  -0.0025791422   0              0.013332346    1.3346257e-12  0              1.2888859e-07  1.1965779e-13  0              3.3904708    
   2300000   6363.961       200            200            0.0035844012  -0.0025791422   0              0.013332346    1.386678e-14   0              1.3391543e-09  1.1965779e-13  0              3.3904708    
   2400000   6363.961       200            200            0.0035844012  -0.0025791422   0              0.013332346    8.1442511e-15  0              7.8651348e-10  1.1965779e-13  0              3.3904708    
   2500000   6363.961       200            200            0.0035844013  -0.0025791422   0              0.013332346    4.3280287e-15  0              4.1797004e-10  1.1965779e-13  0              3.3904708    
   2600000   6363.961       200            200            0.0035844013  -0.0025791422   0              0.013332346    6.165178e-16   0              5.9538876e-11  1.1965779e-13  0              3.3904708    
   2700000   6363.961       200            200            0.0035844013  -0.0025791422   0              0.013332346    5.4042745e-17  0              5.2190615e-12  1.1965779e-13  0              3.3904708    
   2800000   6363.961       200            200            0.0035844013  -0.0025791422   0              0.013332346    1.0082127e-17  0              9.7365961e-13  1.1965779e-13  0              3.3904708    
   2900000   6363.961       200            200            0.0035844013  -0.0025791422   0              0.013332346    4.7367021e-19  0              4.5743679e-14  1.1965779e-13  0              3.3904708    
   3000000   6363.961       200            200            0.0035844013  -0.0025791422   0              0.013332346    1.3442021e-18  0              1.2981342e-13  1.1965779e-13  0              3.3904708    
Loop time of 282.983 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9159562.572 ns/day, 0.000 hours/ns, 10601.346 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.891     | 38.206     | 65.833     | 437.7 | 13.50
Neigh   | 1.5757     | 1.5922     | 1.6084     |   0.9 |  0.56
Comm    | 12.269     | 17.216     | 21.446     |  90.8 |  6.08
Output  | 0.24267    | 0.243      | 0.24336    |   0.1 |  0.09
Modify  | 166.56     | 170.99     | 175.69     |  29.4 | 60.42
Other   |            | 54.74      |            |       | 19.34

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.75 ave         694 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1387
Ave neighs/atom = 0.55457817
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.8                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.2080064321856
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.9
  ghost atom cutoff = 3.9
  binsize = 1.95, bins = 3264 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.32 | 49.33 | 49.33 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.020714943   -0.020181255    0              0.082326084    691666.83      0              6.6796231e+10  1.1965779e-13  0              3.3886863    
    200000   6363.961       200            200           -0.00037703933 -1.5231792e-34  0             -0.001131118    47626.776      0              4.5994532e+09  1.1965779e-13  0              3.5175935    
    300000   6363.961       200            200           -0.00015110614  5.0538267e-41  0             -0.00045331842  5426.346       0              5.2403765e+08  1.1965779e-13  0              3.4322106    
    400000   6363.961       200            200           -0.00014292015  1.2693374e-35  0             -0.00042876044  4908.4707      0              4.7402497e+08  1.1965779e-13  0              3.4003369    
    500000   6363.961       200            200            0.0071684612  -0.0029868634   0              0.024492247    649.96479      0              62768947       1.1965779e-13  0              3.3938726    
    600000   6363.961       200            200            0.0021686631  -0.0021143333   0              0.0086203227   8.5660807      0              827250.76      1.1965779e-13  0              3.396372     
    700000   6363.961       200            200            0.0030836567  -0.0025878821   0              0.011838852    8.233757       0              795157.31      1.1965779e-13  0              3.3957363    
    800000   6363.961       200            200            0.0035395719  -0.0025568833   0              0.013175599    2.9424121      0              284157.1       1.1965779e-13  0              3.395502     
    900000   6363.961       200            200            0.0036253321  -0.0025834183   0              0.013459415    0.34507064     0              33324.453      1.1965779e-13  0              3.3954547    
   1000000   6363.961       200            200            0.003618275   -0.002581756    0              0.013436581    0.010669773    0              1030.4103      1.1965779e-13  0              3.3954592    
   1100000   6363.961       200            200            0.0036018669  -0.0025801282   0              0.013385729    0.00040504029  0              39.115892      1.1965779e-13  0              3.395468     
   1200000   6363.961       200            200            0.0035935229  -0.0025793065   0              0.013359875    0.00064519448  0              62.308265      1.1965779e-13  0              3.3954724    
   1300000   6363.961       200            200            0.0035909689  -0.0025790575   0              0.013351964    0.00013912371  0              13.435572      1.1965779e-13  0              3.3954737    
   1400000   6363.961       200            200            0.0035906342  -0.0025790263   0              0.013350929    1.0979043e-05  0              1.0602774      1.1965779e-13  0              3.3954739    
   1500000   6363.961       200            200            0.0035907872  -0.0025790421   0              0.013351404    9.1619118e-08  0              0.0088479186   1.1965779e-13  0              3.3954738    
   1600000   6363.961       200            200            0.0035909198  -0.0025790553   0              0.013351815    7.4939897e-08  0              0.0072371588   1.1965779e-13  0              3.3954737    
   1700000   6363.961       200            200            0.0035909748  -0.0025790608   0              0.013351985    3.8872514e-08  0              0.0037540291   1.1965779e-13  0              3.3954737    
   1800000   6363.961       200            200            0.0035909884  -0.0025790621   0              0.013352027    5.7324825e-09  0              0.00055360213  1.1965779e-13  0              3.3954737    
   1900000   6363.961       200            200            0.0035909888  -0.0025790621   0              0.013352028    2.7788352e-10  0              2.6836001e-05  1.1965779e-13  0              3.3954737    
   2000000   6363.961       200            200            0.0035909871  -0.0025790619   0              0.013352023    4.689306e-13   0              4.5285961e-08  1.1965779e-13  0              3.3954737    
   2100000   6363.961       200            200            0.0035909862  -0.0025790618   0              0.01335202     6.9598064e-12  0              6.7212828e-07  1.1965779e-13  0              3.3954737    
   2200000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    2.0011056e-12  0              1.9325246e-07  1.1965779e-13  0              3.3954737    
   2300000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    2.0464945e-13  0              1.9763579e-08  1.1965779e-13  0              3.3954737    
   2400000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    4.3796201e-15  0              4.2295236e-10  1.1965779e-13  0              3.3954737    
   2500000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    4.9592314e-16  0              4.7892708e-11  1.1965779e-13  0              3.3954737    
   2600000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    4.5952475e-16  0              4.4377611e-11  1.1965779e-13  0              3.3954737    
   2700000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    8.4521283e-17  0              8.1624606e-12  1.1965779e-13  0              3.3954737    
   2800000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    8.6980811e-18  0              8.3999842e-13  1.1965779e-13  0              3.3954737    
   2900000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    1.8186416e-18  0              1.7563139e-13  1.1965779e-13  0              3.3954737    
   3000000   6363.961       200            200            0.0035909858  -0.0025790618   0              0.013352019    7.0004834e-18  0              6.7605658e-13  1.1965779e-13  0              3.3954737    
Loop time of 284.13 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9122589.200 ns/day, 0.000 hours/ns, 10558.552 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.95      | 38.271     | 65.894     | 438.6 | 13.47
Neigh   | 1.59       | 1.6071     | 1.6235     |   1.0 |  0.57
Comm    | 12.423     | 17.305     | 21.635     |  91.1 |  6.09
Output  | 0.23935    | 0.23968    | 0.24005    |   0.1 |  0.08
Modify  | 167.4      | 171.73     | 176.39     |  29.3 | 60.44
Other   |            | 54.97      |            |       | 19.35

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         348.75 ave         698 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1395
Ave neighs/atom = 0.55777689
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.81                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.7083313469284
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.91
  ghost atom cutoff = 3.91
  binsize = 1.955, bins = 3256 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.23 | 49.24 | 49.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200            0.0049620992  -0.0069338667   0              0.021820164    703407.1       0              6.7930023e+10  1.1965779e-13  0              3.3991952    
    200000   6363.961       200            200           -0.00037189556 -1.0154494e-34  0             -0.0011156867   45372.436      0              4.3817451e+09  1.1965779e-13  0              3.5245552    
    300000   6363.961       200            200           -0.00014085592  2.5386593e-35  0             -0.00042256775  4630.9071      0              4.4721986e+08  1.1965779e-13  0              3.4379733    
    400000   6363.961       200            200           -0.00013172506  2.0309226e-34  0             -0.00039517517  4089.3666      0              3.9492176e+08  1.1965779e-13  0              3.4061317    
    500000   6363.961       200            200            0.0078670254  -0.0033215954   0              0.026922671    372.79667      0              36002034       1.1965779e-13  0              3.3985756    
    600000   6363.961       200            200            0.0022783011  -0.002136537    0              0.0089714404   31.780031      0              3069087.9      1.1965779e-13  0              3.4013075    
    700000   6363.961       200            200            0.0030113453  -0.0025944296   0              0.011628466    3.0667538      0              296165.14      1.1965779e-13  0              3.4007818    
    800000   6363.961       200            200            0.0034818968  -0.0025550561   0              0.013000747    2.2586905      0              218128.16      1.1965779e-13  0              3.4005386    
    900000   6363.961       200            200            0.0036052365  -0.0025789249   0              0.013394634    0.41643419     0              40216.233      1.1965779e-13  0              3.400472     
   1000000   6363.961       200            200            0.0036186188  -0.0025792726   0              0.013435129    0.03051292     0              2946.7194      1.1965779e-13  0              3.4004656    
   1100000   6363.961       200            200            0.0036091247  -0.0025783099   0              0.013405684    0.00023672338  0              22.861049      1.1965779e-13  0              3.4004708    
   1200000   6363.961       200            200            0.0036018254  -0.0025775863   0              0.013383062    0.00021058177  0              20.33648       1.1965779e-13  0              3.4004747    
   1300000   6363.961       200            200            0.0035988286  -0.0025772918   0              0.013373778    0.00011194162  0              10.810521      1.1965779e-13  0              3.4004763    
   1400000   6363.961       200            200            0.0035980552  -0.0025772169   0              0.013371382    1.8039123e-05  0              1.7420894      1.1965779e-13  0              3.4004767    
   1500000   6363.961       200            200            0.0035980056  -0.0025772127   0              0.01337123     1.1322092e-06  0              0.10934066     1.1965779e-13  0              3.4004767    
   1600000   6363.961       200            200            0.0035980808  -0.0025772204   0              0.013371463    2.6372925e-09  0              0.00025469084  1.1965779e-13  0              3.4004767    
   1700000   6363.961       200            200            0.0035981315  -0.0025772254   0              0.01337162     1.2841205e-08  0              0.0012401117   1.1965779e-13  0              3.4004767    
   1800000   6363.961       200            200            0.0035981512  -0.0025772273   0              0.013371681    5.3818503e-09  0              0.00051974058  1.1965779e-13  0              3.4004767    
   1900000   6363.961       200            200            0.0035981558  -0.0025772278   0              0.013371695    7.6932374e-10  0              7.429578e-05   1.1965779e-13  0              3.4004767    
   2000000   6363.961       200            200            0.0035981559  -0.0025772278   0              0.013371696    4.0621624e-11  0              3.9229456e-06  1.1965779e-13  0              3.4004767    
   2100000   6363.961       200            200            0.0035981553  -0.0025772277   0              0.013371694    6.4578058e-18  0              6.2364866e-13  1.1965779e-13  0              3.4004767    
   2200000   6363.961       200            200            0.003598155   -0.0025772277   0              0.013371693    7.3944428e-13  0              7.1410236e-08  1.1965779e-13  0              3.4004767    
   2300000   6363.961       200            200            0.0035981549  -0.0025772277   0              0.013371692    2.5435396e-13  0              2.4563685e-08  1.1965779e-13  0              3.4004767    
   2400000   6363.961       200            200            0.0035981548  -0.0025772277   0              0.013371692    3.2133092e-14  0              3.1031841e-09  1.1965779e-13  0              3.4004767    
   2500000   6363.961       200            200            0.0035981548  -0.0025772277   0              0.013371692    1.3530316e-15  0              1.3066611e-10  1.1965779e-13  0              3.4004767    
   2600000   6363.961       200            200            0.0035981548  -0.0025772277   0              0.013371692    2.4922256e-18  0              2.4068131e-13  1.1965779e-13  0              3.4004767    
   2700000   6363.961       200            200            0.0035981548  -0.0025772277   0              0.013371692    1.154333e-17   0              1.1147722e-12  1.1965779e-13  0              3.4004767    
   2800000   6363.961       200            200            0.0035981548  -0.0025772277   0              0.013371692    1.9406613e-19  0              1.8741518e-14  1.1965779e-13  0              3.4004767    
   2900000   6363.961       200            200            0.0035981548  -0.0025772277   0              0.013371692    7.0647003e-18  0              6.8225819e-13  1.1965779e-13  0              3.4004767    
   3000000   6363.961       200            200            0.0035981548  -0.0025772277   0              0.013371692    2.3759314e-18  0              2.2945044e-13  1.1965779e-13  0              3.4004767    
Loop time of 283.677 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9137164.051 ns/day, 0.000 hours/ns, 10575.421 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.002     | 38.252     | 66.079     | 438.1 | 13.48
Neigh   | 1.6165     | 1.6347     | 1.652      |   1.0 |  0.58
Comm    | 12.417     | 17.35      | 21.539     |  93.2 |  6.12
Output  | 0.24019    | 0.24051    | 0.24086    |   0.1 |  0.08
Modify  | 166.96     | 171.3      | 175.63     |  28.6 | 60.39
Other   |            | 54.9       |            |       | 19.35

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         351.25 ave         703 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1405
Ave neighs/atom = 0.56177529
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.82                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.2112895446332
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.92
  ghost atom cutoff = 3.92
  binsize = 1.96, bins = 3247 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.14 | 49.15 | 49.15 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -1.0886257e-05  1.3259158e-05  0             -4.5917929e-05  698102.45      0              6.7417738e+10  1.1965779e-13  0              3.4097148    
    200000   6363.961       200            200           -0.00036656066 -2.5386362e-35  0             -0.001099682    43174.763      0              4.1695096e+09  1.1965779e-13  0              3.5314702    
    300000   6363.961       200            200           -0.00013040864 -2.5385941e-35  0             -0.00039122591  3899.3024      0              3.7656672e+08  1.1965779e-13  0              3.4436763    
    400000   6363.961       200            200           -0.00012030275  2.538657e-34   0             -0.00036090825  3346.0317      0              3.2313579e+08  1.1965779e-13  0              3.4118553    
    500000   6363.961       200            200            0.0083608387  -0.0036183237   0              0.02870084     145.6051       0              14061498       1.1965779e-13  0              3.4033682    
    600000   6363.961       200            200            0.0024579187  -0.0021564423   0              0.0095301983   65.45363       0              6321043        1.1965779e-13  0              3.406202     
    700000   6363.961       200            200            0.0029817073  -0.0025925598   0              0.011537682    0.26664982     0              25751.131      1.1965779e-13  0              3.4058058    
    800000   6363.961       200            200            0.0034360357  -0.0025530287   0              0.012861136    1.3273298      0              128184.01      1.1965779e-13  0              3.4055694    
    900000   6363.961       200            200            0.0035844035  -0.002574125    0              0.013327336    0.39486059     0              38132.81       1.1965779e-13  0              3.4054898    
   1000000   6363.961       200            200            0.0036161642  -0.002576336    0              0.013424829    0.049075814    0              4739.3908      1.1965779e-13  0              3.4054736    
   1100000   6363.961       200            200            0.0036146283  -0.0025761469   0              0.013420032    0.0023283924   0              224.85947      1.1965779e-13  0              3.4054747    
   1200000   6363.961       200            200            0.0036094774  -0.0025756304   0              0.013404062    7.6011523e-07  0              0.073406488    1.1965779e-13  0              3.4054774    
   1300000   6363.961       200            200            0.0036065943  -0.0025753453   0              0.013395128    4.9364552e-05  0              4.7672751      1.1965779e-13  0              3.405479     
   1400000   6363.961       200            200            0.0036055569  -0.0025752437   0              0.013391914    1.6833805e-05  0              1.6256884      1.1965779e-13  0              3.4054795    
   1500000   6363.961       200            200            0.0036053222  -0.0025752212   0              0.013391188    2.3031242e-06  0              0.22241925     1.1965779e-13  0              3.4054796    
   1600000   6363.961       200            200            0.0036053211  -0.0025752213   0              0.013391185    1.2859046e-07  0              0.012418346    1.1965779e-13  0              3.4054796    
   1700000   6363.961       200            200            0.0036053521  -0.0025752245   0              0.013391281    1.1765583e-10  0              1.1362358e-05  1.1965779e-13  0              3.4054796    
   1800000   6363.961       200            200            0.0036053708  -0.0025752263   0              0.013391339    1.7489807e-09  0              0.00016890404  1.1965779e-13  0              3.4054796    
   1900000   6363.961       200            200            0.0036053779  -0.002575227    0              0.013391361    7.0669008e-10  0              6.824707e-05   1.1965779e-13  0              3.4054796    
   2000000   6363.961       200            200            0.0036053797  -0.0025752272   0              0.013391366    1.0674483e-10  0              1.0308651e-05  1.1965779e-13  0              3.4054796    
   2100000   6363.961       200            200            0.0036053797  -0.0025752272   0              0.013391366    6.882838e-12   0              6.6469523e-07  1.1965779e-13  0              3.4054796    
   2200000   6363.961       200            200            0.0036053796  -0.0025752272   0              0.013391366    3.3456276e-14  0              3.2309677e-09  1.1965779e-13  0              3.4054796    
   2300000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    5.9052554e-14  0              5.702873e-09   1.1965779e-13  0              3.4054796    
   2400000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    2.9003312e-14  0              2.8009323e-09  1.1965779e-13  0              3.4054796    
   2500000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    4.8829722e-15  0              4.715625e-10   1.1965779e-13  0              3.4054796    
   2600000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    3.7602913e-16  0              3.6314202e-11  1.1965779e-13  0              3.4054796    
   2700000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    2.3051534e-17  0              2.2261521e-12  1.1965779e-13  0              3.4054796    
   2800000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    5.6295702e-18  0              5.4366359e-13  1.1965779e-13  0              3.4054796    
   2900000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    8.0022046e-20  0              7.7279564e-15  1.1965779e-13  0              3.4054796    
   3000000   6363.961       200            200            0.0036053794  -0.0025752272   0              0.013391365    4.8625728e-18  0              4.6959248e-13  1.1965779e-13  0              3.4054796    
Loop time of 285.58 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9076251.806 ns/day, 0.000 hours/ns, 10504.921 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.932     | 38.485     | 66.43      | 440.8 | 13.48
Neigh   | 1.6272     | 1.6455     | 1.663      |   1.0 |  0.58
Comm    | 12.491     | 17.556     | 21.885     |  92.4 |  6.15
Output  | 0.24078    | 0.2411     | 0.24144    |   0.1 |  0.08
Modify  | 167.55     | 172.16     | 177.6      |  31.2 | 60.28
Other   |            | 55.49      |            |       | 19.43

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         353.75 ave         708 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1415
Ave neighs/atom = 0.56577369
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.83                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.7168879368044
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.93
  ghost atom cutoff = 3.93
  binsize = 1.965, bins = 3239 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 48.38 | 48.39 | 48.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -5.0104564e-05 -1.0154506e-34  0             -0.00015031369  689664.38      0              6.660285e+10   1.1965779e-13  0              3.4202076    
    200000   6363.961       200            200           -0.00036103557  1.901149e-39   0             -0.0010831067   41033.608      0              3.9627322e+09  1.1965779e-13  0              3.5383385    
    300000   6363.961       200            200           -0.0001197656   2.5386981e-35  0             -0.00035929681  3231.3099      0              3.1205678e+08  1.1965779e-13  0              3.4493194    
    400000   6363.961       200            200           -0.000108655    1.2693416e-35  0             -0.000325965    2678.1317      0              2.5863479e+08  1.1965779e-13  0              3.4175077    
    500000   6363.961       200            200            0.0086210205  -0.0037813152   0              0.029644377    17.188774      0              1659968.8      1.1965779e-13  0              3.4082624    
    600000   6363.961       200            200            0.0026986991  -0.0021926181   0              0.010288715    103.34138      0              9979971        1.1965779e-13  0              3.4110604    
    700000   6363.961       200            200            0.0029942994  -0.0025897403   0              0.011572639    0.56363226     0              54431.569      1.1965779e-13  0              3.4108068    
    800000   6363.961       200            200            0.0034070328  -0.0025497586   0              0.012770857    0.48480179     0              46818.687      1.1965779e-13  0              3.4105917    
    900000   6363.961       200            200            0.0035664367  -0.0025682572   0              0.013267567    0.29040063     0              28044.814      1.1965779e-13  0              3.4105063    
   1000000   6363.961       200            200            0.0036125333  -0.0025722716   0              0.013409872    0.056368892    0              5443.7041      1.1965779e-13  0              3.4104824    
   1100000   6363.961       200            200            0.0036189303  -0.0025728636   0              0.013429654    0.0053410415   0              515.79956      1.1965779e-13  0              3.4104793    
   1200000   6363.961       200            200            0.0036166651  -0.0025726277   0              0.013422623    0.00016614581  0              16.045173      1.1965779e-13  0              3.4104805    
   1300000   6363.961       200            200            0.003614414   -0.002572403    0              0.013415645    3.7276565e-06  0              0.35999038     1.1965779e-13  0              3.4104817    
   1400000   6363.961       200            200            0.0036133368  -0.0025722967   0              0.013412307    8.546282e-06   0              0.82533874     1.1965779e-13  0              3.4104823    
   1500000   6363.961       200            200            0.0036129784  -0.0025722617   0              0.013411197    2.358797e-06   0              0.22779573     1.1965779e-13  0              3.4104825    
   1600000   6363.961       200            200            0.0036129034  -0.0025722545   0              0.013410965    3.019987e-07   0              0.029164873    1.1965779e-13  0              3.4104825    
   1700000   6363.961       200            200            0.0036129056  -0.0025722548   0              0.013410972    1.7059362e-08  0              0.0016474711   1.1965779e-13  0              3.4104825    
   1800000   6363.961       200            200            0.0036129171  -0.002572256    0              0.013411007    3.808146e-11   0              3.6776348e-06  1.1965779e-13  0              3.4104825    
   1900000   6363.961       200            200            0.0036129238  -0.0025722567   0              0.013411028    1.9082697e-10  0              1.8428703e-05  1.1965779e-13  0              3.4104825    
   2000000   6363.961       200            200            0.0036129264  -0.0025722569   0              0.013411036    8.6851061e-11  0              8.3874538e-06  1.1965779e-13  0              3.4104825    
   2100000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    1.4923837e-11  0              1.4412374e-06  1.1965779e-13  0              3.4104825    
   2200000   6363.961       200            200            0.0036129272  -0.002572257    0              0.013411039    1.2492868e-12  0              1.2064718e-07  1.1965779e-13  0              3.4104825    
   2300000   6363.961       200            200            0.0036129272  -0.002572257    0              0.013411038    2.7319875e-14  0              2.638358e-09   1.1965779e-13  0              3.4104825    
   2400000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    2.3273002e-15  0              2.24754e-10    1.1965779e-13  0              3.4104825    
   2500000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    2.6973316e-15  0              2.6048898e-10  1.1965779e-13  0              3.4104825    
   2600000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    6.4534168e-16  0              6.232248e-11   1.1965779e-13  0              3.4104825    
   2700000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    9.0480207e-17  0              8.7379307e-12  1.1965779e-13  0              3.4104825    
   2800000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    1.0575078e-17  0              1.0212654e-12  1.1965779e-13  0              3.4104825    
   2900000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    4.5696458e-18  0              4.4130368e-13  1.1965779e-13  0              3.4104825    
   3000000   6363.961       200            200            0.0036129271  -0.002572257    0              0.013411038    2.9029752e-18  0              2.8034857e-13  1.1965779e-13  0              3.4104825    
Loop time of 284.796 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9101256.839 ns/day, 0.000 hours/ns, 10533.862 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.069     | 37.295     | 64.046     | 428.1 | 13.10
Neigh   | 1.6013     | 1.6184     | 1.6351     |   1.0 |  0.57
Comm    | 12.073     | 17.995     | 23.191     | 115.5 |  6.32
Output  | 0.24022    | 0.24054    | 0.24089    |   0.1 |  0.08
Modify  | 168.04     | 172.56     | 177.71     |  30.2 | 60.59
Other   |            | 55.09      |            |       | 19.34

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         330.25 ave         661 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1321
Ave neighs/atom = 0.52818872
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.84                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.2251334349452
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.94
  ghost atom cutoff = 3.94
  binsize = 1.97, bins = 3231 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 48.3 | 48.3 | 48.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -6.6385966e-05  5.0773429e-35  0             -0.0001991579   681282.41      0              6.5793379e+10  1.1965779e-13  0              3.4306702    
    200000   6363.961       200            200           -0.00035532121  1.0154696e-34  0             -0.0010659636   38948.822      0              3.7613984e+09  1.1965779e-13  0              3.5451599    
    300000   6363.961       200            200           -0.00010892812  7.2535383e-40  0             -0.00032678436  2626.7079      0              2.5366865e+08  1.1965779e-13  0              3.4549025    
    400000   6363.961       200            200           -9.6783605e-05 -2.5386435e-35  0             -0.00029035081  2085.3356      0              2.0138679e+08  1.1965779e-13  0              3.4230887    
    500000   6363.961       200            200            0.0086180991  -0.0037983372   0              0.029652634    16.063782      0              1551325.1      1.1965779e-13  0              3.4132645    
    600000   6363.961       200            200            0.0029914513  -0.0022547839   0              0.011229138    138.07189      0              13333995       1.1965779e-13  0              3.4158897    
    700000   6363.961       200            200            0.0030471333  -0.002591371    0              0.011732771    3.8582762      0              372604.7       1.1965779e-13  0              3.4157849    
    800000   6363.961       200            200            0.0033978121  -0.0025460305   0              0.012739467    0.031623269    0              3053.949       1.1965779e-13  0              3.4156039    
    900000   6363.961       200            200            0.0035540358  -0.0025623333   0              0.013224441    0.15010082     0              14495.662      1.1965779e-13  0              3.4155201    
   1000000   6363.961       200            200            0.003609095   -0.0025677991   0              0.013395084    0.048511552    0              4684.8985      1.1965779e-13  0              3.4154912    
   1100000   6363.961       200            200            0.0036223766  -0.00256908     0              0.01343621     0.0073658415   0              711.34025      1.1965779e-13  0              3.4154844    
   1200000   6363.961       200            200            0.0036232686  -0.0025691538   0              0.01343896     0.00058261151  0              56.264449      1.1965779e-13  0              3.415484     
   1300000   6363.961       200            200            0.0036220383  -0.0025690282   0              0.013435143    1.2767215e-05  0              1.2329662      1.1965779e-13  0              3.4154847    
   1400000   6363.961       200            200            0.0036211467  -0.0025689395   0              0.01343238     1.0238033e-06  0              0.098871596    1.1965779e-13  0              3.4154851    
   1500000   6363.961       200            200            0.0036207532  -0.0025689007   0              0.01343116     1.2462469e-06  0              0.1203536      1.1965779e-13  0              3.4154854    
   1600000   6363.961       200            200            0.0036206266  -0.0025688884   0              0.013430768    3.1802273e-07  0              0.030712359    1.1965779e-13  0              3.4154854    
   1700000   6363.961       200            200            0.0036206002  -0.0025688859   0              0.013430686    4.1329823e-08  0              0.0039913385   1.1965779e-13  0              3.4154854    
   1800000   6363.961       200            200            0.0036206007  -0.002568886    0              0.013430688    2.6543132e-09  0              0.00025633457  1.1965779e-13  0              3.4154854    
   1900000   6363.961       200            200            0.0036206045  -0.0025688864   0              0.0134307      2.4175467e-11  0              2.3346936e-06  1.1965779e-13  0              3.4154854    
   2000000   6363.961       200            200            0.0036206069  -0.0025688866   0              0.013430707    1.4899268e-11  0              1.4388647e-06  1.1965779e-13  0              3.4154854    
   2100000   6363.961       200            200            0.0036206079  -0.0025688867   0              0.01343071     9.5120533e-12  0              9.1860602e-07  1.1965779e-13  0              3.4154854    
   2200000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    2.0000393e-12  0              1.9314948e-07  1.1965779e-13  0              3.4154854    
   2300000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    2.2224858e-13  0              2.1463177e-08  1.1965779e-13  0              3.4154854    
   2400000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    1.0981464e-14  0              1.0605112e-09  1.1965779e-13  0              3.4154854    
   2500000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    8.6414122e-18  0              8.3452574e-13  1.1965779e-13  0              3.4154854    
   2600000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    1.3152243e-16  0              1.2701494e-11  1.1965779e-13  0              3.4154854    
   2700000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    3.2022011e-17  0              3.0924566e-12  1.1965779e-13  0              3.4154854    
   2800000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    3.6405693e-19  0              3.5158013e-14  1.1965779e-13  0              3.4154854    
   2900000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    4.9699745e-18  0              4.7996457e-13  1.1965779e-13  0              3.4154854    
   3000000   6363.961       200            200            0.0036206082  -0.0025688867   0              0.013430711    4.7332829e-18  0              4.5710658e-13  1.1965779e-13  0              3.4154854    
Loop time of 282.427 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9177602.044 ns/day, 0.000 hours/ns, 10622.225 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.921     | 37.528     | 64.689     | 431.1 | 13.29
Neigh   | 1.5402     | 1.5564     | 1.5728     |   0.9 |  0.55
Comm    | 12.366     | 17.346     | 21.509     |  92.5 |  6.14
Output  | 0.24309    | 0.24342    | 0.24378    |   0.1 |  0.09
Modify  | 165.77     | 170.87     | 176.03     |  34.2 | 60.50
Other   |            | 54.88      |            |       | 19.43

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.53298681
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.85                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.7360329505601
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.95
  ghost atom cutoff = 3.95
  binsize = 1.975, bins = 3223 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 48.21 | 48.22 | 48.22 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -8.2441398e-05 -5.0772582e-35  0             -0.00024732419  672956.76      0              6.4989347e+10  1.1965779e-13  0              3.4411025    
    200000   6363.961       200            200           -0.00034941848  1.269326e-35   0             -0.0010482554   36920.235      0              3.565492e+09   1.1965779e-13  0              3.5519343    
    300000   6363.961       200            200           -9.7897434e-05 -3.8079679e-34  0             -0.0002936923   2085.2727      0              2.0138071e+08  1.1965779e-13  0              3.4604256    
    400000   6363.961       200            200           -8.4690305e-05  2.3109271e-40  0             -0.00025407092  1567.3108      0              1.5135966e+08  1.1965779e-13  0              3.4285983    
    500000   6363.961       200            200            0.0083148174  -0.0037746653   0              0.028719117    142.10353      0              13723342       1.1965779e-13  0              3.4183749    
    600000   6363.961       200            200            0.0033312714  -0.0023301423   0              0.012323956    162.45332      0              15688579       1.1965779e-13  0              3.4206983    
    700000   6363.961       200            200            0.0031412148  -0.0025872065   0              0.012010851    9.2480493      0              893110.41      1.1965779e-13  0              3.420742     
    800000   6363.961       200            200            0.0034096903  -0.0025423177   0              0.012771389    0.12642948     0              12209.654      1.1965779e-13  0              3.420605     
    900000   6363.961       200            200            0.0035495374  -0.0025565176   0              0.01320513     0.03671616     0              3545.7839      1.1965779e-13  0              3.4205298    
   1000000   6363.961       200            200            0.0036076243  -0.0025623817   0              0.013385254    0.029761679    0              2874.17        1.1965779e-13  0              3.4204992    
   1100000   6363.961       200            200            0.0036258993  -0.0025641597   0              0.013441858    0.0071286249   0              688.43157      1.1965779e-13  0              3.4204897    
   1200000   6363.961       200            200            0.0036297307  -0.0025645219   0              0.013453714    0.00094432688  0              91.196331      1.1965779e-13  0              3.4204877    
   1300000   6363.961       200            200            0.0036297157  -0.0025645154   0              0.013453662    6.840588e-05   0              6.6061502      1.1965779e-13  0              3.4204878    
   1400000   6363.961       200            200            0.0036291897  -0.0025644625   0              0.013452032    1.3163642e-06  0              0.12712503     1.1965779e-13  0              3.4204881    
   1500000   6363.961       200            200            0.0036288555  -0.0025644295   0              0.013450996    1.451995e-07   0              0.014022329    1.1965779e-13  0              3.4204882    
   1600000   6363.961       200            200            0.0036287126  -0.0025644156   0              0.013450553    1.5867859e-07  0              0.015324042    1.1965779e-13  0              3.4204883    
   1700000   6363.961       200            200            0.0036286663  -0.0025644111   0              0.01345041     4.1369448e-08  0              0.0039951652   1.1965779e-13  0              3.4204883    
   1800000   6363.961       200            200            0.0036286559  -0.0025644101   0              0.013450378    5.8346828e-09  0              0.0005634719   1.1965779e-13  0              3.4204883    
   1900000   6363.961       200            200            0.0036286555  -0.0025644101   0              0.013450377    4.5947614e-10  0              4.4372917e-05  1.1965779e-13  0              3.4204883    
   2000000   6363.961       200            200            0.0036286567  -0.0025644102   0              0.01345038     1.1645688e-11  0              1.1246572e-06  1.1965779e-13  0              3.4204883    
   2100000   6363.961       200            200            0.0036286575  -0.0025644103   0              0.013450383    4.9964371e-13  0              4.8252013e-08  1.1965779e-13  0              3.4204883    
   2200000   6363.961       200            200            0.0036286578  -0.0025644103   0              0.013450384    8.3157789e-13  0              8.0307841e-08  1.1965779e-13  0              3.4204883    
   2300000   6363.961       200            200            0.0036286579  -0.0025644103   0              0.013450384    2.380911e-13   0              2.2993134e-08  1.1965779e-13  0              3.4204883    
   2400000   6363.961       200            200            0.0036286579  -0.0025644103   0              0.013450384    3.5686741e-14  0              3.44637e-09    1.1965779e-13  0              3.4204883    
   2500000   6363.961       200            200            0.003628658   -0.0025644103   0              0.013450384    3.0034269e-15  0              2.9004947e-10  1.1965779e-13  0              3.4204883    
   2600000   6363.961       200            200            0.0036286579  -0.0025644103   0              0.013450384    1.0511988e-16  0              1.0151725e-11  1.1965779e-13  0              3.4204883    
   2700000   6363.961       200            200            0.0036286579  -0.0025644103   0              0.013450384    4.1139396e-18  0              3.9729484e-13  1.1965779e-13  0              3.4204883    
   2800000   6363.961       200            200            0.0036286579  -0.0025644103   0              0.013450384    2.7674451e-18  0              2.6726004e-13  1.1965779e-13  0              3.4204883    
   2900000   6363.961       200            200            0.0036286579  -0.0025644103   0              0.013450384    3.625093e-18   0              3.5008554e-13  1.1965779e-13  0              3.4204883    
   3000000   6363.961       200            200            0.0036286579  -0.0025644103   0              0.013450384    9.8438175e-21  0              9.5064544e-16  1.1965779e-13  0              3.4204883    
Loop time of 282.704 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9168610.001 ns/day, 0.000 hours/ns, 10611.817 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.956     | 37.637     | 64.832     | 431.4 | 13.31
Neigh   | 1.4805     | 1.4964     | 1.5119     |   0.9 |  0.53
Comm    | 12.186     | 17.204     | 21.375     |  93.1 |  6.09
Output  | 0.23937    | 0.2397     | 0.24006    |   0.1 |  0.08
Modify  | 165.59     | 170.91     | 176.66     |  36.4 | 60.45
Other   |            | 55.22      |            |       | 19.53

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.25 ave         673 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1345
Ave neighs/atom = 0.53778489
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.86                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.2495933951522
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.96
  ghost atom cutoff = 3.96
  binsize = 1.98, bins = 3215 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 48.12 | 48.13 | 48.13 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -9.8271337e-05  5.0775618e-35  0             -0.00029481401  664687.42      0              6.4190753e+10  1.1965779e-13  0              3.4515046    
    200000   6363.961       200            200           -0.00034332836  1.269329e-35   0             -0.0010299851   34947.721      0              3.3750007e+09  1.1965779e-13  0              3.5586618    
    300000   6363.961       200            200           -8.6674968e-05  5.0773841e-35  0             -0.0002600249   1606.789       0              1.5517218e+08  1.1965779e-13  0              3.4658885    
    400000   6363.961       200            200           -7.2377032e-05  3.9349087e-34  0             -0.0002171311   1123.7335      0              1.0852214e+08  1.1965779e-13  0              3.4340363    
    500000   6363.961       200            200            0.0077671568  -0.0036341023   0              0.026935573    366.33714      0              35378219       1.1965779e-13  0              3.4235875    
    600000   6363.961       200            200            0.0037212639  -0.0023676131   0              0.013531405    170.87832      0              16502205       1.1965779e-13  0              3.425496     
    700000   6363.961       200            200            0.003269307   -0.0025854392   0              0.01239336     15.251496      0              1472880.4      1.1965779e-13  0              3.4256812    
    800000   6363.961       200            200            0.0034427254  -0.0025374759   0              0.012865652    0.73113172     0              70607.469      1.1965779e-13  0              3.4255954    
    900000   6363.961       200            200            0.0035551445  -0.0025486765   0              0.01321411     0.00067223701  0              64.919839      1.1965779e-13  0              3.4255347    
   1000000   6363.961       200            200            0.003610087   -0.0025542166   0              0.013384478    0.010184077    0              983.50529      1.1965779e-13  0              3.4255056    
   1100000   6363.961       200            200            0.0036308871  -0.0025562411   0              0.013448902    0.0047854473   0              462.14425      1.1965779e-13  0              3.4254947    
   1200000   6363.961       200            200            0.0036370015  -0.0025568247   0              0.013467829    0.00098755065  0              95.370574      1.1965779e-13  0              3.4254916    
   1300000   6363.961       200            200            0.003638175   -0.0025569336   0              0.013471458    0.00012392203  0              11.967502      1.1965779e-13  0              3.425491     
   1400000   6363.961       200            200            0.0036381146  -0.0025569259   0              0.01347127     9.0660636e-06  0              0.87553553     1.1965779e-13  0              3.425491     
   1500000   6363.961       200            200            0.0036379171  -0.0025569063   0              0.013470657    2.1129975e-07  0              0.020405817    1.1965779e-13  0              3.4254911    
   1600000   6363.961       200            200            0.0036377967  -0.0025568945   0              0.013470284    1.1364145e-08  0              0.0010974678   1.1965779e-13  0              3.4254912    
   1700000   6363.961       200            200            0.0036377449  -0.0025568895   0              0.013470124    1.7255253e-08  0              0.0016663889   1.1965779e-13  0              3.4254912    
   1800000   6363.961       200            200            0.0036377274  -0.0025568878   0              0.01347007     5.06185e-09    0              0.00048883724  1.1965779e-13  0              3.4254912    
   1900000   6363.961       200            200            0.003637723   -0.0025568874   0              0.013470056    8.1855459e-10  0              7.9050143e-05  1.1965779e-13  0              3.4254912    
   2000000   6363.961       200            200            0.0036377225  -0.0025568874   0              0.013470055    8.1636441e-11  0              7.8838632e-06  1.1965779e-13  0              3.4254912    
   2100000   6363.961       200            200            0.0036377228  -0.0025568874   0              0.013470056    4.1042428e-12  0              3.963584e-07   1.1965779e-13  0              3.4254912    
   2200000   6363.961       200            200            0.003637723   -0.0025568874   0              0.013470056    1.0126641e-14  0              9.7795849e-10  1.1965779e-13  0              3.4254912    
   2300000   6363.961       200            200            0.0036377231  -0.0025568875   0              0.013470057    4.3332672e-14  0              4.1847593e-09  1.1965779e-13  0              3.4254912    
   2400000   6363.961       200            200            0.0036377232  -0.0025568875   0              0.013470057    2.1935469e-14  0              2.1183705e-09  1.1965779e-13  0              3.4254912    
   2500000   6363.961       200            200            0.0036377232  -0.0025568875   0              0.013470057    4.7289473e-15  0              4.5668788e-10  1.1965779e-13  0              3.4254912    
   2600000   6363.961       200            200            0.0036377232  -0.0025568875   0              0.013470057    6.2167879e-16  0              6.0037288e-11  1.1965779e-13  0              3.4254912    
   2700000   6363.961       200            200            0.0036377232  -0.0025568875   0              0.013470057    7.5065466e-17  0              7.2492854e-12  1.1965779e-13  0              3.4254912    
   2800000   6363.961       200            200            0.0036377232  -0.0025568875   0              0.013470057    1.2376435e-17  0              1.1952275e-12  1.1965779e-13  0              3.4254912    
   2900000   6363.961       200            200            0.0036377232  -0.0025568875   0              0.013470057    7.5235401e-19  0              7.2656965e-14  1.1965779e-13  0              3.4254912    
   3000000   6363.961       200            200            0.0036377232  -0.0025568875   0              0.013470057    3.0926566e-19  0              2.9866664e-14  1.1965779e-13  0              3.4254912    
Loop time of 283.889 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9130325.103 ns/day, 0.000 hours/ns, 10567.506 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.172     | 37.612     | 64.538     | 430.3 | 13.25
Neigh   | 1.5385     | 1.5544     | 1.5701     |   0.9 |  0.55
Comm    | 11.976     | 17.857     | 23.131     | 116.3 |  6.29
Output  | 0.24041    | 0.24074    | 0.2411     |   0.1 |  0.08
Modify  | 167.76     | 171.79     | 176.29     |  26.4 | 60.51
Other   |            | 54.84      |            |       | 19.32

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         339.25 ave         679 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1357
Ave neighs/atom = 0.54258297
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.87                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.765821680226
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.97
  ghost atom cutoff = 3.97
  binsize = 1.985, bins = 3207 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 47.38 | 47.38 | 47.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00011387644 -1.2693239e-35  0             -0.00034162933  656474.23      0              6.3397583e+10  1.1965779e-13  0              3.4618764    
    200000   6363.961       200            200           -0.00033705172  2.5387233e-35  0             -0.0010111552   33031.105      0              3.1899077e+09  1.1965779e-13  0              3.5653422    
    300000   6363.961       200            200           -7.5261854e-05  4.2558354e-40  0             -0.00022578556  1191.0294      0              1.150211e+08   1.1965779e-13  0              3.471291     
    400000   6363.961       200            200           -5.984528e-05   3.7115899e-40  0             -0.00017953584  754.26578      0              72841590       1.1965779e-13  0              3.4394027    
    500000   6363.961       200            200            0.0069716093  -0.0035628315   0              0.024477659    639.10803      0              61720479       1.1965779e-13  0              3.4288907    
    600000   6363.961       200            200            0.004124502   -0.0024157225   0              0.014789229    160.82069      0              15530911       1.1965779e-13  0              3.4302941    
    700000   6363.961       200            200            0.0034267119  -0.0025783359   0              0.012858472    20.190041      0              1949809.6      1.1965779e-13  0              3.4306069    
    800000   6363.961       200            200            0.0034942936  -0.002533053    0              0.013015934    1.6250973      0              156940.27      1.1965779e-13  0              3.4305761    
    900000   6363.961       200            200            0.0035705372  -0.0025410732   0              0.013252685    0.057640935    0              5566.5489      1.1965779e-13  0              3.4305345    
   1000000   6363.961       200            200            0.0036166284  -0.002545714    0              0.013395599    0.00023838997  0              23.021997      1.1965779e-13  0              3.43051      
   1100000   6363.961       200            200            0.0036372325  -0.0025477212   0              0.013459419    0.0018149205   0              175.27203      1.1965779e-13  0              3.4304992    
   1200000   6363.961       200            200            0.0036446457  -0.002548431    0              0.013482368    0.00068179898  0              65.843266      1.1965779e-13  0              3.4304953    
   1300000   6363.961       200            200            0.0036467711  -0.0025486318   0              0.013488945    0.0001330685   0              12.850803      1.1965779e-13  0              3.4304942    
   1400000   6363.961       200            200            0.0036471779  -0.0025486691   0              0.013490203    1.6922272e-05  0              1.6342319      1.1965779e-13  0              3.430494     
   1500000   6363.961       200            200            0.0036471606  -0.0025486668   0              0.013490149    1.36245e-06    0              0.13157567     1.1965779e-13  0              3.430494     
   1600000   6363.961       200            200            0.0036470943  -0.0025486603   0              0.013489943    4.748657e-08   0              0.0045859131   1.1965779e-13  0              3.4304941    
   1700000   6363.961       200            200            0.0036470528  -0.0025486562   0              0.013489815    1.7247582e-10  0              1.665648e-05   1.1965779e-13  0              3.4304941    
   1800000   6363.961       200            200            0.0036470343  -0.0025486544   0              0.013489757    1.4488328e-09  0              0.0001399179   1.1965779e-13  0              3.4304941    
   1900000   6363.961       200            200            0.0036470276  -0.0025486538   0              0.013489737    5.4839226e-10  0              5.2959799e-05  1.1965779e-13  0              3.4304941    
   2000000   6363.961       200            200            0.0036470257  -0.0025486536   0              0.013489731    1.0744614e-10  0              1.0376379e-05  1.1965779e-13  0              3.4304941    
   2100000   6363.961       200            200            0.0036470253  -0.0025486536   0              0.013489729    1.3711516e-11  0              1.32416e-06    1.1965779e-13  0              3.4304941    
   2200000   6363.961       200            200            0.0036470253  -0.0025486536   0              0.01348973     1.1093839e-12  0              1.0713636e-07  1.1965779e-13  0              3.4304941    
   2300000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     3.9410635e-14  0              3.805997e-09   1.1965779e-13  0              3.4304941    
   2400000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     9.7645205e-17  0              9.429875e-12   1.1965779e-13  0              3.4304941    
   2500000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     1.1519201e-15  0              1.112442e-10   1.1965779e-13  0              3.4304941    
   2600000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     4.173858e-16   0              4.0308133e-11  1.1965779e-13  0              3.4304941    
   2700000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     6.0444454e-17  0              5.8372928e-12  1.1965779e-13  0              3.4304941    
   2800000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     1.3315757e-18  0              1.2859405e-13  1.1965779e-13  0              3.4304941    
   2900000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     3.8444881e-20  0              3.7127315e-15  1.1965779e-13  0              3.4304941    
   3000000   6363.961       200            200            0.0036470254  -0.0025486536   0              0.01348973     1.8717297e-18  0              1.8075826e-13  1.1965779e-13  0              3.4304941    
Loop time of 285.049 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9093169.759 ns/day, 0.000 hours/ns, 10524.502 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.08      | 37.611     | 64.715     | 431.2 | 13.19
Neigh   | 1.4732     | 1.4895     | 1.5054     |   1.0 |  0.52
Comm    | 11.887     | 17.862     | 23.07      | 117.7 |  6.27
Output  | 0.23924    | 0.23956    | 0.23991    |   0.1 |  0.08
Modify  | 168.99     | 173.01     | 177.33     |  25.6 | 60.70
Other   |            | 54.83      |            |       | 19.24

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         341.75 ave         684 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1367
Ave neighs/atom = 0.54658137
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.88                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.284724717285
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.98
  ghost atom cutoff = 3.98
  binsize = 1.99, bins = 3198 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 47.26 | 47.28 | 47.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00012925732  2.5386942e-35  0             -0.00038777195  648317.11      0              6.2609826e+10  1.1965779e-13  0              3.4722178    
    200000   6363.961       200            200           -0.00033058951 -1.2693215e-35  0             -0.00099176853  31170.244      0              3.010199e+09   1.1965779e-13  0              3.5719753    
    300000   6363.961       200            200           -6.3659455e-05 -5.0772709e-35  0             -0.00019097837  837.77729      0              80906534       1.1965779e-13  0              3.4766332    
    400000   6363.961       200            200           -4.7096987e-05 -1.2693105e-35  0             -0.00014129096  458.58682      0              44287033       1.1965779e-13  0              3.4446973    
    500000   6363.961       200            200            0.0060039719  -0.0035673832   0              0.021579299    903.76167      0              87278833       1.1965779e-13  0              3.434268     
    600000   6363.961       200            200            0.004487193   -0.0025607169   0              0.016022296    133.77018      0              12918566       1.1965779e-13  0              3.4351038    
    700000   6363.961       200            200            0.0036018842  -0.0025716001   0              0.013377253    22.646708      0              2187057        1.1965779e-13  0              3.4355248    
    800000   6363.961       200            200            0.0035599023  -0.0025312038   0              0.013210911    2.4833524      0              239824.4       1.1965779e-13  0              3.4355493    
    900000   6363.961       200            200            0.0035945388  -0.0025351993   0              0.013318816    0.18151993     0              17529.896      1.1965779e-13  0              3.4355297    
   1000000   6363.961       200            200            0.0036271139  -0.0025384922   0              0.013419834    0.0051868134   0              500.90531      1.1965779e-13  0              3.4355122    
   1100000   6363.961       200            200            0.0036448937  -0.0025402334   0              0.013474915    8.2637083e-05  0              7.980498       1.1965779e-13  0              3.4355028    
   1200000   6363.961       200            200            0.0036524507  -0.0025409612   0              0.013498313    0.00025028594  0              24.170825      1.1965779e-13  0              3.4354988    
   1300000   6363.961       200            200            0.003655129   -0.0025412163   0              0.013506603    8.8393902e-05  0              8.5364503      1.1965779e-13  0              3.4354975    
   1400000   6363.961       200            200            0.0036559092  -0.0025412898   0              0.013509017    1.7495582e-05  0              1.6895981      1.1965779e-13  0              3.4354971    
   1500000   6363.961       200            200            0.0036560721  -0.0025413048   0              0.013509521    2.3787541e-06  0              0.22972304     1.1965779e-13  0              3.435497     
   1600000   6363.961       200            200            0.0036560764  -0.002541305    0              0.013509534    2.2296764e-07  0              0.021532618    1.1965779e-13  0              3.435497     
   1700000   6363.961       200            200            0.0036560573  -0.0025413031   0              0.013509475    1.1943826e-08  0              0.0011534492   1.1965779e-13  0              3.435497     
   1800000   6363.961       200            200            0.0036560439  -0.0025413018   0              0.013509434    9.5293269e-11  0              9.2027419e-06  1.1965779e-13  0              3.435497     
   1900000   6363.961       200            200            0.0036560375  -0.0025413012   0              0.013509414    6.6816807e-11  0              6.452689e-06   1.1965779e-13  0              3.435497     
   2000000   6363.961       200            200            0.003656035   -0.0025413009   0              0.013509406    4.6331077e-11  0              4.4743238e-06  1.1965779e-13  0              3.435497     
   2100000   6363.961       200            200            0.0036560342  -0.0025413009   0              0.013509403    1.2042139e-11  0              1.1629436e-06  1.1965779e-13  0              3.435497     
   2200000   6363.961       200            200            0.003656034   -0.0025413008   0              0.013509403    1.998228e-12   0              1.9297455e-07  1.1965779e-13  0              3.435497     
   2300000   6363.961       200            200            0.0036560339  -0.0025413008   0              0.013509403    2.3194693e-13  0              2.2399774e-08  1.1965779e-13  0              3.435497     
   2400000   6363.961       200            200            0.0036560339  -0.0025413008   0              0.013509403    1.7838991e-14  0              1.722762e-09   1.1965779e-13  0              3.435497     
   2500000   6363.961       200            200            0.0036560339  -0.0025413008   0              0.013509403    6.5470857e-16  0              6.3227067e-11  1.1965779e-13  0              3.435497     
   2600000   6363.961       200            200            0.0036560339  -0.0025413008   0              0.013509403    3.3814262e-20  0              3.2655394e-15  1.1965779e-13  0              3.435497     
   2700000   6363.961       200            200            0.0036560339  -0.0025413008   0              0.013509403    6.7175089e-20  0              6.4872893e-15  1.1965779e-13  0              3.435497     
   2800000   6363.961       200            200            0.0036560339  -0.0025413008   0              0.013509403    1.6609345e-18  0              1.6040116e-13  1.1965779e-13  0              3.435497     
   2900000   6363.961       200            200            0.0036560339  -0.0025413008   0              0.013509403    2.6193411e-18  0              2.5295721e-13  1.1965779e-13  0              3.435497     
   3000000   6363.961       200            200            0.0036560339  -0.0025413009   0              0.013509403    1.0402773e-19  0              1.0046254e-14  1.1965779e-13  0              3.435497     
Loop time of 283.718 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9135845.018 ns/day, 0.000 hours/ns, 10573.895 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.898     | 38.073     | 65.828     | 437.0 | 13.42
Neigh   | 1.4868     | 1.5026     | 1.5183     |   0.9 |  0.53
Comm    | 12.161     | 17.189     | 21.317     |  93.5 |  6.06
Output  | 0.2387     | 0.23903    | 0.23939    |   0.1 |  0.08
Modify  | 166.81     | 171.58     | 176.86     |  31.7 | 60.48
Other   |            | 55.13      |            |       | 19.43

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         344.25 ave         689 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1377
Ave neighs/atom = 0.55057977
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.89                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.8063094178331
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.99
  ghost atom cutoff = 3.99
  binsize = 1.995, bins = 3190 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 47.17 | 47.19 | 47.21 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00014441453  2.8559818e-35  0             -0.00043324358  640215.95      0              6.1827474e+10  1.1965779e-13  0              3.4825288    
    200000   6363.961       200            200           -0.00032394265 -6.346607e-36   0             -0.00097182795  29364.985      0              2.8358601e+09  1.1965779e-13  0              3.5785612    
    300000   6363.961       200            200           -5.186904e-05  -7.6159387e-35  0             -0.00015560712  546.81249      0              52807236       1.1965779e-13  0              3.4819149    
    400000   6363.961       200            200           -3.413387e-05   5.0773945e-35  0             -0.00010240161  236.36972      0              22826895       1.1965779e-13  0              3.4499201    
    500000   6363.961       200            200            0.0049211533  -0.0037128931   0              0.018476353    1110.5699      0              1.072509e+08   1.1965779e-13  0              3.4397002    
    600000   6363.961       200            200            0.00482953    -0.0026610872   0              0.017149677    95.338737      0              9207132.8      1.1965779e-13  0              3.4399366    
    700000   6363.961       200            200            0.003785311   -0.0025591326   0              0.013915066    21.878566      0              2112875.3      1.1965779e-13  0              3.4404408    
    800000   6363.961       200            200            0.0036316523  -0.00254004     0              0.013434997    2.9926083      0              289004.69      1.1965779e-13  0              3.4405177    
    900000   6363.961       200            200            0.003626128   -0.0025289176   0              0.013407302    0.31604848     0              30521.7        1.1965779e-13  0              3.440521     
   1000000   6363.961       200            200            0.003642015   -0.0025305533   0              0.013456598    0.022286249    0              2152.2464      1.1965779e-13  0              3.4405122    
   1100000   6363.961       200            200            0.00365476    -0.0025318065   0              0.013496086    0.00066802246  0              64.512827      1.1965779e-13  0              3.4405054    
   1200000   6363.961       200            200            0.0036613133  -0.002532439    0              0.013516379    6.3977952e-06  0              0.61785327     1.1965779e-13  0              3.440502     
   1300000   6363.961       200            200            0.0036640586  -0.0025327012   0              0.013524877    2.7115675e-05  0              2.6186378      1.1965779e-13  0              3.4405006    
   1400000   6363.961       200            200            0.0036650445  -0.0025327945   0              0.013527928    1.0272047e-05  0              0.99200077     1.1965779e-13  0              3.4405001    
   1500000   6363.961       200            200            0.0036653457  -0.0025328228   0              0.01352886     2.1919933e-06  0              0.21168702     1.1965779e-13  0              3.4404999    
   1600000   6363.961       200            200            0.003665418   -0.0025328295   0              0.013529083    3.3196177e-07  0              0.032058492    1.1965779e-13  0              3.4404999    
   1700000   6363.961       200            200            0.0036654266  -0.0025328302   0              0.01352911     3.716102e-08   0              0.0035887453   1.1965779e-13  0              3.4404999    
   1800000   6363.961       200            200            0.0036654227  -0.0025328298   0              0.013529098    2.873593e-09   0              0.00027751104  1.1965779e-13  0              3.4404999    
   1900000   6363.961       200            200            0.0036654189  -0.0025328295   0              0.013529086    1.1064745e-10  0              1.0685539e-05  1.1965779e-13  0              3.4404999    
   2000000   6363.961       200            200            0.0036654168  -0.0025328293   0              0.01352908     4.0310318e-15  0              3.892882e-10   1.1965779e-13  0              3.4404999    
   2100000   6363.961       200            200            0.0036654159  -0.0025328292   0              0.013529077    2.1331352e-12  0              2.0600293e-07  1.1965779e-13  0              3.4404999    
   2200000   6363.961       200            200            0.0036654156  -0.0025328292   0              0.013529076    9.7247451e-13  0              9.3914628e-08  1.1965779e-13  0              3.4404999    
   2300000   6363.961       200            200            0.0036654155  -0.0025328291   0              0.013529076    2.252858e-13   0              2.175649e-08   1.1965779e-13  0              3.4404999    
   2400000   6363.961       200            200            0.0036654154  -0.0025328291   0              0.013529075    3.6235651e-14  0              3.4993798e-09  1.1965779e-13  0              3.4404999    
   2500000   6363.961       200            200            0.0036654154  -0.0025328291   0              0.013529075    4.3070352e-15  0              4.1594263e-10  1.1965779e-13  0              3.4404999    
   2600000   6363.961       200            200            0.0036654154  -0.0025328291   0              0.013529075    3.8832765e-16  0              3.7501905e-11  1.1965779e-13  0              3.4404999    
   2700000   6363.961       200            200            0.0036654154  -0.0025328291   0              0.013529075    4.8387946e-17  0              4.6729615e-12  1.1965779e-13  0              3.4404999    
   2800000   6363.961       200            200            0.0036654154  -0.0025328291   0              0.013529075    1.217975e-17   0              1.176233e-12   1.1965779e-13  0              3.4404999    
   2900000   6363.961       200            200            0.0036654154  -0.0025328291   0              0.013529075    6.7155395e-18  0              6.4853873e-13  1.1965779e-13  0              3.4404999    
   3000000   6363.961       200            200            0.0036654154  -0.0025328291   0              0.013529075    5.9440254e-18  0              5.7403143e-13  1.1965779e-13  0              3.4404999    
Loop time of 283.766 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9134290.279 ns/day, 0.000 hours/ns, 10572.095 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.986     | 38.23      | 66.079     | 437.7 | 13.47
Neigh   | 1.4959     | 1.5116     | 1.5269     |   0.9 |  0.53
Comm    | 12.26      | 17.236     | 21.322     |  91.8 |  6.07
Output  | 0.23609    | 0.23642    | 0.23678    |   0.1 |  0.08
Modify  | 166.57     | 171.37     | 176.45     |  31.5 | 60.39
Other   |            | 55.18      |            |       | 19.45

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         347.25 ave         695 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1389
Ave neighs/atom = 0.55537785
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.9                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.3305826933741
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4
  ghost atom cutoff = 4
  binsize = 2, bins = 3182 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 48.4 | 48.41 | 48.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0001593487   1.2693346e-35  0             -0.00047804609  632170.64      0              6.1050516e+10  1.1965779e-13  0              3.4928093    
    200000   6363.961       200            200           -0.00031711203  5.0774387e-35  0             -0.0009513361   27615.174      0              2.6668758e+09  1.1965779e-13  0              3.5850997    
    300000   6363.961       200            200           -3.9891856e-05 -5.0772789e-35  0             -0.00011967557  317.91565      0              30702018       1.1965779e-13  0              3.4871359    
    400000   6363.961       200            200           -2.0957645e-05  5.7950769e-41  0             -6.2872936e-05  87.289887      0              8429832.5      1.1965779e-13  0              3.4550709    
    500000   6363.961       200            200            0.004001685   -0.0033925863   0              0.015397641    1226.68        0              1.1846398e+08  1.1965779e-13  0              3.4451664    
    600000   6363.961       200            200            0.0050982002  -0.0027920071   0              0.018086608    54.217468      0              5235935        1.1965779e-13  0              3.4448026    
    700000   6363.961       200            200            0.0039662776  -0.0025356754   0              0.014434508    18.054766      0              1743600.1      1.1965779e-13  0              3.4453614    
    800000   6363.961       200            200            0.0037087451  -0.0025432652   0              0.013669501    2.9649242      0              286331.16      1.1965779e-13  0              3.4454845    
    900000   6363.961       200            200            0.003661883   -0.0025246527   0              0.013510302    0.40005739     0              38634.679      1.1965779e-13  0              3.4455099    
   1000000   6363.961       200            200            0.0036596802  -0.0025245367   0              0.013503577    0.042252612    0              4080.4549      1.1965779e-13  0              3.4455105    
   1100000   6363.961       200            200            0.0036658498  -0.0025251573   0              0.013522707    0.003187999    0              307.87413      1.1965779e-13  0              3.4455071    
   1200000   6363.961       200            200            0.0036704252  -0.0025256016   0              0.013536877    0.00012583217  0              12.151971      1.1965779e-13  0              3.4455047    
   1300000   6363.961       200            200            0.0036727498  -0.0025258243   0              0.013544074    1.4907966e-08  0              0.0014397047   1.1965779e-13  0              3.4455035    
   1400000   6363.961       200            200            0.0036737359  -0.0025259179   0              0.013547126    2.0391533e-06  0              0.19692683     1.1965779e-13  0              3.445503     
   1500000   6363.961       200            200            0.0036741024  -0.0025259525   0              0.01354826     1.0019534e-06  0              0.096761486    1.1965779e-13  0              3.4455028    
   1600000   6363.961       200            200            0.0036742221  -0.0025259637   0              0.01354863     2.4763469e-07  0              0.023914785    1.1965779e-13  0              3.4455027    
   1700000   6363.961       200            200            0.0036742553  -0.0025259668   0              0.013548733    4.3330726e-08  0              0.0041845714   1.1965779e-13  0              3.4455027    
   1800000   6363.961       200            200            0.003674262   -0.0025259674   0              0.013548753    5.8426684e-09  0              0.00056424309  1.1965779e-13  0              3.4455027    
   1900000   6363.961       200            200            0.0036742622  -0.0025259674   0              0.013548754    6.0716294e-10  0              5.8635451e-05  1.1965779e-13  0              3.4455027    
   2000000   6363.961       200            200            0.0036742614  -0.0025259673   0              0.013548751    4.4690085e-11  0              4.3158486e-06  1.1965779e-13  0              3.4455027    
   2100000   6363.961       200            200            0.0036742608  -0.0025259672   0              0.01354875     1.6582281e-12  0              1.601398e-07   1.1965779e-13  0              3.4455027    
   2200000   6363.961       200            200            0.0036742605  -0.0025259672   0              0.013548749    1.8060474e-16  0              1.7441513e-11  1.1965779e-13  0              3.4455027    
   2300000   6363.961       200            200            0.0036742604  -0.0025259672   0              0.013548748    3.3231619e-14  0              3.2092719e-09  1.1965779e-13  0              3.4455027    
   2400000   6363.961       200            200            0.0036742604  -0.0025259672   0              0.013548748    1.580809e-14   0              1.5266322e-09  1.1965779e-13  0              3.4455027    
   2500000   6363.961       200            200            0.0036742603  -0.0025259672   0              0.013548748    3.7780786e-15  0              3.6485979e-10  1.1965779e-13  0              3.4455027    
   2600000   6363.961       200            200            0.0036742603  -0.0025259672   0              0.013548748    6.3402158e-16  0              6.1229266e-11  1.1965779e-13  0              3.4455027    
   2700000   6363.961       200            200            0.0036742603  -0.0025259672   0              0.013548748    8.5909096e-17  0              8.2964856e-12  1.1965779e-13  0              3.4455027    
   2800000   6363.961       200            200            0.0036742603  -0.0025259672   0              0.013548748    4.095334e-18   0              3.9549805e-13  1.1965779e-13  0              3.4455027    
   2900000   6363.961       200            200            0.0036742603  -0.0025259672   0              0.013548748    1.1503175e-19  0              1.1108943e-14  1.1965779e-13  0              3.4455027    
   3000000   6363.961       200            200            0.0036742603  -0.0025259672   0              0.013548748    1.6137691e-19  0              1.5584627e-14  1.1965779e-13  0              3.4455027    
Loop time of 285.679 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9073128.526 ns/day, 0.000 hours/ns, 10501.306 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.866     | 38.347     | 66.218     | 439.7 | 13.42
Neigh   | 1.5533     | 1.569      | 1.5844     |   0.9 |  0.55
Comm    | 12.196     | 17.242     | 21.465     |  92.3 |  6.04
Output  | 0.24175    | 0.24206    | 0.2424     |   0.1 |  0.08
Modify  | 167.94     | 172.81     | 178.17     |  32.3 | 60.49
Other   |            | 55.46      |            |       | 19.41

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         349.75 ave         700 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1399
Ave neighs/atom = 0.55937625
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.91                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.8575514554118
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.01
  ghost atom cutoff = 4.01
  binsize = 2.005, bins = 3175 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 46.39 | 46.4 | 46.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00017406043  2.0823893e-39  0             -0.00052218128  624181.09      0              6.0278942e+10  1.1965779e-13  0              3.5030594    
    200000   6363.961       200            200           -0.0003100986   2.838737e-40   0             -0.00093029579  25920.659      0              2.5032317e+09  1.1965779e-13  0              3.5915908    
    300000   6363.961       200            200           -2.7729254e-05 -2.5386164e-35  0             -8.3187761e-05  150.86985      0              14569930       1.1965779e-13  0              3.4922961    
    400000   6363.961       200            200           -7.570188e-06  -1.2693213e-35  0             -2.2710564e-05  11.025302      0              1064744.8      1.1965779e-13  0              3.4601496    
    500000   6363.961       200            200            0.0031861938  -0.0029517166   0              0.012510298    1240.2035      0              1.1976997e+08  1.1965779e-13  0              3.450646     
    600000   6363.961       200            200            0.0053293291  -0.0027672438   0              0.018755231    20.24109       0              1954739.6      1.1965779e-13  0              3.4497106    
    700000   6363.961       200            200            0.0041175281  -0.002542202    0              0.014894786    12.25289       0              1183296.4      1.1965779e-13  0              3.4502927    
    800000   6363.961       200            200            0.0037848826  -0.0025398436   0              0.013894491    2.4078857      0              232536.36      1.1965779e-13  0              3.4504531    
    900000   6363.961       200            200            0.0036991515  -0.0025207136   0              0.013618168    0.39516577     0              38162.281      1.1965779e-13  0              3.450498     
   1000000   6363.961       200            200            0.0036793576  -0.0025189464   0              0.013557019    0.054229075    0              5237.0559      1.1965779e-13  0              3.4505077    
   1100000   6363.961       200            200            0.0036782596  -0.0025188768   0              0.013553655    0.0060382426   0              583.13025      1.1965779e-13  0              3.4505081    
   1200000   6363.961       200            200            0.0036801956  -0.002519071    0              0.013559658    0.00051932657  0              50.152843      1.1965779e-13  0              3.4505071    
   1300000   6363.961       200            200            0.0036816951  -0.0025192158   0              0.013564301    2.9304764e-05  0              2.8300444      1.1965779e-13  0              3.4505063    
   1400000   6363.961       200            200            0.0036824797  -0.0025192905   0              0.01356673     4.9316647e-07  0              0.047626487    1.1965779e-13  0              3.4505059    
   1500000   6363.961       200            200            0.0036828247  -0.0025193231   0              0.013567797    5.764592e-08   0              0.0055670304   1.1965779e-13  0              3.4505057    
   1600000   6363.961       200            200            0.0036829594  -0.0025193358   0              0.013568214    6.8670024e-08  0              0.0066316594   1.1965779e-13  0              3.4505056    
   1700000   6363.961       200            200            0.0036830068  -0.0025193402   0              0.013568361    2.2599858e-08  0              0.0021825325   1.1965779e-13  0              3.4505056    
   1800000   6363.961       200            200            0.0036830217  -0.0025193416   0              0.013568407    4.8283912e-09  0              0.00046629146  1.1965779e-13  0              3.4505056    
   1900000   6363.961       200            200            0.0036830257  -0.002519342    0              0.013568419    7.9416399e-10  0              7.6694674e-05  1.1965779e-13  0              3.4505056    
   2000000   6363.961       200            200            0.0036830265  -0.0025193421   0              0.013568422    1.05705e-10    0              1.0208233e-05  1.1965779e-13  0              3.4505056    
   2100000   6363.961       200            200            0.0036830265  -0.0025193421   0              0.013568422    1.1349448e-11  0              1.0960484e-06  1.1965779e-13  0              3.4505056    
   2200000   6363.961       200            200            0.0036830264  -0.002519342    0              0.013568421    9.2768862e-13  0              8.9589527e-08  1.1965779e-13  0              3.4505056    
   2300000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    4.716931e-14   0              4.5552744e-09  1.1965779e-13  0              3.4505056    
   2400000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    5.3185657e-16  0              5.1362901e-11  1.1965779e-13  0              3.4505056    
   2500000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    1.983224e-16   0              1.9152558e-11  1.1965779e-13  0              3.4505056    
   2600000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    1.3881725e-16  0              1.3405976e-11  1.1965779e-13  0              3.4505056    
   2700000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    1.5803543e-17  0              1.5261931e-12  1.1965779e-13  0              3.4505056    
   2800000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    5.7121649e-19  0              5.5164e-14     1.1965779e-13  0              3.4505056    
   2900000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    2.9305685e-18  0              2.8301333e-13  1.1965779e-13  0              3.4505056    
   3000000   6363.961       200            200            0.0036830263  -0.002519342    0              0.013568421    7.1632539e-18  0              6.9177579e-13  1.1965779e-13  0              3.4505056    
Loop time of 284.771 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9102035.955 ns/day, 0.000 hours/ns, 10534.764 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.913     | 38.341     | 66.284     | 439.4 | 13.46
Neigh   | 1.484      | 1.5004     | 1.5166     |   1.0 |  0.53
Comm    | 12.177     | 17.26      | 21.417     |  93.0 |  6.06
Output  | 0.24441    | 0.24473    | 0.24508    |   0.1 |  0.09
Modify  | 167.21     | 172        | 177.49     |  32.1 | 60.40
Other   |            | 55.43      |            |       | 19.46

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         352.25 ave         705 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1409
Ave neighs/atom = 0.56337465
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.92                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.3872226154503
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.02
  ghost atom cutoff = 4.02
  binsize = 2.01, bins = 3167 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 46.31 | 46.31 | 46.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0001885503   7.9332832e-36  0             -0.00056565091  616247.19      0              5.9512742e+10  1.1965779e-13  0              3.513279     
    200000   6363.961       200            200           -0.00030290326  6.3466693e-36  0             -0.00090870979  24281.293      0              2.3449135e+09  1.1965779e-13  0              3.5980343    
    300000   6363.961       200            200           -1.5382479e-05  5.0774515e-35  0             -4.6147438e-05  45.45669       0              4389881.7      1.1965779e-13  0              3.4973955    
    400000   6363.961       200            200            6.0268413e-06  8.7120195e-40  0              1.8080524e-05  7.2530099      0              700443.78      1.1965779e-13  0              3.465156     
    500000   6363.961       200            200            0.0024069335  -0.002721902    0              0.0099427024   1158.1695      0              1.1184772e+08  1.1965779e-13  0              3.4561193    
    600000   6363.961       200            200            0.0054506169  -0.0027436343   0              0.019095485    1.8165724      0              175431.56      1.1965779e-13  0              3.4546665    
    700000   6363.961       200            200            0.004241189   -0.0025348597   0              0.015258427    6.173955       0              596236.38      1.1965779e-13  0              3.4552403    
    800000   6363.961       200            200            0.0038515589  -0.0025354648   0              0.014090141    1.5241185      0              147188.46      1.1965779e-13  0              3.4554268    
    900000   6363.961       200            200            0.0037349111  -0.0025158031   0              0.013720536    0.30341799     0              29301.938      1.1965779e-13  0              3.455487     
   1000000   6363.961       200            200            0.0036998605  -0.0025126427   0              0.013612224    0.051638502    0              4986.8769      1.1965779e-13  0              3.4555046    
   1100000   6363.961       200            200            0.0036917262  -0.0025119157   0              0.013587094    0.0074023849   0              714.86935      1.1965779e-13  0              3.4555087    
   1200000   6363.961       200            200            0.0036907656  -0.0025118381   0              0.013584135    0.0008976938   0              86.692842      1.1965779e-13  0              3.4555091    
   1300000   6363.961       200            200            0.003691186   -0.0025118818   0              0.01358544     9.0281742e-05  0              8.7187645      1.1965779e-13  0              3.4555089    
   1400000   6363.961       200            200            0.0036916118  -0.002511923    0              0.013586758    7.0346565e-06  0              0.67935677     1.1965779e-13  0              3.4555086    
   1500000   6363.961       200            200            0.003691855   -0.0025119462   0              0.013587511    3.4448861e-07  0              0.033268244    1.1965779e-13  0              3.4555085    
   1600000   6363.961       200            200            0.0036919688  -0.0025119569   0              0.013587863    3.1132414e-09  0              0.00030065457  1.1965779e-13  0              3.4555084    
   1700000   6363.961       200            200            0.0036920162  -0.0025119613   0              0.01358801     1.5858573e-09  0              0.00015315074  1.1965779e-13  0              3.4555084    
   1800000   6363.961       200            200            0.0036920342  -0.002511963    0              0.013588066    1.26471e-09    0              0.00012213664  1.1965779e-13  0              3.4555084    
   1900000   6363.961       200            200            0.0036920405  -0.0025119636   0              0.013588085    3.8708861e-10  0              3.7382247e-05  1.1965779e-13  0              3.4555084    
   2000000   6363.961       200            200            0.0036920425  -0.0025119638   0              0.013588091    8.2101589e-11  0              7.9287838e-06  1.1965779e-13  0              3.4555084    
   2100000   6363.961       200            200            0.0036920431  -0.0025119638   0              0.013588093    1.390299e-11   0              1.3426513e-06  1.1965779e-13  0              3.4555084    
   2200000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    1.9720117e-12  0              1.9044277e-07  1.1965779e-13  0              3.4555084    
   2300000   6363.961       200            200            0.0036920433  -0.0025119639   0              0.013588094    2.3654981e-13  0              2.2844287e-08  1.1965779e-13  0              3.4555084    
   2400000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    2.3665333e-14  0              2.2854285e-09  1.1965779e-13  0              3.4555084    
   2500000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    1.8553323e-15  0              1.7917472e-10  1.1965779e-13  0              3.4555084    
   2600000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    1.1182013e-16  0              1.0798788e-11  1.1965779e-13  0              3.4555084    
   2700000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    2.2910842e-17  0              2.2125652e-12  1.1965779e-13  0              3.4555084    
   2800000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    1.058187e-17   0              1.0219212e-12  1.1965779e-13  0              3.4555084    
   2900000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    1.3773727e-18  0              1.330168e-13   1.1965779e-13  0              3.4555084    
   3000000   6363.961       200            200            0.0036920432  -0.0025119639   0              0.013588094    1.5874197e-19  0              1.5330164e-14  1.1965779e-13  0              3.4555084    
Loop time of 286.6 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9043965.930 ns/day, 0.000 hours/ns, 10467.553 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.917     | 38.494     | 66.616     | 440.9 | 13.43
Neigh   | 1.5057     | 1.5225     | 1.5391     |   1.0 |  0.53
Comm    | 12.264     | 17.351     | 21.516     |  93.0 |  6.05
Output  | 0.24018    | 0.2405     | 0.24084    |   0.1 |  0.08
Modify  | 168.47     | 173.39     | 178.76     |  32.7 | 60.50
Other   |            | 55.6       |            |       | 19.40

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         354.75 ave         710 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1419
Ave neighs/atom = 0.56737305
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.93                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.9196030849932
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.03
  ghost atom cutoff = 4.03
  binsize = 2.015, bins = 3159 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 46.22 | 46.23 | 46.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0002028189  -6.3466234e-35  0             -0.00060845671  608368.85      0              5.8751909e+10  1.1965779e-13  0              3.523468     
    200000   6363.961       200            200           -0.00029552697  5.0774512e-35  0             -0.00088658091  22696.927      0              2.1919068e+09  1.1965779e-13  0              3.6044301    
    300000   6363.961       200            200           -2.8528757e-06  1.243139e-40   0             -8.5586272e-06  1.4591604      0              140915.27      1.1965779e-13  0              3.5024339    
    400000   6363.961       200            200            1.9831612e-05  1.5400657e-41  0              5.9494836e-05  75.651847      0              7305913.9      1.1965779e-13  0              3.4700902    
    500000   6363.961       200            200            0.0018396046  -0.0022492054   0              0.0077680191   1001.8071      0              96747363       1.1965779e-13  0              3.4615688    
    600000   6363.961       200            200            0.0054476892  -0.0027327872   0              0.019075855    3.5602221      0              343820.77      1.1965779e-13  0              3.4596734    
    700000   6363.961       200            200            0.0043228706  -0.0025264292   0              0.015495041    1.634336       0              157832.48      1.1965779e-13  0              3.4602082    
    800000   6363.961       200            200            0.003903073   -0.0025294736   0              0.014238693    0.64000282     0              61806.891      1.1965779e-13  0              3.4604083    
    900000   6363.961       200            200            0.0037659943  -0.0025096639   0              0.013807647    0.16655705     0              16084.888      1.1965779e-13  0              3.4604785    
   1000000   6363.961       200            200            0.0037196043  -0.0025053561   0              0.013664169    0.035798783    0              3457.1902      1.1965779e-13  0              3.4605021    
   1100000   6363.961       200            200            0.0037055568  -0.0025040857   0              0.013620756    0.0064005106   0              618.1155       1.1965779e-13  0              3.4605092    
   1200000   6363.961       200            200            0.0037018794  -0.0025037557   0              0.013609394    0.00098218006  0              94.85192       1.1965779e-13  0              3.460511     
   1300000   6363.961       200            200            0.0037011594  -0.0025036932   0              0.013607171    0.00013183676  0              12.731851      1.1965779e-13  0              3.4605113    
   1400000   6363.961       200            200            0.0037011436  -0.0025036933   0              0.013607124    1.546827e-05   0              1.4938148      1.1965779e-13  0              3.4605113    
   1500000   6363.961       200            200            0.0037012294  -0.0025037019   0              0.01360739     1.5536145e-06  0              0.15003697     1.1965779e-13  0              3.4605113    
   1600000   6363.961       200            200            0.0037012926  -0.0025037079   0              0.013607586    1.2629593e-07  0              0.012196757    1.1965779e-13  0              3.4605113    
   1700000   6363.961       200            200            0.0037013258  -0.0025037111   0              0.013607689    7.1343101e-09  0              0.00068898061  1.1965779e-13  0              3.4605112    
   1800000   6363.961       200            200            0.003701341   -0.0025037125   0              0.013607735    1.4651017e-10  0              1.4148904e-05  1.1965779e-13  0              3.4605112    
   1900000   6363.961       200            200            0.0037013472  -0.0025037131   0              0.013607755    7.7591774e-12  0              7.4932581e-07  1.1965779e-13  0              3.4605112    
   2000000   6363.961       200            200            0.0037013496  -0.0025037133   0              0.013607762    1.3037275e-11  0              1.2590467e-06  1.1965779e-13  0              3.4605112    
   2100000   6363.961       200            200            0.0037013505  -0.0025037134   0              0.013607765    4.793473e-12   0              4.6291931e-07  1.1965779e-13  0              3.4605112    
   2200000   6363.961       200            200            0.0037013508  -0.0025037134   0              0.013607766    1.1422363e-12  0              1.10309e-07    1.1965779e-13  0              3.4605112    
   2300000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    2.1585269e-13  0              2.0845508e-08  1.1965779e-13  0              3.4605112    
   2400000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    3.4501778e-14  0              3.3319347e-09  1.1965779e-13  0              3.4605112    
   2500000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    4.8264966e-15  0              4.6610849e-10  1.1965779e-13  0              3.4605112    
   2600000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    6.0318062e-16  0              5.8250867e-11  1.1965779e-13  0              3.4605112    
   2700000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    8.5914419e-17  0              8.2969997e-12  1.1965779e-13  0              3.4605112    
   2800000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    6.7981643e-18  0              6.5651805e-13  1.1965779e-13  0              3.4605112    
   2900000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    2.6780925e-18  0              2.5863101e-13  1.1965779e-13  0              3.4605112    
   3000000   6363.961       200            200            0.0037013509  -0.0025037134   0              0.013607766    1.4792689e-18  0              1.428572e-13   1.1965779e-13  0              3.4605112    
Loop time of 282.085 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9188732.351 ns/day, 0.000 hours/ns, 10635.107 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.96      | 37.535     | 64.484     | 430.0 | 13.31
Neigh   | 1.4953     | 1.5125     | 1.5294     |   1.0 |  0.54
Comm    | 12.136     | 17.16      | 21.458     |  93.2 |  6.08
Output  | 0.24149    | 0.24181    | 0.24216    |   0.1 |  0.09
Modify  | 165.41     | 170.66     | 176.29     |  35.7 | 60.50
Other   |            | 54.98      |            |       | 19.49

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.25 ave         663 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1325
Ave neighs/atom = 0.52978808
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.94                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.4546997755443
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.04
  ghost atom cutoff = 4.04
  binsize = 2.02, bins = 3151 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 46.14 | 46.14 | 46.15 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00021686681 -5.0771382e-35  0             -0.00065060044  600545.98      0              5.7996432e+10  1.1965779e-13  0              3.5336263    
    200000   6363.961       200            200           -0.00028797063 -1.269322e-34   0             -0.0008639119   21167.411      0              2.0441971e+09  1.1965779e-13  0              3.6107782    
    300000   6363.961       200            200            9.8583061e-06 -2.0308675e-34  0              2.9574918e-05  18.659917      0              1802041.2      1.1965779e-13  0              3.5074111    
    400000   6363.961       200            200            3.3842402e-05  1.0154866e-34  0              0.00010152721  215.90143      0              20850215       1.1965779e-13  0              3.474952     
    500000   6363.961       200            200            0.0014770847  -0.0015896601   0              0.0060209143   799.86315      0              77245058       1.1965779e-13  0              3.4669797    
    600000   6363.961       200            200            0.0053220414  -0.0027318444   0              0.018697968    24.926696      0              2407241.9      1.1965779e-13  0              3.4647311    
    700000   6363.961       200            200            0.0043557044  -0.0025176944   0              0.015584808    0.00064107313  0              61.910254      1.1965779e-13  0              3.4651993    
    800000   6363.961       200            200            0.0039348298  -0.0025224604   0              0.01432695     0.083847784    0              8097.4188      1.1965779e-13  0              3.4653996    
    900000   6363.961       200            200            0.0037894935  -0.0025027554   0              0.013871236    0.047173913    0              4555.7189      1.1965779e-13  0              3.465474     
   1000000   6363.961       200            200            0.0037368097  -0.0024977442   0              0.013708173    0.015340238    0              1481.4504      1.1965779e-13  0              3.4655008    
   1100000   6363.961       200            200            0.0037187313  -0.0024961075   0              0.013652301    0.0036581232   0              353.27535      1.1965779e-13  0              3.46551      
   1200000   6363.961       200            200            0.0037129263  -0.002495582    0              0.013634361    0.0007084241   0              68.414528      1.1965779e-13  0              3.4655129    
   1300000   6363.961       200            200            0.0037112056  -0.0024954271   0              0.013629044    0.00011890169  0              11.482674      1.1965779e-13  0              3.4655138    
   1400000   6363.961       200            200            0.0037107559  -0.0024953872   0              0.013627655    1.7802944e-05  0              1.7192809      1.1965779e-13  0              3.465514     
   1500000   6363.961       200            200            0.0037106659  -0.0024953795   0              0.013627377    2.405809e-06   0              0.23233581     1.1965779e-13  0              3.4655141    
   1600000   6363.961       200            200            0.0037106621  -0.0024953793   0              0.013627365    2.9349825e-07  0              0.02834396     1.1965779e-13  0              3.4655141    
   1700000   6363.961       200            200            0.0037106714  -0.0024953803   0              0.013627395    3.196892e-08   0              0.0030873294   1.1965779e-13  0              3.4655141    
   1800000   6363.961       200            200            0.0037106787  -0.002495381    0              0.013627417    3.0235331e-09  0              0.00029199118  1.1965779e-13  0              3.4655141    
   1900000   6363.961       200            200            0.0037106826  -0.0024953813   0              0.013627429    2.3309568e-10  0              2.2510713e-05  1.1965779e-13  0              3.4655141    
   2000000   6363.961       200            200            0.0037106844  -0.0024953815   0              0.013627435    1.2381433e-11  0              1.1957102e-06  1.1965779e-13  0              3.4655141    
   2100000   6363.961       200            200            0.0037106852  -0.0024953816   0              0.013627437    2.1310188e-13  0              2.0579855e-08  1.1965779e-13  0              3.4655141    
   2200000   6363.961       200            200            0.0037106855  -0.0024953816   0              0.013627438    2.0701998e-14  0              1.9992508e-09  1.1965779e-13  0              3.4655141    
   2300000   6363.961       200            200            0.0037106856  -0.0024953816   0              0.013627439    2.7287633e-14  0              2.6352443e-09  1.1965779e-13  0              3.4655141    
   2400000   6363.961       200            200            0.0037106857  -0.0024953816   0              0.013627439    1.0085413e-14  0              9.7397697e-10  1.1965779e-13  0              3.4655141    
   2500000   6363.961       200            200            0.0037106857  -0.0024953816   0              0.013627439    2.3611162e-15  0              2.280197e-10   1.1965779e-13  0              3.4655141    
   2600000   6363.961       200            200            0.0037106857  -0.0024953816   0              0.013627439    4.4047948e-16  0              4.2538356e-11  1.1965779e-13  0              3.4655141    
   2700000   6363.961       200            200            0.0037106857  -0.0024953816   0              0.013627439    4.572674e-17   0              4.4159613e-12  1.1965779e-13  0              3.4655141    
   2800000   6363.961       200            200            0.0037106857  -0.0024953816   0              0.013627439    5.3247101e-21  0              5.1422239e-16  1.1965779e-13  0              3.4655141    
   2900000   6363.961       200            200            0.0037106857  -0.0024953816   0              0.013627439    7.7535179e-18  0              7.4877927e-13  1.1965779e-13  0              3.4655141    
   3000000   6363.961       200            200            0.0037106857  -0.0024953816   0              0.013627439    1.070158e-18   0              1.033482e-13   1.1965779e-13  0              3.4655141    
Loop time of 282.247 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9183444.504 ns/day, 0.000 hours/ns, 10628.987 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.951     | 37.589     | 64.577     | 430.7 | 13.32
Neigh   | 1.396      | 1.4119     | 1.4273     |   1.0 |  0.50
Comm    | 12.063     | 17.011     | 21.237     |  91.6 |  6.03
Output  | 0.24139    | 0.2417     | 0.24204    |   0.1 |  0.09
Modify  | 165.39     | 170.84     | 176.77     |  37.1 | 60.53
Other   |            | 55.16      |            |       | 19.54

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.75 ave         668 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1335
Ave neighs/atom = 0.53378649
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.95                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.9925195986076
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.05
  ghost atom cutoff = 4.05
  binsize = 2.025, bins = 3143 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.42 | 45.43 | 45.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00023069465  5.0773089e-35  0             -0.00069208394  592778.47      0              5.7246302e+10  1.1965779e-13  0              3.5437541    
    200000   6363.961       200            200           -0.00028023516 -1.5231843e-34  0             -0.00084070549  19692.593      0              1.9017697e+09  1.1965779e-13  0              3.6170785    
    300000   6363.961       200            200            2.2749801e-05  3.0463957e-34  0              6.8249404e-05  96.842605      0              9352365.6      1.1965779e-13  0              3.5123271    
    400000   6363.961       200            200            4.8057512e-05 -3.1733093e-36  0              0.00014417254  427.68332      0              41302594       1.1965779e-13  0              3.4797412    
    500000   6363.961       200            200            0.001136439   -0.001261485    0              0.0046708019   582.32672      0              56236946       1.1965779e-13  0              3.4723397    
    600000   6363.961       200            200            0.0050920069  -0.0027207567   0              0.017996778    60.349674      0              5828139.6      1.1965779e-13  0              3.469836     
    700000   6363.961       200            200            0.0043384     -0.0025057119   0              0.015520912    1.7538466      0              169373.95      1.1965779e-13  0              3.4702144    
    800000   6363.961       200            200            0.0039450088  -0.002512725    0              0.014347752    0.061293241    0              5919.2625      1.1965779e-13  0              3.4704019    
    900000   6363.961       200            200            0.0038041024  -0.0024935269   0              0.013905834    5.7188937e-07  0              0.055228982    1.1965779e-13  0              3.4704742    
   1000000   6363.961       200            200            0.0037507247  -0.0024884005   0              0.013740575    0.0016287176   0              157.28989      1.1965779e-13  0              3.4705014    
   1100000   6363.961       200            200            0.0037310342  -0.0024865854   0              0.013679688    0.00093326516  0              90.128069      1.1965779e-13  0              3.4705115    
   1200000   6363.961       200            200            0.003724016   -0.0024859505   0              0.013657998    0.00027659833  0              26.711887      1.1965779e-13  0              3.4705151    
   1300000   6363.961       200            200            0.0037216115  -0.0024857332   0              0.013650568    6.1921963e-05  0              5.9799799      1.1965779e-13  0              3.4705163    
   1400000   6363.961       200            200            0.0037208242  -0.0024856623   0              0.013648135    1.1763484e-05  0              1.1360331      1.1965779e-13  0              3.4705167    
   1500000   6363.961       200            200            0.0037205809  -0.0024856405   0              0.013647383    1.9917408e-06  0              0.19234807     1.1965779e-13  0              3.4705168    
   1600000   6363.961       200            200            0.0037205116  -0.0024856344   0              0.013647169    3.0786416e-07  0              0.029731317    1.1965779e-13  0              3.4705169    
   1700000   6363.961       200            200            0.0037204945  -0.0024856329   0              0.013647116    4.3962144e-08  0              0.0042455492   1.1965779e-13  0              3.4705169    
   1800000   6363.961       200            200            0.0037204915  -0.0024856326   0              0.013647107    5.825794e-09   0              0.00056261348  1.1965779e-13  0              3.4705169    
   1900000   6363.961       200            200            0.0037204917  -0.0024856327   0              0.013647108    7.15513e-10    0              6.9099124e-05  1.1965779e-13  0              3.4705169    
   2000000   6363.961       200            200            0.0037204922  -0.0024856327   0              0.013647109    8.0830955e-11  0              7.8060751e-06  1.1965779e-13  0              3.4705169    
   2100000   6363.961       200            200            0.0037204925  -0.0024856327   0              0.01364711     8.2613379e-12  0              7.9782088e-07  1.1965779e-13  0              3.4705169    
   2200000   6363.961       200            200            0.0037204927  -0.0024856328   0              0.013647111    7.3892997e-13  0              7.1360568e-08  1.1965779e-13  0              3.4705169    
   2300000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    5.4207233e-14  0              5.2349465e-09  1.1965779e-13  0              3.4705169    
   2400000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    2.5079785e-15  0              2.4220262e-10  1.1965779e-13  0              3.4705169    
   2500000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    2.8146295e-17  0              2.7181677e-12  1.1965779e-13  0              3.4705169    
   2600000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    4.7727114e-18  0              4.6091431e-13  1.1965779e-13  0              3.4705169    
   2700000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    7.7440818e-19  0              7.4786799e-14  1.1965779e-13  0              3.4705169    
   2800000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    6.4863907e-18  0              6.2640919e-13  1.1965779e-13  0              3.4705169    
   2900000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    2.4947845e-18  0              2.4092843e-13  1.1965779e-13  0              3.4705169    
   3000000   6363.961       200            200            0.0037204928  -0.0024856328   0              0.013647111    4.9642519e-18  0              4.7941191e-13  1.1965779e-13  0              3.4705169    
Loop time of 284.128 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9122645.370 ns/day, 0.000 hours/ns, 10558.617 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.971     | 37.743     | 64.983     | 432.4 | 13.28
Neigh   | 1.376      | 1.3904     | 1.405      |   0.9 |  0.49
Comm    | 11.99      | 16.876     | 20.995     |  91.8 |  5.94
Output  | 0.24001    | 0.24033    | 0.24068    |   0.1 |  0.08
Modify  | 166.61     | 172.2      | 177.87     |  38.2 | 60.61
Other   |            | 55.67      |            |       | 19.59

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.75 ave         674 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1347
Ave neighs/atom = 0.53858457
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.96                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 71.5330694656869
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.06
  ghost atom cutoff = 4.06
  binsize = 2.03, bins = 3135 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.34 | 45.34 | 45.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.000244303    6.9622713e-41  0             -0.000732909    585066.21      0              5.6501506e+10  1.1965779e-13  0              3.5538511    
    200000   6363.961       200            200           -0.00027232147  1.015484e-34   0             -0.0008169644   18272.32       0              1.7646099e+09  1.1965779e-13  0              3.6233309    
    300000   6363.961       200            200            3.5820335e-05 -1.0154488e-34  0              0.000107461    235.79152      0              22771057       1.1965779e-13  0              3.5171818    
    400000   6363.961       200            200            6.2475193e-05  2.5386891e-35  0              0.00018742558  710.67985      0              68632373       1.1965779e-13  0              3.4844578    
    500000   6363.961       200            200            0.0008843413  -0.0010296973   0              0.0036827212   375.9561       0              36307150       1.1965779e-13  0              3.4776395    
    600000   6363.961       200            200            0.0047904606  -0.0026643364   0              0.017035718    100.85591      0              9739941.8      1.1965779e-13  0              3.4749814    
    700000   6363.961       200            200            0.0042735334  -0.0024898657   0              0.015310466    6.3343461      0              611725.81      1.1965779e-13  0              3.4752525    
    800000   6363.961       200            200            0.0039333532  -0.0025007908   0              0.01430085     0.57688265     0              55711.197      1.1965779e-13  0              3.4754151    
    900000   6363.961       200            200            0.00380883    -0.0024830185   0              0.013909509    0.046377316    0              4478.7893      1.1965779e-13  0              3.4754794    
   1000000   6363.961       200            200            0.0037603271  -0.0024782998   0              0.013759281    0.0024218807   0              233.8879       1.1965779e-13  0              3.4755043    
   1100000   6363.961       200            200            0.0037416433  -0.002476543    0              0.013701473    2.5357775e-05  0              2.4488724      1.1965779e-13  0              3.4755139    
   1200000   6363.961       200            200            0.0037345301  -0.0024758983   0              0.013679489    1.0276681e-05  0              0.99244831     1.1965779e-13  0              3.4755176    
   1300000   6363.961       200            200            0.0037318859  -0.0024756595   0              0.013671317    9.0133241e-06  0              0.87044232     1.1965779e-13  0              3.4755189    
   1400000   6363.961       200            200            0.003730928   -0.0024755731   0              0.013668357    3.040894e-06   0              0.29366777     1.1965779e-13  0              3.4755194    
   1500000   6363.961       200            200            0.0037305901  -0.0024755427   0              0.013667313    7.3824272e-07  0              0.071294198    1.1965779e-13  0              3.4755196    
   1600000   6363.961       200            200            0.0037304743  -0.0024755323   0              0.013666955    1.5030155e-07  0              0.014515048    1.1965779e-13  0              3.4755196    
   1700000   6363.961       200            200            0.003730436   -0.0024755289   0              0.013666837    2.7282452e-08  0              0.0026347439   1.1965779e-13  0              3.4755197    
   1800000   6363.961       200            200            0.0037304238  -0.0024755278   0              0.013666799    4.5506282e-09  0              0.0004394671   1.1965779e-13  0              3.4755197    
   1900000   6363.961       200            200            0.0037304201  -0.0024755275   0              0.013666788    7.0907244e-10  0              6.8477141e-05  1.1965779e-13  0              3.4755197    
   2000000   6363.961       200            200            0.0037304191  -0.0024755274   0              0.013666785    1.0417512e-10  0              1.0060487e-05  1.1965779e-13  0              3.4755197    
   2100000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    1.4507493e-11  0              1.4010299e-06  1.1965779e-13  0              3.4755197    
   2200000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    1.9178783e-12  0              1.8521496e-07  1.1965779e-13  0              3.4755197    
   2300000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    2.4048967e-13  0              2.3224771e-08  1.1965779e-13  0              3.4755197    
   2400000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    2.8717953e-14  0              2.7733743e-09  1.1965779e-13  0              3.4755197    
   2500000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    3.1807868e-15  0              3.0717763e-10  1.1965779e-13  0              3.4755197    
   2600000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    3.532725e-16   0              3.4116529e-11  1.1965779e-13  0              3.4755197    
   2700000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    6.6361322e-17  0              6.4087015e-12  1.1965779e-13  0              3.4755197    
   2800000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    9.7783668e-18  0              9.4432467e-13  1.1965779e-13  0              3.4755197    
   2900000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    1.2437058e-18  0              1.201082e-13   1.1965779e-13  0              3.4755197    
   3000000   6363.961       200            200            0.0037304188  -0.0024755274   0              0.013666784    1.2150774e-19  0              1.1734348e-14  1.1965779e-13  0              3.4755197    
Loop time of 284.692 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9104580.460 ns/day, 0.000 hours/ns, 10537.709 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.056     | 37.68      | 64.812     | 431.6 | 13.24
Neigh   | 1.3802     | 1.3961     | 1.4113     |   1.0 |  0.49
Comm    | 11.725     | 17.684     | 22.876     | 117.8 |  6.21
Output  | 0.24033    | 0.24067    | 0.24104    |   0.1 |  0.08
Modify  | 168.42     | 172.53     | 177.03     |  27.3 | 60.60
Other   |            | 55.16      |            |       | 19.38

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         340.25 ave         681 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1361
Ave neighs/atom = 0.54418233
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.97                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.076356288286
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.07
  ghost atom cutoff = 4.07
  binsize = 2.035, bins = 3128 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.26 | 45.26 | 45.27 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00025769246  2.5386765e-35  0             -0.00077307737  577409.1       0              5.5762038e+10  1.1965779e-13  0              3.5639173    
    200000   6363.961       200            200           -0.00026423047  7.6159977e-35  0             -0.0007926914   16906.446      0              1.6327035e+09  1.1965779e-13  0              3.6295353    
    300000   6363.961       200            200            4.9068625e-05 -7.9332802e-37  0              0.00014720588  435.29138      0              42037326       1.1965779e-13  0              3.5219749    
    400000   6363.961       200            200            7.7093728e-05  5.0773253e-35  0              0.00023128118  1064.575       0              1.0280903e+08  1.1965779e-13  0              3.4891016    
    500000   6363.961       200            200            0.00072378524 -0.00083516285  0              0.0030065186   202.35125      0              19541636       1.1965779e-13  0              3.4828719    
    600000   6363.961       200            200            0.0044203015  -0.0026346786   0              0.015895583    136.56993      0              13188947       1.1965779e-13  0              3.4801585    
    700000   6363.961       200            200            0.0041678814  -0.0024700429   0              0.014973687    12.32358       0              1190123.1      1.1965779e-13  0              3.4803108    
    800000   6363.961       200            200            0.0039018138  -0.0024875199   0              0.014192961    1.4329207      0              138381.23      1.1965779e-13  0              3.4804383    
    900000   6363.961       200            200            0.0038038047  -0.0024727165   0              0.013884131    0.16426443     0              15863.483      1.1965779e-13  0              3.4804895    
   1000000   6363.961       200            200            0.0037651423  -0.0024688206   0              0.013764248    0.017315621    0              1672.2187      1.1965779e-13  0              3.4805095    
   1100000   6363.961       200            200            0.0037498849  -0.0024673429   0              0.013716997    0.0016242044   0              156.85403      1.1965779e-13  0              3.4805174    
   1200000   6363.961       200            200            0.0037438497  -0.0024667751   0              0.013698324    0.00012810635  0              12.371595      1.1965779e-13  0              3.4805205    
   1300000   6363.961       200            200            0.0037414803  -0.0024665576   0              0.013690999    7.4943585e-06  0              0.7237515      1.1965779e-13  0              3.4805217    
   1400000   6363.961       200            200            0.0037405634  -0.0024664744   0              0.013688165    2.1598107e-07  0              0.020857905    1.1965779e-13  0              3.4805222    
   1500000   6363.961       200            200            0.003740215   -0.0024664429   0              0.013687088    9.3699391e-10  0              9.0488165e-05  1.1965779e-13  0              3.4805223    
   1600000   6363.961       200            200            0.0037400849  -0.0024664311   0              0.013686686    7.2128479e-09  0              0.00069656522  1.1965779e-13  0              3.4805224    
   1700000   6363.961       200            200            0.0037400372  -0.0024664268   0              0.013686538    3.3305366e-09  0              0.00032163938  1.1965779e-13  0              3.4805224    
   1800000   6363.961       200            200            0.0037400199  -0.0024664253   0              0.013686485    9.3462212e-10  0              9.0259115e-05  1.1965779e-13  0              3.4805224    
   1900000   6363.961       200            200            0.0037400138  -0.0024664248   0              0.013686466    2.0966192e-10  0              2.0247647e-05  1.1965779e-13  0              3.4805225    
   2000000   6363.961       200            200            0.0037400117  -0.0024664246   0              0.01368646     4.1247862e-11  0              3.9834233e-06  1.1965779e-13  0              3.4805225    
   2100000   6363.961       200            200            0.003740011   -0.0024664245   0              0.013686457    7.4230728e-12  0              7.1686723e-07  1.1965779e-13  0              3.4805225    
   2200000   6363.961       200            200            0.0037400107  -0.0024664245   0              0.013686457    1.2498293e-12  0              1.2069957e-07  1.1965779e-13  0              3.4805225    
   2300000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    1.992704e-13   0              1.9244109e-08  1.1965779e-13  0              3.4805225    
   2400000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    3.0293526e-14  0              2.9255319e-09  1.1965779e-13  0              3.4805225    
   2500000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    4.4624358e-15  0              4.3095011e-10  1.1965779e-13  0              3.4805225    
   2600000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    6.194543e-16   0              5.9822463e-11  1.1965779e-13  0              3.4805225    
   2700000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    6.5637252e-17  0              6.338776e-12   1.1965779e-13  0              3.4805225    
   2800000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    2.0131183e-19  0              1.9441255e-14  1.1965779e-13  0              3.4805225    
   2900000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    1.2742009e-18  0              1.230532e-13   1.1965779e-13  0              3.4805225    
   3000000   6363.961       200            200            0.0037400106  -0.0024664245   0              0.013686456    7.9051793e-19  0              7.6342563e-14  1.1965779e-13  0              3.4805225    
Loop time of 283.595 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9139791.419 ns/day, 0.000 hours/ns, 10578.462 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.928     | 37.783     | 65.123     | 433.0 | 13.32
Neigh   | 1.3489     | 1.3654     | 1.3813     |   1.0 |  0.48
Comm    | 11.897     | 16.996     | 21.169     |  93.8 |  5.99
Output  | 0.24084    | 0.24116    | 0.24151    |   0.1 |  0.09
Modify  | 167.2      | 172.15     | 177.9      |  33.8 | 60.70
Other   |            | 55.06      |            |       | 19.42

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.25 ave         685 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1369
Ave neighs/atom = 0.54738105
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.98                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.6223869779087
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.08
  ghost atom cutoff = 4.08
  binsize = 2.04, bins = 3120 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 45.17 | 45.18 | 45.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0002708636  -1.0154512e-34  0             -0.00081259079  569807.06      0              5.5027888e+10  1.1965779e-13  0              3.5739528    
    200000   6363.961       200            200           -0.00025596311  4.961094e-40   0             -0.00076788933  15594.824      0              1.5060364e+09  1.1965779e-13  0              3.6356915    
    300000   6363.961       200            200            6.2493342e-05  3.0464112e-34  0              0.00018748002  695.12629      0              67130322       1.1965779e-13  0              3.5267065    
    400000   6363.961       200            200            9.1911296e-05 -1.586656e-36   0              0.00027573389  1489.0508      0              1.4380187e+08  1.1965779e-13  0              3.4936725    
    500000   6363.961       200            200            0.00062685188 -0.00071600387  0              0.0025965595   77.114989      0              7447213.7      1.1965779e-13  0              3.4880322    
    600000   6363.961       200            200            0.0039940798  -0.0026816777   0              0.014663917    159.28705      0              15382803       1.1965779e-13  0              3.4853564    
    700000   6363.961       200            200            0.0040318796  -0.0024458401   0              0.014541479    17.89833       0              1728492.6      1.1965779e-13  0              3.485385     
    800000   6363.961       200            200            0.0038547629  -0.002472668    0              0.014036957    2.3059313      0              222690.34      1.1965779e-13  0              3.4854694    
    900000   6363.961       200            200            0.0037910281  -0.0024620585   0              0.013835143    0.29857511     0              28834.247      1.1965779e-13  0              3.4855034    
   1000000   6363.961       200            200            0.003766013   -0.0024595036   0              0.013757542    0.037783055    0              3648.817       1.1965779e-13  0              3.4855166    
   1100000   6363.961       200            200            0.0037560641  -0.002458514    0              0.013726706    0.0046837763   0              452.32559      1.1965779e-13  0              3.4855218    
   1200000   6363.961       200            200            0.0037520519  -0.0024581177   0              0.013714273    0.00057517441  0              55.546228      1.1965779e-13  0              3.4855239    
   1300000   6363.961       200            200            0.0037504505  -0.0024579625   0              0.013709314    7.0236371e-05  0              6.782926       1.1965779e-13  0              3.4855247    
   1400000   6363.961       200            200            0.003749821   -0.0024579027   0              0.013707366    8.4868463e-06  0              0.81959887     1.1965779e-13  0              3.485525     
   1500000   6363.961       200            200            0.0037495754  -0.0024578801   0              0.013706606    1.0127587e-06  0              0.097804984    1.1965779e-13  0              3.4855252    
   1600000   6363.961       200            200            0.0037494802  -0.0024578714   0              0.013706312    1.1914103e-07  0              0.011505788    1.1965779e-13  0              3.4855252    
   1700000   6363.961       200            200            0.0037494436  -0.002457868    0              0.013706199    1.3787761e-08  0              0.0013315233   1.1965779e-13  0              3.4855252    
   1800000   6363.961       200            200            0.0037494295  -0.0024578668   0              0.013706155    1.565395e-09   0              0.00015117465  1.1965779e-13  0              3.4855252    
   1900000   6363.961       200            200            0.0037494242  -0.0024578663   0              0.013706139    1.7373255e-10  0              1.6777846e-05  1.1965779e-13  0              3.4855252    
   2000000   6363.961       200            200            0.0037494222  -0.0024578661   0              0.013706133    1.8750946e-11  0              1.8108321e-06  1.1965779e-13  0              3.4855252    
   2100000   6363.961       200            200            0.0037494214  -0.002457866    0              0.01370613     1.9530924e-12  0              1.8861568e-07  1.1965779e-13  0              3.4855252    
   2200000   6363.961       200            200            0.0037494211  -0.002457866    0              0.013706129    1.9507751e-13  0              1.883919e-08   1.1965779e-13  0              3.4855252    
   2300000   6363.961       200            200            0.003749421   -0.002457866    0              0.013706129    1.8458825e-14  0              1.7826211e-09  1.1965779e-13  0              3.4855252    
   2400000   6363.961       200            200            0.0037494209  -0.002457866    0              0.013706129    1.4550441e-15  0              1.4051774e-10  1.1965779e-13  0              3.4855252    
   2500000   6363.961       200            200            0.0037494209  -0.002457866    0              0.013706129    1.048348e-16   0              1.0124195e-11  1.1965779e-13  0              3.4855252    
   2600000   6363.961       200            200            0.0037494209  -0.002457866    0              0.013706129    1.1695374e-17  0              1.1294555e-12  1.1965779e-13  0              3.4855252    
   2700000   6363.961       200            200            0.0037494209  -0.002457866    0              0.013706129    1.5529676e-17  0              1.499745e-12   1.1965779e-13  0              3.4855252    
   2800000   6363.961       200            200            0.0037494209  -0.002457866    0              0.013706129    1.2014201e-17  0              1.1602456e-12  1.1965779e-13  0              3.4855252    
   2900000   6363.961       200            200            0.0037494209  -0.002457866    0              0.013706129    4.4526932e-18  0              4.3000924e-13  1.1965779e-13  0              3.4855252    
   3000000   6363.961       200            200            0.0037494209  -0.002457866    0              0.013706129    2.4098456e-18  0              2.3272564e-13  1.1965779e-13  0              3.4855252    
Loop time of 287.617 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9011987.243 ns/day, 0.000 hours/ns, 10430.541 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.064     | 38.05      | 65.605     | 436.0 | 13.23
Neigh   | 1.3449     | 1.3596     | 1.374      |   0.9 |  0.47
Comm    | 11.754     | 17.672     | 22.829     | 117.3 |  6.14
Output  | 0.24224    | 0.24256    | 0.24291    |   0.1 |  0.08
Modify  | 171.26     | 175.13     | 179.39     |  25.1 | 60.89
Other   |            | 55.16      |            |       | 19.18

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         345.25 ave         691 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1381
Ave neighs/atom = 0.55217913
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.99                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 73.171168446059
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.09
  ghost atom cutoff = 4.09
  binsize = 2.045, bins = 3112 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.47 | 44.48 | 44.48 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00028381701 -1.7770506e-34  0             -0.00085145104  562259.98      0              5.4299045e+10  1.1965779e-13  0              3.5839574    
    200000   6363.961       200            200           -0.00024752027 -3.8079729e-35  0             -0.00074256081  14337.299      0              1.3845938e+09  1.1965779e-13  0              3.6417996    
    300000   6363.961       200            200            7.6093303e-05  1.0154852e-34  0              0.00022827991  1015.0837      0              98029521       1.1965779e-13  0              3.5313763    
    400000   6363.961       200            200            0.00010692632 -1.1423917e-34  0              0.00032077895  1983.7972      0              1.9158093e+08  1.1965779e-13  0              3.4981704    
    500000   6363.961       200            200            0.00058908717 -0.00064857355  0              0.002415835    10.125959      0              977892.62      1.1965779e-13  0              3.493117     
    600000   6363.961       200            200            0.0035920052  -0.0026472137   0              0.013423229    164.28848      0              15865805       1.1965779e-13  0              3.4905636    
    700000   6363.961       200            200            0.0038826948  -0.0024038168   0              0.014051901    21.40025       0              2066683        1.1965779e-13  0              3.4904696    
    800000   6363.961       200            200            0.0037975468  -0.0024577067   0              0.013850347    2.8700397      0              277167.89      1.1965779e-13  0              3.4905057    
    900000   6363.961       200            200            0.0037732948  -0.0024509673   0              0.013770852    0.38693262     0              37367.183      1.1965779e-13  0              3.4905199    
   1000000   6363.961       200            200            0.0037643504  -0.0024500103   0              0.013743061    0.051997655    0              5021.5613      1.1965779e-13  0              3.4905249    
   1100000   6363.961       200            200            0.0037609096  -0.0024496477   0              0.013732376    0.0069893915   0              674.98541      1.1965779e-13  0              3.4905268    
   1200000   6363.961       200            200            0.0037595749  -0.002449502    0              0.013728227    0.00094166692  0              90.939451      1.1965779e-13  0              3.4905276    
   1300000   6363.961       200            200            0.0037590819  -0.0024494453   0              0.013726691    0.00012692432  0              12.257442      1.1965779e-13  0              3.4905279    
   1400000   6363.961       200            200            0.0037588999  -0.0024494275   0              0.013726127    1.7109969e-05  0              1.6523584      1.1965779e-13  0              3.490528     
   1500000   6363.961       200            200            0.0037588332  -0.002449421    0              0.013725921    2.3065392e-06  0              0.22274904     1.1965779e-13  0              3.490528     
   1600000   6363.961       200            200            0.0037588088  -0.0024494186   0              0.013725845    3.109386e-07   0              0.030028224    1.1965779e-13  0              3.490528     
   1700000   6363.961       200            200            0.0037587998  -0.0024494177   0              0.013725817    4.1916873e-08  0              0.0040480315   1.1965779e-13  0              3.490528     
   1800000   6363.961       200            200            0.0037587965  -0.0024494174   0              0.013725807    5.6506321e-09  0              0.0005456976   1.1965779e-13  0              3.490528     
   1900000   6363.961       200            200            0.0037587953  -0.0024494173   0              0.013725803    7.6176623e-10  0              7.356593e-05   1.1965779e-13  0              3.490528     
   2000000   6363.961       200            200            0.0037587949  -0.0024494172   0              0.013725802    1.0269678e-10  0              9.9177195e-06  1.1965779e-13  0              3.490528     
   2100000   6363.961       200            200            0.0037587947  -0.0024494172   0              0.013725801    1.3846221e-11  0              1.3371689e-06  1.1965779e-13  0              3.490528     
   2200000   6363.961       200            200            0.0037587947  -0.0024494172   0              0.013725801    1.8664374e-12  0              1.8024717e-07  1.1965779e-13  0              3.490528     
   2300000   6363.961       200            200            0.0037587947  -0.0024494172   0              0.013725801    2.516509e-13   0              2.4302643e-08  1.1965779e-13  0              3.490528     
   2400000   6363.961       200            200            0.0037587947  -0.0024494172   0              0.013725801    3.4014986e-14  0              3.2849239e-09  1.1965779e-13  0              3.490528     
   2500000   6363.961       200            200            0.0037587947  -0.0024494172   0              0.013725801    4.5725678e-15  0              4.4158587e-10  1.1965779e-13  0              3.490528     
   2600000   6363.961       200            200            0.0037587946  -0.0024494172   0              0.013725801    6.2586911e-16  0              6.0441959e-11  1.1965779e-13  0              3.490528     
   2700000   6363.961       200            200            0.0037587946  -0.0024494172   0              0.013725801    7.8319971e-17  0              7.5635823e-12  1.1965779e-13  0              3.490528     
   2800000   6363.961       200            200            0.0037587946  -0.0024494172   0              0.013725801    2.3312693e-19  0              2.251373e-14   1.1965779e-13  0              3.490528     
   2900000   6363.961       200            200            0.0037587946  -0.0024494172   0              0.013725801    5.2669091e-19  0              5.0864038e-14  1.1965779e-13  0              3.490528     
   3000000   6363.961       200            200            0.0037587947  -0.0024494172   0              0.013725801    7.9815195e-23  0              7.7079803e-18  1.1965779e-13  0              3.490528     
Loop time of 283.471 on 4 procs for 3000000 steps with 2501 atoms

Performance: 9143787.000 ns/day, 0.000 hours/ns, 10583.087 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.959     | 38.233     | 65.874     | 437.6 | 13.49
Neigh   | 1.3551     | 1.3696     | 1.3842     |   0.9 |  0.48
Comm    | 11.917     | 16.954     | 21.27      |  93.5 |  5.98
Output  | 0.23718    | 0.23751    | 0.23787    |   0.1 |  0.08
Modify  | 166.93     | 171.54     | 176.94     |  31.1 | 60.52
Other   |            | 55.13      |            |       | 19.45

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         347.75 ave         696 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1391
Ave neighs/atom = 0.55617753
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 7:57:49

LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.005 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.51                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.8129947834697
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.61
  ghost atom cutoff = 3.61
  binsize = 1.805, bins = 71 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.73 | 17.2 | 18.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038566635  -2.4210273e-39  0              0.011569991    14829.486      0              7.1606279e+10  2.6109412e-16  0              3.3224693    
    200000   127.27922      200            200           -0.00045936127 -5.8098373e-38  0             -0.0013780838   2717.0378      0              1.3119603e+10  2.6109412e-16  0              3.3038763    
    300000   127.27922      200            200            0.012170772    0.0019450558   0              0.03456726     864.57347      0              4.1747158e+09  2.6109412e-16  0              3.2467144    
    400000   127.27922      200            200            0.00011570134 -2.140637e-36   0              0.00034710402  50.161352      0              2.4221122e+08  2.6109412e-16  0              3.2584439    
    500000   127.27922      200            200            0.0087826889   0.00011555484  0              0.026232512    1.396969       0              6745463.3      2.6109412e-16  0              3.2477661    
    600000   127.27922      200            200            0.0059229226  -1.5695708e-36  0              0.017768768    0.23922313     0              1155122.9      2.6109412e-16  0              3.2493641    
    700000   127.27922      200            200            0.0046028307   5.5953012e-37  0              0.013808492    0.44316066     0              2139864.2      2.6109412e-16  0              3.250234     
    800000   127.27922      200            200            0.0043197152  -1.182677e-36   0              0.012959146    0.028082935    0              135602.44      2.6109412e-16  0              3.2504366    
    900000   127.27922      200            200            0.0044023392   8.9013688e-37  0              0.013207018    0.0013285817   0              6415.2455      2.6109412e-16  0              3.2503808    
   1000000   127.27922      200            200            0.0044681847   1.9853773e-39  0              0.013404554    0.0011744496   0              5670.997       2.6109412e-16  0              3.2503347    
   1100000   127.27922      200            200            0.0044777693  -7.840887e-38   0              0.013433308    3.3957932e-05  0              163.9707       2.6109412e-16  0              3.2503278    
   1200000   127.27922      200            200            0.0044718463   5.2114128e-39  0              0.013415539    7.885543e-06   0              38.076465      2.6109412e-16  0              3.2503318    
   1300000   127.27922      200            200            0.0044686917   3.7034098e-39  0              0.013406075    2.7898141e-06  0              13.471014      2.6109412e-16  0              3.250334     
   1400000   127.27922      200            200            0.0044685024  -1.5883224e-38  0              0.013405507    2.0909212e-08  0              0.1009631      2.6109412e-16  0              3.2503341    
   1500000   127.27922      200            200            0.0044688698   7.585863e-40   0              0.013406609    3.2621704e-08  0              0.15751853     2.6109412e-16  0              3.2503339    
   1600000   127.27922      200            200            0.0044690108   4.8399879e-39  0              0.013407033    5.8207183e-09  0              0.028106165    2.6109412e-16  0              3.2503338    
   1700000   127.27922      200            200            0.0044690054  -3.6550263e-39  0              0.013407016    2.3068182e-13  0              1.1138799e-06  2.6109412e-16  0              3.2503338    
   1800000   127.27922      200            200            0.0044689846   6.5551446e-40  0              0.013406954    1.0973025e-10  0              0.0005298481   2.6109412e-16  0              3.2503338    
   1900000   127.27922      200            200            0.0044689788   8.0945784e-40  0              0.013406936    1.0400122e-11  0              5.0218468e-05  2.6109412e-16  0              3.2503338    
   2000000   127.27922      200            200            0.0044689798  -1.3702891e-39  0              0.013406939    1.63775e-13    0              7.9081086e-07  2.6109412e-16  0              3.2503338    
   2100000   127.27922      200            200            0.0044689809   7.4429614e-39  0              0.013406943    3.1757816e-13  0              1.5334713e-06  2.6109412e-16  0              3.2503338    
   2200000   127.27922      200            200            0.0044689811  -7.242938e-39   0              0.013406943    1.4928671e-14  0              7.2085211e-08  2.6109412e-16  0              3.2503338    
   2300000   127.27922      200            200            0.004468981   -2.4477641e-39  0              0.013406943    1.4357246e-15  0              6.9326005e-09  2.6109412e-16  0              3.2503338    
   2400000   127.27922      200            200            0.004468981    6.5170772e-40  0              0.013406943    8.0852354e-16  0              3.9040708e-09  2.6109412e-16  0              3.2503338    
   2500000   127.27922      200            200            0.004468981    1.4583696e-39  0              0.013406943    1.5879673e-17  0              7.6677259e-11  2.6109412e-16  0              3.2503338    
   2600000   127.27922      200            200            0.004468981    6.0335754e-39  0              0.013406943    7.0601408e-18  0              3.4090893e-11  2.6109412e-16  0              3.2503338    
   2700000   127.27922      200            200            0.004468981   -1.3963448e-40  0              0.013406943    1.4029799e-18  0              6.7744878e-12  2.6109412e-16  0              3.2503338    
   2800000   127.27922      200            200            0.004468981   -1.3145317e-39  0              0.013406943    1.715589e-20   0              8.2839655e-14  2.6109412e-16  0              3.2503338    
   2900000   127.27922      200            200            0.004468981    3.7300157e-39  0              0.013406943    7.0745854e-22  0              3.4160641e-15  2.6109412e-16  0              3.2503338    
   3000000   127.27922      200            200            0.004468981    4.1106322e-39  0              0.013406943    1.0996698e-20  0              5.3099118e-14  2.6109412e-16  0              3.2503338    
Loop time of 73.5396 on 4 procs for 3000000 steps with 51 atoms

Performance: 35246325.724 ns/day, 0.000 hours/ns, 40794.358 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33844    | 1.4368     | 4.6776     | 156.1 |  1.95
Neigh   | 0.060112   | 0.062315   | 0.065739   |   0.9 |  0.08
Comm    | 31.452     | 39.246     | 45.938     |  95.1 | 53.37
Output  | 0.075379   | 0.075655   | 0.075879   |   0.1 |  0.10
Modify  | 16.349     | 23.431     | 32.258     | 146.6 | 31.86
Other   |            | 9.288      |            |       | 12.63

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.52                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.2399609964769
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.62
  ghost atom cutoff = 3.62
  binsize = 1.81, bins = 71 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.73 | 17.2 | 18.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038665085   6.0526391e-40  0              0.011599525    14880.952      0              7.1854792e+10  2.6109412e-16  0              3.322098     
    200000   127.27922      200            200           -0.00045973331 -1.9264852e-38  0             -0.0013791999   2636.9879      0              1.2733071e+10  2.6109412e-16  0              3.3120478    
    300000   127.27922      200            200            0.0064096906   2.6346121e-38  0              0.019229072    904.80359      0              4.3689727e+09  2.6109412e-16  0              3.2538618    
    400000   127.27922      200            200            0.00013004622 -4.3126675e-36  0              0.00039013865  62.381789      0              3.0121934e+08  2.6109412e-16  0              3.2628503    
    500000   127.27922      200            200            0.0089753048   0.00017351969  0              0.026752395    0.027193414    0              131307.26      2.6109412e-16  0              3.252701     
    600000   127.27922      200            200            0.0058097625  -1.549248e-36   0              0.017429287    0.73087619     0              3529139.6      2.6109412e-16  0              3.2544407    
    700000   127.27922      200            200            0.0044886669   3.6890545e-37  0              0.013466001    0.47275465     0              2282763        2.6109412e-16  0              3.2553196    
    800000   127.27922      200            200            0.0042996113  -5.5277372e-37  0              0.012898834    0.01340574     0              64731.523      2.6109412e-16  0              3.255458     
    900000   127.27922      200            200            0.0044193558  -1.1880931e-37  0              0.013258067    0.0033577675   0              16213.458      2.6109412e-16  0              3.2553758    
   1000000   127.27922      200            200            0.004482828   -9.3343324e-39  0              0.013448484    0.0010995563   0              5309.3638      2.6109412e-16  0              3.2553314    
   1100000   127.27922      200            200            0.0044856025   8.9718201e-39  0              0.013456808    4.2895654e-06  0              20.712776      2.6109412e-16  0              3.2553291    
   1200000   127.27922      200            200            0.0044778281   5.121859e-39   0              0.013433484    1.4955169e-05  0              72.21316       2.6109412e-16  0              3.2553344    
   1300000   127.27922      200            200            0.0044751295  -1.3273992e-38  0              0.013425389    2.0657239e-06  0              9.9746414      2.6109412e-16  0              3.2553363    
   1400000   127.27922      200            200            0.0044753738  -5.1481408e-39  0              0.013426121    8.6922192e-09  0              0.041971616    2.6109412e-16  0              3.2553362    
   1500000   127.27922      200            200            0.0044758121  -3.6347149e-39  0              0.013427436    4.946041e-08   0              0.23882662     2.6109412e-16  0              3.2553359    
   1600000   127.27922      200            200            0.0044759101  -6.1204809e-39  0              0.01342773     2.9083611e-09  0              0.014043435    2.6109412e-16  0              3.2553358    
   1700000   127.27922      200            200            0.0044758802   6.6616993e-39  0              0.013427641    1.9485383e-10  0              0.00094087941  2.6109412e-16  0              3.2553358    
   1800000   127.27922      200            200            0.0044758579   4.3975227e-39  0              0.013427574    1.3167014e-10  0              0.00063578797  2.6109412e-16  0              3.2553359    
   1900000   127.27922      200            200            0.0044758553   4.031438e-39   0              0.013427566    2.3852804e-12  0              1.1517665e-05  2.6109412e-16  0              3.2553359    
   2000000   127.27922      200            200            0.0044758576   2.549195e-39   0              0.013427573    1.1894475e-12  0              5.7434161e-06  2.6109412e-16  0              3.2553359    
   2100000   127.27922      200            200            0.0044758586  -6.4358279e-40  0              0.013427576    2.8657523e-13  0              1.3837692e-06  2.6109412e-16  0              3.2553358    
   2200000   127.27922      200            200            0.0044758586  -1.0986781e-38  0              0.013427576    1.5930014e-16  0              7.6920338e-10  2.6109412e-16  0              3.2553358    
   2300000   127.27922      200            200            0.0044758585   5.7905754e-40  0              0.013427575    4.7117861e-15  0              2.2751529e-08  2.6109412e-16  0              3.2553358    
   2400000   127.27922      200            200            0.0044758584   3.7987202e-39  0              0.013427575    4.9323724e-16  0              2.3816661e-09  2.6109412e-16  0              3.2553358    
   2500000   127.27922      200            200            0.0044758584  -2.5296227e-39  0              0.013427575    6.8386848e-18  0              3.3021561e-11  2.6109412e-16  0              3.2553358    
   2600000   127.27922      200            200            0.0044758584  -1.4493706e-39  0              0.013427575    1.4464546e-17  0              6.9844114e-11  2.6109412e-16  0              3.2553358    
   2700000   127.27922      200            200            0.0044758584  -7.4769276e-39  0              0.013427575    1.8552807e-19  0              8.9584865e-13  2.6109412e-16  0              3.2553358    
   2800000   127.27922      200            200            0.0044758584   1.1876426e-39  0              0.013427575    1.7970621e-19  0              8.6773699e-13  2.6109412e-16  0              3.2553358    
   2900000   127.27922      200            200            0.0044758584   5.1872166e-39  0              0.013427575    1.6066928e-21  0              7.7581445e-15  2.6109412e-16  0              3.2553358    
   3000000   127.27922      200            200            0.0044758584  -1.5188062e-39  0              0.013427575    1.9228149e-21  0              9.284585e-15   2.6109412e-16  0              3.2553358    
Loop time of 72.9533 on 4 procs for 3000000 steps with 51 atoms

Performance: 35529600.016 ns/day, 0.000 hours/ns, 41122.222 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.34328    | 1.4403     | 4.6687     | 155.3 |  1.97
Neigh   | 0.057295   | 0.059695   | 0.063191   |   1.0 |  0.08
Comm    | 30.883     | 38.84      | 45.637     |  96.5 | 53.24
Output  | 0.076609   | 0.076813   | 0.077003   |   0.1 |  0.11
Modify  | 16.056     | 23.207     | 32.127     | 147.7 | 31.81
Other   |            | 9.33       |            |       | 12.79

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.53                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.6693600588351
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.63
  ghost atom cutoff = 3.63
  binsize = 1.815, bins = 71 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.73 | 17.2 | 18.36 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.003876353   -1.8157329e-39  0              0.011629059    14932.486      0              7.2103631e+10  2.6109412e-16  0              3.3217143    
    200000   127.27922      200            200           -0.00045987996 -7.7441856e-38  0             -0.0013796399   2558.2094      0              1.2352677e+10  2.6109412e-16  0              3.320175     
    300000   127.27922      200            200            0.0031704945  -1.4840595e-35  0              0.0095114834   906.10215      0              4.375243e+09   2.6109412e-16  0              3.2610351    
    400000   127.27922      200            200            0.00014457152  2.1952926e-36  0              0.00043371455  75.908398      0              3.6653449e+08  2.6109412e-16  0              3.267191     
    500000   127.27922      200            200            0.0088953519   0.00017674215  0              0.026509314    0.74445311     0              3594697.6      2.6109412e-16  0              3.2577376    
    600000   127.27922      200            200            0.0056371362   1.2787871e-35  0              0.016911409    1.3956965      0              6739319.1      2.6109412e-16  0              3.259556     
    700000   127.27922      200            200            0.0043747625  -1.8526097e-38  0              0.013124287    0.45472738     0              2195715.8      2.6109412e-16  0              3.2604059    
    800000   127.27922      200            200            0.0042902007   1.3051089e-36  0              0.012870602    0.003262686    0              15754.343      2.6109412e-16  0              3.2604718    
    900000   127.27922      200            200            0.0044404812   2.9028894e-38  0              0.013321444    0.0056534805   0              27298.634      2.6109412e-16  0              3.2603681    
   1000000   127.27922      200            200            0.0044968846   8.4706536e-38  0              0.013490654    0.00085476235  0              4127.3415      2.6109412e-16  0              3.2603284    
   1100000   127.27922      200            200            0.0044924775  -5.9423881e-38  0              0.013477433    3.5170157e-06  0              16.98241       2.6109412e-16  0              3.2603311    
   1200000   127.27922      200            200            0.0044835887   1.0085541e-39  0              0.013450766    2.0143858e-05  0              97.267482      2.6109412e-16  0              3.2603372    
   1300000   127.27922      200            200            0.0044816604   7.6686433e-39  0              0.013444981    1.0448099e-06  0              5.0450129      2.6109412e-16  0              3.2603386    
   1400000   127.27922      200            200            0.0044823147  -3.8120725e-39  0              0.013446944    1.0032973e-07  0              0.48445637     2.6109412e-16  0              3.2603382    
   1500000   127.27922      200            200            0.0044827617   3.069472e-39   0              0.013448285    5.215551e-08   0              0.25184029     2.6109412e-16  0              3.2603379    
   1600000   127.27922      200            200            0.0044828002   2.3545311e-39  0              0.013448401    4.8665981e-10  0              0.0023499061   2.6109412e-16  0              3.2603378    
   1700000   127.27922      200            200            0.0044827507  -3.0928524e-39  0              0.013448252    6.0679978e-10  0              0.002930019    2.6109412e-16  0              3.2603379    
   1800000   127.27922      200            200            0.0044827314   6.0378055e-40  0              0.013448194    9.9764323e-11  0              0.00048172621  2.6109412e-16  0              3.2603379    
   1900000   127.27922      200            200            0.0044827326   1.9554272e-39  0              0.013448198    2.4399662e-13  0              1.1781724e-06  2.6109412e-16  0              3.2603379    
   2000000   127.27922      200            200            0.0044827356  -2.3437451e-40  0              0.013448207    2.2261385e-12  0              1.0749226e-05  2.6109412e-16  0              3.2603379    
   2100000   127.27922      200            200            0.0044827362  -5.0957591e-40  0              0.013448209    1.2763386e-13  0              6.1629824e-07  2.6109412e-16  0              3.2603379    
   2200000   127.27922      200            200            0.004482736   -2.4955678e-39  0              0.013448208    1.0069914e-14  0              4.8624013e-08  2.6109412e-16  0              3.2603379    
   2300000   127.27922      200            200            0.0044827359   5.919292e-39   0              0.013448208    5.913446e-15   0              2.8553915e-08  2.6109412e-16  0              3.2603379    
   2400000   127.27922      200            200            0.0044827359   6.5845746e-39  0              0.013448208    6.8108338e-17  0              3.2887079e-10  2.6109412e-16  0              3.2603379    
   2500000   127.27922      200            200            0.0044827359   1.3241947e-39  0              0.013448208    6.7211006e-17  0              3.2453789e-10  2.6109412e-16  0              3.2603379    
   2600000   127.27922      200            200            0.0044827359   5.883588e-39   0              0.013448208    1.1145223e-17  0              5.3816295e-11  2.6109412e-16  0              3.2603379    
   2700000   127.27922      200            200            0.0044827359   9.0356575e-40  0              0.013448208    2.1852927e-19  0              1.0551996e-12  2.6109412e-16  0              3.2603379    
   2800000   127.27922      200            200            0.0044827359   2.1307185e-39  0              0.013448208    2.6659075e-19  0              1.2872713e-12  2.6109412e-16  0              3.2603379    
   2900000   127.27922      200            200            0.0044827359   1.1018432e-39  0              0.013448208    9.845489e-20   0              4.7540343e-13  2.6109412e-16  0              3.2603379    
   3000000   127.27922      200            200            0.0044827359   6.3017796e-39  0              0.013448208    9.0231734e-20  0              4.3569675e-13  2.6109412e-16  0              3.2603379    
Loop time of 72.6085 on 4 procs for 3000000 steps with 51 atoms

Performance: 35698305.036 ns/day, 0.000 hours/ns, 41317.483 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33004    | 1.3515     | 4.3511     | 149.0 |  1.86
Neigh   | 0.058889   | 0.061386   | 0.065072   |   1.1 |  0.08
Comm    | 31.039     | 38.932     | 45.572     |  96.3 | 53.62
Output  | 0.075788   | 0.076034   | 0.076288   |   0.1 |  0.10
Modify  | 15.862     | 22.936     | 31.714     | 146.6 | 31.59
Other   |            | 9.251      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.54                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.1011988820483
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.64
  ghost atom cutoff = 3.64
  binsize = 1.82, bins = 70 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.72 | 17.18 | 18.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038861971   1.740524e-43   0              0.011658591    14984.087      0              7.2352795e+10  2.6109412e-16  0              3.3213183    
    200000   127.27922      200            200           -0.00045980221 -1.9342516e-37  0             -0.0013794066   2480.6975      0              1.1978401e+10  2.6109412e-16  0              3.3282577    
    300000   127.27922      200            200            0.00074003156 -3.6911239e-36  0              0.0022200947   878.49514      0              4.2419386e+09  2.6109412e-16  0              3.2681946    
    400000   127.27922      200            200            0.00015927658 -5.8957836e-37  0              0.00047782974  90.73541       0              4.3812882e+08  2.6109412e-16  0              3.2714657    
    500000   127.27922      200            200            0.0085458765   9.0143267e-05  0              0.025547486    3.3950959      0              16393703       2.6109412e-16  0              3.2628742    
    600000   127.27922      200            200            0.0054146417   3.5404515e-36  0              0.016243925    2.114916       0              10212173       2.6109412e-16  0              3.2647049    
    700000   127.27922      200            200            0.0042672137  -2.4955536e-37  0              0.012801641    0.39314765     0              1898369.3      2.6109412e-16  0              3.2654884    
    800000   127.27922      200            200            0.0042924385   1.464302e-36   0              0.012877315    2.3450611e-05  0              113.23461      2.6109412e-16  0              3.2654775    
    900000   127.27922      200            200            0.0044646954   2.1715074e-37  0              0.013394086    0.0075591526   0              36500.443      2.6109412e-16  0              3.2653581    
   1000000   127.27922      200            200            0.0045097435   8.290692e-38   0              0.013529231    0.00052184867  0              2519.8205      2.6109412e-16  0              3.2653262    
   1100000   127.27922      200            200            0.0044983959   1.157186e-37   0              0.013495188    3.163464e-05   0              152.75235      2.6109412e-16  0              3.2653338    
   1200000   127.27922      200            200            0.0044892538   2.0288789e-39  0              0.013467761    2.1197554e-05  0              102.3554       2.6109412e-16  0              3.2653401    
   1300000   127.27922      200            200            0.0044883283  -1.3417639e-38  0              0.013464985    2.2926584e-07  0              1.1070427      2.6109412e-16  0              3.2653408    
   1400000   127.27922      200            200            0.0044893159  -3.2197595e-39  0              0.013467948    2.4413975e-07  0              1.1788635      2.6109412e-16  0              3.2653401    
   1500000   127.27922      200            200            0.0044897071   5.527408e-39   0              0.013469121    3.9145328e-08  0              0.18901878     2.6109412e-16  0              3.2653398    
   1600000   127.27922      200            200            0.0044896788  -3.5857559e-39  0              0.013469036    1.8462009e-10  0              0.00089146435  2.6109412e-16  0              3.2653398    
   1700000   127.27922      200            200            0.0044896182  -5.0365661e-40  0              0.013468855    9.2615919e-10  0              0.0044720913   2.6109412e-16  0              3.2653399    
   1800000   127.27922      200            200            0.0044896058   8.1867571e-40  0              0.013468817    4.0402238e-11  0              0.00019508795  2.6109412e-16  0              3.2653399    
   1900000   127.27922      200            200            0.0044896106   2.8262084e-39  0              0.013468832    5.7922852e-12  0              2.7968872e-05  2.6109412e-16  0              3.2653399    
   2000000   127.27922      200            200            0.0044896136   5.5349825e-39  0              0.013468841    2.2747154e-12  0              1.0983786e-05  2.6109412e-16  0              3.2653399    
   2100000   127.27922      200            200            0.0044896137   4.7837862e-40  0              0.013468841    6.4814809e-15  0              3.1296752e-08  2.6109412e-16  0              3.2653399    
   2200000   127.27922      200            200            0.0044896134  -6.8906227e-39  0              0.01346884     3.3280017e-14  0              1.6069729e-07  2.6109412e-16  0              3.2653399    
   2300000   127.27922      200            200            0.0044896133   2.1978579e-39  0              0.01346884     3.5919812e-15  0              1.7344392e-08  2.6109412e-16  0              3.2653399    
   2400000   127.27922      200            200            0.0044896133  -3.1166793e-39  0              0.01346884     7.5084648e-17  0              3.6255689e-10  2.6109412e-16  0              3.2653399    
   2500000   127.27922      200            200            0.0044896133   9.8583224e-39  0              0.01346884     1.0866413e-16  0              5.2470018e-10  2.6109412e-16  0              3.2653399    
   2600000   127.27922      200            200            0.0044896133  -2.4470262e-39  0              0.01346884     2.6153611e-18  0              1.2628643e-11  2.6109412e-16  0              3.2653399    
   2700000   127.27922      200            200            0.0044896133  -1.2865034e-39  0              0.01346884     1.3287083e-18  0              6.415857e-12   2.6109412e-16  0              3.2653399    
   2800000   127.27922      200            200            0.0044896133  -8.4393773e-39  0              0.01346884     7.9777208e-20  0              3.8521558e-13  2.6109412e-16  0              3.2653399    
   2900000   127.27922      200            200            0.0044896133   2.3315566e-38  0              0.01346884     1.5048876e-19  0              7.2665637e-13  2.6109412e-16  0              3.2653399    
   3000000   127.27922      200            200            0.0044896133  -1.1325582e-38  0              0.01346884     7.9530586e-20  0              3.8402474e-13  2.6109412e-16  0              3.2653399    
Loop time of 72.0136 on 4 procs for 3000000 steps with 51 atoms

Performance: 35993218.721 ns/day, 0.000 hours/ns, 41658.818 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3375     | 1.3402     | 4.3114     | 148.2 |  1.86
Neigh   | 0.050895   | 0.053069   | 0.056321   |   1.0 |  0.07
Comm    | 30.741     | 38.503     | 45.065     |  95.3 | 53.47
Output  | 0.14252    | 0.14274    | 0.14296    |   0.0 |  0.20
Modify  | 15.738     | 22.765     | 31.422     | 145.5 | 31.61
Other   |            | 9.21       |            |       | 12.79

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.55                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.5354843776197
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.65
  ghost atom cutoff = 3.65
  binsize = 1.825, bins = 70 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.72 | 17.18 | 18.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038960407   3.6319552e-39  0              0.011688122    15035.757      0              7.2602289e+10  2.6109412e-16  0              3.3209098    
    200000   127.27922      200            200           -0.00045950098  1.9401356e-38  0             -0.0013785029   2404.446       0              1.1610209e+10  2.6109412e-16  0              3.3362961    
    300000   127.27922      200            200           -0.00033843138 -1.3919252e-36  0             -0.0010152941   833.17516      0              4.0231047e+09  2.6109412e-16  0              3.2753111    
    400000   127.27922      200            200            0.00017416006  2.5363782e-38  0              0.00052248019  106.85663      0              5.1597243e+08  2.6109412e-16  0              3.2756745    
    500000   127.27922      200            200            0.0080527815  -5.5476937e-37  0              0.024158345    7.4361686      0              35906597       2.6109412e-16  0              3.268104     
    600000   127.27922      200            200            0.0051542761  -7.0163911e-37  0              0.015462828    2.7626257      0              13339731       2.6109412e-16  0              3.2698808    
    700000   127.27922      200            200            0.0041716154   4.0193152e-37  0              0.012514846    0.30065583     0              1451759.4      2.6109412e-16  0              3.2705633    
    800000   127.27922      200            200            0.004306605    1.1461139e-36  0              0.012919815    0.0044026712   0              21258.923      2.6109412e-16  0              3.2704748    
    900000   127.27922      200            200            0.0044907513   4.4711835e-38  0              0.013472254    0.0085318788   0              41197.389      2.6109412e-16  0              3.2703469    
   1000000   127.27922      200            200            0.0045208956  -3.4480027e-38  0              0.013562687    0.00021124277  0              1020.0157      2.6109412e-16  0              3.2703252    
   1100000   127.27922      200            200            0.0045034534   3.8613755e-38  0              0.01351036     7.7620582e-05  0              374.80201      2.6109412e-16  0              3.270337     
   1200000   127.27922      200            200            0.0044949594  -2.98525e-39    0              0.013484878    1.7680123e-05  0              85.370988      2.6109412e-16  0              3.2703429    
   1300000   127.27922      200            200            0.0044951593  -1.401214e-38   0              0.013485478    1.5159068e-08  0              0.073197716    2.6109412e-16  0              3.2703428    
   1400000   127.27922      200            200            0.0044963594  -4.5241617e-39  0              0.013489078    3.6039164e-07  0              1.7402022      2.6109412e-16  0              3.270342     
   1500000   127.27922      200            200            0.0044966375   5.8972232e-40  0              0.013489913    1.8480884e-08  0              0.089237576    2.6109412e-16  0              3.2703418    
   1600000   127.27922      200            200            0.0044965458  -1.883522e-39   0              0.013489637    2.1791776e-09  0              0.010522469    2.6109412e-16  0              3.2703419    
   1700000   127.27922      200            200            0.0044964848  -4.9028765e-39  0              0.013489455    9.1586139e-10  0              0.0044223669   2.6109412e-16  0              3.2703419    
   1800000   127.27922      200            200            0.0044964818   1.8071354e-39  0              0.013489445    1.8931625e-12  0              9.1414042e-06  2.6109412e-16  0              3.2703419    
   1900000   127.27922      200            200            0.0044964892   6.1757026e-39  0              0.013489468    1.4029221e-11  0              6.7742086e-05  2.6109412e-16  0              3.2703419    
   2000000   127.27922      200            200            0.0044964915   2.1649298e-39  0              0.013489475    1.2957036e-12  0              6.2564891e-06  2.6109412e-16  0              3.2703419    
   2100000   127.27922      200            200            0.0044964911   3.7001501e-39  0              0.013489473    4.729508e-14   0              2.2837101e-07  2.6109412e-16  0              3.2703419    
   2200000   127.27922      200            200            0.0044964907  -6.1610316e-39  0              0.013489472    4.380992e-14   0              2.1154243e-07  2.6109412e-16  0              3.2703419    
   2300000   127.27922      200            200            0.0044964907  -5.0171631e-39  0              0.013489472    5.7132451e-16  0              2.7587216e-09  2.6109412e-16  0              3.2703419    
   2400000   127.27922      200            200            0.0044964907   6.5341173e-39  0              0.013489472    4.9193263e-16  0              2.3753666e-09  2.6109412e-16  0              3.2703419    
   2500000   127.27922      200            200            0.0044964907   2.4746204e-39  0              0.013489472    7.9645289e-17  0              3.845786e-10   2.6109412e-16  0              3.2703419    
   2600000   127.27922      200            200            0.0044964907   3.3917397e-39  0              0.013489472    5.6818105e-19  0              2.743543e-12   2.6109412e-16  0              3.2703419    
   2700000   127.27922      200            200            0.0044964907  -1.600167e-39   0              0.013489472    1.9510459e-18  0              9.4209022e-12  2.6109412e-16  0              3.2703419    
   2800000   127.27922      200            200            0.0044964907   8.2433923e-40  0              0.013489472    1.5687765e-22  0              7.5750604e-16  2.6109412e-16  0              3.2703419    
   2900000   127.27922      200            200            0.0044964907   3.4124621e-39  0              0.013489472    4.8050289e-20  0              2.3201765e-13  2.6109412e-16  0              3.2703419    
   3000000   127.27922      200            200            0.0044964907   2.5436789e-39  0              0.013489472    7.9203249e-20  0              3.8244415e-13  2.6109412e-16  0              3.2703419    
Loop time of 70.5838 on 4 procs for 3000000 steps with 51 atoms

Performance: 36722286.346 ns/day, 0.000 hours/ns, 42502.646 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30104    | 1.2738     | 4.0719     | 143.2 |  1.80
Neigh   | 0.051909   | 0.053876   | 0.056871   |   0.9 |  0.08
Comm    | 29.961     | 37.75      | 44.081     |  95.9 | 53.48
Output  | 0.077032   | 0.077247   | 0.077442   |   0.1 |  0.11
Modify  | 15.289     | 22.292     | 30.887     | 145.4 | 31.58
Other   |            | 9.137      |            |       | 12.94

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.56                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.9722234570539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.66
  ghost atom cutoff = 3.66
  binsize = 1.83, bins = 70 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.72 | 17.18 | 18.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0039058837   6.0527658e-39  0              0.011717651    15087.494      0              7.285211e+10   2.6109412e-16  0              3.3204889    
    200000   127.27922      200            200           -0.0004589773   2.9068144e-38  0             -0.0013769319   2329.4538      0              1.1248098e+10  2.6109412e-16  0              3.3442899    
    300000   127.27922      200            200           -0.00033263954  2.5785803e-39  0             -0.00099791862  785.62825      0              3.7935177e+09  2.6109412e-16  0              3.2823709    
    400000   127.27922      200            200            0.00022423595  6.4570725e-37  0              0.00067270784  124.25295      0              5.9997305e+08  2.6109412e-16  0              3.2798174    
    500000   127.27922      200            200            0.007514679    2.0426662e-36  0              0.022544037    12.213721      0              58975685       2.6109412e-16  0              3.2734165    
    600000   127.27922      200            200            0.0048695265   1.4964117e-37  0              0.014608579    3.228619       0              15589845       2.6109412e-16  0              3.2750762    
    700000   127.27922      200            200            0.0040928235  -5.0122883e-37  0              0.012278471    0.19577652     0              945334.75      2.6109412e-16  0              3.2756267    
    800000   127.27922      200            200            0.0043322898   5.4296037e-38  0              0.012996869    0.015299505    0              73875.836      2.6109412e-16  0              3.275464     
    900000   127.27922      200            200            0.0045172621   1.7955406e-38  0              0.013551786    0.008296165    0              40059.212      2.6109412e-16  0              3.2753353    
   1000000   127.27922      200            200            0.0045299773   3.5627334e-39  0              0.013589932    2.5190381e-05  0              121.63533      2.6109412e-16  0              3.2753256    
   1100000   127.27922      200            200            0.0045078297   1.5295061e-38  0              0.013523489    0.00012374912  0              597.5402       2.6109412e-16  0              3.2753407    
   1200000   127.27922      200            200            0.0045008365   4.0745154e-38  0              0.013502509    1.1140681e-05  0              53.79436       2.6109412e-16  0              3.2753456    
   1300000   127.27922      200            200            0.004502159   -2.2057489e-39  0              0.013506477    5.0011467e-07  0              2.4148747      2.6109412e-16  0              3.2753447    
   1400000   127.27922      200            200            0.0045034216  -6.0522631e-40  0              0.013510265    3.8536938e-07  0              1.8608108      2.6109412e-16  0              3.2753439    
   1500000   127.27922      200            200            0.0045035445   1.8342457e-39  0              0.013510634    2.7780083e-09  0              0.013414008    2.6109412e-16  0              3.2753438    
   1600000   127.27922      200            200            0.004503403   -1.1229311e-38  0              0.013510209    5.0988559e-09  0              0.02462055     2.6109412e-16  0              3.2753439    
   1700000   127.27922      200            200            0.0045033526  -2.7736962e-39  0              0.013510058    5.8580509e-10  0              0.0028286431   2.6109412e-16  0              3.2753439    
   1800000   127.27922      200            200            0.0045033597   4.5144535e-39  0              0.013510079    1.5029057e-11  0              7.2569937e-05  2.6109412e-16  0              3.2753439    
   1900000   127.27922      200            200            0.0045033682  -3.8518696e-39  0              0.013510105    1.7657695e-11  0              8.526269e-05   2.6109412e-16  0              3.2753439    
   2000000   127.27922      200            200            0.0045033693   3.6127265e-39  0              0.013510108    2.3039765e-13  0              1.1125078e-06  2.6109412e-16  0              3.2753439    
   2100000   127.27922      200            200            0.0045033684  -2.1419976e-39  0              0.013510105    2.0608304e-13  0              9.9510123e-07  2.6109412e-16  0              3.2753439    
   2200000   127.27922      200            200            0.004503368   -4.7692308e-39  0              0.013510104    3.0105573e-14  0              1.4536904e-07  2.6109412e-16  0              3.2753439    
   2300000   127.27922      200            200            0.004503368    6.6327184e-39  0              0.013510104    4.0058054e-16  0              1.9342601e-09  2.6109412e-16  0              3.2753439    
   2400000   127.27922      200            200            0.0045033681   2.4136068e-39  0              0.013510104    7.9850378e-16  0              3.855689e-09   2.6109412e-16  0              3.2753439    
   2500000   127.27922      200            200            0.0045033681   6.7917359e-39  0              0.013510104    1.7264351e-17  0              8.3363372e-11  2.6109412e-16  0              3.2753439    
   2600000   127.27922      200            200            0.0045033681   6.4596567e-39  0              0.013510104    8.4341321e-18  0              4.0725406e-11  2.6109412e-16  0              3.2753439    
   2700000   127.27922      200            200            0.0045033681  -1.3100033e-38  0              0.013510104    9.583233e-19   0              4.6274002e-12  2.6109412e-16  0              3.2753439    
   2800000   127.27922      200            200            0.0045033681   2.5956774e-39  0              0.013510104    8.7940717e-20  0              4.2463425e-13  2.6109412e-16  0              3.2753439    
   2900000   127.27922      200            200            0.0045033681  -8.179749e-39   0              0.013510104    1.6312894e-20  0              7.8769129e-14  2.6109412e-16  0              3.2753439    
   3000000   127.27922      200            200            0.0045033681   7.8474934e-39  0              0.013510104    6.6989923e-20  0              3.2347037e-13  2.6109412e-16  0              3.2753439    
Loop time of 69.5552 on 4 procs for 3000000 steps with 51 atoms

Performance: 37265354.852 ns/day, 0.000 hours/ns, 43131.198 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30938    | 1.2572     | 4.0195     | 142.3 |  1.81
Neigh   | 0.052917   | 0.055246   | 0.058611   |   1.0 |  0.08
Comm    | 29.813     | 37.555     | 43.966     |  95.2 | 53.99
Output  | 0.073993   | 0.074213   | 0.074418   |   0.1 |  0.11
Modify  | 14.897     | 21.807     | 30.365     | 147.1 | 31.35
Other   |            | 8.807      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.57                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.411423031854
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.67
  ghost atom cutoff = 3.67
  binsize = 1.835, bins = 70 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.68 | 17.15 | 18.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0039157262  -6.0517569e-40  0              0.011747178    15139.299      0              7.3102256e+10  2.6109412e-16  0              3.3200555    
    200000   127.27922      200            200           -0.00045823218 -1.2104053e-39  0             -0.0013746965   2255.7185      0              1.0892058e+10  2.6109412e-16  0              3.3522391    
    300000   127.27922      200            200           -0.00032661018  1.5732958e-37  0             -0.00097983053  739.53403      0              3.5709452e+09  2.6109412e-16  0              3.2893729    
    400000   127.27922      200            200            0.00072561744  6.4441251e-37  0              0.0021768523   141.85686      0              6.8497601e+08  2.6109412e-16  0              3.2838955    
    500000   127.27922      200            200            0.0068711654  -3.9832468e-36  0              0.020613496    16.996947      0              82072175       2.6109412e-16  0              3.2787992    
    600000   127.27922      200            200            0.004574389    6.5023499e-37  0              0.013723167    3.4372534      0              16597267       2.6109412e-16  0              3.2802824    
    700000   127.27922      200            200            0.0040347797  -4.5601951e-37  0              0.012104339    0.09917371     0              478874.35      2.6109412e-16  0              3.2806758    
    800000   127.27922      200            200            0.0043684101   3.6262439e-37  0              0.01310523     0.030064476    0              145170.59      2.6109412e-16  0              3.2804459    
    900000   127.27922      200            200            0.004542801   -7.827555e-38   0              0.013628403    0.0069214415   0              33421.164      2.6109412e-16  0              3.2803244    
   1000000   127.27922      200            200            0.0045368021  -7.4165892e-38  0              0.013610406    2.3919188e-05  0              115.4972       2.6109412e-16  0              3.2803276    
   1100000   127.27922      200            200            0.0045117705  -4.763249e-39   0              0.013535312    0.00015240559  0              735.91204      2.6109412e-16  0              3.2803447    
   1200000   127.27922      200            200            0.0045069961   1.5408996e-38  0              0.013520988    4.4195105e-06  0              21.340235      2.6109412e-16  0              3.2803481    
   1300000   127.27922      200            200            0.0045093113  -3.8463738e-39  0              0.013527934    1.4395733e-06  0              6.9511842      2.6109412e-16  0              3.2803465    
   1400000   127.27922      200            200            0.0045104761   3.0500089e-40  0              0.013531428    3.0596247e-07  0              1.4773832      2.6109412e-16  0              3.2803457    
   1500000   127.27922      200            200            0.0045104235   1.9959963e-39  0              0.013531271    1.4847078e-09  0              0.0071691224   2.6109412e-16  0              3.2803458    
   1600000   127.27922      200            200            0.0045102541   4.4461876e-39  0              0.013530762    6.9687858e-09  0              0.033649773    2.6109412e-16  0              3.2803459    
   1700000   127.27922      200            200            0.0045102233   2.5576327e-40  0              0.01353067     1.8157945e-10  0              0.00087678218  2.6109412e-16  0              3.2803459    
   1800000   127.27922      200            200            0.0045102394   2.7773711e-39  0              0.013530718    6.8558297e-11  0              0.00033104348  2.6109412e-16  0              3.2803459    
   1900000   127.27922      200            200            0.0045102471  -5.6646564e-41  0              0.013530741    1.352207e-11   0              6.5293236e-05  2.6109412e-16  0              3.2803459    
   2000000   127.27922      200            200            0.0045102467   6.2884501e-39  0              0.01353074     8.8335391e-14  0              4.2653999e-07  2.6109412e-16  0              3.2803459    
   2100000   127.27922      200            200            0.0045102455  -4.8171639e-39  0              0.013530737    3.1827907e-13  0              1.5368557e-06  2.6109412e-16  0              3.2803459    
   2200000   127.27922      200            200            0.0045102453   5.2649441e-40  0              0.013530736    7.4174229e-15  0              3.5816081e-08  2.6109412e-16  0              3.2803459    
   2300000   127.27922      200            200            0.0045102455   4.7745318e-39  0              0.013530736    3.2557378e-15  0              1.5720793e-08  2.6109412e-16  0              3.2803459    
   2400000   127.27922      200            200            0.0045102455   1.8824003e-39  0              0.013530737    5.9559545e-16  0              2.8759173e-09  2.6109412e-16  0              3.2803459    
   2500000   127.27922      200            200            0.0045102455   2.7530777e-39  0              0.013530736    4.4527083e-18  0              2.1500535e-11  2.6109412e-16  0              3.2803459    
   2600000   127.27922      200            200            0.0045102455   1.3220685e-40  0              0.013530736    1.4519933e-17  0              7.0111559e-11  2.6109412e-16  0              3.2803459    
   2700000   127.27922      200            200            0.0045102455   8.1810215e-41  0              0.013530736    3.0078001e-20  0              1.452359e-13   2.6109412e-16  0              3.2803459    
   2800000   127.27922      200            200            0.0045102455   3.8224684e-39  0              0.013530736    2.6539341e-19  0              1.2814898e-12  2.6109412e-16  0              3.2803459    
   2900000   127.27922      200            200            0.0045102455   1.257544e-38   0              0.013530736    1.0669949e-23  0              5.1521365e-17  2.6109412e-16  0              3.2803459    
   3000000   127.27922      200            200            0.0045102455  -3.9108998e-39  0              0.013530736    1.1221322e-20  0              5.4183746e-14  2.6109412e-16  0              3.2803459    
Loop time of 69.3095 on 4 procs for 3000000 steps with 51 atoms

Performance: 37397492.492 ns/day, 0.000 hours/ns, 43284.135 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2942     | 1.2511     | 4.0401     | 144.0 |  1.81
Neigh   | 0.049526   | 0.051355   | 0.053671   |   0.7 |  0.07
Comm    | 29.7       | 37.431     | 43.859     |  95.4 | 54.01
Output  | 0.075865   | 0.076085   | 0.076312   |   0.1 |  0.11
Modify  | 14.764     | 21.71      | 30.261     | 146.9 | 31.32
Other   |            | 8.79       |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.58                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.8530900135247
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.68
  ghost atom cutoff = 3.68
  binsize = 1.84, bins = 70 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.68 | 17.15 | 18.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0039255679   1.9376895e-38  0              0.011776704    15191.171      0              7.3352729e+10  2.6109412e-16  0              3.3196095    
    200000   127.27922      200            200           -0.00045726653  2.3256237e-37  0             -0.0013717996   2183.2345      0              1.0542058e+10  2.6109412e-16  0              3.3601437    
    300000   127.27922      200            200           -0.00032034442  1.574061e-37   0             -0.00096103327  694.88539      0              3.3553529e+09  2.6109412e-16  0              3.2963171    
    400000   127.27922      200            200            0.0015715963   1.2628376e-36  0              0.0047147888   157.4609       0              7.6032234e+08  2.6109412e-16  0              3.2879156    
    500000   127.27922      200            200            0.0061571722  -1.4330566e-36  0              0.018471517    21.070845      0              1.0174357e+08  2.6109412e-16  0              3.2842372    
    600000   127.27922      200            200            0.0042824709   1.9860143e-36  0              0.012847413    3.3588616      0              16218740       2.6109412e-16  0              3.2854909    
    700000   127.27922      200            200            0.0040004054  -4.1579666e-36  0              0.012001216    0.029622545    0              143036.67      2.6109412e-16  0              3.2857082    
    800000   127.27922      200            200            0.0044132632   4.2584323e-37  0              0.013239789    0.045130376    0              217918.43      2.6109412e-16  0              3.2854218    
    900000   127.27922      200            200            0.004566005    3.0285785e-37  0              0.013698015    0.0048010635   0              23182.617      2.6109412e-16  0              3.2853151    
   1000000   127.27922      200            200            0.0045413761   6.2648601e-38  0              0.013624128    0.00020606603  0              995.01909      2.6109412e-16  0              3.2853311    
   1100000   127.27922      200            200            0.0045155631   1.4243461e-38  0              0.013546689    0.00015277034  0              737.67329      2.6109412e-16  0              3.2853488    
   1200000   127.27922      200            200            0.0045135177   2.053855e-38   0              0.013540553    4.0657102e-07  0              1.9631859      2.6109412e-16  0              3.2853503    
   1300000   127.27922      200            200            0.0045165813  -5.066874e-39   0              0.013549744    2.3703583e-06  0              11.445612      2.6109412e-16  0              3.2853483    
   1400000   127.27922      200            200            0.0045174978  -1.3919501e-39  0              0.013552493    1.6609241e-07  0              0.80200083     2.6109412e-16  0              3.2853476    
   1500000   127.27922      200            200            0.0045172744  -1.4267566e-39  0              0.013551823    1.5206312e-08  0              0.073425838    2.6109412e-16  0              3.2853478    
   1600000   127.27922      200            200            0.0045171037  -7.8071539e-40  0              0.013551311    6.5415069e-09  0              0.031586596    2.6109412e-16  0              3.2853479    
   1700000   127.27922      200            200            0.0045170984  -1.3406935e-39  0              0.013551295    3.5501198e-14  0              1.7142258e-07  2.6109412e-16  0              3.2853479    
   1800000   127.27922      200            200            0.0045171203   5.8482494e-40  0              0.013551361    1.1893399e-10  0              0.00057428967  2.6109412e-16  0              3.2853479    
   1900000   127.27922      200            200            0.0045171256   3.2127813e-39  0              0.013551377    5.2946091e-12  0              2.5565773e-05  2.6109412e-16  0              3.2853479    
   2000000   127.27922      200            200            0.0045171238   1.0991979e-39  0              0.013551371    9.9154212e-13  0              4.787802e-06   2.6109412e-16  0              3.2853479    
   2100000   127.27922      200            200            0.0045171227  -6.3599937e-39  0              0.013551368    2.6948546e-13  0              1.3012488e-06  2.6109412e-16  0              3.2853479    
   2200000   127.27922      200            200            0.0045171227   2.0254861e-39  0              0.013551368    7.0017319e-16  0              3.3808858e-09  2.6109412e-16  0              3.2853479    
   2300000   127.27922      200            200            0.0045171229  -3.394155e-39   0              0.013551369    5.7378691e-15  0              2.7706116e-08  2.6109412e-16  0              3.2853479    
   2400000   127.27922      200            200            0.0045171229   9.9433331e-40  0              0.013551369    1.5028887e-16  0              7.2569118e-10  2.6109412e-16  0              3.2853479    
   2500000   127.27922      200            200            0.0045171229   3.0939806e-39  0              0.013551369    5.6975755e-17  0              2.7511553e-10  2.6109412e-16  0              3.2853479    
   2600000   127.27922      200            200            0.0045171229   4.9256733e-40  0              0.013551369    1.0363552e-17  0              5.0041883e-11  2.6109412e-16  0              3.2853479    
   2700000   127.27922      200            200            0.0045171229  -1.9583433e-39  0              0.013551369    4.8720645e-19  0              2.3525456e-12  2.6109412e-16  0              3.2853479    
   2800000   127.27922      200            200            0.0045171229   1.8039785e-39  0              0.013551369    1.8766659e-19  0              9.0617479e-13  2.6109412e-16  0              3.2853479    
   2900000   127.27922      200            200            0.0045171229   9.3692848e-39  0              0.013551369    1.1446804e-19  0              5.5272521e-13  2.6109412e-16  0              3.2853479    
   3000000   127.27922      200            200            0.0045171229  -1.1935035e-38  0              0.013551369    8.2148381e-20  0              3.9666513e-13  2.6109412e-16  0              3.2853479    
Loop time of 69.2034 on 4 procs for 3000000 steps with 51 atoms

Performance: 37454822.407 ns/day, 0.000 hours/ns, 43350.489 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28758    | 1.2296     | 3.9877     | 143.6 |  1.78
Neigh   | 0.055051   | 0.057201   | 0.060279   |   0.9 |  0.08
Comm    | 29.924     | 37.47      | 43.793     |  93.6 | 54.14
Output  | 0.07401    | 0.074215   | 0.074408   |   0.1 |  0.11
Modify  | 14.739     | 21.608     | 30.01      | 145.8 | 31.22
Other   |            | 8.765      |            |       | 12.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.59                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.2972313135691
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.69
  ghost atom cutoff = 3.69
  binsize = 1.845, bins = 69 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.67 | 17.14 | 18.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.003935409   -2.6480157e-40  0              0.011806227    15243.111      0              7.3603529e+10  2.6109412e-16  0              3.319151     
    200000   127.27922      200            200           -0.00045608137  5.8173223e-38  0             -0.0013682441   2111.9993      0              1.0198089e+10  2.6109412e-16  0              3.3680035    
    300000   127.27922      200            200           -0.00031384388 -1.5081046e-37  0             -0.00094153163  651.6784       0              3.1467218e+09  2.6109412e-16  0              3.3032034    
    400000   127.27922      200            200            0.0026999993  -4.3168003e-36  0              0.0080999979   169.08398      0              8.1644601e+08  2.6109412e-16  0              3.2918902    
    500000   127.27922      200            200            0.005409117   -6.8850354e-37  0              0.016227351    23.867882      0              1.1524946e+08  2.6109412e-16  0              3.2897139    
    600000   127.27922      200            200            0.0040062731   1.8279304e-37  0              0.012018819    3.0123645      0              14545630       2.6109412e-16  0              3.2906931    
    700000   127.27922      200            200            0.0039915424  -2.3245097e-36  0              0.011974627    0.00044743508  0              2160.5039      2.6109412e-16  0              3.2907224    
    800000   127.27922      200            200            0.0044646077   2.5419518e-37  0              0.013393823    0.056859854    0              274555.89      2.6109412e-16  0              3.2903932    
    900000   127.27922      200            200            0.0045856757   6.8545735e-38  0              0.013757027    0.0025391924   0              12260.852      2.6109412e-16  0              3.2903082    
   1000000   127.27922      200            200            0.004543897    4.4131745e-38  0              0.013631691    0.00050966257  0              2460.9781      2.6109412e-16  0              3.290336     
   1100000   127.27922      200            200            0.0045195082  -2.5196471e-38  0              0.013558525    0.00012484302  0              602.82227      2.6109412e-16  0              3.2903528    
   1200000   127.27922      200            200            0.0045204398   4.2901789e-39  0              0.013561319    7.9634108e-07  0              3.8452461      2.6109412e-16  0              3.2903523    
   1300000   127.27922      200            200            0.0045239193   5.7737883e-39  0              0.013571758    2.8384669e-06  0              13.705941      2.6109412e-16  0              3.2903499    
   1400000   127.27922      200            200            0.0045244664   2.6429578e-40  0              0.013573399    4.2044878e-08  0              0.20301967     2.6109412e-16  0              3.2903495    
   1500000   127.27922      200            200            0.0045241013  -2.7133653e-39  0              0.013572304    3.5471376e-08  0              0.17127858     2.6109412e-16  0              3.2903498    
   1600000   127.27922      200            200            0.0045239567  -7.0561912e-39  0              0.01357187     4.1177706e-09  0              0.01988324     2.6109412e-16  0              3.2903499    
   1700000   127.27922      200            200            0.0045239781   4.3353404e-39  0              0.013571934    1.7100745e-10  0              0.00082573375  2.6109412e-16  0              3.2903499    
   1800000   127.27922      200            200            0.0045240018  -2.3620814e-39  0              0.013572006    1.2572567e-10  0              0.00060708425  2.6109412e-16  0              3.2903498    
   1900000   127.27922      200            200            0.0045240035   1.092833e-40   0              0.013572011    1.5906085e-13  0              7.6804792e-07  2.6109412e-16  0              3.2903498    
   2000000   127.27922      200            200            0.0045240006   2.6684951e-39  0              0.013572002    2.0742238e-12  0              1.0015685e-05  2.6109412e-16  0              3.2903498    
   2100000   127.27922      200            200            0.0045239999   4.1064868e-39  0              0.013572       1.105419e-13   0              5.337673e-07   2.6109412e-16  0              3.2903498    
   2200000   127.27922      200            200            0.0045240001   3.2191082e-39  0              0.013572       1.7043613e-14  0              8.229751e-08   2.6109412e-16  0              3.2903498    
   2300000   127.27922      200            200            0.0045240002  -1.8022083e-39  0              0.013572001    4.9308142e-15  0              2.3809137e-08  2.6109412e-16  0              3.2903498    
   2400000   127.27922      200            200            0.0045240002  -4.8978511e-39  0              0.013572001    1.7094351e-17  0              8.2542503e-11  2.6109412e-16  0              3.2903498    
   2500000   127.27922      200            200            0.0045240002   3.0183626e-39  0              0.013572001    1.0624969e-16  0              5.1304171e-10  2.6109412e-16  0              3.2903498    
   2600000   127.27922      200            200            0.0045240002   1.4691117e-38  0              0.013572001    1.8464779e-18  0              8.9159808e-12  2.6109412e-16  0              3.2903498    
   2700000   127.27922      200            200            0.0045240002   4.707826e-39   0              0.013572001    1.674946e-18   0              8.087715e-12   2.6109412e-16  0              3.2903498    
   2800000   127.27922      200            200            0.0045240002  -7.5541966e-39  0              0.013572001    3.0549861e-20  0              1.4751435e-13  2.6109412e-16  0              3.2903498    
   2900000   127.27922      200            200            0.0045240002  -2.7170358e-39  0              0.013572001    1.0979159e-19  0              5.3014429e-13  2.6109412e-16  0              3.2903498    
   3000000   127.27922      200            200            0.0045240002   1.0755827e-38  0              0.013572001    3.7640621e-20  0              1.8175309e-13  2.6109412e-16  0              3.2903498    
Loop time of 68.8045 on 4 procs for 3000000 steps with 51 atoms

Performance: 37671942.276 ns/day, 0.000 hours/ns, 43601.785 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29337    | 1.1938     | 3.859      | 140.8 |  1.74
Neigh   | 0.052498   | 0.0547     | 0.057826   |   1.0 |  0.08
Comm    | 29.801     | 37.311     | 43.555     |  93.2 | 54.23
Output  | 0.074416   | 0.074611   | 0.074802   |   0.1 |  0.11
Modify  | 14.622     | 21.441     | 29.73      | 144.9 | 31.16
Other   |            | 8.729      |            |       | 12.69

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.6                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.7438538434912
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.7
  ghost atom cutoff = 3.7
  binsize = 1.85, bins = 69 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.67 | 17.14 | 18.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0039452493  -1.2103591e-39  0              0.011835748    15295.119      0              7.3854654e+10  2.6109412e-16  0              3.31868      
    200000   127.27922      200            200           -0.00045467769  8.7173246e-38  0             -0.0013640331   2042.0105      0              9.860138e+09   2.6109412e-16  0              3.3758185    
    300000   127.27922      200            200           -0.00030711008 -1.5474142e-36  0             -0.00092133023  609.90865      0              2.9450306e+09  2.6109412e-16  0              3.3100315    
    400000   127.27922      200            200            0.0040717921   7.7124993e-38  0              0.012215376    174.92184      0              8.4463494e+08  2.6109412e-16  0              3.2958357    
    500000   127.27922      200            200            0.0046620062  -2.5118089e-36  0              0.013986019    25.046435      0              1.2094027e+08  2.6109412e-16  0              3.2952119    
    600000   127.27922      200            200            0.0037566433   2.533862e-37   0              0.01126993     2.459514       0              11876113       2.6109412e-16  0              3.2958806    
    700000   127.27922      200            200            0.0040089158  -4.802072e-36   0              0.012026748    0.017031874    0              82240.822      2.6109412e-16  0              3.2957178    
    800000   127.27922      200            200            0.0045197817   3.444509e-39   0              0.013559345    0.062416308    0              301386.01      2.6109412e-16  0              3.2953621    
    900000   127.27922      200            200            0.0046008702   2.1974549e-37  0              0.013802611    0.00077749676  0              3754.2536      2.6109412e-16  0              3.2953043    
   1000000   127.27922      200            200            0.0045447365  -1.9543553e-39  0              0.013634209    0.00083315862  0              4023.0248      2.6109412e-16  0              3.295342     
   1100000   127.27922      200            200            0.0045238904   4.5431123e-39  0              0.013571671    7.9325712e-05  0              383.03547      2.6109412e-16  0              3.2953565    
   1200000   127.27922      200            200            0.0045277568  -8.4708832e-39  0              0.01358327     5.3731244e-06  0              25.944895      2.6109412e-16  0              3.295354     
   1300000   127.27922      200            200            0.0045312672   2.9744042e-40  0              0.013593802    2.6190658e-06  0              12.646531      2.6109412e-16  0              3.2953516    
   1400000   127.27922      200            200            0.0045313693  -6.2632522e-40  0              0.013594108    6.494765e-10   0              0.0031360896   2.6109412e-16  0              3.2953515    
   1500000   127.27922      200            200            0.0045309124   2.298479e-39   0              0.013592737    4.9969784e-08  0              0.24128621     2.6109412e-16  0              3.2953518    
   1600000   127.27922      200            200            0.0045308172  -5.7395082e-39  0              0.013592452    1.3222377e-09  0              0.0063846125   2.6109412e-16  0              3.2953518    
   1700000   127.27922      200            200            0.0045308621  -1.0521378e-39  0              0.013592586    5.6521362e-10  0              0.0027292143   2.6109412e-16  0              3.2953518    
   1800000   127.27922      200            200            0.004530883   -5.2178384e-40  0              0.013592649    8.381125e-11   0              0.00040469453  2.6109412e-16  0              3.2953518    
   1900000   127.27922      200            200            0.0045308806   3.7268486e-39  0              0.013592642    2.5180512e-12  0              1.2158768e-05  2.6109412e-16  0              3.2953518    
   2000000   127.27922      200            200            0.0045308774   7.4530473e-39  0              0.013592632    2.3148883e-12  0              1.1177767e-05  2.6109412e-16  0              3.2953518    
   2100000   127.27922      200            200            0.0045308771  -5.076935e-39   0              0.013592631    3.1645714e-15  0              1.5280583e-08  2.6109412e-16  0              3.2953518    
   2200000   127.27922      200            200            0.0045308775   3.0646284e-39  0              0.013592633    3.8367358e-14  0              1.8526224e-07  2.6109412e-16  0              3.2953518    
   2300000   127.27922      200            200            0.0045308776  -7.9953093e-40  0              0.013592633    1.8106485e-15  0              8.7429735e-09  2.6109412e-16  0              3.2953518    
   2400000   127.27922      200            200            0.0045308776  -1.5312533e-39  0              0.013592633    3.5826908e-16  0              1.7299532e-09  2.6109412e-16  0              3.2953518    
   2500000   127.27922      200            200            0.0045308776  -2.7551148e-39  0              0.013592633    8.1005429e-17  0              3.9114623e-10  2.6109412e-16  0              3.2953518    
   2600000   127.27922      200            200            0.0045308776   3.7853465e-40  0              0.013592633    1.0359708e-18  0              5.0023322e-12  2.6109412e-16  0              3.2953518    
   2700000   127.27922      200            200            0.0045308776   3.6409635e-39  0              0.013592633    1.7809506e-18  0              8.5995732e-12  2.6109412e-16  0              3.2953518    
   2800000   127.27922      200            200            0.0045308776   7.0407985e-39  0              0.013592633    1.9213308e-20  0              9.2774189e-14  2.6109412e-16  0              3.2953518    
   2900000   127.27922      200            200            0.0045308776  -3.0746234e-40  0              0.013592633    9.1193208e-20  0              4.4033936e-13  2.6109412e-16  0              3.2953518    
   3000000   127.27922      200            200            0.0045308776   7.0269751e-39  0              0.013592633    1.4786363e-19  0              7.1398054e-13  2.6109412e-16  0              3.2953518    
Loop time of 69.2574 on 4 procs for 3000000 steps with 51 atoms

Performance: 37425606.106 ns/day, 0.000 hours/ns, 43316.674 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29472    | 1.3075     | 4.3006     | 151.1 |  1.89
Neigh   | 0.049773   | 0.051214   | 0.053677   |   0.7 |  0.07
Comm    | 29.637     | 37.413     | 43.866     |  94.7 | 54.02
Output  | 0.076892   | 0.077109   | 0.077295   |   0.1 |  0.11
Modify  | 14.767     | 21.68      | 30.292     | 146.9 | 31.30
Other   |            | 8.729      |            |       | 12.60

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.61                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.1929645147953
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.71
  ghost atom cutoff = 3.71
  binsize = 1.855, bins = 69 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.67 | 17.14 | 18.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0039550888   6.0526546e-39  0              0.011865266    15347.193      0              7.4106105e+10  2.6109412e-16  0              3.3181964    
    200000   127.27922      200            200           -0.00045305641 -2.4204439e-39  0             -0.0013591692   1973.263       0              9.5281808e+09  2.6109412e-16  0              3.3835887    
    300000   127.27922      200            200           -0.00030014421 -1.5269984e-37  0             -0.00090043262  569.56962      0              2.7502479e+09  2.6109412e-16  0              3.3168016    
    400000   127.27922      200            200            0.0056426248   2.9564795e-35  0              0.016927874    173.56358      0              8.380764e+08   2.6109412e-16  0              3.2997727    
    500000   127.27922      200            200            0.0039469528  -9.0703125e-37  0              0.011840859    24.521403      0              1.1840508e+08  2.6109412e-16  0              3.3007138    
    600000   127.27922      200            200            0.0035424808   6.4935088e-36  0              0.010627442    1.7925999      0              8655823.4      2.6109412e-16  0              3.301046     
    700000   127.27922      200            200            0.0040521227   1.3822368e-37  0              0.012156368    0.075840469    0              366206.48      2.6109412e-16  0              3.3006948    
    800000   127.27922      200            200            0.0045758512  -1.2510925e-36  0              0.013727554    0.060449048    0              291886.82      2.6109412e-16  0              3.3003304    
    900000   127.27922      200            200            0.0046109741  -1.2945835e-38  0              0.013832922    1.1665201e-05  0              56.327081      2.6109412e-16  0              3.3003039    
   1000000   127.27922      200            200            0.0045444075   8.6135763e-41  0              0.013633223    0.0010693099   0              5163.3148      2.6109412e-16  0              3.3003489    
   1100000   127.27922      200            200            0.004528951    9.1644069e-38  0              0.013586853    3.3462451e-05  0              161.5782       2.6109412e-16  0              3.3003597    
   1200000   127.27922      200            200            0.0045354191  -2.1317384e-39  0              0.013606257    1.2126383e-05  0              58.553963      2.6109412e-16  0              3.3003554    
   1300000   127.27922      200            200            0.0045385662   3.1502032e-39  0              0.013615699    1.8222694e-06  0              8.7990869      2.6109412e-16  0              3.3003532    
   1400000   127.27922      200            200            0.0045382031   9.6109133e-41  0              0.013614609    6.326547e-08   0              0.30548631     2.6109412e-16  0              3.3003534    
   1500000   127.27922      200            200            0.0045377181   9.4860432e-39  0              0.013613154    5.0004393e-08  0              0.24145332     2.6109412e-16  0              3.3003538    
   1600000   127.27922      200            200            0.0045376883  -5.2897146e-39  0              0.013613065    5.5897664e-12  0              2.6990982e-05  2.6109412e-16  0              3.3003538    
   1700000   127.27922      200            200            0.004537749    2.3645379e-39  0              0.013613247    8.9257322e-10  0              0.0043099166   2.6109412e-16  0              3.3003538    
   1800000   127.27922      200            200            0.004537763   -4.4205605e-39  0              0.013613289    2.6866758e-11  0              0.00012972996  2.6109412e-16  0              3.3003537    
   1900000   127.27922      200            200            0.004537757    7.0329797e-39  0              0.013613271    1.0235134e-11  0              4.9421797e-05  2.6109412e-16  0              3.3003538    
   2000000   127.27922      200            200            0.0045377541  -6.8579884e-39  0              0.013613262    1.4937142e-12  0              7.2126112e-06  2.6109412e-16  0              3.3003538    
   2100000   127.27922      200            200            0.0045377545   4.7533956e-39  0              0.013613263    5.473937e-14   0              2.6431683e-07  2.6109412e-16  0              3.3003538    
   2200000   127.27922      200            200            0.0045377549  -4.9426157e-40  0              0.013613265    4.1404654e-14  0              1.9992826e-07  2.6109412e-16  0              3.3003538    
   2300000   127.27922      200            200            0.004537755    1.190518e-38   0              0.013613265    1.9991051e-18  0              9.6529632e-12  2.6109412e-16  0              3.3003538    
   2400000   127.27922      200            200            0.0045377549   6.8527126e-39  0              0.013613265    7.4600749e-16  0              3.6022032e-09  2.6109412e-16  0              3.3003538    
   2500000   127.27922      200            200            0.0045377549  -4.145053e-39   0              0.013613265    2.0522335e-17  0              9.9095012e-11  2.6109412e-16  0              3.3003538    
   2600000   127.27922      200            200            0.0045377549   2.5242621e-39  0              0.013613265    8.8221401e-18  0              4.2598957e-11  2.6109412e-16  0              3.3003538    
   2700000   127.27922      200            200            0.0045377549   4.4736586e-39  0              0.013613265    7.3252224e-19  0              3.5370878e-12  2.6109412e-16  0              3.3003538    
   2800000   127.27922      200            200            0.0045377549   5.0078259e-40  0              0.013613265    1.6562126e-19  0              7.9972577e-13  2.6109412e-16  0              3.3003538    
   2900000   127.27922      200            200            0.0045377549   5.14062e-39    0              0.013613265    2.4148831e-20  0              1.1660606e-13  2.6109412e-16  0              3.3003538    
   3000000   127.27922      200            200            0.0045377549  -3.3869392e-39  0              0.013613265    6.4585926e-20  0              3.1186232e-13  2.6109412e-16  0              3.3003538    
Loop time of 68.9667 on 4 procs for 3000000 steps with 51 atoms

Performance: 37583329.948 ns/day, 0.000 hours/ns, 43499.224 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27892    | 1.1501     | 3.7065     | 137.6 |  1.67
Neigh   | 0.054889   | 0.057357   | 0.060837   |   1.1 |  0.08
Comm    | 29.906     | 37.376     | 43.471     |  93.4 | 54.19
Output  | 0.074779   | 0.075006   | 0.075211   |   0.1 |  0.11
Modify  | 14.812     | 21.594     | 29.804     | 143.9 | 31.31
Other   |            | 8.715      |            |       | 12.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.62                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.6445702389847
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.72
  ghost atom cutoff = 3.72
  binsize = 1.86, bins = 69 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.67 | 17.14 | 18.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0039649274  -7.8682978e-39  0              0.011894782    15399.336      0              7.4357881e+10  2.6109412e-16  0              3.3177002    
    200000   127.27922      200            200           -0.00045121857 -1.5479285e-37  0             -0.0013536557   1905.755       0              9.202209e+09   2.6109412e-16  0              3.3913138    
    300000   127.27922      200            200           -0.00029294788  1.5709224e-37  0             -0.00087884363  530.65738      0              2.5623546e+09  2.6109412e-16  0              3.3235135    
    400000   127.27922      200            200            0.0073567312   1.2216803e-35  0              0.022070194    164.25966      0              7.9315109e+08  2.6109412e-16  0              3.3037245    
    500000   127.27922      200            200            0.0032894143  -2.2734668e-36  0              0.009868243    22.448448      0              1.0839552e+08  2.6109412e-16  0              3.3062028    
    600000   127.27922      200            200            0.0033706916   2.7989032e-36  0              0.010112075    1.118515       0              5400908.6      2.6109412e-16  0              3.3061829    
    700000   127.27922      200            200            0.0041196319   5.099784e-36   0              0.012358896    0.16509846     0              797201.39      2.6109412e-16  0              3.3056547    
    800000   127.27922      200            200            0.0046297807  -5.6224674e-37  0              0.013889342    0.051426127    0              248318.36      2.6109412e-16  0              3.3053002    
    900000   127.27922      200            200            0.004615748    3.7305009e-37  0              0.013847244    0.0004506773   0              2176.1594      2.6109412e-16  0              3.3053071    
   1000000   127.27922      200            200            0.0045435201   7.5101333e-39  0              0.01363056     0.0011405359   0              5507.2397      2.6109412e-16  0              3.3053561    
   1100000   127.27922      200            200            0.0045348647  -2.2684392e-38  0              0.013604594    4.4695421e-06  0              21.581819      2.6109412e-16  0              3.3053623    
   1200000   127.27922      200            200            0.0045433393  -1.110251e-39   0              0.013630018    1.8132878e-05  0              87.557178      2.6109412e-16  0              3.3053566    
   1300000   127.27922      200            200            0.0045457637  -1.799107e-39   0              0.013637291    8.3568801e-07  0              4.0352383      2.6109412e-16  0              3.3053549    
   1400000   127.27922      200            200            0.004544974    1.047618e-40   0              0.013634922    1.9489476e-07  0              0.94107704     2.6109412e-16  0              3.3053555    
   1500000   127.27922      200            200            0.0045445295  -4.1583185e-39  0              0.013633589    3.5646755e-08  0              0.17212542     2.6109412e-16  0              3.3053558    
   1600000   127.27922      200            200            0.0045445708   2.9207805e-39  0              0.013633712    1.0175689e-09  0              0.0049134762   2.6109412e-16  0              3.3053557    
   1700000   127.27922      200            200            0.0045446371  -3.8587295e-39  0              0.013633911    9.1528601e-10  0              0.0044195886   2.6109412e-16  0              3.3053557    
   1800000   127.27922      200            200            0.0045446412   3.3897616e-39  0              0.013633924    2.0903417e-14  0              1.0093512e-07  2.6109412e-16  0              3.3053557    
   1900000   127.27922      200            200            0.0045446329   1.6454278e-39  0              0.013633899    1.6587344e-11  0              8.0094347e-05  2.6109412e-16  0              3.3053557    
   2000000   127.27922      200            200            0.0045446311   1.7983361e-39  0              0.013633893    3.8468328e-13  0              1.8574979e-06  2.6109412e-16  0              3.3053557    
   2100000   127.27922      200            200            0.004544632    2.0406705e-39  0              0.013633896    2.1125389e-13  0              1.0200694e-06  2.6109412e-16  0              3.3053557    
   2200000   127.27922      200            200            0.0045446323  -2.4617351e-39  0              0.013633897    2.3014708e-14  0              1.1112979e-07  2.6109412e-16  0              3.3053557    
   2300000   127.27922      200            200            0.0045446323  -3.8340457e-39  0              0.013633897    1.5782915e-15  0              7.621005e-09   2.6109412e-16  0              3.3053557    
   2400000   127.27922      200            200            0.0045446322  -2.069636e-39   0              0.013633897    6.9869204e-16  0              3.3737338e-09  2.6109412e-16  0              3.3053557    
   2500000   127.27922      200            200            0.0045446322   3.4440853e-39  0              0.013633897    2.0333612e-18  0              9.8183733e-12  2.6109412e-16  0              3.3053557    
   2600000   127.27922      200            200            0.0045446322   3.0308359e-39  0              0.013633897    1.438732e-17   0              6.9471218e-11  2.6109412e-16  0              3.3053557    
   2700000   127.27922      200            200            0.0045446322   7.5937209e-39  0              0.013633897    1.3883186e-22  0              6.7036937e-16  2.6109412e-16  0              3.3053557    
   2800000   127.27922      200            200            0.0045446322  -1.1910861e-38  0              0.013633897    2.6312389e-19  0              1.2705311e-12  2.6109412e-16  0              3.3053557    
   2900000   127.27922      200            200            0.0045446322   1.4212007e-39  0              0.013633897    2.2094083e-22  0              1.0668442e-15  2.6109412e-16  0              3.3053557    
   3000000   127.27922      200            200            0.0045446322   6.4423204e-39  0              0.013633897    1.9033797e-20  0              9.1907395e-14  2.6109412e-16  0              3.3053557    
Loop time of 69.0781 on 4 procs for 3000000 steps with 51 atoms

Performance: 37522719.263 ns/day, 0.000 hours/ns, 43429.073 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29277    | 1.1904     | 3.8356     | 140.0 |  1.72
Neigh   | 0.056989   | 0.059322   | 0.062738   |   1.0 |  0.09
Comm    | 29.77      | 37.37      | 43.603     |  94.1 | 54.10
Output  | 0.075266   | 0.075501   | 0.075727   |   0.1 |  0.11
Modify  | 14.769     | 21.62      | 30.021     | 145.2 | 31.30
Other   |            | 8.762      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.63                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.0986779275632
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.73
  ghost atom cutoff = 3.73
  binsize = 1.865, bins = 69 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.67 | 17.14 | 18.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0039747651   1.210712e-39   0              0.011924295    15451.546      0              7.4609983e+10  2.6109412e-16  0              3.3171913    
    200000   127.27922      200            200           -0.00044916509  7.7519565e-38  0             -0.0013474953   1839.4821      0              8.8822008e+09  2.6109412e-16  0              3.398994     
    300000   127.27922      200            200           -0.00028552225  3.1191824e-37  0             -0.00085656675  493.16556      0              2.38132e+09    2.6109412e-16  0              3.330167     
    400000   127.27922      200            200            0.0094772252   0.00025493354  0              0.028176742    146.96895      0              7.0966047e+08  2.6109412e-16  0              3.3077168    
    500000   127.27922      200            200            0.0027080918   1.5162263e-36  0              0.0081242755   19.172636      0              92577800       2.6109412e-16  0              3.3116635    
    600000   127.27922      200            200            0.0032462938   1.5569174e-36  0              0.0097388814   0.54190748     0              2616677.3      2.6109412e-16  0              3.311286     
    700000   127.27922      200            200            0.0042088029  -1.9713855e-37  0              0.012626409    0.26701969     0              1289342.5      2.6109412e-16  0              3.3105996    
    800000   127.27922      200            200            0.0046786239   1.2622536e-37  0              0.014035872    0.037529134    0              181214.76      2.6109412e-16  0              3.3102736    
    900000   127.27922      200            200            0.0046153463  -8.8684478e-38  0              0.013846039    0.0019588757   0              9458.7097      2.6109412e-16  0              3.3103138    
   1000000   127.27922      200            200            0.0045427287   3.3279536e-38  0              0.013628186    0.0010241314   0              4945.1639      2.6109412e-16  0              3.3103633    
   1100000   127.27922      200            200            0.0045417233  -5.2507511e-38  0              0.01362517     3.055379e-06   0              14.753332      2.6109412e-16  0              3.3103643    
   1200000   127.27922      200            200            0.004551402   -3.9245182e-39  0              0.013654206    2.081742e-05   0              100.51987      2.6109412e-16  0              3.3103578    
   1300000   127.27922      200            200            0.00455282    -4.2923065e-39  0              0.01365846     1.3418734e-07  0              0.64794264     2.6109412e-16  0              3.3103567    
   1400000   127.27922      200            200            0.0045516972  -1.7253631e-39  0              0.013655092    3.2380061e-07  0              1.5635173      2.6109412e-16  0              3.3103575    
   1500000   127.27922      200            200            0.004551357   -5.4744804e-39  0              0.013654071    1.5564647e-08  0              0.075156108    2.6109412e-16  0              3.3103577    
   1600000   127.27922      200            200            0.004551464   -2.8732499e-40  0              0.013654392    3.6625143e-09  0              0.017684971    2.6109412e-16  0              3.3103577    
   1700000   127.27922      200            200            0.0045515241  -1.6700784e-39  0              0.013654572    6.1899282e-10  0              0.0029888948   2.6109412e-16  0              3.3103576    
   1800000   127.27922      200            200            0.0045515176  -5.9738504e-39  0              0.013654553    2.4031397e-11  0              0.00011603902  2.6109412e-16  0              3.3103576    
   1900000   127.27922      200            200            0.0045515086  -2.9370729e-39  0              0.013654526    1.6116542e-11  0              7.7821012e-05  2.6109412e-16  0              3.3103576    
   2000000   127.27922      200            200            0.0045515083   5.6231321e-39  0              0.013654525    1.7651858e-14  0              8.5234503e-08  2.6109412e-16  0              3.3103576    
   2100000   127.27922      200            200            0.0045515095   2.7689165e-39  0              0.013654528    3.1452944e-13  0              1.5187501e-06  2.6109412e-16  0              3.3103576    
   2200000   127.27922      200            200            0.0045515097   7.5398575e-42  0              0.013654529    3.1520777e-15  0              1.5220255e-08  2.6109412e-16  0              3.3103576    
   2300000   127.27922      200            200            0.0045515096  -2.3421087e-40  0              0.013654529    4.6908157e-15  0              2.265027e-08   2.6109412e-16  0              3.3103576    
   2400000   127.27922      200            200            0.0045515095  -3.7111369e-40  0              0.013654529    2.7999118e-16  0              1.3519772e-09  2.6109412e-16  0              3.3103576    
   2500000   127.27922      200            200            0.0045515095  -4.0277224e-39  0              0.013654529    4.8835386e-17  0              2.358086e-10   2.6109412e-16  0              3.3103576    
   2600000   127.27922      200            200            0.0045515095   3.0343476e-40  0              0.013654529    9.6078804e-18  0              4.6393016e-11  2.6109412e-16  0              3.3103576    
   2700000   127.27922      200            200            0.0045515095   7.182965e-39   0              0.013654529    7.5310113e-19  0              3.6364558e-12  2.6109412e-16  0              3.3103576    
   2800000   127.27922      200            200            0.0045515095  -6.3805824e-39  0              0.013654529    9.56321e-20    0              4.6177319e-13  2.6109412e-16  0              3.3103576    
   2900000   127.27922      200            200            0.0045515095  -4.0624785e-39  0              0.013654529    3.9703602e-20  0              1.9171448e-13  2.6109412e-16  0              3.3103576    
   3000000   127.27922      200            200            0.0045515095   8.3118872e-40  0              0.013654529    3.1232144e-22  0              1.5080884e-15  2.6109412e-16  0              3.3103576    
Loop time of 68.6819 on 4 procs for 3000000 steps with 51 atoms

Performance: 37739180.676 ns/day, 0.000 hours/ns, 43679.607 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29359    | 1.1952     | 3.8537     | 140.4 |  1.74
Neigh   | 0.051879   | 0.053728   | 0.056475   |   0.8 |  0.08
Comm    | 29.596     | 37.172     | 43.431     |  93.5 | 54.12
Output  | 0.075324   | 0.075544   | 0.075742   |   0.1 |  0.11
Modify  | 14.663     | 21.475     | 29.864     | 145.3 | 31.27
Other   |            | 8.711      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.64                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.5552944920351
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.74
  ghost atom cutoff = 3.74
  binsize = 1.87, bins = 69 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.63 | 17.1 | 18.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0067531241   5.8105224e-38  0              0.020259372    15486.818      0              7.4780302e+10  2.6109412e-16  0              3.3166703    
    200000   127.27922      200            200           -0.00044689695  2.9079425e-38  0             -0.0013406909   1774.4413      0              8.5681419e+09  2.6109412e-16  0              3.4066291    
    300000   127.27922      200            200           -0.00027786894  6.2349298e-37  0             -0.00083360683  457.0902       0              2.207125e+09   2.6109412e-16  0              3.3367622    
    400000   127.27922      200            200            0.012867568    0.0015057539   0              0.037096951    119.96252      0              5.7925609e+08  2.6109412e-16  0              3.3117819    
    500000   127.27922      200            200            0.0022147237  -8.5869406e-37  0              0.006644171    15.157443      0              73189870       2.6109412e-16  0              3.3170822    
    600000   127.27922      200            200            0.0031726527  -3.4201048e-36  0              0.0095179581   0.14999364     0              724265.62      2.6109412e-16  0              3.3163516    
    700000   127.27922      200            200            0.0043159249  -3.938862e-36   0              0.012947775    0.36119831     0              1744097.4      2.6109412e-16  0              3.3155323    
    800000   127.27922      200            200            0.0047197151  -3.2958683e-38  0              0.014159145    0.022128719    0              106851.67      2.6109412e-16  0              3.3152522    
    900000   127.27922      200            200            0.0046103056   2.2478098e-37  0              0.013830917    0.004097073    0              19783.299      2.6109412e-16  0              3.3153237    
   1000000   127.27922      200            200            0.0045426776   7.3400252e-38  0              0.013628033    0.00075916499  0              3665.7361      2.6109412e-16  0              3.3153699    
   1100000   127.27922      200            200            0.0045495272   5.2093209e-39  0              0.013648582    2.9464728e-05  0              142.27463      2.6109412e-16  0              3.3153656    
   1200000   127.27922      200            200            0.0045594764   3.2972147e-39  0              0.013678429    1.9048121e-05  0              91.97656       2.6109412e-16  0              3.3153589    
   1300000   127.27922      200            200            0.0045597133   4.1618164e-39  0              0.01367914     5.05849e-08    0              0.24425638     2.6109412e-16  0              3.3153587    
   1400000   127.27922      200            200            0.0045583943  -1.0931093e-39  0              0.013675183    3.8052506e-07  0              1.8374193      2.6109412e-16  0              3.3153595    
   1500000   127.27922      200            200            0.0045582082   1.1569528e-39  0              0.013674625    1.7323551e-09  0              0.0083649226   2.6109412e-16  0              3.3153597    
   1600000   127.27922      200            200            0.0045583649  -8.2032755e-39  0              0.013675095    6.1803416e-09  0              0.029842658    2.6109412e-16  0              3.3153596    
   1700000   127.27922      200            200            0.0045584084   2.5210029e-39  0              0.013675225    2.1950288e-10  0              0.0010599009   2.6109412e-16  0              3.3153595    
   1800000   127.27922      200            200            0.0045583923  -2.3886209e-39  0              0.013675177    7.9351923e-11  0              0.00038316204  2.6109412e-16  0              3.3153595    
   1900000   127.27922      200            200            0.0045583845   5.4847974e-39  0              0.013675154    9.2748786e-12  0              4.4785069e-05  2.6109412e-16  0              3.3153596    
   2000000   127.27922      200            200            0.0045583858   6.1703547e-39  0              0.013675157    7.221333e-13   0              3.4869232e-06  2.6109412e-16  0              3.3153596    
   2100000   127.27922      200            200            0.004558387   -1.3031941e-38  0              0.013675161    2.6150511e-13  0              1.2627146e-06  2.6109412e-16  0              3.3153596    
   2200000   127.27922      200            200            0.004558387    1.1437052e-38  0              0.013675161    3.0552537e-15  0              1.4752727e-08  2.6109412e-16  0              3.3153596    
   2300000   127.27922      200            200            0.0045583868  -5.1538357e-39  0              0.01367516     5.7264043e-15  0              2.7650757e-08  2.6109412e-16  0              3.3153596    
   2400000   127.27922      200            200            0.0045583868   1.9646417e-39  0              0.01367516     1.7108638e-18  0              8.2611491e-12  2.6109412e-16  0              3.3153596    
   2500000   127.27922      200            200            0.0045583868  -6.5424906e-39  0              0.01367516     1.0108778e-16  0              4.881167e-10   2.6109412e-16  0              3.3153596    
   2600000   127.27922      200            200            0.0045583868   6.2531584e-39  0              0.01367516     1.6010644e-18  0              7.7309669e-12  2.6109412e-16  0              3.3153596    
   2700000   127.27922      200            200            0.0045583868  -1.4035587e-39  0              0.01367516     1.8340018e-18  0              8.8557381e-12  2.6109412e-16  0              3.3153596    
   2800000   127.27922      200            200            0.0045583868  -5.2937716e-39  0              0.01367516     2.4900005e-21  0              1.2023321e-14  2.6109412e-16  0              3.3153596    
   2900000   127.27922      200            200            0.0045583868  -6.6190273e-39  0              0.01367516     8.1335375e-20  0              3.9273942e-13  2.6109412e-16  0              3.3153596    
   3000000   127.27922      200            200            0.0045583868   5.524962e-39   0              0.01367516     6.228293e-21   0              3.0074198e-14  2.6109412e-16  0              3.3153596    
Loop time of 69.1612 on 4 procs for 3000000 steps with 51 atoms

Performance: 37477658.029 ns/day, 0.000 hours/ns, 43376.919 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28619    | 1.1727     | 3.7657     | 138.3 |  1.70
Neigh   | 0.052573   | 0.05462    | 0.057528   |   0.9 |  0.08
Comm    | 29.895     | 37.463     | 43.619     |  94.3 | 54.17
Output  | 0.072046   | 0.072222   | 0.072375   |   0.1 |  0.10
Modify  | 14.831     | 21.656     | 30.023     | 145.8 | 31.31
Other   |            | 8.742      |            |       | 12.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.65                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.0144268439039
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.75
  ghost atom cutoff = 3.75
  binsize = 1.875, bins = 68 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.62 | 17.09 | 18.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.01942197     0.0026201042   0              0.055645807    15350.752      0              7.4123288e+10  2.6109412e-16  0              3.3161518    
    200000   127.27922      200            200           -0.00044441518  1.9383673e-37  0             -0.0013332455   1710.6301      0              8.2600207e+09  2.6109412e-16  0              3.4142189    
    300000   127.27922      200            200           -0.00026998941 -6.1774186e-37  0             -0.00080996823  422.42638      0              2.0397458e+09  2.6109412e-16  0              3.3432989    
    400000   127.27922      200            200            0.01652609     0.0030685198   0              0.046509749    84.646653      0              4.087284e+08   2.6109412e-16  0              3.3159641    
    500000   127.27922      200            200            0.0018145214  -4.5748863e-36  0              0.0054435643   10.909673      0              52678909       2.6109412e-16  0              3.3224472    
    600000   127.27922      200            200            0.0031517153  -9.0830222e-37  0              0.0094551458   0.00059635387  0              2879.5794      2.6109412e-16  0              3.3213771    
    700000   127.27922      200            200            0.0044363227  -2.4565092e-37  0              0.013308968    0.42859971     0              2069554.6      2.6109412e-16  0              3.3204564    
    800000   127.27922      200            200            0.0047508565   1.6606998e-36  0              0.014252569    0.0089605579   0              43267.327      2.6109412e-16  0              3.3202375    
    900000   127.27922      200            200            0.0046015005  -1.1948417e-37  0              0.013804502    0.0062504097   0              30180.991      2.6109412e-16  0              3.3203361    
   1000000   127.27922      200            200            0.004543946    5.6866605e-38  0              0.013631838    0.00043302491  0              2090.9223      2.6109412e-16  0              3.3203757    
   1100000   127.27922      200            200            0.004558186   -4.3103604e-38  0              0.013674558    7.3497561e-05  0              354.89342      2.6109412e-16  0              3.3203664    
   1200000   127.27922      200            200            0.0045674309   3.7250836e-39  0              0.013702293    1.3602043e-05  0              65.679399      2.6109412e-16  0              3.32036      
   1300000   127.27922      200            200            0.0045664419   5.6611283e-40  0              0.013699326    6.1786924e-07  0              2.9834695      2.6109412e-16  0              3.3203607    
   1400000   127.27922      200            200            0.0045650904  -3.3849315e-39  0              0.013695271    3.3505426e-07  0              1.6178571      2.6109412e-16  0              3.3203616    
   1500000   127.27922      200            200            0.0045650871  -7.2216311e-39  0              0.013695261    2.26743e-09    0              0.010948608    2.6109412e-16  0              3.3203616    
   1600000   127.27922      200            200            0.0045652696  -2.6336829e-39  0              0.013695809    6.9162889e-09  0              0.033396284    2.6109412e-16  0              3.3203615    
   1700000   127.27922      200            200            0.0045652886   3.9123122e-39  0              0.013695866    3.988293e-12   0              1.9258039e-05  2.6109412e-16  0              3.3203615    
   1800000   127.27922      200            200            0.0045652658  -3.9687852e-39  0              0.013695798    1.2213353e-10  0              0.00058973913  2.6109412e-16  0              3.3203615    
   1900000   127.27922      200            200            0.004565261    6.3782035e-39  0              0.013695783    1.9373742e-12  0              9.3548865e-06  2.6109412e-16  0              3.3203615    
   2000000   127.27922      200            200            0.0045652635  -3.1691903e-39  0              0.013695791    1.833875e-12   0              8.8551259e-06  2.6109412e-16  0              3.3203615    
   2100000   127.27922      200            200            0.0045652645   7.3474802e-39  0              0.013695793    1.0617883e-13  0              5.1269959e-07  2.6109412e-16  0              3.3203615    
   2200000   127.27922      200            200            0.0045652642  -7.4604171e-39  0              0.013695793    2.2542321e-14  0              1.088488e-07   2.6109412e-16  0              3.3203615    
   2300000   127.27922      200            200            0.0045652641  -5.2190956e-39  0              0.013695792    3.5208779e-15  0              1.7001059e-08  2.6109412e-16  0              3.3203615    
   2400000   127.27922      200            200            0.0045652641  -1.3158638e-38  0              0.013695792    2.0517409e-16  0              9.9071226e-10  2.6109412e-16  0              3.3203615    
   2500000   127.27922      200            200            0.0045652641   1.0491339e-38  0              0.013695792    9.0880185e-17  0              4.3882789e-10  2.6109412e-16  0              3.3203615    
   2600000   127.27922      200            200            0.0045652641   1.5808586e-39  0              0.013695792    9.7970612e-19  0              4.7306503e-12  2.6109412e-16  0              3.3203615    
   2700000   127.27922      200            200            0.0045652641  -2.355673e-39   0              0.013695792    1.5722751e-18  0              7.5919539e-12  2.6109412e-16  0              3.3203615    
   2800000   127.27922      200            200            0.0045652641   3.532594e-39   0              0.013695792    5.1056717e-20  0              2.4653461e-13  2.6109412e-16  0              3.3203615    
   2900000   127.27922      200            200            0.0045652641   2.3076836e-39  0              0.013695792    1.3840502e-19  0              6.6830829e-13  2.6109412e-16  0              3.3203615    
   3000000   127.27922      200            200            0.0045652641   3.2175853e-41  0              0.013695792    6.867081e-20   0              3.3158676e-13  2.6109412e-16  0              3.3203615    
Loop time of 68.9661 on 4 procs for 3000000 steps with 51 atoms

Performance: 37583675.591 ns/day, 0.000 hours/ns, 43499.625 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29294    | 1.1715     | 3.7565     | 137.9 |  1.70
Neigh   | 0.047366   | 0.04924    | 0.052083   |   0.9 |  0.07
Comm    | 29.87      | 37.384     | 43.553     |  93.6 | 54.21
Output  | 0.074045   | 0.074246   | 0.074442   |   0.1 |  0.11
Modify  | 14.779     | 21.583     | 29.855     | 144.5 | 31.30
Other   |            | 8.703      |            |       | 12.62

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.66                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.4760818946735
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.76
  ghost atom cutoff = 3.76
  binsize = 1.88, bins = 68 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.62 | 17.09 | 18.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.053664976    0.018317776    0              0.14267715     14700.675      0              7.0984299e+10  2.6109412e-16  0              3.3156943    
    200000   127.27922      200            200           -0.00044172072 -8.7141608e-38  0             -0.0013251622   1648.0448      0              7.9578183e+09  2.6109412e-16  0              3.4217636    
    300000   127.27922      200            200           -0.00026188498  5.4378395e-37  0             -0.00078565495  389.16874      0              1.8791566e+09  2.6109412e-16  0              3.3497769    
    400000   127.27922      200            200            0.019820971    0.004560218    0              0.054902694    47.381831      0              2.2878991e+08  2.6109412e-16  0              3.320311     
    500000   127.27922      200            200            0.0015073613   7.8058308e-36  0              0.0045220838   6.9145305      0              33387793       2.6109412e-16  0              3.3277488    
    600000   127.27922      200            200            0.0031842284   2.7650538e-36  0              0.0095526853   0.11475967     0              554133.36      2.6109412e-16  0              3.3263618    
    700000   127.27922      200            200            0.0045644914   3.4122325e-37  0              0.013693474    0.45535815     0              2198761.5      2.6109412e-16  0              3.3253758    
    800000   127.27922      200            200            0.0047704682  -5.0616155e-37  0              0.014311405    0.0012110764   0              5847.8544      2.6109412e-16  0              3.3252305    
    900000   127.27922      200            200            0.0045900771   2.1534726e-38  0              0.013770231    0.0078044642   0              37684.964      2.6109412e-16  0              3.3253503    
   1000000   127.27922      200            200            0.0045470014   7.554593e-38   0              0.013641004    0.00015239148  0              735.8439       2.6109412e-16  0              3.3253803    
   1100000   127.27922      200            200            0.0045675274   4.6820998e-38  0              0.013702582    0.00011843472  0              571.87887      2.6109412e-16  0              3.3253666    
   1200000   127.27922      200            200            0.0045751476  -6.0039773e-39  0              0.013725443    6.8128827e-06  0              32.896973      2.6109412e-16  0              3.3253614    
   1300000   127.27922      200            200            0.0045730247   5.6329526e-39  0              0.013719074    1.5572883e-06  0              7.5195881      2.6109412e-16  0              3.3253628    
   1400000   127.27922      200            200            0.0045718107   1.1176714e-38  0              0.013715432    2.1229389e-07  0              1.0250912      2.6109412e-16  0              3.3253636    
   1500000   127.27922      200            200            0.0045719933   8.3954594e-39  0              0.01371598     1.6680191e-08  0              0.080542675    2.6109412e-16  0              3.3253635    
   1600000   127.27922      200            200            0.0045721734   8.0026962e-40  0              0.01371652     5.3999819e-09  0              0.02607458     2.6109412e-16  0              3.3253634    
   1700000   127.27922      200            200            0.0045721642  -4.2345782e-39  0              0.013716492    1.2416958e-10  0              0.00059957048  2.6109412e-16  0              3.3253634    
   1800000   127.27922      200            200            0.004572139   -6.1640388e-39  0              0.013716417    1.1891374e-10  0              0.00057419189  2.6109412e-16  0              3.3253634    
   1900000   127.27922      200            200            0.0045721381  -4.4005842e-39  0              0.013716414    3.225985e-13   0              1.5577127e-06  2.6109412e-16  0              3.3253634    
   2000000   127.27922      200            200            0.0045721414   4.6322801e-40  0              0.013716424    2.3244595e-12  0              1.1223983e-05  2.6109412e-16  0              3.3253634    
   2100000   127.27922      200            200            0.0045721418   1.7787398e-39  0              0.013716425    2.9782191e-15  0              1.4380754e-08  2.6109412e-16  0              3.3253634    
   2200000   127.27922      200            200            0.0045721414   8.6294529e-39  0              0.013716424    4.0645837e-14  0              1.962642e-07   2.6109412e-16  0              3.3253634    
   2300000   127.27922      200            200            0.0045721413  -1.1058404e-38  0              0.013716424    6.1045227e-16  0              2.9476556e-09  2.6109412e-16  0              3.3253634    
   2400000   127.27922      200            200            0.0045721414  -2.8050612e-39  0              0.013716424    6.3472374e-16  0              3.0648538e-09  2.6109412e-16  0              3.3253634    
   2500000   127.27922      200            200            0.0045721414   1.3173297e-39  0              0.013716424    2.8351782e-17  0              1.3690061e-10  2.6109412e-16  0              3.3253634    
   2600000   127.27922      200            200            0.0045721414  -2.3157759e-39  0              0.013716424    8.9569062e-18  0              4.3249695e-11  2.6109412e-16  0              3.3253634    
   2700000   127.27922      200            200            0.0045721414   4.4609355e-39  0              0.013716424    4.2718694e-19  0              2.0627329e-12  2.6109412e-16  0              3.3253634    
   2800000   127.27922      200            200            0.0045721414   4.7130173e-40  0              0.013716424    2.4240227e-19  0              1.1704738e-12  2.6109412e-16  0              3.3253634    
   2900000   127.27922      200            200            0.0045721414  -2.1709295e-39  0              0.013716424    3.9184938e-20  0              1.8921004e-13  2.6109412e-16  0              3.3253634    
   3000000   127.27922      200            200            0.0045721414  -5.8777255e-39  0              0.013716424    1.4532742e-19  0              7.0173409e-13  2.6109412e-16  0              3.3253634    
Loop time of 68.9927 on 4 procs for 3000000 steps with 51 atoms

Performance: 37569213.101 ns/day, 0.000 hours/ns, 43482.886 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28316    | 1.1856     | 3.832      | 140.3 |  1.72
Neigh   | 0.045828   | 0.047249   | 0.04948    |   0.7 |  0.07
Comm    | 29.958     | 37.435     | 43.62      |  93.2 | 54.26
Output  | 0.076758   | 0.076956   | 0.077139   |   0.1 |  0.11
Modify  | 14.683     | 21.499     | 29.782     | 144.6 | 31.16
Other   |            | 8.749      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.67                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.9402665558481
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.77
  ghost atom cutoff = 3.77
  binsize = 1.885, bins = 68 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.62 | 17.09 | 18.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.10241971     0.014929369    0              0.29232977     13120.552      0              6.3354448e+10  2.6109412e-16  0              3.3154337    
    200000   127.27922      200            200           -0.00043881461  2.4212965e-38  0             -0.0013164438   1586.6829      0              7.661524e+09   2.6109412e-16  0              3.4292628    
    300000   127.27922      200            200           -0.00025355728  3.1213505e-37  0             -0.00076067184  357.31303      0              1.7253367e+09  2.6109412e-16  0              3.3561963    
    400000   127.27922      200            200            0.022244933    0.0056907382   0              0.06104406     16.85278       0              81376043       2.6109412e-16  0              3.3248656    
    500000   127.27922      200            200            0.0012894586   3.5420295e-37  0              0.0038683758   3.5878897      0              17324635       2.6109412e-16  0              3.3329796    
    600000   127.27922      200            200            0.003269795   -2.2096127e-36  0              0.0098093849   0.47400134     0              2288782.9      2.6109412e-16  0              3.3313062    
    700000   127.27922      200            200            0.0046942941   7.2578687e-38  0              0.014082882    0.43568926     0              2103787.5      2.6109412e-16  0              3.3302947    
    800000   127.27922      200            200            0.0047777044  -1.745779e-36   0              0.014333113    0.00073338265  0              3541.2424      2.6109412e-16  0              3.3302317    
    900000   127.27922      200            200            0.0045773691  -1.108298e-38   0              0.013732107    0.0083194419   0              40171.608      2.6109412e-16  0              3.3303654    
   1000000   127.27922      200            200            0.0045521619   1.1451272e-37  0              0.013656486    8.2610124e-06  0              39.889473      2.6109412e-16  0              3.3303834    
   1100000   127.27922      200            200            0.0045773137   1.3965421e-38  0              0.013731941    0.00014735084  0              711.50446      2.6109412e-16  0              3.3303666    
   1200000   127.27922      200            200            0.0045825348  -2.347819e-38   0              0.013747604    1.5638421e-06  0              7.5512338      2.6109412e-16  0              3.3303629    
   1300000   127.27922      200            200            0.0045794984   1.5690422e-40  0              0.013738495    2.4151491e-06  0              11.661891      2.6109412e-16  0              3.3303649    
   1400000   127.27922      200            200            0.0045785769   7.2009763e-39  0              0.013735731    7.8082537e-08  0              0.37703263     2.6109412e-16  0              3.3303656    
   1500000   127.27922      200            200            0.0045789224   7.3483695e-39  0              0.013736767    3.6283287e-08  0              0.17519901     2.6109412e-16  0              3.3303653    
   1600000   127.27922      200            200            0.0045790716   3.4346333e-40  0              0.013737215    2.6342189e-09  0              0.0127197      2.6109412e-16  0              3.3303652    
   1700000   127.27922      200            200            0.0045790354   1.3432023e-39  0              0.013737106    4.9003121e-10  0              0.0023661853   2.6109412e-16  0              3.3303653    
   1800000   127.27922      200            200            0.0045790127  -3.0418619e-39  0              0.013737038    7.2513993e-11  0              0.00035014412  2.6109412e-16  0              3.3303653    
   1900000   127.27922      200            200            0.0045790159  -4.9479268e-39  0              0.013737048    5.7200935e-12  0              2.7620284e-05  2.6109412e-16  0              3.3303653    
   2000000   127.27922      200            200            0.0045790193  -3.753801e-39   0              0.013737058    1.7475926e-12  0              8.4384992e-06  2.6109412e-16  0              3.3303653    
   2100000   127.27922      200            200            0.004579019   -7.3207691e-39  0              0.013737057    5.2840958e-14  0              2.5515008e-07  2.6109412e-16  0              3.3303653    
   2200000   127.27922      200            200            0.0045790186  -5.9609832e-39  0              0.013737056    3.8101708e-14  0              1.8397951e-07  2.6109412e-16  0              3.3303653    
   2300000   127.27922      200            200            0.0045790186   1.5412231e-39  0              0.013737056    2.9786076e-16  0              1.438263e-09   2.6109412e-16  0              3.3303653    
   2400000   127.27922      200            200            0.0045790186   6.0492962e-41  0              0.013737056    7.6368453e-16  0              3.6875593e-09  2.6109412e-16  0              3.3303653    
   2500000   127.27922      200            200            0.0045790186   7.1558536e-39  0              0.013737056    3.3468603e-19  0              1.6160791e-12  2.6109412e-16  0              3.3303653    
   2600000   127.27922      200            200            0.0045790186   2.2551746e-39  0              0.013737056    1.419054e-17   0              6.852104e-11   2.6109412e-16  0              3.3303653    
   2700000   127.27922      200            200            0.0045790186  -1.080525e-40   0              0.013737056    2.4411561e-20  0              1.1787469e-13  2.6109412e-16  0              3.3303653    
   2800000   127.27922      200            200            0.0045790186   1.0363331e-38  0              0.013737056    2.0828518e-19  0              1.0057346e-12  2.6109412e-16  0              3.3303653    
   2900000   127.27922      200            200            0.0045790186  -8.2234639e-40  0              0.013737056    2.8851491e-20  0              1.3931352e-13  2.6109412e-16  0              3.3303653    
   3000000   127.27922      200            200            0.0045790186   2.3831554e-40  0              0.013737056    1.5753308e-19  0              7.6067087e-13  2.6109412e-16  0              3.3303653    
Loop time of 69.0977 on 4 procs for 3000000 steps with 51 atoms

Performance: 37512092.910 ns/day, 0.000 hours/ns, 43416.774 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29455    | 1.2127     | 3.9321     | 142.6 |  1.76
Neigh   | 0.04964    | 0.05167    | 0.054564   |   0.9 |  0.07
Comm    | 29.82      | 37.391     | 43.655     |  93.4 | 54.11
Output  | 0.074591   | 0.074825   | 0.075027   |   0.1 |  0.11
Modify  | 14.792     | 21.608     | 29.988     | 145.1 | 31.27
Other   |            | 8.76       |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.68                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.4069877389307
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.78
  ghost atom cutoff = 3.78
  binsize = 1.89, bins = 68 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.62 | 17.09 | 18.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.15744806     0.00052522301  0              0.47181894     10417.353      0              5.0301671e+10  2.6109412e-16  0              3.3155941    
    200000   127.27922      200            200           -0.00043569771  2.9075173e-38  0             -0.0013070931   1526.5397      0              7.3711138e+09  2.6109412e-16  0              3.4367166    
    300000   127.27922      200            200           -0.00024500737  4.6718731e-37  0             -0.00073502212  326.85302      0              1.5782563e+09  2.6109412e-16  0              3.3625569    
    400000   127.27922      200            200            0.023425543    0.0062524665   0              0.064024164    1.0749191      0              5190399.6      2.6109412e-16  0              3.3296597    
    500000   127.27922      200            200            0.0011553665   4.1294624e-36  0              0.0034660995   1.2473591      0              6023050.9      2.6109412e-16  0              3.3381343    
    600000   127.27922      200            200            0.003406796    2.673615e-36   0              0.010220388    1.0226064      0              4937800.5      2.6109412e-16  0              3.3362125    
    700000   127.27922      200            200            0.0048192708  -1.1213131e-36  0              0.014457812    0.37326987     0              1802386.6      2.6109412e-16  0              3.3352176    
    800000   127.27922      200            200            0.0047725211   4.3456159e-37  0              0.014317563    0.0075898664   0              36648.749      2.6109412e-16  0              3.3352413    
    900000   127.27922      200            200            0.0045647958  -6.2508243e-38  0              0.013694387    0.0076534875   0              36955.952      2.6109412e-16  0              3.3353805    
   1000000   127.27922      200            200            0.0045595696   1.1322104e-37  0              0.013678709    4.6338982e-05  0              223.75436      2.6109412e-16  0              3.335385     
   1100000   127.27922      200            200            0.004587265   -1.0498536e-38  0              0.013761795    0.00014945341  0              721.65702      2.6109412e-16  0              3.3353664    
   1200000   127.27922      200            200            0.0045895374   7.883171e-39   0              0.013768612    5.8013467e-08  0              0.28012627     2.6109412e-16  0              3.3353647    
   1300000   127.27922      200            200            0.004585913    6.3539498e-40  0              0.013757739    2.7812714e-06  0              13.429764      2.6109412e-16  0              3.3353671    
   1400000   127.27922      200            200            0.0045854041  -2.4780604e-40  0              0.013756212    3.6325261e-09  0              0.017540168    2.6109412e-16  0              3.3353675    
   1500000   127.27922      200            200            0.0045858662  -1.6406693e-40  0              0.013757599    4.9428731e-08  0              0.23867365     2.6109412e-16  0              3.3353672    
   1600000   127.27922      200            200            0.0045859608  -1.100192e-39   0              0.013757882    4.2173047e-10  0              0.0020363855   2.6109412e-16  0              3.3353671    
   1700000   127.27922      200            200            0.0045859035   2.3151329e-39  0              0.013757711    8.3767023e-10  0              0.0040448098   2.6109412e-16  0              3.3353672    
   1800000   127.27922      200            200            0.0045858875  -1.4866907e-39  0              0.013757663    1.9277726e-11  0              9.3085241e-05  2.6109412e-16  0              3.3353672    
   1900000   127.27922      200            200            0.0045858944  -1.1887662e-38  0              0.013757683    1.3484659e-11  0              6.5112595e-05  2.6109412e-16  0              3.3353672    
   2000000   127.27922      200            200            0.0045858969   5.0233565e-39  0              0.013757691    6.3783407e-13  0              3.0798725e-06  2.6109412e-16  0              3.3353672    
   2100000   127.27922      200            200            0.0045858961  -5.2229699e-39  0              0.013757688    2.0473461e-13  0              9.8859016e-07  2.6109412e-16  0              3.3353672    
   2200000   127.27922      200            200            0.0045858958   1.5606551e-39  0              0.013757687    1.7745662e-14  0              8.5687451e-08  2.6109412e-16  0              3.3353672    
   2300000   127.27922      200            200            0.0045858958   3.5902867e-39  0              0.013757688    2.8914472e-15  0              1.3961764e-08  2.6109412e-16  0              3.3353672    
   2400000   127.27922      200            200            0.0045858959   3.2931188e-39  0              0.013757688    4.3918581e-16  0              2.1206711e-09  2.6109412e-16  0              3.3353672    
   2500000   127.27922      200            200            0.0045858959  -3.5614236e-39  0              0.013757688    3.8364643e-17  0              1.8524913e-10  2.6109412e-16  0              3.3353672    
   2600000   127.27922      200            200            0.0045858959   1.1910989e-39  0              0.013757688    9.6075547e-18  0              4.6391443e-11  2.6109412e-16  0              3.3353672    
   2700000   127.27922      200            200            0.0045858959  -6.0007615e-40  0              0.013757688    8.7890108e-19  0              4.2438987e-12  2.6109412e-16  0              3.3353672    
   2800000   127.27922      200            200            0.0045858959   2.5725755e-39  0              0.013757688    4.2173428e-20  0              2.0364039e-13  2.6109412e-16  0              3.3353672    
   2900000   127.27922      200            200            0.0045858959   5.8750211e-39  0              0.013757688    2.5461745e-20  0              1.2294566e-13  2.6109412e-16  0              3.3353672    
   3000000   127.27922      200            200            0.0045858959  -3.9999104e-39  0              0.013757688    9.458593e-23   0              4.5672161e-16  2.6109412e-16  0              3.3353672    
Loop time of 68.9078 on 4 procs for 3000000 steps with 51 atoms

Performance: 37615502.049 ns/day, 0.000 hours/ns, 43536.461 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29504    | 1.2199     | 3.9436     | 142.4 |  1.77
Neigh   | 0.046901   | 0.048723   | 0.051395   |   0.8 |  0.07
Comm    | 29.744     | 37.295     | 43.57      |  93.3 | 54.12
Output  | 0.075847   | 0.076061   | 0.076254   |   0.1 |  0.11
Modify  | 14.676     | 21.503     | 29.854     | 145.0 | 31.21
Other   |            | 8.765      |            |       | 12.72

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.69                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.8762523554259
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.79
  ghost atom cutoff = 3.79
  binsize = 1.895, bins = 68 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.62 | 17.09 | 18.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.21097534    -0.017317741    0              0.65024377     6941.2609      0              3.3516865e+10  2.6109412e-16  0              3.3164494    
    200000   127.27922      200            200           -0.00043237106 -1.9356401e-38  0             -0.0012971132   1467.6125      0              7.0865756e+09  2.6109412e-16  0              3.444125     
    300000   127.27922      200            200           -0.00023623682  6.2171895e-37  0             -0.00070871046  297.7843       0              1.4378938e+09  2.6109412e-16  0              3.3688587    
    400000   127.27922      200            200            0.023217423    0.006272824    0              0.063379445    4.437398       0              21426607       2.6109412e-16  0              3.3347092    
    500000   127.27922      200            200            0.0011000926  -3.346154e-36   0              0.0033002777   0.10008196     0              483259.96      2.6109412e-16  0              3.3432094    
    600000   127.27922      200            200            0.0035921793   4.5119502e-36  0              0.010776538    1.6748259      0              8087135        2.6109412e-16  0              3.3410844    
    700000   127.27922      200            200            0.0049329785   4.8927871e-36  0              0.014798936    0.2806884      0              1355343.9      2.6109412e-16  0              3.3401484    
    800000   127.27922      200            200            0.0047556819  -8.0110105e-37  0              0.014267046    0.02004274     0              96779.218      2.6109412e-16  0              3.3402586    
    900000   127.27922      200            200            0.0045537606   5.8566364e-38  0              0.013661282    0.0059999842   0              28971.776      2.6109412e-16  0              3.3403945    
   1000000   127.27922      200            200            0.0045691796   9.3218951e-38  0              0.013707539    0.00025250331  0              1219.2481      2.6109412e-16  0              3.3403851    
   1100000   127.27922      200            200            0.0045970855   4.1613245e-39  0              0.013791256    0.00012406249  0              599.05336      2.6109412e-16  0              3.3403663    
   1200000   127.27922      200            200            0.0045961421  -1.4055464e-38  0              0.013788426    2.8924521e-06  0              13.966616      2.6109412e-16  0              3.3403668    
   1300000   127.27922      200            200            0.0045923257   1.1912438e-39  0              0.013776977    2.4836209e-06  0              11.992517      2.6109412e-16  0              3.3403693    
   1400000   127.27922      200            200            0.0045922991  -4.6804932e-40  0              0.013776897    2.7668291e-08  0              0.13360027     2.6109412e-16  0              3.3403694    
   1500000   127.27922      200            200            0.0045928145   1.3894348e-39  0              0.013778443    4.8399912e-08  0              0.23370586     2.6109412e-16  0              3.340369     
   1600000   127.27922      200            200            0.0045928389   4.6165876e-40  0              0.013778517    1.8509022e-10  0              0.00089373443  2.6109412e-16  0              3.340369     
   1700000   127.27922      200            200            0.0045927702  -8.846122e-39   0              0.013778311    9.1941873e-10  0              0.004439544    2.6109412e-16  0              3.340369     
   1800000   127.27922      200            200            0.0045927641  -9.6451199e-39  0              0.013778292    3.766405e-13   0              1.8186622e-06  2.6109412e-16  0              3.340369     
   1900000   127.27922      200            200            0.0045927731  -1.1594406e-38  0              0.013778319    1.7041688e-11  0              8.2288214e-05  2.6109412e-16  0              3.340369     
   2000000   127.27922      200            200            0.0045927743   2.8738377e-39  0              0.013778323    7.0611703e-15  0              3.4095864e-08  2.6109412e-16  0              3.340369     
   2100000   127.27922      200            200            0.0045927732  -1.3436054e-39  0              0.013778319    3.0825831e-13  0              1.4884691e-06  2.6109412e-16  0              3.340369     
   2200000   127.27922      200            200            0.004592773    2.3879667e-39  0              0.013778319    1.1413581e-15  0              5.5112099e-09  2.6109412e-16  0              3.340369     
   2300000   127.27922      200            200            0.0045927731   7.4163841e-39  0              0.013778319    5.4491252e-15  0              2.6311875e-08  2.6109412e-16  0              3.340369     
   2400000   127.27922      200            200            0.0045927731   8.3003131e-39  0              0.013778319    5.6900915e-17  0              2.7475415e-10  2.6109412e-16  0              3.340369     
   2500000   127.27922      200            200            0.0045927731  -2.2173278e-39  0              0.013778319    9.3699354e-17  0              4.5244065e-10  2.6109412e-16  0              3.340369     
   2600000   127.27922      200            200            0.0045927731   8.0364195e-41  0              0.013778319    1.4972007e-18  0              7.2294463e-12  2.6109412e-16  0              3.340369     
   2700000   127.27922      200            200            0.0045927731   6.1213977e-39  0              0.013778319    1.8784237e-18  0              9.0702359e-12  2.6109412e-16  0              3.340369     
   2800000   127.27922      200            200            0.0045927731   6.83424e-39    0              0.013778319    6.1329885e-21  0              2.9614006e-14  2.6109412e-16  0              3.340369     
   2900000   127.27922      200            200            0.0045927731   1.6215033e-39  0              0.013778319    4.821701e-20   0              2.3282268e-13  2.6109412e-16  0              3.340369     
   3000000   127.27922      200            200            0.0045927731  -3.4558116e-39  0              0.013778319    3.3375779e-22  0              1.6115969e-15  2.6109412e-16  0              3.340369     
Loop time of 69.0512 on 4 procs for 3000000 steps with 51 atoms

Performance: 37537347.901 ns/day, 0.000 hours/ns, 43446.005 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29236    | 1.1722     | 3.7653     | 138.3 |  1.70
Neigh   | 0.049839   | 0.052071   | 0.055291   |   1.0 |  0.08
Comm    | 29.873     | 37.399     | 43.566     |  93.5 | 54.16
Output  | 0.075143   | 0.075405   | 0.075642   |   0.1 |  0.11
Modify  | 14.775     | 21.602     | 29.943     | 145.2 | 31.28
Other   |            | 8.751      |            |       | 12.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.7                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.3480673168373
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.8
  ghost atom cutoff = 3.8
  binsize = 1.9, bins = 67 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.61 | 17.08 | 18.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.25560066    -0.033815962    0              0.80061794     3456.0975      0              1.6688258e+10  2.6109412e-16  0              3.3182739    
    200000   127.27922      200            200           -0.00042883548  3.1041401e-37  0             -0.0012865064   1409.8966      0              6.8078863e+09  2.6109412e-16  0              3.4514878    
    300000   127.27922      200            200           -0.0002272467   1.5666242e-37  0             -0.00068174009  270.10098      0              1.3042209e+09  2.6109412e-16  0              3.3751016    
    400000   127.27922      200            200            0.021772394    0.0061448196   0              0.059172363    25.973803      0              1.254182e+08   2.6109412e-16  0              3.3400117    
    500000   127.27922      200            200            0.0011208483  -3.9909147e-37  0              0.0033625448   0.23966158     0              1157240        2.6109412e-16  0              3.3482033    
    600000   127.27922      200            200            0.0038211955   8.1836252e-37  0              0.011463587    2.3266448      0              11234535       2.6109412e-16  0              3.3459271    
    700000   127.27922      200            200            0.0050293992  -6.2313236e-38  0              0.015088198    0.17697865     0              854566.56      2.6109412e-16  0              3.345091     
    800000   127.27922      200            200            0.004728703    4.3964704e-37  0              0.014186109    0.03499288     0              168968.09      2.6109412e-16  0              3.3452827    
    900000   127.27922      200            200            0.0045455489   1.353036e-37   0              0.013636647    0.0038297532   0              18492.508      2.6109412e-16  0              3.3454067    
   1000000   127.27922      200            200            0.004580764    1.1146272e-37  0              0.013742292    0.00055786668  0              2693.7385      2.6109412e-16  0              3.3453839    
   1100000   127.27922      200            200            0.0046064927   4.7547517e-38  0              0.013819478    8.0776567e-05  0              390.04113      2.6109412e-16  0              3.3453664    
   1200000   127.27922      200            200            0.0046023795  -1.8348476e-39  0              0.013807139    8.8225997e-06  0              42.601176      2.6109412e-16  0              3.345369     
   1300000   127.27922      200            200            0.0045987935  -1.9503159e-38  0              0.01379638     1.6671937e-06  0              8.0502816      2.6109412e-16  0              3.3453715    
   1400000   127.27922      200            200            0.0045992593   7.7772556e-39  0              0.013797778    1.3633413e-07  0              0.65830871     2.6109412e-16  0              3.3453712    
   1500000   127.27922      200            200            0.0045997564  -1.2348518e-39  0              0.013799269    3.3886104e-08  0              0.16362387     2.6109412e-16  0              3.3453708    
   1600000   127.27922      200            200            0.0045997059   2.6910354e-40  0              0.013799118    2.0527129e-09  0              0.0099118159   2.6109412e-16  0              3.3453709    
   1700000   127.27922      200            200            0.0045996374  -4.8218679e-39  0              0.013798912    6.7899698e-10  0              0.0032786334   2.6109412e-16  0              3.3453709    
   1800000   127.27922      200            200            0.0045996425  -3.2207227e-39  0              0.013798927    2.9936586e-11  0              0.00014455306  2.6109412e-16  0              3.3453709    
   1900000   127.27922      200            200            0.0045996519  -5.7916683e-39  0              0.013798956    1.343007e-11   0              6.4849003e-05  2.6109412e-16  0              3.3453709    
   2000000   127.27922      200            200            0.0045996514  -5.866918e-39   0              0.013798954    4.1952177e-13  0              2.0257205e-06  2.6109412e-16  0              3.3453709    
   2100000   127.27922      200            200            0.0045996502   5.0276535e-39  0              0.01379895     2.6243926e-13  0              1.2672253e-06  2.6109412e-16  0              3.3453709    
   2200000   127.27922      200            200            0.0045996502   2.6855393e-39  0              0.013798951    5.5818286e-15  0              2.6952653e-08  2.6109412e-16  0              3.3453709    
   2300000   127.27922      200            200            0.0045996504  -2.5979088e-39  0              0.013798951    5.0759013e-15  0              2.4509711e-08  2.6109412e-16  0              3.3453709    
   2400000   127.27922      200            200            0.0045996504   4.3146286e-39  0              0.013798951    6.5411479e-17  0              3.1584862e-10  2.6109412e-16  0              3.3453709    
   2500000   127.27922      200            200            0.0045996503   4.0606667e-39  0              0.013798951    9.7672318e-17  0              4.7162467e-10  2.6109412e-16  0              3.3453709    
   2600000   127.27922      200            200            0.0045996503  -5.169238e-39   0              0.013798951    9.7968362e-19  0              4.7305416e-12  2.6109412e-16  0              3.3453709    
   2700000   127.27922      200            200            0.0045996503  -2.1841301e-39  0              0.013798951    1.3458801e-18  0              6.4987732e-12  2.6109412e-16  0              3.3453709    
   2800000   127.27922      200            200            0.0045996503   3.1274478e-40  0              0.013798951    1.0868596e-19  0              5.2480561e-13  2.6109412e-16  0              3.3453709    
   2900000   127.27922      200            200            0.0045996503   5.9606725e-39  0              0.013798951    8.9689529e-20  0              4.3307864e-13  2.6109412e-16  0              3.3453709    
   3000000   127.27922      200            200            0.0045996503   2.0573901e-39  0              0.013798951    3.2553748e-22  0              1.571904e-15   2.6109412e-16  0              3.3453709    
Loop time of 68.9643 on 4 procs for 3000000 steps with 51 atoms

Performance: 37584652.933 ns/day, 0.000 hours/ns, 43500.756 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28292    | 1.1778     | 3.8078     | 139.9 |  1.71
Neigh   | 0.047125   | 0.04889    | 0.051641   |   0.8 |  0.07
Comm    | 29.974     | 37.432     | 43.613     |  93.0 | 54.28
Output  | 0.074598   | 0.074807   | 0.074996   |   0.1 |  0.11
Modify  | 14.707     | 21.498     | 29.771     | 144.6 | 31.17
Other   |            | 8.733      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.71                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.8224395346687
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.81
  ghost atom cutoff = 3.81
  binsize = 1.905, bins = 67 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.57 | 17.04 | 18.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.28490927    -0.045232649    0              0.89996046     892.36816      0              4.3089265e+09  2.6109412e-16  0              3.3213002    
    200000   127.27922      200            200           -0.00042509215  1.3330866e-40  0             -0.0012752765   1353.3913      0              6.5350422e+09  2.6109412e-16  0              3.458805     
    300000   127.27922      200            200           -0.00021803902  9.3235286e-37  0             -0.00065411707  243.79992      0              1.1772226e+09  2.6109412e-16  0              3.3812853    
    400000   127.27922      200            200            0.019212336    0.0056402549   0              0.051996753    59.677254      0              2.881601e+08   2.6109412e-16  0              3.3455467    
    500000   127.27922      200            200            0.0012180511  -1.6804841e-36  0              0.0036541533   1.646982       0              7952686.4      2.6109412e-16  0              3.3531162    
    600000   127.27922      200            200            0.0040870961   1.7950696e-37  0              0.012261288    2.8709176      0              13862634       2.6109412e-16  0              3.3507468    
    700000   127.27922      200            200            0.0051033337   8.5248157e-37  0              0.015310001    0.083703237    0              404172.98      2.6109412e-16  0              3.3500485    
    800000   127.27922      200            200            0.0046937476   1.3721624e-37  0              0.014081243    0.048751685    0              235404.44      2.6109412e-16  0              3.3503122    
    900000   127.27922      200            200            0.0045412401   2.542769e-37   0              0.01362372     0.0017559327   0              8478.7704      2.6109412e-16  0              3.3504162    
   1000000   127.27922      200            200            0.0045939301   8.1221012e-38  0              0.01378179     0.00086161236  0              4160.4177      2.6109412e-16  0              3.3503815    
   1100000   127.27922      200            200            0.0046152441   2.3216272e-38  0              0.013845732    3.5801553e-05  0              172.87289      2.6109412e-16  0              3.350367     
   1200000   127.27922      200            200            0.0046083199   1.8828686e-39  0              0.01382496     1.5307468e-05  0              73.914284      2.6109412e-16  0              3.3503715    
   1300000   127.27922      200            200            0.0046053665  -8.3193698e-40  0              0.013816099    7.2152045e-07  0              3.483964       2.6109412e-16  0              3.3503735    
   1400000   127.27922      200            200            0.0046062731  -3.1087212e-40  0              0.013818819    2.7119093e-07  0              1.3094839      2.6109412e-16  0              3.350373     
   1500000   127.27922      200            200            0.0046066821  -1.8267298e-40  0              0.013820046    1.4463548e-08  0              0.069839296    2.6109412e-16  0              3.3503727    
   1600000   127.27922      200            200            0.0046065636   4.4060272e-39  0              0.013819691    4.7948556e-09  0              0.023152642    2.6109412e-16  0              3.3503728    
   1700000   127.27922      200            200            0.004606507   -6.1060396e-39  0              0.013819521    2.8835696e-10  0              0.0013923726   2.6109412e-16  0              3.3503728    
   1800000   127.27922      200            200            0.0046065225  -5.0821607e-39  0              0.013819567    8.4588938e-11  0              0.00040844971  2.6109412e-16  0              3.3503728    
   1900000   127.27922      200            200            0.0046065303  -2.1697604e-39  0              0.013819591    5.7208432e-12  0              2.7623905e-05  2.6109412e-16  0              3.3503728    
   2000000   127.27922      200            200            0.0046065283  -4.0223467e-39  0              0.013819585    1.4888853e-12  0              7.1892944e-06  2.6109412e-16  0              3.3503728    
   2100000   127.27922      200            200            0.0046065272  -4.5879238e-39  0              0.013819582    1.1296811e-13  0              5.4548256e-07  2.6109412e-16  0              3.3503728    
   2200000   127.27922      200            200            0.0046065274   9.8061354e-40  0              0.013819582    2.6142098e-14  0              1.2623084e-07  2.6109412e-16  0              3.3503728    
   2300000   127.27922      200            200            0.0046065276   5.8433326e-40  0              0.013819583    2.2153716e-15  0              1.0697237e-08  2.6109412e-16  0              3.3503728    
   2400000   127.27922      200            200            0.0046065276   5.7290093e-39  0              0.013819583    4.5815017e-16  0              2.2122432e-09  2.6109412e-16  0              3.3503728    
   2500000   127.27922      200            200            0.0046065275  -4.7634919e-39  0              0.013819583    4.4685884e-17  0              2.1577214e-10  2.6109412e-16  0              3.3503728    
   2600000   127.27922      200            200            0.0046065275  -6.2354959e-40  0              0.013819583    8.2965358e-18  0              4.0061002e-11  2.6109412e-16  0              3.3503728    
   2700000   127.27922      200            200            0.0046065275   5.4453614e-39  0              0.013819583    2.6579589e-19  0              1.2834332e-12  2.6109412e-16  0              3.3503728    
   2800000   127.27922      200            200            0.0046065275   1.3494387e-40  0              0.013819583    2.5954353e-19  0              1.2532428e-12  2.6109412e-16  0              3.3503728    
   2900000   127.27922      200            200            0.0046065275  -2.0480502e-40  0              0.013819583    1.5254967e-19  0              7.3660775e-13  2.6109412e-16  0              3.3503728    
   3000000   127.27922      200            200            0.0046065275   8.0301611e-40  0              0.013819583    1.9187349e-20  0              9.2648842e-14  2.6109412e-16  0              3.3503728    
Loop time of 69.0605 on 4 procs for 3000000 steps with 51 atoms

Performance: 37532318.634 ns/day, 0.000 hours/ns, 43440.184 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28229    | 1.1621     | 3.7267     | 137.4 |  1.68
Neigh   | 0.050828   | 0.052998   | 0.055959   |   0.9 |  0.08
Comm    | 29.889     | 37.499     | 43.667     |  94.1 | 54.30
Output  | 0.074429   | 0.074658   | 0.07487    |   0.1 |  0.11
Modify  | 14.757     | 21.582     | 29.951     | 145.3 | 31.25
Other   |            | 8.691      |            |       | 12.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.72                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.299375920424
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.82
  ghost atom cutoff = 3.82
  binsize = 1.91, bins = 67 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.57 | 17.04 | 18.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.29449945    -0.049114949    0              0.93261329     1.8410872      0              8889951.1      2.6109412e-16  0              3.3256831    
    200000   127.27922      200            200           -0.00042114201  7.0522789e-42  0             -0.001263426    1298.0928      0              6.2680254e+09  2.6109412e-16  0              3.4660764    
    300000   127.27922      200            200           -0.00020861495 -2.3131664e-37  0             -0.00062584484  218.87539      0              1.0568709e+09  2.6109412e-16  0              3.3874099    
    400000   127.27922      200            200            0.015469716    0.0035177353   0              0.042891412    96.765796      0              4.672474e+08   2.6109412e-16  0              3.3512783    
    500000   127.27922      200            200            0.0013952551   3.2845548e-36  0              0.0041857652   4.1908194      0              20235967       2.6109412e-16  0              3.35795      
    600000   127.27922      200            200            0.0043810025  -2.2835475e-37  0              0.013143008    3.2145195      0              15521764       2.6109412e-16  0              3.3555511    
    700000   127.27922      200            200            0.0051507927  -2.2534782e-36  0              0.015452378    0.020351714    0              98271.144      2.6109412e-16  0              3.3550232    
    800000   127.27922      200            200            0.0046534679  -1.7452175e-37  0              0.013960404    0.057954354    0              279840.84      2.6109412e-16  0              3.3553453    
    900000   127.27922      200            200            0.0045416306   1.3954037e-37  0              0.013624892    0.0003597881   0              1737.288       2.6109412e-16  0              3.3554226    
   1000000   127.27922      200            200            0.004608154   -1.4223963e-38  0              0.013824462    0.0010641237   0              5138.2723      2.6109412e-16  0              3.3553785    
   1100000   127.27922      200            200            0.0046231605   7.5363482e-39  0              0.013869482    5.841551e-06   0              28.206759      2.6109412e-16  0              3.3553681    
   1200000   127.27922      200            200            0.0046140656   2.7771261e-39  0              0.013842197    1.959607e-05   0              94.622408      2.6109412e-16  0              3.3553741    
   1300000   127.27922      200            200            0.0046120817  -1.2428558e-38  0              0.013836245    9.3324256e-08  0              0.45062943     2.6109412e-16  0              3.3553755    
   1400000   127.27922      200            200            0.0046133217  -1.8163283e-39  0              0.013839965    3.6062133e-07  0              1.7413113      2.6109412e-16  0              3.3553747    
   1500000   127.27922      200            200            0.0046135842  -5.3273562e-39  0              0.013840753    1.4766228e-09  0              0.0071300833   2.6109412e-16  0              3.3553745    
   1600000   127.27922      200            200            0.0046134151  -1.7119591e-40  0              0.013840245    6.6343078e-09  0              0.032034698    2.6109412e-16  0              3.3553746    
   1700000   127.27922      200            200            0.0046133804   4.9818659e-39  0              0.013840141    2.3084272e-11  0              0.00011146569  2.6109412e-16  0              3.3553746    
   1800000   127.27922      200            200            0.0046134035  -6.7766102e-39  0              0.01384021     1.2200499e-10  0              0.00058911842  2.6109412e-16  0              3.3553746    
   1900000   127.27922      200            200            0.004613408   -6.9624857e-39  0              0.013840224    3.5587547e-13  0              1.7183953e-06  2.6109412e-16  0              3.3553746    
   2000000   127.27922      200            200            0.0046134049   1.862201e-40   0              0.013840215    2.2428603e-12  0              1.082997e-05   2.6109412e-16  0              3.3553746    
   2100000   127.27922      200            200            0.0046134043  -2.2787101e-39  0              0.013840213    5.3946289e-15  0              2.6048732e-08  2.6109412e-16  0              3.3553746    
   2200000   127.27922      200            200            0.0046134047  -4.667602e-39   0              0.013840214    4.1218282e-14  0              1.9902833e-07  2.6109412e-16  0              3.3553746    
   2300000   127.27922      200            200            0.0046134048   5.1306569e-39  0              0.013840214    8.0822816e-17  0              3.9026445e-10  2.6109412e-16  0              3.3553746    
   2400000   127.27922      200            200            0.0046134047   8.9634937e-39  0              0.013840214    7.5740485e-16  0              3.657237e-09   2.6109412e-16  0              3.3553746    
   2500000   127.27922      200            200            0.0046134047  -1.6371544e-39  0              0.013840214    1.4446295e-18  0              6.9755986e-12  2.6109412e-16  0              3.3553746    
   2600000   127.27922      200            200            0.0046134047  -5.481023e-39   0              0.013840214    1.3952789e-17  0              6.7373026e-11  2.6109412e-16  0              3.3553746    
   2700000   127.27922      200            200            0.0046134047   4.7015483e-39  0              0.013840214    7.5450337e-20  0              3.6432268e-13  2.6109412e-16  0              3.3553746    
   2800000   127.27922      200            200            0.0046134047   4.7020341e-40  0              0.013840214    1.5432084e-19  0              7.451601e-13   2.6109412e-16  0              3.3553746    
   2900000   127.27922      200            200            0.0046134047  -9.8348691e-42  0              0.013840214    1.1293589e-20  0              5.45327e-14    2.6109412e-16  0              3.3553746    
   3000000   127.27922      200            200            0.0046134047  -3.9938252e-39  0              0.013840214    1.2603924e-19  0              6.0859839e-13  2.6109412e-16  0              3.3553746    
Loop time of 69.0263 on 4 procs for 3000000 steps with 51 atoms

Performance: 37550896.565 ns/day, 0.000 hours/ns, 43461.686 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29345    | 1.1843     | 3.8134     | 139.5 |  1.72
Neigh   | 0.047915   | 0.049634   | 0.052354   |   0.8 |  0.07
Comm    | 29.846     | 37.43      | 43.664     |  94.0 | 54.23
Output  | 0.075917   | 0.076131   | 0.076335   |   0.1 |  0.11
Modify  | 14.681     | 21.535     | 29.911     | 145.5 | 31.20
Other   |            | 8.752      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.73                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.7788833856071
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.83
  ghost atom cutoff = 3.83
  binsize = 1.915, bins = 67 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.57 | 17.04 | 18.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.28155094    -0.04830371     0              0.89295652     1052.4608      0              5.0819563e+09  2.6109412e-16  0              3.3314744    
    200000   127.27922      200            200           -0.00041698594 -3.0262766e-39  0             -0.0012509578   1243.9969      0              6.0068158e+09  2.6109412e-16  0              3.473302     
    300000   127.27922      200            200           -0.00019897575 -3.0883159e-37  0             -0.00059692724  195.32219      0              9.4314093e+08  2.6109412e-16  0              3.3934752    
    400000   127.27922      200            200            0.011543246    0.001447465    0              0.033182272    128.84315      0              6.2213747e+08  2.6109412e-16  0              3.3571609    
    500000   127.27922      200            200            0.0016580072  -5.4084482e-36  0              0.0049740216   7.6285472      0              36835524       2.6109412e-16  0              3.3627086    
    600000   127.27922      200            200            0.0046918797  -7.9153777e-37  0              0.014075639    3.2946247      0              15908563       2.6109412e-16  0              3.3603483    
    700000   127.27922      200            200            0.0051692906   5.4456724e-37  0              0.015507872    0.0001297279   0              626.40959      2.6109412e-16  0              3.3600166    
    800000   127.27922      200            200            0.0046108264  -2.0696461e-38  0              0.013832479    0.06037743     0              291541         2.6109412e-16  0              3.3603802    
    900000   127.27922      200            200            0.0045471827   4.8756287e-37  0              0.013641548    2.7720056e-05  0              133.85023      2.6109412e-16  0              3.3604255    
   1000000   127.27922      200            200            0.0046228227   6.4523097e-38  0              0.013868468    0.0010994235   0              5308.7228      2.6109412e-16  0              3.3603751    
   1100000   127.27922      200            200            0.0046301431  -3.1927535e-38  0              0.013890429    1.873268e-06   0              9.0453408      2.6109412e-16  0              3.3603699    
   1200000   127.27922      200            200            0.0046197399  -8.882558e-39   0              0.01385922     1.9887659e-05  0              96.030389      2.6109412e-16  0              3.3603768    
   1300000   127.27922      200            200            0.0046189586  -1.3042682e-38  0              0.013856876    7.4904341e-08  0              0.36168625     2.6109412e-16  0              3.3603774    
   1400000   127.27922      200            200            0.0046203815   1.9655697e-39  0              0.013861145    3.5767873e-07  0              1.7271026      2.6109412e-16  0              3.3603764    
   1500000   127.27922      200            200            0.004620459    1.4925451e-39  0              0.013861377    2.3920522e-09  0              0.011550364    2.6109412e-16  0              3.3603764    
   1600000   127.27922      200            200            0.0046202649   2.6781029e-39  0              0.013860795    6.3938118e-09  0              0.030873429    2.6109412e-16  0              3.3603765    
   1700000   127.27922      200            200            0.0046202583   8.3744713e-39  0              0.013860775    6.7333489e-11  0              0.00032512932  2.6109412e-16  0              3.3603765    
   1800000   127.27922      200            200            0.0046202847  -5.2581579e-39  0              0.013860854    1.1358826e-10  0              0.00054847705  2.6109412e-16  0              3.3603765    
   1900000   127.27922      200            200            0.0046202851  -3.6875642e-39  0              0.013860855    1.7475119e-12  0              8.4381095e-06  2.6109412e-16  0              3.3603765    
   2000000   127.27922      200            200            0.0046202815   6.42275e-39    0              0.013860844    2.0049661e-12  0              9.6812639e-06  2.6109412e-16  0              3.3603765    
   2100000   127.27922      200            200            0.0046202815  -4.5852638e-39  0              0.013860845    4.2851021e-14  0              2.0691224e-07  2.6109412e-16  0              3.3603765    
   2200000   127.27922      200            200            0.004620282   -2.8111565e-39  0              0.013860846    3.515431e-14   0              1.6974758e-07  2.6109412e-16  0              3.3603765    
   2300000   127.27922      200            200            0.004620282    2.6715189e-39  0              0.013860846    1.0060518e-15  0              4.8578643e-09  2.6109412e-16  0              3.3603765    
   2400000   127.27922      200            200            0.0046202819   2.1834188e-39  0              0.013860846    6.1077359e-16  0              2.9492071e-09  2.6109412e-16  0              3.3603765    
   2500000   127.27922      200            200            0.0046202819  -3.0596534e-39  0              0.013860846    2.4804729e-17  0              1.1977316e-10  2.6109412e-16  0              3.3603765    
   2600000   127.27922      200            200            0.0046202819  -6.39407e-39    0              0.013860846    1.0175535e-17  0              4.9134018e-11  2.6109412e-16  0              3.3603765    
   2700000   127.27922      200            200            0.0046202819  -3.5768935e-39  0              0.013860846    9.7454119e-19  0              4.7057106e-12  2.6109412e-16  0              3.3603765    
   2800000   127.27922      200            200            0.0046202819  -3.0752893e-39  0              0.013860846    1.6975243e-20  0              8.1967371e-14  2.6109412e-16  0              3.3603765    
   2900000   127.27922      200            200            0.0046202819   1.2670242e-38  0              0.013860846    5.2111261e-21  0              2.5162663e-14  2.6109412e-16  0              3.3603765    
   3000000   127.27922      200            200            0.0046202819   4.9303536e-39  0              0.013860846    2.6379409e-20  0              1.2737673e-13  2.6109412e-16  0              3.3603765    
Loop time of 69.0239 on 4 procs for 3000000 steps with 51 atoms

Performance: 37552187.038 ns/day, 0.000 hours/ns, 43463.179 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28618    | 1.1765     | 3.7852     | 138.9 |  1.70
Neigh   | 0.05       | 0.051855   | 0.054687   |   0.9 |  0.08
Comm    | 29.89      | 37.451     | 43.653     |  94.0 | 54.26
Output  | 0.077804   | 0.078038   | 0.078259   |   0.1 |  0.11
Modify  | 14.753     | 21.578     | 29.921     | 145.2 | 31.26
Other   |            | 8.689      |            |       | 12.59

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.74                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.2609688417216
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.84
  ghost atom cutoff = 3.84
  binsize = 1.92, bins = 67 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.57 | 17.04 | 18.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.24703144    -0.045642642    0              0.78673698     3712.2073      0              1.792492e+10   2.6109412e-16  0              3.3386143    
    200000   127.27922      200            200           -0.0004126249   1.1629069e-37  0             -0.0012378747   1191.1003      0              5.7513971e+09  2.6109412e-16  0              3.4804817    
    300000   127.27922      200            200           -0.00018912274 -4.5828791e-37  0             -0.00056736821  173.13524      0              8.360081e+08   2.6109412e-16  0              3.3994812    
    400000   127.27922      200            200            0.0082228857   4.5169489e-05  0              0.024623488    150.79092      0              7.2811538e+08  2.6109412e-16  0              3.3631452    
    500000   127.27922      200            200            0.0020119699   1.6933751e-37  0              0.0060359096   11.611463      0              56067601       2.6109412e-16  0              3.3673977    
    600000   127.27922      200            200            0.005006792    4.8643362e-36  0              0.015020376    3.0914928      0              14927712       2.6109412e-16  0              3.3651471    
    700000   127.27922      200            200            0.0051580477   1.463968e-36   0              0.015474143    0.027059325    0              130659.8       2.6109412e-16  0              3.3650292    
    800000   127.27922      200            200            0.0045688997   3.4397153e-37  0              0.013706699    0.05546686     0              267829.62      2.6109412e-16  0              3.3654147    
    900000   127.27922      200            200            0.0045579925  -1.3024511e-38  0              0.013673977    0.00084398433  0              4075.2983      2.6109412e-16  0              3.3654248    
   1000000   127.27922      200            200            0.0046372855  -1.4989279e-37  0              0.013911857    0.00095647962  0              4618.4978      2.6109412e-16  0              3.3653719    
   1100000   127.27922      200            200            0.0046361828  -1.1533146e-38  0              0.013908548    2.5110518e-05  0              121.24971      2.6109412e-16  0              3.3653723    
   1200000   127.27922      200            200            0.0046254732   2.5893719e-39  0              0.01387642     1.6078651e-05  0              77.638051      2.6109412e-16  0              3.3653794    
   1300000   127.27922      200            200            0.0046259968  -6.7072713e-39  0              0.013877991    6.6814558e-07  0              3.2262359      2.6109412e-16  0              3.3653791    
   1400000   127.27922      200            200            0.0046274276  -1.7957471e-41  0              0.013882283    2.6442606e-07  0              1.2768188      2.6109412e-16  0              3.3653781    
   1500000   127.27922      200            200            0.0046273071  -1.0831967e-39  0              0.013881921    1.651237e-08   0              0.079732325    2.6109412e-16  0              3.3653782    
   1600000   127.27922      200            200            0.0046271176   9.2992191e-39  0              0.013881353    4.240293e-09   0              0.020474857    2.6109412e-16  0              3.3653783    
   1700000   127.27922      200            200            0.0046271405  -4.2687615e-39  0              0.013881422    3.86271e-10    0              0.0018651644   2.6109412e-16  0              3.3653783    
   1800000   127.27922      200            200            0.0046271654   9.8304297e-40  0              0.013881496    6.6072211e-11  0              0.00031903906  2.6109412e-16  0              3.3653783    
   1900000   127.27922      200            200            0.0046271614  -2.7618319e-39  0              0.013881484    8.6573398e-12  0              4.1803195e-05  2.6109412e-16  0              3.3653783    
   2000000   127.27922      200            200            0.0046271582   1.4343076e-39  0              0.013881475    9.9534404e-13  0              4.8061602e-06  2.6109412e-16  0              3.3653783    
   2100000   127.27922      200            200            0.0046271588  -9.529531e-40   0              0.013881476    1.8740326e-13  0              9.0490328e-07  2.6109412e-16  0              3.3653783    
   2200000   127.27922      200            200            0.0046271592   6.4255057e-39  0              0.013881478    1.4384018e-14  0              6.9455275e-08  2.6109412e-16  0              3.3653783    
   2300000   127.27922      200            200            0.0046271591   3.6017325e-39  0              0.013881477    3.9382413e-15  0              1.9016358e-08  2.6109412e-16  0              3.3653783    
   2400000   127.27922      200            200            0.0046271591   1.0554749e-38  0              0.013881477    1.975916e-16   0              9.5409913e-10  2.6109412e-16  0              3.3653783    
   2500000   127.27922      200            200            0.0046271591  -4.182996e-39   0              0.013881477    8.2321518e-17  0              3.9750115e-10  2.6109412e-16  0              3.3653783    
   2600000   127.27922      200            200            0.0046271591  -1.8682572e-39  0              0.013881477    2.2056401e-18  0              1.0650247e-11  2.6109412e-16  0              3.3653783    
   2700000   127.27922      200            200            0.0046271591  -6.5198369e-40  0              0.013881477    1.8572867e-18  0              8.968173e-12   2.6109412e-16  0              3.3653783    
   2800000   127.27922      200            200            0.0046271591   2.4994713e-39  0              0.013881477    1.6970422e-20  0              8.1944096e-14  2.6109412e-16  0              3.3653783    
   2900000   127.27922      200            200            0.0046271591   4.5676238e-39  0              0.013881477    2.6379461e-20  0              1.2737698e-13  2.6109412e-16  0              3.3653783    
   3000000   127.27922      200            200            0.0046271591  -2.9128437e-39  0              0.013881477    8.6692434e-21  0              4.1860674e-14  2.6109412e-16  0              3.3653783    
Loop time of 69.0494 on 4 procs for 3000000 steps with 51 atoms

Performance: 37538330.323 ns/day, 0.000 hours/ns, 43447.142 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28946    | 1.1599     | 3.7267     | 137.6 |  1.68
Neigh   | 0.046106   | 0.048343   | 0.051614   |   1.1 |  0.07
Comm    | 29.796     | 37.454     | 43.695     |  95.0 | 54.24
Output  | 0.078303   | 0.07855    | 0.078778   |   0.1 |  0.11
Modify  | 14.685     | 21.575     | 29.98      | 146.1 | 31.25
Other   |            | 8.733      |            |       | 12.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.75                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.7456392002713
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.85
  ghost atom cutoff = 3.85
  binsize = 1.925, bins = 67 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.57 | 17.04 | 18.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.20713165    -0.0090909605   0              0.63048591     7185.5443      0              3.4696422e+10  2.6109412e-16  0              3.34694      
    200000   127.27922      200            200           -0.00040805988  3.8754752e-38  0             -0.0012241796   1139.4001      0              5.5017554e+09  2.6109412e-16  0              3.4876155    
    300000   127.27922      200            200           -0.0001790575   3.8890202e-37  0             -0.00053717251  152.31011      0              7.3545101e+08  2.6109412e-16  0              3.4054278    
    400000   127.27922      200            200            0.0063533811  -2.2005511e-36  0              0.019060143    163.14734      0              7.8778012e+08  2.6109412e-16  0              3.3691886    
    500000   127.27922      200            200            0.0024607269   1.5060877e-37  0              0.0073821808   15.701181      0              75815381       2.6109412e-16  0              3.3720253    
    600000   127.27922      200            200            0.00531141     1.0380269e-35  0              0.01593423     2.6346903      0              12721977       2.6109412e-16  0              3.3699565    
    700000   127.27922      200            200            0.0051180612  -3.8885855e-37  0              0.015354184    0.095093604    0              459172.98      2.6109412e-16  0              3.3700603    
    800000   127.27922      200            200            0.0045306852  -4.2348976e-37  0              0.013592055    0.044451376    0              214639.79      2.6109412e-16  0              3.3704469    
    900000   127.27922      200            200            0.0045737835   1.7787099e-37  0              0.01372135     0.0025688316   0              12403.968      2.6109412e-16  0              3.3704209    
   1000000   127.27922      200            200            0.004650908   -3.5574275e-38  0              0.013952724    0.00068246447  0              3295.3767      2.6109412e-16  0              3.3703692    
   1100000   127.27922      200            200            0.0046413607  -1.1931741e-38  0              0.013924082    6.6641742e-05  0              321.78912      2.6109412e-16  0              3.3703752    
   1200000   127.27922      200            200            0.0046313891  -2.7352207e-38  0              0.013894167    9.7878977e-06  0              47.262255      2.6109412e-16  0              3.3703819    
   1300000   127.27922      200            200            0.0046331765  -4.2873597e-39  0              0.01389953     1.5870306e-06  0              7.6632027      2.6109412e-16  0              3.3703807    
   1400000   127.27922      200            200            0.0046344372   1.232987e-39   0              0.013903312    1.3023165e-07  0              0.62884203     2.6109412e-16  0              3.3703799    
   1500000   127.27922      200            200            0.0046341327  -3.4944611e-39  0              0.013902398    3.5491659e-08  0              0.17137652     2.6109412e-16  0              3.3703801    
   1600000   127.27922      200            200            0.0046339772   1.1623781e-38  0              0.013901932    1.5590425e-09  0              0.0075280581   2.6109412e-16  0              3.3703802    
   1700000   127.27922      200            200            0.0046340262   3.8108645e-40  0              0.013902078    7.5370251e-10  0              0.0036393597   2.6109412e-16  0              3.3703802    
   1800000   127.27922      200            200            0.0046340448   1.307692e-39   0              0.013902134    1.5846248e-11  0              7.6515863e-05  2.6109412e-16  0              3.3703801    
   1900000   127.27922      200            200            0.0046340372  -3.1401033e-39  0              0.013902112    1.5309476e-11  0              7.3923981e-05  2.6109412e-16  0              3.3703801    
   2000000   127.27922      200            200            0.0046340351   2.1599452e-39  0              0.013902105    1.1867651e-13  0              5.7304639e-07  2.6109412e-16  0              3.3703801    
   2100000   127.27922      200            200            0.0046340362  -3.4042706e-40  0              0.013902109    2.9870532e-13  0              1.4423411e-06  2.6109412e-16  0              3.3703801    
   2200000   127.27922      200            200            0.0046340364   1.4704542e-39  0              0.013902109    3.8187385e-16  0              1.8439322e-09  2.6109412e-16  0              3.3703801    
   2300000   127.27922      200            200            0.0046340363  -4.5079497e-39  0              0.013902109    5.6129427e-15  0              2.7102891e-08  2.6109412e-16  0              3.3703801    
   2400000   127.27922      200            200            0.0046340363   1.702878e-39   0              0.013902109    1.1900549e-18  0              5.7463494e-12  2.6109412e-16  0              3.3703801    
   2500000   127.27922      200            200            0.0046340363   1.3453851e-39  0              0.013902109    1.0149459e-16  0              4.9008104e-10  2.6109412e-16  0              3.3703801    
   2600000   127.27922      200            200            0.0046340363  -3.153479e-39   0              0.013902109    6.4632247e-19  0              3.1208599e-12  2.6109412e-16  0              3.3703801    
   2700000   127.27922      200            200            0.0046340363  -2.8751308e-40  0              0.013902109    1.230485e-18   0              5.9415718e-12  2.6109412e-16  0              3.3703801    
   2800000   127.27922      200            200            0.0046340363  -1.5500319e-39  0              0.013902109    1.7956027e-19  0              8.6703226e-13  2.6109412e-16  0              3.3703801    
   2900000   127.27922      200            200            0.0046340363   1.1223898e-38  0              0.013902109    8.8811645e-20  0              4.2883965e-13  2.6109412e-16  0              3.3703801    
   3000000   127.27922      200            200            0.0046340363   1.1208859e-39  0              0.013902109    2.4943076e-21  0              1.2044119e-14  2.6109412e-16  0              3.3703801    
Loop time of 68.4781 on 4 procs for 3000000 steps with 51 atoms

Performance: 37851515.584 ns/day, 0.000 hours/ns, 43809.625 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28938    | 1.1619     | 3.7258     | 137.3 |  1.70
Neigh   | 0.045236   | 0.046924   | 0.049533   |   0.8 |  0.07
Comm    | 29.563     | 37.105     | 43.263     |  94.0 | 54.19
Output  | 0.077759   | 0.077996   | 0.078225   |   0.1 |  0.11
Modify  | 14.648     | 21.416     | 29.703     | 144.7 | 31.27
Other   |            | 8.67       |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.76                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.2329013727605
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.86
  ghost atom cutoff = 3.86
  binsize = 1.93, bins = 66 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.56 | 17.03 | 18.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.15263594     0.0099512694   0              0.44795655     10535.086      0              5.087016e+10   2.6109412e-16  0              3.3562112    
    200000   127.27922      200            200           -0.00040329189  7.263676e-39   0             -0.0012098757   1088.8935      0              5.2578771e+09  2.6109412e-16  0              3.4947032    
    300000   127.27922      200            200           -0.00016878125 -1.5161855e-37  0             -0.00050634375  132.84156      0              6.4144433e+08  2.6109412e-16  0              3.4113148    
    400000   127.27922      200            200            0.004640722   -3.7687474e-37  0              0.013922166    167.19113      0              8.0730611e+08  2.6109412e-16  0              3.3752603    
    500000   127.27922      200            200            0.003003701   -1.1382e-36     0              0.0090111031   19.403488      0              93692499       2.6109412e-16  0              3.3766016    
    600000   127.27922      200            200            0.0055908011   3.4709178e-36  0              0.016772403    2.0005755      0              9660063.3      2.6109412e-16  0              3.3747852    
    700000   127.27922      200            200            0.0050520347   2.5633742e-37  0              0.015156104    0.18946201     0              914844.23      2.6109412e-16  0              3.3751084    
    800000   127.27922      200            200            0.0044989194   1.451711e-36   0              0.013496758    0.030022882    0              144969.75      2.6109412e-16  0              3.3754749    
    900000   127.27922      200            200            0.0045939254   1.3621454e-37  0              0.013781776    0.0047076287   0              22731.454      2.6109412e-16  0              3.3754139    
   1000000   127.27922      200            200            0.0046631257   7.8950265e-40  0              0.013989377    0.00036700205  0              1772.1215      2.6109412e-16  0              3.3753674    
   1100000   127.27922      200            200            0.0046458399  -3.5793802e-38  0              0.01393752     0.00011083542  0              535.18458      2.6109412e-16  0              3.3753786    
   1200000   127.27922      200            200            0.0046375912   1.6452271e-38  0              0.013912774    3.6595669e-06  0              17.670739      2.6109412e-16  0              3.3753842    
   1300000   127.27922      200            200            0.0046404605  -5.6089217e-39  0              0.013921382    2.3953858e-06  0              11.566461      2.6109412e-16  0              3.3753823    
   1400000   127.27922      200            200            0.0046413922   4.5170137e-40  0              0.013924177    2.534972e-08   0              0.12240473     2.6109412e-16  0              3.3753816    
   1500000   127.27922      200            200            0.0046409439  -3.2212489e-39  0              0.013922832    4.826747e-08   0              0.23306634     2.6109412e-16  0              3.3753819    
   1600000   127.27922      200            200            0.0046408467  -4.1637385e-39  0              0.01392254     5.4694111e-11  0              0.00026409829  2.6109412e-16  0              3.375382     
   1700000   127.27922      200            200            0.0046409136  -2.8371633e-40  0              0.013922741    9.12454e-10    0              0.0044059138   2.6109412e-16  0              3.375382     
   1800000   127.27922      200            200            0.0046409224   5.4841859e-39  0              0.013922767    8.9255281e-13  0              4.3098181e-06  2.6109412e-16  0              3.375382     
   1900000   127.27922      200            200            0.0046409128   1.0314835e-39  0              0.013922738    1.6216228e-11  0              7.8302363e-05  2.6109412e-16  0              3.375382     
   2000000   127.27922      200            200            0.0046409122  -2.7541853e-39  0              0.013922737    1.4992652e-13  0              7.2394153e-07  2.6109412e-16  0              3.375382     
   2100000   127.27922      200            200            0.0046409136  -4.1896465e-40  0              0.013922741    2.7037387e-13  0              1.3055387e-06  2.6109412e-16  0              3.375382     
   2200000   127.27922      200            200            0.0046409136  -4.3064947e-40  0              0.013922741    7.3864786e-15  0              3.5666662e-08  2.6109412e-16  0              3.375382     
   2300000   127.27922      200            200            0.0046409134   5.6886757e-39  0              0.01392274     4.1962133e-15  0              2.0262012e-08  2.6109412e-16  0              3.375382     
   2400000   127.27922      200            200            0.0046409134   2.8124267e-39  0              0.01392274     2.5137103e-16  0              1.2137808e-09  2.6109412e-16  0              3.375382     
   2500000   127.27922      200            200            0.0046409134  -4.2117395e-39  0              0.01392274     5.9212212e-17  0              2.8591458e-10  2.6109412e-16  0              3.375382     
   2600000   127.27922      200            200            0.0046409134  -3.8780241e-39  0              0.01392274     7.7307154e-18  0              3.7328858e-11  2.6109412e-16  0              3.375382     
   2700000   127.27922      200            200            0.0046409134  -1.0223484e-39  0              0.01392274     1.6306842e-19  0              7.8739906e-13  2.6109412e-16  0              3.375382     
   2800000   127.27922      200            200            0.0046409134  -4.1117789e-39  0              0.01392274     2.5231513e-19  0              1.2183394e-12  2.6109412e-16  0              3.375382     
   2900000   127.27922      200            200            0.0046409134   3.8080333e-39  0              0.01392274     1.0228001e-19  0              4.9387358e-13  2.6109412e-16  0              3.375382     
   3000000   127.27922      200            200            0.0046409134   3.3762052e-39  0              0.01392274     4.0852616e-20  0              1.9726266e-13  2.6109412e-16  0              3.375382     
Loop time of 69.0662 on 4 procs for 3000000 steps with 51 atoms

Performance: 37529236.052 ns/day, 0.000 hours/ns, 43436.616 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27703    | 1.1631     | 3.7612     | 139.1 |  1.68
Neigh   | 0.045911   | 0.0477     | 0.050396   |   0.8 |  0.07
Comm    | 30.098     | 37.526     | 43.695     |  92.9 | 54.33
Output  | 0.074773   | 0.074992   | 0.075202   |   0.1 |  0.11
Modify  | 14.722     | 21.55      | 29.809     | 144.9 | 31.20
Other   |            | 8.704      |            |       | 12.60

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.77                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.7227622706926
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.87
  ghost atom cutoff = 3.87
  binsize = 1.935, bins = 66 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.56 | 17.03 | 18.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.096812416    0.023809772    0              0.26662748     13026.2        0              6.2898858e+10  2.6109412e-16  0              3.3661475    
    200000   127.27922      200            200           -0.00039832181 -3.8706368e-38  0             -0.0011949654   1039.5766      0              5.0197435e+09  2.6109412e-16  0              3.5017448    
    300000   127.27922      200            200           -0.00015829569  7.9217242e-38  0             -0.00047488708  114.72528      0              5.5396733e+08  2.6109412e-16  0              3.4171421    
    400000   127.27922      200            200            0.003107672    1.4336115e-36  0              0.0093230161   163.32252      0              7.8862599e+08  2.6109412e-16  0              3.3813336    
    500000   127.27922      200            200            0.0036343461   2.6543678e-36  0              0.010903038    22.221212      0              1.0729828e+08  2.6109412e-16  0              3.381139     
    600000   127.27922      200            200            0.0058303841   9.0651633e-37  0              0.017491152    1.3005184      0              6279738        2.6109412e-16  0              3.3796412    
    700000   127.27922      200            200            0.0049641833  -1.6095762e-36  0              0.01489255     0.28992238     0              1399931.4      2.6109412e-16  0              3.3801708    
    800000   127.27922      200            200            0.0044759259   2.1834137e-37  0              0.013427778    0.015671778    0              75673.407      2.6109412e-16  0              3.380497     
    900000   127.27922      200            200            0.0046174753   1.9828555e-38  0              0.013852426    0.0066510778   0              32115.675      2.6109412e-16  0              3.3804048    
   1000000   127.27922      200            200            0.004673491    1.5581636e-37  0              0.014020473    0.0001126785   0              544.08417      2.6109412e-16  0              3.3803669    
   1100000   127.27922      200            200            0.0046498502   3.2338587e-38  0              0.013949551    0.00014120165  0              681.81223      2.6109412e-16  0              3.3803823    
   1200000   127.27922      200            200            0.0046441518   3.5536245e-38  0              0.013932455    2.4576093e-07  0              1.1866916      2.6109412e-16  0              3.3803862    
   1300000   127.27922      200            200            0.0046477994   6.2105833e-39  0              0.013943398    2.7131624e-06  0              13.10089       2.6109412e-16  0              3.3803838    
   1400000   127.27922      200            200            0.0046482823   6.1046442e-40  0              0.013944847    3.9935368e-09  0              0.01928336     2.6109412e-16  0              3.3803835    
   1500000   127.27922      200            200            0.0046477505  -2.1238323e-39  0              0.013943251    4.7481691e-08  0              0.22927209     2.6109412e-16  0              3.3803838    
   1600000   127.27922      200            200            0.0046477272  -2.5121876e-39  0              0.013943182    6.6498527e-10  0              0.0032109759   2.6109412e-16  0              3.3803838    
   1700000   127.27922      200            200            0.004647801   -4.618267e-40   0              0.013943403    7.5338593e-10  0              0.003637831    2.6109412e-16  0              3.3803838    
   1800000   127.27922      200            200            0.0046477983   3.484608e-39   0              0.013943395    3.20429e-11    0              0.0001547237   2.6109412e-16  0              3.3803838    
   1900000   127.27922      200            200            0.0046477885  -9.8109265e-40  0              0.013943366    1.0671051e-11  0              5.1526686e-05  2.6109412e-16  0              3.3803838    
   2000000   127.27922      200            200            0.0046477897   5.981698e-41   0              0.013943369    1.0494061e-12  0              5.0672066e-06  2.6109412e-16  0              3.3803838    
   2100000   127.27922      200            200            0.0046477909  -3.6731859e-39  0              0.013943373    1.3038175e-13  0              6.2956683e-07  2.6109412e-16  0              3.3803838    
   2200000   127.27922      200            200            0.0046477907  -6.9837883e-41  0              0.013943372    2.7945429e-14  0              1.3493848e-07  2.6109412e-16  0              3.3803838    
   2300000   127.27922      200            200            0.0046477905   3.005306e-39   0              0.013943372    1.2652136e-15  0              6.1092635e-09  2.6109412e-16  0              3.3803838    
   2400000   127.27922      200            200            0.0046477906   1.1004581e-38  0              0.013943372    6.460357e-16   0              3.1194752e-09  2.6109412e-16  0              3.3803838    
   2500000   127.27922      200            200            0.0046477906   6.380913e-39   0              0.013943372    8.0868716e-18  0              3.9048609e-11  2.6109412e-16  0              3.3803838    
   2600000   127.27922      200            200            0.0046477906  -1.0859983e-38  0              0.013943372    1.359308e-17   0              6.5636121e-11  2.6109412e-16  0              3.3803838    
   2700000   127.27922      200            200            0.0046477906  -8.6331927e-39  0              0.013943372    1.5164906e-19  0              7.3225905e-13  2.6109412e-16  0              3.3803838    
   2800000   127.27922      200            200            0.0046477906  -2.479839e-40   0              0.013943372    1.1114715e-19  0              5.366898e-13   2.6109412e-16  0              3.3803838    
   2900000   127.27922      200            200            0.0046477906   2.1973251e-39  0              0.013943372    3.2016046e-20  0              1.5459403e-13  2.6109412e-16  0              3.3803838    
   3000000   127.27922      200            200            0.0046477906   5.3679591e-39  0              0.013943372    1.4771736e-19  0              7.1327425e-13  2.6109412e-16  0              3.3803838    
Loop time of 69.0083 on 4 procs for 3000000 steps with 51 atoms

Performance: 37560672.247 ns/day, 0.000 hours/ns, 43473.000 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28436    | 1.1928     | 3.8653     | 141.3 |  1.73
Neigh   | 0.043288   | 0.045021   | 0.047798   |   0.9 |  0.07
Comm    | 29.834     | 37.386     | 43.609     |  93.9 | 54.18
Output  | 0.076202   | 0.076409   | 0.076598   |   0.1 |  0.11
Modify  | 14.75      | 21.586     | 29.918     | 145.2 | 31.28
Other   |            | 8.722      |            |       | 12.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.78                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.2152288055716
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.88
  ghost atom cutoff = 3.88
  binsize = 1.94, bins = 66 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.56 | 17.03 | 18.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.047522362    0.022927274    0              0.11963981     14364.212      0              6.9359639e+10  2.6109412e-16  0              3.3764712    
    200000   127.27922      200            200           -0.00039315085  1.9385324e-38  0             -0.0011794526   991.44807      0              4.7873479e+09  2.6109412e-16  0              3.5087401    
    300000   127.27922      200            200           -0.00014760213  3.1264998e-37  0             -0.0004428064   97.956218      0              4.7299552e+08  2.6109412e-16  0              3.4229097    
    400000   127.27922      200            200            0.0018094164  -4.7779516e-36  0              0.0054282492   152.79422      0              7.377886e+08   2.6109412e-16  0              3.3873844    
    500000   127.27922      200            200            0.0043389958   1.2494975e-36  0              0.013016987    23.724335      0              1.1455632e+08  2.6109412e-16  0              3.3856519    
    600000   127.27922      200            200            0.0060170411   1.0841123e-35  0              0.018051123    0.66113972     0              3192407.1      2.6109412e-16  0              3.3845313    
    700000   127.27922      200            200            0.0048599193   7.4588114e-37  0              0.014579758    0.37518027     0              1811611.3      2.6109412e-16  0              3.3852444    
    800000   127.27922      200            200            0.0044634865  -7.1308137e-37  0              0.013390459    0.0048396693   0              23369.031      2.6109412e-16  0              3.3855122    
    900000   127.27922      200            200            0.0046432427   5.1618023e-38  0              0.013929728    0.0078475494   0              37893.007      2.6109412e-16  0              3.3853941    
   1000000   127.27922      200            200            0.0046817118  -1.5412118e-37  0              0.014045136    1.4750447e-06  0              7.1224631      2.6109412e-16  0              3.3853677    
   1100000   127.27922      200            200            0.004653665    1.3741874e-40  0              0.013960995    0.00014651404  0              707.46387      2.6109412e-16  0              3.3853861    
   1200000   127.27922      200            200            0.0046511043   1.6467024e-39  0              0.013953313    9.4053536e-07  0              4.5415086      2.6109412e-16  0              3.385388     
   1300000   127.27922      200            200            0.0046551369   1.1530221e-39  0              0.013965411    2.3937685e-06  0              11.558651      2.6109412e-16  0              3.3853853    
   1400000   127.27922      200            200            0.004655106    2.8228326e-40  0              0.013965318    7.6297719e-08  0              0.36841438     2.6109412e-16  0              3.3853853    
   1500000   127.27922      200            200            0.0046545631   6.3466684e-39  0              0.013963689    3.3667343e-08  0              0.16256755     2.6109412e-16  0              3.3853857    
   1600000   127.27922      200            200            0.0046546182  -1.2537862e-40  0              0.013963855    2.9780575e-09  0              0.014379974    2.6109412e-16  0              3.3853856    
   1700000   127.27922      200            200            0.0046546865   3.131306e-39   0              0.013964059    3.887573e-10   0              0.0018771699   2.6109412e-16  0              3.3853856    
   1800000   127.27922      200            200            0.0046546726   4.0516965e-39  0              0.013964018    8.5236999e-11  0              0.00041157896  2.6109412e-16  0              3.3853856    
   1900000   127.27922      200            200            0.0046546647  -7.0764365e-39  0              0.013963994    3.2511015e-12  0              1.5698406e-05  2.6109412e-16  0              3.3853856    
   2000000   127.27922      200            200            0.0046546673  -1.0277283e-38  0              0.013964002    2.0117115e-12  0              9.7138349e-06  2.6109412e-16  0              3.3853856    
   2100000   127.27922      200            200            0.0046546681  -7.9622309e-39  0              0.013964004    1.2343645e-14  0              5.9603043e-08  2.6109412e-16  0              3.3853856    
   2200000   127.27922      200            200            0.0046546677  -5.5745039e-39  0              0.013964003    4.0946856e-14  0              1.9771771e-07  2.6109412e-16  0              3.3853856    
   2300000   127.27922      200            200            0.0046546676   1.731793e-39   0              0.013964003    1.486619e-17   0              7.1783513e-11  2.6109412e-16  0              3.3853856    
   2400000   127.27922      200            200            0.0046546677  -5.645067e-40   0              0.013964003    7.309005e-16   0              3.5292569e-09  2.6109412e-16  0              3.3853856    
   2500000   127.27922      200            200            0.0046546677   2.6735826e-39  0              0.013964003    8.5469802e-18  0              4.1270309e-11  2.6109412e-16  0              3.3853856    
   2600000   127.27922      200            200            0.0046546677  -6.1008764e-39  0              0.013964003    1.092729e-17   0              5.2763974e-11  2.6109412e-16  0              3.3853856    
   2700000   127.27922      200            200            0.0046546677  -5.0924533e-39  0              0.013964003    1.1305816e-18  0              5.4591741e-12  2.6109412e-16  0              3.3853856    
   2800000   127.27922      200            200            0.0046546677  -9.5258822e-40  0              0.013964003    3.2548808e-21  0              1.5716654e-14  2.6109412e-16  0              3.3853856    
   2900000   127.27922      200            200            0.0046546677  -3.3230139e-40  0              0.013964003    4.0666665e-22  0              1.9636477e-15  2.6109412e-16  0              3.3853856    
   3000000   127.27922      200            200            0.0046546677   4.0388363e-39  0              0.013964003    6.0416168e-20  0              2.9172805e-13  2.6109412e-16  0              3.3853856    
Loop time of 68.8836 on 4 procs for 3000000 steps with 51 atoms

Performance: 37628672.475 ns/day, 0.000 hours/ns, 43551.704 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29216    | 1.1781     | 3.8013     | 139.5 |  1.71
Neigh   | 0.04514    | 0.046935   | 0.0497     |   0.9 |  0.07
Comm    | 29.75      | 37.314     | 43.515     |  93.8 | 54.17
Output  | 0.073321   | 0.073513   | 0.073703   |   0.1 |  0.11
Modify  | 14.74      | 21.557     | 29.87      | 144.9 | 31.29
Other   |            | 8.714      |            |       | 12.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.79                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.7103078889014
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.89
  ghost atom cutoff = 3.89
  binsize = 1.945, bins = 66 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.53 | 17 | 18.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.012839139    0.0020609956   0              0.036456423    14803.344      0              7.1480051e+10  2.6109412e-16  0              3.3869603    
    200000   127.27922      200            200           -0.00038777948  6.7807266e-38  0             -0.0011633384   944.50084      0              4.5606565e+09  2.6109412e-16  0              3.5156892    
    300000   127.27922      200            200           -0.0001367014  -3.083913e-37   0             -0.00041010421  82.528749      0              3.9850179e+08  2.6109412e-16  0              3.4286174    
    400000   127.27922      200            200            0.00078976813  3.8777267e-36  0              0.0023693044   137.41842      0              6.6354436e+08  2.6109412e-16  0              3.3933922    
    500000   127.27922      200            200            0.0050963495   1.254784e-36   0              0.015289048    23.626479      0              1.1408381e+08  2.6109412e-16  0              3.3901567    
    600000   127.27922      200            200            0.0061401739  -6.5529916e-36  0              0.018420522    0.20030021     0              967178.03      2.6109412e-16  0              3.3894607    
    700000   127.27922      200            200            0.0047454702  -9.3798036e-38  0              0.014236411    0.42743549     0              2063933        2.6109412e-16  0              3.3903253    
    800000   127.27922      200            200            0.0044627515   3.7180163e-37  0              0.013388254    9.6766189e-05  0              467.2493       2.6109412e-16  0              3.3905195    
    900000   127.27922      200            200            0.0046698714  -5.7765235e-38  0              0.014009614    0.0079586006   0              38429.234      2.6109412e-16  0              3.3903828    
   1000000   127.27922      200            200            0.0046876762   1.5648665e-37  0              0.014063029    6.8197741e-05  0              329.30249      2.6109412e-16  0              3.3903701    
   1100000   127.27922      200            200            0.0046575757   1.2035179e-38  0              0.013972727    0.0001249113   0              603.15196      2.6109412e-16  0              3.3903899    
   1200000   127.27922      200            200            0.0046584401   2.7581026e-38  0              0.01397532     5.4106927e-06  0              26.126299      2.6109412e-16  0              3.3903895    
   1300000   127.27922      200            200            0.0046624177   7.5684645e-40  0              0.013987253    1.5898361e-06  0              7.6767494      2.6109412e-16  0              3.3903868    
   1400000   127.27922      200            200            0.0046618705  -1.0110589e-39  0              0.013985612    2.0361425e-07  0              0.98318034     2.6109412e-16  0              3.3903872    
   1500000   127.27922      200            200            0.0046613915   5.8945086e-39  0              0.013984174    1.4834664e-08  0              0.071631283    2.6109412e-16  0              3.3903875    
   1600000   127.27922      200            200            0.0046615173  -1.8521895e-39  0              0.013984552    5.5118934e-09  0              0.026614961    2.6109412e-16  0              3.3903874    
   1700000   127.27922      200            200            0.0046615685  -1.0442718e-39  0              0.013984706    7.138035e-11   0              0.00034467016  2.6109412e-16  0              3.3903874    
   1800000   127.27922      200            200            0.004661546   -1.5611235e-40  0              0.013984638    1.2014309e-10  0              0.00058012801  2.6109412e-16  0              3.3903874    
   1900000   127.27922      200            200            0.0046615415   1.9912712e-39  0              0.013984624    1.8249916e-15  0              8.8122313e-09  2.6109412e-16  0              3.3903874    
   2000000   127.27922      200            200            0.004661545   -4.116439e-41   0              0.013984635    2.1863951e-12  0              1.0557319e-05  2.6109412e-16  0              3.3903874    
   2100000   127.27922      200            200            0.0046615452  -3.2177193e-39  0              0.013984636    2.7474976e-14  0              1.3266683e-07  2.6109412e-16  0              3.3903874    
   2200000   127.27922      200            200            0.0046615447   3.9646272e-39  0              0.013984634    3.3178943e-14  0              1.6020924e-07  2.6109412e-16  0              3.3903874    
   2300000   127.27922      200            200            0.0046615448   2.7465224e-39  0              0.013984634    1.7778686e-15  0              8.5846911e-09  2.6109412e-16  0              3.3903874    
   2400000   127.27922      200            200            0.0046615448   1.0080293e-38  0              0.013984635    4.0292461e-16  0              1.9455787e-09  2.6109412e-16  0              3.3903874    
   2500000   127.27922      200            200            0.0046615448   2.9711807e-39  0              0.013984634    6.0697826e-17  0              2.9308808e-10  2.6109412e-16  0              3.3903874    
   2600000   127.27922      200            200            0.0046615448   7.929311e-40   0              0.013984634    3.2258985e-18  0              1.5576709e-11  2.6109412e-16  0              3.3903874    
   2700000   127.27922      200            200            0.0046615448  -1.2907779e-39  0              0.013984634    1.8497328e-18  0              8.9316978e-12  2.6109412e-16  0              3.3903874    
   2800000   127.27922      200            200            0.0046615448   3.5777793e-40  0              0.013984634    4.4966791e-20  0              2.1712854e-13  2.6109412e-16  0              3.3903874    
   2900000   127.27922      200            200            0.0046615448  -9.1272306e-40  0              0.013984634    1.8983571e-21  0              9.1664869e-15  2.6109412e-16  0              3.3903874    
   3000000   127.27922      200            200            0.0046615448   6.4046605e-39  0              0.013984634    1.0297931e-19  0              4.9725022e-13  2.6109412e-16  0              3.3903874    
Loop time of 69.1307 on 4 procs for 3000000 steps with 51 atoms

Performance: 37494194.187 ns/day, 0.000 hours/ns, 43396.058 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28987    | 1.1723     | 3.7633     | 138.2 |  1.70
Neigh   | 0.043365   | 0.044901   | 0.047368   |   0.8 |  0.06
Comm    | 29.895     | 37.46      | 43.593     |  94.2 | 54.19
Output  | 0.080317   | 0.080571   | 0.080815   |   0.1 |  0.12
Modify  | 14.853     | 21.628     | 29.987     | 145.4 | 31.29
Other   |            | 8.744      |            |       | 12.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.8                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.2080064321856
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.9
  ghost atom cutoff = 3.9
  binsize = 1.95, bins = 66 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.53 | 17 | 18.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0018631449   6.8176315e-36  0              0.0055894347   14775.39       0              7.1345073e+10  2.6109412e-16  0              3.397484     
    200000   127.27922      200            200           -0.00038220916 -7.7457972e-38  0             -0.0011466275   898.73561      0              4.3396726e+09  2.6109412e-16  0              3.5225919    
    300000   127.27922      200            200           -0.00012559567  6.2204636e-37  0             -0.00037678701  68.439145      0              3.3046814e+08  2.6109412e-16  0              3.4342652    
    400000   127.27922      200            200            9.2385781e-05  8.9107649e-38  0              0.00027715734  119.26778      0              5.7590144e+08  2.6109412e-16  0              3.399341     
    500000   127.27922      200            200            0.0058777554  -3.7821991e-36  0              0.017633266    21.853845      0              1.055244e+08   2.6109412e-16  0              3.3946707    
    600000   127.27922      200            200            0.0061926208  -7.8137923e-36  0              0.018577862    0.0037227559   0              17975.856      2.6109412e-16  0              3.3944331    
    700000   127.27922      200            200            0.0046274613   4.8975149e-38  0              0.013882384    0.43605998     0              2105577.6      2.6109412e-16  0              3.3954092    
    800000   127.27922      200            200            0.0044741841   6.2708435e-38  0              0.013422552    0.0025350869   0              12241.027      2.6109412e-16  0              3.3955186    
    900000   127.27922      200            200            0.0046959366   1.5657862e-38  0              0.01408781     0.0069540629   0              33578.681      2.6109412e-16  0              3.3953719    
   1000000   127.27922      200            200            0.0046914607  -9.4598986e-38  0              0.014074382    0.00028950049  0              1397.8943      2.6109412e-16  0              3.3953738    
   1100000   127.27922      200            200            0.0046618635   3.4417333e-38  0              0.013985591    8.4492281e-05  0              407.98299      2.6109412e-16  0              3.3953934    
   1200000   127.27922      200            200            0.0046661093  -1.3839554e-38  0              0.013998328    1.1752886e-05  0              56.750482      2.6109412e-16  0              3.3953907    
   1300000   127.27922      200            200            0.004669593   -3.1256495e-39  0              0.014008779    6.7854871e-07  0              3.2764689      2.6109412e-16  0              3.3953884    
   1400000   127.27922      200            200            0.0046685913   2.6629804e-39  0              0.014005774    3.1917177e-07  0              1.5411662      2.6109412e-16  0              3.3953891    
   1500000   127.27922      200            200            0.0046682427   5.8891928e-39  0              0.014004728    1.7805618e-09  0              0.0085976955   2.6109412e-16  0              3.3953893    
   1600000   127.27922      200            200            0.004668421   -2.4858314e-39  0              0.014005263    6.6627172e-09  0              0.032171877    2.6109412e-16  0              3.3953892    
   1700000   127.27922      200            200            0.0046684463  -1.6708884e-39  0              0.014005339    1.8476003e-11  0              8.9214006e-05  2.6109412e-16  0              3.3953892    
   1800000   127.27922      200            200            0.0046684191  -1.3883519e-39  0              0.014005257    1.1064706e-10  0              0.00053427504  2.6109412e-16  0              3.3953892    
   1900000   127.27922      200            200            0.004668419    1.9649186e-39  0              0.014005257    3.5020383e-12  0              1.691009e-05   2.6109412e-16  0              3.3953892    
   2000000   127.27922      200            200            0.0046684227   4.1660119e-39  0              0.014005268    1.425764e-12   0              6.884504e-06   2.6109412e-16  0              3.3953892    
   2100000   127.27922      200            200            0.0046684222  -2.6453175e-39  0              0.014005267    1.5973768e-13  0              7.7131609e-07  2.6109412e-16  0              3.3953892    
   2200000   127.27922      200            200            0.0046684218  -9.1418574e-40  0              0.014005265    1.2677929e-14  0              6.1217181e-08  2.6109412e-16  0              3.3953892    
   2300000   127.27922      200            200            0.0046684219  -9.2600475e-40  0              0.014005266    4.6023641e-15  0              2.2223169e-08  2.6109412e-16  0              3.3953892    
   2400000   127.27922      200            200            0.0046684219   6.4031994e-39  0              0.014005266    4.7309255e-17  0              2.2843946e-10  2.6109412e-16  0              3.3953892    
   2500000   127.27922      200            200            0.0046684219   2.3153993e-39  0              0.014005266    1.0058823e-16  0              4.8570458e-10  2.6109412e-16  0              3.3953892    
   2600000   127.27922      200            200            0.0046684219   8.0000856e-39  0              0.014005266    1.4096227e-19  0              6.8065634e-13  2.6109412e-16  0              3.3953892    
   2700000   127.27922      200            200            0.0046684219  -9.2211144e-39  0              0.014005266    1.2655045e-18  0              6.1106684e-12  2.6109412e-16  0              3.3953892    
   2800000   127.27922      200            200            0.0046684219   2.105131e-39   0              0.014005266    2.1324651e-19  0              1.0296911e-12  2.6109412e-16  0              3.3953892    
   2900000   127.27922      200            200            0.0046684219  -7.0408446e-39  0              0.014005266    7.3120636e-20  0              3.5307338e-13  2.6109412e-16  0              3.3953892    
   3000000   127.27922      200            200            0.0046684219   8.7424919e-39  0              0.014005266    1.0715989e-21  0              5.1743678e-15  2.6109412e-16  0              3.3953892    
Loop time of 69.1534 on 4 procs for 3000000 steps with 51 atoms

Performance: 37481883.587 ns/day, 0.000 hours/ns, 43381.810 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28048    | 1.2034     | 3.9066     | 142.3 |  1.74
Neigh   | 0.045244   | 0.047173   | 0.050119   |   0.9 |  0.07
Comm    | 29.984     | 37.518     | 43.772     |  93.3 | 54.25
Output  | 0.078295   | 0.078505   | 0.078706   |   0.1 |  0.11
Modify  | 14.719     | 21.559     | 29.885     | 145.4 | 31.18
Other   |            | 8.747      |            |       | 12.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.81                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.7083313469284
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.91
  ghost atom cutoff = 3.91
  binsize = 1.955, bins = 66 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.53 | 17 | 18.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -3.6772622e-05 -8.7139613e-38  0             -0.00011031787  14606.303      0              7.0528608e+10  2.6109412e-16  0              3.4079894    
    200000   127.27922      200            200           -0.00037644058 -1.2586766e-37  0             -0.0011293218   854.14709      0              4.1243706e+09  2.6109412e-16  0              3.5294481    
    300000   127.27922      200            200           -0.0001142858   3.1165092e-37  0             -0.00034285741  55.681912      0              2.6886803e+08  2.6109412e-16  0              3.4398529    
    400000   127.27922      200            200           -0.00014851214  9.5493198e-37  0             -0.00044553643  100.52145      0              4.8538213e+08  2.6109412e-16  0              3.4052195    
    500000   127.27922      200            200            0.0066485636  -5.6920672e-36  0              0.019945691    18.588254      0              89756025       2.6109412e-16  0              3.3992122    
    600000   127.27922      200            200            0.0061712975  -1.5983786e-36  0              0.018513893    0.10750933     0              519124.1       2.6109412e-16  0              3.3994497    
    700000   127.27922      200            200            0.0045125284   1.0356455e-36  0              0.013537585    0.39964787     0              1929756.6      2.6109412e-16  0              3.4004919    
    800000   127.27922      200            200            0.0044975377   5.5995954e-38  0              0.013492613    0.011515599    0              55604.706      2.6109412e-16  0              3.4005098    
    900000   127.27922      200            200            0.0047200438   2.1294332e-38  0              0.014160131    0.0051200273   0              24722.78       2.6109412e-16  0              3.4003623    
   1000000   127.27922      200            200            0.0046933242   4.1841688e-39  0              0.014079973    0.00059189927  0              2858.0698      2.6109412e-16  0              3.4003788    
   1100000   127.27922      200            200            0.0046667735   1.1068738e-38  0              0.014000321    4.0238079e-05  0              194.29528      2.6109412e-16  0              3.4003965    
   1200000   127.27922      200            200            0.0046740267   4.1100769e-39  0              0.01402208     1.7300711e-05  0              83.538941      2.6109412e-16  0              3.4003918    
   1300000   127.27922      200            200            0.0046766271   2.3623271e-39  0              0.014029881    8.3567967e-08  0              0.4035198      2.6109412e-16  0              3.4003901    
   1400000   127.27922      200            200            0.0046752893   2.255307e-39   0              0.014025868    3.6296473e-07  0              1.7526268      2.6109412e-16  0              3.4003909    
   1500000   127.27922      200            200            0.0046751206  -1.8203567e-39  0              0.014025362    1.8810587e-09  0              0.0090829594   2.6109412e-16  0              3.4003911    
   1600000   127.27922      200            200            0.0046753248   1.9051341e-39  0              0.014025974    5.7138164e-09  0              0.027589975    2.6109412e-16  0              3.4003909    
   1700000   127.27922      200            200            0.0046753196  -2.8809316e-40  0              0.014025959    2.6305212e-10  0              0.0012701845   2.6109412e-16  0              3.4003909    
   1800000   127.27922      200            200            0.0046752927   3.030422e-39   0              0.014025878    6.4134724e-11  0              0.00030968363  2.6109412e-16  0              3.400391     
   1900000   127.27922      200            200            0.0046752971  -1.4759974e-39  0              0.014025891    1.0832472e-11  0              5.2306131e-05  2.6109412e-16  0              3.4003909    
   2000000   127.27922      200            200            0.0046753001  -2.895179e-39   0              0.0140259      4.0081195e-13  0              1.9353775e-06  2.6109412e-16  0              3.4003909    
   2100000   127.27922      200            200            0.0046752991  -1.2210454e-39  0              0.014025897    2.8313735e-13  0              1.3671689e-06  2.6109412e-16  0              3.4003909    
   2200000   127.27922      200            200            0.0046752989  -6.8836801e-40  0              0.014025897    1.6308355e-16  0              7.8747208e-10  2.6109412e-16  0              3.4003909    
   2300000   127.27922      200            200            0.004675299   -6.8737497e-40  0              0.014025897    5.4388787e-15  0              2.6262399e-08  2.6109412e-16  0              3.4003909    
   2400000   127.27922      200            200            0.004675299   -2.4565798e-42  0              0.014025897    7.1216225e-17  0              3.4387766e-10  2.6109412e-16  0              3.4003909    
   2500000   127.27922      200            200            0.004675299    7.6616449e-40  0              0.014025897    7.6062899e-17  0              3.6728052e-10  2.6109412e-16  0              3.4003909    
   2600000   127.27922      200            200            0.004675299    7.6764925e-39  0              0.014025897    6.0060838e-18  0              2.9001229e-11  2.6109412e-16  0              3.4003909    
   2700000   127.27922      200            200            0.004675299   -4.0813926e-39  0              0.014025897    2.1635732e-19  0              1.0447121e-12  2.6109412e-16  0              3.4003909    
   2800000   127.27922      200            200            0.004675299   -1.2119572e-39  0              0.014025897    2.3079525e-19  0              1.1144276e-12  2.6109412e-16  0              3.4003909    
   2900000   127.27922      200            200            0.004675299    2.370337e-39   0              0.014025897    5.3319118e-20  0              2.5745894e-13  2.6109412e-16  0              3.4003909    
   3000000   127.27922      200            200            0.004675299   -5.9066489e-40  0              0.014025897    1.0243625e-20  0              4.94628e-14    2.6109412e-16  0              3.4003909    
Loop time of 69.0647 on 4 procs for 3000000 steps with 51 atoms

Performance: 37530037.405 ns/day, 0.000 hours/ns, 43437.543 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29518    | 1.2124     | 3.9218     | 142.1 |  1.76
Neigh   | 0.042626   | 0.044105   | 0.046724   |   0.8 |  0.06
Comm    | 29.885     | 37.457     | 43.697     |  93.7 | 54.23
Output  | 0.076829   | 0.077043   | 0.077249   |   0.1 |  0.11
Modify  | 14.66      | 21.515     | 29.867     | 145.6 | 31.15
Other   |            | 8.759      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.82                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.2112895446332
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.92
  ghost atom cutoff = 3.92
  binsize = 1.96, bins = 65 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.52 | 16.99 | 18.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -5.4023189e-05 -1.9363733e-38  0             -0.00016206957  14429.866      0              6.9676658e+10  2.6109412e-16  0              3.4184651    
    200000   127.27922      200            200           -0.00037047478 -5.8076502e-38  0             -0.0011114243   810.73266      0              3.9147379e+09  2.6109412e-16  0              3.5362578    
    300000   127.27922      200            200           -0.00010277332 -1.5335974e-37  0             -0.00030831996  44.25243       0              2.1367915e+08  2.6109412e-16  0              3.4453804    
    400000   127.27922      200            200           -0.00013641433  2.8185231e-36  0             -0.00040924298  83.150335      0              4.0150321e+08  2.6109412e-16  0              3.4110235    
    500000   127.27922      200            200            0.0073701981  -1.3945732e-36  0              0.022110594    14.268116      0              68895627       2.6109412e-16  0              3.4037991    
    600000   127.27922      200            200            0.0060775301  -3.4630362e-37  0              0.01823259     0.49040983     0              2368013.5      2.6109412e-16  0              3.40451      
    700000   127.27922      200            200            0.0044069583  -5.7451251e-37  0              0.013220875    0.32610569     0              1574647.6      2.6109412e-16  0              3.4055691    
    800000   127.27922      200            200            0.0045318622   1.4440725e-36  0              0.013595587    0.024823085    0              119861.79      2.6109412e-16  0              3.4054936    
    900000   127.27922      200            200            0.0047409321   1.1573235e-37  0              0.014222796    0.0029774157   0              14376.875      2.6109412e-16  0              3.4053548    
   1000000   127.27922      200            200            0.0046936862  -1.3274992e-38  0              0.014081059    0.00087601416  0              4229.9589      2.6109412e-16  0              3.4053849    
   1100000   127.27922      200            200            0.0046724915  -2.7527798e-38  0              0.014017475    8.4309047e-06  0              40.709822      2.6109412e-16  0              3.4053991    
   1200000   127.27922      200            200            0.0046820805  -3.5887195e-40  0              0.014046241    1.9740168e-05  0              95.318209      2.6109412e-16  0              3.4053928    
   1300000   127.27922      200            200            0.0046835014   2.2062488e-39  0              0.014050504    7.7495406e-08  0              0.37419758     2.6109412e-16  0              3.4053918    
   1400000   127.27922      200            200            0.0046819887   2.1641744e-39  0              0.014045966    3.1267876e-07  0              1.5098138      2.6109412e-16  0              3.4053928    
   1500000   127.27922      200            200            0.0046820251   2.2477523e-39  0              0.014046075    1.492569e-08   0              0.072070818    2.6109412e-16  0              3.4053928    
   1600000   127.27922      200            200            0.0046822243  -9.2595371e-41  0              0.014046673    3.2728175e-09  0              0.015803264    2.6109412e-16  0              3.4053927    
   1700000   127.27922      200            200            0.0046821893  -3.4990562e-39  0              0.014046568    6.3392209e-10  0              0.0030609829   2.6109412e-16  0              3.4053927    
   1800000   127.27922      200            200            0.0046821676  -1.4065158e-39  0              0.014046503    1.5499349e-11  0              7.4840809e-05  2.6109412e-16  0              3.4053927    
   1900000   127.27922      200            200            0.0046821756   1.9397537e-39  0              0.014046527    1.6016473e-11  0              7.7337814e-05  2.6109412e-16  0              3.4053927    
   2000000   127.27922      200            200            0.0046821773  -6.7573368e-39  0              0.014046532    5.1940652e-15  0              2.5080282e-08  2.6109412e-16  0              3.4053927    
   2100000   127.27922      200            200            0.004682176   -2.0732784e-39  0              0.014046528    2.8160069e-13  0              1.359749e-06   2.6109412e-16  0              3.4053927    
   2200000   127.27922      200            200            0.004682176   -4.5847503e-39  0              0.014046528    8.0872912e-15  0              3.9050635e-08  2.6109412e-16  0              3.4053927    
   2300000   127.27922      200            200            0.0046821761   8.4462572e-40  0              0.014046528    3.3842975e-15  0              1.6341561e-08  2.6109412e-16  0              3.4053927    
   2400000   127.27922      200            200            0.0046821761   9.0400085e-40  0              0.014046528    4.3983413e-16  0              2.1238016e-09  2.6109412e-16  0              3.4053927    
   2500000   127.27922      200            200            0.0046821761   4.6771824e-39  0              0.014046528    2.09536e-17    0              1.0117744e-10  2.6109412e-16  0              3.4053927    
   2600000   127.27922      200            200            0.0046821761   1.2747775e-39  0              0.014046528    1.2925144e-17  0              6.2410893e-11  2.6109412e-16  0              3.4053927    
   2700000   127.27922      200            200            0.0046821761  -3.2449067e-39  0              0.014046528    1.6905234e-19  0              8.1629325e-13  2.6109412e-16  0              3.4053927    
   2800000   127.27922      200            200            0.0046821761  -1.6126952e-39  0              0.014046528    5.9704375e-20  0              2.8829106e-13  2.6109412e-16  0              3.4053927    
   2900000   127.27922      200            200            0.0046821761  -2.2958232e-39  0              0.014046528    1.1802692e-19  0              5.6990973e-13  2.6109412e-16  0              3.4053927    
   3000000   127.27922      200            200            0.0046821761  -5.8927019e-39  0              0.014046528    9.1187574e-21  0              4.4031216e-14  2.6109412e-16  0              3.4053927    
Loop time of 69.043 on 4 procs for 3000000 steps with 51 atoms

Performance: 37541801.387 ns/day, 0.000 hours/ns, 43451.159 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28255    | 1.1823     | 3.8245     | 140.3 |  1.71
Neigh   | 0.043234   | 0.04442    | 0.046687   |   0.7 |  0.06
Comm    | 29.98      | 37.486     | 43.677     |  93.3 | 54.29
Output  | 0.07733    | 0.077522   | 0.077694   |   0.1 |  0.11
Modify  | 14.731     | 21.518     | 29.787     | 144.8 | 31.17
Other   |            | 8.735      |            |       | 12.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.83                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.7168879368044
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.93
  ghost atom cutoff = 3.93
  binsize = 1.965, bins = 65 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.52 | 16.99 | 18.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -7.1036868e-05  9.6905709e-39  0             -0.00021311061  14254.611      0              6.8830413e+10  2.6109412e-16  0              3.4289106    
    200000   127.27922      200            200           -0.00036431279 -2.4206745e-38  0             -0.0010929384   768.48968      0              3.7107616e+09  2.6109412e-16  0              3.5430208    
    300000   127.27922      200            200           -9.1059834e-05  7.8955206e-38  0             -0.0002731795   34.1461        0              1.648793e+08   2.6109412e-16  0              3.4508477    
    400000   127.27922      200            200           -0.00012406971 -3.068682e-36   0             -0.00037220913  67.451088      0              3.2569717e+08  2.6109412e-16  0              3.4167526    
    500000   127.27922      200            200            0.0080030473   2.237877e-36   0              0.024009142    9.5382154      0              46056629       2.6109412e-16  0              3.4084481    
    600000   127.27922      200            200            0.0059169821  -4.0152955e-36  0              0.017750946    1.0779702      0              5205132.3      2.6109412e-16  0              3.4096111    
    700000   127.27922      200            200            0.0043163802   1.9283364e-36  0              0.012949141    0.2308267      0              1114579.5      2.6109412e-16  0              3.4106369    
    800000   127.27922      200            200            0.0045755461   4.078809e-38   0              0.013726638    0.039197499    0              189270.69      2.6109412e-16  0              3.4104713    
    900000   127.27922      200            200            0.0047575699  -1.9704371e-37  0              0.01427271     0.0011333329   0              5472.4591      2.6109412e-16  0              3.41035      
   1000000   127.27922      200            200            0.004693091   -2.63901e-38    0              0.014079273    0.0010490985   0              5065.7211      2.6109412e-16  0              3.4103915    
   1100000   127.27922      200            200            0.0046791267   4.9692469e-38  0              0.01403738     6.3937315e-07  0              3.0873041      2.6109412e-16  0              3.410401     
   1200000   127.27922      200            200            0.0046901444   1.7678231e-39  0              0.014070433    1.8068166e-05  0              87.244707      2.6109412e-16  0              3.4103938    
   1300000   127.27922      200            200            0.0046902165  -2.9019761e-39  0              0.01407065     6.5677784e-07  0              3.1713451      2.6109412e-16  0              3.4103937    
   1400000   127.27922      200            200            0.0046887133  -6.0128742e-39  0              0.01406614     1.947669e-07   0              0.94045966     2.6109412e-16  0              3.4103947    
   1500000   127.27922      200            200            0.0046889519   2.459455e-39   0              0.014066856    3.3332572e-08  0              0.16095106     2.6109412e-16  0              3.4103946    
   1600000   127.27922      200            200            0.0046891159   1.3193211e-39  0              0.014067348    8.7390192e-10  0              0.0042197596   2.6109412e-16  0              3.4103944    
   1700000   127.27922      200            200            0.0046890565   5.1574776e-39  0              0.01406717     8.7556865e-10  0              0.0042278077   2.6109412e-16  0              3.4103945    
   1800000   127.27922      200            200            0.0046890441   7.2171583e-39  0              0.014067132    7.880647e-13   0              3.8052824e-06  2.6109412e-16  0              3.4103945    
   1900000   127.27922      200            200            0.0046890542   2.4230442e-40  0              0.014067163    1.4880448e-11  0              7.1852356e-05  2.6109412e-16  0              3.4103945    
   2000000   127.27922      200            200            0.0046890542   5.920008e-40   0              0.014067163    5.7375258e-13  0              2.7704459e-06  2.6109412e-16  0              3.4103945    
   2100000   127.27922      200            200            0.0046890529  -6.2590326e-39  0              0.014067159    1.5747905e-13  0              7.6040996e-07  2.6109412e-16  0              3.4103945    
   2200000   127.27922      200            200            0.0046890531  -1.5450079e-39  0              0.014067159    2.8240886e-14  0              1.3636513e-07  2.6109412e-16  0              3.4103945    
   2300000   127.27922      200            200            0.0046890532   8.1803171e-40  0              0.01406716     6.8153793e-16  0              3.2909027e-09  2.6109412e-16  0              3.4103945    
   2400000   127.27922      200            200            0.0046890532  -2.1916379e-39  0              0.01406716     7.3199507e-16  0              3.5345422e-09  2.6109412e-16  0              3.4103945    
   2500000   127.27922      200            200            0.0046890532   2.1411573e-39  0              0.01406716     1.0590236e-18  0              5.113646e-12   2.6109412e-16  0              3.4103945    
   2600000   127.27922      200            200            0.0046890532   4.13738e-39    0              0.01406716     1.1678347e-17  0              5.639056e-11   2.6109412e-16  0              3.4103945    
   2700000   127.27922      200            200            0.0046890532   5.6182973e-39  0              0.01406716     1.1543415e-18  0              5.5739022e-12  2.6109412e-16  0              3.4103945    
   2800000   127.27922      200            200            0.0046890532  -1.2786754e-39  0              0.01406716     2.7669535e-22  0              1.3360628e-15  2.6109412e-16  0              3.4103945    
   2900000   127.27922      200            200            0.0046890532   1.0052303e-39  0              0.01406716     4.1353261e-20  0              1.996801e-13   2.6109412e-16  0              3.4103945    
   3000000   127.27922      200            200            0.0046890532   3.7138385e-40  0              0.01406716     7.8874133e-20  0              3.8085496e-13  2.6109412e-16  0              3.4103945    
Loop time of 68.8913 on 4 procs for 3000000 steps with 51 atoms

Performance: 37624465.448 ns/day, 0.000 hours/ns, 43546.835 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29264    | 1.1778     | 3.7917     | 139.1 |  1.71
Neigh   | 0.04345    | 0.045419   | 0.048348   |   1.0 |  0.07
Comm    | 29.888     | 37.38      | 43.558     |  93.1 | 54.26
Output  | 0.075425   | 0.075624   | 0.075813   |   0.1 |  0.11
Modify  | 14.686     | 21.479     | 29.749     | 144.5 | 31.18
Other   |            | 8.733      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.84                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.2251334349452
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.94
  ghost atom cutoff = 3.94
  binsize = 1.97, bins = 65 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.52 | 16.99 | 18.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -8.7814562e-05  2.4210909e-39  0             -0.00026344369  14080.531      0              6.7989844e+10  2.6109412e-16  0              3.4393261    
    200000   127.27922      200            200           -0.00035795539 -1.1611326e-37  0             -0.0010738662   727.41377      0              3.5124208e+09  2.6109412e-16  0              3.5497372    
    300000   127.27922      200            200           -7.9146303e-05 -2.3093881e-37  0             -0.00023743891  25.357784      0              1.2244367e+08  2.6109412e-16  0              3.4562545    
    400000   127.27922      200            200           -0.00011148003  3.0067208e-38  0             -0.00033444009  53.414903      0              2.5792145e+08  2.6109412e-16  0              3.4224067    
    500000   127.27922      200            200            0.0086003426   6.6632222e-05  0              0.025734396    5.1304247      0              24772985       2.6109412e-16  0              3.4131742    
    600000   127.27922      200            200            0.0056991676   5.9606328e-36  0              0.017097503    1.7577532      0              8487561.2      2.6109412e-16  0              3.4147483    
    700000   127.27922      200            200            0.0042455321  -8.4759929e-37  0              0.012736596    0.1334017      0              644149.09      2.6109412e-16  0              3.4156918    
    800000   127.27922      200            200            0.0046263975  -4.8541925e-38  0              0.013879192    0.051119145    0              246836.06      2.6109412e-16  0              3.4154442    
    900000   127.27922      200            200            0.0047692341  -1.9861661e-37  0              0.014307702    0.00010766929  0              519.89649      2.6109412e-16  0              3.4153485    
   1000000   127.27922      200            200            0.0046921613   4.7064674e-39  0              0.014076484    0.0010551481   0              5094.9327      2.6109412e-16  0              3.4153984    
   1100000   127.27922      200            200            0.0046867012   1.1556582e-39  0              0.014060104    1.9495645e-05  0              94.137492      2.6109412e-16  0              3.4154023    
   1200000   127.27922      200            200            0.0046980916   1.4063365e-39  0              0.014094275    1.2996711e-05  0              62.756466      2.6109412e-16  0              3.4153949    
   1300000   127.27922      200            200            0.0046967921  -8.0408793e-40  0              0.014090376    1.5463234e-06  0              7.4666422      2.6109412e-16  0              3.4153957    
   1400000   127.27922      200            200            0.0046954833   2.3887303e-39  0              0.01408645     7.0247682e-08  0              0.33920091     2.6109412e-16  0              3.4153965    
   1500000   127.27922      200            200            0.0046958937   8.3876794e-39  0              0.014087681    4.6552295e-08  0              0.22478437     2.6109412e-16  0              3.4153963    
   1600000   127.27922      200            200            0.0046959973   4.2345895e-39  0              0.014087992    7.7780171e-12  0              3.7557261e-05  2.6109412e-16  0              3.4153962    
   1700000   127.27922      200            200            0.0046959232  -4.0365935e-39  0              0.01408777     8.2356811e-10  0              0.0039767157   2.6109412e-16  0              3.4153962    
   1800000   127.27922      200            200            0.0046959224  -1.3855399e-39  0              0.014087767    3.0459126e-11  0              0.00014707622  2.6109412e-16  0              3.4153962    
   1900000   127.27922      200            200            0.0046959326   7.088422e-40   0              0.014087798    8.379287e-12   0              4.0460578e-05  2.6109412e-16  0              3.4153962    
   2000000   127.27922      200            200            0.0046959309   1.0490251e-39  0              0.014087793    1.6014447e-12  0              7.7328035e-06  2.6109412e-16  0              3.4153962    
   2100000   127.27922      200            200            0.0046959298  -2.7869046e-39  0              0.014087789    2.7242923e-14  0              1.3154633e-07  2.6109412e-16  0              3.4153962    
   2200000   127.27922      200            200            0.0046959302  -1.1111999e-39  0              0.014087791    4.0321717e-14  0              1.9469914e-07  2.6109412e-16  0              3.4153962    
   2300000   127.27922      200            200            0.0046959303   5.4759196e-39  0              0.014087791    1.8729101e-16  0              9.0436128e-10  2.6109412e-16  0              3.4153962    
   2400000   127.27922      200            200            0.0046959302   6.3675132e-40  0              0.014087791    6.1132427e-16  0              2.9518661e-09  2.6109412e-16  0              3.4153962    
   2500000   127.27922      200            200            0.0046959302  -1.0978011e-39  0              0.014087791    3.9464564e-17  0              1.9056026e-10  2.6109412e-16  0              3.4153962    
   2600000   127.27922      200            200            0.0046959303   7.5404946e-39  0              0.014087791    4.1779287e-18  0              2.0173722e-11  2.6109412e-16  0              3.4153962    
   2700000   127.27922      200            200            0.0046959303   5.3728877e-39  0              0.014087791    1.8236592e-18  0              8.8057975e-12  2.6109412e-16  0              3.4153962    
   2800000   127.27922      200            200            0.0046959303  -1.5422797e-39  0              0.014087791    6.2922027e-20  0              3.0382795e-13  2.6109412e-16  0              3.4153962    
   2900000   127.27922      200            200            0.0046959303  -1.0936788e-39  0              0.014087791    9.1288895e-22  0              4.408014e-15   2.6109412e-16  0              3.4153962    
   3000000   127.27922      200            200            0.0046959303  -5.3794636e-40  0              0.014087791    1.1357751e-19  0              5.4842514e-13  2.6109412e-16  0              3.4153962    
Loop time of 68.8623 on 4 procs for 3000000 steps with 51 atoms

Performance: 37640328.038 ns/day, 0.000 hours/ns, 43565.194 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28928    | 1.1622     | 3.7291     | 137.5 |  1.69
Neigh   | 0.040132   | 0.041568   | 0.043752   |   0.7 |  0.06
Comm    | 29.803     | 37.348     | 43.521     |  93.8 | 54.24
Output  | 0.07546    | 0.075666   | 0.075865   |   0.1 |  0.11
Modify  | 14.72      | 21.52      | 29.823     | 144.7 | 31.25
Other   |            | 8.715      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.85                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.7360329505601
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.95
  ghost atom cutoff = 3.95
  binsize = 1.975, bins = 65 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.52 | 16.99 | 18.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00010435676 -4.8414962e-39  0             -0.00031307029  13907.626      0              6.7154948e+10  2.6109412e-16  0              3.4497113    
    200000   127.27922      200            200           -0.00035140374  2.5181583e-37  0             -0.0010542112   687.50297      0              3.3197058e+09  2.6109412e-16  0              3.5564067    
    300000   127.27922      200            200           -6.7034538e-05 -7.6081442e-38  0             -0.00020110361  17.883028      0              86350740       2.6109412e-16  0              3.4616009    
    400000   127.27922      200            200           -9.8647807e-05 -9.0165251e-37  0             -0.00029594342  41.033914      0              1.9813808e+08  2.6109412e-16  0              3.4279858    
    500000   127.27922      200            200            0.0091333358   0.00020480932  0              0.027195198    1.7307337      0              8357093.7      2.6109412e-16  0              3.4179911    
    600000   127.27922      200            200            0.0054366614   4.4936299e-37  0              0.016309984    2.4019587      0              11598199       2.6109412e-16  0              3.419915     
    700000   127.27922      200            200            0.0041981086  -2.3376903e-37  0              0.012594326    0.053605301    0              258840.81      2.6109412e-16  0              3.4207312    
    800000   127.27922      200            200            0.004681755    9.0355058e-38  0              0.014045265    0.057660757    0              278423.16      2.6109412e-16  0              3.4204143    
    900000   127.27922      200            200            0.0047755667   1.5049576e-37  0              0.0143267      0.00018503027  0              893.44494      2.6109412e-16  0              3.4203505    
   1000000   127.27922      200            200            0.0046915466  -2.6768896e-38  0              0.01407464     0.00089279666  0              4310.9956      2.6109412e-16  0              3.420405     
   1100000   127.27922      200            200            0.0046951487  -3.7965223e-38  0              0.014085446    5.7799505e-05  0              279.09312      2.6109412e-16  0              3.4204031    
   1200000   127.27922      200            200            0.0047058078   1.7860384e-38  0              0.014117423    6.6418322e-06  0              32.071031      2.6109412e-16  0              3.4203961    
   1300000   127.27922      200            200            0.0047032646  -5.5770495e-40  0              0.014109794    2.329831e-06   0              11.24992       2.6109412e-16  0              3.4203977    
   1400000   127.27922      200            200            0.004702313    2.0942607e-39  0              0.014106939    2.9304092e-09  0              0.014149897    2.6109412e-16  0              3.4203983    
   1500000   127.27922      200            200            0.0047028408   5.637127e-39   0              0.014108522    4.7089808e-08  0              0.22737983     2.6109412e-16  0              3.420398     
   1600000   127.27922      200            200            0.0047028677  -9.320552e-40   0              0.014108603    1.1941674e-09  0              0.0057662071   2.6109412e-16  0              3.420398     
   1700000   127.27922      200            200            0.0047027911   4.5632847e-40  0              0.014108373    5.1510398e-10  0              0.0024872528   2.6109412e-16  0              3.420398     
   1800000   127.27922      200            200            0.0047028023   5.1659919e-41  0              0.014108407    8.2025094e-11  0              0.00039606982  2.6109412e-16  0              3.420398     
   1900000   127.27922      200            200            0.0047028105  -3.3260997e-39  0              0.014108431    1.7511165e-12  0              8.455515e-06   2.6109412e-16  0              3.420398     
   2000000   127.27922      200            200            0.0047028074   3.6453078e-39  0              0.014108422    2.1934324e-12  0              1.05913e-05    2.6109412e-16  0              3.420398     
   2100000   127.27922      200            200            0.0047028069   9.904668e-40   0              0.014108421    1.1401432e-14  0              5.5053433e-08  2.6109412e-16  0              3.420398     
   2200000   127.27922      200            200            0.0047028074  -5.2334912e-39  0              0.014108422    3.2360123e-14  0              1.5625545e-07  2.6109412e-16  0              3.420398     
   2300000   127.27922      200            200            0.0047028073  -4.7322777e-39  0              0.014108422    2.4130761e-15  0              1.1651881e-08  2.6109412e-16  0              3.420398     
   2400000   127.27922      200            200            0.0047028073  -3.5544292e-39  0              0.014108422    2.2495452e-16  0              1.0862249e-09  2.6109412e-16  0              3.420398     
   2500000   127.27922      200            200            0.0047028073  -1.6954225e-39  0              0.014108422    8.9722857e-17  0              4.3323957e-10  2.6109412e-16  0              3.420398     
   2600000   127.27922      200            200            0.0047028073   2.4442393e-40  0              0.014108422    9.7179098e-22  0              4.6924308e-15  2.6109412e-16  0              3.420398     
   2700000   127.27922      200            200            0.0047028073   1.0138721e-38  0              0.014108422    1.1739712e-18  0              5.6686868e-12  2.6109412e-16  0              3.420398     
   2800000   127.27922      200            200            0.0047028073  -2.87532e-39    0              0.014108422    2.3593359e-19  0              1.1392389e-12  2.6109412e-16  0              3.420398     
   2900000   127.27922      200            200            0.0047028073  -1.8708478e-39  0              0.014108422    3.9365427e-20  0              1.9008156e-13  2.6109412e-16  0              3.420398     
   3000000   127.27922      200            200            0.0047028073  -3.1836342e-39  0              0.014108422    9.906132e-21   0              4.7833166e-14  2.6109412e-16  0              3.420398     
Loop time of 69.0875 on 4 procs for 3000000 steps with 51 atoms

Performance: 37517623.357 ns/day, 0.000 hours/ns, 43423.175 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28881    | 1.2078     | 3.9225     | 142.6 |  1.75
Neigh   | 0.041779   | 0.043445   | 0.046025   |   0.8 |  0.06
Comm    | 29.821     | 37.359     | 43.597     |  93.4 | 54.08
Output  | 0.14985    | 0.15006    | 0.15025    |   0.0 |  0.22
Modify  | 14.75      | 21.566     | 29.861     | 144.4 | 31.21
Other   |            | 8.761      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.86                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.2495933951522
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.96
  ghost atom cutoff = 3.96
  binsize = 1.98, bins = 65 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.52 | 16.99 | 18.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00012066411  2.4216367e-39  0             -0.00036199234  13735.894      0              6.6325716e+10  2.6109412e-16  0              3.4600665    
    200000   127.27922      200            200           -0.00034465866  1.3568902e-37  0             -0.001033976    648.75335      0              3.1325978e+09  2.6109412e-16  0              3.5630293    
    300000   127.27922      200            200           -5.472546e-05  -3.8589837e-37  0             -0.00016417638  11.716794      0              56576203       2.6109412e-16  0              3.4668867    
    400000   127.27922      200            200           -8.5574473e-05  3.4371704e-36  0             -0.00025672342  30.29927       0              1.4630433e+08  2.6109412e-16  0              3.4334898    
    500000   127.27922      200            200            0.0093978936   0.00028527296  0              0.027908408    0.079020447    0              381561.46      2.6109412e-16  0              3.4229102    
    600000   127.27922      200            200            0.0051440423  -1.3009897e-36  0              0.015432127    2.8924992      0              13966843       2.6109412e-16  0              3.4251036    
    700000   127.27922      200            200            0.0041766551  -2.2309676e-37  0              0.012529965    0.0074364737   0              35908.07       2.6109412e-16  0              3.4257531    
    800000   127.27922      200            200            0.0047386391   3.4810754e-38  0              0.014215917    0.057205683    0              276225.77      2.6109412e-16  0              3.4253834    
    900000   127.27922      200            200            0.0047766025  -4.4935536e-38  0              0.014329807    0.001334295    0              6442.8329      2.6109412e-16  0              3.4253558    
   1000000   127.27922      200            200            0.0046918686  -4.45714e-38    0              0.014075606    0.00061532171  0              2971.1683      2.6109412e-16  0              3.4254111    
   1100000   127.27922      200            200            0.0047043206   5.5444937e-39  0              0.014112962    0.00010124745  0              488.88768      2.6109412e-16  0              3.4254033    
   1200000   127.27922      200            200            0.0047132037   1.5529822e-38  0              0.014139611    1.6336001e-06  0              7.8880703      2.6109412e-16  0              3.4253975    
   1300000   127.27922      200            200            0.0047096826   1.0655914e-40  0              0.014129048    2.6439258e-06  0              12.766572      2.6109412e-16  0              3.4253997    
   1400000   127.27922      200            200            0.0047092085  -5.1080104e-39  0              0.014127625    2.6629097e-08  0              0.12858238     2.6109412e-16  0              3.4254       
   1500000   127.27922      200            200            0.004709783   -3.509304e-40   0              0.014129349    3.4709776e-08  0              0.16760109     2.6109412e-16  0              3.4253997    
   1600000   127.27922      200            200            0.0047097284   2.1993785e-39  0              0.014129185    3.6719062e-09  0              0.017730321    2.6109412e-16  0              3.4253997    
   1700000   127.27922      200            200            0.0047096619  -4.0702385e-41  0              0.014128986    1.6091049e-10  0              0.00077697919  2.6109412e-16  0              3.4253997    
   1800000   127.27922      200            200            0.004709683   -4.076255e-39   0              0.014129049    1.1712353e-10  0              0.0005655476   2.6109412e-16  0              3.4253997    
   1900000   127.27922      200            200            0.0047096877  -2.0000232e-39  0              0.014129063    2.7098489e-13  0              1.3084891e-06  2.6109412e-16  0              3.4253997    
   2000000   127.27922      200            200            0.0047096838   1.9514689e-39  0              0.014129052    1.8413879e-12  0              8.8914034e-06  2.6109412e-16  0              3.4253997    
   2100000   127.27922      200            200            0.004709684    1.1185697e-39  0              0.014129052    1.231856e-13   0              5.9481916e-07  2.6109412e-16  0              3.4253997    
   2200000   127.27922      200            200            0.0047096845  -3.8881188e-39  0              0.014129053    1.2334535e-14  0              5.9559055e-08  2.6109412e-16  0              3.4253997    
   2300000   127.27922      200            200            0.0047096844  -3.379818e-39   0              0.014129053    4.9624011e-15  0              2.3961659e-08  2.6109412e-16  0              3.4253997    
   2400000   127.27922      200            200            0.0047096843   2.2644758e-40  0              0.014129053    2.9916001e-19  0              1.4445366e-12  2.6109412e-16  0              3.4253997    
   2500000   127.27922      200            200            0.0047096843   2.0931984e-39  0              0.014129053    9.4008982e-17  0              4.5393573e-10  2.6109412e-16  0              3.4253997    
   2600000   127.27922      200            200            0.0047096843   2.2253933e-39  0              0.014129053    3.8714635e-18  0              1.8693912e-11  2.6109412e-16  0              3.4253997    
   2700000   127.27922      200            200            0.0047096843  -5.8227359e-40  0              0.014129053    2.20427e-19    0              1.0643631e-12  2.6109412e-16  0              3.4253997    
   2800000   127.27922      200            200            0.0047096843   2.1494188e-39  0              0.014129053    2.0822927e-19  0              1.0054646e-12  2.6109412e-16  0              3.4253997    
   2900000   127.27922      200            200            0.0047096843  -7.1261834e-39  0              0.014129053    1.6522813e-20  0              7.9782749e-14  2.6109412e-16  0              3.4253997    
   3000000   127.27922      200            200            0.0047096843   2.4655529e-39  0              0.014129053    4.9634496e-20  0              2.3966722e-13  2.6109412e-16  0              3.4253997    
Loop time of 68.8984 on 4 procs for 3000000 steps with 51 atoms

Performance: 37620586.654 ns/day, 0.000 hours/ns, 43542.346 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29353    | 1.1856     | 3.8177     | 139.6 |  1.72
Neigh   | 0.043027   | 0.044713   | 0.047291   |   0.8 |  0.06
Comm    | 29.811     | 37.334     | 43.541     |  93.5 | 54.19
Output  | 0.12241    | 0.12263    | 0.12283    |   0.1 |  0.18
Modify  | 14.687     | 21.492     | 29.783     | 145.0 | 31.19
Other   |            | 8.719      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.87                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.765821680226
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.97
  ghost atom cutoff = 3.97
  binsize = 1.985, bins = 65 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 16.96 | 18.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00013673731  7.3799356e-45  0             -0.00041021194  13565.331      0              6.5502131e+10  2.6109412e-16  0              3.4703913    
    200000   127.27922      200            200           -0.000337721   -5.8090196e-38  0             -0.001013163    611.16125      0              2.951079e+09   2.6109412e-16  0              3.5696049    
    300000   127.27922      200            200           -4.2220473e-05  3.1139532e-37  0             -0.00012666142  6.8544228      0              33097555       2.6109412e-16  0              3.4721117    
    400000   127.27922      200            200           -7.226252e-05   1.2682174e-36  0             -0.00021678756  21.203175      0              1.0238254e+08  2.6109412e-16  0              3.4389186    
    500000   127.27922      200            200            0.0093330608   0.00029175811  0              0.027707424    0.59821453     0              2888563.9      2.6109412e-16  0              3.4279374    
    600000   127.27922      200            200            0.0048368093   1.8096058e-36  0              0.014510428    3.1428768      0              15175827       2.6109412e-16  0              3.4303053    
    700000   127.27922      200            200            0.0041825174  -2.107969e-36   0              0.012547552    0.0039898381   0              19265.5        2.6109412e-16  0              3.4307565    
    800000   127.27922      200            200            0.0047939225  -4.7926211e-37  0              0.014381768    0.049852359    0              240719.2       2.6109412e-16  0              3.4303536    
    900000   127.27922      200            200            0.004772768    1.9282514e-37  0              0.014318304    0.003218966    0              15543.235      2.6109412e-16  0              3.4303644    
   1000000   127.27922      200            200            0.0046936702   5.4106751e-38  0              0.014081011    0.00031296112  0              1511.1773      2.6109412e-16  0              3.4304162    
   1100000   127.27922      200            200            0.0047139997  -1.9689466e-38  0              0.014141999    0.00013374473  0              645.80545      2.6109412e-16  0              3.4304033    
   1200000   127.27922      200            200            0.0047202242   7.7435658e-39  0              0.014160673    2.3267998e-08  0              0.11235284     2.6109412e-16  0              3.4303991    
   1300000   127.27922      200            200            0.0047161009  -2.0472023e-39  0              0.014148303    2.3454035e-06  0              11.325114      2.6109412e-16  0              3.4304017    
   1400000   127.27922      200            200            0.0047161672  -1.3303076e-39  0              0.014148502    1.2819023e-07  0              0.61898473     2.6109412e-16  0              3.4304017    
   1500000   127.27922      200            200            0.0047167105   3.9769932e-40  0              0.014150132    1.6478539e-08  0              0.079568969    2.6109412e-16  0              3.4304014    
   1600000   127.27922      200            200            0.0047165819   1.7257988e-39  0              0.014149746    5.8878025e-09  0              0.028430091    2.6109412e-16  0              3.4304015    
   1700000   127.27922      200            200            0.0047165367   4.7678691e-41  0              0.01414961     2.1784724e-13  0              1.0519063e-06  2.6109412e-16  0              3.4304015    
   1800000   127.27922      200            200            0.004716564   -2.8144731e-39  0              0.014149692    1.099672e-10   0              0.00053099224  2.6109412e-16  0              3.4304015    
   1900000   127.27922      200            200            0.0047165641  -4.4046071e-39  0              0.014149692    5.0493999e-12  0              2.4381745e-05  2.6109412e-16  0              3.4304015    
   2000000   127.27922      200            200            0.0047165604  -1.0975119e-39  0              0.014149681    8.5383686e-13  0              4.1228726e-06  2.6109412e-16  0              3.4304015    
   2100000   127.27922      200            200            0.0047165612  -1.5670091e-40  0              0.014149684    2.5772841e-13  0              1.2444782e-06  2.6109412e-16  0              3.4304015    
   2200000   127.27922      200            200            0.0047165615  -2.1816326e-39  0              0.014149685    1.7391567e-16  0              8.3977655e-10  2.6109412e-16  0              3.4304015    
   2300000   127.27922      200            200            0.0047165614  -1.7208992e-39  0              0.014149684    5.1287351e-15  0              2.4764826e-08  2.6109412e-16  0              3.4304015    
   2400000   127.27922      200            200            0.0047165614  -1.1917128e-39  0              0.014149684    1.9632849e-16  0              9.4800001e-10  2.6109412e-16  0              3.4304015    
   2500000   127.27922      200            200            0.0047165614   1.5650317e-41  0              0.014149684    4.3886679e-17  0              2.1191307e-10  2.6109412e-16  0              3.4304015    
   2600000   127.27922      200            200            0.0047165614   7.353259e-39   0              0.014149684    1.1332779e-17  0              5.4721933e-11  2.6109412e-16  0              3.4304015    
   2700000   127.27922      200            200            0.0047165614   3.2735036e-39  0              0.014149684    6.4857925e-20  0              3.1317571e-13  2.6109412e-16  0              3.4304015    
   2800000   127.27922      200            200            0.0047165614   4.7290128e-39  0              0.014149684    5.2771281e-20  0              2.5481363e-13  2.6109412e-16  0              3.4304015    
   2900000   127.27922      200            200            0.0047165614  -3.4060923e-39  0              0.014149684    1.2966184e-19  0              6.2609062e-13  2.6109412e-16  0              3.4304015    
   3000000   127.27922      200            200            0.0047165614  -1.152174e-39   0              0.014149684    8.8464476e-23  0              4.2716329e-16  2.6109412e-16  0              3.4304015    
Loop time of 69.1254 on 4 procs for 3000000 steps with 51 atoms

Performance: 37497086.928 ns/day, 0.000 hours/ns, 43399.406 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29594    | 1.2326     | 3.9813     | 142.9 |  1.78
Neigh   | 0.042701   | 0.044492   | 0.047188   |   0.9 |  0.06
Comm    | 29.784     | 37.371     | 43.632     |  94.0 | 54.06
Output  | 0.13364    | 0.13386    | 0.13407    |   0.1 |  0.19
Modify  | 14.848     | 21.64      | 30.039     | 145.7 | 31.30
Other   |            | 8.704      |            |       | 12.59

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.88                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.284724717285
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.98
  ghost atom cutoff = 3.98
  binsize = 1.99, bins = 64 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.48 | 16.95 | 18.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00015257676  2.4212805e-39  0             -0.00045773029  13395.939      0              6.4684197e+10  2.6109412e-16  0              3.4806859    
    200000   127.27922      200            200           -0.00033059211  4.8458167e-39  0             -0.00099177632  574.72545      0              2.7751435e+09  2.6109412e-16  0              3.5761335    
    300000   127.27922      200            200           -2.9521614e-05  4.6678015e-37  0             -8.8564841e-05  3.2913912      0              15892950       2.6109412e-16  0              3.4772759    
    400000   127.27922      200            200           -5.8714455e-05 -1.833992e-36   0             -0.00017614336  13.737662      0              66334255       2.6109412e-16  0              3.4442722    
    500000   127.27922      200            200            0.0089494907   0.00022581398  0              0.026622658    3.1602877      0              15259898       2.6109412e-16  0              3.4330717    
    600000   127.27922      200            200            0.0045302801   2.333428e-38   0              0.01359084     3.112868       0              15030926       2.6109412e-16  0              3.4355109    
    700000   127.27922      200            200            0.0042158072  -2.3852654e-37  0              0.012647422    0.043685299    0              210940.68      2.6109412e-16  0              3.4357413    
    800000   127.27922      200            200            0.0048445291  -4.8702734e-37  0              0.014533587    0.037402028    0              180601.01      2.6109412e-16  0              3.4353269    
    900000   127.27922      200            200            0.0047648487  -1.1580497e-37  0              0.014294546    0.0052949515   0              25567.426      2.6109412e-16  0              3.4353756    
   1000000   127.27922      200            200            0.0046973712   3.2513442e-37  0              0.014092114    8.3387594e-05  0              402.64885      2.6109412e-16  0              3.43542      
   1100000   127.27922      200            200            0.0047239214  -1.0975729e-39  0              0.014171764    0.00014333787  0              692.12728      2.6109412e-16  0              3.435403     
   1200000   127.27922      200            200            0.0047268546   1.2736817e-38  0              0.014180564    2.4400521e-06  0              11.782139      2.6109412e-16  0              3.435401     
   1300000   127.27922      200            200            0.0047225742   2.3183474e-39  0              0.014167723    1.5749968e-06  0              7.605096       2.6109412e-16  0              3.4354037    
   1400000   127.27922      200            200            0.0047231781   1.5549479e-38  0              0.014169534    2.5476136e-07  0              1.2301514      2.6109412e-16  0              3.4354034    
   1500000   127.27922      200            200            0.0047236162   3.5043642e-40  0              0.014170849    2.6879359e-09  0              0.01297908     2.6109412e-16  0              3.4354031    
   1600000   127.27922      200            200            0.0047234321   5.3290602e-39  0              0.014170296    6.4678698e-09  0              0.031231029    2.6109412e-16  0              3.4354032    
   1700000   127.27922      200            200            0.0047234158   7.2722987e-39  0              0.014170247    1.3886005e-10  0              0.00067050549  2.6109412e-16  0              3.4354032    
   1800000   127.27922      200            200            0.0047234445  -4.0673663e-39  0              0.014170334    6.6073923e-11  0              0.00031904733  2.6109412e-16  0              3.4354032    
   1900000   127.27922      200            200            0.00472344     1.6032011e-39  0              0.01417032     1.2213656e-11  0              5.8975372e-05  2.6109412e-16  0              3.4354032    
   2000000   127.27922      200            200            0.0047234372   5.5108471e-39  0              0.014170312    8.0092966e-14  0              3.8674027e-07  2.6109412e-16  0              3.4354032    
   2100000   127.27922      200            200            0.0047234385   1.6047741e-39  0              0.014170315    2.906803e-13   0              1.4035911e-06  2.6109412e-16  0              3.4354032    
   2200000   127.27922      200            200            0.0047234386  -7.0828695e-39  0              0.014170316    7.6906083e-15  0              3.7135195e-08  2.6109412e-16  0              3.4354032    
   2300000   127.27922      200            200            0.0047234384   1.8461634e-39  0              0.014170315    2.7617397e-15  0              1.3335453e-08  2.6109412e-16  0              3.4354032    
   2400000   127.27922      200            200            0.0047234384  -1.2620582e-39  0              0.014170315    5.8527358e-16  0              2.8260767e-09  2.6109412e-16  0              3.4354032    
   2500000   127.27922      200            200            0.0047234384  -6.6625631e-40  0              0.014170315    1.5110871e-18  0              7.296499e-12   2.6109412e-16  0              3.4354032    
   2600000   127.27922      200            200            0.0047234384   2.4277024e-39  0              0.014170315    1.2801555e-17  0              6.1814126e-11  2.6109412e-16  0              3.4354032    
   2700000   127.27922      200            200            0.0047234384   1.9721322e-39  0              0.014170315    1.0165168e-18  0              4.908396e-12   2.6109412e-16  0              3.4354032    
   2800000   127.27922      200            200            0.0047234384   5.8407001e-39  0              0.014170315    1.5158386e-21  0              7.3194421e-15  2.6109412e-16  0              3.4354032    
   2900000   127.27922      200            200            0.0047234384  -1.0925198e-39  0              0.014170315    6.0515402e-20  0              2.9220722e-13  2.6109412e-16  0              3.4354032    
   3000000   127.27922      200            200            0.0047234384  -5.5058157e-39  0              0.014170315    5.4991377e-20  0              2.6553368e-13  2.6109412e-16  0              3.4354032    
Loop time of 68.994 on 4 procs for 3000000 steps with 51 atoms

Performance: 37568479.019 ns/day, 0.000 hours/ns, 43482.036 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28709    | 1.1813     | 3.8029     | 139.3 |  1.71
Neigh   | 0.041405   | 0.043513   | 0.046505   |   1.0 |  0.06
Comm    | 29.913     | 37.424     | 43.63      |  93.5 | 54.24
Output  | 0.075597   | 0.075845   | 0.076072   |   0.1 |  0.11
Modify  | 14.747     | 21.57      | 29.876     | 144.8 | 31.26
Other   |            | 8.699      |            |       | 12.61

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.89                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.8063094178331
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.99
  ghost atom cutoff = 3.99
  binsize = 1.995, bins = 64 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.48 | 16.95 | 18.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00016818319  2.4211952e-39  0             -0.00050454958  13227.714      0              6.3871898e+10  2.6109412e-16  0              3.4909502    
    200000   127.27922      200            200           -0.00032327261  7.7540411e-38  0             -0.00096981782  539.44117      0              2.6047683e+09  2.6109412e-16  0              3.5826149    
    300000   127.27922      200            200           -1.6629514e-05 -7.6494105e-38  0             -4.9888541e-05  1.0227364      0              4938428.2      2.6109412e-16  0              3.4823792    
    400000   127.27922      200            200           -4.4931812e-05  3.3934927e-37  0             -0.00013479544  7.8942556      0              38118535       2.6109412e-16  0              3.4495504    
    500000   127.27922      200            200            0.0083100786   3.5642958e-05  0              0.024894593    7.1357248      0              34455862       2.6109412e-16  0              3.4383049    
    600000   127.27922      200            200            0.0042386581  -2.1940203e-37  0              0.012715974    2.813478       0              13585279       2.6109412e-16  0              3.4407113    
    700000   127.27922      200            200            0.0042753966   3.7245669e-37  0              0.01282619     0.1181977      0              570734.41      2.6109412e-16  0              3.4407085    
    800000   127.27922      200            200            0.0048876389  -3.4101604e-37  0              0.014662917    0.02292139     0              110679.19      2.6109412e-16  0              3.4403051    
    900000   127.27922      200            200            0.004753928   -1.5238852e-37  0              0.014261784    0.0069672726   0              33642.466      2.6109412e-16  0              3.4403887    
   1000000   127.27922      200            200            0.0047032336   9.2244206e-38  0              0.014109701    2.4899606e-08  0              0.12023129     2.6109412e-16  0              3.4404225    
   1100000   127.27922      200            200            0.0047337984  -2.5397927e-39  0              0.014201395    0.00012657514  0              611.18604      2.6109412e-16  0              3.4404028    
   1200000   127.27922      200            200            0.0047331216   1.2702309e-38  0              0.014199365    7.8448081e-06  0              37.879771      2.6109412e-16  0              3.4404031    
   1300000   127.27922      200            200            0.0047291505   3.2906969e-39  0              0.014187452    6.8947827e-07  0              3.3292438      2.6109412e-16  0              3.4404057    
   1400000   127.27922      200            200            0.0047302235  -1.1977266e-39  0              0.01419067     3.4124599e-07  0              1.6477547      2.6109412e-16  0              3.440405     
   1500000   127.27922      200            200            0.0047304958  -1.8413888e-39  0              0.014191487    1.0216657e-09  0              0.004933258    2.6109412e-16  0              3.4404048    
   1600000   127.27922      200            200            0.0047302833  -5.0725023e-40  0              0.01419085     5.0628904e-09  0              0.024446886    2.6109412e-16  0              3.4404049    
   1700000   127.27922      200            200            0.0047302989   3.2164904e-39  0              0.014190897    4.7986718e-10  0              0.0023171069   2.6109412e-16  0              3.4404049    
   1800000   127.27922      200            200            0.0047303238  -8.8682503e-40  0              0.014190971    1.7779101e-11  0              8.5848918e-05  2.6109412e-16  0              3.4404049    
   1900000   127.27922      200            200            0.0047303156   5.1785819e-40  0              0.014190947    1.6049963e-11  0              7.7499526e-05  2.6109412e-16  0              3.4404049    
   2000000   127.27922      200            200            0.0047303142  -4.4940299e-40  0              0.014190943    1.7575279e-13  0              8.4864734e-07  2.6109412e-16  0              3.4404049    
   2100000   127.27922      200            200            0.0047303157  -1.3634802e-39  0              0.014190947    1.9234094e-13  0              9.2874557e-07  2.6109412e-16  0              3.4404049    
   2200000   127.27922      200            200            0.0047303155   3.8334817e-39  0              0.014190947    2.7255792e-14  0              1.3160846e-07  2.6109412e-16  0              3.4404049    
   2300000   127.27922      200            200            0.0047303154  -3.0132718e-39  0              0.014190946    3.4213959e-16  0              1.6520696e-09  2.6109412e-16  0              3.4404049    
   2400000   127.27922      200            200            0.0047303154  -3.1367744e-39  0              0.014190946    7.2434527e-16  0              3.4976041e-09  2.6109412e-16  0              3.4404049    
   2500000   127.27922      200            200            0.0047303154  -7.6952807e-40  0              0.014190946    1.88777e-17    0              9.1153656e-11  2.6109412e-16  0              3.4404049    
   2600000   127.27922      200            200            0.0047303154  -1.4391718e-40  0              0.014190946    6.1194231e-18  0              2.9548504e-11  2.6109412e-16  0              3.4404049    
   2700000   127.27922      200            200            0.0047303154   8.4289771e-39  0              0.014190946    1.7963062e-18  0              8.6737199e-12  2.6109412e-16  0              3.4404049    
   2800000   127.27922      200            200            0.0047303154   7.437606e-40   0              0.014190946    8.4712858e-20  0              4.0904807e-13  2.6109412e-16  0              3.4404049    
   2900000   127.27922      200            200            0.0047303154  -1.4047736e-39  0              0.014190946    6.8639358e-20  0              3.3143489e-13  2.6109412e-16  0              3.4404049    
   3000000   127.27922      200            200            0.0047303154  -5.8792998e-39  0              0.014190946    2.7630138e-20  0              1.3341605e-13  2.6109412e-16  0              3.4404049    
Loop time of 69.2828 on 4 procs for 3000000 steps with 51 atoms

Performance: 37411905.099 ns/day, 0.000 hours/ns, 43300.816 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2925     | 1.178      | 3.8123     | 140.1 |  1.70
Neigh   | 0.04325    | 0.044968   | 0.047722   |   0.9 |  0.06
Comm    | 29.904     | 37.52      | 43.709     |  94.8 | 54.16
Output  | 0.074956   | 0.075167   | 0.075375   |   0.1 |  0.11
Modify  | 14.935     | 21.745     | 30.123     | 146.2 | 31.39
Other   |            | 8.719      |            |       | 12.59

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.9                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.3305826933741
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4
  ghost atom cutoff = 4
  binsize = 2, bins = 64 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.54 | 17.01 | 18.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00018355734 -3.8631635e-38  0             -0.00055067203  13060.652      0              6.3065214e+10  2.6109412e-16  0              3.5011841    
    200000   127.27922      200            200           -0.00031576354  4.8432036e-38  0             -0.00094729063  505.3057       0              2.4399404e+09  2.6109412e-16  0              3.589049     
    300000   127.27922      200            200           -3.5459008e-06  4.6734995e-37  0             -1.0637702e-05  0.043836818    0              211672.3       2.6109412e-16  0              3.4874215    
    400000   127.27922      200            200           -3.0916912e-05  7.1526698e-36  0             -9.2750736e-05  3.6649757      0              17696856       2.6109412e-16  0              3.4547532    
    500000   127.27922      200            200            0.0076891524  -1.9374868e-36  0              0.023067457    11.728008      0              56630355       2.6109412e-16  0              3.4436239    
    600000   127.27922      200            200            0.0039743834   1.2717193e-37  0              0.01192315     2.3022645      0              11116812       2.6109412e-16  0              3.4458976    
    700000   127.27922      200            200            0.0043589255   5.1877658e-37  0              0.013076776    0.2120809      0              1024062.8      2.6109412e-16  0              3.4456597    
    800000   127.27922      200            200            0.0049208812  -1.8645958e-37  0              0.014762644    0.0099855191   0              48216.498      2.6109412e-16  0              3.4452896    
    900000   127.27922      200            200            0.0047413064   5.0825423e-39  0              0.014223919    0.007759849    0              37469.534      2.6109412e-16  0              3.445403     
   1000000   127.27922      200            200            0.0047113413   3.1994062e-38  0              0.014134024    8.847688e-05   0              427.22319      2.6109412e-16  0              3.4454235    
   1100000   127.27922      200            200            0.0047433475   1.5330107e-39  0              0.014230042    8.9709426e-05  0              433.17471      2.6109412e-16  0              3.4454027    
   1200000   127.27922      200            200            0.0047390905   4.9500892e-39  0              0.014217272    1.3974438e-05  0              67.477562      2.6109412e-16  0              3.4454054    
   1300000   127.27922      200            200            0.0047358654   1.2767877e-39  0              0.014207596    9.5293036e-08  0              0.46013597     2.6109412e-16  0              3.4454075    
   1400000   127.27922      200            200            0.0047372809   5.7771422e-40  0              0.014211843    3.4362289e-07  0              1.659232       2.6109412e-16  0              3.4454066    
   1500000   127.27922      200            200            0.004737349    1.4366012e-39  0              0.014212047    1.2272545e-08  0              0.059259727    2.6109412e-16  0              3.4454065    
   1600000   127.27922      200            200            0.0047371397   2.8089586e-40  0              0.014211419    2.5497568e-09  0              0.012311863    2.6109412e-16  0              3.4454067    
   1700000   127.27922      200            200            0.0047371849   2.1153206e-39  0              0.014211555    7.9145115e-10  0              0.0038216343   2.6109412e-16  0              3.4454066    
   1800000   127.27922      200            200            0.0047372015   1.5761519e-39  0              0.014211604    2.3850829e-13  0              1.1516712e-06  2.6109412e-16  0              3.4454066    
   1900000   127.27922      200            200            0.0047371911  -7.2623744e-40  0              0.014211573    1.3542034e-11  0              6.5389633e-05  2.6109412e-16  0              3.4454066    
   2000000   127.27922      200            200            0.0047371915  -2.9857049e-39  0              0.014211575    1.0480495e-12  0              5.0606559e-06  2.6109412e-16  0              3.4454066    
   2100000   127.27922      200            200            0.0047371928  -9.5957896e-40  0              0.014211578    5.3617554e-14  0              2.5889998e-07  2.6109412e-16  0              3.4454066    
   2200000   127.27922      200            200            0.0047371924  -1.9069234e-39  0              0.014211577    3.9509923e-14  0              1.9077928e-07  2.6109412e-16  0              3.4454066    
   2300000   127.27922      200            200            0.0047371924   2.274715e-40   0              0.014211577    4.142255e-16   0              2.0001467e-09  2.6109412e-16  0              3.4454066    
   2400000   127.27922      200            200            0.0047371924   3.0261861e-39  0              0.014211577    4.6641771e-16  0              2.2521642e-09  2.6109412e-16  0              3.4454066    
   2500000   127.27922      200            200            0.0047371924  -6.8226421e-39  0              0.014211577    7.038095e-17   0              3.3984442e-10  2.6109412e-16  0              3.4454066    
   2600000   127.27922      200            200            0.0047371924   3.3690912e-39  0              0.014211577    2.8269638e-19  0              1.3650397e-12  2.6109412e-16  0              3.4454066    
   2700000   127.27922      200            200            0.0047371924  -3.31528e-39    0              0.014211577    1.2069443e-18  0              5.8279021e-12  2.6109412e-16  0              3.4454066    
   2800000   127.27922      200            200            0.0047371924   9.7083115e-40  0              0.014211577    2.3908965e-19  0              1.1544783e-12  2.6109412e-16  0              3.4454066    
   2900000   127.27922      200            200            0.0047371924  -1.0978298e-40  0              0.014211577    4.2577719e-21  0              2.0559257e-14  2.6109412e-16  0              3.4454066    
   3000000   127.27922      200            200            0.0047371924   1.316436e-39   0              0.014211577    6.2391118e-20  0              3.0126438e-13  2.6109412e-16  0              3.4454066    
Loop time of 68.9186 on 4 procs for 3000000 steps with 51 atoms

Performance: 37609564.452 ns/day, 0.000 hours/ns, 43529.588 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29084    | 1.1863     | 3.8334     | 140.3 |  1.72
Neigh   | 0.044442   | 0.046232   | 0.04889    |   0.9 |  0.07
Comm    | 29.926     | 37.449     | 43.651     |  93.4 | 54.34
Output  | 0.07461    | 0.074773   | 0.074908   |   0.0 |  0.11
Modify  | 14.624     | 21.44      | 29.725     | 144.7 | 31.11
Other   |            | 8.723      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.91                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.8575514554118
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.01
  ghost atom cutoff = 4.01
  binsize = 2.005, bins = 64 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.48 | 16.95 | 18.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00019869973  8.4739423e-39  0             -0.00059609918  12894.752      0              6.2264144e+10  2.6109412e-16  0              3.5113876    
    200000   127.27922      200            200           -0.00030806595 -1.548778e-37   0             -0.00092419784  472.31623      0              2.280646e+09   2.6109412e-16  0              3.5954358    
    300000   127.27922      200            200            9.7278758e-06 -6.9577767e-37  0              2.9183627e-05  0.34996529     0              1689857.1      2.6109412e-16  0              3.4924026    
    400000   127.27922      200            200           -1.6671828e-05 -2.769584e-36   0             -5.0015483e-05  1.0417354      0              5030167.2      2.6109412e-16  0              3.4598805    
    500000   127.27922      200            200            0.0069949915   5.3264258e-37  0              0.020984975    16.220578      0              78323365       2.6109412e-16  0              3.4490141    
    600000   127.27922      200            200            0.0037477267   2.0511577e-37  0              0.01124318     1.6709278      0              8068312.2      2.6109412e-16  0              3.451062     
    700000   127.27922      200            200            0.0044628391  -1.1877131e-36  0              0.013388517    0.30581768     0              1476684.1      2.6109412e-16  0              3.4505978    
    800000   127.27922      200            200            0.0049425074   5.7940949e-37  0              0.014827522    0.0017847324   0              8617.834       2.6109412e-16  0              3.4502815    
    900000   127.27922      200            200            0.0047284029  -3.0294684e-38  0              0.014185209    0.0074501101   0              35973.915      2.6109412e-16  0              3.4504175    
   1000000   127.27922      200            200            0.0047215928   9.0720071e-38  0              0.014164778    0.00031855753  0              1538.2003      2.6109412e-16  0              3.450423     
   1100000   127.27922      200            200            0.0047523167   5.0413518e-38  0              0.01425695     4.6330076e-05  0              223.71136      2.6109412e-16  0              3.4504031    
   1200000   127.27922      200            200            0.0047448582  -2.0597115e-39  0              0.014234574    1.8286212e-05  0              88.297575      2.6109412e-16  0              3.4504078    
   1300000   127.27922      200            200            0.0047427379   5.0035796e-39  0              0.014228214    6.1335031e-08  0              0.29616491     2.6109412e-16  0              3.4504092    
   1400000   127.27922      200            200            0.0047443265   2.2831895e-39  0              0.01423298     2.611091e-07   0              1.2608024      2.6109412e-16  0              3.4504082    
   1500000   127.27922      200            200            0.0047441793   2.8265883e-39  0              0.014232538    2.9983532e-08  0              0.14477975     2.6109412e-16  0              3.4504083    
   1600000   127.27922      200            200            0.0047440046   5.4954685e-40  0              0.014232014    4.7647433e-10  0              0.002300724    2.6109412e-16  0              3.4504084    
   1700000   127.27922      200            200            0.0047440722  -5.5662049e-40  0              0.014232217    8.6421956e-10  0              0.0041730069   2.6109412e-16  0              3.4504083    
   1800000   127.27922      200            200            0.0047440774  -5.22988e-39    0              0.014232232    2.580512e-11   0              0.00012460369  2.6109412e-16  0              3.4504083    
   1900000   127.27922      200            200            0.0047440668   5.2841842e-39  0              0.014232201    6.7083614e-12  0              3.2392276e-05  2.6109412e-16  0              3.4504083    
   2000000   127.27922      200            200            0.004744069    3.74133e-39    0              0.014232207    1.9467082e-12  0              9.399957e-06   2.6109412e-16  0              3.4504083    
   2100000   127.27922      200            200            0.0047440699   4.3945572e-40  0              0.01423221     9.4776093e-16  0              4.5763983e-09  2.6109412e-16  0              3.4504083    
   2200000   127.27922      200            200            0.0047440693   1.4347901e-39  0              0.014232208    3.2548194e-14  0              1.5716358e-07  2.6109412e-16  0              3.4504083    
   2300000   127.27922      200            200            0.0047440694   7.2409369e-41  0              0.014232208    2.8480104e-15  0              1.3752023e-08  2.6109412e-16  0              3.4504083    
   2400000   127.27922      200            200            0.0047440694  -6.1708349e-40  0              0.014232208    9.5014881e-17  0              4.5879286e-10  2.6109412e-16  0              3.4504083    
   2500000   127.27922      200            200            0.0047440694  -8.4976925e-39  0              0.014232208    9.828859e-17   0              4.7460043e-10  2.6109412e-16  0              3.4504083    
   2600000   127.27922      200            200            0.0047440694  -1.1701983e-39  0              0.014232208    2.5698454e-18  0              1.2408864e-11  2.6109412e-16  0              3.4504083    
   2700000   127.27922      200            200            0.0047440694  -1.0243724e-39  0              0.014232208    2.0599688e-19  0              9.9468519e-13  2.6109412e-16  0              3.4504083    
   2800000   127.27922      200            200            0.0047440694   1.0102838e-38  0              0.014232208    2.026698e-19   0              9.7861994e-13  2.6109412e-16  0              3.4504083    
   2900000   127.27922      200            200            0.0047440694  -1.6776689e-39  0              0.014232208    2.0513645e-20  0              9.9053048e-14  2.6109412e-16  0              3.4504083    
   3000000   127.27922      200            200            0.0047440694  -5.4916665e-39  0              0.014232208    4.0381712e-20  0              1.9498884e-13  2.6109412e-16  0              3.4504083    
Loop time of 69.1779 on 4 procs for 3000000 steps with 51 atoms

Performance: 37468608.416 ns/day, 0.000 hours/ns, 43366.445 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29292    | 1.1906     | 3.8312     | 139.7 |  1.72
Neigh   | 0.043395   | 0.045196   | 0.047846   |   0.8 |  0.07
Comm    | 29.874     | 37.455     | 43.733     |  94.2 | 54.14
Output  | 0.076437   | 0.076668   | 0.076866   |   0.1 |  0.11
Modify  | 14.824     | 21.69      | 30.039     | 145.4 | 31.35
Other   |            | 8.721      |            |       | 12.61

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.92                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.3872226154503
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.02
  ghost atom cutoff = 4.02
  binsize = 2.01, bins = 64 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.48 | 16.95 | 18.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00021361102 -6.6578078e-39  0             -0.00064083307  12730.012      0              6.1468672e+10  2.6109412e-16  0              3.5215606    
    200000   127.27922      200            200           -0.00030018056  3.8749179e-38  0             -0.00090054168  440.46879      0              2.1268661e+09  2.6109412e-16  0              3.6017752    
    300000   127.27922      200            200            2.3190883e-05  6.210476e-37   0              6.9572649e-05  1.9364824      0              9350580.4      2.6109412e-16  0              3.4973224    
    400000   127.27922      200            200           -2.1981329e-06  3.35163e-37    0             -6.5943988e-06  0.016477213    0              79562.565      2.6109412e-16  0              3.4649322    
    500000   127.27922      200            200            0.0062299065   7.2451185e-38  0              0.01868972     19.888291      0              96033438       2.6109412e-16  0              3.4544588    
    600000   127.27922      200            200            0.0035666706  -6.6204081e-36  0              0.010700012    1.0281898      0              4964760.5      2.6109412e-16  0              3.4561975    
    700000   127.27922      200            200            0.0045824715  -8.6998778e-37  0              0.013747414    0.37974858     0              1833670        2.6109412e-16  0              3.4555259    
    800000   127.27922      200            200            0.0049515221   2.7184577e-37  0              0.014854566    0.00032324833  0              1560.8505      2.6109412e-16  0              3.4552814    
    900000   127.27922      200            200            0.0047166507   6.9799375e-38  0              0.014149952    0.0061300963   0              29600.041      2.6109412e-16  0              3.4554313    
   1000000   127.27922      200            200            0.00473371     6.9374956e-38  0              0.01420113     0.00061441785  0              2966.8039      2.6109412e-16  0              3.4554214    
   1100000   127.27922      200            200            0.004760509    3.501415e-38   0              0.014281527    1.2319409e-05  0              59.486019      2.6109412e-16  0              3.4554039    
   1200000   127.27922      200            200            0.0047505424   2.1804916e-39  0              0.014251627    1.9007154e-05  0              91.778746      2.6109412e-16  0              3.4554102    
   1300000   127.27922      200            200            0.0047497681   1.1251075e-38  0              0.014249304    5.970809e-07   0              2.88309        2.6109412e-16  0              3.4554108    
   1400000   127.27922      200            200            0.0047513382   3.1745577e-40  0              0.014254015    1.3605634e-07  0              0.65696735     2.6109412e-16  0              3.4554098    
   1500000   127.27922      200            200            0.0047509937   3.9137441e-39  0              0.014252981    4.4150997e-08  0              0.21318936     2.6109412e-16  0              3.45541      
   1600000   127.27922      200            200            0.0047508798  -1.1771432e-39  0              0.014252639    1.0431897e-10  0              0.00050371899  2.6109412e-16  0              3.4554101    
   1700000   127.27922      200            200            0.004750959    3.0894567e-39  0              0.014252877    6.5084713e-10  0              0.0031427079   2.6109412e-16  0              3.45541      
   1800000   127.27922      200            200            0.0047509518   1.5864917e-40  0              0.014252855    7.5387327e-11  0              0.00036401842  2.6109412e-16  0              3.45541      
   1900000   127.27922      200            200            0.0047509431  -1.5158191e-39  0              0.014252829    9.3644903e-13  0              4.5217772e-06  2.6109412e-16  0              3.45541      
   2000000   127.27922      200            200            0.0047509466  -1.2035288e-40  0              0.01425284     2.1080609e-12  0              1.0179072e-05  2.6109412e-16  0              3.45541      
   2100000   127.27922      200            200            0.0047509468  -3.5152273e-39  0              0.01425284     8.0965519e-14  0              3.9095351e-07  2.6109412e-16  0              3.45541      
   2200000   127.27922      200            200            0.0047509463  -1.4087206e-39  0              0.014252839    1.3240941e-14  0              6.3935764e-08  2.6109412e-16  0              3.45541      
   2300000   127.27922      200            200            0.0047509464   1.3599263e-39  0              0.014252839    5.1046389e-15  0              2.4648474e-08  2.6109412e-16  0              3.45541      
   2400000   127.27922      200            200            0.0047509464  -1.0336867e-38  0              0.014252839    2.3857319e-17  0              1.1519846e-10  2.6109412e-16  0              3.45541      
   2500000   127.27922      200            200            0.0047509464  -7.847963e-40   0              0.014252839    6.9796598e-17  0              3.3702279e-10  2.6109412e-16  0              3.45541      
   2600000   127.27922      200            200            0.0047509464   9.6767635e-40  0              0.014252839    9.7277687e-18  0              4.6971914e-11  2.6109412e-16  0              3.45541      
   2700000   127.27922      200            200            0.0047509464  -1.4434754e-39  0              0.014252839    9.1230814e-20  0              4.4052095e-13  2.6109412e-16  0              3.45541      
   2800000   127.27922      200            200            0.0047509464   9.5390016e-39  0              0.014252839    2.9020568e-20  0              1.4012994e-13  2.6109412e-16  0              3.45541      
   2900000   127.27922      200            200            0.0047509464   4.2622648e-39  0              0.014252839    1.0946369e-19  0              5.2856096e-13  2.6109412e-16  0              3.45541      
   3000000   127.27922      200            200            0.0047509464   6.9420586e-39  0              0.014252839    1.4071828e-22  0              6.7947821e-16  2.6109412e-16  0              3.45541      
Loop time of 69.349 on 4 procs for 3000000 steps with 51 atoms

Performance: 37376153.037 ns/day, 0.000 hours/ns, 43259.436 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29496    | 1.2525     | 4.0822     | 146.0 |  1.81
Neigh   | 0.042419   | 0.044286   | 0.047144   |   0.9 |  0.06
Comm    | 30.022     | 37.552     | 43.871     |  93.3 | 54.15
Output  | 0.0979     | 0.098085   | 0.098253   |   0.0 |  0.14
Modify  | 14.725     | 21.599     | 29.939     | 145.5 | 31.15
Other   |            | 8.803      |            |       | 12.69

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.93                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.9196030849932
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.03
  ghost atom cutoff = 4.03
  binsize = 2.015, bins = 64 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.48 | 16.95 | 18.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00022829177 -4.8379932e-39  0             -0.00068487531  12566.43       0              6.0678794e+10  2.6109412e-16  0              3.5317032    
    200000   127.27922      200            200           -0.00029210847  4.8430615e-38  0             -0.00087632542  409.76084      0              1.9785884e+09  2.6109412e-16  0              3.608067     
    300000   127.27922      200            200            3.6841332e-05 -1.511445e-37   0              0.000110524    4.7986992      0              23171201       2.6109412e-16  0              3.5021808    
    400000   127.27922      200            200            1.250164e-05   2.7736135e-38  0              3.7504921e-05  0.58130445     0              2806911.2      2.6109412e-16  0              3.4699083    
    500000   127.27922      200            200            0.0054356565  -4.3955328e-38  0              0.016306969    22.180704      0              1.0710268e+08  2.6109412e-16  0              3.4599397    
    600000   127.27922      200            200            0.0034370298  -3.4491213e-36  0              0.01031109     0.48139482     0              2324483.3      2.6109412e-16  0              3.4612985    
    700000   127.27922      200            200            0.0047121778  -1.9502053e-38  0              0.014136533    0.41813295     0              2019014.4      2.6109412e-16  0              3.460448     
    800000   127.27922      200            200            0.0049477599  -1.9004442e-36  0              0.01484328     0.0059154403   0              28563.544      2.6109412e-16  0              3.4602895    
    900000   127.27922      200            200            0.0047073951   2.0549926e-37  0              0.014122185    0.0041778187   0              20173.191      2.6109412e-16  0              3.4604435    
   1000000   127.27922      200            200            0.00474726     1.3516251e-37  0              0.01424178     0.00087934137  0              4246.0248      2.6109412e-16  0              3.4604188    
   1100000   127.27922      200            200            0.0047678007  -3.7506624e-38  0              0.014303402    1.1275696e-08  0              0.0544463      2.6109412e-16  0              3.4604053    
   1200000   127.27922      200            200            0.0047562697  -1.5385987e-38  0              0.014268809    1.5855668e-05  0              76.561347      2.6109412e-16  0              3.4604127    
   1300000   127.27922      200            200            0.0047569378   2.1087957e-38  0              0.014270813    1.4509519e-06  0              7.0061274      2.6109412e-16  0              3.4604123    
   1400000   127.27922      200            200            0.0047582983   4.5563322e-41  0              0.014274895    3.1980646e-08  0              0.1544231      2.6109412e-16  0              3.4604114    
   1500000   127.27922      200            200            0.0047578012  -3.4651733e-39  0              0.014273404    4.6854601e-08  0              0.2262441      2.6109412e-16  0              3.4604117    
   1600000   127.27922      200            200            0.0047577657   2.1312166e-40  0              0.014273297    1.6401061e-09  0              0.0079194853   2.6109412e-16  0              3.4604117    
   1700000   127.27922      200            200            0.0047578436   2.5689443e-40  0              0.014273531    2.9541111e-10  0              0.0014264345   2.6109412e-16  0              3.4604117    
   1800000   127.27922      200            200            0.0047578251   5.8158949e-39  0              0.014273475    1.1273354e-10  0              0.00054434991  2.6109412e-16  0              3.4604117    
   1900000   127.27922      200            200            0.0047578201   5.2080157e-40  0              0.01427346     7.1844033e-13  0              3.4690912e-06  2.6109412e-16  0              3.4604117    
   2000000   127.27922      200            200            0.0047578241   1.9287449e-39  0              0.014273472    1.400714e-12   0              6.7635464e-06  2.6109412e-16  0              3.4604117    
   2100000   127.27922      200            200            0.0047578236   2.1792793e-39  0              0.014273471    2.194231e-13   0              1.0595156e-06  2.6109412e-16  0              3.4604117    
   2200000   127.27922      200            200            0.0047578232  -1.1471906e-39  0              0.01427347     4.0234001e-16  0              1.9427559e-09  2.6109412e-16  0              3.4604117    
   2300000   127.27922      200            200            0.0047578234   1.0314375e-39  0              0.01427347     4.8167208e-15  0              2.3258221e-08  2.6109412e-16  0              3.4604117    
   2400000   127.27922      200            200            0.0047578234   8.5077898e-40  0              0.01427347     3.2119413e-16  0              1.5509315e-09  2.6109412e-16  0              3.4604117    
   2500000   127.27922      200            200            0.0047578234   3.1567933e-39  0              0.01427347     1.786289e-17   0              8.6253503e-11  2.6109412e-16  0              3.4604117    
   2600000   127.27922      200            200            0.0047578234  -3.5463287e-39  0              0.01427347     1.3330146e-17  0              6.4366504e-11  2.6109412e-16  0              3.4604117    
   2700000   127.27922      200            200            0.0047578234   6.166859e-39   0              0.01427347     8.6644028e-19  0              4.18373e-12    2.6109412e-16  0              3.4604117    
   2800000   127.27922      200            200            0.0047578234  -1.5935521e-39  0              0.01427347     3.5267087e-21  0              1.7029214e-14  2.6109412e-16  0              3.4604117    
   2900000   127.27922      200            200            0.0047578234   8.8878882e-39  0              0.01427347     1.356683e-19   0              6.5509366e-13  2.6109412e-16  0              3.4604117    
   3000000   127.27922      200            200            0.0047578234  -3.5412394e-39  0              0.01427347     3.1630621e-21  0              1.5273295e-14  2.6109412e-16  0              3.4604117    
Loop time of 69.1008 on 4 procs for 3000000 steps with 51 atoms

Performance: 37510398.759 ns/day, 0.000 hours/ns, 43414.813 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29084    | 1.169      | 3.7576     | 138.2 |  1.69
Neigh   | 0.04167    | 0.043209   | 0.045804   |   0.8 |  0.06
Comm    | 29.923     | 37.428     | 43.588     |  93.6 | 54.16
Output  | 0.19485    | 0.19506    | 0.19526    |   0.0 |  0.28
Modify  | 14.7       | 21.521     | 29.803     | 144.6 | 31.14
Other   |            | 8.744      |            |       | 12.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.94                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.4546997755443
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.04
  ghost atom cutoff = 4.04
  binsize = 2.02, bins = 64 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.48 | 16.95 | 18.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.0002427426  -2.4201817e-39  0             -0.00072822781  12404.004      0              5.9894498e+10  2.6109412e-16  0              3.5418152    
    200000   127.27922      200            200           -0.00028385068 -7.7412857e-38  0             -0.00085155203  380.18938      0              1.8357984e+09  2.6109412e-16  0              3.6143113    
    300000   127.27922      200            200            5.0677953e-05  5.4415027e-37  0              0.00015203386  8.9319603      0              43129240       2.6109412e-16  0              3.5069778    
    400000   127.27922      200            200            2.7425482e-05 -1.5266142e-36  0              8.2276447e-05  2.7282516      0              13173751       2.6109412e-16  0              3.4748086    
    500000   127.27922      200            200            0.0046516139   7.5795249e-37  0              0.013954842    22.805709      0              1.1012061e+08  2.6109412e-16  0              3.4654377    
    600000   127.27922      200            200            0.0033626664  -4.6841358e-36  0              0.010087999    0.11953911     0              577211.57      2.6109412e-16  0              3.4663608    
    700000   127.27922      200            200            0.0048455734  -3.2471729e-37  0              0.01453672     0.41254052     0              1992010.5      2.6109412e-16  0              3.4653684    
    800000   127.27922      200            200            0.004931899   -1.8967895e-36  0              0.014795697    0.017111175    0              82623.742      2.6109412e-16  0              3.4653053    
    900000   127.27922      200            200            0.0047017952   9.1636466e-38  0              0.014105386    0.0021476514   0              10370.24       2.6109412e-16  0              3.4654534    
   1000000   127.27922      200            200            0.0047616919   1.0137436e-38  0              0.014285076    0.0010271866   0              4959.9163      2.6109412e-16  0              3.4654157    
   1100000   127.27922      200            200            0.0047741531   1.1006885e-38  0              0.014322459    1.3696283e-05  0              66.134447      2.6109412e-16  0              3.4654073    
   1200000   127.27922      200            200            0.0047621616  -2.9721806e-38  0              0.014286485    1.0142711e-05  0              48.97552       2.6109412e-16  0              3.465415     
   1300000   127.27922      200            200            0.0047642121  -4.4757914e-39  0              0.014292636    2.2281718e-06  0              10.759044      2.6109412e-16  0              3.4654137    
   1400000   127.27922      200            200            0.0047651959   2.9212811e-40  0              0.014295588    1.1517178e-09  0              0.0055612332   2.6109412e-16  0              3.4654131    
   1500000   127.27922      200            200            0.004764612   -1.0820414e-39  0              0.014293836    3.6645739e-08  0              0.17694916     2.6109412e-16  0              3.4654134    
   1600000   127.27922      200            200            0.0047646608  -1.0639423e-39  0              0.014293982    4.1238789e-09  0              0.019912736    2.6109412e-16  0              3.4654134    
   1700000   127.27922      200            200            0.0047647246   1.8986002e-40  0              0.014294174    3.4850342e-11  0              0.00016827983  2.6109412e-16  0              3.4654134    
   1800000   127.27922      200            200            0.0047646981  -3.061717e-40   0              0.014294094    1.108585e-10   0              0.00053529601  2.6109412e-16  0              3.4654134    
   1900000   127.27922      200            200            0.0047646977  -6.2136576e-39  0              0.014294093    6.1531964e-12  0              2.9711583e-05  2.6109412e-16  0              3.4654134    
   2000000   127.27922      200            200            0.0047647014   3.0426739e-41  0              0.014294104    4.2539912e-13  0              2.0541001e-06  2.6109412e-16  0              3.4654134    
   2100000   127.27922      200            200            0.0047647003  -2.1463693e-39  0              0.014294101    2.903289e-13   0              1.4018943e-06  2.6109412e-16  0              3.4654134    
   2200000   127.27922      200            200            0.0047647002   1.7832064e-39  0              0.0142941      6.3405776e-15  0              3.061638e-08   2.6109412e-16  0              3.4654134    
   2300000   127.27922      200            200            0.0047647004   3.3490441e-39  0              0.014294101    2.32444e-15    0              1.1223889e-08  2.6109412e-16  0              3.4654134    
   2400000   127.27922      200            200            0.0047647003   1.3400533e-40  0              0.014294101    6.6201937e-16  0              3.1966546e-09  2.6109412e-16  0              3.4654134    
   2500000   127.27922      200            200            0.0047647003  -3.0160398e-39  0              0.014294101    1.7493119e-18  0              8.4468013e-12  2.6109412e-16  0              3.4654134    
   2600000   127.27922      200            200            0.0047647003  -4.2811693e-39  0              0.014294101    9.1520758e-18  0              4.4192098e-11  2.6109412e-16  0              3.4654134    
   2700000   127.27922      200            200            0.0047647003   3.0009106e-39  0              0.014294101    1.7188982e-18  0              8.299944e-12   2.6109412e-16  0              3.4654134    
   2800000   127.27922      200            200            0.0047647003   4.9138624e-39  0              0.014294101    8.2606344e-20  0              3.9887647e-13  2.6109412e-16  0              3.4654134    
   2900000   127.27922      200            200            0.0047647003   8.1205353e-39  0              0.014294101    2.5456676e-20  0              1.2292118e-13  2.6109412e-16  0              3.4654134    
   3000000   127.27922      200            200            0.0047647003   5.2099674e-40  0              0.014294101    8.1677236e-20  0              3.9439014e-13  2.6109412e-16  0              3.4654134    
Loop time of 69.2379 on 4 procs for 3000000 steps with 51 atoms

Performance: 37436143.381 ns/day, 0.000 hours/ns, 43328.870 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29136    | 1.1575     | 3.7121     | 137.1 |  1.67
Neigh   | 0.040048   | 0.041411   | 0.043828   |   0.8 |  0.06
Comm    | 30.04      | 37.62      | 43.805     |  94.2 | 54.33
Output  | 0.075933   | 0.076103   | 0.076247   |   0.0 |  0.11
Modify  | 14.738     | 21.617     | 29.964     | 145.5 | 31.22
Other   |            | 8.726      |            |       | 12.60

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.95                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.9925195986076
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.05
  ghost atom cutoff = 4.05
  binsize = 2.025, bins = 63 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.44 | 16.9 | 18.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00025696413  3.3897921e-38  0             -0.0007708924   12242.733      0              5.9115775e+10  2.6109412e-16  0              3.5518966    
    200000   127.27922      200            200           -0.00027540807  2.4220015e-39  0             -0.00082622422  351.75113      0              1.6984803e+09  2.6109412e-16  0              3.6205078    
    300000   127.27922      200            200            6.46994e-05    3.8858316e-37  0              0.0001940982   14.331621      0              69202269       2.6109412e-16  0              3.5117131    
    400000   127.27922      200            200            4.257144e-05  -1.215459e-36   0              0.00012771432  6.4494224      0              31141953       2.6109412e-16  0              3.4796331    
    500000   127.27922      200            200            0.0039119049  -1.0193759e-36  0              0.011735715    21.751494      0              1.0503018e+08  2.6109412e-16  0              3.4709338    
    600000   127.27922      200            200            0.0033457981   3.9704197e-36  0              0.010037394    0.00025209943  0              1217.2979      2.6109412e-16  0              3.4713821    
    700000   127.27922      200            200            0.0049758127   1.4481338e-37  0              0.014927438    0.36379689     0              1756645        2.6109412e-16  0              3.4702913    
    800000   127.27922      200            200            0.0049054121  -2.521289e-37   0              0.014716236    0.031067593    0              150014.29      2.6109412e-16  0              3.4703278    
    900000   127.27922      200            200            0.0047007475  -2.1728057e-37  0              0.014102242    0.00061252189  0              2957.649       2.6109412e-16  0              3.4704603    
   1000000   127.27922      200            200            0.0047763804  -4.3799339e-38  0              0.014329141    0.0010101609   0              4877.7057      2.6109412e-16  0              3.4704123    
   1100000   127.27922      200            200            0.004779616    5.3534109e-39  0              0.014338848    4.8117184e-05  0              232.34066      2.6109412e-16  0              3.4704098    
   1200000   127.27922      200            200            0.004768322    1.7969913e-38  0              0.014304966    4.2193712e-06  0              20.373834      2.6109412e-16  0              3.4704171    
   1300000   127.27922      200            200            0.0047715439  -4.091141e-39   0              0.014314632    2.572426e-06   0              12.421325      2.6109412e-16  0              3.4704151    
   1400000   127.27922      200            200            0.0047720286  -4.4083181e-40  0              0.014316086    5.831724e-08   0              0.28159308     2.6109412e-16  0              3.4704148    
   1500000   127.27922      200            200            0.0047714356  -8.1099039e-41  0              0.014314307    1.9273207e-08  0              0.093063421    2.6109412e-16  0              3.4704152    
   1600000   127.27922      200            200            0.0047715621   1.0632179e-39  0              0.014314686    6.0286172e-09  0              0.029110035    2.6109412e-16  0              3.4704151    
   1700000   127.27922      200            200            0.0047716014   4.5002752e-40  0              0.014314804    4.0467174e-11  0              0.0001954015   2.6109412e-16  0              3.470415     
   1800000   127.27922      200            200            0.0047715715   3.5253348e-39  0              0.014314715    7.1346772e-11  0              0.00034450803  2.6109412e-16  0              3.4704151    
   1900000   127.27922      200            200            0.0047715759   4.8147877e-39  0              0.014314728    1.2935875e-11  0              6.246271e-05   2.6109412e-16  0              3.4704151    
   2000000   127.27922      200            200            0.0047715785   3.1215654e-39  0              0.014314735    4.7584753e-16  0              2.2976974e-09  2.6109412e-16  0              3.4704151    
   2100000   127.27922      200            200            0.0047715771  -1.5502316e-39  0              0.014314731    2.3005599e-13  0              1.1108581e-06  2.6109412e-16  0              3.4704151    
   2200000   127.27922      200            200            0.0047715772  -1.936439e-39   0              0.014314732    2.5073336e-14  0              1.2107017e-07  2.6109412e-16  0              3.4704151    
   2300000   127.27922      200            200            0.0047715773   2.5718076e-39  0              0.014314732    1.8098401e-16  0              8.7390701e-10  2.6109412e-16  0              3.4704151    
   2400000   127.27922      200            200            0.0047715773   5.3200637e-39  0              0.014314732    6.6695549e-16  0              3.2204894e-09  2.6109412e-16  0              3.4704151    
   2500000   127.27922      200            200            0.0047715773   2.6801763e-39  0              0.014314732    4.2762374e-17  0              2.064842e-10   2.6109412e-16  0              3.4704151    
   2600000   127.27922      200            200            0.0047715773  -1.0186159e-38  0              0.014314732    1.7077013e-18  0              8.2458784e-12  2.6109412e-16  0              3.4704151    
   2700000   127.27922      200            200            0.0047715773   2.4354942e-39  0              0.014314732    1.3871889e-18  0              6.6982387e-12  2.6109412e-16  0              3.4704151    
   2800000   127.27922      200            200            0.0047715773  -1.8189107e-39  0              0.014314732    2.4438445e-19  0              1.1800451e-12  2.6109412e-16  0              3.4704151    
   2900000   127.27922      200            200            0.0047715773   5.5024385e-39  0              0.014314732    1.6692094e-21  0              8.0600148e-15  2.6109412e-16  0              3.4704151    
   3000000   127.27922      200            200            0.0047715773   7.991627e-40   0              0.014314732    1.5053644e-19  0              7.2688661e-13  2.6109412e-16  0              3.4704151    
Loop time of 69.2747 on 4 procs for 3000000 steps with 51 atoms

Performance: 37416247.304 ns/day, 0.000 hours/ns, 43305.842 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29317    | 1.1936     | 3.8586     | 140.8 |  1.72
Neigh   | 0.036974   | 0.038098   | 0.040218   |   0.7 |  0.05
Comm    | 30.076     | 37.611     | 43.88      |  93.7 | 54.29
Output  | 0.079061   | 0.079318   | 0.079552   |   0.1 |  0.11
Modify  | 14.706     | 21.594     | 29.96      | 146.1 | 31.17
Other   |            | 8.758      |            |       | 12.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.96                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 71.5330694656869
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.06
  ghost atom cutoff = 4.06
  binsize = 2.03, bins = 63 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.44 | 16.9 | 18.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00027095686 -2.4208994e-38  0             -0.00081287059  12082.615      0              5.8342623e+10  2.6109412e-16  0              3.5619474    
    200000   127.27922      200            200           -0.00026678187 -1.161771e-37   0             -0.00080034562  324.44377      0              1.5666229e+09  2.6109412e-16  0              3.6266565    
    300000   127.27922      200            200            7.8903724e-05 -5.4112257e-37  0              0.00023671117  20.992741      0              1.0136644e+08  2.6109412e-16  0              3.5163866    
    400000   127.27922      200            200            5.7936601e-05  9.5400458e-37  0              0.0001738098   11.736612      0              56671899       2.6109412e-16  0              3.4843816    
    500000   127.27922      200            200            0.0032434581  -5.9058091e-36  0              0.0097303743   19.256244      0              92981513       2.6109412e-16  0              3.4764103    
    600000   127.27922      200            200            0.0033871858  -1.4657449e-35  0              0.010161557    0.1415618      0              683551.29      2.6109412e-16  0              3.4763614    
    700000   127.27922      200            200            0.0050959463   1.8005938e-36  0              0.015287839    0.2820415      0              1361877.4      2.6109412e-16  0              3.4752212    
    800000   127.27922      200            200            0.0048704676   4.4618252e-37  0              0.014611403    0.044267756    0              213753.15      2.6109412e-16  0              3.4753558    
    900000   127.27922      200            200            0.0047048234  -2.5283544e-37  0              0.01411447     2.03047e-06    0              9.804413       2.6109412e-16  0              3.475464     
   1000000   127.27922      200            200            0.0047906766  -4.7563512e-39  0              0.01437203     0.00083415257  0              4027.8242      2.6109412e-16  0              3.4754092    
   1100000   127.27922      200            200            0.0047843228   6.5728564e-39  0              0.014352968    9.0457393e-05  0              436.78638      2.6109412e-16  0              3.4754129    
   1200000   127.27922      200            200            0.0047748262   1.8539789e-38  0              0.014324479    5.0497664e-07  0              2.4383515      2.6109412e-16  0              3.475419     
   1300000   127.27922      200            200            0.0047788796   4.4133304e-40  0              0.014336639    2.3280367e-06  0              11.241256      2.6109412e-16  0              3.4754165    
   1400000   127.27922      200            200            0.0047788022   1.1026633e-39  0              0.014336407    1.7365501e-07  0              0.83851792     2.6109412e-16  0              3.4754165    
   1500000   127.27922      200            200            0.0047782797   1.6600158e-39  0              0.014334839    4.4082784e-09  0              0.021285998    2.6109412e-16  0              3.4754168    
   1600000   127.27922      200            200            0.0047784658   2.2195676e-39  0              0.014335397    6.1953491e-09  0              0.029915124    2.6109412e-16  0              3.4754167    
   1700000   127.27922      200            200            0.0047784739  -1.6699857e-40  0              0.014335422    3.0533026e-10  0              0.0014743306   2.6109412e-16  0              3.4754167    
   1800000   127.27922      200            200            0.004778446   -6.8775746e-40  0              0.014335338    2.2826186e-11  0              0.00011021948  2.6109412e-16  0              3.4754167    
   1900000   127.27922      200            200            0.0047784543   3.0597152e-39  0              0.014335363    1.5765582e-11  0              7.6126351e-05  2.6109412e-16  0              3.4754167    
   2000000   127.27922      200            200            0.0047784553  -4.07626e-40    0              0.014335366    4.7353329e-13  0              2.2865228e-06  2.6109412e-16  0              3.4754167    
   2100000   127.27922      200            200            0.0047784538   1.6222898e-39  0              0.014335362    9.3590077e-14  0              4.5191299e-07  2.6109412e-16  0              3.4754167    
   2200000   127.27922      200            200            0.0047784542  -5.3331351e-40  0              0.014335363    3.8416874e-14  0              1.8550134e-07  2.6109412e-16  0              3.4754167    
   2300000   127.27922      200            200            0.0047784543  -3.8440949e-39  0              0.014335363    5.9537455e-16  0              2.8748507e-09  2.6109412e-16  0              3.4754167    
   2400000   127.27922      200            200            0.0047784542   1.3775937e-39  0              0.014335363    3.3060116e-16  0              1.5963547e-09  2.6109412e-16  0              3.4754167    
   2500000   127.27922      200            200            0.0047784542   4.2406691e-39  0              0.014335363    9.0705268e-17  0              4.3798328e-10  2.6109412e-16  0              3.4754167    
   2600000   127.27922      200            200            0.0047784542  -3.1192576e-39  0              0.014335363    7.8206704e-19  0              3.7763219e-12  2.6109412e-16  0              3.4754167    
   2700000   127.27922      200            200            0.0047784542  -1.1908382e-40  0              0.014335363    3.2022181e-19  0              1.5462365e-12  2.6109412e-16  0              3.4754167    
   2800000   127.27922      200            200            0.0047784542   5.3772688e-39  0              0.014335363    1.7947756e-19  0              8.6663292e-13  2.6109412e-16  0              3.4754167    
   2900000   127.27922      200            200            0.0047784542  -5.4644318e-40  0              0.014335363    6.8981788e-22  0              3.3308837e-15  2.6109412e-16  0              3.4754167    
   3000000   127.27922      200            200            0.0047784542   3.2989957e-39  0              0.014335363    1.5053835e-19  0              7.2689583e-13  2.6109412e-16  0              3.4754167    
Loop time of 69.0802 on 4 procs for 3000000 steps with 51 atoms

Performance: 37521619.397 ns/day, 0.000 hours/ns, 43427.800 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28711    | 1.1777     | 3.7977     | 139.4 |  1.70
Neigh   | 0.037087   | 0.038978   | 0.041902   |   1.0 |  0.06
Comm    | 29.981     | 37.485     | 43.695     |  93.5 | 54.26
Output  | 0.075418   | 0.075623   | 0.075812   |   0.1 |  0.11
Modify  | 14.731     | 21.567     | 29.878     | 144.9 | 31.22
Other   |            | 8.736      |            |       | 12.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.97                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.076356288286
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.07
  ghost atom cutoff = 4.07
  binsize = 2.035, bins = 63 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.44 | 16.9 | 18.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00028472164  3.9106329e-38  0             -0.00085416491  11923.645      0              5.7575015e+10  2.6109412e-16  0              3.5719675    
    200000   127.27922      200            200           -0.00025797256 -3.869669e-38   0             -0.00077391769  298.26279      0              1.4402043e+09  2.6109412e-16  0              3.6327574    
    300000   127.27922      200            200            9.3290894e-05 -3.0845037e-37  0              0.00027987268  28.911342      0              1.3960252e+08  2.6109412e-16  0              3.5209983    
    400000   127.27922      200            200            7.3520839e-05 -3.076666e-36   0              0.00022056252  18.582678      0              89729102       2.6109412e-16  0              3.4890541    
    500000   127.27922      200            200            0.0026648958  -4.1902335e-37  0              0.0079946873   15.739834      0              76002027       2.6109412e-16  0              3.4818507    
    600000   127.27922      200            200            0.0034861868   8.9303483e-36  0              0.01045856     0.5192787      0              2507411        2.6109412e-16  0              3.4812996    
    700000   127.27922      200            200            0.0051993827  -2.5374732e-36  0              0.015598148    0.18471356     0              891915.66      2.6109412e-16  0              3.480162     
    800000   127.27922      200            200            0.0048297668  -2.7857407e-37  0              0.0144893      0.053409572    0              257895.71      2.6109412e-16  0              3.4803876    
    900000   127.27922      200            200            0.0047142288   1.3367676e-37  0              0.014142686    0.00048144096  0              2324.7061      2.6109412e-16  0              3.4804642    
   1000000   127.27922      200            200            0.0048039631   9.9498262e-38  0              0.014411889    0.0005565922   0              2687.5846      2.6109412e-16  0              3.4804067    
   1100000   127.27922      200            200            0.0047884779   2.3238193e-39  0              0.014365434    0.00012509301  0              604.02936      2.6109412e-16  0              3.4804163    
   1200000   127.27922      200            200            0.0047817135   9.3409584e-39  0              0.01434514     4.9470795e-07  0              2.3887677      2.6109412e-16  0              3.4804207    
   1300000   127.27922      200            200            0.004786165    5.8349209e-40  0              0.014358495    1.609054e-06   0              7.7695457      2.6109412e-16  0              3.4804179    
   1400000   127.27922      200            200            0.0047855303  -2.7358361e-39  0              0.014356591    2.8829183e-07  0              1.3920581      2.6109412e-16  0              3.4804183    
   1500000   127.27922      200            200            0.0047851489   2.1892196e-39  0              0.014355447    2.3500421e-10  0              0.0011347512   2.6109412e-16  0              3.4804185    
   1600000   127.27922      200            200            0.0047853676   2.7620832e-39  0              0.014356103    4.5320421e-09  0              0.021883609    2.6109412e-16  0              3.4804184    
   1700000   127.27922      200            200            0.0047853431   1.0248395e-39  0              0.014356029    6.5120565e-10  0              0.003144439    2.6109412e-16  0              3.4804184    
   1800000   127.27922      200            200            0.004785322   -6.5746023e-41  0              0.014355966    4.9834242e-14  0              2.4063172e-07  2.6109412e-16  0              3.4804184    
   1900000   127.27922      200            200            0.0047853327  -2.938355e-39   0              0.014355998    1.2468262e-11  0              6.0204775e-05  2.6109412e-16  0              3.4804184    
   2000000   127.27922      200            200            0.0047853318   2.1094023e-39  0              0.014355995    1.4386376e-12  0              6.9466662e-06  2.6109412e-16  0              3.4804184    
   2100000   127.27922      200            200            0.0047853307  -1.8702011e-39  0              0.014355992    3.6204427e-15  0              1.7481822e-08  2.6109412e-16  0              3.4804184    
   2200000   127.27922      200            200            0.0047853312   3.2831035e-39  0              0.014355994    3.3586086e-14  0              1.6217519e-07  2.6109412e-16  0              3.4804184    
   2300000   127.27922      200            200            0.0047853312   2.1055503e-41  0              0.014355994    3.1022463e-15  0              1.4979637e-08  2.6109412e-16  0              3.4804184    
   2400000   127.27922      200            200            0.0047853311  -2.5739606e-39  0              0.014355993    2.8159321e-17  0              1.3597128e-10  2.6109412e-16  0              3.4804184    
   2500000   127.27922      200            200            0.0047853311  -1.471793e-39   0              0.014355993    8.7958445e-17  0              4.2471985e-10  2.6109412e-16  0              3.4804184    
   2600000   127.27922      200            200            0.0047853311  -9.0505826e-40  0              0.014355993    7.3983235e-18  0              3.5723857e-11  2.6109412e-16  0              3.4804184    
   2700000   127.27922      200            200            0.0047853311   4.5780084e-39  0              0.014355993    5.0450371e-20  0              2.4360679e-13  2.6109412e-16  0              3.4804184    
   2800000   127.27922      200            200            0.0047853311  -3.1757349e-39  0              0.014355993    3.0555228e-20  0              1.4754026e-13  2.6109412e-16  0              3.4804184    
   2900000   127.27922      200            200            0.0047853311  -8.424488e-39   0              0.014355993    5.2197409e-20  0              2.5204261e-13  2.6109412e-16  0              3.4804184    
   3000000   127.27922      200            200            0.0047853311  -5.7155832e-39  0              0.014355993    1.4360026e-20  0              6.9339429e-14  2.6109412e-16  0              3.4804184    
Loop time of 68.4414 on 4 procs for 3000000 steps with 51 atoms

Performance: 37871819.844 ns/day, 0.000 hours/ns, 43833.125 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29823    | 1.2064     | 3.899      | 141.5 |  1.76
Neigh   | 0.035948   | 0.03739    | 0.03969    |   0.8 |  0.05
Comm    | 29.573     | 37.01      | 43.188     |  92.7 | 54.08
Output  | 0.075546   | 0.075782   | 0.075991   |   0.1 |  0.11
Modify  | 14.625     | 21.406     | 29.653     | 144.0 | 31.28
Other   |            | 8.706      |            |       | 12.72

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.98                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.6223869779087
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.08
  ghost atom cutoff = 4.08
  binsize = 2.04, bins = 63 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.44 | 16.9 | 18.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00029825901 -1.2104052e-39  0             -0.00089477703  11765.822      0              5.6812946e+10  2.6109412e-16  0              3.5819569    
    200000   127.27922      200            200           -0.00024898135  1.1909599e-41  0             -0.00074694404  273.20587      0              1.3192134e+09  2.6109412e-16  0              3.6388102    
    300000   127.27922      200            200            0.00010785846 -5.4128163e-37  0              0.00032357539  38.08225       0              1.8388556e+08  2.6109412e-16  0              3.525548     
    400000   127.27922      200            200            8.9320426e-05 -5.9858744e-37  0              0.00026796128  26.979132      0              1.3027257e+08  2.6109412e-16  0              3.4936506    
    500000   127.27922      200            200            0.0021868358  -2.3414711e-36  0              0.0065605075   11.720181      0              56592558       2.6109412e-16  0              3.487241     
    600000   127.27922      200            200            0.0036406293   1.4538659e-36  0              0.010921888    1.0701954      0              5167590.7      2.6109412e-16  0              3.4861994    
    700000   127.27922      200            200            0.0052803085  -1.5998791e-36  0              0.015840925    0.092870205    0              448436.98      2.6109412e-16  0              3.4851169    
    800000   127.27922      200            200            0.0047863675   1.9221993e-37  0              0.014359103    0.056226589    0              271498.08      2.6109412e-16  0              3.4854213    
    900000   127.27922      200            200            0.0047287895  -1.0054968e-37  0              0.014186369    0.001906088    0              9203.8168      2.6109412e-16  0              3.485461     
   1000000   127.27922      200            200            0.0048157047   2.0390714e-38  0              0.014447114    0.00026763431  0              1292.3103      2.6109412e-16  0              3.4854052    
   1100000   127.27922      200            200            0.0047923376  -2.897465e-39   0              0.014377013    0.00013932391  0              672.74529      2.6109412e-16  0              3.4854198    
   1200000   127.27922      200            200            0.0047889822  -8.6009977e-39  0              0.014366947    4.1556732e-06  0              20.066259      2.6109412e-16  0              3.4854221    
   1300000   127.27922      200            200            0.0047933522  -8.7417162e-40  0              0.014380057    7.4481264e-07  0              3.5964337      2.6109412e-16  0              3.4854193    
   1400000   127.27922      200            200            0.0047922325  -2.8668075e-39  0              0.014376698    3.4424119e-07  0              1.6622175      2.6109412e-16  0              3.48542      
   1500000   127.27922      200            200            0.0047920444   1.2846972e-40  0              0.014376133    8.9378006e-09  0              0.043157441    2.6109412e-16  0              3.4854201    
   1600000   127.27922      200            200            0.0047922637   2.1574473e-39  0              0.014376791    2.0562566e-09  0              0.009928927    2.6109412e-16  0              3.48542      
   1700000   127.27922      200            200            0.0047922102   6.4501582e-41  0              0.014376631    8.4834018e-10  0              0.0040963311   2.6109412e-16  0              3.48542      
   1800000   127.27922      200            200            0.0047921998  -7.7498441e-39  0              0.014376599    1.8960333e-11  0              9.155266e-05   2.6109412e-16  0              3.48542      
   1900000   127.27922      200            200            0.0047922108   2.6277675e-39  0              0.014376632    5.6316832e-12  0              2.7193383e-05  2.6109412e-16  0              3.48542      
   2000000   127.27922      200            200            0.0047922082  -2.623654e-40   0              0.014376625    2.0850793e-12  0              1.0068102e-05  2.6109412e-16  0              3.48542      
   2100000   127.27922      200            200            0.0047922076  -1.8958431e-39  0              0.014376623    3.9570375e-14  0              1.9107118e-07  2.6109412e-16  0              3.48542      
   2200000   127.27922      200            200            0.0047922082   1.5162546e-40  0              0.014376625    1.5311417e-14  0              7.3933351e-08  2.6109412e-16  0              3.48542      
   2300000   127.27922      200            200            0.0047922081  -3.1950339e-39  0              0.014376624    5.1102448e-15  0              2.4675543e-08  2.6109412e-16  0              3.48542      
   2400000   127.27922      200            200            0.004792208    3.8040278e-39  0              0.014376624    8.0485547e-17  0              3.886359e-10   2.6109412e-16  0              3.48542      
   2500000   127.27922      200            200            0.0047922081   2.9945305e-39  0              0.014376624    4.150789e-17   0              2.0042675e-10  2.6109412e-16  0              3.48542      
   2600000   127.27922      200            200            0.0047922081   2.8539602e-39  0              0.014376624    1.2783667e-17  0              6.1727752e-11  2.6109412e-16  0              3.48542      
   2700000   127.27922      200            200            0.0047922081  -1.455765e-39   0              0.014376624    8.0830891e-19  0              3.9030345e-12  2.6109412e-16  0              3.48542      
   2800000   127.27922      200            200            0.0047922081  -7.5093188e-39  0              0.014376624    5.2721186e-21  0              2.5457174e-14  2.6109412e-16  0              3.48542      
   2900000   127.27922      200            200            0.0047922081   7.0925253e-39  0              0.014376624    1.041176e-19   0              5.0274662e-13  2.6109412e-16  0              3.48542      
   3000000   127.27922      200            200            0.0047922081  -1.2242149e-39  0              0.014376624    7.6368213e-21  0              3.6875477e-14  2.6109412e-16  0              3.48542      
Loop time of 69.1478 on 4 procs for 3000000 steps with 51 atoms

Performance: 37484903.300 ns/day, 0.000 hours/ns, 43385.305 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29145    | 1.2005     | 3.8809     | 141.2 |  1.74
Neigh   | 0.040231   | 0.041924   | 0.044538   |   0.9 |  0.06
Comm    | 30.082     | 37.542     | 43.784     |  92.7 | 54.29
Output  | 0.076236   | 0.076505   | 0.076792   |   0.1 |  0.11
Modify  | 14.686     | 21.521     | 29.845     | 145.3 | 31.12
Other   |            | 8.765      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.99                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 73.171168446059
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.09
  ghost atom cutoff = 4.09
  binsize = 2.045, bins = 63 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.44 | 16.9 | 18.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00031156955  4.8425946e-39  0             -0.00093470866  11609.145      0              5.6056408e+10  2.6109412e-16  0              3.5919156    
    200000   127.27922      200            200           -0.00023980909  1.4531329e-38  0             -0.00071942727  249.26972      0              1.2036343e+09  2.6109412e-16  0              3.644815     
    300000   127.27922      200            200            0.00012260564 -3.8624235e-37  0              0.00036781693  48.501205      0              2.3419496e+08  2.6109412e-16  0              3.5300357    
    400000   127.27922      200            200            0.00010533439 -9.0808288e-37  0              0.00031600317  36.918736      0              1.7826736e+08  2.6109412e-16  0              3.4981708    
    500000   127.27922      200            200            0.0018126839   3.2605473e-36  0              0.0054380518   7.7296616      0              37323769       2.6109412e-16  0              3.4925693    
    600000   127.27922      200            200            0.0038465873  -4.5297174e-37  0              0.011539762    1.7011376      0              8214184.6      2.6109412e-16  0              3.4910649    
    700000   127.27922      200            200            0.0053341483  -5.839205e-38   0              0.016002445    0.026523659    0              128073.25      2.6109412e-16  0              3.4900888    
    800000   127.27922      200            200            0.0047434654  -2.5337635e-37  0              0.014230396    0.052045214    0              251307.71      2.6109412e-16  0              3.4904548    
    900000   127.27922      200            200            0.0047479623  -3.3438797e-37  0              0.014243887    0.003863424    0              18655.092      2.6109412e-16  0              3.4904549    
   1000000   127.27922      200            200            0.0048254942   3.9498298e-38  0              0.014476483    6.0667324e-05  0              292.9408       2.6109412e-16  0              3.490405     
   1100000   127.27922      200            200            0.0047961855   9.5574418e-39  0              0.014388556    0.00012800457  0              618.08828      2.6109412e-16  0              3.4904234    
   1200000   127.27922      200            200            0.0047965909   5.9659608e-40  0              0.014389773    9.9528862e-06  0              48.058925      2.6109412e-16  0              3.4904233    
   1300000   127.27922      200            200            0.0048004048  -2.7169606e-39  0              0.014401214    1.2792955e-07  0              0.61772603     2.6109412e-16  0              3.4904208    
   1400000   127.27922      200            200            0.0047989316   3.5408885e-39  0              0.014396795    3.1357253e-07  0              1.5141295      2.6109412e-16  0              3.4904218    
   1500000   127.27922      200            200            0.0047989634   4.1770054e-40  0              0.01439689     2.5561841e-08  0              0.12342898     2.6109412e-16  0              3.4904218    
   1600000   127.27922      200            200            0.0047991509   1.5280158e-39  0              0.014397453    2.6606049e-10  0              0.0012847109   2.6109412e-16  0              3.4904216    
   1700000   127.27922      200            200            0.0047990769   1.5361181e-39  0              0.014397231    7.674384e-10   0              0.0037056854   2.6109412e-16  0              3.4904217    
   1800000   127.27922      200            200            0.0047990791   3.9840614e-39  0              0.014397237    6.5554397e-11  0              0.00031653872  2.6109412e-16  0              3.4904217    
   1900000   127.27922      200            200            0.0047990883   4.1675647e-40  0              0.014397265    5.436872e-13   0              2.6252709e-06  2.6109412e-16  0              3.4904217    
   2000000   127.27922      200            200            0.0047990845   5.2729688e-40  0              0.014397254    1.8766105e-12  0              9.0614804e-06  2.6109412e-16  0              3.4904217    
   2100000   127.27922      200            200            0.0047990847  -3.5551836e-39  0              0.014397254    1.6789614e-13  0              8.1071039e-07  2.6109412e-16  0              3.4904217    
   2200000   127.27922      200            200            0.0047990851  -2.1424882e-39  0              0.014397255    1.0862633e-15  0              5.2451767e-09  2.6109412e-16  0              3.4904217    
   2300000   127.27922      200            200            0.004799085   -7.3276709e-41  0              0.014397255    4.5841827e-15  0              2.2135378e-08  2.6109412e-16  0              3.4904217    
   2400000   127.27922      200            200            0.004799085   -1.5814718e-39  0              0.014397255    4.3167466e-16  0              2.0844024e-09  2.6109412e-16  0              3.4904217    
   2500000   127.27922      200            200            0.004799085    1.2048135e-39  0              0.014397255    2.2018823e-18  0              1.0632101e-11  2.6109412e-16  0              3.4904217    
   2600000   127.27922      200            200            0.004799085   -2.6054641e-39  0              0.014397255    1.076705e-17   0              5.1990233e-11  2.6109412e-16  0              3.4904217    
   2700000   127.27922      200            200            0.004799085   -1.5084859e-39  0              0.014397255    1.6959048e-18  0              8.1889172e-12  2.6109412e-16  0              3.4904217    
   2800000   127.27922      200            200            0.004799085   -9.4748489e-40  0              0.014397255    1.0770082e-19  0              5.200487e-13   2.6109412e-16  0              3.4904217    
   2900000   127.27922      200            200            0.004799085    7.5555772e-39  0              0.014397255    7.1656783e-20  0              3.4600496e-13  2.6109412e-16  0              3.4904217    
   3000000   127.27922      200            200            0.004799085    1.0054189e-39  0              0.014397255    6.0891622e-20  0              2.9402385e-13  2.6109412e-16  0              3.4904217    
Loop time of 69.2751 on 4 procs for 3000000 steps with 51 atoms

Performance: 37416039.998 ns/day, 0.000 hours/ns, 43305.602 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.301      | 1.2435     | 4.037      | 144.6 |  1.80
Neigh   | 0.040583   | 0.042102   | 0.044481   |   0.8 |  0.06
Comm    | 29.852     | 37.468     | 43.804     |  93.5 | 54.09
Output  | 0.078283   | 0.078553   | 0.078811   |   0.1 |  0.11
Modify  | 14.759     | 21.637     | 30.079     | 146.1 | 31.23
Other   |            | 8.807      |            |       | 12.71

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 73.7227076042404
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.1
  ghost atom cutoff = 4.1
  binsize = 2.05, bins = 63 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.44 | 16.9 | 18.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00032465366  9.6991694e-39  0             -0.00097396097  11453.615      0              5.5305408e+10  2.6109412e-16  0              3.6018434    
    200000   127.27922      200            200           -0.00023045704 -5.8051792e-38  0             -0.00069137113  226.45197      0              1.0934555e+09  2.6109412e-16  0              3.6507715    
    300000   127.27922      200            200            0.00013753046  1.8829933e-39  0              0.00041259137  60.163147      0              2.9050631e+08  2.6109412e-16  0              3.5344611    
    400000   127.27922      200            200            0.00012155974  2.1877938e-36  0              0.00036467922  48.393129      0              2.336731e+08   2.6109412e-16  0              3.5026147    
    500000   127.27922      200            200            0.0015405576  -1.0653699e-36  0              0.0046216727   4.2494005      0              20518834       2.6109412e-16  0              3.4978263    
    600000   127.27922      200            200            0.0040980322  -2.9334883e-36  0              0.012294097    2.3028464      0              11119621       2.6109412e-16  0              3.495902     
    700000   127.27922      200            200            0.0053579091  -3.7783504e-37  0              0.016073727    0.00014598084  0              704.88924      2.6109412e-16  0              3.4950791    
    800000   127.27922      200            200            0.0047041966   1.0337261e-37  0              0.01411259     0.041934328    0              202485.86      2.6109412e-16  0              3.4954861    
    900000   127.27922      200            200            0.0047708695  -2.6940376e-38  0              0.014312608    0.0057906352   0              27960.905      2.6109412e-16  0              3.4954465    
   1000000   127.27922      200            200            0.0048330871  -1.931858e-37   0              0.014499261    1.9705214e-06  0              9.5149427      2.6109412e-16  0              3.4954061    
   1100000   127.27922      200            200            0.0048003058   2.3008927e-38  0              0.014400917    9.5365573e-05  0              460.48622      2.6109412e-16  0              3.4954268    
   1200000   127.27922      200            200            0.0048044622   1.9360775e-38  0              0.014413387    1.5489207e-05  0              74.791838      2.6109412e-16  0              3.4954243    
   1300000   127.27922      200            200            0.0048073023  -3.7576935e-39  0              0.014421907    3.5285589e-08  0              0.17038148     2.6109412e-16  0              3.4954225    
   1400000   127.27922      200            200            0.0048056507  -4.6457542e-39  0              0.014416952    2.1211243e-07  0              1.024215       2.6109412e-16  0              3.4954235    
   1500000   127.27922      200            200            0.0048058998  -2.3313045e-39  0              0.0144177      4.0829322e-08  0              0.19715018     2.6109412e-16  0              3.4954234    
   1600000   127.27922      200            200            0.0048060278  -8.5201431e-40  0              0.014418083    2.3027023e-10  0              0.0011118925   2.6109412e-16  0              3.4954233    
   1700000   127.27922      200            200            0.004805945    3.1545081e-39  0              0.014417835    4.6327699e-10  0              0.0022369988   2.6109412e-16  0              3.4954233    
   1800000   127.27922      200            200            0.0048059594  -9.963309e-40   0              0.014417878    1.0627074e-10  0              0.00051314339  2.6109412e-16  0              3.4954233    
   1900000   127.27922      200            200            0.0048059651  -1.4696692e-39  0              0.014417895    1.0840828e-12  0              5.2346477e-06  2.6109412e-16  0              3.4954233    
   2000000   127.27922      200            200            0.004805961   -3.103764e-39   0              0.014417883    9.9154927e-13  0              4.7878365e-06  2.6109412e-16  0              3.4954233    
   2100000   127.27922      200            200            0.0048059618  -2.2691605e-39  0              0.014417885    2.7324561e-13  0              1.3194053e-06  2.6109412e-16  0              3.4954233    
   2200000   127.27922      200            200            0.004805962    1.6445779e-39  0              0.014417886    4.3271712e-15  0              2.0894361e-08  2.6109412e-16  0              3.4954233    
   2300000   127.27922      200            200            0.0048059618   9.2460602e-39  0              0.014417885    2.0658362e-15  0              9.9751835e-09  2.6109412e-16  0              3.4954233    
   2400000   127.27922      200            200            0.0048059619   7.2227662e-39  0              0.014417886    6.9482315e-16  0              3.3550523e-09  2.6109412e-16  0              3.4954233    
   2500000   127.27922      200            200            0.0048059619  -5.0266951e-39  0              0.014417886    1.4538669e-17  0              7.020203e-11   2.6109412e-16  0              3.4954233    
   2600000   127.27922      200            200            0.0048059619  -8.6683855e-40  0              0.014417886    3.8466278e-18  0              1.8573989e-11  2.6109412e-16  0              3.4954233    
   2700000   127.27922      200            200            0.0048059619   1.5487184e-39  0              0.014417886    1.472855e-18   0              7.1118898e-12  2.6109412e-16  0              3.4954233    
   2800000   127.27922      200            200            0.0048059619   1.6192291e-39  0              0.014417886    2.4671319e-19  0              1.1912897e-12  2.6109412e-16  0              3.4954233    
   2900000   127.27922      200            200            0.0048059619   1.1652722e-39  0              0.014417886    4.2525207e-20  0              2.05339e-13    2.6109412e-16  0              3.4954233    
   3000000   127.27922      200            200            0.0048059619   6.849818e-39   0              0.014417886    1.8327674e-20  0              8.8497778e-14  2.6109412e-16  0              3.4954233    
Loop time of 69.1758 on 4 procs for 3000000 steps with 51 atoms

Performance: 37469770.645 ns/day, 0.000 hours/ns, 43367.790 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27392    | 1.1637     | 3.7545     | 138.7 |  1.68
Neigh   | 0.039474   | 0.041009   | 0.043589   |   0.8 |  0.06
Comm    | 29.925     | 37.519     | 43.718     |  94.3 | 54.24
Output  | 0.077554   | 0.077747   | 0.077919   |   0.1 |  0.11
Modify  | 14.78      | 21.62      | 29.942     | 145.1 | 31.25
Other   |            | 8.754      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(51*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.01                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 74.2770113639572
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.11
  ghost atom cutoff = 4.11
  binsize = 2.055, bins = 62 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.42 | 16.89 | 18.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200           -0.00033751219  9.8355098e-40  0             -0.0010125366   11299.226      0              5.4559919e+10  2.6109412e-16  0              3.6117403    
    200000   127.27922      200            200           -0.00022092595  8.0547146e-42  0             -0.00066277784  204.749        0              9.8865964e+08  2.6109412e-16  0              3.6566798    
    300000   127.27922      200            200            0.0001526319   7.8837724e-38  0              0.0004578957   73.063717      0              3.5279854e+08  2.6109412e-16  0              3.5388241    
    400000   127.27922      200            200            0.00013799503 -3.0779736e-36  0              0.00041398508  61.394943      0              2.9645421e+08  2.6109412e-16  0              3.5069823    
    500000   127.27922      200            200            0.0013655364   1.4880395e-36  0              0.0040966092   1.6638409      0              8034092.4      2.6109412e-16  0              3.5030051    
    600000   127.27922      200            200            0.0043865812  -3.3137194e-36  0              0.013159744    2.7676952      0              13364210       2.6109412e-16  0              3.5007177    
    700000   127.27922      200            200            0.0053504375   3.3279239e-36  0              0.016051312    0.019342144    0              93396.292      2.6109412e-16  0              3.5000886    
    800000   127.27922      200            200            0.0046714363   2.5358359e-38  0              0.014014309    0.02842187     0              137239.04      2.6109412e-16  0              3.5005133    
    900000   127.27922      200            200            0.0047963598  -6.8920473e-39  0              0.014389079    0.0071351706   0              34453.185      2.6109412e-16  0              3.5004363    
   1000000   127.27922      200            200            0.0048384226  -1.1475414e-37  0              0.014515268    0.00010926551  0              527.60406      2.6109412e-16  0              3.5004086    
   1100000   127.27922      200            200            0.0048049569   2.3317917e-38  0              0.014414871    5.3396657e-05  0              257.83335      2.6109412e-16  0              3.5004299    
   1200000   127.27922      200            200            0.0048124914  -3.1063194e-39  0              0.014437474    1.8492503e-05  0              89.293681      2.6109412e-16  0              3.5004252    
   1300000   127.27922      200            200            0.0048140425  -1.5281484e-39  0              0.014442128    5.0332186e-07  0              2.4303611      2.6109412e-16  0              3.5004242    
   1400000   127.27922      200            200            0.0048124103  -5.2095648e-39  0              0.014437231    9.1043354e-08  0              0.43961577     2.6109412e-16  0              3.5004252    
   1500000   127.27922      200            200            0.0048128451   6.6708131e-40  0              0.014438535    4.6301928e-08  0              0.22357544     2.6109412e-16  0              3.500425     
   1600000   127.27922      200            200            0.0048128942   3.204398e-40   0              0.014438683    1.9497316e-09  0              0.0094145559   2.6109412e-16  0              3.5004249    
   1700000   127.27922      200            200            0.004812816    6.5301139e-40  0              0.014438448    1.3639794e-10  0              0.00065861683  2.6109412e-16  0              3.500425     
   1800000   127.27922      200            200            0.0048128403   3.7183388e-39  0              0.014438521    1.1210739e-10  0              0.00054132647  2.6109412e-16  0              3.500425     
   1900000   127.27922      200            200            0.0048128413  -1.037655e-39   0              0.014438524    6.7679365e-12  0              3.2679943e-05  2.6109412e-16  0              3.500425     
   2000000   127.27922      200            200            0.0048128376   3.0401039e-40  0              0.014438513    1.6433744e-13  0              7.9352668e-07  2.6109412e-16  0              3.500425     
   2100000   127.27922      200            200            0.0048128389  -7.3079391e-40  0              0.014438517    2.6228394e-13  0              1.2664753e-06  2.6109412e-16  0              3.500425     
   2200000   127.27922      200            200            0.0048128389  -2.9264317e-39  0              0.014438517    2.173756e-14   0              1.049629e-07   2.6109412e-16  0              3.500425     
   2300000   127.27922      200            200            0.0048128387  -7.4907245e-39  0              0.014438516    1.2197352e-16  0              5.8896648e-10  2.6109412e-16  0              3.500425     
   2400000   127.27922      200            200            0.0048128388   1.0572333e-40  0              0.014438516    5.938824e-16   0              2.8676456e-09  2.6109412e-16  0              3.500425     
   2500000   127.27922      200            200            0.0048128388   8.3665739e-39  0              0.014438516    6.3292649e-17  0              3.0561755e-10  2.6109412e-16  0              3.500425     
   2600000   127.27922      200            200            0.0048128388  -2.5705965e-40  0              0.014438516    8.1937476e-21  0              3.9564675e-14  2.6109412e-16  0              3.500425     
   2700000   127.27922      200            200            0.0048128388   5.107103e-39   0              0.014438516    6.0663587e-19  0              2.9292275e-12  2.6109412e-16  0              3.500425     
   2800000   127.27922      200            200            0.0048128388  -9.5770389e-40  0              0.014438516    1.7538243e-19  0              8.4685897e-13  2.6109412e-16  0              3.500425     
   2900000   127.27922      200            200            0.0048128388  -2.8916862e-40  0              0.014438516    4.1303963e-20  0              1.9944206e-13  2.6109412e-16  0              3.500425     
   3000000   127.27922      200            200            0.0048128388   1.0749031e-38  0              0.014438516    1.41093e-20    0              6.8128762e-14  2.6109412e-16  0              3.500425     
Loop time of 69.087 on 4 procs for 3000000 steps with 51 atoms

Performance: 37517908.298 ns/day, 0.000 hours/ns, 43423.505 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27965    | 1.1764     | 3.7795     | 138.6 |  1.70
Neigh   | 0.040761   | 0.042596   | 0.045311   |   0.9 |  0.06
Comm    | 30.044     | 37.507     | 43.656     |  93.1 | 54.29
Output  | 0.074514   | 0.074746   | 0.074957   |   0.1 |  0.11
Modify  | 14.755     | 21.554     | 29.862     | 144.9 | 31.20
Other   |            | 8.732      |            |       | 12.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 0:58:58

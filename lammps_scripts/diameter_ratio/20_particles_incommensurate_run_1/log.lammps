LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 83 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.34 | 17.81 | 18.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0033552875   1.5131607e-40  0              0.010065862    12296.1        0              5.9373464e+10  2.6109412e-16  0              3.3254829    
    200000   127.27922      200            200            0.0012014045   4.8426437e-38  0              0.0036042136   3048.1392      0              1.4718373e+10  2.6109412e-16  0              3.0706213    
    300000   127.27922      200            200            9.5150698e-05  6.2344793e-37  0              0.00028545209  39.114055      0              1.8886778e+08  2.6109412e-16  0              3.0444002    
    400000   127.27922      200            200            0.00015829837 -1.2032192e-36  0              0.00047489512  103.85279      0              5.0146798e+08  2.6109412e-16  0              3.0018397    
    500000   127.27922      200            200            0.00098763195 -1.7634937e-36  0              0.0029628959   3.6628191      0              17686442       2.6109412e-16  0              2.9981887    
    600000   127.27922      200            200            0.0028920814  -6.880602e-36   0              0.0086762443   0.81637994     0              3942006.5      2.6109412e-16  0              2.9962093    
    700000   127.27922      200            200            0.003724962    1.6534477e-37  0              0.011174886    0.23280356     0              1124125.1      2.6109412e-16  0              2.9955195    
    800000   127.27922      200            200            0.0039939654  -3.8577117e-37  0              0.011981896    0.04307522     0              207994.82      2.6109412e-16  0              2.9953095    
    900000   127.27922      200            200            0.0040806184  -1.1718147e-37  0              0.012241855    0.0071799293   0              34669.309      2.6109412e-16  0              2.9952433    
   1000000   127.27922      200            200            0.0041076159  -8.4998058e-38  0              0.012322848    0.0011264569   0              5439.2574      2.6109412e-16  0              2.9952229    
   1100000   127.27922      200            200            0.0041155765   5.0503098e-38  0              0.012346729    0.00016839131  0              813.10137      2.6109412e-16  0              2.9952169    
   1200000   127.27922      200            200            0.0041177248   5.6016825e-40  0              0.012353174    2.4116048e-05  0              116.44776      2.6109412e-16  0              2.9952153    
   1300000   127.27922      200            200            0.004118213    1.3346303e-39  0              0.012354639    3.3174822e-06  0              16.018934      2.6109412e-16  0              2.995215     
   1400000   127.27922      200            200            0.0041182781   1.940825e-39   0              0.012354834    4.386754e-07   0              2.1182065      2.6109412e-16  0              2.995215     
   1500000   127.27922      200            200            0.0041182594  -1.6317634e-39  0              0.012354778    5.5707367e-08  0              0.26899094     2.6109412e-16  0              2.995215     
   1600000   127.27922      200            200            0.004118237   -4.6645093e-39  0              0.012354711    6.7756915e-09  0              0.032717389    2.6109412e-16  0              2.995215     
   1700000   127.27922      200            200            0.0041182232  -2.651817e-39   0              0.01235467     7.8547267e-10  0              0.0037927664   2.6109412e-16  0              2.995215     
   1800000   127.27922      200            200            0.0041182162   6.8636901e-40  0              0.012354649    8.6080314e-11  0              0.00041565103  2.6109412e-16  0              2.995215     
   1900000   127.27922      200            200            0.0041182129   1.0239436e-38  0              0.012354639    8.7990204e-12  0              4.2487321e-05  2.6109412e-16  0              2.995215     
   2000000   127.27922      200            200            0.0041182115  -5.4640412e-39  0              0.012354635    8.1977225e-13  0              3.9583868e-06  2.6109412e-16  0              2.995215     
   2100000   127.27922      200            200            0.0041182109  -6.4603724e-39  0              0.012354633    6.6663024e-14  0              3.2189189e-07  2.6109412e-16  0              2.995215     
   2200000   127.27922      200            200            0.0041182107   8.4740598e-39  0              0.012354632    4.2910438e-15  0              2.0719915e-08  2.6109412e-16  0              2.995215     
   2300000   127.27922      200            200            0.0041182106  -3.0144079e-39  0              0.012354632    1.6323479e-16  0              7.8820239e-10  2.6109412e-16  0              2.995215     
   2400000   127.27922      200            200            0.0041182106   1.3563303e-38  0              0.012354632    1.4508953e-19  0              7.0058541e-13  2.6109412e-16  0              2.995215     
   2500000   127.27922      200            200            0.0041182105  -1.3197109e-38  0              0.012354632    1.639132e-18   0              7.9147816e-12  2.6109412e-16  0              2.995215     
   2600000   127.27922      200            200            0.0041182105  -4.593851e-39   0              0.012354632    1.2339283e-18  0              5.958198e-12   2.6109412e-16  0              2.995215     
   2700000   127.27922      200            200            0.0041182105  -5.5510034e-40  0              0.012354632    3.3617648e-19  0              1.6232759e-12  2.6109412e-16  0              2.995215     
   2800000   127.27922      200            200            0.0041182105  -7.1129742e-39  0              0.012354632    1.0887845e-19  0              5.2573507e-13  2.6109412e-16  0              2.995215     
   2900000   127.27922      200            200            0.0041182105   1.0859688e-38  0              0.012354632    2.6326439e-20  0              1.2712095e-13  2.6109412e-16  0              2.995215     
   3000000   127.27922      200            200            0.0041182105  -1.924486e-38   0              0.012354632    1.4200169e-20  0              6.8567533e-14  2.6109412e-16  0              2.995215     
Loop time of 71.3976 on 4 procs for 3000000 steps with 51 atoms

Performance: 36303725.882 ns/day, 0.000 hours/ns, 42018.201 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23825    | 1.3326     | 4.3992     | 153.4 |  1.87
Neigh   | 0.096417   | 0.097848   | 0.10058    |   0.5 |  0.14
Comm    | 30.604     | 38.212     | 44.665     |  92.4 | 53.52
Output  | 0.058128   | 0.058461   | 0.058866   |   0.1 |  0.08
Modify  | 15.533     | 22.345     | 30.677     | 140.3 | 31.30
Other   |            | 9.351      |            |       | 13.10

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.01                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.4138228207373
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.11
  ghost atom cutoff = 3.11
  binsize = 1.555, bins = 82 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.28 | 17.75 | 18.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0033650828   4.8421552e-39  0              0.010095248    12344.023      0              5.960487e+10   2.6109412e-16  0              3.3257153    
    200000   127.27922      200            200            0.0012156385   1.4529453e-38  0              0.0036469155   3100.6426      0              1.4971894e+10  2.6109412e-16  0              3.072436     
    300000   127.27922      200            200            0.00010630524  2.1493014e-39  0              0.00031891572  48.110145      0              2.3230667e+08  2.6109412e-16  0              3.0489605    
    400000   127.27922      200            200            0.00017133164  1.271493e-36   0              0.00051399493  119.80961      0              5.785177e+08   2.6109412e-16  0              3.0060561    
    500000   127.27922      200            200            0.0011733882   7.8978695e-37  0              0.0035201646   6.9854551      0              33730263       2.6109412e-16  0              3.0029782    
    600000   127.27922      200            200            0.0028100635   9.1804235e-36  0              0.0084301904   0.30475467     0              1471551.2      2.6109412e-16  0              3.0012915    
    700000   127.27922      200            200            0.0036682534  -7.8339115e-36  0              0.01100476     0.12141459     0              586267.61      2.6109412e-16  0              3.000574     
    800000   127.27922      200            200            0.0039685385   1.1638907e-36  0              0.011905616    0.024901193    0              120238.95      2.6109412e-16  0              3.0003378    
    900000   127.27922      200            200            0.0040724415  -2.6813916e-38  0              0.012217325    0.0044885679   0              21673.688      2.6109412e-16  0              3.0002577    
   1000000   127.27922      200            200            0.0041077937  -1.5798505e-38  0              0.012323381    0.00075865791  0              3663.2875      2.6109412e-16  0              3.0002308    
   1100000   127.27922      200            200            0.0041195704   6.2246518e-38  0              0.012358711    0.00012238874  0              590.97141      2.6109412e-16  0              3.0002218    
   1200000   127.27922      200            200            0.0041233949   8.2318531e-40  0              0.012370185    1.9007054e-05  0              91.778259      2.6109412e-16  0              3.0002189    
   1300000   127.27922      200            200            0.0041245972  -7.1267191e-39  0              0.012373792    2.8564476e-06  0              13.792763      2.6109412e-16  0              3.000218     
   1400000   127.27922      200            200            0.0041249586   7.1409851e-39  0              0.012374876    4.1681492e-07  0              2.0126501      2.6109412e-16  0              3.0002178    
   1500000   127.27922      200            200            0.0041250602   5.2573011e-39  0              0.012375181    5.9185248e-08  0              0.28578438     2.6109412e-16  0              3.0002177    
   1600000   127.27922      200            200            0.0041250855  -1.4670322e-39  0              0.012375256    8.1884331e-09  0              0.039539013    2.6109412e-16  0              3.0002177    
   1700000   127.27922      200            200            0.0041250903   5.3269473e-39  0              0.012375271    1.1044751e-09  0              0.0053331149   2.6109412e-16  0              3.0002177    
   1800000   127.27922      200            200            0.0041250903   2.5695059e-39  0              0.012375271    1.4522554e-10  0              0.00070124215  2.6109412e-16  0              3.0002177    
   1900000   127.27922      200            200            0.0041250897   3.6005558e-39  0              0.012375269    1.8600514e-11  0              8.9815226e-05  2.6109412e-16  0              3.0002177    
   2000000   127.27922      200            200            0.0041250893  -4.8874426e-39  0              0.012375268    2.3172322e-12  0              1.1189085e-05  2.6109412e-16  0              3.0002177    
   2100000   127.27922      200            200            0.004125089   -8.3567743e-39  0              0.012375267    2.8010978e-13  0              1.3525499e-06  2.6109412e-16  0              3.0002177    
   2200000   127.27922      200            200            0.0041250889   2.8907068e-39  0              0.012375267    3.2737756e-14  0              1.5807891e-07  2.6109412e-16  0              3.0002177    
   2300000   127.27922      200            200            0.0041250889   5.8686314e-39  0              0.012375267    3.6735001e-15  0              1.7738017e-08  2.6109412e-16  0              3.0002177    
   2400000   127.27922      200            200            0.0041250888   9.0660122e-39  0              0.012375267    3.9769491e-16  0              1.9203264e-09  2.6109412e-16  0              3.0002177    
   2500000   127.27922      200            200            0.0041250888  -1.8974673e-38  0              0.012375267    4.0102763e-17  0              1.9364189e-10  2.6109412e-16  0              3.0002177    
   2600000   127.27922      200            200            0.0041250888  -6.8151659e-39  0              0.012375266    3.4778534e-18  0              1.6793309e-11  2.6109412e-16  0              3.0002177    
   2700000   127.27922      200            200            0.0041250888  -5.278802e-39   0              0.012375266    2.8442053e-19  0              1.373365e-12   2.6109412e-16  0              3.0002177    
   2800000   127.27922      200            200            0.0041250888   1.8071536e-40  0              0.012375266    1.8323508e-21  0              8.8477661e-15  2.6109412e-16  0              3.0002177    
   2900000   127.27922      200            200            0.0041250888  -3.7308921e-39  0              0.012375266    3.943591e-20   0              1.904219e-13   2.6109412e-16  0              3.0002177    
   3000000   127.27922      200            200            0.0041250888  -1.3358979e-38  0              0.012375266    9.3181244e-20  0              4.4993888e-13  2.6109412e-16  0              3.0002177    
Loop time of 71.1929 on 4 procs for 3000000 steps with 51 atoms

Performance: 36408100.231 ns/day, 0.000 hours/ns, 42139.005 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23319    | 1.2773     | 4.1835     | 148.5 |  1.79
Neigh   | 0.092547   | 0.094652   | 0.098045   |   0.7 |  0.13
Comm    | 30.605     | 38.355     | 44.827     |  94.1 | 53.87
Output  | 0.057033   | 0.057425   | 0.058196   |   0.2 |  0.08
Modify  | 15.401     | 22.232     | 30.738     | 144.0 | 31.23
Other   |            | 9.177      |            |       | 12.89

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.02                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.7279587335909
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.12
  ghost atom cutoff = 3.12
  binsize = 1.56, bins = 82 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.28 | 17.75 | 18.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0033748804  -4.8415445e-39  0              0.010124641    12392.018      0              5.9836619e+10  2.6109412e-16  0              3.3259363    
    200000   127.27922      200            200            0.0012299194   4.8425517e-39  0              0.0036897583   3153.5491      0              1.522736e+10   2.6109412e-16  0              3.0742204    
    300000   127.27922      200            200            0.00011759655  2.3361032e-37  0              0.00035278964  58.024652      0              2.8018028e+08  2.6109412e-16  0              3.0534749    
    400000   127.27922      200            200            0.00018451916  6.5393636e-37  0              0.00055355748  136.87656      0              6.6092794e+08  2.6109412e-16  0              3.0102154    
    500000   127.27922      200            200            0.0014279723  -6.618987e-36   0              0.0042839169   11.030695      0              53263277       2.6109412e-16  0              3.0077012    
    600000   127.27922      200            200            0.0027732429  -4.4539813e-36  0              0.0083197287   0.033316919    0              160875.48      2.6109412e-16  0              3.0063346    
    700000   127.27922      200            200            0.0036337549   3.3599452e-36  0              0.010901265    0.039196506    0              189265.9       2.6109412e-16  0              3.0056108    
    800000   127.27922      200            200            0.0039529148  -2.2252564e-37  0              0.011858744    0.0096802474   0              46742.45       2.6109412e-16  0              3.0053584    
    900000   127.27922      200            200            0.0040683473   6.7957025e-37  0              0.012205042    0.0019488094   0              9410.1032      2.6109412e-16  0              3.0052691    
   1000000   127.27922      200            200            0.0041095931   6.6554954e-39  0              0.012328779    0.000359985    0              1738.2388      2.6109412e-16  0              3.0052374    
   1100000   127.27922      200            200            0.0041241791   1.418465e-37   0              0.012372537    6.2866167e-05  0              303.55822      2.6109412e-16  0              3.0052262    
   1200000   127.27922      200            200            0.0041292862  -1.731773e-38   0              0.012387858    1.0525153e-05  0              50.822196      2.6109412e-16  0              3.0052223    
   1300000   127.27922      200            200            0.0041310557  -2.322472e-38   0              0.012393167    1.7036959e-06  0              8.2265379      2.6109412e-16  0              3.005221     
   1400000   127.27922      200            200            0.0041316618   1.8504854e-39  0              0.012394985    2.6814448e-07  0              1.2947737      2.6109412e-16  0              3.0052205    
   1500000   127.27922      200            200            0.0041318666  -3.7323509e-39  0              0.0123956      4.1199509e-08  0              0.19893769     2.6109412e-16  0              3.0052204    
   1600000   127.27922      200            200            0.0041319347  -1.9559462e-39  0              0.012395804    6.1975401e-09  0              0.029925703    2.6109412e-16  0              3.0052203    
   1700000   127.27922      200            200            0.004131957    1.2311593e-39  0              0.012395871    9.147042e-10   0              0.0044167792   2.6109412e-16  0              3.0052203    
   1800000   127.27922      200            200            0.0041319641   8.2056553e-39  0              0.012395892    1.3266832e-10  0              0.00064060781  2.6109412e-16  0              3.0052203    
   1900000   127.27922      200            200            0.0041319662   8.1321311e-40  0              0.012395899    1.8931713e-11  0              9.1414466e-05  2.6109412e-16  0              3.0052203    
   2000000   127.27922      200            200            0.0041319669  -3.9859596e-39  0              0.012395901    2.6602136e-12  0              1.2845219e-05  2.6109412e-16  0              3.0052203    
   2100000   127.27922      200            200            0.0041319671   1.0796074e-39  0              0.012395901    3.6828432e-13  0              1.7783132e-06  2.6109412e-16  0              3.0052203    
   2200000   127.27922      200            200            0.0041319671   2.7088449e-39  0              0.012395901    5.0267378e-14  0              2.4272318e-07  2.6109412e-16  0              3.0052203    
   2300000   127.27922      200            200            0.0041319671  -9.9795106e-39  0              0.012395901    6.7633885e-15  0              3.2657983e-08  2.6109412e-16  0              3.0052203    
   2400000   127.27922      200            200            0.0041319671   5.5639579e-40  0              0.012395901    8.9507035e-16  0              4.3219744e-09  2.6109412e-16  0              3.0052203    
   2500000   127.27922      200            200            0.0041319671  -4.4037981e-39  0              0.012395901    1.1622061e-16  0              5.6118772e-10  2.6109412e-16  0              3.0052203    
   2600000   127.27922      200            200            0.0041319671   5.4207227e-39  0              0.012395901    1.4586004e-17  0              7.0430594e-11  2.6109412e-16  0              3.0052203    
   2700000   127.27922      200            200            0.0041319671  -6.2667298e-39  0              0.012395901    1.9186749e-18  0              9.2645944e-12  2.6109412e-16  0              3.0052203    
   2800000   127.27922      200            200            0.0041319671  -6.7616241e-39  0              0.012395901    1.8452639e-19  0              8.910119e-13   2.6109412e-16  0              3.0052203    
   2900000   127.27922      200            200            0.0041319671   1.1221071e-38  0              0.012395901    8.0074072e-20  0              3.8664904e-13  2.6109412e-16  0              3.0052203    
   3000000   127.27922      200            200            0.0041319671  -7.9791575e-39  0              0.012395901    7.5904495e-20  0              3.6651564e-13  2.6109412e-16  0              3.0052203    
Loop time of 71.3777 on 4 procs for 3000000 steps with 51 atoms

Performance: 36313838.273 ns/day, 0.000 hours/ns, 42029.905 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2656     | 1.3133     | 4.3158     | 151.3 |  1.84
Neigh   | 0.093696   | 0.095581   | 0.098735   |   0.7 |  0.13
Comm    | 30.697     | 38.371     | 44.825     |  93.2 | 53.76
Output  | 0.057541   | 0.057901   | 0.058558   |   0.2 |  0.08
Modify  | 15.482     | 22.306     | 30.771     | 142.8 | 31.25
Other   |            | 9.234      |            |       | 12.94

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.03                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.0441819206036
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.13
  ghost atom cutoff = 3.13
  binsize = 1.565, bins = 82 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.28 | 17.75 | 18.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0033846802  -4.8418648e-39  0              0.01015404     12440.084      0              6.0068712e+10  2.6109412e-16  0              3.326146     
    200000   127.27922      200            200            0.0012442468   3.8744624e-38  0              0.0037327403   3206.8564      0              1.5484762e+10  2.6109412e-16  0              3.0759746    
    300000   127.27922      200            200            0.00012902282 -3.086057e-37   0              0.00038706845  68.853504      0              3.3246893e+08  2.6109412e-16  0              3.0579432    
    400000   127.27922      200            200            0.00042135251  3.1289424e-36  0              0.0012640575   154.7332       0              7.4715123e+08  2.6109412e-16  0              3.0143177    
    500000   127.27922      200            200            0.0017564313  -1.4072549e-35  0              0.0052692938   15.457418      0              74638339       2.6109412e-16  0              3.0123633    
    600000   127.27922      200            200            0.0027824869   1.0401362e-35  0              0.0083474608   0.037013061    0              178722.83      2.6109412e-16  0              3.0113372    
    700000   127.27922      200            200            0.0036232166  -5.9272604e-36  0              0.01086965     0.0014767332   0              7130.6162      2.6109412e-16  0              3.0106284    
    800000   127.27922      200            200            0.0039484303  -9.9615608e-37  0              0.011845291    0.0010926858   0              5276.1888      2.6109412e-16  0              3.0103704    
    900000   127.27922      200            200            0.0040691638   2.1811025e-37  0              0.012207491    0.0003230513   0              1559.8991      2.6109412e-16  0              3.0102765    
   1000000   127.27922      200            200            0.0041134817   7.6073564e-39  0              0.012340445    7.5128314e-05  0              362.76774      2.6109412e-16  0              3.0102424    
   1100000   127.27922      200            200            0.0041296517   1.0357273e-37  0              0.012388955    1.5446165e-05  0              74.584001      2.6109412e-16  0              3.01023      
   1200000   127.27922      200            200            0.0041355256  -1.7244291e-38  0              0.012406577    2.9358975e-06  0              14.176399      2.6109412e-16  0              3.0102255    
   1300000   127.27922      200            200            0.0041376512  -1.6196937e-38  0              0.012412953    5.2804692e-07  0              2.5497496      2.6109412e-16  0              3.0102238    
   1400000   127.27922      200            200            0.0041384174   1.8486493e-38  0              0.012415252    9.1129723e-08  0              0.44003282     2.6109412e-16  0              3.0102232    
   1500000   127.27922      200            200            0.0041386927  -5.3677004e-39  0              0.012416078    1.5227312e-08  0              0.073527241    2.6109412e-16  0              3.010223     
   1600000   127.27922      200            200            0.0041387911  -4.8457931e-39  0              0.012416373    2.4788508e-09  0              0.011969483    2.6109412e-16  0              3.010223     
   1700000   127.27922      200            200            0.0041388262  -7.7677113e-39  0              0.012416478    3.9488282e-10  0              0.0019067478   2.6109412e-16  0              3.0102229    
   1800000   127.27922      200            200            0.0041388386   6.4251447e-39  0              0.012416516    6.1758133e-11  0              0.00029820792  2.6109412e-16  0              3.0102229    
   1900000   127.27922      200            200            0.004138843    1.404717e-39   0              0.012416529    9.5064373e-12  0              4.5903183e-05  2.6109412e-16  0              3.0102229    
   2000000   127.27922      200            200            0.0041388445  -1.0707972e-38  0              0.012416534    1.4431607e-12  0              6.9685066e-06  2.6109412e-16  0              3.0102229    
   2100000   127.27922      200            200            0.0041388451  -8.1175953e-39  0              0.012416535    2.163637e-13   0              1.0447429e-06  2.6109412e-16  0              3.0102229    
   2200000   127.27922      200            200            0.0041388453   7.1664729e-40  0              0.012416536    3.2062821e-14  0              1.5481989e-07  2.6109412e-16  0              3.0102229    
   2300000   127.27922      200            200            0.0041388453   2.4919293e-39  0              0.012416536    4.7025036e-15  0              2.2706707e-08  2.6109412e-16  0              3.0102229    
   2400000   127.27922      200            200            0.0041388453   1.1749729e-38  0              0.012416536    6.8005256e-16  0              3.2837305e-09  2.6109412e-16  0              3.0102229    
   2500000   127.27922      200            200            0.0041388454   1.1558704e-38  0              0.012416536    9.9271096e-17  0              4.793446e-10   2.6109412e-16  0              3.0102229    
   2600000   127.27922      200            200            0.0041388454   9.1992836e-39  0              0.012416536    1.4594468e-17  0              7.0471464e-11  2.6109412e-16  0              3.0102229    
   2700000   127.27922      200            200            0.0041388454   1.0742626e-38  0              0.012416536    1.876237e-18   0              9.0596771e-12  2.6109412e-16  0              3.0102229    
   2800000   127.27922      200            200            0.0041388454   6.5244631e-39  0              0.012416536    2.8252414e-19  0              1.364208e-12   2.6109412e-16  0              3.0102229    
   2900000   127.27922      200            200            0.0041388454   9.8819124e-39  0              0.012416536    1.2193991e-19  0              5.8880419e-13  2.6109412e-16  0              3.0102229    
   3000000   127.27922      200            200            0.0041388454  -8.214615e-39   0              0.012416536    3.8025603e-20  0              1.8361203e-13  2.6109412e-16  0              3.0102229    
Loop time of 71.02 on 4 procs for 3000000 steps with 51 atoms

Performance: 36496777.128 ns/day, 0.000 hours/ns, 42241.640 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23479    | 1.3195     | 4.3357     | 151.7 |  1.86
Neigh   | 0.089714   | 0.091411   | 0.094367   |   0.6 |  0.13
Comm    | 30.502     | 38.254     | 44.739     |  93.8 | 53.86
Output  | 0.06312    | 0.063527   | 0.064216   |   0.2 |  0.09
Modify  | 15.374     | 22.144     | 30.592     | 143.2 | 31.18
Other   |            | 9.147      |            |       | 12.88

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 171
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.04                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.3624992932791
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.14
  ghost atom cutoff = 3.14
  binsize = 1.57, bins = 82 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.28 | 17.75 | 18.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0033944821  -3.6312433e-39  0              0.010183446    12488.221      0              6.0301148e+10  2.6109412e-16  0              3.3263443    
    200000   127.27922      200            200            0.0012586205  -8.4735652e-39  0              0.0037758616   3260.5654      0              1.5744103e+10  2.6109412e-16  0              3.0776983    
    300000   127.27922      200            200            0.00014058415  5.4370311e-37  0              0.00042175244  80.594409      0              3.8916156e+08  2.6109412e-16  0              3.0623654    
    400000   127.27922      200            200            0.0010400617   1.7890981e-38  0              0.0031201851   171.49289      0              8.2807778e+08  2.6109412e-16  0              3.0183664    
    500000   127.27922      200            200            0.002161837    5.7344553e-36  0              0.0064855111   19.857128      0              95882965       2.6109412e-16  0              3.0169714    
    600000   127.27922      200            200            0.0028378393   5.3933611e-36  0              0.008513518    0.3136948      0              1514719.9      2.6109412e-16  0              3.0162995    
    700000   127.27922      200            200            0.0036373743   9.0858756e-37  0              0.010912123    0.015022765    0              72539.558      2.6109412e-16  0              3.0156261    
    800000   127.27922      200            200            0.0039557505  -9.9948666e-37  0              0.011867252    0.0011648778   0              5624.7779      2.6109412e-16  0              3.015373     
    900000   127.27922      200            200            0.0040753417  -8.9598572e-38  0              0.012226025    9.0089382e-05  0              435.00939      2.6109412e-16  0              3.0152799    
   1000000   127.27922      200            200            0.0041197306   1.4426724e-37  0              0.012359192    5.7864513e-06  0              27.940703      2.6109412e-16  0              3.0152456    
   1100000   127.27922      200            200            0.00413614     2.6449572e-38  0              0.01240842     2.3642459e-07  0              1.1416097      2.6109412e-16  0              3.0152329    
   1200000   127.27922      200            200            0.0041421943   2.2173659e-38  0              0.012426583    1.029684e-09   0              0.0049719755   2.6109412e-16  0              3.0152282    
   1300000   127.27922      200            200            0.0041444251  -1.3456309e-38  0              0.012433275    1.7810926e-09  0              0.0086002585   2.6109412e-16  0              3.0152265    
   1400000   127.27922      200            200            0.0041452463   5.6103224e-39  0              0.012435739    1.2516477e-09  0              0.0060437586   2.6109412e-16  0              3.0152259    
   1500000   127.27922      200            200            0.0041455483   2.2712821e-39  0              0.012436645    4.1235144e-10  0              0.0019910975   2.6109412e-16  0              3.0152257    
   1600000   127.27922      200            200            0.0041456593  -5.6426e-39     0              0.012436978    1.0293583e-10  0              0.00049704028  2.6109412e-16  0              3.0152256    
   1700000   127.27922      200            200            0.0041457      1.1315589e-39  0              0.0124371      2.221428e-11   0              0.00010726481  2.6109412e-16  0              3.0152255    
   1800000   127.27922      200            200            0.004145715   -2.8058534e-39  0              0.012437145    4.3813941e-12  0              2.1156184e-05  2.6109412e-16  0              3.0152255    
   1900000   127.27922      200            200            0.0041457204   6.7275288e-39  0              0.012437161    8.1261748e-13  0              3.923839e-06   2.6109412e-16  0              3.0152255    
   2000000   127.27922      200            200            0.0041457224   4.3296214e-39  0              0.012437167    1.4417783e-13  0              6.9618314e-07  2.6109412e-16  0              3.0152255    
   2100000   127.27922      200            200            0.0041457232   5.7423946e-39  0              0.01243717     2.4717259e-14  0              1.193508e-07   2.6109412e-16  0              3.0152255    
   2200000   127.27922      200            200            0.0041457234   8.5378464e-41  0              0.01243717     4.1371636e-15  0              1.9976882e-08  2.6109412e-16  0              3.0152255    
   2300000   127.27922      200            200            0.0041457235   7.9506713e-39  0              0.012437171    6.7500033e-16  0              3.259335e-09   2.6109412e-16  0              3.0152255    
   2400000   127.27922      200            200            0.0041457236   9.9850805e-39  0              0.012437171    1.0855875e-16  0              5.2419134e-10  2.6109412e-16  0              3.0152255    
   2500000   127.27922      200            200            0.0041457236  -1.8005673e-38  0              0.012437171    1.7619082e-17  0              8.5076243e-11  2.6109412e-16  0              3.0152255    
   2600000   127.27922      200            200            0.0041457236  -1.1846467e-38  0              0.012437171    2.8962438e-18  0              1.3984925e-11  2.6109412e-16  0              3.0152255    
   2700000   127.27922      200            200            0.0041457236   6.393906e-40   0              0.012437171    3.4312214e-19  0              1.656814e-12   2.6109412e-16  0              3.0152255    
   2800000   127.27922      200            200            0.0041457236   7.3667517e-39  0              0.012437171    6.5450724e-20  0              3.1603812e-13  2.6109412e-16  0              3.0152255    
   2900000   127.27922      200            200            0.0041457236  -1.1648146e-40  0              0.012437171    2.2715755e-20  0              1.0968625e-13  2.6109412e-16  0              3.0152255    
   3000000   127.27922      200            200            0.0041457236  -1.8155598e-38  0              0.012437171    7.8469745e-21  0              3.7890231e-14  2.6109412e-16  0              3.0152255    
Loop time of 71.1591 on 4 procs for 3000000 steps with 51 atoms

Performance: 36425393.512 ns/day, 0.000 hours/ns, 42159.020 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25204    | 1.2749     | 4.1446     | 146.8 |  1.79
Neigh   | 0.087553   | 0.089284   | 0.092257   |   0.6 |  0.13
Comm    | 30.631     | 38.294     | 44.695     |  93.5 | 53.82
Output  | 0.058482   | 0.058832   | 0.059478   |   0.2 |  0.08
Modify  | 15.44      | 22.208     | 30.576     | 142.3 | 31.21
Other   |            | 9.234      |            |       | 12.98

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.05                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.6829177631213
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.15
  ghost atom cutoff = 3.15
  binsize = 1.575, bins = 81 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.21 | 17.68 | 18.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034042862  -3.873588e-38   0              0.010212859    12536.429      0              6.0533927e+10  2.6109412e-16  0              3.3265311    
    200000   127.27922      200            200            0.00127304    -7.7355914e-38  0              0.0038191201   3314.6735      0              1.6005372e+10  2.6109412e-16  0              3.0793916    
    300000   127.27922      200            200            0.00015227882 -2.3100471e-37  0              0.00045683645  93.243291      0              4.5023848e+08  2.6109412e-16  0              3.0667415    
    400000   127.27922      200            200            0.0019193494  -5.9862839e-37  0              0.0057580482   185.25973      0              8.9455292e+08  2.6109412e-16  0              3.0223699    
    500000   127.27922      200            200            0.0026438896   5.7009596e-36  0              0.0079316687   23.780819      0              1.1482907e+08  2.6109412e-16  0              3.0215345    
    600000   127.27922      200            200            0.0029385097  -8.7530244e-37  0              0.0088155291   0.82445527     0              3980999.4      2.6109412e-16  0              3.0212228    
    700000   127.27922      200            200            0.003675949   -2.1877926e-36  0              0.011027847    0.076892645    0              371287.07      2.6109412e-16  0              3.0206042    
    800000   127.27922      200            200            0.0039748454  -1.7842595e-36  0              0.011924536    0.0098021605   0              47331.125      2.6109412e-16  0              3.0203665    
    900000   127.27922      200            200            0.0040869262   3.7340616e-37  0              0.012260779    0.0013058671   0              6305.5649      2.6109412e-16  0              3.020279     
   1000000   127.27922      200            200            0.0041283923   1.0490806e-37  0              0.012385177    0.00017464073  0              843.27757      2.6109412e-16  0              3.0202469    
   1100000   127.27922      200            200            0.0041436838   4.5088428e-38  0              0.012431052    2.3346731e-05  0              112.73301      2.6109412e-16  0              3.020235     
   1200000   127.27922      200            200            0.0041493175   7.5498128e-38  0              0.012447953    3.1197226e-06  0              15.064024      2.6109412e-16  0              3.0202307    
   1300000   127.27922      200            200            0.0041513924  -1.8456165e-38  0              0.012454177    4.1676865e-07  0              2.0124267      2.6109412e-16  0              3.0202291    
   1400000   127.27922      200            200            0.0041521565  -4.2273044e-40  0              0.012456469    5.5667832e-08  0              0.26880004     2.6109412e-16  0              3.0202285    
   1500000   127.27922      200            200            0.0041524378  -3.8081509e-39  0              0.012457313    7.4346516e-09  0              0.035899272    2.6109412e-16  0              3.0202282    
   1600000   127.27922      200            200            0.0041525414  -8.0520022e-40  0              0.012457624    9.9281998e-10  0              0.0047939724   2.6109412e-16  0              3.0202282    
   1700000   127.27922      200            200            0.0041525796   1.1192648e-39  0              0.012457739    1.3256729e-10  0              0.00064012001  2.6109412e-16  0              3.0202281    
   1800000   127.27922      200            200            0.0041525936  -4.031128e-39   0              0.012457781    1.7699089e-11  0              8.5462568e-05  2.6109412e-16  0              3.0202281    
   1900000   127.27922      200            200            0.0041525988  -1.765436e-39   0              0.012457796    2.3626466e-12  0              1.1408375e-05  2.6109412e-16  0              3.0202281    
   2000000   127.27922      200            200            0.0041526007  -1.9905829e-38  0              0.012457802    3.1539992e-13  0              1.5229534e-06  2.6109412e-16  0              3.0202281    
   2100000   127.27922      200            200            0.0041526014  -6.393881e-39   0              0.012457804    4.2085585e-14  0              2.0321623e-07  2.6109412e-16  0              3.0202281    
   2200000   127.27922      200            200            0.0041526017   3.6787922e-39  0              0.012457805    5.6252726e-15  0              2.7162428e-08  2.6109412e-16  0              3.0202281    
   2300000   127.27922      200            200            0.0041526017   5.4836166e-39  0              0.012457805    7.5481488e-16  0              3.6447309e-09  2.6109412e-16  0              3.0202281    
   2400000   127.27922      200            200            0.0041526018   8.7196891e-39  0              0.012457805    9.8244835e-17  0              4.7438915e-10  2.6109412e-16  0              3.0202281    
   2500000   127.27922      200            200            0.0041526018  -1.123113e-39   0              0.012457805    1.4174298e-17  0              6.844261e-11   2.6109412e-16  0              3.0202281    
   2600000   127.27922      200            200            0.0041526018  -2.2380951e-39  0              0.012457805    1.751979e-18   0              8.4596794e-12  2.6109412e-16  0              3.0202281    
   2700000   127.27922      200            200            0.0041526018   5.3933502e-39  0              0.012457805    2.4066041e-19  0              1.162063e-12   2.6109412e-16  0              3.0202281    
   2800000   127.27922      200            200            0.0041526018   6.0543751e-39  0              0.012457805    3.6574127e-21  0              1.7660337e-14  2.6109412e-16  0              3.0202281    
   2900000   127.27922      200            200            0.0041526018   1.4292685e-38  0              0.012457805    6.0688095e-21  0              2.9304109e-14  2.6109412e-16  0              3.0202281    
   3000000   127.27922      200            200            0.0041526018   1.0787123e-39  0              0.012457805    1.2923859e-19  0              6.2404688e-13  2.6109412e-16  0              3.0202281    
Loop time of 71.2179 on 4 procs for 3000000 steps with 51 atoms

Performance: 36395319.737 ns/day, 0.000 hours/ns, 42124.213 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23703    | 1.264      | 4.1531     | 148.4 |  1.77
Neigh   | 0.08612    | 0.08841    | 0.091773   |   0.8 |  0.12
Comm    | 30.707     | 38.312     | 44.713     |  92.8 | 53.80
Output  | 0.059955   | 0.060312   | 0.060935   |   0.2 |  0.08
Modify  | 15.479     | 22.248     | 30.554     | 141.5 | 31.24
Other   |            | 9.245      |            |       | 12.98

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.06                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.005444241634
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.16
  ghost atom cutoff = 3.16
  binsize = 1.58, bins = 81 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.21 | 17.68 | 18.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034140923   7.2634936e-39  0              0.010242277    12584.707      0              6.0767046e+10  2.6109412e-16  0              3.3267066    
    200000   127.27922      200            200            0.0012875048  -3.0975215e-37  0              0.0038625145   3369.1792      0              1.6268561e+10  2.6109412e-16  0              3.0810544    
    300000   127.27922      200            200            0.00016410623  2.1855996e-39  0              0.00049231868  106.79722      0              5.1568557e+08  2.6109412e-16  0              3.0710714    
    400000   127.27922      200            200            0.0030220436   1.9060842e-36  0              0.0090661308   194.32682      0              9.3833466e+08  2.6109412e-16  0              3.0263403    
    500000   127.27922      200            200            0.0031979189  -4.2536916e-36  0              0.0095937568   26.78235       0              1.2932238e+08  2.6109412e-16  0              3.0260632    
    600000   127.27922      200            200            0.0030827489   2.7620209e-36  0              0.0092482468   1.4980719      0              7233653.2      2.6109412e-16  0              3.0261098    
    700000   127.27922      200            200            0.0037376412   2.8201083e-37  0              0.011212924    0.17500527     0              845037.81      2.6109412e-16  0              3.025564     
    800000   127.27922      200            200            0.0040049884  -8.6935166e-37  0              0.012014965    0.024827658    0              119883.87      2.6109412e-16  0              3.0253514    
    900000   127.27922      200            200            0.0041035543   6.7863145e-37  0              0.012310663    0.003591204    0              17340.639      2.6109412e-16  0              3.0252743    
   1000000   127.27922      200            200            0.0041392968  -1.8744862e-37  0              0.01241789     0.00051819546  0              2502.1804      2.6109412e-16  0              3.0252464    
   1100000   127.27922      200            200            0.0041522069  -1.4991296e-37  0              0.012456621    7.449326e-05   0              359.70129      2.6109412e-16  0              3.0252364    
   1200000   127.27922      200            200            0.0041568622  -1.6707046e-38  0              0.012470587    1.0673688e-05  0              51.539417      2.6109412e-16  0              3.0252327    
   1300000   127.27922      200            200            0.0041585389  -6.6062051e-39  0              0.012475617    1.5249276e-06  0              7.3633295      2.6109412e-16  0              3.0252314    
   1400000   127.27922      200            200            0.004159142    1.5291082e-38  0              0.012477426    2.1728216e-07  0              1.0491778      2.6109412e-16  0              3.025231     
   1500000   127.27922      200            200            0.0041593588  -1.3517749e-38  0              0.012478076    3.0882415e-08  0              0.14912013     2.6109412e-16  0              3.0252308    
   1600000   127.27922      200            200            0.0041594366  -6.8511546e-39  0              0.01247831     4.3789298e-09  0              0.021144285    2.6109412e-16  0              3.0252307    
   1700000   127.27922      200            200            0.0041594645  -3.7125916e-39  0              0.012478393    6.1950104e-10  0              0.0029913488   2.6109412e-16  0              3.0252307    
   1800000   127.27922      200            200            0.0041594745   5.6643251e-39  0              0.012478423    8.7453141e-11  0              0.00042227992  2.6109412e-16  0              3.0252307    
   1900000   127.27922      200            200            0.004159478    9.1398412e-39  0              0.012478434    1.2320173e-11  0              5.9489705e-05  2.6109412e-16  0              3.0252307    
   2000000   127.27922      200            200            0.0041594793  -1.7404588e-39  0              0.012478438    1.7321885e-12  0              8.3641186e-06  2.6109412e-16  0              3.0252307    
   2100000   127.27922      200            200            0.0041594797  -3.3708318e-40  0              0.012478439    2.4308636e-13  0              1.173777e-06   2.6109412e-16  0              3.0252307    
   2200000   127.27922      200            200            0.0041594799   1.6994332e-38  0              0.01247844     3.405777e-14   0              1.6445278e-07  2.6109412e-16  0              3.0252307    
   2300000   127.27922      200            200            0.00415948    -5.742189e-40   0              0.01247844     4.763705e-15   0              2.3002226e-08  2.6109412e-16  0              3.0252307    
   2400000   127.27922      200            200            0.00415948     1.4455074e-39  0              0.01247844     6.6851485e-16  0              3.228019e-09   2.6109412e-16  0              3.0252307    
   2500000   127.27922      200            200            0.00415948    -2.3513297e-39  0              0.01247844     9.3958814e-17  0              4.5369348e-10  2.6109412e-16  0              3.0252307    
   2600000   127.27922      200            200            0.00415948    -1.4368588e-38  0              0.01247844     1.2822055e-17  0              6.1913113e-11  2.6109412e-16  0              3.0252307    
   2700000   127.27922      200            200            0.00415948     2.2306819e-38  0              0.01247844     1.7771161e-18  0              8.5810576e-12  2.6109412e-16  0              3.0252307    
   2800000   127.27922      200            200            0.00415948     1.4484477e-38  0              0.01247844     2.0908596e-19  0              1.0096013e-12  2.6109412e-16  0              3.0252307    
   2900000   127.27922      200            200            0.00415948     1.302766e-38   0              0.01247844     5.9625124e-20  0              2.8790838e-13  2.6109412e-16  0              3.0252307    
   3000000   127.27922      200            200            0.00415948    -5.0407191e-39  0              0.01247844     1.2116146e-19  0              5.8504531e-13  2.6109412e-16  0              3.0252307    
Loop time of 71.1721 on 4 procs for 3000000 steps with 51 atoms

Performance: 36418784.780 ns/day, 0.000 hours/ns, 42151.371 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23861    | 1.2664     | 4.1139     | 146.2 |  1.78
Neigh   | 0.081435   | 0.08336    | 0.086405   |   0.7 |  0.12
Comm    | 30.556     | 38.282     | 44.71      |  94.0 | 53.79
Output  | 0.056749   | 0.057064   | 0.05758    |   0.1 |  0.08
Modify  | 15.519     | 22.303     | 30.722     | 142.5 | 31.34
Other   |            | 9.18       |            |       | 12.90

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.07                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.3300856403214
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.17
  ghost atom cutoff = 3.17
  binsize = 1.585, bins = 81 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.21 | 17.68 | 18.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034239005  -7.5657637e-41  0              0.010271701    12633.057      0              6.100051e+10   2.6109412e-16  0              3.3268706    
    200000   127.27922      200            200            0.0013020149   2.4215058e-39  0              0.0039060447   3424.0829      0              1.6533671e+10  2.6109412e-16  0              3.0826867    
    300000   127.27922      200            200            0.00017606547  7.7697333e-37  0              0.0005281964   121.25296      0              5.8548714e+08  2.6109412e-16  0              3.075355     
    400000   127.27922      200            200            0.0043155109  -5.8182796e-37  0              0.012946533    197.22063      0              9.5230783e+08  2.6109412e-16  0              3.0302931    
    500000   127.27922      200            200            0.0038141173   5.0728006e-37  0              0.011442352    28.472504      0              1.3748353e+08  2.6109412e-16  0              3.0305695    
    600000   127.27922      200            200            0.0032676415  -1.030391e-36   0              0.0098029244   2.2394298      0              10813405       2.6109412e-16  0              3.0309648    
    700000   127.27922      200            200            0.0038201442  -3.9049327e-37  0              0.011460433    0.29037717     0              1402127.4      2.6109412e-16  0              3.0305075    
    800000   127.27922      200            200            0.0040447932   5.1029899e-37  0              0.012134379    0.042521372    0              205320.49      2.6109412e-16  0              3.0303288    
    900000   127.27922      200            200            0.004124483   -1.0901597e-37  0              0.012373449    0.0062496577   0              30177.361      2.6109412e-16  0              3.0302662    
   1000000   127.27922      200            200            0.0041520688  -1.3293814e-37  0              0.012456206    0.00091073959  0              4397.6355      2.6109412e-16  0              3.0302445    
   1100000   127.27922      200            200            0.0041615263   1.1322058e-38  0              0.012484579    0.00013160996  0              635.49738      2.6109412e-16  0              3.0302371    
   1200000   127.27922      200            200            0.0041647415  -4.2736746e-38  0              0.012494225    1.8875843e-05  0              91.144691      2.6109412e-16  0              3.0302345    
   1300000   127.27922      200            200            0.0041658242   4.9823392e-39  0              0.012497473    2.6884659e-06  0              12.981639      2.6109412e-16  0              3.0302337    
   1400000   127.27922      200            200            0.0041661846   5.2189424e-39  0              0.012498554    3.8041902e-07  0              1.8369073      2.6109412e-16  0              3.0302334    
   1500000   127.27922      200            200            0.0041663029   1.793658e-39   0              0.012498909    5.3495101e-08  0              0.2583087      2.6109412e-16  0              3.0302333    
   1600000   127.27922      200            200            0.004166341   -1.3161257e-39  0              0.012499023    7.4776509e-09  0              0.0361069      2.6109412e-16  0              3.0302333    
   1700000   127.27922      200            200            0.0041663531   1.7139788e-39  0              0.012499059    1.0391993e-09  0              0.0050179216   2.6109412e-16  0              3.0302333    
   1800000   127.27922      200            200            0.0041663567   3.6938404e-39  0              0.01249907     1.4361101e-10  0              0.00069344619  2.6109412e-16  0              3.0302333    
   1900000   127.27922      200            200            0.0041663578   7.0259184e-39  0              0.012499073    1.9736247e-11  0              9.5299274e-05  2.6109412e-16  0              3.0302333    
   2000000   127.27922      200            200            0.0041663581  -4.0120192e-39  0              0.012499074    2.6977862e-12  0              1.3026644e-05  2.6109412e-16  0              3.0302333    
   2100000   127.27922      200            200            0.0041663582  -1.5675462e-39  0              0.012499075    3.6677334e-13  0              1.7710172e-06  2.6109412e-16  0              3.0302333    
   2200000   127.27922      200            200            0.0041663582  -7.4186587e-39  0              0.012499075    4.9596848e-14  0              2.3948543e-07  2.6109412e-16  0              3.0302333    
   2300000   127.27922      200            200            0.0041663582  -9.7308497e-40  0              0.012499075    6.6721579e-15  0              3.2217462e-08  2.6109412e-16  0              3.0302333    
   2400000   127.27922      200            200            0.0041663582  -4.0065192e-39  0              0.012499075    8.9212677e-16  0              4.3077609e-09  2.6109412e-16  0              3.0302333    
   2500000   127.27922      200            200            0.0041663582   8.9170742e-39  0              0.012499075    1.187247e-16   0              5.7327908e-10  2.6109412e-16  0              3.0302333    
   2600000   127.27922      200            200            0.0041663582  -9.3966639e-39  0              0.012499075    1.5923965e-17  0              7.6891126e-11  2.6109412e-16  0              3.0302333    
   2700000   127.27922      200            200            0.0041663582   4.0166931e-39  0              0.012499075    1.9396006e-18  0              9.3656373e-12  2.6109412e-16  0              3.0302333    
   2800000   127.27922      200            200            0.0041663582   9.2283781e-39  0              0.012499075    2.5938716e-19  0              1.2524878e-12  2.6109412e-16  0              3.0302333    
   2900000   127.27922      200            200            0.0041663582  -1.0048988e-39  0              0.012499075    9.4953472e-20  0              4.5849633e-13  2.6109412e-16  0              3.0302333    
   3000000   127.27922      200            200            0.0041663582   1.5706433e-38  0              0.012499075    5.2508536e-21  0              2.5354493e-14  2.6109412e-16  0              3.0302333    
Loop time of 71.3181 on 4 procs for 3000000 steps with 51 atoms

Performance: 36344225.707 ns/day, 0.000 hours/ns, 42065.076 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24454    | 1.2957     | 4.2369     | 149.3 |  1.82
Neigh   | 0.083315   | 0.085064   | 0.088005   |   0.7 |  0.12
Comm    | 30.638     | 38.347     | 44.824     |  93.8 | 53.77
Output  | 0.056272   | 0.056534   | 0.056939   |   0.1 |  0.08
Modify  | 15.484     | 22.278     | 30.676     | 142.5 | 31.24
Other   |            | 9.256      |            |       | 12.98

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.08                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.6568488706868
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.18
  ghost atom cutoff = 3.18
  binsize = 1.59, bins = 81 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.21 | 17.68 | 18.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034337105  -1.2102294e-39  0              0.010301131    12681.477      0              6.1234312e+10  2.6109412e-16  0              3.3270232    
    200000   127.27922      200            200            0.0013165692  -3.8640655e-38  0              0.0039497075   3479.3806      0              1.6800684e+10  2.6109412e-16  0              3.0842885    
    300000   127.27922      200            200            0.00018815524  1.5684509e-37  0              0.00056446571  136.60675      0              6.5962509e+08  2.6109412e-16  0              3.0795924    
    400000   127.27922      200            200            0.0057615506  -1.5057009e-35  0              0.017284652    192.89076      0              9.3140043e+08  2.6109412e-16  0              3.0342464    
    500000   127.27922      200            200            0.004477217    4.1479559e-36  0              0.013431651    28.579016      0              1.3799784e+08  2.6109412e-16  0              3.0350671    
    600000   127.27922      200            200            0.0034888609   1.4483665e-37  0              0.010466583    2.9414119      0              14203025       2.6109412e-16  0              3.0357928    
    700000   127.27922      200            200            0.0039201764   8.3226584e-37  0              0.011760529    0.40064082     0              1934551.1      2.6109412e-16  0              3.0354377    
    800000   127.27922      200            200            0.0040922827  -8.5264353e-38  0              0.012276848    0.058526745    0              282604.7       2.6109412e-16  0              3.0353004    
    900000   127.27922      200            200            0.0041486432   4.2752062e-37  0              0.01244593     0.0084784809   0              40939.55       2.6109412e-16  0              3.0352556    
   1000000   127.27922      200            200            0.0041661627   3.5372834e-38  0              0.012498488    0.0012102435   0              5843.8329      2.6109412e-16  0              3.0352416    
   1100000   127.27922      200            200            0.0041713735  -3.1943903e-39  0              0.012514121    0.00017036256  0              822.61985      2.6109412e-16  0              3.0352374    
   1200000   127.27922      200            200            0.0041728267  -4.947331e-39   0              0.01251848     2.3669093e-05  0              114.28958      2.6109412e-16  0              3.0352362    
   1300000   127.27922      200            200            0.0041731878  -6.5213898e-39  0              0.012519563    3.2471042e-06  0              15.679104      2.6109412e-16  0              3.0352359    
   1400000   127.27922      200            200            0.0041732562  -1.0372227e-39  0              0.012519769    4.39957e-07    0              2.1243949      2.6109412e-16  0              3.0352358    
   1500000   127.27922      200            200            0.0041732575  -1.207878e-39   0              0.012519772    5.8875678e-08  0              0.28428958     2.6109412e-16  0              3.0352358    
   1600000   127.27922      200            200            0.0041732491  -7.1289601e-39  0              0.012519747    7.7806099e-09  0              0.037569781    2.6109412e-16  0              3.0352358    
   1700000   127.27922      200            200            0.0041732429   9.526821e-40   0              0.012519729    1.0151094e-09  0              0.0049015999   2.6109412e-16  0              3.0352358    
   1800000   127.27922      200            200            0.0041732394  -1.6986676e-39  0              0.012519718    1.3068513e-10  0              0.00063103173  2.6109412e-16  0              3.0352358    
   1900000   127.27922      200            200            0.0041732377  -4.1944692e-39  0              0.012519713    1.6590256e-11  0              8.0108409e-05  2.6109412e-16  0              3.0352358    
   2000000   127.27922      200            200            0.0041732369  -5.3105061e-39  0              0.012519711    2.0749088e-12  0              1.0018992e-05  2.6109412e-16  0              3.0352358    
   2100000   127.27922      200            200            0.0041732366  -5.0325077e-39  0              0.01251971     2.5535011e-13  0              1.2329943e-06  2.6109412e-16  0              3.0352358    
   2200000   127.27922      200            200            0.0041732364   2.7044601e-39  0              0.012519709    3.088089e-14   0              1.4911277e-07  2.6109412e-16  0              3.0352358    
   2300000   127.27922      200            200            0.0041732364  -2.6634439e-39  0              0.012519709    3.6629519e-15  0              1.7687084e-08  2.6109412e-16  0              3.0352358    
   2400000   127.27922      200            200            0.0041732363   2.3668266e-38  0              0.012519709    4.2311889e-16  0              2.0430897e-09  2.6109412e-16  0              3.0352358    
   2500000   127.27922      200            200            0.0041732363  -5.4414763e-39  0              0.012519709    4.8736544e-17  0              2.3533133e-10  2.6109412e-16  0              3.0352358    
   2600000   127.27922      200            200            0.0041732363  -1.2501558e-38  0              0.012519709    5.8420144e-18  0              2.8208997e-11  2.6109412e-16  0              3.0352358    
   2700000   127.27922      200            200            0.0041732363  -1.1245922e-39  0              0.012519709    4.0965328e-19  0              1.9780691e-12  2.6109412e-16  0              3.0352358    
   2800000   127.27922      200            200            0.0041732363   6.9203474e-39  0              0.012519709    3.2349782e-20  0              1.5620552e-13  2.6109412e-16  0              3.0352358    
   2900000   127.27922      200            200            0.0041732363  -7.7132942e-39  0              0.012519709    3.3517519e-20  0              1.6184411e-13  2.6109412e-16  0              3.0352358    
   3000000   127.27922      200            200            0.0041732363  -9.8969586e-39  0              0.012519709    4.2209045e-21  0              2.0381237e-14  2.6109412e-16  0              3.0352358    
Loop time of 71.1452 on 4 procs for 3000000 steps with 51 atoms

Performance: 36432521.296 ns/day, 0.000 hours/ns, 42167.270 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.26283    | 1.2766     | 4.1656     | 147.7 |  1.79
Neigh   | 0.082634   | 0.084372   | 0.087404   |   0.7 |  0.12
Comm    | 30.643     | 38.3       | 44.695     |  93.5 | 53.83
Output  | 0.061274   | 0.061701   | 0.062469   |   0.2 |  0.09
Modify  | 15.429     | 22.235     | 30.663     | 143.1 | 31.25
Other   |            | 9.188      |            |       | 12.91

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.09                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.9857408442343
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.19
  ghost atom cutoff = 3.19
  binsize = 1.595, bins = 80 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.19 | 17.66 | 18.82 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034435225   6.0527228e-40  0              0.010330568    12729.968      0              6.1468459e+10  2.6109412e-16  0              3.3271643    
    200000   127.27922      200            200            0.0013311684   2.9057159e-38  0              0.0039935051   3535.0758      0              1.7069616e+10  2.6109412e-16  0              3.0858596    
    300000   127.27922      200            200            0.00020037551  1.5595793e-37  0              0.00060112652  152.85652      0              7.3808943e+08  2.6109412e-16  0              3.0837833    
    400000   127.27922      200            200            0.0073138384  -2.0077475e-38  0              0.021941515    180.90937      0              8.7354659e+08  2.6109412e-16  0              3.0382206    
    500000   127.27922      200            200            0.0051667304  -1.3279258e-36  0              0.015500191    27.00183       0              1.3038218e+08  2.6109412e-16  0              3.0395706    
    600000   127.27922      200            200            0.0037404765  -5.1932384e-37  0              0.011221429    3.4993581      0              16897148       2.6109412e-16  0              3.0406003    
    700000   127.27922      200            200            0.0040335582  -4.1864587e-36  0              0.012100674    0.48426358     0              2338335.5      2.6109412e-16  0              3.0403582    
    800000   127.27922      200            200            0.0041449946  -4.7015268e-38  0              0.012434984    0.068911134    0              332747.2       2.6109412e-16  0              3.040268     
    900000   127.27922      200            200            0.0041747201   4.7164476e-39  0              0.01252416     0.0096093999   0              46400.353      2.6109412e-16  0              3.0402435    
   1000000   127.27922      200            200            0.0041809135  -3.3770411e-39  0              0.012542741    0.0013094603   0              6322.9152      2.6109412e-16  0              3.0402381    
   1100000   127.27922      200            200            0.0041814241   1.928469e-38   0              0.012544272    0.000174457    0              842.39042      2.6109412e-16  0              3.0402375    
   1200000   127.27922      200            200            0.0041809636  -2.3592913e-39  0              0.012542891    2.2720688e-05  0              109.71007      2.6109412e-16  0              3.0402378    
   1300000   127.27922      200            200            0.0041805584   3.1583733e-39  0              0.012541675    2.8902092e-06  0              13.955786      2.6109412e-16  0              3.040238     
   1400000   127.27922      200            200            0.0041803243   1.1715309e-39  0              0.012540973    3.5855742e-07  0              1.7313454      2.6109412e-16  0              3.0402382    
   1500000   127.27922      200            200            0.0041802079   2.1717311e-39  0              0.012540624    4.3282646e-08  0              0.20899641     2.6109412e-16  0              3.0402383    
   1600000   127.27922      200            200            0.0041801545  -4.4885392e-39  0              0.012540463    5.0669227e-09  0              0.024466356    2.6109412e-16  0              3.0402383    
   1700000   127.27922      200            200            0.0041801311  -5.0193569e-39  0              0.012540393    5.7247355e-10  0              0.0027642699   2.6109412e-16  0              3.0402383    
   1800000   127.27922      200            200            0.0041801212  -5.4216832e-39  0              0.012540364    6.1980605e-11  0              0.00029928216  2.6109412e-16  0              3.0402383    
   1900000   127.27922      200            200            0.0041801172  -8.3719745e-40  0              0.012540351    6.3616451e-12  0              3.0718108e-05  2.6109412e-16  0              3.0402384    
   2000000   127.27922      200            200            0.0041801155   1.1162894e-38  0              0.012540347    6.0835665e-13  0              2.9375365e-06  2.6109412e-16  0              3.0402384    
   2100000   127.27922      200            200            0.0041801149  -4.5104998e-39  0              0.012540345    5.2585224e-14  0              2.5391523e-07  2.6109412e-16  0              3.0402384    
   2200000   127.27922      200            200            0.0041801146   5.7468479e-40  0              0.012540344    3.879002e-15   0              1.8730313e-08  2.6109412e-16  0              3.0402384    
   2300000   127.27922      200            200            0.0041801145   3.4324386e-39  0              0.012540344    2.1016551e-16  0              1.014814e-09   2.6109412e-16  0              3.0402384    
   2400000   127.27922      200            200            0.0041801145  -1.9758388e-39  0              0.012540343    4.6566046e-18  0              2.2485077e-11  2.6109412e-16  0              3.0402384    
   2500000   127.27922      200            200            0.0041801145   1.0996519e-38  0              0.012540343    1.1612309e-19  0              5.6071687e-13  2.6109412e-16  0              3.0402384    
   2600000   127.27922      200            200            0.0041801145  -7.2657014e-39  0              0.012540343    2.4235524e-19  0              1.1702467e-12  2.6109412e-16  0              3.0402384    
   2700000   127.27922      200            200            0.0041801145   1.4944307e-40  0              0.012540343    2.1699332e-19  0              1.0477831e-12  2.6109412e-16  0              3.0402384    
   2800000   127.27922      200            200            0.0041801145  -6.3403609e-40  0              0.012540343    2.2661586e-20  0              1.0942469e-13  2.6109412e-16  0              3.0402384    
   2900000   127.27922      200            200            0.0041801145   3.7195948e-39  0              0.012540343    9.6925857e-22  0              4.6802028e-15  2.6109412e-16  0              3.0402384    
   3000000   127.27922      200            200            0.0041801145   1.4442314e-38  0              0.012540343    2.4852149e-20  0              1.2000213e-13  2.6109412e-16  0              3.0402384    
Loop time of 71.1547 on 4 procs for 3000000 steps with 51 atoms

Performance: 36427689.569 ns/day, 0.000 hours/ns, 42161.678 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23587    | 1.3746     | 4.5412     | 156.0 |  1.93
Neigh   | 0.083157   | 0.085247   | 0.088507   |   0.8 |  0.12
Comm    | 30.45      | 38.262     | 44.841     |  94.2 | 53.77
Output  | 0.06121    | 0.061624   | 0.062467   |   0.2 |  0.09
Modify  | 15.361     | 22.202     | 30.738     | 143.6 | 31.20
Other   |            | 9.169      |            |       | 12.89

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.1                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.3167684724676
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.2
  ghost atom cutoff = 3.2
  binsize = 1.6, bins = 80 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.24 | 17.71 | 18.87 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034533364  -2.4210267e-39  0              0.010360009    12778.529      0              6.1702945e+10  2.6109412e-16  0              3.3272939    
    200000   127.27922      200            200            0.0013458113   4.1756977e-41  0              0.0040374339   3591.1636      0              1.7340444e+10  2.6109412e-16  0              3.0874       
    300000   127.27922      200            200            0.00021272449 -3.085319e-37   0              0.00063817348  169.99788      0              8.208589e+08   2.6109412e-16  0              3.0879277    
    400000   127.27922      200            200            0.0091045641   0.00016372553  0              0.027149967    161.55471      0              7.8008985e+08  2.6109412e-16  0              3.0422377    
    500000   127.27922      200            200            0.005857534    1.3318229e-36  0              0.017572602    23.851945      0              1.1517251e+08  2.6109412e-16  0              3.0440954    
    600000   127.27922      200            200            0.0040147969  -6.2995078e-36  0              0.012044391    3.8263163      0              18475912       2.6109412e-16  0              3.0453945    
    700000   127.27922      200            200            0.0041553165   4.1716286e-37  0              0.012465949    0.52469134     0              2533546.7      2.6109412e-16  0              3.0452729    
    800000   127.27922      200            200            0.0042001114  -1.6524319e-37  0              0.012600334    0.071123316    0              343429.04      2.6109412e-16  0              3.0452339    
    900000   127.27922      200            200            0.0042012483   1.2144731e-38  0              0.012603745    0.0093070501   0              44940.414      2.6109412e-16  0              3.0452311    
   1000000   127.27922      200            200            0.004195597    1.3373583e-38  0              0.012586791    0.0011738609   0              5668.1542      2.6109412e-16  0              3.0452347    
   1100000   127.27922      200            200            0.0041913329  -1.4482697e-38  0              0.012573999    0.00014238359  0              687.51939      2.6109412e-16  0              3.0452377    
   1200000   127.27922      200            200            0.0041889928   5.4636078e-39  0              0.012566978    1.6534751e-05  0              79.840397      2.6109412e-16  0              3.0452394    
   1300000   127.27922      200            200            0.0041878639  -5.6131085e-40  0              0.012563592    1.8249523e-06  0              8.8120414      2.6109412e-16  0              3.0452402    
   1400000   127.27922      200            200            0.0041873574   5.5075614e-39  0              0.012562072    1.8920528e-07  0              0.91360458     2.6109412e-16  0              3.0452406    
   1500000   127.27922      200            200            0.0041871407  -1.5889627e-39  0              0.012561422    1.8070303e-08  0              0.087255025    2.6109412e-16  0              3.0452408    
   1600000   127.27922      200            200            0.0041870513  -4.0082043e-39  0              0.012561154    1.5347451e-09  0              0.0074107347   2.6109412e-16  0              3.0452408    
   1700000   127.27922      200            200            0.0041870153  -1.5064886e-39  0              0.012561046    1.0775406e-10  0              0.00052030581  2.6109412e-16  0              3.0452409    
   1800000   127.27922      200            200            0.0041870012   7.7645259e-39  0              0.012561004    5.1489156e-12  0              2.4862271e-05  2.6109412e-16  0              3.0452409    
   1900000   127.27922      200            200            0.0041869958   2.3307143e-40  0              0.012560987    6.2588091e-14  0              3.0221549e-07  2.6109412e-16  0              3.0452409    
   2000000   127.27922      200            200            0.0041869938  -1.0963466e-39  0              0.012560981    1.5531214e-14  0              7.4994672e-08  2.6109412e-16  0              3.0452409    
   2100000   127.27922      200            200            0.004186993   -3.4692171e-39  0              0.012560979    1.5568379e-14  0              7.5174129e-08  2.6109412e-16  0              3.0452409    
   2200000   127.27922      200            200            0.0041869927   1.5993039e-39  0              0.012560978    5.4851653e-15  0              2.64859e-08    2.6109412e-16  0              3.0452409    
   2300000   127.27922      200            200            0.0041869926   6.8598044e-39  0              0.012560978    1.3833921e-15  0              6.6799051e-09  2.6109412e-16  0              3.0452409    
   2400000   127.27922      200            200            0.0041869926   2.6421091e-39  0              0.012560978    2.9154604e-16  0              1.4077715e-09  2.6109412e-16  0              3.0452409    
   2500000   127.27922      200            200            0.0041869926   4.6979842e-39  0              0.012560978    5.4563191e-17  0              2.6346612e-10  2.6109412e-16  0              3.0452409    
   2600000   127.27922      200            200            0.0041869926  -1.6009034e-38  0              0.012560978    9.4566626e-18  0              4.5662839e-11  2.6109412e-16  0              3.0452409    
   2700000   127.27922      200            200            0.0041869926  -8.6197948e-39  0              0.012560978    1.6206971e-18  0              7.8257662e-12  2.6109412e-16  0              3.0452409    
   2800000   127.27922      200            200            0.0041869926   6.305278e-39   0              0.012560978    2.0410283e-19  0              9.8553954e-13  2.6109412e-16  0              3.0452409    
   2900000   127.27922      200            200            0.0041869926   6.9965504e-39  0              0.012560978    7.8154621e-20  0              3.773807e-13   2.6109412e-16  0              3.0452409    
   3000000   127.27922      200            200            0.0041869926   1.5264673e-38  0              0.012560978    7.935658e-20   0              3.8318453e-13  2.6109412e-16  0              3.0452409    
Loop time of 70.7544 on 4 procs for 3000000 steps with 51 atoms

Performance: 36633780.191 ns/day, 0.000 hours/ns, 42400.209 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24306    | 1.2435     | 4.0512     | 145.4 |  1.76
Neigh   | 0.090016   | 0.092133   | 0.09543    |   0.7 |  0.13
Comm    | 30.515     | 38.153     | 44.536     |  93.4 | 53.92
Output  | 0.057311   | 0.057579   | 0.058014   |   0.1 |  0.08
Modify  | 15.301     | 22.082     | 30.491     | 143.2 | 31.21
Other   |            | 9.126      |            |       | 12.90

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.11                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.6499386668908
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.21
  ghost atom cutoff = 3.21
  binsize = 1.605, bins = 80 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.15 | 17.62 | 18.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.003463152    3.2054325e-39  0              0.010389456    12827.161      0              6.1937771e+10  2.6109412e-16  0              3.327412     
    200000   127.27922      200            200            0.0013604979  -9.6686978e-39  0              0.0040814937   3647.6447      0              1.7613171e+10  2.6109412e-16  0              3.0889096    
    300000   127.27922      200            200            0.00022520186 -2.3155069e-37  0              0.00067560557  188.02839      0              9.0792179e+08  2.6109412e-16  0              3.0920257    
    400000   127.27922      200            200            0.012049791    0.0013629397   0              0.034786432    133.70181      0              6.4559821e+08  2.6109412e-16  0              3.0463236    
    500000   127.27922      200            200            0.0065212447   2.40738e-36    0              0.019563734    19.461833      0              93974227       2.6109412e-16  0              3.0486569    
    600000   127.27922      200            200            0.0043024416   2.3154655e-36  0              0.012907325    3.867317       0              18673890       2.6109412e-16  0              3.0501833    
    700000   127.27922      200            200            0.0042798821  -1.175014e-37   0              0.012839646    0.51367905     0              2480372.3      2.6109412e-16  0              3.0501863    
    800000   127.27922      200            200            0.0042546302   1.3559646e-37  0              0.012763891    0.064621038    0              312031.87      2.6109412e-16  0              3.0502003    
    900000   127.27922      200            200            0.0042267248  -1.5598472e-37  0              0.012680174    0.0076669303   0              37020.862      2.6109412e-16  0              3.0502195    
   1000000   127.27922      200            200            0.0042094973  -3.9995092e-38  0              0.012628492    0.00085313484  0              4119.4828      2.6109412e-16  0              3.0502319    
   1100000   127.27922      200            200            0.0042007723   1.0632191e-37  0              0.012602317    8.7841279e-05  0              424.1541       2.6109412e-16  0              3.0502383    
   1200000   127.27922      200            200            0.0041967693   4.1018975e-39  0              0.012590308    8.1611558e-06  0              39.407301      2.6109412e-16  0              3.0502412    
   1300000   127.27922      200            200            0.0041950425  -1.5308983e-38  0              0.012585127    6.5153737e-07  0              3.1460408      2.6109412e-16  0              3.0502425    
   1400000   127.27922      200            200            0.0041943297  -1.7527691e-40  0              0.012582989    3.9929477e-08  0              0.19280515     2.6109412e-16  0              3.050243     
   1500000   127.27922      200            200            0.0041940456  -1.4118518e-39  0              0.012582137    1.2916178e-09  0              0.0062367601   2.6109412e-16  0              3.0502433    
   1600000   127.27922      200            200            0.0041939356  -3.0766955e-39  0              0.012581807    8.6800831e-13  0              4.1913015e-06  2.6109412e-16  0              3.0502433    
   1700000   127.27922      200            200            0.0041938942   1.2886592e-38  0              0.012581683    3.0694482e-11  0              0.00014821267  2.6109412e-16  0              3.0502434    
   1800000   127.27922      200            200            0.004193879    8.3432012e-39  0              0.012581637    1.5200453e-11  0              7.3397549e-05  2.6109412e-16  0              3.0502434    
   1900000   127.27922      200            200            0.0041938735   5.725705e-39   0              0.012581621    4.3376034e-12  0              2.0944734e-05  2.6109412e-16  0              3.0502434    
   2000000   127.27922      200            200            0.0041938716  -1.312191e-38   0              0.012581615    9.7113499e-13  0              4.6892633e-06  2.6109412e-16  0              3.0502434    
   2100000   127.27922      200            200            0.004193871   -1.3686526e-38  0              0.012581613    1.8842616e-13  0              9.0984248e-07  2.6109412e-16  0              3.0502434    
   2200000   127.27922      200            200            0.0041938708   5.251261e-39   0              0.012581612    3.3118265e-14  0              1.5991625e-07  2.6109412e-16  0              3.0502434    
   2300000   127.27922      200            200            0.0041938707   2.5436599e-39  0              0.012581612    5.403583e-15   0              2.6091969e-08  2.6109412e-16  0              3.0502434    
   2400000   127.27922      200            200            0.0041938707   7.2538344e-39  0              0.012581612    8.252218e-16   0              3.9847007e-09  2.6109412e-16  0              3.0502434    
   2500000   127.27922      200            200            0.0041938707   1.6971906e-38  0              0.012581612    1.2013762e-16  0              5.8010157e-10  2.6109412e-16  0              3.0502434    
   2600000   127.27922      200            200            0.0041938707   2.3633545e-40  0              0.012581612    1.6448013e-17  0              7.9421567e-11  2.6109412e-16  0              3.0502434    
   2700000   127.27922      200            200            0.0041938707   5.4809122e-39  0              0.012581612    2.0754356e-18  0              1.0021536e-11  2.6109412e-16  0              3.0502434    
   2800000   127.27922      200            200            0.0041938707   2.4563925e-39  0              0.012581612    2.5519101e-19  0              1.2322261e-12  2.6109412e-16  0              3.0502434    
   2900000   127.27922      200            200            0.0041938707   1.6598567e-38  0              0.012581612    1.3595061e-19  0              6.5645686e-13  2.6109412e-16  0              3.0502434    
   3000000   127.27922      200            200            0.0041938707  -1.5023846e-38  0              0.012581612    2.0957244e-20  0              1.0119503e-13  2.6109412e-16  0              3.0502434    
Loop time of 70.9807 on 4 procs for 3000000 steps with 51 atoms

Performance: 36516952.892 ns/day, 0.000 hours/ns, 42264.992 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27288    | 1.2888     | 4.1897     | 147.6 |  1.82
Neigh   | 0.083836   | 0.086313   | 0.090043   |   0.9 |  0.12
Comm    | 30.563     | 38.164     | 44.591     |  92.9 | 53.77
Output  | 0.059835   | 0.060181   | 0.060724   |   0.1 |  0.08
Modify  | 15.396     | 22.166     | 30.516     | 142.3 | 31.23
Other   |            | 9.215      |            |       | 12.98

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.12                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.9852583390075
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.22
  ghost atom cutoff = 3.22
  binsize = 1.61, bins = 80 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.15 | 17.62 | 18.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034729694  -1.4525145e-38  0              0.010418908    12875.864      0              6.2172938e+10  2.6109412e-16  0              3.3275186    
    200000   127.27922      200            200            0.0013752278  -6.0525254e-40  0              0.0041256833   3704.5176      0              1.788779e+10   2.6109412e-16  0              3.0903885    
    300000   127.27922      200            200            0.00023780659 -2.3123225e-37  0              0.00071341977  206.94474      0              9.9926207e+08  2.6109412e-16  0              3.096077     
    400000   127.27922      200            200            0.015319764    0.0029426555   0              0.043016638    98.127992      0              4.7382495e+08  2.6109412e-16  0              3.0505141    
    500000   127.27922      200            200            0.0071278303  -3.1236637e-37  0              0.021383491    14.360534      0              69341881       2.6109412e-16  0              3.0532697    
    600000   127.27922      200            200            0.0045925236   4.6890682e-36  0              0.013777571    3.6098534      0              17430690       2.6109412e-16  0              3.0549749    
    700000   127.27922      200            200            0.0044013235   2.9212606e-37  0              0.013203971    0.45307378     0              2187731.1      2.6109412e-16  0              3.0551029    
    800000   127.27922      200            200            0.004305543   -3.806246e-38   0              0.012916629    0.051006664    0              246292.92      2.6109412e-16  0              3.0551695    
    900000   127.27922      200            200            0.0042497227   6.6844573e-38  0              0.012749168    0.0051837653   0              25030.547      2.6109412e-16  0              3.0552098    
   1000000   127.27922      200            200            0.0042219719   1.6271922e-37  0              0.012665916    0.00046249758  0              2233.2353      2.6109412e-16  0              3.0552301    
   1100000   127.27922      200            200            0.0042094667  -8.3478252e-39  0              0.0126284      3.3783408e-05  0              163.12799      2.6109412e-16  0              3.0552394    
   1200000   127.27922      200            200            0.0042041811   4.6921887e-39  0              0.012612543    1.6735624e-06  0              8.0810341      2.6109412e-16  0              3.0552433    
   1300000   127.27922      200            200            0.0042020512   1.7581276e-39  0              0.012606154    2.2219975e-08  0              0.10729231     2.6109412e-16  0              3.0552449    
   1400000   127.27922      200            200            0.0042012262  -4.2443068e-40  0              0.012603678    4.5234337e-09  0              0.021842043    2.6109412e-16  0              3.0552455    
   1500000   127.27922      200            200            0.0042009177  -2.3313347e-39  0              0.012602753    4.7345065e-09  0              0.022861237    2.6109412e-16  0              3.0552458    
   1600000   127.27922      200            200            0.0042008064   2.9929499e-39  0              0.012602419    1.6530082e-09  0              0.0079817852   2.6109412e-16  0              3.0552458    
   1700000   127.27922      200            200            0.0042007676  -3.0807328e-39  0              0.012602303    4.036084e-10   0              0.0019488805   2.6109412e-16  0              3.0552459    
   1800000   127.27922      200            200            0.0042007546  -4.8278841e-39  0              0.012602264    8.1474567e-11  0              0.00039341152  2.6109412e-16  0              3.0552459    
   1900000   127.27922      200            200            0.0042007504   4.4558849e-39  0              0.012602251    1.4506417e-11  0              7.0046298e-05  2.6109412e-16  0              3.0552459    
   2000000   127.27922      200            200            0.0042007492   2.9861841e-39  0              0.012602248    2.3494438e-12  0              1.1344623e-05  2.6109412e-16  0              3.0552459    
   2100000   127.27922      200            200            0.0042007488   6.5143299e-39  0              0.012602247    3.5173193e-13  0              1.6983876e-06  2.6109412e-16  0              3.0552459    
   2200000   127.27922      200            200            0.0042007488  -3.1058234e-39  0              0.012602246    4.903167e-14   0              2.3675639e-07  2.6109412e-16  0              3.0552459    
   2300000   127.27922      200            200            0.0042007488  -1.6517313e-39  0              0.012602246    6.3765505e-15  0              3.079008e-08   2.6109412e-16  0              3.0552459    
   2400000   127.27922      200            200            0.0042007488  -4.8469618e-39  0              0.012602246    7.7088755e-16  0              3.7223401e-09  2.6109412e-16  0              3.0552459    
   2500000   127.27922      200            200            0.0042007488  -5.7241266e-40  0              0.012602246    8.4944271e-17  0              4.1016548e-10  2.6109412e-16  0              3.0552459    
   2600000   127.27922      200            200            0.0042007488   1.8450032e-38  0              0.012602246    8.8945966e-18  0              4.2948824e-11  2.6109412e-16  0              3.0552459    
   2700000   127.27922      200            200            0.0042007488  -3.4476559e-39  0              0.012602246    5.4277772e-19  0              2.6208794e-12  2.6109412e-16  0              3.0552459    
   2800000   127.27922      200            200            0.0042007488  -1.6616852e-38  0              0.012602246    2.4696037e-20  0              1.1924832e-13  2.6109412e-16  0              3.0552459    
   2900000   127.27922      200            200            0.0042007488  -2.8812861e-39  0              0.012602246    6.8790783e-20  0              3.3216607e-13  2.6109412e-16  0              3.0552459    
   3000000   127.27922      200            200            0.0042007488   2.5260268e-40  0              0.012602246    6.1641504e-21  0              2.9764476e-14  2.6109412e-16  0              3.0552459    
Loop time of 71.0833 on 4 procs for 3000000 steps with 51 atoms

Performance: 36464277.849 ns/day, 0.000 hours/ns, 42204.025 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27314    | 1.3143     | 4.2801     | 149.4 |  1.85
Neigh   | 0.089572   | 0.091908   | 0.095536   |   0.8 |  0.13
Comm    | 30.479     | 38.17      | 44.62      |  93.3 | 53.70
Output  | 0.059961   | 0.060382   | 0.061131   |   0.2 |  0.08
Modify  | 15.419     | 22.24      | 30.708     | 142.8 | 31.29
Other   |            | 9.206      |            |       | 12.95

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.13                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.3227344003217
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.23
  ghost atom cutoff = 3.23
  binsize = 1.615, bins = 79 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.13 | 17.6 | 18.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034827885   3.1277669e-45  0              0.010448366    12924.637      0              6.2408445e+10  2.6109412e-16  0              3.3276136    
    200000   127.27922      200            200            0.0013900006  -8.7149773e-38  0              0.0041700017   3761.7812      0              1.8164295e+10  2.6109412e-16  0              3.0918365    
    300000   127.27922      200            200            0.00025053758  2.3387574e-37  0              0.00075161274  226.74339      0              1.0948627e+09  2.6109412e-16  0              3.1000817    
    400000   127.27922      200            200            0.018374844    0.0045170164   0              0.050607517    59.944553      0              2.8945079e+08  2.6109412e-16  0              3.0548485    
    500000   127.27922      200            200            0.0076477113   1.9859259e-36  0              0.022943134    9.2109961      0              44476604       2.6109412e-16  0              3.0579475    
    600000   127.27922      200            200            0.0048730781   4.566407e-36   0              0.014619234    3.0884798      0              14913163       2.6109412e-16  0              3.0597778    
    700000   127.27922      200            200            0.0045136569   2.3765873e-37  0              0.013540971    0.35464589     0              1712458.1      2.6109412e-16  0              3.0600268    
    800000   127.27922      200            200            0.0043500343   1.0265162e-37  0              0.013050103    0.033634883    0              162410.81      2.6109412e-16  0              3.0601436    
    900000   127.27922      200            200            0.0042690029  -1.7510454e-37  0              0.012807009    0.0026007632   0              12558.155      2.6109412e-16  0              3.0602028    
   1000000   127.27922      200            200            0.0042325108   6.5130954e-38  0              0.012697532    0.0001409126   0              680.41654      2.6109412e-16  0              3.0602298    
   1100000   127.27922      200            200            0.0042172226  -8.4638636e-39  0              0.012651668    2.6950687e-06  0              13.013522      2.6109412e-16  0              3.0602412    
   1200000   127.27922      200            200            0.0042111626   1.752658e-38   0              0.012633488    1.8050246e-07  0              0.87158177     2.6109412e-16  0              3.0602457    
   1300000   127.27922      200            200            0.0042088718   3.6677018e-40  0              0.012626616    2.7847558e-07  0              1.3446589      2.6109412e-16  0              3.0602474    
   1400000   127.27922      200            200            0.004208044   -2.8005188e-40  0              0.012624132    1.0375111e-07  0              0.50097698     2.6109412e-16  0              3.060248     
   1500000   127.27922      200            200            0.0042077584   4.35008e-41    0              0.012623275    2.5693237e-08  0              0.12406345     2.6109412e-16  0              3.0602483    
   1600000   127.27922      200            200            0.004207665   -3.0506595e-39  0              0.012622995    5.1431066e-09  0              0.024834221    2.6109412e-16  0              3.0602483    
   1700000   127.27922      200            200            0.0042076365   9.1152896e-39  0              0.01262291     8.9380437e-10  0              0.0043158614   2.6109412e-16  0              3.0602484    
   1800000   127.27922      200            200            0.0042076286   1.9168368e-40  0              0.012622886    1.3926231e-10  0              0.00067244784  2.6109412e-16  0              3.0602484    
   1900000   127.27922      200            200            0.0042076268  -3.7461768e-39  0              0.01262288     1.974126e-11   0              9.5323479e-05  2.6109412e-16  0              3.0602484    
   2000000   127.27922      200            200            0.0042076266   9.4132174e-39  0              0.01262288     2.5573243e-12  0              1.2348404e-05  2.6109412e-16  0              3.0602484    
   2100000   127.27922      200            200            0.0042076267   9.4608506e-40  0              0.01262288     3.0153747e-13  0              1.4560165e-06  2.6109412e-16  0              3.0602484    
   2200000   127.27922      200            200            0.0042076267  -6.1349187e-39  0              0.01262288     3.1906873e-14  0              1.5406687e-07  2.6109412e-16  0              3.0602484    
   2300000   127.27922      200            200            0.0042076268  -9.228743e-40   0              0.01262288     2.9393557e-15  0              1.4193097e-08  2.6109412e-16  0              3.0602484    
   2400000   127.27922      200            200            0.0042076268   2.0697516e-39  0              0.01262288     2.1971927e-16  0              1.0609457e-09  2.6109412e-16  0              3.0602484    
   2500000   127.27922      200            200            0.0042076268   1.9804742e-38  0              0.01262288     1.142293e-17   0              5.515724e-11   2.6109412e-16  0              3.0602484    
   2600000   127.27922      200            200            0.0042076268  -2.175818e-39   0              0.01262288     3.2396487e-19  0              1.5643104e-12  2.6109412e-16  0              3.0602484    
   2700000   127.27922      200            200            0.0042076268  -3.3290615e-39  0              0.012622881    6.574306e-20   0              3.1744971e-13  2.6109412e-16  0              3.0602484    
   2800000   127.27922      200            200            0.0042076268   1.0310326e-38  0              0.012622881    1.8865825e-20  0              9.1096316e-14  2.6109412e-16  0              3.0602484    
   2900000   127.27922      200            200            0.0042076268   1.6972177e-38  0              0.012622881    6.862081e-23   0              3.3134533e-16  2.6109412e-16  0              3.0602484    
   3000000   127.27922      200            200            0.0042076268   9.4139666e-39  0              0.012622881    7.2297398e-20  0              3.4909826e-13  2.6109412e-16  0              3.0602484    
Loop time of 71.4935 on 4 procs for 3000000 steps with 51 atoms

Performance: 36255021.133 ns/day, 0.000 hours/ns, 41961.830 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27451    | 1.2984     | 4.2365     | 148.9 |  1.82
Neigh   | 0.084      | 0.085841   | 0.089061   |   0.7 |  0.12
Comm    | 30.712     | 38.486     | 44.966     |  93.6 | 53.83
Output  | 0.060439   | 0.060911   | 0.061785   |   0.2 |  0.09
Modify  | 15.401     | 22.267     | 30.807     | 143.0 | 31.15
Other   |            | 9.296      |            |       | 13.00

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.14                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.6623737623371
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.24
  ghost atom cutoff = 3.24
  binsize = 1.62, bins = 79 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.13 | 17.6 | 18.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0034926093   9.0790205e-40  0              0.010477828    12973.48       0              6.2644291e+10  2.6109412e-16  0              3.327697     
    200000   127.27922      200            200            0.0014048159   3.8740372e-38  0              0.0042144476   3819.4344      0              1.8442682e+10  2.6109412e-16  0              3.0932535    
    300000   127.27922      200            200            0.00026339422 -1.5406672e-37  0              0.00079018266  247.42163      0              1.1947105e+09  2.6109412e-16  0              3.1040397    
    400000   127.27922      200            200            0.020794093    0.005804913    0              0.056577366    26.464747      0              1.2778879e+08  2.6109412e-16  0              3.0593633    
    500000   127.27922      200            200            0.0080540153   1.4233282e-35  0              0.024162046    4.7165556      0              22774559       2.6109412e-16  0              3.0627019    
    600000   127.27922      200            200            0.0051316776  -1.7796572e-35  0              0.015395033    2.3817201      0              11500474       2.6109412e-16  0              3.0645999    
    700000   127.27922      200            200            0.0046111992  -1.2354438e-37  0              0.013833597    0.23788223     0              1148648.1      2.6109412e-16  0              3.0649622    
    800000   127.27922      200            200            0.0043856739  -3.0004965e-36  0              0.013157022    0.016781734    0              81032.989      2.6109412e-16  0              3.0651244    
    900000   127.27922      200            200            0.0042836121   2.8482816e-37  0              0.012850836    0.00068545131  0              3309.799       2.6109412e-16  0              3.0651993    
   1000000   127.27922      200            200            0.0042407829  -3.2542571e-38  0              0.012722349    1.4176647e-06  0              6.8453953      2.6109412e-16  0              3.0652311    
   1100000   127.27922      200            200            0.0042239484   4.9400626e-38  0              0.012671845    7.2293111e-06  0              34.907756      2.6109412e-16  0              3.0652437    
   1200000   127.27922      200            200            0.0042177024   2.2655835e-39  0              0.012653107    4.3404946e-06  0              20.958695      2.6109412e-16  0              3.0652484    
   1300000   127.27922      200            200            0.0042155135   9.3372444e-40  0              0.012646541    1.2675747e-06  0              6.1206644      2.6109412e-16  0              3.0652501    
   1400000   127.27922      200            200            0.0042147934   2.144818e-39   0              0.01264438     2.7365684e-07  0              1.3213909      2.6109412e-16  0              3.0652506    
   1500000   127.27922      200            200            0.0042145747  -3.9783284e-39  0              0.012643724    4.9151868e-08  0              0.23733678     2.6109412e-16  0              3.0652508    
   1600000   127.27922      200            200            0.0042145158   6.1344759e-39  0              0.012643547    7.6977772e-09  0              0.037169811    2.6109412e-16  0              3.0652508    
   1700000   127.27922      200            200            0.0042145032  -6.6149115e-39  0              0.01264351     1.0715539e-09  0              0.0051741504   2.6109412e-16  0              3.0652508    
   1800000   127.27922      200            200            0.0042145022   8.5778155e-39  0              0.012643507    1.3303065e-10  0              0.00064235742  2.6109412e-16  0              3.0652508    
   1900000   127.27922      200            200            0.0042145032   6.9599352e-39  0              0.01264351     1.4573117e-11  0              7.0368365e-05  2.6109412e-16  0              3.0652508    
   2000000   127.27922      200            200            0.004214504   -1.7753975e-39  0              0.012643512    1.3662801e-12  0              6.5972775e-06  2.6109412e-16  0              3.0652508    
   2100000   127.27922      200            200            0.0042145045   2.9602087e-39  0              0.012643514    1.0187447e-13  0              4.9191535e-07  2.6109412e-16  0              3.0652508    
   2200000   127.27922      200            200            0.0042145047  -3.0313581e-39  0              0.012643514    4.8983672e-15  0              2.3652462e-08  2.6109412e-16  0              3.0652508    
   2300000   127.27922      200            200            0.0042145048   4.4717317e-39  0              0.012643514    4.6430917e-17  0              2.2419828e-10  2.6109412e-16  0              3.0652508    
   2400000   127.27922      200            200            0.0042145049   6.1141352e-39  0              0.012643515    2.1155327e-17  0              1.021515e-10   2.6109412e-16  0              3.0652508    
   2500000   127.27922      200            200            0.0042145049  -1.7219541e-39  0              0.012643515    1.6408244e-17  0              7.922954e-11   2.6109412e-16  0              3.0652508    
   2600000   127.27922      200            200            0.0042145049   8.8202908e-39  0              0.012643515    4.742321e-18   0              2.2898971e-11  2.6109412e-16  0              3.0652508    
   2700000   127.27922      200            200            0.0042145049  -1.4295712e-38  0              0.012643515    1.3425314e-18  0              6.4826035e-12  2.6109412e-16  0              3.0652508    
   2800000   127.27922      200            200            0.0042145049   1.578432e-39   0              0.012643515    2.3067039e-19  0              1.1138248e-12  2.6109412e-16  0              3.0652508    
   2900000   127.27922      200            200            0.0042145049   3.1980005e-39  0              0.012643515    1.6132059e-20  0              7.789594e-14   2.6109412e-16  0              3.0652508    
   3000000   127.27922      200            200            0.0042145049   8.7404061e-39  0              0.012643515    9.4398774e-20  0              4.5581789e-13  2.6109412e-16  0              3.0652508    
Loop time of 70.9607 on 4 procs for 3000000 steps with 51 atoms

Performance: 36527236.805 ns/day, 0.000 hours/ns, 42276.894 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.26763    | 1.2823     | 4.1788     | 147.7 |  1.81
Neigh   | 0.083036   | 0.084157   | 0.086589   |   0.5 |  0.12
Comm    | 30.588     | 38.19      | 44.554     |  92.6 | 53.82
Output  | 0.057348   | 0.057669   | 0.05819    |   0.1 |  0.08
Modify  | 15.462     | 22.17      | 30.533     | 141.8 | 31.24
Other   |            | 9.177      |            |       | 12.93

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.15                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.0041833365577
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.25
  ghost atom cutoff = 3.25
  binsize = 1.625, bins = 79 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.13 | 17.6 | 18.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035024316   1.4848513e-44  0              0.010507295    13022.393      0              6.2880476e+10  2.6109412e-16  0              3.3277689    
    200000   127.27922      200            200            0.0014196732   4.3583235e-38  0              0.0042590196   3877.4756      0              1.8722942e+10  2.6109412e-16  0              3.0946397    
    300000   127.27922      200            200            0.0002763754  -1.531284e-37   0              0.00082912619  268.97596      0              1.2987887e+09  2.6109412e-16  0              3.107951     
    400000   127.27922      200            200            0.022251793    0.0065952861   0              0.060160094    5.0186083      0              24233063       2.6109412e-16  0              3.0640875    
    500000   127.27922      200            200            0.0083406435   1.3854777e-05  0              0.025008076    1.5109744      0              7295954.6      2.6109412e-16  0              3.0675419    
    600000   127.27922      200            200            0.0053561607   3.2138264e-36  0              0.016068482    1.6010639      0              7730964.5      2.6109412e-16  0              3.0694487    
    700000   127.27922      200            200            0.0046889245   4.4169074e-37  0              0.014066774    0.12613229     0              609047.69      2.6109412e-16  0              3.0699124    
    800000   127.27922      200            200            0.0044105867   2.4155969e-36  0              0.01323176     0.0045826221   0              22127.842      2.6109412e-16  0              3.0701131    
    900000   127.27922      200            200            0.004292958   -2.7680648e-38  0              0.012878874    2.9742141e-07  0              1.4361416      2.6109412e-16  0              3.0701997    
   1000000   127.27922      200            200            0.0042466659  -3.0352225e-37  0              0.012739998    9.1367489e-05  0              441.1809       2.6109412e-16  0              3.0702342    
   1100000   127.27922      200            200            0.0042296635   5.0958056e-38  0              0.01268899     4.5092542e-05  0              217.73575      2.6109412e-16  0              3.070247     
   1200000   127.27922      200            200            0.0042238443   8.1132249e-39  0              0.012671533    1.2084531e-05  0              58.351877      2.6109412e-16  0              3.0702514    
   1300000   127.27922      200            200            0.0042220108   2.4465296e-40  0              0.012666032    2.4352024e-06  0              11.758721      2.6109412e-16  0              3.0702528    
   1400000   127.27922      200            200            0.0042214958   2.5858775e-39  0              0.012664487    4.0704937e-07  0              1.9654957      2.6109412e-16  0              3.0702532    
   1500000   127.27922      200            200            0.0042213781   4.3462875e-39  0              0.012664134    5.8561132e-08  0              0.28277075     2.6109412e-16  0              3.0702533    
   1600000   127.27922      200            200            0.0042213642  -1.2127833e-38  0              0.012664093    7.3185447e-09  0              0.035338633    2.6109412e-16  0              3.0702533    
   1700000   127.27922      200            200            0.0042213703  -1.8215975e-39  0              0.012664111    7.8492306e-10  0              0.0037901126   2.6109412e-16  0              3.0702533    
   1800000   127.27922      200            200            0.0042213765   1.3188944e-40  0              0.012664129    6.9273157e-11  0              0.00033449529  2.6109412e-16  0              3.0702533    
   1900000   127.27922      200            200            0.00422138     1.0172473e-39  0              0.01266414     4.4959507e-12  0              2.1709337e-05  2.6109412e-16  0              3.0702533    
   2000000   127.27922      200            200            0.0042213817   5.6883323e-39  0              0.012664145    1.4420821e-13  0              6.9632983e-07  2.6109412e-16  0              3.0702533    
   2100000   127.27922      200            200            0.0042213825   2.0476876e-39  0              0.012664147    2.9397287e-16  0              1.4194898e-09  2.6109412e-16  0              3.0702533    
   2200000   127.27922      200            200            0.0042213828  -5.0500954e-39  0              0.012664148    4.0408109e-15  0              1.9511629e-08  2.6109412e-16  0              3.0702533    
   2300000   127.27922      200            200            0.0042213829  -2.2774371e-39  0              0.012664149    1.8346198e-15  0              8.8587224e-09  2.6109412e-16  0              3.0702533    
   2400000   127.27922      200            200            0.0042213829   1.2800078e-38  0              0.012664149    4.7749953e-16  0              2.3056743e-09  2.6109412e-16  0              3.0702533    
   2500000   127.27922      200            200            0.0042213829   6.3021362e-39  0              0.012664149    9.352475e-17   0              4.5159755e-10  2.6109412e-16  0              3.0702533    
   2600000   127.27922      200            200            0.0042213829  -8.4401564e-39  0              0.012664149    1.5450508e-17  0              7.4604973e-11  2.6109412e-16  0              3.0702533    
   2700000   127.27922      200            200            0.0042213829   4.90539e-39    0              0.012664149    2.1321397e-18  0              1.029534e-11   2.6109412e-16  0              3.0702533    
   2800000   127.27922      200            200            0.0042213829   3.5658946e-40  0              0.012664149    2.6295467e-19  0              1.269714e-12   2.6109412e-16  0              3.0702533    
   2900000   127.27922      200            200            0.0042213829   9.3234861e-40  0              0.012664149    1.1115812e-19  0              5.3674277e-13  2.6109412e-16  0              3.0702533    
   3000000   127.27922      200            200            0.0042213829   1.8108911e-39  0              0.012664149    6.3478889e-20  0              3.0651684e-13  2.6109412e-16  0              3.0702533    
Loop time of 70.4695 on 4 procs for 3000000 steps with 51 atoms

Performance: 36781887.282 ns/day, 0.000 hours/ns, 42571.629 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23087    | 1.2578     | 4.1468     | 148.8 |  1.78
Neigh   | 0.076172   | 0.077746   | 0.080298   |   0.6 |  0.11
Comm    | 30.481     | 37.976     | 44.292     |  91.9 | 53.89
Output  | 0.061377   | 0.061673   | 0.062115   |   0.1 |  0.09
Modify  | 15.35      | 22         | 30.238     | 140.8 | 31.22
Other   |            | 9.096      |            |       | 12.91

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.16                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.3481700344871
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.26
  ghost atom cutoff = 3.26
  binsize = 1.63, bins = 79 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.09 | 17.56 | 18.71 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035122555  -9.0788493e-40  0              0.010536767    13071.377      0              6.3117e+10     2.6109412e-16  0              3.3278291    
    200000   127.27922      200            200            0.0014345725  -4.8396953e-39  0              0.0043037175   3935.9048      0              1.9005076e+10  2.6109412e-16  0              3.0959948    
    300000   127.27922      200            200            0.00028948042 -1.5345024e-37  0              0.00086844125  291.40355      0              1.4070835e+09  2.6109412e-16  0              3.1118153    
    400000   127.27922      200            200            0.022554335    0.0067806905   0              0.060882315    0.64318236     0              3105697.4      2.6109412e-16  0              3.0690389    
    500000   127.27922      200            200            0.0085025099   5.1168251e-05  0              0.025456361    0.05527984     0              266926.56      2.6109412e-16  0              3.0724741    
    600000   127.27922      200            200            0.0055354728  -5.5166444e-37  0              0.016606419    0.87317797     0              4216263.9      2.6109412e-16  0              3.0743307    
    700000   127.27922      200            200            0.0047428153  -2.0626641e-36  0              0.014228446    0.041844208    0              202050.7       2.6109412e-16  0              3.07488      
    800000   127.27922      200            200            0.0044235908  -6.7975033e-37  0              0.013270772    3.1146347e-06  0              15.039456      2.6109412e-16  0              3.0751106    
    900000   127.27922      200            200            0.0042968563   4.3759239e-37  0              0.012890569    0.00073667399  0              3557.1351      2.6109412e-16  0              3.0752042    
   1000000   127.27922      200            200            0.0042502556   8.5582958e-38  0              0.012750767    0.00037649786  0              1817.9734      2.6109412e-16  0              3.0752391    
   1100000   127.27922      200            200            0.0042344953   6.1578672e-38  0              0.012703486    0.00010021272  0              483.89135      2.6109412e-16  0              3.075251     
   1200000   127.27922      200            200            0.0042296812   1.902751e-38   0              0.012689044    1.9651888e-05  0              94.891935      2.6109412e-16  0              3.0752546    
   1300000   127.27922      200            200            0.0042284187  -2.9282596e-39  0              0.012685256    3.1366052e-06  0              15.145544      2.6109412e-16  0              3.0752556    
   1400000   127.27922      200            200            0.00422818     5.1386243e-39  0              0.01268454     4.2098226e-07  0              2.0327727      2.6109412e-16  0              3.0752558    
   1500000   127.27922      200            200            0.0042281825   2.5512836e-39  0              0.012684547    4.7440567e-08  0              0.22907352     2.6109412e-16  0              3.0752558    
   1600000   127.27922      200            200            0.0042282166  -1.8989848e-39  0              0.01268465     4.3254201e-09  0              0.020885906    2.6109412e-16  0              3.0752558    
   1700000   127.27922      200            200            0.0042282403  -1.2241172e-38  0              0.012684721    2.8548338e-10  0              0.0013784971   2.6109412e-16  0              3.0752558    
   1800000   127.27922      200            200            0.0042282524   5.3899533e-39  0              0.012684757    9.0787309e-12  0              4.3837942e-05  2.6109412e-16  0              3.0752557    
   1900000   127.27922      200            200            0.0042282577   1.5971091e-40  0              0.012684773    2.6254038e-14  0              1.2677135e-07  2.6109412e-16  0              3.0752557    
   2000000   127.27922      200            200            0.0042282598   8.3967809e-39  0              0.012684779    2.7248773e-13  0              1.3157457e-06  2.6109412e-16  0              3.0752557    
   2100000   127.27922      200            200            0.0042282606  -4.9983782e-39  0              0.012684782    1.1981566e-13  0              5.7854695e-07  2.6109412e-16  0              3.0752557    
   2200000   127.27922      200            200            0.0042282608  -8.54026e-39    0              0.012684782    3.0053594e-14  0              1.4511805e-07  2.6109412e-16  0              3.0752557    
   2300000   127.27922      200            200            0.0042282609   3.8352311e-39  0              0.012684783    5.6858596e-15  0              2.7454981e-08  2.6109412e-16  0              3.0752557    
   2400000   127.27922      200            200            0.0042282609  -2.964234e-39   0              0.012684783    8.8202878e-16  0              4.2590013e-09  2.6109412e-16  0              3.0752557    
   2500000   127.27922      200            200            0.0042282609  -2.2932576e-39  0              0.012684783    1.1445456e-16  0              5.5266012e-10  2.6109412e-16  0              3.0752557    
   2600000   127.27922      200            200            0.0042282609  -8.6632659e-39  0              0.012684783    1.2601367e-17  0              6.0847491e-11  2.6109412e-16  0              3.0752557    
   2700000   127.27922      200            200            0.0042282609   9.41642e-40    0              0.012684783    1.0051505e-18  0              4.8535121e-12  2.6109412e-16  0              3.0752557    
   2800000   127.27922      200            200            0.0042282609  -1.3408682e-38  0              0.012684783    4.6364428e-20  0              2.2387723e-13  2.6109412e-16  0              3.0752557    
   2900000   127.27922      200            200            0.0042282609   3.5658066e-40  0              0.012684783    4.348035e-20   0              2.0995105e-13  2.6109412e-16  0              3.0752557    
   3000000   127.27922      200            200            0.0042282609   9.572968e-39   0              0.012684783    1.5018279e-22  0              7.2517894e-16  2.6109412e-16  0              3.0752557    
Loop time of 70.276 on 4 procs for 3000000 steps with 51 atoms

Performance: 36883160.908 ns/day, 0.000 hours/ns, 42688.844 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25445    | 1.223      | 4.0066     | 145.4 |  1.74
Neigh   | 0.076806   | 0.079306   | 0.082988   |   0.9 |  0.11
Comm    | 30.639     | 38.088     | 44.331     |  91.8 | 54.20
Output  | 0.059139   | 0.059519   | 0.060207   |   0.2 |  0.08
Modify  | 15.213     | 21.823     | 30         | 141.0 | 31.05
Other   |            | 9.003      |            |       | 12.81

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.17                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.6943407676294
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.27
  ghost atom cutoff = 3.27
  binsize = 1.635, bins = 78 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.07 | 17.54 | 18.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035220809  -1.0894489e-38  0              0.010566243    13120.43       0              6.3353863e+10  2.6109412e-16  0              3.3278778    
    200000   127.27922      200            200            0.0014495132  -1.089445e-38   0              0.0043485397   3994.7206      0              1.9289076e+10  2.6109412e-16  0              3.0973188    
    300000   127.27922      200            200            0.00030270826  2.3423259e-37  0              0.00090812479  314.70105      0              1.5195788e+09  2.6109412e-16  0              3.1156328    
    400000   127.27922      200            200            0.021778115    0.0067090554   0              0.05862529     14.401518      0              69539778       2.6109412e-16  0              3.0742216    
    500000   127.27922      200            200            0.0084562424   5.5300415e-05  0              0.025313427    0.59400443     0              2868234.8      2.6109412e-16  0              3.0775017    
    600000   127.27922      200            200            0.005660476    6.9012418e-36  0              0.016981428    0.3183396      0              1537148        2.6109412e-16  0              3.0792508    
    700000   127.27922      200            200            0.0047701504   5.9731198e-36  0              0.014310451    0.00191311     0              9237.7235      2.6109412e-16  0              3.0798668    
    800000   127.27922      200            200            0.0044242835  -5.1785524e-37  0              0.013272851    0.0041065876   0              19829.242      2.6109412e-16  0              3.0801172    
    900000   127.27922      200            200            0.0042955436  -6.4195473e-37  0              0.012886631    0.0026616816   0              12852.308      2.6109412e-16  0              3.0802126    
   1000000   127.27922      200            200            0.0042518562  -9.7126513e-39  0              0.012755569    0.00075408437  0              3641.2035      2.6109412e-16  0              3.0802454    
   1100000   127.27922      200            200            0.0042386644   2.4527201e-38  0              0.012715993    0.00014958234  0              722.2796       2.6109412e-16  0              3.0802554    
   1200000   127.27922      200            200            0.0042353428   3.2810549e-40  0              0.012706028    2.3414468e-05  0              113.06009      2.6109412e-16  0              3.080258     
   1300000   127.27922      200            200            0.0042348044   4.2370168e-39  0              0.012704413    2.99073e-06    0              14.441165      2.6109412e-16  0              3.0802584    
   1400000   127.27922      200            200            0.0042348773   1.7713016e-39  0              0.012704632    3.0772498e-07  0              1.4858938      2.6109412e-16  0              3.0802584    
   1500000   127.27922      200            200            0.0042350012   5.7067706e-39  0              0.012705004    2.3702137e-08  0              0.11444914     2.6109412e-16  0              3.0802583    
   1600000   127.27922      200            200            0.004235078    6.0457061e-39  0              0.012705234    1.0633089e-09  0              0.0051343382   2.6109412e-16  0              3.0802582    
   1700000   127.27922      200            200            0.0042351149  -1.9342783e-39  0              0.012705345    3.8911596e-12  0              1.8789017e-05  2.6109412e-16  0              3.0802582    
   1800000   127.27922      200            200            0.0042351304  -1.2965242e-39  0              0.012705391    9.1994701e-12  0              4.4420949e-05  2.6109412e-16  0              3.0802582    
   1900000   127.27922      200            200            0.0042351362   6.7396113e-39  0              0.012705409    5.703682e-12   0              2.7541039e-05  2.6109412e-16  0              3.0802582    
   2000000   127.27922      200            200            0.0042351382   2.8187888e-39  0              0.012705414    1.5873954e-12  0              7.6649643e-06  2.6109412e-16  0              3.0802582    
   2100000   127.27922      200            200            0.0042351388   2.6830941e-39  0              0.012705416    3.1135601e-13  0              1.5034268e-06  2.6109412e-16  0              3.0802582    
   2200000   127.27922      200            200            0.0042351389  -9.1970165e-40  0              0.012705417    4.8297797e-14  0              2.3321278e-07  2.6109412e-16  0              3.0802582    
   2300000   127.27922      200            200            0.0042351389   1.7442846e-38  0              0.012705417    6.1131485e-15  0              2.9518206e-08  2.6109412e-16  0              3.0802582    
   2400000   127.27922      200            200            0.0042351389   8.8856205e-40  0              0.012705417    6.2599389e-16  0              3.0227005e-09  2.6109412e-16  0              3.0802582    
   2500000   127.27922      200            200            0.0042351389   1.483472e-39   0              0.012705417    4.5476588e-17  0              2.1959017e-10  2.6109412e-16  0              3.0802582    
   2600000   127.27922      200            200            0.0042351389   2.2947057e-39  0              0.012705417    2.0741023e-18  0              1.0015098e-11  2.6109412e-16  0              3.0802582    
   2700000   127.27922      200            200            0.0042351389  -5.1358744e-39  0              0.012705417    9.8422933e-21  0              4.7524912e-14  2.6109412e-16  0              3.0802582    
   2800000   127.27922      200            200            0.0042351389   5.839867e-39   0              0.012705417    3.1491522e-20  0              1.5206129e-13  2.6109412e-16  0              3.0802582    
   2900000   127.27922      200            200            0.0042351389   4.9766766e-39  0              0.012705417    1.6173433e-20  0              7.8095718e-14  2.6109412e-16  0              3.0802582    
   3000000   127.27922      200            200            0.0042351389  -4.4319851e-40  0              0.012705417    1.8405126e-21  0              8.8871769e-15  2.6109412e-16  0              3.0802582    
Loop time of 69.7013 on 4 procs for 3000000 steps with 51 atoms

Performance: 37187262.010 ns/day, 0.000 hours/ns, 43040.813 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24928    | 1.2431     | 4.1066     | 148.3 |  1.78
Neigh   | 0.079108   | 0.08077    | 0.083771   |   0.7 |  0.12
Comm    | 30.394     | 37.834     | 44.1       |  91.4 | 54.28
Output  | 0.059442   | 0.059821   | 0.060533   |   0.2 |  0.09
Modify  | 15.04      | 21.613     | 29.781     | 141.7 | 31.01
Other   |            | 8.871      |            |       | 12.73

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.18                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.0427024474883
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.28
  ghost atom cutoff = 3.28
  binsize = 1.64, bins = 78 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.07 | 17.54 | 18.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035319078  -1.2105143e-39  0              0.010595723    13169.554      0              6.3591063e+10  2.6109412e-16  0              3.3279147    
    200000   127.27922      200            200            0.0014644951  -8.7139166e-38  0              0.0043934854   4053.922       0              1.9574938e+10  2.6109412e-16  0              3.0986117    
    300000   127.27922      200            200            0.00031605831  7.7670582e-37  0              0.00094817492  338.86582      0              1.6362618e+09  2.6109412e-16  0              3.1194032    
    400000   127.27922      200            200            0.020051729    0.0065026929   0              0.053652493    42.980039      0              2.0753523e+08  2.6109412e-16  0              3.0796254    
    500000   127.27922      200            200            0.0082057161   1.8457512e-06  0              0.024615303    3.0327767      0              14644193       2.6109412e-16  0              3.082624     
    600000   127.27922      200            200            0.0057246701   4.4255019e-36  0              0.01717401     0.029021594    0              140134.89      2.6109412e-16  0              3.0842126    
    700000   127.27922      200            200            0.0047697105  -2.463099e-37   0              0.014309132    0.014149993    0              68325.254      2.6109412e-16  0              3.0848736    
    800000   127.27922      200            200            0.0044130708  -9.7482997e-37  0              0.013239212    0.015802679    0              76305.482      2.6109412e-16  0              3.0851325    
    900000   127.27922      200            200            0.0042896562  -8.6775606e-37  0              0.012868968    0.0051921465   0              25071.017      2.6109412e-16  0              3.0852244    
   1000000   127.27922      200            200            0.0042519505   9.9677174e-38  0              0.012755851    0.0010900182   0              5263.3076      2.6109412e-16  0              3.0852528    
   1100000   127.27922      200            200            0.0042424605   1.954494e-39   0              0.012727381    0.00017283785  0              834.57214      2.6109412e-16  0              3.0852601    
   1200000   127.27922      200            200            0.0042409798  -4.3480966e-41  0              0.012722939    2.1602802e-05  0              104.3122       2.6109412e-16  0              3.0852613    
   1300000   127.27922      200            200            0.0042412377   4.0456878e-38  0              0.012723713    2.0833617e-06  0              10.059808      2.6109412e-16  0              3.0852612    
   1400000   127.27922      200            200            0.004241617    1.5407454e-39  0              0.012724851    1.3818292e-07  0              0.66723587     2.6109412e-16  0              3.0852609    
   1500000   127.27922      200            200            0.0042418451   1.0275714e-38  0              0.012725535    3.8930054e-09  0              0.01879793     2.6109412e-16  0              3.0852607    
   1600000   127.27922      200            200            0.0042419519  -3.8568273e-39  0              0.012725856    4.9654458e-11  0              0.00023976361  2.6109412e-16  0              3.0852606    
   1700000   127.27922      200            200            0.0042419951  -8.8685445e-40  0              0.012725985    1.7765756e-10  0              0.0008578448   2.6109412e-16  0              3.0852606    
   1800000   127.27922      200            200            0.0042420106   3.4548611e-39  0              0.012726032    6.8680389e-11  0              0.00033163302  2.6109412e-16  0              3.0852606    
   1900000   127.27922      200            200            0.0042420154  -5.3641859e-40  0              0.012726046    1.5538623e-11  0              7.5030451e-05  2.6109412e-16  0              3.0852606    
   2000000   127.27922      200            200            0.0042420167  -7.4315975e-40  0              0.01272605     2.5967813e-12  0              1.2538928e-05  2.6109412e-16  0              3.0852606    
   2100000   127.27922      200            200            0.004242017    2.8411511e-39  0              0.012726051    3.4076889e-13  0              1.645451e-06   2.6109412e-16  0              3.0852606    
   2200000   127.27922      200            200            0.004242017   -7.9306906e-39  0              0.012726051    3.4846616e-14  0              1.6826184e-07  2.6109412e-16  0              3.0852606    
   2300000   127.27922      200            200            0.0042420169   8.4816554e-40  0              0.012726051    2.5408203e-15  0              1.2268712e-08  2.6109412e-16  0              3.0852606    
   2400000   127.27922      200            200            0.0042420169   3.7695725e-39  0              0.012726051    9.2013495e-17  0              4.4430024e-10  2.6109412e-16  0              3.0852606    
   2500000   127.27922      200            200            0.0042420169  -1.1257664e-38  0              0.012726051    3.0202134e-20  0              1.4583529e-13  2.6109412e-16  0              3.0852606    
   2600000   127.27922      200            200            0.0042420169  -1.3955499e-38  0              0.012726051    1.6042738e-18  0              7.746464e-12   2.6109412e-16  0              3.0852606    
   2700000   127.27922      200            200            0.0042420169  -6.7630737e-40  0              0.012726051    1.0676425e-18  0              5.1552634e-12  2.6109412e-16  0              3.0852606    
   2800000   127.27922      200            200            0.0042420169  -1.1350128e-38  0              0.012726051    2.2665213e-19  0              1.094422e-12   2.6109412e-16  0              3.0852606    
   2900000   127.27922      200            200            0.0042420169  -1.1691941e-39  0              0.012726051    5.5818636e-21  0              2.6952821e-14  2.6109412e-16  0              3.0852606    
   3000000   127.27922      200            200            0.0042420169   1.1728423e-38  0              0.012726051    5.2346455e-20  0              2.527623e-13   2.6109412e-16  0              3.0852606    
Loop time of 69.3292 on 4 procs for 3000000 steps with 51 atoms

Performance: 37386846.631 ns/day, 0.000 hours/ns, 43271.813 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22064    | 1.2052     | 3.9672     | 145.3 |  1.74
Neigh   | 0.07753    | 0.079587   | 0.08284    |   0.8 |  0.11
Comm    | 30.069     | 37.629     | 43.869     |  92.6 | 54.28
Output  | 0.061307   | 0.061639   | 0.062164   |   0.1 |  0.09
Modify  | 14.908     | 21.501     | 29.705     | 141.8 | 31.01
Other   |            | 8.852      |            |       | 12.77

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.19                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.3932619855676
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.29
  ghost atom cutoff = 3.29
  binsize = 1.645, bins = 78 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.07 | 17.54 | 18.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.003541736    7.5658029e-40  0              0.010625208    13218.748      0              6.3828603e+10  2.6109412e-16  0              3.32794      
    200000   127.27922      200            200            0.0014795178  -9.6834249e-38  0              0.0044385535   4113.508       0              1.9862658e+10  2.6109412e-16  0              3.0998734    
    300000   127.27922      200            200            0.00032952929  2.3389013e-37  0              0.00098858788  363.89406      0              1.7571142e+09  2.6109412e-16  0              3.1231267    
    400000   127.27922      200            200            0.017207375    0.0050346184   0              0.046587507    79.754698      0              3.8510689e+08  2.6109412e-16  0              3.0852272    
    500000   127.27922      200            200            0.00785831     9.0653998e-36  0              0.02357493     6.9785358      0              33696852       2.6109412e-16  0              3.0878361    
    600000   127.27922      200            200            0.0057247277   9.4159968e-36  0              0.017174183    0.05297315     0              255788.38      2.6109412e-16  0              3.0892178    
    700000   127.27922      200            200            0.0047418717  -4.5709853e-36  0              0.014225615    0.07566883     0              365377.7       2.6109412e-16  0              3.0899001    
    800000   127.27922      200            200            0.0043911342  -4.9635257e-37  0              0.013173403    0.032137997    0              155182.89      2.6109412e-16  0              3.0901558    
    900000   127.27922      200            200            0.0042801767   1.4857706e-37  0              0.01284053     0.0075718259   0              36561.637      2.6109412e-16  0              3.0902388    
   1000000   127.27922      200            200            0.0042511538   3.5346296e-39  0              0.012753461    0.0012663061   0              6114.5388      2.6109412e-16  0              3.0902609    
   1100000   127.27922      200            200            0.0042462107  -2.9044245e-38  0              0.012738632    0.00016058104  0              775.3884       2.6109412e-16  0              3.0902649    
   1200000   127.27922      200            200            0.0042467446   2.6883323e-38  0              0.012740234    1.5116153e-05  0              72.990495      2.6109412e-16  0              3.0902645    
   1300000   127.27922      200            200            0.0042477812  -4.2016243e-38  0              0.012743343    9.1257835e-07  0              4.4065142      2.6109412e-16  0              3.0902638    
   1400000   127.27922      200            200            0.004248421    1.8223633e-41  0              0.012745263    1.6878485e-08  0              0.081500163    2.6109412e-16  0              3.0902633    
   1500000   127.27922      200            200            0.0042487201   3.8101156e-39  0              0.01274616     1.6042746e-09  0              0.0077464678   2.6109412e-16  0              3.0902631    
   1600000   127.27922      200            200            0.004248839   -4.2998956e-39  0              0.012746517    2.0329887e-09  0              0.0098165749   2.6109412e-16  0              3.090263     
   1700000   127.27922      200            200            0.0042488801  -4.9963568e-39  0              0.01274664     6.5256475e-10  0              0.0031510016   2.6109412e-16  0              3.090263     
   1800000   127.27922      200            200            0.0042488923  -1.8996109e-39  0              0.012746677    1.3092101e-10  0              0.00063217068  2.6109412e-16  0              3.090263     
   1900000   127.27922      200            200            0.0042488951   1.2432236e-40  0              0.012746685    1.937072e-11   0              9.3534272e-05  2.6109412e-16  0              3.090263     
   2000000   127.27922      200            200            0.0042488953  -2.5456399e-39  0              0.012746686    2.1733337e-12  0              1.0494251e-05  2.6109412e-16  0              3.090263     
   2100000   127.27922      200            200            0.0042488952  -6.2701253e-39  0              0.012746685    1.7378779e-13  0              8.3915905e-07  2.6109412e-16  0              3.090263     
   2200000   127.27922      200            200            0.004248895   -4.986343e-39   0              0.012746685    7.5327171e-15  0              3.6372795e-08  2.6109412e-16  0              3.090263     
   2300000   127.27922      200            200            0.0042488949   6.1599866e-39  0              0.012746685    1.0721822e-17  0              5.177184e-11   2.6109412e-16  0              3.090263     
   2400000   127.27922      200            200            0.0042488949   1.7605019e-39  0              0.012746685    9.0503487e-17  0              4.3700895e-10  2.6109412e-16  0              3.090263     
   2500000   127.27922      200            200            0.0042488948  -3.6448062e-39  0              0.012746685    4.7887546e-17  0              2.3123182e-10  2.6109412e-16  0              3.090263     
   2600000   127.27922      200            200            0.0042488948   2.0639451e-39  0              0.012746685    1.1577619e-17  0              5.5904178e-11  2.6109412e-16  0              3.090263     
   2700000   127.27922      200            200            0.0042488948  -2.8869711e-39  0              0.012746685    2.1404786e-18  0              1.0335605e-11  2.6109412e-16  0              3.090263     
   2800000   127.27922      200            200            0.0042488948   8.876246e-40   0              0.012746685    2.6331909e-19  0              1.2714737e-12  2.6109412e-16  0              3.090263     
   2900000   127.27922      200            200            0.0042488948   8.5636358e-39  0              0.012746685    8.5738757e-20  0              4.1400177e-13  2.6109412e-16  0              3.090263     
   3000000   127.27922      200            200            0.0042488948   1.65288e-38    0              0.012746685    8.0743483e-20  0              3.8988138e-13  2.6109412e-16  0              3.090263     
Loop time of 69.4248 on 4 procs for 3000000 steps with 51 atoms

Performance: 37335343.525 ns/day, 0.000 hours/ns, 43212.203 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22158    | 1.2054     | 3.9802     | 146.0 |  1.74
Neigh   | 0.079047   | 0.081458   | 0.085004   |   0.9 |  0.12
Comm    | 30.178     | 37.707     | 43.956     |  92.3 | 54.31
Output  | 0.059923   | 0.060243   | 0.06072    |   0.1 |  0.09
Modify  | 14.961     | 21.527     | 29.738     | 141.8 | 31.01
Other   |            | 8.844      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.2                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.7460262933712
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.3
  ghost atom cutoff = 3.3
  binsize = 1.65, bins = 78 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.07 | 17.54 | 18.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035515655   7.2632412e-39  0              0.010654697    13268.011      0              6.4066477e+10  2.6109412e-16  0              3.3279537    
    200000   127.27922      200            200            0.0014945803  -7.7456698e-38  0              0.0044837409   4173.4748      0              2.0152216e+10  2.6109412e-16  0              3.1011039    
    300000   127.27922      200            200            0.00034311987 -6.1794668e-37  0              0.0010293596   389.7817       0              1.8821163e+09  2.6109412e-16  0              3.126803     
    400000   127.27922      200            200            0.01372978     0.0028764442   0              0.038312895    116.92426      0              5.6458541e+08  2.6109412e-16  0              3.0909933    
    500000   127.27922      200            200            0.007384497   -8.2100193e-36  0              0.022153491    11.850995      0              57224212       2.6109412e-16  0              3.0931301    
    600000   127.27922      200            200            0.0056607678   6.9707119e-36  0              0.016982303    0.38440314     0              1856145.2      2.6109412e-16  0              3.0942663    
    700000   127.27922      200            200            0.0046885721   5.3629618e-36  0              0.014065716    0.17355612     0              838040.39      2.6109412e-16  0              3.0949449    
    800000   127.27922      200            200            0.0043603393   1.4193386e-37  0              0.013081018    0.049048583    0              236838.05      2.6109412e-16  0              3.0951857    
    900000   127.27922      200            200            0.0042683528  -3.596672e-38   0              0.012805058    0.0090970943   0              43926.613      2.6109412e-16  0              3.095255     
   1000000   127.27922      200            200            0.0042501573   2.9329214e-38  0              0.012750472    0.0012221076   0              5901.1202      2.6109412e-16  0              3.0952692    
   1100000   127.27922      200            200            0.0042502446   2.1444263e-38  0              0.012750734    0.00011805872  0              570.06332      2.6109412e-16  0              3.0952694    
   1200000   127.27922      200            200            0.004252773   -8.7050186e-39  0              0.012758319    7.0541941e-06  0              34.062179      2.6109412e-16  0              3.0952676    
   1300000   127.27922      200            200            0.0042544814  -2.7093855e-38  0              0.012763444    1.1231386e-07  0              0.54232344     2.6109412e-16  0              3.0952663    
   1400000   127.27922      200            200            0.0042553008   1.5286294e-39  0              0.012765902    1.7320603e-08  0              0.083634995    2.6109412e-16  0              3.0952657    
   1500000   127.27922      200            200            0.0042556267  -1.9647963e-39  0              0.01276688     1.817732e-08   0              0.087771774    2.6109412e-16  0              3.0952655    
   1600000   127.27922      200            200            0.0042557373   2.0610352e-39  0              0.012767212    5.4531898e-09  0              0.026331502    2.6109412e-16  0              3.0952654    
   1700000   127.27922      200            200            0.0042557684   7.4419233e-39  0              0.012767305    1.0212369e-09  0              0.0049311876   2.6109412e-16  0              3.0952654    
   1800000   127.27922      200            200            0.0042557746  -3.9617677e-39  0              0.012767324    1.3763347e-10  0              0.00066458278  2.6109412e-16  0              3.0952654    
   1900000   127.27922      200            200            0.0042557746   5.3507037e-39  0              0.012767324    1.3329375e-11  0              6.4362782e-05  2.6109412e-16  0              3.0952654    
   2000000   127.27922      200            200            0.0042557738   5.1265572e-39  0              0.012767321    7.9989421e-13  0              3.8624029e-06  2.6109412e-16  0              3.0952654    
   2100000   127.27922      200            200            0.0042557732  -9.9310385e-40  0              0.01276732     1.2989487e-14  0              6.2721586e-08  2.6109412e-16  0              3.0952654    
   2200000   127.27922      200            200            0.0042557729  -8.9278138e-40  0              0.012767319    1.9051949e-15  0              9.1995044e-09  2.6109412e-16  0              3.0952654    
   2300000   127.27922      200            200            0.0042557728  -6.1256396e-40  0              0.012767318    2.0371903e-15  0              9.8368631e-09  2.6109412e-16  0              3.0952654    
   2400000   127.27922      200            200            0.0042557728   3.4919165e-39  0              0.012767318    6.1128873e-16  0              2.9516945e-09  2.6109412e-16  0              3.0952654    
   2500000   127.27922      200            200            0.0042557728   5.3977259e-40  0              0.012767318    1.1401647e-16  0              5.5054472e-10  2.6109412e-16  0              3.0952654    
   2600000   127.27922      200            200            0.0042557728   6.2825781e-39  0              0.012767318    1.5505558e-17  0              7.4870791e-11  2.6109412e-16  0              3.0952654    
   2700000   127.27922      200            200            0.0042557728  -9.5269432e-39  0              0.012767318    1.2793503e-18  0              6.1775248e-12  2.6109412e-16  0              3.0952654    
   2800000   127.27922      200            200            0.0042557728  -3.2930414e-39  0              0.012767318    6.0238818e-20  0              2.9087169e-13  2.6109412e-16  0              3.0952654    
   2900000   127.27922      200            200            0.0042557728   9.2656131e-39  0              0.012767318    1.1315069e-19  0              5.463642e-13   2.6109412e-16  0              3.0952654    
   3000000   127.27922      200            200            0.0042557728   1.3642176e-38  0              0.012767318    9.4084903e-20  0              4.5430233e-13  2.6109412e-16  0              3.0952654    
Loop time of 69.3651 on 4 procs for 3000000 steps with 51 atoms

Performance: 37367510.167 ns/day, 0.000 hours/ns, 43249.433 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22324    | 1.2313     | 4.0669     | 147.6 |  1.78
Neigh   | 0.080558   | 0.082636   | 0.086063   |   0.8 |  0.12
Comm    | 30.066     | 37.607     | 43.919     |  92.3 | 54.22
Output  | 0.057682   | 0.058029   | 0.05871    |   0.2 |  0.08
Modify  | 14.899     | 21.506     | 29.728     | 141.8 | 31.00
Other   |            | 8.88       |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.21                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.1010022824028
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.31
  ghost atom cutoff = 3.31
  binsize = 1.655, bins = 77 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.01 | 17.48 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035613964   7.5658115e-40  0              0.010684189    13317.344      0              6.430469e+10   2.6109412e-16  0              3.3279556    
    200000   127.27922      200            200            0.0033415565   9.6940348e-39  0              0.010024669    4224.0763      0              2.0396553e+10  2.6109412e-16  0              3.102304     
    300000   127.27922      200            200            0.00035683033  1.9842081e-39  0              0.001070491    416.52796      0              2.0112644e+09  2.6109412e-16  0              3.1304321    
    400000   127.27922      200            200            0.0102893      0.00093604307  0              0.029931856    147.88762      0              7.1409639e+08  2.6109412e-16  0              3.0968847    
    500000   127.27922      200            200            0.0068074895   4.3530563e-36  0              0.020422469    16.946643      0              81829273       2.6109412e-16  0              3.0984952    
    600000   127.27922      200            200            0.00553636    -1.602864e-36   0              0.01660908     0.96504541     0              4659858.9      2.6109412e-16  0              3.0993559    
    700000   127.27922      200            200            0.0046131732  -1.7412342e-37  0              0.01383952     0.28763055     0              1388865        2.6109412e-16  0              3.1000059    
    800000   127.27922      200            200            0.0043231022  -7.2578543e-38  0              0.012969307    0.062372656    0              301175.23      2.6109412e-16  0              3.1002204    
    900000   127.27922      200            200            0.0042556002  -1.1586657e-39  0              0.012766801    0.0093230377   0              45017.612      2.6109412e-16  0              3.1002719    
   1000000   127.27922      200            200            0.0042496657   6.0097791e-38  0              0.012748997    0.00097414095  0              4703.778       2.6109412e-16  0              3.100277     
   1100000   127.27922      200            200            0.0042548603   2.1706764e-38  0              0.012764581    6.280976e-05   0              303.28585      2.6109412e-16  0              3.1002735    
   1200000   127.27922      200            200            0.0042591676   1.9541987e-38  0              0.012777503    1.2216943e-06  0              5.8991244      2.6109412e-16  0              3.1002703    
   1300000   127.27922      200            200            0.0042613626  -6.510925e-39   0              0.012784088    1.0847346e-07  0              0.52377951     2.6109412e-16  0              3.1002687    
   1400000   127.27922      200            200            0.0042622559   5.1395036e-39  0              0.012786768    1.3769263e-07  0              0.66486844     2.6109412e-16  0              3.1002681    
   1500000   127.27922      200            200            0.0042625595   1.5495174e-39  0              0.012787679    4.2009007e-08  0              0.20284646     2.6109412e-16  0              3.1002678    
   1600000   127.27922      200            200            0.0042626428   4.2993003e-39  0              0.012787928    7.6760863e-09  0              0.037065074    2.6109412e-16  0              3.1002678    
   1700000   127.27922      200            200            0.0042626577  -6.1430893e-39  0              0.012787973    9.7220859e-10  0              0.0046944473   2.6109412e-16  0              3.1002678    
   1800000   127.27922      200            200            0.0042626565  -7.9663964e-39  0              0.012787969    8.3014906e-11  0              0.00040084927  2.6109412e-16  0              3.1002678    
   1900000   127.27922      200            200            0.0042626536   6.0754919e-39  0              0.012787961    3.638871e-12   0              1.7570806e-05  2.6109412e-16  0              3.1002678    
   2000000   127.27922      200            200            0.0042626519   8.8539699e-40  0              0.012787956    2.4818189e-15  0              1.1983815e-08  2.6109412e-16  0              3.1002678    
   2100000   127.27922      200            200            0.0042626511   7.948119e-39   0              0.012787953    5.0442512e-14  0              2.4356884e-07  2.6109412e-16  0              3.1002678    
   2200000   127.27922      200            200            0.0042626508  -2.9895607e-39  0              0.012787952    2.4883846e-14  0              1.2015519e-07  2.6109412e-16  0              3.1002678    
   2300000   127.27922      200            200            0.0042626507  -1.6527225e-39  0              0.012787952    5.7296946e-15  0              2.7666645e-08  2.6109412e-16  0              3.1002678    
   2400000   127.27922      200            200            0.0042626507   8.3392214e-39  0              0.012787952    8.7368203e-16  0              4.2186978e-09  2.6109412e-16  0              3.1002678    
   2500000   127.27922      200            200            0.0042626507   1.1262436e-38  0              0.012787952    9.2663947e-17  0              4.4744104e-10  2.6109412e-16  0              3.1002678    
   2600000   127.27922      200            200            0.0042626507  -1.3232006e-40  0              0.012787952    6.1448852e-18  0              2.9671451e-11  2.6109412e-16  0              3.1002678    
   2700000   127.27922      200            200            0.0042626507  -2.8302748e-39  0              0.012787952    7.9461602e-20  0              3.8369164e-13  2.6109412e-16  0              3.1002678    
   2800000   127.27922      200            200            0.0042626507  -6.4997084e-39  0              0.012787952    9.8540284e-21  0              4.7581577e-14  2.6109412e-16  0              3.1002678    
   2900000   127.27922      200            200            0.0042626507  -2.6499236e-39  0              0.012787952    3.9923925e-20  0              1.9277834e-13  2.6109412e-16  0              3.1002678    
   3000000   127.27922      200            200            0.0042626507   1.9632026e-38  0              0.012787952    2.2937432e-21  0              1.1075665e-14  2.6109412e-16  0              3.1002678    
Loop time of 69.5113 on 4 procs for 3000000 steps with 51 atoms

Performance: 37288927.421 ns/day, 0.000 hours/ns, 43158.481 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21893    | 1.1883     | 3.902      | 143.8 |  1.71
Neigh   | 0.07923    | 0.081295   | 0.084772   |   0.8 |  0.12
Comm    | 30.231     | 37.784     | 44.036     |  92.7 | 54.36
Output  | 0.061306   | 0.061765   | 0.062582   |   0.2 |  0.09
Modify  | 14.955     | 21.541     | 29.778     | 142.2 | 30.99
Other   |            | 8.855      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.22                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.4581968641666
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.32
  ghost atom cutoff = 3.32
  binsize = 1.66, bins = 77 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.01 | 17.48 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035712285  -9.0788568e-40  0              0.010713686    13366.747      0              6.454324e+10   2.6109412e-16  0              3.3279458    
    200000   127.27922      200            200            0.008393092   -1.5496405e-37  0              0.025179276    4206.0419      0              2.0309471e+10  2.6109412e-16  0              3.1034903    
    300000   127.27922      200            200            0.00037065948 -7.7281061e-37  0              0.0011119784   444.12918      0              2.1445408e+09  2.6109412e-16  0              3.134014     
    400000   127.27922      200            200            0.0077416489   7.7781977e-36  0              0.023224947    169.37591      0              8.1785567e+08  2.6109412e-16  0              3.1028612    
    500000   127.27922      200            200            0.0061565747   4.4963305e-36  0              0.018469724    21.558029      0              1.0409601e+08  2.6109412e-16  0              3.1039186    
    600000   127.27922      200            200            0.0053582772  -2.5165838e-37  0              0.016074832    1.6948239      0              8183697.9      2.6109412e-16  0              3.104483     
    700000   127.27922      200            200            0.0045202275   1.7234975e-36  0              0.013560682    0.39467584     0              1905748.4      2.6109412e-16  0              3.1050799    
    800000   127.27922      200            200            0.0042822227   9.9518937e-38  0              0.012846668    0.068871712    0              332556.85      2.6109412e-16  0              3.1052579    
    900000   127.27922      200            200            0.0042433944  -2.4648145e-37  0              0.012730183    0.0081907394   0              39550.149      2.6109412e-16  0              3.1052885    
   1000000   127.27922      200            200            0.0042503351   4.226774e-38   0              0.012751005    0.00060987726  0              2944.879       2.6109412e-16  0              3.1052841    
   1100000   127.27922      200            200            0.0042602932  -1.1336579e-37  0              0.01278088     1.735957e-05   0              83.823151      2.6109412e-16  0              3.1052769    
   1200000   127.27922      200            200            0.0042659862  -9.8097976e-39  0              0.012797958    3.2888337e-07  0              1.5880601      2.6109412e-16  0              3.1052728    
   1300000   127.27922      200            200            0.0042684238  -1.6784263e-38  0              0.012805271    8.9336065e-07  0              4.3137188      2.6109412e-16  0              3.105271     
   1400000   127.27922      200            200            0.0042692736   5.8542627e-39  0              0.012807821    3.0323378e-07  0              1.4642074      2.6109412e-16  0              3.1052703    
   1500000   127.27922      200            200            0.0042695086   1.6374012e-39  0              0.012808526    5.6703146e-08  0              0.2737992      2.6109412e-16  0              3.1052701    
   1600000   127.27922      200            200            0.0042695498   1.1041493e-38  0              0.012808649    7.0163047e-09  0              0.033879225    2.6109412e-16  0              3.1052701    
   1700000   127.27922      200            200            0.0042695454  -6.6852298e-39  0              0.012808636    5.5008552e-10  0              0.0026561661   2.6109412e-16  0              3.1052701    
   1800000   127.27922      200            200            0.0042695369  -7.2725617e-41  0              0.012808611    1.8102002e-11  0              8.740809e-05   2.6109412e-16  0              3.1052701    
   1900000   127.27922      200            200            0.0042695318  -5.4407955e-39  0              0.012808596    1.1952885e-13  0              5.7716204e-07  2.6109412e-16  0              3.1052701    
   2000000   127.27922      200            200            0.0042695296   1.427017e-39   0              0.012808589    6.4892129e-13  0              3.1334087e-06  2.6109412e-16  0              3.1052701    
   2100000   127.27922      200            200            0.0042695289   3.596333e-39   0              0.012808587    2.3880066e-13  0              1.1530829e-06  2.6109412e-16  0              3.1052701    
   2200000   127.27922      200            200            0.0042695286  -1.3438989e-39  0              0.012808586    4.6568851e-14  0              2.2486432e-07  2.6109412e-16  0              3.1052701    
   2300000   127.27922      200            200            0.0042695286  -1.2770076e-39  0              0.012808586    5.9756681e-15  0              2.8854363e-08  2.6109412e-16  0              3.1052701    
   2400000   127.27922      200            200            0.0042695286   2.5984284e-39  0              0.012808586    4.9264218e-16  0              2.3787928e-09  2.6109412e-16  0              3.1052701    
   2500000   127.27922      200            200            0.0042695286   6.1080946e-40  0              0.012808586    1.6331339e-17  0              7.8858191e-11  2.6109412e-16  0              3.1052701    
   2600000   127.27922      200            200            0.0042695286  -2.3842565e-39  0              0.012808586    4.2694646e-20  0              2.0615716e-13  2.6109412e-16  0              3.1052701    
   2700000   127.27922      200            200            0.0042695286  -8.7933713e-39  0              0.012808586    6.7047301e-19  0              3.2374742e-12  2.6109412e-16  0              3.1052701    
   2800000   127.27922      200            200            0.0042695286   7.6729731e-40  0              0.012808586    2.1460722e-19  0              1.0362615e-12  2.6109412e-16  0              3.1052701    
   2900000   127.27922      200            200            0.0042695286   8.9335666e-40  0              0.012808586    1.2506986e-20  0              6.0391761e-14  2.6109412e-16  0              3.1052701    
   3000000   127.27922      200            200            0.0042695286   3.7077748e-39  0              0.012808586    7.3200938e-20  0              3.5346113e-13  2.6109412e-16  0              3.1052701    
Loop time of 69.34 on 4 procs for 3000000 steps with 51 atoms

Performance: 37381017.392 ns/day, 0.000 hours/ns, 43265.066 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22087    | 1.2282     | 4.0498     | 147.1 |  1.77
Neigh   | 0.075921   | 0.078546   | 0.082531   |   0.9 |  0.11
Comm    | 29.909     | 37.48      | 43.756     |  92.6 | 54.05
Output  | 0.060543   | 0.060844   | 0.061275   |   0.1 |  0.09
Modify  | 14.921     | 21.529     | 29.726     | 140.6 | 31.05
Other   |            | 8.963      |            |       | 12.93

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.23                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.8176169501661
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.33
  ghost atom cutoff = 3.33
  binsize = 1.665, bins = 77 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.01 | 17.48 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035810618   3.3083118e-51  0              0.010743185    13416.22       0              6.4782126e+10  2.6109412e-16  0              3.3279243    
    200000   127.27922      200            200            0.021139812    0.0050829036   0              0.058336531    4051.6932      0              1.9564176e+10  2.6109412e-16  0              3.1047077    
    300000   127.27922      200            200            0.00038460547  6.9884253e-37  0              0.0011538164   472.58024      0              2.2819208e+09  2.6109412e-16  0              3.1375485    
    400000   127.27922      200            200            0.0061050142  -8.4257049e-36  0              0.018315043    182.66249      0              8.820118e+08   2.6109412e-16  0              3.1088904    
    500000   127.27922      200            200            0.005463084    1.332218e-35   0              0.016389252    25.081777      0              1.2111092e+08  2.6109412e-16  0              3.1093853    
    600000   127.27922      200            200            0.0051359686   3.5555681e-36  0              0.015407906    2.450177       0              11831028       2.6109412e-16  0              3.1096421    
    700000   127.27922      200            200            0.0044151581  -7.106567e-37   0              0.013245474    0.47324018     0              2285107.4      2.6109412e-16  0              3.1101633    
    800000   127.27922      200            200            0.004240692   -1.9201448e-37  0              0.012722076    0.067008818    0              323561.6       2.6109412e-16  0              3.1102961    
    900000   127.27922      200            200            0.0042331584   1.890109e-37   0              0.012699475    0.0060395824   0              29162.982      2.6109412e-16  0              3.1103036    
   1000000   127.27922      200            200            0.0042527147   2.4981159e-38  0              0.012758144    0.00025625433  0              1237.3604      2.6109412e-16  0              3.1102898    
   1100000   127.27922      200            200            0.0042666921   3.3256643e-37  0              0.012800076    1.720379e-10   0              0.00083070944  2.6109412e-16  0              3.1102797    
   1200000   127.27922      200            200            0.0042732344   1.9297852e-38  0              0.012819703    4.7357074e-06  0              22.867036      2.6109412e-16  0              3.1102749    
   1300000   127.27922      200            200            0.0042756386   2.5230829e-39  0              0.012826916    2.0366655e-06  0              9.8343288      2.6109412e-16  0              3.1102731    
   1400000   127.27922      200            200            0.0042763316   7.1466753e-39  0              0.012828995    4.1280398e-07  0              1.9932827      2.6109412e-16  0              3.1102725    
   1500000   127.27922      200            200            0.0042764612   2.9916906e-39  0              0.012829384    5.231007e-08   0              0.25258661     2.6109412e-16  0              3.1102724    
   1600000   127.27922      200            200            0.0042764526   2.148141e-39   0              0.012829358    3.9966494e-09  0              0.01929839     2.6109412e-16  0              3.1102725    
   1700000   127.27922      200            200            0.0042764293  -4.6550591e-39  0              0.012829288    1.1144546e-10  0              0.00053813024  2.6109412e-16  0              3.1102725    
   1800000   127.27922      200            200            0.0042764153  -2.2637573e-39  0              0.012829246    2.6371806e-12  0              1.2734001e-05  2.6109412e-16  0              3.1102725    
   1900000   127.27922      200            200            0.0042764092   8.5641428e-40  0              0.012829227    6.2240764e-12  0              3.0053838e-05  2.6109412e-16  0              3.1102725    
   2000000   127.27922      200            200            0.0042764071   8.9487947e-39  0              0.012829221    2.0114042e-12  0              9.7123509e-06  2.6109412e-16  0              3.1102725    
   2100000   127.27922      200            200            0.0042764065  -9.7261905e-40  0              0.01282922     3.5223452e-13  0              1.7008144e-06  2.6109412e-16  0              3.1102725    
   2200000   127.27922      200            200            0.0042764064   1.3657632e-39  0              0.012829219    3.9099713e-14  0              1.8879852e-07  2.6109412e-16  0              3.1102725    
   2300000   127.27922      200            200            0.0042764064  -2.1825762e-39  0              0.012829219    2.449399e-15   0              1.1827271e-08  2.6109412e-16  0              3.1102725    
   2400000   127.27922      200            200            0.0042764065   2.9206437e-39  0              0.012829219    3.4077888e-17  0              1.6454992e-10  2.6109412e-16  0              3.1102725    
   2500000   127.27922      200            200            0.0042764065   3.3722717e-39  0              0.012829219    9.3389881e-18  0              4.5094631e-11  2.6109412e-16  0              3.1102725    
   2600000   127.27922      200            200            0.0042764065  -3.2351971e-39  0              0.012829219    7.0871837e-18  0              3.4221473e-11  2.6109412e-16  0              3.1102725    
   2700000   127.27922      200            200            0.0042764065   6.0044314e-41  0              0.012829219    2.025683e-18   0              9.7812984e-12  2.6109412e-16  0              3.1102725    
   2800000   127.27922      200            200            0.0042764065   4.7998466e-39  0              0.012829219    2.4634002e-19  0              1.1894878e-12  2.6109412e-16  0              3.1102725    
   2900000   127.27922      200            200            0.0042764065   8.5797975e-39  0              0.012829219    3.2839419e-20  0              1.585698e-13   2.6109412e-16  0              3.1102725    
   3000000   127.27922      200            200            0.0042764065   6.5755956e-39  0              0.012829219    9.0740725e-20  0              4.3815448e-13  2.6109412e-16  0              3.1102725    
Loop time of 69.38 on 4 procs for 3000000 steps with 51 atoms

Performance: 37359467.331 ns/day, 0.000 hours/ns, 43240.124 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21696    | 1.1676     | 3.8392     | 142.8 |  1.68
Neigh   | 0.075842   | 0.077574   | 0.080688   |   0.7 |  0.11
Comm    | 30.137     | 37.72      | 43.961     |  92.8 | 54.37
Output  | 0.059095   | 0.05941    | 0.059923   |   0.1 |  0.09
Modify  | 14.91      | 21.501     | 29.715     | 141.9 | 30.99
Other   |            | 8.854      |            |       | 12.76

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.24                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.1792694519052
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.34
  ghost atom cutoff = 3.34
  binsize = 1.67, bins = 77 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.01 | 17.48 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0035908962   2.4214826e-39  0              0.010772689    13465.763      0              6.5021348e+10  2.6109412e-16  0              3.327891     
    200000   127.27922      200            200            0.042891947    0.016991976    0              0.11168386     3632.9307      0              1.7542122e+10  2.6109412e-16  0              3.1060512    
    300000   127.27922      200            200            0.0003986687   4.6597592e-37  0              0.0011960061   501.88078      0              2.4234027e+09  2.6109412e-16  0              3.1410357    
    400000   127.27922      200            200            0.0045576963   5.4480465e-36  0              0.013673089    187.98903      0              9.0773173e+08  2.6109412e-16  0              3.1149477    
    500000   127.27922      200            200            0.0047579552   4.7938132e-36  0              0.014273866    27.100299      0              1.3085764e+08  2.6109412e-16  0              3.1148796    
    600000   127.27922      200            200            0.0048808045  -4.2627098e-38  0              0.014642414    3.1061995      0              14998725       2.6109412e-16  0              3.1148265    
    700000   127.27922      200            200            0.0043038864   2.6763385e-37  0              0.012911659    0.50793923     0              2452656.8      2.6109412e-16  0              3.115252     
    800000   127.27922      200            200            0.0042014934   2.084772e-37   0              0.01260448     0.057293136    0              276648.05      2.6109412e-16  0              3.1153326    
    900000   127.27922      200            200            0.0042261571   2.7499729e-37  0              0.012678471    0.0035026077   0              16912.839      2.6109412e-16  0              3.1153163    
   1000000   127.27922      200            200            0.004257199    2.1865593e-37  0              0.012771597    3.5173711e-05  0              169.84126      2.6109412e-16  0              3.115294     
   1100000   127.27922      200            200            0.0042741044   8.003657e-38   0              0.012822313    1.7437368e-05  0              84.198807      2.6109412e-16  0              3.1152816    
   1200000   127.27922      200            200            0.0042808663   2.3527346e-38  0              0.012842599    1.2318841e-05  0              59.483277      2.6109412e-16  0              3.1152766    
   1300000   127.27922      200            200            0.0042829599  -4.2246633e-39  0              0.01284888     2.9221733e-06  0              14.110129      2.6109412e-16  0              3.1152751    
   1400000   127.27922      200            200            0.0042834013  -6.0586205e-40  0              0.012850204    4.004456e-07   0              1.9336085      2.6109412e-16  0              3.1152748    
   1500000   127.27922      200            200            0.0042834041  -1.6960229e-39  0              0.012850212    3.195371e-08   0              0.15429303     2.6109412e-16  0              3.1152747    
   1600000   127.27922      200            200            0.0042833461  -1.3360912e-39  0              0.012850038    9.1248276e-10  0              0.0044060527   2.6109412e-16  0              3.1152748    
   1700000   127.27922      200            200            0.0042833082   4.553431e-39   0              0.012849925    2.1291463e-11  0              0.00010280885  2.6109412e-16  0              3.1152748    
   1800000   127.27922      200            200            0.0042832914  -3.9866575e-39  0              0.012849874    5.0098564e-11  0              0.00024190803  2.6109412e-16  0              3.1152748    
   1900000   127.27922      200            200            0.0042832857  -8.1693271e-39  0              0.012849857    1.57011e-11    0              7.5814995e-05  2.6109412e-16  0              3.1152748    
   2000000   127.27922      200            200            0.0042832843   2.3012011e-39  0              0.012849853    2.5921168e-12  0              1.2516404e-05  2.6109412e-16  0              3.1152748    
   2100000   127.27922      200            200            0.0042832841   3.2281671e-39  0              0.012849852    2.5715739e-13  0              1.241721e-06   2.6109412e-16  0              3.1152748    
   2200000   127.27922      200            200            0.0042832842   1.8855407e-39  0              0.012849853    1.2274349e-14  0              5.9268439e-08  2.6109412e-16  0              3.1152748    
   2300000   127.27922      200            200            0.0042832843  -5.0541977e-40  0              0.012849853    1.0106652e-17  0              4.8801406e-11  2.6109412e-16  0              3.1152748    
   2400000   127.27922      200            200            0.0042832843  -3.9330181e-39  0              0.012849853    1.6971684e-16  0              8.195019e-10   2.6109412e-16  0              3.1152748    
   2500000   127.27922      200            200            0.0042832844  -2.3323643e-39  0              0.012849853    7.8163901e-17  0              3.7742551e-10  2.6109412e-16  0              3.1152748    
   2600000   127.27922      200            200            0.0042832844  -4.1639347e-39  0              0.012849853    1.5487938e-17  0              7.4785709e-11  2.6109412e-16  0              3.1152748    
   2700000   127.27922      200            200            0.0042832844   1.4811089e-39  0              0.012849853    1.6411698e-18  0              7.9246218e-12  2.6109412e-16  0              3.1152748    
   2800000   127.27922      200            200            0.0042832844  -1.1189021e-39  0              0.012849853    6.0922841e-20  0              2.941746e-13   2.6109412e-16  0              3.1152748    
   2900000   127.27922      200            200            0.0042832844   2.5785207e-39  0              0.012849853    1.1976227e-19  0              5.7828916e-13  2.6109412e-16  0              3.1152748    
   3000000   127.27922      200            200            0.0042832844  -1.9355421e-39  0              0.012849853    9.588245e-20   0              4.6298204e-13  2.6109412e-16  0              3.1152748    
Loop time of 69.3857 on 4 procs for 3000000 steps with 51 atoms

Performance: 37356378.841 ns/day, 0.000 hours/ns, 43236.550 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2188     | 1.2243     | 4.0338     | 146.7 |  1.76
Neigh   | 0.073821   | 0.075751   | 0.078915   |   0.7 |  0.11
Comm    | 30.1       | 37.683     | 43.994     |  92.6 | 54.31
Output  | 0.061151   | 0.061529   | 0.06224    |   0.2 |  0.09
Modify  | 14.885     | 21.482     | 29.754     | 142.5 | 30.96
Other   |            | 8.859      |            |       | 12.77

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.25                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.5431612808879
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.35
  ghost atom cutoff = 3.35
  binsize = 1.675, bins = 76 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14 | 17.47 | 18.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036007317   1.2105811e-39  0              0.010802195    13515.375      0              6.5260907e+10  2.6109412e-16  0              3.3278459    
    200000   127.27922      200            200            0.06874482     0.022288286    0              0.18394617     2904.8342      0              1.4026405e+10  2.6109412e-16  0              3.107674     
    300000   127.27922      200            200            0.0004128476   1.5662525e-37  0              0.0012385428   532.02625      0              2.5689644e+09  2.6109412e-16  0              3.1444753    
    400000   127.27922      200            200            0.0031549039  -2.1582622e-36  0              0.0094647118   185.6191       0              8.9628818e+08  2.6109412e-16  0              3.1210103    
    500000   127.27922      200            200            0.0040697911   6.1507613e-37  0              0.012209373    27.42433       0              1.3242228e+08  2.6109412e-16  0              3.1203855    
    600000   127.27922      200            200            0.0046052976   1.1503069e-36  0              0.013815893    3.5578176      0              17179428       2.6109412e-16  0              3.1200288    
    700000   127.27922      200            200            0.0041924894   3.1110857e-38  0              0.012577468    0.49236563     0              2377457.4      2.6109412e-16  0              3.1203416    
    800000   127.27922      200            200            0.0041674284  -5.5476529e-37  0              0.012502285    0.042123102    0              203397.38      2.6109412e-16  0              3.1203655    
    900000   127.27922      200            200            0.0042234095   1.2847282e-37  0              0.012670228    0.0013188329   0              6368.1719      2.6109412e-16  0              3.1203259    
   1000000   127.27922      200            200            0.0042639954   2.5450858e-38  0              0.012791986    2.1493158e-05  0              103.78277      2.6109412e-16  0              3.1202965    
   1100000   127.27922      200            200            0.004282472    2.1465297e-38  0              0.012847416    6.2239182e-05  0              300.53073      2.6109412e-16  0              3.1202829    
   1200000   127.27922      200            200            0.0042887897   1.6390669e-38  0              0.012866369    1.9498242e-05  0              94.150031      2.6109412e-16  0              3.1202782    
   1300000   127.27922      200            200            0.0042903258   1.0736833e-39  0              0.012870977    3.0787276e-06  0              14.866074      2.6109412e-16  0              3.1202771    
   1400000   127.27922      200            200            0.0042904525   1.0306532e-39  0              0.012871358    2.7448844e-07  0              1.3254064      2.6109412e-16  0              3.120277     
   1500000   127.27922      200            200            0.0042903256   2.4868228e-39  0              0.012870977    9.490742e-09   0              0.045827396    2.6109412e-16  0              3.120277     
   1600000   127.27922      200            200            0.0042902274   1.6891631e-39  0              0.012870682    7.4499988e-11  0              0.00035973378  2.6109412e-16  0              3.1202771    
   1700000   127.27922      200            200            0.0042901817  -5.0780116e-39  0              0.012870545    3.4969485e-10  0              0.0016885513   2.6109412e-16  0              3.1202771    
   1800000   127.27922      200            200            0.0042901659  -3.2863617e-39  0              0.012870498    1.1630153e-10  0              0.00056157846  2.6109412e-16  0              3.1202772    
   1900000   127.27922      200            200            0.0042901619  -1.6121475e-40  0              0.012870486    1.9029738e-11  0              9.1887796e-05  2.6109412e-16  0              3.1202772    
   2000000   127.27922      200            200            0.0042901615   5.5161238e-39  0              0.012870485    1.7656955e-12  0              8.5259115e-06  2.6109412e-16  0              3.1202772    
   2100000   127.27922      200            200            0.0042901618   5.2846697e-39  0              0.012870485    6.7068064e-14  0              3.2384768e-07  2.6109412e-16  0              3.1202772    
   2200000   127.27922      200            200            0.0042901621  -2.0545723e-39  0              0.012870486    2.0352192e-16  0              9.827345e-10   2.6109412e-16  0              3.1202772    
   2300000   127.27922      200            200            0.0042901622  -9.2277999e-39  0              0.012870487    1.9577786e-15  0              9.453412e-09   2.6109412e-16  0              3.1202772    
   2400000   127.27922      200            200            0.0042901622   1.8881984e-38  0              0.012870487    6.9215189e-16  0              3.3421538e-09  2.6109412e-16  0              3.1202772    
   2500000   127.27922      200            200            0.0042901622  -3.6597959e-39  0              0.012870487    1.1760911e-16  0              5.6789229e-10  2.6109412e-16  0              3.1202772    
   2600000   127.27922      200            200            0.0042901622  -9.0504273e-39  0              0.012870487    1.1722142e-17  0              5.6602028e-11  2.6109412e-16  0              3.1202772    
   2700000   127.27922      200            200            0.0042901622  -1.1801755e-38  0              0.012870487    3.1058383e-19  0              1.4996982e-12  2.6109412e-16  0              3.1202772    
   2800000   127.27922      200            200            0.0042901622  -2.6424605e-38  0              0.012870487    1.6390885e-21  0              7.9145719e-15  2.6109412e-16  0              3.1202772    
   2900000   127.27922      200            200            0.0042901622   3.6056566e-40  0              0.012870487    6.6699422e-20  0              3.2206764e-13  2.6109412e-16  0              3.1202772    
   3000000   127.27922      200            200            0.0042901622   8.0453385e-39  0              0.012870487    9.1220828e-21  0              4.4047273e-14  2.6109412e-16  0              3.1202772    
Loop time of 69.5624 on 4 procs for 3000000 steps with 51 atoms

Performance: 37261488.272 ns/day, 0.000 hours/ns, 43126.723 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21771    | 1.1781     | 3.8632     | 142.9 |  1.69
Neigh   | 0.070917   | 0.0728     | 0.075993   |   0.7 |  0.10
Comm    | 30.13      | 37.79      | 44.08      |  93.6 | 54.33
Output  | 0.062841   | 0.063334   | 0.064242   |   0.2 |  0.09
Modify  | 14.973     | 21.592     | 29.877     | 142.5 | 31.04
Other   |            | 8.866      |            |       | 12.75

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.26                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.9092993486176
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.36
  ghost atom cutoff = 3.36
  binsize = 1.68, bins = 76 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14 | 17.47 | 18.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036105683   1.5131673e-39  0              0.010831705    13565.056      0              6.5500801e+10  2.6109412e-16  0              3.327789     
    200000   127.27922      200            200            0.094764323    0.0186521      0              0.26564087     1905.3695      0              9.2003476e+09  2.6109412e-16  0              3.1097827    
    300000   127.27922      200            200            0.00042714117 -3.8587074e-37  0              0.0012814235   563.01333      0              2.7185899e+09  2.6109412e-16  0              3.1478675    
    400000   127.27922      200            200            0.0019424471   2.6913344e-37  0              0.0058273412   176.55954      0              8.5254282e+08  2.6109412e-16  0              3.1270574    
    500000   127.27922      200            200            0.0034230469   3.1362367e-37  0              0.010269141    26.09635       0              1.2600994e+08  2.6109412e-16  0              3.1258872    
    600000   127.27922      200            200            0.0043222278   4.7978313e-36  0              0.012966683    3.7365901      0              18042656       2.6109412e-16  0              3.1252405    
    700000   127.27922      200            200            0.0040868478   5.3254855e-38  0              0.012260543    0.43012291     0              2076909.6      2.6109412e-16  0              3.1254277    
    800000   127.27922      200            200            0.0041409495   5.4186933e-37  0              0.012422849    0.025179358    0              121582.11      2.6109412e-16  0              3.1253929    
    900000   127.27922      200            200            0.0042256165   1.2773552e-37  0              0.01267685     0.00011730846  0              566.44055      2.6109412e-16  0              3.1253319    
   1000000   127.27922      200            200            0.004273107   -1.5207047e-38  0              0.012819321    0.00021775695  0              1051.4704      2.6109412e-16  0              3.1252972    
   1100000   127.27922      200            200            0.0042916382   1.9338414e-38  0              0.012874915    0.00011601799  0              560.20935      2.6109412e-16  0              3.1252836    
   1200000   127.27922      200            200            0.0042968779  -8.2080355e-40  0              0.012890634    2.2924077e-05  0              110.69216      2.6109412e-16  0              3.1252797    
   1300000   127.27922      200            200            0.004297669    3.3065636e-39  0              0.012893007    2.4280935e-06  0              11.724395      2.6109412e-16  0              3.125279     
   1400000   127.27922      200            200            0.0042974582   2.1624561e-39  0              0.012892374    1.113052e-07   0              0.53745296     2.6109412e-16  0              3.1252792    
   1500000   127.27922      200            200            0.0042972183   9.0611478e-40  0              0.012891655    5.0379743e-13  0              2.4326575e-06  2.6109412e-16  0              3.1252793    
   1600000   127.27922      200            200            0.0042970958   7.9163775e-39  0              0.012891287    2.0788278e-09  0              0.010037916    2.6109412e-16  0              3.1252794    
   1700000   127.27922      200            200            0.004297051    2.2817065e-39  0              0.012891153    8.1936476e-10  0              0.0039564192   2.6109412e-16  0              3.1252795    
   1800000   127.27922      200            200            0.0042970394   1.567275e-39   0              0.012891118    1.4068765e-10  0              0.00067933032  2.6109412e-16  0              3.1252795    
   1900000   127.27922      200            200            0.0042970382   9.7013704e-40  0              0.012891115    1.2945368e-11  0              6.2508548e-05  2.6109412e-16  0              3.1252795    
   2000000   127.27922      200            200            0.004297039    6.5519879e-39  0              0.012891117    4.3724286e-13  0              2.1112893e-06  2.6109412e-16  0              3.1252795    
   2100000   127.27922      200            200            0.0042970396   3.7976583e-39  0              0.012891119    4.9528683e-15  0              2.3915629e-08  2.6109412e-16  0              3.1252795    
   2200000   127.27922      200            200            0.0042970399  -1.2295462e-39  0              0.01289112     1.7908415e-14  0              8.6473325e-08  2.6109412e-16  0              3.1252795    
   2300000   127.27922      200            200            0.00429704    -1.2565098e-39  0              0.01289112     5.592844e-15   0              2.7005842e-08  2.6109412e-16  0              3.1252795    
   2400000   127.27922      200            200            0.0042970401  -9.5878369e-39  0              0.01289112     8.4134498e-16  0              4.0625538e-09  2.6109412e-16  0              3.1252795    
   2500000   127.27922      200            200            0.0042970401   4.198899e-40   0              0.01289112     6.8009569e-17  0              3.2839387e-10  2.6109412e-16  0              3.1252795    
   2600000   127.27922      200            200            0.0042970401  -3.9046788e-39  0              0.01289112     1.5268882e-18  0              7.3727967e-12  2.6109412e-16  0              3.1252795    
   2700000   127.27922      200            200            0.0042970401  -7.5842345e-40  0              0.01289112     1.5138444e-19  0              7.309813e-13   2.6109412e-16  0              3.1252795    
   2800000   127.27922      200            200            0.0042970401  -4.6529364e-39  0              0.01289112     1.4559988e-19  0              7.030497e-13   2.6109412e-16  0              3.1252795    
   2900000   127.27922      200            200            0.0042970401  -5.8883279e-39  0              0.01289112     1.3530812e-20  0              6.5335447e-14  2.6109412e-16  0              3.1252795    
   3000000   127.27922      200            200            0.0042970401   4.0258996e-39  0              0.01289112     1.6169875e-22  0              7.8078539e-16  2.6109412e-16  0              3.1252795    
Loop time of 69.8142 on 4 procs for 3000000 steps with 51 atoms

Performance: 37127098.754 ns/day, 0.000 hours/ns, 42971.179 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22267    | 1.2189     | 4.0169     | 146.4 |  1.75
Neigh   | 0.069143   | 0.070464   | 0.07319    |   0.6 |  0.10
Comm    | 30.281     | 37.92      | 44.257     |  93.1 | 54.32
Output  | 0.058416   | 0.058698   | 0.059086   |   0.1 |  0.08
Modify  | 14.988     | 21.622     | 29.922     | 142.4 | 30.97
Other   |            | 8.924      |            |       | 12.78

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.27                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.2776905665988
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.37
  ghost atom cutoff = 3.37
  binsize = 1.685, bins = 76 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036204058  -1.8157522e-39  0              0.010861217    13614.807      0              6.5741029e+10  2.6109412e-16  0              3.3277203    
    200000   127.27922      200            200            0.11632218     0.013273844    0              0.3356927      877.86489      0              4.2388954e+09  2.6109412e-16  0              3.1126101    
    300000   127.27922      200            200            0.00044154892  2.4219941e-39  0              0.0013246468   594.83983      0              2.8722686e+09  2.6109412e-16  0              3.151212     
    400000   127.27922      200            200            0.0009581048  -4.7083383e-36  0              0.0028743144   162.33734      0              7.8386894e+08  2.6109412e-16  0              3.1330713    
    500000   127.27922      200            200            0.0028368988   5.845528e-36   0              0.0085106963   23.358212      0              1.1278845e+08  2.6109412e-16  0              3.1313699    
    600000   127.27922      200            200            0.0040438797  -1.0157742e-36  0              0.012131639    3.620037       0              17479863       2.6109412e-16  0              3.1304533    
    700000   127.27922      200            200            0.0039923621   1.1499676e-37  0              0.011977086    0.33383906     0              1611989.4      2.6109412e-16  0              3.1305062    
    800000   127.27922      200            200            0.0041240296   3.9530272e-37  0              0.012372089    0.010525165    0              50822.256      2.6109412e-16  0              3.1304132    
    900000   127.27922      200            200            0.0042331147  -2.5637139e-37  0              0.012699344    0.00023636145  0              1141.3049      2.6109412e-16  0              3.1303339    
   1000000   127.27922      200            200            0.0042843336  -1.3132269e-37  0              0.012853001    0.00055418186  0              2675.9459      2.6109412e-16  0              3.1302964    
   1100000   127.27922      200            200            0.0043013643   1.364692e-38   0              0.012904093    0.0001569711   0              757.95728      2.6109412e-16  0              3.1302838    
   1200000   127.27922      200            200            0.0043049854   2.3883005e-40  0              0.012914956    2.1027236e-05  0              101.533        2.6109412e-16  0              3.1302811    
   1300000   127.27922      200            200            0.0043049256   1.723017e-39   0              0.012914777    1.3201017e-06  0              6.3742989      2.6109412e-16  0              3.1302811    
   1400000   127.27922      200            200            0.0043043985  -2.3763417e-40  0              0.012913195    8.5007177e-09  0              0.041046923    2.6109412e-16  0              3.1302814    
   1500000   127.27922      200            200            0.0043040796   4.5826627e-39  0              0.012912239    9.6598834e-09  0              0.04664412     2.6109412e-16  0              3.1302817    
   1600000   127.27922      200            200            0.0043039532   6.8316462e-39  0              0.01291186     5.3942736e-09  0              0.026047017    2.6109412e-16  0              3.1302818    
   1700000   127.27922      200            200            0.0043039179  -8.3994972e-39  0              0.012911754    1.0407425e-09  0              0.0050253729   2.6109412e-16  0              3.1302818    
   1800000   127.27922      200            200            0.0043039131   3.0852327e-39  0              0.012911739    1.0147232e-10  0              0.00048997353  2.6109412e-16  0              3.1302818    
   1900000   127.27922      200            200            0.0043039149   1.3780251e-39  0              0.012911745    3.5463432e-12  0              1.7124022e-05  2.6109412e-16  0              3.1302818    
   2000000   127.27922      200            200            0.0043039167   2.2280414e-39  0              0.01291175     3.8032712e-14  0              1.8364636e-07  2.6109412e-16  0              3.1302818    
   2100000   127.27922      200            200            0.0043039175   1.2907815e-38  0              0.012911753    1.4118871e-13  0              6.8174977e-07  2.6109412e-16  0              3.1302818    
   2200000   127.27922      200            200            0.0043039178  -8.9400667e-39  0              0.012911753    4.2709277e-14  0              2.0622782e-07  2.6109412e-16  0              3.1302818    
   2300000   127.27922      200            200            0.0043039179   2.0631067e-39  0              0.012911754    5.985753e-15   0              2.8903059e-08  2.6109412e-16  0              3.1302818    
   2400000   127.27922      200            200            0.0043039179   3.5606361e-39  0              0.012911754    3.9869024e-16  0              1.9251325e-09  2.6109412e-16  0              3.1302818    
   2500000   127.27922      200            200            0.0043039179  -3.2243821e-39  0              0.012911754    3.6986556e-18  0              1.7859484e-11  2.6109412e-16  0              3.1302818    
   2600000   127.27922      200            200            0.0043039179   5.9319581e-39  0              0.012911754    2.1525339e-18  0              1.0393816e-11  2.6109412e-16  0              3.1302818    
   2700000   127.27922      200            200            0.0043039179   7.8102328e-40  0              0.012911754    1.5824615e-18  0              7.6411404e-12  2.6109412e-16  0              3.1302818    
   2800000   127.27922      200            200            0.0043039179  -1.0188067e-38  0              0.012911754    2.7748921e-19  0              1.3398961e-12  2.6109412e-16  0              3.1302818    
   2900000   127.27922      200            200            0.0043039179   6.9358588e-39  0              0.012911754    5.6276527e-21  0              2.7173921e-14  2.6109412e-16  0              3.1302818    
   3000000   127.27922      200            200            0.0043039179  -2.3030002e-39  0              0.012911754    4.0359954e-20  0              1.9488377e-13  2.6109412e-16  0              3.1302818    
Loop time of 70.476 on 4 procs for 3000000 steps with 51 atoms

Performance: 36778470.394 ns/day, 0.000 hours/ns, 42567.674 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22093    | 1.2127     | 4.0053     | 146.5 |  1.72
Neigh   | 0.072122   | 0.073422   | 0.076081   |   0.6 |  0.10
Comm    | 30.58      | 38.335     | 44.676     |  93.8 | 54.39
Output  | 0.05988    | 0.060154   | 0.060564   |   0.1 |  0.09
Modify  | 15.188     | 21.829     | 30.264     | 143.6 | 30.97
Other   |            | 8.965      |            |       | 12.72

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.28                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.6483418463349
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.38
  ghost atom cutoff = 3.38
  binsize = 1.69, bins = 76 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036302442   3.0264129e-40  0              0.010890733    13664.627      0              6.5981592e+10  2.6109412e-16  0              3.3276398    
    200000   127.27922      200            200            0.12951715     0.0092819647   0              0.37926947     163.23532      0              7.8820494e+08  2.6109412e-16  0              3.1163579    
    300000   127.27922      200            200            0.00045606965  8.535676e-37   0              0.001368209    627.50194      0              3.0299823e+09  2.6109412e-16  0              3.1545088    
    400000   127.27922      200            200            0.00023821825  7.9199504e-37  0              0.00071465475  144.76737      0              6.990298e+08   2.6109412e-16  0              3.1390373    
    500000   127.27922      200            200            0.0023247348   2.8062498e-36  0              0.0069742043   19.595705      0              94620648       2.6109412e-16  0              3.1368202    
    600000   127.27922      200            200            0.0037814398  -2.183781e-36   0              0.011344319    3.2327309      0              15609701       2.6109412e-16  0              3.1356589    
    700000   127.27922      200            200            0.0039137349   4.5664474e-37  0              0.011741205    0.22249031     0              1074326.1      2.6109412e-16  0              3.1355733    
    800000   127.27922      200            200            0.0041180631  -1.3103645e-36  0              0.012354189    0.0016348991   0              7894.3429      2.6109412e-16  0              3.1354254    
    900000   127.27922      200            200            0.004245854   -2.6071163e-37  0              0.012737562    0.001628897    0              7865.3605      2.6109412e-16  0              3.1353321    
   1000000   127.27922      200            200            0.00429729     1.3618039e-37  0              0.01289187     0.00091342879  0              4410.6207      2.6109412e-16  0              3.1352943    
   1100000   127.27922      200            200            0.0043113548   1.3411483e-39  0              0.012934064    0.00016867422  0              814.46746      2.6109412e-16  0              3.1352838    
   1200000   127.27922      200            200            0.004312965   -1.6965662e-39  0              0.012938895    1.4719591e-05  0              71.075636      2.6109412e-16  0              3.1352825    
   1300000   127.27922      200            200            0.004312044   -6.5157062e-39  0              0.012936132    3.41422e-07    0              1.6486046      2.6109412e-16  0              3.1352832    
   1400000   127.27922      200            200            0.0043112641   1.9674841e-40  0              0.012933792    2.6405856e-08  0              0.12750443     2.6109412e-16  0              3.1352837    
   1500000   127.27922      200            200            0.0043109127   3.6213973e-39  0              0.012932738    3.1776653e-08  0              0.15343808     2.6109412e-16  0              3.135284     
   1600000   127.27922      200            200            0.0043108037  -6.3279489e-39  0              0.012932411    7.5381348e-09  0              0.036398955    2.6109412e-16  0              3.1352841    
   1700000   127.27922      200            200            0.0043107847   6.1920612e-39  0              0.012932354    8.3375106e-10  0              0.0040258855   2.6109412e-16  0              3.1352841    
   1800000   127.27922      200            200            0.0043107879  -2.9912133e-39  0              0.012932364    3.4531338e-11  0              0.00016673947  2.6109412e-16  0              3.1352841    
   1900000   127.27922      200            200            0.0043107924   2.4717797e-39  0              0.012932377    1.0268764e-13  0              4.9584185e-07  2.6109412e-16  0              3.1352841    
   2000000   127.27922      200            200            0.0043107947  -4.0699146e-40  0              0.012932384    9.8167059e-13  0              4.740136e-06   2.6109412e-16  0              3.1352841    
   2100000   127.27922      200            200            0.0043107955   1.6953125e-39  0              0.012932387    3.1522248e-13  0              1.5220965e-06  2.6109412e-16  0              3.1352841    
   2200000   127.27922      200            200            0.0043107957   3.1490903e-40  0              0.012932387    4.3528628e-14  0              2.1018417e-07  2.6109412e-16  0              3.1352841    
   2300000   127.27922      200            200            0.0043107957  -1.1801387e-38  0              0.012932387    2.6309194e-15  0              1.2703768e-08  2.6109412e-16  0              3.1352841    
   2400000   127.27922      200            200            0.0043107957  -7.4797894e-40  0              0.012932387    9.4229393e-18  0              4.5500001e-11  2.6109412e-16  0              3.1352841    
   2500000   127.27922      200            200            0.0043107957  -1.6180613e-39  0              0.012932387    2.8168167e-17  0              1.36014e-10    2.6109412e-16  0              3.1352841    
   2600000   127.27922      200            200            0.0043107957  -1.5609368e-38  0              0.012932387    1.2419322e-17  0              5.9968463e-11  2.6109412e-16  0              3.1352841    
   2700000   127.27922      200            200            0.0043107957  -8.8135547e-39  0              0.012932387    1.9226698e-18  0              9.2838843e-12  2.6109412e-16  0              3.1352841    
   2800000   127.27922      200            200            0.0043107957  -1.0268488e-38  0              0.012932387    6.5130997e-20  0              3.1449428e-13  2.6109412e-16  0              3.1352841    
   2900000   127.27922      200            200            0.0043107957   6.2041683e-40  0              0.012932387    2.2747555e-20  0              1.098398e-13   2.6109412e-16  0              3.1352841    
   3000000   127.27922      200            200            0.0043107957   4.5016114e-39  0              0.012932387    5.2186352e-20  0              2.5198922e-13  2.6109412e-16  0              3.1352841    
Loop time of 69.893 on 4 procs for 3000000 steps with 51 atoms

Performance: 37085233.324 ns/day, 0.000 hours/ns, 42922.724 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22497    | 1.1942     | 3.9227     | 144.2 |  1.71
Neigh   | 0.071881   | 0.072575   | 0.074628   |   0.4 |  0.10
Comm    | 30.265     | 37.902     | 44.152     |  93.6 | 54.23
Output  | 0.061856   | 0.062354   | 0.063456   |   0.3 |  0.09
Modify  | 15.209     | 21.797     | 30.089     | 142.8 | 31.19
Other   |            | 8.865      |            |       | 12.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.29                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.0212600993298
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.39
  ghost atom cutoff = 3.39
  binsize = 1.695, bins = 76 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036400835  -3.0262773e-40  0              0.01092025     13714.516      0              6.622249e+10   2.6109412e-16  0              3.3275474    
    200000   127.27922      200            200            0.13177955     0.0083000486   0              0.3870386      28.691081      0              1.3853896e+08  2.6109412e-16  0              3.1211532    
    300000   127.27922      200            200            0.00047070304 -3.8358345e-38  0              0.0014121091   660.99795      0              3.1917225e+09  2.6109412e-16  0              3.1577578    
    400000   127.27922      200            200           -0.00014504892 -2.7326158e-36  0             -0.00043514675  125.78654      0              6.073782e+08   2.6109412e-16  0              3.1449447    
    500000   127.27922      200            200            0.0018941353  -1.0716077e-35  0              0.0056824059   15.272586      0              73745854       2.6109412e-16  0              3.1422262    
    600000   127.27922      200            200            0.0035445396   3.6452644e-37  0              0.010633619    2.6397733      0              12746520       2.6109412e-16  0              3.1408493    
    700000   127.27922      200            200            0.0038548041   8.1287631e-37  0              0.011564412    0.11761204     0              567906.43      2.6109412e-16  0              3.140626     
    800000   127.27922      200            200            0.004123798   -1.0054866e-36  0              0.012371394    0.0005760523   0              2781.5504      2.6109412e-16  0              3.1404289    
    900000   127.27922      200            200            0.0042634038   4.3401996e-37  0              0.012790211    0.00387969     0              18733.634      2.6109412e-16  0              3.1403267    
   1000000   127.27922      200            200            0.0043114401   1.7812347e-38  0              0.01293432     0.0011713892   0              5656.2194      2.6109412e-16  0              3.1402913    
   1100000   127.27922      200            200            0.0043212883  -2.9423729e-38  0              0.012963865    0.00014659331  0              707.84663      2.6109412e-16  0              3.1402839    
   1200000   127.27922      200            200            0.0043206857  -7.6810585e-39  0              0.012962057    6.9374363e-06  0              33.498397      2.6109412e-16  0              3.1402842    
   1300000   127.27922      200            200            0.0043189919  -8.4973556e-39  0              0.012956976    3.3216917e-09  0              0.01603926     2.6109412e-16  0              3.1402854    
   1400000   127.27922      200            200            0.0043180571   1.0222835e-39  0              0.012954171    1.5287831e-07  0              0.73819463     2.6109412e-16  0              3.1402861    
   1500000   127.27922      200            200            0.0043177253   6.0321893e-39  0              0.012953176    5.1467181e-08  0              0.2485166      2.6109412e-16  0              3.1402863    
   1600000   127.27922      200            200            0.0043176527  -2.0974238e-39  0              0.012952958    6.9299184e-09  0              0.033462096    2.6109412e-16  0              3.1402864    
   1700000   127.27922      200            200            0.004317654   -4.0811098e-39  0              0.012952962    3.7101574e-10  0              0.0017915022   2.6109412e-16  0              3.1402864    
   1800000   127.27922      200            200            0.0043176646   1.2989684e-39  0              0.012952994    8.7129576e-14  0              4.2071754e-07  2.6109412e-16  0              3.1402864    
   1900000   127.27922      200            200            0.0043176708  -1.6708977e-39  0              0.012953012    5.9023687e-12  0              2.8500426e-05  2.6109412e-16  0              3.1402864    
   2000000   127.27922      200            200            0.0043176731  -8.7208745e-40  0              0.012953019    2.2439776e-12  0              1.0835365e-05  2.6109412e-16  0              3.1402864    
   2100000   127.27922      200            200            0.0043176736   2.4901315e-39  0              0.012953021    3.2519995e-13  0              1.5702742e-06  2.6109412e-16  0              3.1402864    
   2200000   127.27922      200            200            0.0043176736  -3.6799964e-39  0              0.012953021    1.9478396e-14  0              9.4054205e-08  2.6109412e-16  0              3.1402864    
   2300000   127.27922      200            200            0.0043176735  -6.0563476e-39  0              0.012953021    4.3571773e-17  0              2.103925e-10   2.6109412e-16  0              3.1402864    
   2400000   127.27922      200            200            0.0043176735   1.4248401e-39  0              0.01295302     2.1979936e-16  0              1.0613324e-09  2.6109412e-16  0              3.1402864    
   2500000   127.27922      200            200            0.0043176735  -1.8030897e-39  0              0.01295302     9.8062876e-17  0              4.7351053e-10  2.6109412e-16  0              3.1402864    
   2600000   127.27922      200            200            0.0043176735  -4.8323631e-39  0              0.01295302     1.5155137e-17  0              7.3178732e-11  2.6109412e-16  0              3.1402864    
   2700000   127.27922      200            200            0.0043176735  -3.8586898e-40  0              0.01295302     6.4020428e-19  0              3.0913173e-12  2.6109412e-16  0              3.1402864    
   2800000   127.27922      200            200            0.0043176735   3.0776965e-39  0              0.01295302     8.8772125e-22  0              4.2864882e-15  2.6109412e-16  0              3.1402864    
   2900000   127.27922      200            200            0.0043176735   4.3638188e-39  0              0.01295302     9.4477585e-20  0              4.5619845e-13  2.6109412e-16  0              3.1402864    
   3000000   127.27922      200            200            0.0043176735   7.1211968e-39  0              0.01295302     1.5873908e-19  0              7.664942e-13   2.6109412e-16  0              3.1402864    
Loop time of 69.7954 on 4 procs for 3000000 steps with 51 atoms

Performance: 37137130.547 ns/day, 0.000 hours/ns, 42982.790 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21618    | 1.2117     | 4.0018     | 146.4 |  1.74
Neigh   | 0.070801   | 0.072606   | 0.07567    |   0.7 |  0.10
Comm    | 30.279     | 37.881     | 44.195     |  92.7 | 54.27
Output  | 0.06202    | 0.062431   | 0.063184   |   0.2 |  0.09
Modify  | 15.049     | 21.665     | 29.912     | 141.8 | 31.04
Other   |            | 8.903      |            |       | 12.76

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.3964522370874
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.4
  ghost atom cutoff = 3.4
  binsize = 1.7, bins = 75 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.94 | 17.41 | 18.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036499236  -9.6755888e-39  0              0.010949771    13764.475      0              6.6463723e+10  2.6109412e-16  0              3.327443     
    200000   127.27922      200            200            0.12192389     0.0087753248   0              0.35699636     525.86511      0              2.5392144e+09  2.6109412e-16  0              3.127021     
    300000   127.27922      200            200            0.00048544787 -7.5733476e-38  0              0.0014563436   695.32405      0              3.357471e+09   2.6109412e-16  0              3.160959     
    400000   127.27922      200            200           -0.0001406283  -1.1947819e-36  0             -0.00042188489  107.51261      0              5.1913991e+08  2.6109412e-16  0              3.1507879    
    500000   127.27922      200            200            0.0015475357  -3.259327e-36   0              0.0046426072   10.867928      0              52477337       2.6109412e-16  0              3.1475779    
    600000   127.27922      200            200            0.0033410665   2.8927272e-36  0              0.010023199    1.9346844      0              9341898.5      2.6109412e-16  0              3.1460176    
    700000   127.27922      200            200            0.0038184513   3.927579e-36   0              0.011455354    0.03918572     0              189213.82      2.6109412e-16  0              3.1456619    
    800000   127.27922      200            200            0.0041413027   2.3197667e-37  0              0.012423908    0.0075342336   0              36380.118      2.6109412e-16  0              3.1454238    
    900000   127.27922      200            200            0.0042849822  -1.9378334e-37  0              0.012854947    0.0063281812   0              30556.522      2.6109412e-16  0              3.1453183    
   1000000   127.27922      200            200            0.0043261442   7.0589975e-39  0              0.012978433    0.0012397611   0              5986.3624      2.6109412e-16  0              3.1452879    
   1100000   127.27922      200            200            0.0043308503   2.2426184e-38  0              0.012992551    9.9747186e-05  0              481.64346      2.6109412e-16  0              3.1452842    
   1200000   127.27922      200            200            0.0043280479   5.2442107e-38  0              0.012984144    1.2616463e-06  0              6.0920386      2.6109412e-16  0              3.1452861    
   1300000   127.27922      200            200            0.0043257603  -1.20302e-39    0              0.012977281    4.7489353e-07  0              2.2930909      2.6109412e-16  0              3.1452878    
   1400000   127.27922      200            200            0.004324791    1.3380884e-39  0              0.012974373    3.1169486e-07  0              1.5050629      2.6109412e-16  0              3.1452885    
   1500000   127.27922      200            200            0.004324529    7.2098851e-39  0              0.012973587    5.5660868e-08  0              0.26876641     2.6109412e-16  0              3.1452887    
   1600000   127.27922      200            200            0.0043245057   3.8870134e-39  0              0.012973517    4.0392224e-09  0              0.019503959    2.6109412e-16  0              3.1452887    
   1700000   127.27922      200            200            0.0043245274  -1.7546901e-39  0              0.012973582    3.0763932e-11  0              0.00014854802  2.6109412e-16  0              3.1452887    
   1800000   127.27922      200            200            0.0043245433   1.1910792e-39  0              0.01297363     2.8410738e-11  0              0.00013718528  2.6109412e-16  0              3.1452886    
   1900000   127.27922      200            200            0.0043245498  -7.842121e-39   0              0.012973649    1.5158095e-11  0              7.3193018e-05  2.6109412e-16  0              3.1452886    
   2000000   127.27922      200            200            0.0043245515   1.4191639e-39  0              0.012973654    2.4782227e-12  0              1.1966451e-05  2.6109412e-16  0              3.1452886    
   2100000   127.27922      200            200            0.0043245516   4.7692897e-39  0              0.012973655    1.610522e-13   0              7.7766346e-07  2.6109412e-16  0              3.1452886    
   2200000   127.27922      200            200            0.0043245514  -2.0382119e-40  0              0.012973654    5.5667009e-16  0              2.6879607e-09  2.6109412e-16  0              3.1452886    
   2300000   127.27922      200            200            0.0043245513   2.2470569e-39  0              0.012973654    1.6313841e-15  0              7.8773697e-09  2.6109412e-16  0              3.1452886    
   2400000   127.27922      200            200            0.0043245513   3.6594086e-39  0              0.012973654    7.2918568e-16  0              3.5209767e-09  2.6109412e-16  0              3.1452886    
   2500000   127.27922      200            200            0.0043245512  -5.6388122e-39  0              0.012973654    1.094778e-16   0              5.2862911e-10  2.6109412e-16  0              3.1452886    
   2600000   127.27922      200            200            0.0043245512  -2.6347097e-39  0              0.012973654    6.6421275e-18  0              3.2072457e-11  2.6109412e-16  0              3.1452886    
   2700000   127.27922      200            200            0.0043245512   7.8434694e-39  0              0.012973654    1.8722572e-20  0              9.0404597e-14  2.6109412e-16  0              3.1452886    
   2800000   127.27922      200            200            0.0043245512  -9.2946207e-39  0              0.012973654    1.1860738e-19  0              5.727126e-13   2.6109412e-16  0              3.1452886    
   2900000   127.27922      200            200            0.0043245512   2.8614495e-39  0              0.012973654    1.0514086e-19  0              5.0768757e-13  2.6109412e-16  0              3.1452886    
   3000000   127.27922      200            200            0.0043245512   7.4981542e-40  0              0.012973654    5.5419927e-20  0              2.6760299e-13  2.6109412e-16  0              3.1452886    
Loop time of 69.8631 on 4 procs for 3000000 steps with 51 atoms

Performance: 37101125.921 ns/day, 0.000 hours/ns, 42941.118 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21621    | 1.2397     | 4.1037     | 148.6 |  1.77
Neigh   | 0.071235   | 0.073871   | 0.077794   |   0.9 |  0.11
Comm    | 30.269     | 37.912     | 44.296     |  93.0 | 54.27
Output  | 0.058012   | 0.058295   | 0.05872    |   0.1 |  0.08
Modify  | 14.973     | 21.638     | 29.969     | 142.6 | 30.97
Other   |            | 8.942      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.31                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.7739251711113
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.41
  ghost atom cutoff = 3.41
  binsize = 1.705, bins = 75 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.94 | 17.41 | 18.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036597645   3.6315978e-39  0              0.010979294    13814.503      0              6.670529e+10   2.6109412e-16  0              3.3273268    
    200000   127.27922      200            200            0.10528635     0.020562569    0              0.29529649     1460.4412      0              7.0519476e+09  2.6109412e-16  0              3.1338775    
    300000   127.27922      200            200            0.00050030295 -6.1869635e-37  0              0.0015009089   730.47645      0              3.5272094e+09  2.6109412e-16  0              3.1641123    
    400000   127.27922      200            200           -0.00013048704  4.3814993e-36  0             -0.00039146112  90.699726      0              4.3795651e+08  2.6109412e-16  0              3.1565661    
    500000   127.27922      200            200            0.0012832504  -1.0724543e-35  0              0.0038497513   6.8242721      0              32951968       2.6109412e-16  0              3.1528671    
    600000   127.27922      200            200            0.0031771189  -3.2991187e-36  0              0.0095313567   1.2241406      0              5910936.9      2.6109412e-16  0              3.1511575    
    700000   127.27922      200            200            0.003806539    3.3027956e-36  0              0.011419617    0.0019174837   0              9258.8426      2.6109412e-16  0              3.1506793    
    800000   127.27922      200            200            0.0041699623   2.1543214e-37  0              0.012509887    0.020782159    0              100349.61      2.6109412e-16  0              3.1504104    
    900000   127.27922      200            200            0.0043095115   1.4430785e-37  0              0.012928534    0.0082609355   0              39889.101      2.6109412e-16  0              3.1503078    
   1000000   127.27922      200            200            0.0043407144   7.7958663e-38  0              0.013022143    0.0010959426   0              5291.9144      2.6109412e-16  0              3.1502845    
   1100000   127.27922      200            200            0.0043397657   1.0540976e-38  0              0.013019297    4.6942264e-05  0              226.66739      2.6109412e-16  0              3.1502849    
   1200000   127.27922      200            200            0.0043349954   2.2020677e-38  0              0.013004986    2.6468466e-07  0              1.2780675      2.6109412e-16  0              3.1502883    
   1300000   127.27922      200            200            0.0043323649  -4.9476829e-39  0              0.012997095    1.4999669e-06  0              7.2428034      2.6109412e-16  0              3.1502902    
   1400000   127.27922      200            200            0.0043314881  -1.4410703e-39  0              0.012994464    4.0856608e-07  0              1.9728194      2.6109412e-16  0              3.1502908    
   1500000   127.27922      200            200            0.0043313365   9.0893633e-39  0              0.01299401     4.1699383e-08  0              0.2013514      2.6109412e-16  0              3.150291     
   1600000   127.27922      200            200            0.0043313675   3.1851343e-39  0              0.012994102    1.0040712e-09  0              0.0048483003   2.6109412e-16  0              3.1502909    
   1700000   127.27922      200            200            0.0043314059   2.2350232e-39  0              0.012994218    8.6391515e-11  0              0.00041715371  2.6109412e-16  0              3.1502909    
   1800000   127.27922      200            200            0.004331424   -2.2293435e-39  0              0.012994272    9.345916e-11   0              0.00045128084  2.6109412e-16  0              3.1502909    
   1900000   127.27922      200            200            0.0043314292  -2.9453364e-39  0              0.012994288    1.8811564e-11  0              9.083431e-05   2.6109412e-16  0              3.1502909    
   2000000   127.27922      200            200            0.0043314298  -1.1154497e-39  0              0.012994289    1.4447042e-12  0              6.9759597e-06  2.6109412e-16  0              3.1502909    
   2100000   127.27922      200            200            0.0043314294   6.8961409e-39  0              0.012994288    1.181701e-14   0              5.7060113e-08  2.6109412e-16  0              3.1502909    
   2200000   127.27922      200            200            0.0043314291   2.9396072e-39  0              0.012994287    9.9594237e-15  0              4.8090493e-08  2.6109412e-16  0              3.1502909    
   2300000   127.27922      200            200            0.004331429   -3.2910964e-39  0              0.012994287    5.2486038e-15  0              2.5343629e-08  2.6109412e-16  0              3.1502909    
   2400000   127.27922      200            200            0.004331429   -3.312048e-39   0              0.012994287    8.0772279e-16  0              3.9002043e-09  2.6109412e-16  0              3.1502909    
   2500000   127.27922      200            200            0.004331429   -1.9542595e-39  0              0.012994287    4.5714752e-17  0              2.2074018e-10  2.6109412e-16  0              3.1502909    
   2600000   127.27922      200            200            0.004331429    2.0046252e-39  0              0.012994287    1.9201168e-21  0              9.271557e-15   2.6109412e-16  0              3.1502909    
   2700000   127.27922      200            200            0.004331429   -1.1069511e-39  0              0.012994287    9.7836461e-19  0              4.7241726e-12  2.6109412e-16  0              3.1502909    
   2800000   127.27922      200            200            0.004331429    8.2974317e-40  0              0.012994287    2.8331046e-19  0              1.3680048e-12  2.6109412e-16  0              3.1502909    
   2900000   127.27922      200            200            0.004331429   -5.4865784e-39  0              0.012994287    2.9336922e-21  0              1.416575e-14   2.6109412e-16  0              3.1502909    
   3000000   127.27922      200            200            0.004331429   -3.0931417e-39  0              0.012994287    8.0297141e-22  0              3.8772616e-15  2.6109412e-16  0              3.1502909    
Loop time of 69.7488 on 4 procs for 3000000 steps with 51 atoms

Performance: 37161920.853 ns/day, 0.000 hours/ns, 43011.482 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22099    | 1.1945     | 3.9164     | 143.9 |  1.71
Neigh   | 0.070684   | 0.072505   | 0.075633   |   0.7 |  0.10
Comm    | 30.317     | 37.923     | 44.208     |  93.1 | 54.37
Output  | 0.061015   | 0.061344   | 0.06183    |   0.1 |  0.09
Modify  | 15.001     | 21.609     | 29.852     | 142.3 | 30.98
Other   |            | 8.888      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.32                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.1536858129059
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.42
  ghost atom cutoff = 3.42
  binsize = 1.71, bins = 75 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.9 | 17.37 | 18.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036696062   4.842102e-39   0              0.011008819    13864.6        0              6.694719e+10   2.6109412e-16  0              3.3271986    
    200000   127.27922      200            200            0.0815022      0.029690448    0              0.21481615     2495.7092      0              1.2050886e+10  2.6109412e-16  0              3.1415481    
    300000   127.27922      200            200            0.00051526813  7.7631747e-37  0              0.0015458044   766.45391      0              3.7009316e+09  2.6109412e-16  0              3.1672176    
    400000   127.27922      200            200           -0.00012012777 -5.8824824e-37  0             -0.00036038332  75.340104      0              3.637904e+08   2.6109412e-16  0              3.1622795    
    500000   127.27922      200            200            0.0010968898  -6.965331e-36   0              0.0032906694   3.5115623      0              16956077       2.6109412e-16  0              3.1580876    
    600000   127.27922      200            200            0.0030571186   1.6889996e-36  0              0.0091713559   0.61211335     0              2955676.3      2.6109412e-16  0              3.156264     
    700000   127.27922      200            200            0.0038198834   3.9354088e-36  0              0.01145965     0.012568629    0              60689.413      2.6109412e-16  0              3.1556776    
    800000   127.27922      200            200            0.0042085098   2.8185361e-37  0              0.01262553     0.037099727    0              179141.31      2.6109412e-16  0              3.1553897    
    900000   127.27922      200            200            0.0043356952   7.7765064e-38  0              0.013007086    0.0091180956   0              44028.02       2.6109412e-16  0              3.1552961    
   1000000   127.27922      200            200            0.0043544758   6.6101614e-38  0              0.013063427    0.00079010333  0              3815.1262      2.6109412e-16  0              3.1552818    
   1100000   127.27922      200            200            0.0043478273   1.0190766e-38  0              0.013043482    9.1595201e-06  0              44.228044      2.6109412e-16  0              3.1552863    
   1200000   127.27922      200            200            0.004341521    3.4720409e-38  0              0.013024563    4.3474576e-06  0              20.992317      2.6109412e-16  0              3.1552908    
   1300000   127.27922      200            200            0.004338843    5.585565e-40   0              0.013016529    2.5372537e-06  0              12.25149       2.6109412e-16  0              3.1552927    
   1400000   127.27922      200            200            0.0043381762   4.7111595e-39  0              0.013014529    3.8685807e-07  0              1.8679991      2.6109412e-16  0              3.1552932    
   1500000   127.27922      200            200            0.0043381601   6.135607e-39   0              0.01301448     1.8903349e-08  0              0.091277507    2.6109412e-16  0              3.1552933    
   1600000   127.27922      200            200            0.0043382412   6.2996178e-39  0              0.013014723    3.7560986e-11  0              0.00018136856  2.6109412e-16  0              3.1552932    
   1700000   127.27922      200            200            0.0043382894   6.5940336e-39  0              0.013014868    4.8772286e-10  0              0.0023550391   2.6109412e-16  0              3.1552932    
   1800000   127.27922      200            200            0.0043383058  -6.2940699e-39  0              0.013014917    1.3703013e-10  0              0.00066166945  2.6109412e-16  0              3.1552931    
   1900000   127.27922      200            200            0.0043383085   3.0690655e-40  0              0.013014926    1.3365401e-11  0              6.4536736e-05  2.6109412e-16  0              3.1552931    
   2000000   127.27922      200            200            0.0043383079   3.4033818e-39  0              0.013014924    2.4110028e-13  0              1.164187e-06   2.6109412e-16  0              3.1552931    
   2100000   127.27922      200            200            0.0043383072   5.7964318e-40  0              0.013014921    4.6654038e-14  0              2.2527565e-07  2.6109412e-16  0              3.1552931    
   2200000   127.27922      200            200            0.0043383068   5.1597071e-39  0              0.01301492     3.5752645e-14  0              1.7263673e-07  2.6109412e-16  0              3.1552931    
   2300000   127.27922      200            200            0.0043383067  -2.2145219e-39  0              0.01301492     6.1009367e-15  0              2.945924e-08   2.6109412e-16  0              3.1552931    
   2400000   127.27922      200            200            0.0043383067  -2.1640196e-39  0              0.01301492     3.5120974e-16  0              1.6958662e-09  2.6109412e-16  0              3.1552931    
   2500000   127.27922      200            200            0.0043383067   4.8048608e-40  0              0.01301492     6.8123884e-20  0              3.2894586e-13  2.6109412e-16  0              3.1552931    
   2600000   127.27922      200            200            0.0043383067  -1.5319992e-39  0              0.01301492     6.0158374e-18  0              2.9048326e-11  2.6109412e-16  0              3.1552931    
   2700000   127.27922      200            200            0.0043383067  -4.5569515e-39  0              0.01301492     2.0620667e-18  0              9.956982e-12   2.6109412e-16  0              3.1552931    
   2800000   127.27922      200            200            0.0043383067   3.5247112e-39  0              0.01301492     1.311476e-19   0              6.3326483e-13  2.6109412e-16  0              3.1552931    
   2900000   127.27922      200            200            0.0043383067  -1.3587854e-38  0              0.01301492     1.1804633e-20  0              5.7000347e-14  2.6109412e-16  0              3.1552931    
   3000000   127.27922      200            200            0.0043383067   1.0157834e-39  0              0.01301492     4.0994917e-20  0              1.9794978e-13  2.6109412e-16  0              3.1552931    
Loop time of 69.7552 on 4 procs for 3000000 steps with 51 atoms

Performance: 37158501.362 ns/day, 0.000 hours/ns, 43007.525 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22068    | 1.2118     | 3.9882     | 145.7 |  1.74
Neigh   | 0.066784   | 0.068203   | 0.070815   |   0.6 |  0.10
Comm    | 30.31      | 37.899     | 44.251     |  92.8 | 54.33
Output  | 0.059347   | 0.059758   | 0.060512   |   0.2 |  0.09
Modify  | 14.946     | 21.601     | 29.87      | 142.2 | 30.97
Other   |            | 8.915      |            |       | 12.78

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.33                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.5357410739745
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.43
  ghost atom cutoff = 3.43
  binsize = 1.715, bins = 75 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.9 | 17.37 | 18.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036794485  -2.420906e-39   0              0.011038345    13914.766      0              6.7189423e+10  2.6109412e-16  0              3.3270585    
    200000   127.27922      200            200            0.053844667    0.028248312    0              0.13328569     3324.5775      0              1.6053195e+10  2.6109412e-16  0              3.1498037    
    300000   127.27922      200            200            0.00053034135  1.9676316e-39  0              0.001591024    803.25043      0              3.8786089e+09  2.6109412e-16  0              3.1702749    
    400000   127.27922      200            200           -0.00010955322  1.8950829e-36  0             -0.00032865966  61.427659      0              2.9661218e+08  2.6109412e-16  0              3.1679278    
    500000   127.27922      200            200            0.00098307723 -8.1663742e-36  0              0.0029492317   1.2081109      0              5833535.3      2.6109412e-16  0              3.163235     
    600000   127.27922      200            200            0.0029840466   1.6519032e-36  0              0.0089521397   0.18576777     0              897006.06      2.6109412e-16  0              3.1613335    
    700000   127.27922      200            200            0.003858244    8.299867e-37   0              0.011574732    0.068767379    0              332053.06      2.6109412e-16  0              3.1606571    
    800000   127.27922      200            200            0.0042550846  -1.1788578e-37  0              0.012765254    0.052541476    0              253703.98      2.6109412e-16  0              3.1603632    
    900000   127.27922      200            200            0.0043621092  -1.4720437e-37  0              0.013086328    0.008654117    0              41787.634      2.6109412e-16  0              3.1602842    
   1000000   127.27922      200            200            0.004366825    6.1015671e-39  0              0.013100475    0.00042734807  0              2063.5109      2.6109412e-16  0              3.16028      
   1100000   127.27922      200            200            0.0043549156   9.9991429e-39  0              0.013064747    1.1947113e-06  0              5.7688335      2.6109412e-16  0              3.1602883    
   1200000   127.27922      200            200            0.0043476677   5.44749e-39    0              0.013043003    1.1587301e-05  0              55.95093       2.6109412e-16  0              3.1602936    
   1300000   127.27922      200            200            0.004345249   -1.2481842e-39  0              0.013035747    3.045866e-06   0              14.707397      2.6109412e-16  0              3.1602953    
   1400000   127.27922      200            200            0.0043448843   1.9019863e-39  0              0.013034653    2.6014276e-07  0              1.2561363      2.6109412e-16  0              3.1602956    
   1500000   127.27922      200            200            0.0043450088  -1.6536821e-39  0              0.013035026    2.2565291e-09  0              0.010895971    2.6109412e-16  0              3.1602955    
   1600000   127.27922      200            200            0.0043451274   8.8450831e-40  0              0.013035382    1.8148729e-09  0              0.0087633718   2.6109412e-16  0              3.1602954    
   1700000   127.27922      200            200            0.0043451765   1.1328899e-39  0              0.013035529    9.0735133e-10  0              0.0043812749   2.6109412e-16  0              3.1602954    
   1800000   127.27922      200            200            0.0043451878   6.3599468e-39  0              0.013035563    1.2074459e-10  0              0.00058303243  2.6109412e-16  0              3.1602954    
   1900000   127.27922      200            200            0.0043451874  -4.0318989e-39  0              0.013035562    4.1417858e-12  0              1.9999201e-05  2.6109412e-16  0              3.1602954    
   2000000   127.27922      200            200            0.0043451856  -2.1977067e-39  0              0.013035557    1.2609266e-13  0              6.0885631e-07  2.6109412e-16  0              3.1602954    
   2100000   127.27922      200            200            0.0043451847   1.0659171e-38  0              0.013035554    2.2362395e-13  0              1.0798e-06     2.6109412e-16  0              3.1602954    
   2200000   127.27922      200            200            0.0043451845  -5.4001085e-39  0              0.013035553    4.621267e-14   0              2.2314444e-07  2.6109412e-16  0              3.1602954    
   2300000   127.27922      200            200            0.0043451844   8.9500775e-39  0              0.013035553    3.0819539e-15  0              1.4881652e-08  2.6109412e-16  0              3.1602954    
   2400000   127.27922      200            200            0.0043451844   1.667697e-39   0              0.013035553    2.965461e-18   0              1.431915e-11   2.6109412e-16  0              3.1602954    
   2500000   127.27922      200            200            0.0043451845  -6.0476079e-40  0              0.013035553    4.2754631e-17  0              2.0644681e-10  2.6109412e-16  0              3.1602954    
   2600000   127.27922      200            200            0.0043451845   2.1444475e-39  0              0.013035553    1.4945615e-17  0              7.2167027e-11  2.6109412e-16  0              3.1602954    
   2700000   127.27922      200            200            0.0043451845   2.6647302e-39  0              0.013035553    1.222924e-18   0              5.9050622e-12  2.6109412e-16  0              3.1602954    
   2800000   127.27922      200            200            0.0043451845   8.2326413e-39  0              0.013035553    5.8480296e-22  0              2.8238042e-15  2.6109412e-16  0              3.1602954    
   2900000   127.27922      200            200            0.0043451845   1.2809931e-38  0              0.013035553    6.3287653e-20  0              3.0559343e-13  2.6109412e-16  0              3.1602954    
   3000000   127.27922      200            200            0.0043451845  -9.0090139e-39  0              0.013035553    9.0368893e-20  0              4.3635904e-13  2.6109412e-16  0              3.1602954    
Loop time of 69.8747 on 4 procs for 3000000 steps with 51 atoms

Performance: 37094950.991 ns/day, 0.000 hours/ns, 42933.971 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25039    | 1.2195     | 3.9899     | 144.9 |  1.75
Neigh   | 0.067497   | 0.069089   | 0.072083   |   0.7 |  0.10
Comm    | 30.269     | 37.954     | 44.29      |  93.5 | 54.32
Output  | 0.058412   | 0.058779   | 0.059479   |   0.2 |  0.08
Modify  | 14.98      | 21.663     | 30.011     | 143.4 | 31.00
Other   |            | 8.911      |            |       | 12.75

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.34                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.920097865821
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.44
  ghost atom cutoff = 3.44
  binsize = 1.72, bins = 74 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.89 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036892913   5.0080017e-44  0              0.011067874    13965          0              6.7431988e+10  2.6109412e-16  0              3.3269065    
    200000   127.27922      200            200            0.028305198    0.012309293    0              0.072606302    3827.1635      0              1.8480003e+10  2.6109412e-16  0              3.1584145    
    300000   127.27922      200            200            0.00054552281 -3.0866623e-37  0              0.0016365684   840.86574      0              4.0602397e+09  2.6109412e-16  0              3.173284     
    400000   127.27922      200            200           -9.876443e-05  -3.0679881e-36  0             -0.00029629329  48.954004      0              2.3638137e+08  2.6109412e-16  0              3.1735111    
    500000   127.27922      200            200            0.00093711927 -1.3085282e-35  0              0.0028113578   0.092649274    0              447370.19      2.6109412e-16  0              3.1683062    
    600000   127.27922      200            200            0.0029596486   5.3779323e-36  0              0.0088789457   0.0042278975   0              20415.004      2.6109412e-16  0              3.1663635    
    700000   127.27922      200            200            0.0039203271   1.4514732e-36  0              0.011760981    0.15948314     0              770086.99      2.6109412e-16  0              3.1656188    
    800000   127.27922      200            200            0.0043073312   2.6615801e-38  0              0.012921994    0.063380329    0              306040.93      2.6109412e-16  0              3.1653327    
    900000   127.27922      200            200            0.0043873084   7.6640664e-38  0              0.013161925    0.0070071054   0              33834.804      2.6109412e-16  0              3.1652731    
   1000000   127.27922      200            200            0.0043772841   1.2169474e-37  0              0.013131852    0.00013125864  0              633.80098      2.6109412e-16  0              3.1652796    
   1100000   127.27922      200            200            0.0043610115   1.4611222e-37  0              0.013083035    2.5867884e-05  0              124.90675      2.6109412e-16  0              3.1652911    
   1200000   127.27922      200            200            0.0043535225  -5.6878538e-39  0              0.013060568    1.8647226e-05  0              90.040781      2.6109412e-16  0              3.1652965    
   1300000   127.27922      200            200            0.0043516466  -1.4263246e-38  0              0.01305494     2.765457e-06   0              13.353402      2.6109412e-16  0              3.1652979    
   1400000   127.27922      200            200            0.0043516383   3.8059208e-39  0              0.013054915    1.0311222e-07  0              0.49789203     2.6109412e-16  0              3.1652979    
   1500000   127.27922      200            200            0.0043518876   2.0797979e-38  0              0.013055663    2.5202973e-09  0              0.012169614    2.6109412e-16  0              3.1652977    
   1600000   127.27922      200            200            0.0043520245  -8.3773938e-40  0              0.013056073    5.0110546e-09  0              0.024196589    2.6109412e-16  0              3.1652976    
   1700000   127.27922      200            200            0.0043520653   5.5104088e-39  0              0.013056196    1.0080173e-09  0              0.004867355    2.6109412e-16  0              3.1652976    
   1800000   127.27922      200            200            0.004352069   -8.5755624e-39  0              0.013056207    5.9402022e-11  0              0.0002868311   2.6109412e-16  0              3.1652976    
   1900000   127.27922      200            200            0.0043520655   1.0141461e-38  0              0.013056196    1.0009747e-14  0              4.8333487e-08  2.6109412e-16  0              3.1652976    
   2000000   127.27922      200            200            0.004352063   -2.4933019e-39  0              0.013056189    1.2042821e-12  0              5.8150471e-06  2.6109412e-16  0              3.1652976    
   2100000   127.27922      200            200            0.0043520622   4.3716054e-39  0              0.013056187    3.4101794e-13  0              1.6466536e-06  2.6109412e-16  0              3.1652976    
   2200000   127.27922      200            200            0.0043520621  -1.9389112e-39  0              0.013056186    2.8734428e-14  0              1.3874827e-07  2.6109412e-16  0              3.1652976    
   2300000   127.27922      200            200            0.0043520621  -5.6777029e-39  0              0.013056186    1.7904135e-16  0              8.6452658e-10  2.6109412e-16  0              3.1652976    
   2400000   127.27922      200            200            0.0043520622  -1.9918952e-39  0              0.013056186    2.4697683e-16  0              1.1925627e-09  2.6109412e-16  0              3.1652976    
   2500000   127.27922      200            200            0.0043520622   6.5610172e-40  0              0.013056187    1.0854561e-16  0              5.2412791e-10  2.6109412e-16  0              3.1652976    
   2600000   127.27922      200            200            0.0043520622   8.3309451e-39  0              0.013056187    1.2006789e-17  0              5.7976488e-11  2.6109412e-16  0              3.1652976    
   2700000   127.27922      200            200            0.0043520622  -3.1649369e-39  0              0.013056187    4.2446147e-20  0              2.0495725e-13  2.6109412e-16  0              3.1652976    
   2800000   127.27922      200            200            0.0043520622   2.4979211e-39  0              0.013056187    8.1275121e-20  0              3.9244847e-13  2.6109412e-16  0              3.1652976    
   2900000   127.27922      200            200            0.0043520622  -9.7708965e-39  0              0.013056187    1.247557e-19   0              6.0240062e-13  2.6109412e-16  0              3.1652976    
   3000000   127.27922      200            200            0.0043520622   1.5728445e-38  0              0.013056187    7.9603167e-20  0              3.843752e-13   2.6109412e-16  0              3.1652976    
Loop time of 69.778 on 4 procs for 3000000 steps with 51 atoms

Performance: 37146378.040 ns/day, 0.000 hours/ns, 42993.493 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25083    | 1.1817     | 3.834      | 140.9 |  1.69
Neigh   | 0.066239   | 0.067808   | 0.070558   |   0.7 |  0.10
Comm    | 30.262     | 37.961     | 44.242     |  93.7 | 54.40
Output  | 0.062282   | 0.062603   | 0.063028   |   0.1 |  0.09
Modify  | 14.946     | 21.605     | 29.957     | 143.3 | 30.96
Other   |            | 8.9        |            |       | 12.75

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.35                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.3067630999496
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.45
  ghost atom cutoff = 3.45
  binsize = 1.725, bins = 74 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.89 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0036991348   5.7571188e-44  0              0.011097404    14015.304      0              6.7674887e+10  2.6109412e-16  0              3.3267425    
    200000   127.27922      200            200            0.0095427965   0.00069240716  0              0.027935982    4031.4579      0              1.9466467e+10  2.6109412e-16  0              3.1672007    
    300000   127.27922      200            200            0.00056081159  6.9902287e-37  0              0.0016824348   879.29675      0              4.2458093e+09  2.6109412e-16  0              3.1762448    
    400000   127.27922      200            200           -8.7763002e-05 -5.532773e-36   0             -0.00026328901  37.911759      0              1.8306232e+08  2.6109412e-16  0              3.1790293    
    500000   127.27922      200            200            0.00095648707 -1.9517131e-36  0              0.0028694612   0.24487905     0              1182433.3      2.6109412e-16  0              3.1733       
    600000   127.27922      200            200            0.002984644   -6.9957355e-36  0              0.0089539319   0.091572213    0              442169.44      2.6109412e-16  0              3.1713531    
    700000   127.27922      200            200            0.0040038084   1.7835718e-37  0              0.012011425    0.26708435     0              1289654.7      2.6109412e-16  0              3.1705647    
    800000   127.27922      200            200            0.0043625267   2.2726427e-39  0              0.01308758     0.066997737    0              323508.1       2.6109412e-16  0              3.1703       
    900000   127.27922      200            200            0.0044099334  -1.6286731e-37  0              0.0132298      0.0046564073   0              22484.124      2.6109412e-16  0              3.1702639    
   1000000   127.27922      200            200            0.0043855416  -1.8938352e-37  0              0.013156625    1.6210964e-06  0              7.8276945      2.6109412e-16  0              3.1702807    
   1100000   127.27922      200            200            0.0043661969   5.0761965e-38  0              0.013098591    7.306989e-05   0              352.82835      2.6109412e-16  0              3.1702945    
   1200000   127.27922      200            200            0.0043592064  -2.9872831e-39  0              0.013077619    2.2310907e-05  0              107.73139      2.6109412e-16  0              3.1702996    
   1300000   127.27922      200            200            0.0043581     -9.813747e-41   0              0.0130743      1.8460863e-06  0              8.9140903      2.6109412e-16  0              3.1703004    
   1400000   127.27922      200            200            0.0043584565   6.955093e-39   0              0.01307537     7.1158145e-09  0              0.034359722    2.6109412e-16  0              3.1703002    
   1500000   127.27922      200            200            0.0043587961  -6.3517264e-39  0              0.013076388    1.9306702e-08  0              0.093225155    2.6109412e-16  0              3.1702999    
   1600000   127.27922      200            200            0.0043589287  -7.0503608e-40  0              0.013076786    7.294524e-09   0              0.035222646    2.6109412e-16  0              3.1702998    
   1700000   127.27922      200            200            0.0043589534   5.7056985e-39  0              0.01307686     7.1171091e-10  0              0.0034365973   2.6109412e-16  0              3.1702998    
   1800000   127.27922      200            200            0.0043589486  -1.6636329e-39  0              0.013076846    7.0150853e-12  0              3.3873336e-05  2.6109412e-16  0              3.1702998    
   1900000   127.27922      200            200            0.0043589427  -3.4662029e-39  0              0.013076828    4.8388776e-12  0              2.3365208e-05  2.6109412e-16  0              3.1702998    
   2000000   127.27922      200            200            0.0043589402  -1.5134404e-39  0              0.013076821    2.3403769e-12  0              1.1300842e-05  2.6109412e-16  0              3.1702998    
   2100000   127.27922      200            200            0.0043589397   2.9950773e-39  0              0.013076819    2.6723509e-13  0              1.2903826e-06  2.6109412e-16  0              3.1702998    
   2200000   127.27922      200            200            0.0043589397   4.0167926e-39  0              0.013076819    4.6466763e-15  0              2.2437137e-08  2.6109412e-16  0              3.1702998    
   2300000   127.27922      200            200            0.0043589398  -8.1218689e-39  0              0.013076819    1.1307251e-15  0              5.4598669e-09  2.6109412e-16  0              3.1702998    
   2400000   127.27922      200            200            0.0043589399   8.9584069e-39  0              0.01307682     7.3468041e-16  0              3.5475088e-09  2.6109412e-16  0              3.1702998    
   2500000   127.27922      200            200            0.0043589399   2.0061651e-39  0              0.01307682     9.7715082e-17  0              4.7183116e-10  2.6109412e-16  0              3.1702998    
   2600000   127.27922      200            200            0.0043589399  -9.5978639e-39  0              0.01307682     2.6793608e-18  0              1.2937674e-11  2.6109412e-16  0              3.1702998    
   2700000   127.27922      200            200            0.0043589399  -4.0510233e-39  0              0.01307682     4.8229022e-19  0              2.3288069e-12  2.6109412e-16  0              3.1702998    
   2800000   127.27922      200            200            0.0043589399  -7.0750077e-40  0              0.01307682     2.6729935e-19  0              1.2906929e-12  2.6109412e-16  0              3.1702998    
   2900000   127.27922      200            200            0.0043589399  -6.8152766e-39  0              0.01307682     1.6921008e-20  0              8.1705494e-14  2.6109412e-16  0              3.1702998    
   3000000   127.27922      200            200            0.0043589399  -5.4107974e-39  0              0.01307682     5.4214444e-21  0              2.6178215e-14  2.6109412e-16  0              3.1702998    
Loop time of 69.9057 on 4 procs for 3000000 steps with 51 atoms

Performance: 37078544.687 ns/day, 0.000 hours/ns, 42914.982 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25108    | 1.1993     | 3.8959     | 142.2 |  1.72
Neigh   | 0.061703   | 0.062868   | 0.065273   |   0.6 |  0.09
Comm    | 30.355     | 38.009     | 44.313     |  93.5 | 54.37
Output  | 0.058287   | 0.058566   | 0.058994   |   0.1 |  0.08
Modify  | 15.004     | 21.638     | 29.907     | 142.7 | 30.95
Other   |            | 8.938      |            |       | 12.79

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.36                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.6957436878637
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.46
  ghost atom cutoff = 3.46
  binsize = 1.73, bins = 74 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.89 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037089788  -2.4209472e-39  0              0.011126936    14065.677      0              6.7918119e+10  2.6109412e-16  0              3.3265664    
    200000   127.27922      200            200            0.0029568939   1.1153554e-35  0              0.0088706817   4046.467       0              1.9538941e+10  2.6109412e-16  0              3.176037     
    300000   127.27922      200            200            0.00090800626 -6.1756281e-37  0              0.0027240188   918.00099      0              4.4326982e+09  2.6109412e-16  0              3.1791574    
    400000   127.27922      200            200           -7.655119e-05  -4.3078369e-36  0             -0.00022965357  28.294193      0              1.3662253e+08  2.6109412e-16  0              3.1844825    
    500000   127.27922      200            200            0.0010416201   1.2903307e-35  0              0.0031248604   1.6468776      0              7952182.8      2.6109412e-16  0              3.1782165    
    600000   127.27922      200            200            0.0030588074  -4.5899201e-36  0              0.0091764221   0.43406918     0              2095964.7      2.6109412e-16  0              3.1763028    
    700000   127.27922      200            200            0.0041053549   1.4000295e-37  0              0.012316065    0.37059183     0              1789455.3      2.6109412e-16  0              3.1754977    
    800000   127.27922      200            200            0.0044177242  -2.4765424e-37  0              0.013253173    0.062513809    0              301856.81      2.6109412e-16  0              3.1752675    
    900000   127.27922      200            200            0.0044288102   6.3492e-38     0              0.01328643     0.002282459    0              11021.177      2.6109412e-16  0              3.1752574    
   1000000   127.27922      200            200            0.0043914793   8.2227864e-38  0              0.013174438    8.0771593e-05  0              390.01712      2.6109412e-16  0              3.1752835    
   1100000   127.27922      200            200            0.0043706457   2.6881538e-38  0              0.013111937    0.00012390827  0              598.30871      2.6109412e-16  0              3.1752984    
   1200000   127.27922      200            200            0.0043648594  -6.5273046e-39  0              0.013094578    2.0935763e-05  0              101.09131      2.6109412e-16  0              3.1753027    
   1300000   127.27922      200            200            0.0043646657   3.977522e-38   0              0.013093997    7.6484433e-07  0              3.6931596      2.6109412e-16  0              3.1753028    
   1400000   127.27922      200            200            0.0043653478   5.6395336e-40  0              0.013096044    2.694514e-08   0              0.13010844     2.6109412e-16  0              3.1753024    
   1500000   127.27922      200            200            0.004365729   -1.9871876e-39  0              0.013097187    4.1518288e-08  0              0.20047695     2.6109412e-16  0              3.1753021    
   1600000   127.27922      200            200            0.0043658351  -2.4809959e-39  0              0.013097505    7.023124e-09   0              0.033912152    2.6109412e-16  0              3.175302     
   1700000   127.27922      200            200            0.0043658386   3.8201407e-39  0              0.013097516    2.5695542e-10  0              0.0012407458   2.6109412e-16  0              3.175302     
   1800000   127.27922      200            200            0.0043658262   5.400048e-39   0              0.013097478    9.0022635e-12  0              4.3468709e-05  2.6109412e-16  0              3.175302     
   1900000   127.27922      200            200            0.0043658192  -5.6235685e-39  0              0.013097458    1.3915217e-11  0              6.7191605e-05  2.6109412e-16  0              3.175302     
   2000000   127.27922      200            200            0.0043658172   3.4385792e-39  0              0.013097452    2.355855e-12   0              1.137558e-05   2.6109412e-16  0              3.175302     
   2100000   127.27922      200            200            0.0043658172  -6.911786e-40   0              0.013097451    8.6309976e-14  0              4.1675999e-07  2.6109412e-16  0              3.175302     
   2200000   127.27922      200            200            0.0043658174  -5.8979687e-39  0              0.013097452    3.0047949e-15  0              1.4509079e-08  2.6109412e-16  0              3.175302     
   2300000   127.27922      200            200            0.0043658175   3.5645323e-39  0              0.013097453    4.6632597e-15  0              2.2517212e-08  2.6109412e-16  0              3.175302     
   2400000   127.27922      200            200            0.0043658176  -7.3987948e-39  0              0.013097453    7.9224336e-16  0              3.8254596e-09  2.6109412e-16  0              3.175302     
   2500000   127.27922      200            200            0.0043658176   2.3804032e-39  0              0.013097453    2.9859283e-17  0              1.4417979e-10  2.6109412e-16  0              3.175302     
   2600000   127.27922      200            200            0.0043658176   7.4924867e-39  0              0.013097453    7.7434169e-19  0              3.7390189e-12  2.6109412e-16  0              3.175302     
   2700000   127.27922      200            200            0.0043658176   4.3180512e-39  0              0.013097453    1.7529446e-18  0              8.464342e-12   2.6109412e-16  0              3.175302     
   2800000   127.27922      200            200            0.0043658176   2.5542965e-39  0              0.013097453    2.1081261e-19  0              1.0179387e-12  2.6109412e-16  0              3.175302     
   2900000   127.27922      200            200            0.0043658176   5.8467017e-39  0              0.013097453    1.8792757e-20  0              9.0743496e-14  2.6109412e-16  0              3.175302     
   3000000   127.27922      200            200            0.0043658176  -3.9476762e-39  0              0.013097453    1.5313329e-20  0              7.3942584e-14  2.6109412e-16  0              3.175302     
Loop time of 70.1363 on 4 procs for 3000000 steps with 51 atoms

Performance: 36956608.119 ns/day, 0.000 hours/ns, 42773.852 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22252    | 1.1905     | 3.9082     | 143.9 |  1.70
Neigh   | 0.068236   | 0.070353   | 0.073927   |   0.9 |  0.10
Comm    | 30.584     | 38.186     | 44.503     |  92.8 | 54.45
Output  | 0.057696   | 0.058105   | 0.05889    |   0.2 |  0.08
Modify  | 15.065     | 21.694     | 29.969     | 142.7 | 30.93
Other   |            | 8.937      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.37                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.0870465410674
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.47
  ghost atom cutoff = 3.47
  binsize = 1.735, bins = 74 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.89 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037188232   6.0529529e-40  0              0.01115647     14116.118      0              6.8161683e+10  2.6109412e-16  0              3.3263783    
    200000   127.27922      200            200           -0.00040774313  9.3006066e-37  0             -0.0012232294   3972.8664      0              1.918355e+10   2.6109412e-16  0              3.1848615    
    300000   127.27922      200            200            0.0027907534  -1.6820381e-38  0              0.0083722602   945.91889      0              4.5675038e+09  2.6109412e-16  0              3.1820273    
    400000   127.27922      200            200           -6.5130611e-05  6.5826199e-37  0             -0.00019539183  20.093939      0              97026441       2.6109412e-16  0              3.1898705    
    500000   127.27922      200            200            0.0011958669   7.9694329e-36  0              0.0035876008   4.1834139      0              20200208       2.6109412e-16  0              3.1830573    
    600000   127.27922      200            200            0.0031809057   2.7866527e-36  0              0.0095427171   0.9817458      0              4740499.1      2.6109412e-16  0              3.1812145    
    700000   127.27922      200            200            0.0042206943   1.0248468e-37  0              0.012662083    0.44964693     0              2171184.1      2.6109412e-16  0              3.1804212    
    800000   127.27922      200            200            0.0044699319  -6.469228e-37   0              0.013409796    0.051008096    0              246299.84      2.6109412e-16  0              3.1802372    
    900000   127.27922      200            200            0.0044430412  -9.6393873e-38  0              0.013329124    0.00056863841  0              2745.7514      2.6109412e-16  0              3.1802542    
   1000000   127.27922      200            200            0.0043951824  -5.2173366e-38  0              0.013185547    0.0003397567   0              1640.5635      2.6109412e-16  0              3.1802879    
   1100000   127.27922      200            200            0.0043746058  -5.4221284e-39  0              0.013123817    0.00015825253  0              764.14484      2.6109412e-16  0              3.1803027    
   1200000   127.27922      200            200            0.0043706245   1.1927562e-38  0              0.013111874    1.5173673e-05  0              73.268234      2.6109412e-16  0              3.1803057    
   1300000   127.27922      200            200            0.0043713849   1.5469808e-38  0              0.013114155    7.6224374e-08  0              0.36806022     2.6109412e-16  0              3.1803052    
   1400000   127.27922      200            200            0.0043723099  -6.8958575e-39  0              0.01311693     1.4972334e-07  0              0.72296041     2.6109412e-16  0              3.1803045    
   1500000   127.27922      200            200            0.0043726769  -4.0410828e-40  0              0.013118031    5.4697151e-08  0              0.26411297     2.6109412e-16  0              3.1803042    
   1600000   127.27922      200            200            0.004372738   -2.0933119e-39  0              0.013118214    4.4104502e-09  0              0.021296485    2.6109412e-16  0              3.1803042    
   1700000   127.27922      200            200            0.0043727194  -3.0541643e-39  0              0.013118158    4.3194118e-12  0              2.0856894e-05  2.6109412e-16  0              3.1803042    
   1800000   127.27922      200            200            0.0043727017  -2.0949785e-39  0              0.013118105    6.291041e-11   0              0.00030377185  2.6109412e-16  0              3.1803042    
   1900000   127.27922      200            200            0.0043726952  -3.4534891e-39  0              0.013118086    1.8570468e-11  0              8.9670143e-05  2.6109412e-16  0              3.1803042    
   2000000   127.27922      200            200            0.0043726943  -2.8859753e-39  0              0.013118083    1.2435449e-12  0              6.0046334e-06  2.6109412e-16  0              3.1803042    
   2100000   127.27922      200            200            0.0043726948  -2.196147e-39   0              0.013118084    2.8293737e-16  0              1.3662033e-09  2.6109412e-16  0              3.1803042    
   2200000   127.27922      200            200            0.0043726951  -7.4267774e-39  0              0.013118085    2.5424436e-14  0              1.227655e-07   2.6109412e-16  0              3.1803042    
   2300000   127.27922      200            200            0.0043726952   3.2206551e-39  0              0.013118086    6.1932102e-15  0              2.9904796e-08  2.6109412e-16  0              3.1803042    
   2400000   127.27922      200            200            0.0043726952   5.545456e-39   0              0.013118086    3.3727505e-16  0              1.6285805e-09  2.6109412e-16  0              3.1803042    
   2500000   127.27922      200            200            0.0043726952   6.8211828e-39  0              0.013118086    1.4007175e-18  0              6.7635634e-12  2.6109412e-16  0              3.1803042    
   2600000   127.27922      200            200            0.0043726952   3.4274375e-39  0              0.013118086    9.8965117e-18  0              4.7786713e-11  2.6109412e-16  0              3.1803042    
   2700000   127.27922      200            200            0.0043726952   9.9024765e-39  0              0.013118086    1.865032e-18   0              9.0055721e-12  2.6109412e-16  0              3.1803042    
   2800000   127.27922      200            200            0.0043726952  -1.1267082e-38  0              0.013118086    1.566135e-20   0              7.5623053e-14  2.6109412e-16  0              3.1803042    
   2900000   127.27922      200            200            0.0043726952   2.8796511e-39  0              0.013118086    5.112824e-21   0              2.4687997e-14  2.6109412e-16  0              3.1803042    
   3000000   127.27922      200            200            0.0043726952  -2.1161867e-39  0              0.013118086    3.8405563e-21  0              1.8544672e-14  2.6109412e-16  0              3.1803042    
Loop time of 70.0958 on 4 procs for 3000000 steps with 51 atoms

Performance: 36977980.435 ns/day, 0.000 hours/ns, 42798.588 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21932    | 1.2381     | 4.0625     | 146.6 |  1.77
Neigh   | 0.064098   | 0.066007   | 0.069247   |   0.8 |  0.09
Comm    | 30.415     | 38.111     | 44.477     |  93.4 | 54.37
Output  | 0.061228   | 0.06168    | 0.062525   |   0.2 |  0.09
Modify  | 15.062     | 21.714     | 30.068     | 142.9 | 30.98
Other   |            | 8.905      |            |       | 12.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.38                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.4806785710646
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.48
  ghost atom cutoff = 3.48
  binsize = 1.74, bins = 74 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.85 | 17.32 | 18.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.003728668    1.2105762e-39  0              0.011186004    14166.628      0              6.8405576e+10  2.6109412e-16  0              3.3261782    
    200000   127.27922      200            200           -0.00043356295 -4.8408216e-38  0             -0.0013006888   3874.7007      0              1.8709543e+10  2.6109412e-16  0              3.1936461    
    300000   127.27922      200            200            0.0055848766  -1.5248619e-37  0              0.01675463     949.70811      0              4.5858006e+09  2.6109412e-16  0              3.1848753    
    400000   127.27922      200            200           -5.3503251e-05 -5.805788e-37   0             -0.00016050975  13.30395       0              64240014       2.6109412e-16  0              3.1951934    
    500000   127.27922      200            200            0.0014245486  -3.2462059e-36  0              0.0042736458   7.6411941      0              36896592       2.6109412e-16  0              3.1878258    
    600000   127.27922      200            200            0.0033485259  -3.6217271e-37  0              0.010045578    1.6544083      0              7988545.5      2.6109412e-16  0              3.1860914    
    700000   127.27922      200            200            0.0043447341   7.4600679e-37  0              0.013034202    0.48847001     0              2358646.9      2.6109412e-16  0              3.185339     
    800000   127.27922      200            200            0.0045163015   4.2820744e-37  0              0.013548904    0.035265318    0              170283.6       2.6109412e-16  0              3.1852111    
    900000   127.27922      200            200            0.0044520762   6.0116549e-37  0              0.013356229    3.1347914e-06  0              15.136786      2.6109412e-16  0              3.1852547    
   1000000   127.27922      200            200            0.004396931    7.0616833e-39  0              0.013190793    0.00068888906  0              3326.3987      2.6109412e-16  0              3.1852937    
   1100000   127.27922      200            200            0.0043783734   1.2427349e-38  0              0.01313512     0.00016266022  0              785.42799      2.6109412e-16  0              3.1853071    
   1200000   127.27922      200            200            0.0043766309   1.1578701e-38  0              0.013129893    7.6462325e-06  0              36.92092       2.6109412e-16  0              3.1853085    
   1300000   127.27922      200            200            0.004378278    2.6674683e-38  0              0.013134834    1.2715493e-07  0              0.61398566     2.6109412e-16  0              3.1853073    
   1400000   127.27922      200            200            0.0043793298   3.0482736e-39  0              0.013137989    3.0338138e-07  0              1.4649201      2.6109412e-16  0              3.1853066    
   1500000   127.27922      200            200            0.0043796277  -2.5903269e-39  0              0.013138883    5.039505e-08   0              0.24333966     2.6109412e-16  0              3.1853064    
   1600000   127.27922      200            200            0.0043796329  -8.3010844e-41  0              0.013138899    1.341307e-09   0              0.0064766915   2.6109412e-16  0              3.1853064    
   1700000   127.27922      200            200            0.0043795952   6.1620507e-39  0              0.013138786    1.4990524e-10  0              0.00072383877  2.6109412e-16  0              3.1853064    
   1800000   127.27922      200            200            0.0043795758   5.8342882e-39  0              0.013138727    1.2141362e-10  0              0.00058626292  2.6109412e-16  0              3.1853064    
   1900000   127.27922      200            200            0.0043795713   3.1807201e-39  0              0.013138714    1.4435496e-11  0              6.9703844e-05  2.6109412e-16  0              3.1853064    
   2000000   127.27922      200            200            0.0043795717  -5.7788017e-40  0              0.013138715    1.523234e-13   0              7.3551518e-07  2.6109412e-16  0              3.1853064    
   2100000   127.27922      200            200            0.0043795725  -4.8252361e-39  0              0.013138717    1.0298692e-13  0              4.97287e-07    2.6109412e-16  0              3.1853064    
   2200000   127.27922      200            200            0.0043795728  -2.8943411e-39  0              0.013138719    4.4828873e-14  0              2.1646258e-07  2.6109412e-16  0              3.1853064    
   2300000   127.27922      200            200            0.0043795729   2.8022106e-39  0              0.013138719    3.7692681e-15  0              1.8200447e-08  2.6109412e-16  0              3.1853064    
   2400000   127.27922      200            200            0.0043795729   8.6419734e-39  0              0.013138719    2.8750331e-18  0              1.3882506e-11  2.6109412e-16  0              3.1853064    
   2500000   127.27922      200            200            0.0043795729  -3.5230241e-39  0              0.013138719    5.3475613e-17  0              2.582146e-10   2.6109412e-16  0              3.1853064    
   2600000   127.27922      200            200            0.0043795729  -4.6296427e-39  0              0.013138719    1.5358579e-17  0              7.4161082e-11  2.6109412e-16  0              3.1853064    
   2700000   127.27922      200            200            0.0043795729   2.912421e-39   0              0.013138719    5.2118885e-19  0              2.5166344e-12  2.6109412e-16  0              3.1853064    
   2800000   127.27922      200            200            0.0043795729  -6.3056722e-39  0              0.013138719    3.6878673e-20  0              1.7807391e-13  2.6109412e-16  0              3.1853064    
   2900000   127.27922      200            200            0.0043795729  -7.9735305e-40  0              0.013138719    1.0142383e-19  0              4.8973937e-13  2.6109412e-16  0              3.1853064    
   3000000   127.27922      200            200            0.0043795729   1.2934062e-39  0              0.013138719    1.2996093e-19  0              6.2753484e-13  2.6109412e-16  0              3.1853064    
Loop time of 70.0368 on 4 procs for 3000000 steps with 51 atoms

Performance: 37009116.482 ns/day, 0.000 hours/ns, 42834.626 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25052    | 1.2244     | 4.0111     | 145.4 |  1.75
Neigh   | 0.060617   | 0.062035   | 0.064621   |   0.6 |  0.09
Comm    | 30.359     | 38.071     | 44.44      |  93.9 | 54.36
Output  | 0.057957   | 0.058244   | 0.058718   |   0.1 |  0.08
Modify  | 14.988     | 21.699     | 30.086     | 143.9 | 30.98
Other   |            | 8.923      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.39                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.8766466893589
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.49
  ghost atom cutoff = 3.49
  binsize = 1.745, bins = 73 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.83 | 17.3 | 18.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037385132  -9.0788328e-40  0              0.01121554     14217.207      0              6.8649803e+10  2.6109412e-16  0              3.325966     
    200000   127.27922      200            200           -0.0004369553  -1.1608494e-37  0             -0.0013108659   3777.844       0              1.8241856e+10  2.6109412e-16  0              3.2023874    
    300000   127.27922      200            200            0.009090359    4.9094198e-05  0              0.027221983    921.31562      0              4.4487034e+09  2.6109412e-16  0              3.1877339    
    400000   127.27922      200            200           -4.1670571e-05  6.5354974e-37  0             -0.00012501171  7.9168992      0              38227873       2.6109412e-16  0              3.2004511    
    500000   127.27922      200            200            0.0017334341   5.2194337e-37  0              0.0052003023   11.711048      0              56548462       2.6109412e-16  0              3.1925267    
    600000   127.27922      200            200            0.00355784    -2.9110892e-36  0              0.01067352     2.3518198      0              11356096       2.6109412e-16  0              3.1909382    
    700000   127.27922      200            200            0.0044717536  -1.8438478e-38  0              0.013415261    0.47905727     0              2313196.1      2.6109412e-16  0              3.1902553    
    800000   127.27922      200            200            0.0045543205   1.0350368e-36  0              0.013662962    0.019100635    0              92230.13       2.6109412e-16  0              3.190191     
    900000   127.27922      200            200            0.0044557544  -9.7473499e-38  0              0.013367263    0.00073870616  0              3566.9477      2.6109412e-16  0              3.190259     
   1000000   127.27922      200            200            0.0043971745   7.8393823e-38  0              0.013191523    0.0010087987   0              4871.1277      2.6109412e-16  0              3.1903006    
   1100000   127.27922      200            200            0.0043822626  -1.0888257e-37  0              0.013146788    0.00013556532  0              654.59643      2.6109412e-16  0              3.1903114    
   1200000   127.27922      200            200            0.0043829789   2.2134412e-38  0              0.013148937    1.7394409e-06  0              8.3991375      2.6109412e-16  0              3.190311     
   1300000   127.27922      200            200            0.0043853426  -8.9985291e-39  0              0.013156028    8.8290899e-07  0              4.2632515      2.6109412e-16  0              3.1903094    
   1400000   127.27922      200            200            0.004386386   -1.1261063e-39  0              0.013159158    3.9900495e-07  0              1.9266521      2.6109412e-16  0              3.1903086    
   1500000   127.27922      200            200            0.0043865693  -3.0484677e-39  0              0.013159708    3.1499859e-08  0              0.15210155     2.6109412e-16  0              3.1903085    
   1600000   127.27922      200            200            0.0043865165   1.5623751e-40  0              0.01315955     1.3231781e-14  0              6.3891534e-08  2.6109412e-16  0              3.1903085    
   1700000   127.27922      200            200            0.0043864663  -1.3995411e-39  0              0.013159399    5.7418183e-10  0              0.0027725186   2.6109412e-16  0              3.1903086    
   1800000   127.27922      200            200            0.0043864492   8.0154076e-39  0              0.013159348    1.3390994e-10  0              0.00064660315  2.6109412e-16  0              3.1903086    
   1900000   127.27922      200            200            0.0043864477   1.187558e-39   0              0.013159343    5.4672037e-12  0              2.639917e-05   2.6109412e-16  0              3.1903086    
   2000000   127.27922      200            200            0.0043864493   4.1547494e-39  0              0.013159348    1.9209626e-13  0              9.2756409e-07  2.6109412e-16  0              3.1903086    
   2100000   127.27922      200            200            0.0043864503  -2.4405791e-39  0              0.013159351    2.7852214e-13  0              1.3448838e-06  2.6109412e-16  0              3.1903086    
   2200000   127.27922      200            200            0.0043864506   4.4106555e-39  0              0.013159352    3.8094965e-14  0              1.8394695e-07  2.6109412e-16  0              3.1903086    
   2300000   127.27922      200            200            0.0043864506   5.3485782e-39  0              0.013159352    5.2188503e-16  0              2.519996e-09   2.6109412e-16  0              3.1903086    
   2400000   127.27922      200            200            0.0043864505  -5.6700259e-39  0              0.013159352    2.3491607e-16  0              1.1343256e-09  2.6109412e-16  0              3.1903086    
   2500000   127.27922      200            200            0.0043864505  -7.9286276e-40  0              0.013159352    1.1058062e-16  0              5.3395425e-10  2.6109412e-16  0              3.1903086    
   2600000   127.27922      200            200            0.0043864505  -5.8781835e-40  0              0.013159351    8.8036413e-18  0              4.2509633e-11  2.6109412e-16  0              3.1903086    
   2700000   127.27922      200            200            0.0043864505  -1.4115525e-39  0              0.013159351    5.914972e-20   0              2.8561283e-13  2.6109412e-16  0              3.1903086    
   2800000   127.27922      200            200            0.0043864505  -6.8830499e-39  0              0.013159352    2.357429e-19   0              1.1383181e-12  2.6109412e-16  0              3.1903086    
   2900000   127.27922      200            200            0.0043864505   3.5900333e-39  0              0.013159352    1.3374847e-19  0              6.4582347e-13  2.6109412e-16  0              3.1903086    
   3000000   127.27922      200            200            0.0043864505  -6.2936161e-39  0              0.013159352    1.5489956e-19  0              7.4795452e-13  2.6109412e-16  0              3.1903086    
Loop time of 70.2732 on 4 procs for 3000000 steps with 51 atoms

Performance: 36884591.994 ns/day, 0.000 hours/ns, 42690.500 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24988    | 1.2644     | 4.1361     | 147.5 |  1.80
Neigh   | 0.060498   | 0.061592   | 0.064009   |   0.6 |  0.09
Comm    | 30.542     | 38.204     | 44.576     |  93.5 | 54.37
Output  | 0.060651   | 0.060973   | 0.061475   |   0.1 |  0.09
Modify  | 15.069     | 21.776     | 30.161     | 143.8 | 30.99
Other   |            | 8.906      |            |       | 12.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.4                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.2749578074541
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.5
  ghost atom cutoff = 3.5
  binsize = 1.75, bins = 73 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.83 | 17.3 | 18.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037483587  -2.4208722e-39  0              0.011245076    14267.854      0              6.8894362e+10  2.6109412e-16  0              3.3257416    
    200000   127.27922      200            200           -0.00044010939  4.3917322e-41  0             -0.0013203282   3682.2993      0              1.7780506e+10  2.6109412e-16  0              3.2110853    
    300000   127.27922      200            200            0.016875099    0.0032512185   0              0.047374077    844.5664       0              4.0781089e+09  2.6109412e-16  0              3.1906479    
    400000   127.27922      200            200           -2.9634267e-05  1.2705927e-36  0             -8.8902801e-05  3.925711       0              18955854       2.6109412e-16  0              3.2056436    
    500000   127.27922      200            200            0.0021269387   5.3420153e-37  0              0.006380816    15.998079      0              77249000       2.6109412e-16  0              3.1971669    
    600000   127.27922      200            200            0.0038033425  -8.2713527e-37  0              0.011410027    2.9671802      0              14327451       2.6109412e-16  0              3.1957607    
    700000   127.27922      200            200            0.0045956521  -1.1049044e-36  0              0.013786956    0.42293804     0              2042216.4      2.6109412e-16  0              3.1951747    
    800000   127.27922      200            200            0.0045819845   1.0027271e-37  0              0.013745954    0.0064281419   0              31039.197      2.6109412e-16  0              3.1951782    
    900000   127.27922      200            200            0.0044543169   3.6948368e-37  0              0.013362951    0.0025510608   0              12318.16       2.6109412e-16  0              3.1952669    
   1000000   127.27922      200            200            0.0043964912   3.5874931e-40  0              0.013189474    0.0011911131   0              5751.4589      2.6109412e-16  0              3.1953081    
   1100000   127.27922      200            200            0.0043865736   8.8829293e-39  0              0.013159721    8.7742275e-05  0              423.67604      2.6109412e-16  0              3.1953154    
   1200000   127.27922      200            200            0.0043897291   1.2607019e-38  0              0.013169187    7.5298497e-08  0              0.36358949     2.6109412e-16  0              3.1953133    
   1300000   127.27922      200            200            0.0043925534  -2.1190183e-38  0              0.01317766     1.9503283e-06  0              9.4174373      2.6109412e-16  0              3.1953113    
   1400000   127.27922      200            200            0.0043934517  -4.1236585e-39  0              0.013180355    3.8204314e-07  0              1.8447496      2.6109412e-16  0              3.1953107    
   1500000   127.27922      200            200            0.004393491   -1.738276e-39   0              0.013180473    1.0201593e-08  0              0.049259843    2.6109412e-16  0              3.1953106    
   1600000   127.27922      200            200            0.0043933878   3.3165405e-39  0              0.013180163    1.3144831e-09  0              0.0063471686   2.6109412e-16  0              3.1953107    
   1700000   127.27922      200            200            0.0043933341  -6.4719002e-40  0              0.013180002    9.411546e-10   0              0.0045444987   2.6109412e-16  0              3.1953107    
   1800000   127.27922      200            200            0.0043933228   2.1129466e-39  0              0.013179969    9.0005321e-11  0              0.00043460348  2.6109412e-16  0              3.1953107    
   1900000   127.27922      200            200            0.0043933248  -4.7102352e-39  0              0.013179975    8.9733605e-14  0              4.3329146e-07  2.6109412e-16  0              3.1953107    
   2000000   127.27922      200            200            0.0043933273   5.5274576e-39  0              0.013179982    1.3070662e-12  0              6.3113551e-06  2.6109412e-16  0              3.1953107    
   2100000   127.27922      200            200            0.0043933282  -4.6911519e-39  0              0.013179985    3.3279519e-13  0              1.6069489e-06  2.6109412e-16  0              3.1953107    
   2200000   127.27922      200            200            0.0043933283  -1.4627796e-39  0              0.013179985    1.3450446e-14  0              6.4947389e-08  2.6109412e-16  0              3.1953107    
   2300000   127.27922      200            200            0.0043933282   3.1157499e-39  0              0.013179985    5.6011334e-16  0              2.7045869e-09  2.6109412e-16  0              3.1953107    
   2400000   127.27922      200            200            0.0043933281  -6.3035943e-40  0              0.013179984    7.1847708e-16  0              3.4692687e-09  2.6109412e-16  0              3.1953107    
   2500000   127.27922      200            200            0.0043933281   6.6775792e-39  0              0.013179984    8.5543306e-17  0              4.1305801e-10  2.6109412e-16  0              3.1953107    
   2600000   127.27922      200            200            0.0043933281   4.471712e-39   0              0.013179984    4.4627321e-19  0              2.1548936e-12  2.6109412e-16  0              3.1953107    
   2700000   127.27922      200            200            0.0043933281   4.869049e-39   0              0.013179984    1.2392127e-18  0              5.9837148e-12  2.6109412e-16  0              3.1953107    
   2800000   127.27922      200            200            0.0043933281   7.8821786e-39  0              0.013179984    2.2227545e-19  0              1.0732886e-12  2.6109412e-16  0              3.1953107    
   2900000   127.27922      200            200            0.0043933281  -5.8437976e-39  0              0.013179984    1.2445472e-19  0              6.0094729e-13  2.6109412e-16  0              3.1953107    
   3000000   127.27922      200            200            0.0043933281  -6.0314353e-39  0              0.013179984    1.3243387e-19  0              6.3947576e-13  2.6109412e-16  0              3.1953107    
Loop time of 70.0383 on 4 procs for 3000000 steps with 51 atoms

Performance: 37008344.994 ns/day, 0.000 hours/ns, 42833.733 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25185    | 1.2262     | 3.9702     | 143.1 |  1.75
Neigh   | 0.063737   | 0.065562   | 0.068655   |   0.8 |  0.09
Comm    | 30.354     | 38.098     | 44.467     |  94.2 | 54.40
Output  | 0.060662   | 0.061096   | 0.061932   |   0.2 |  0.09
Modify  | 14.978     | 21.681     | 30.12      | 144.1 | 30.96
Other   |            | 8.907      |            |       | 12.72

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.41                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.6756188368544
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.51
  ghost atom cutoff = 3.51
  binsize = 1.755, bins = 73 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.83 | 17.3 | 18.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037582044  -6.0517327e-40  0              0.011274613    14318.57       0              6.9139251e+10  2.6109412e-16  0              3.3255052    
    200000   127.27922      200            200           -0.00044302616  1.4531849e-38  0             -0.0013290785   3588.0659      0              1.7325486e+10  2.6109412e-16  0              3.2197397    
    300000   127.27922      200            200            0.027163274    0.0083758125   0              0.07311401     699.67694      0              3.3784895e+09  2.6109412e-16  0              3.1936944    
    400000   127.27922      200            200           -1.7396123e-05  4.9937465e-36  0             -5.218837e-05   1.3233839      0              6390147.2      2.6109412e-16  0              3.2107708    
    500000   127.27922      200            200            0.0026063746  -4.4608729e-36  0              0.0078191237   20.045711      0              96793564       2.6109412e-16  0              3.201755     
    600000   127.27922      200            200            0.0040776594  -6.2437305e-37  0              0.012232978    3.4027176      0              16430506       2.6109412e-16  0              3.2005658    
    700000   127.27922      200            200            0.004710267    2.1020758e-36  0              0.014130801    0.33107022     0              1598619.6      2.6109412e-16  0              3.2001011    
    800000   127.27922      200            200            0.0045979419   5.731832e-37   0              0.013793826    0.00029994788  0              1448.3409      2.6109412e-16  0              3.2001735    
    900000   127.27922      200            200            0.0044483869  -2.4511441e-37  0              0.013345161    0.0049069537   0              23693.923      2.6109412e-16  0              3.200278     
   1000000   127.27922      200            200            0.0043955369   2.9513806e-38  0              0.013186611    0.0011749002   0              5673.1728      2.6109412e-16  0              3.2003158    
   1100000   127.27922      200            200            0.0043915633  -5.486919e-40   0              0.01317469     3.7947548e-05  0              183.23513      2.6109412e-16  0              3.200319     
   1200000   127.27922      200            200            0.004396895    3.09597e-38    0              0.013190685    3.3489952e-06  0              16.171099      2.6109412e-16  0              3.2003153    
   1300000   127.27922      200            200            0.004399866   -6.4789708e-40  0              0.013199598    2.7826043e-06  0              13.4362        2.6109412e-16  0              3.2003131    
   1400000   127.27922      200            200            0.0044004989   4.4926771e-39  0              0.013201497    2.6294523e-07  0              1.2696684      2.6109412e-16  0              3.2003127    
   1500000   127.27922      200            200            0.0044003854  -3.7626428e-40  0              0.013201156    6.4322335e-11  0              0.00031058954  2.6109412e-16  0              3.2003128    
   1600000   127.27922      200            200            0.0044002479  -2.0512269e-39  0              0.013200744    4.3211251e-09  0              0.020865166    2.6109412e-16  0              3.2003129    
   1700000   127.27922      200            200            0.0044002007   1.7718248e-39  0              0.013200602    9.6421191e-10  0              0.0046558343   2.6109412e-16  0              3.2003129    
   1800000   127.27922      200            200            0.0044001977   5.6510276e-39  0              0.013200593    2.7666656e-11  0              0.00013359238  2.6109412e-16  0              3.2003129    
   1900000   127.27922      200            200            0.0044002028  -2.4784356e-39  0              0.013200608    3.2553386e-12  0              1.5718865e-05  2.6109412e-16  0              3.2003129    
   2000000   127.27922      200            200            0.0044002055  -5.6558183e-39  0              0.013200616    2.3543293e-12  0              1.1368214e-05  2.6109412e-16  0              3.2003129    
   2100000   127.27922      200            200            0.004400206   -6.2962431e-39  0              0.013200618    2.0728093e-13  0              1.0008854e-06  2.6109412e-16  0              3.2003129    
   2200000   127.27922      200            200            0.0044002059  -4.3922084e-39  0              0.013200618    1.0071817e-20  0              4.8633201e-14  2.6109412e-16  0              3.2003129    
   2300000   127.27922      200            200            0.0044002058  -1.1461812e-39  0              0.013200617    3.7916196e-15  0              1.8308374e-08  2.6109412e-16  0              3.2003129    
   2400000   127.27922      200            200            0.0044002057   4.6612182e-39  0              0.013200617    7.8993399e-16  0              3.8143085e-09  2.6109412e-16  0              3.2003129    
   2500000   127.27922      200            200            0.0044002057  -2.6970716e-39  0              0.013200617    1.909405e-17   0              9.2198336e-11  2.6109412e-16  0              3.2003129    
   2600000   127.27922      200            200            0.0044002057   4.6313712e-39  0              0.013200617    3.0961881e-18  0              1.4950384e-11  2.6109412e-16  0              3.2003129    
   2700000   127.27922      200            200            0.0044002057   2.4471663e-39  0              0.013200617    2.0413134e-18  0              9.8567718e-12  2.6109412e-16  0              3.2003129    
   2800000   127.27922      200            200            0.0044002057  -3.1852419e-39  0              0.013200617    5.6886525e-20  0              2.7468467e-13  2.6109412e-16  0              3.2003129    
   2900000   127.27922      200            200            0.0044002057  -1.1042674e-38  0              0.013200617    1.2475397e-21  0              6.0239226e-15  2.6109412e-16  0              3.2003129    
   3000000   127.27922      200            200            0.0044002057   3.0988416e-39  0              0.013200617    5.9838606e-21  0              2.8893921e-14  2.6109412e-16  0              3.2003129    
Loop time of 70.242 on 4 procs for 3000000 steps with 51 atoms

Performance: 36901024.903 ns/day, 0.000 hours/ns, 42709.520 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2512     | 1.2269     | 4.0052     | 144.9 |  1.75
Neigh   | 0.066663   | 0.067916   | 0.069296   |   0.4 |  0.10
Comm    | 30.584     | 38.298     | 44.647     |  93.6 | 54.52
Output  | 0.059451   | 0.059822   | 0.060516   |   0.2 |  0.09
Modify  | 15.023     | 21.71      | 30.157     | 144.3 | 30.91
Other   |            | 8.879      |            |       | 12.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.42                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.0786366890634
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.52
  ghost atom cutoff = 3.52
  binsize = 1.76, bins = 73 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.83 | 17.3 | 18.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037680503   1.4527418e-38  0              0.011304151    14369.354      0              6.938447e+10   2.6109412e-16  0              3.3252566    
    200000   127.27922      200            200           -0.00044570661  7.7543342e-38  0             -0.0013371198   3495.1408      0              1.6876784e+10  2.6109412e-16  0              3.2283505    
    300000   127.27922      200            200            0.03794722     0.014053453    0              0.099788208    499.36439      0              2.4112519e+09  2.6109412e-16  0              3.1969745    
    400000   127.27922      200            200           -4.9583922e-06  4.9907878e-36  0             -1.4875177e-05  0.10295104     0              497113.73      2.6109412e-16  0              3.2158326    
    500000   127.27922      200            200            0.0031684081  -1.5266856e-36  0              0.0095052244   23.376269      0              1.1287564e+08  2.6109412e-16  0              3.2063016    
    600000   127.27922      200            200            0.0043714772   4.3991037e-37  0              0.013114432    3.5853655      0              17312447       2.6109412e-16  0              3.2053611    
    700000   127.27922      200            200            0.0048097312  -4.2204606e-37  0              0.014429194    0.22179469     0              1070967.2      2.6109412e-16  0              3.2050385    
    800000   127.27922      200            200            0.0046015935   4.0902048e-37  0              0.01380478     0.0021571113   0              10415.919      2.6109412e-16  0              3.2051775    
    900000   127.27922      200            200            0.0044389202  -3.1342029e-37  0              0.013316761    0.007121033    0              34384.92       2.6109412e-16  0              3.2052916    
   1000000   127.27922      200            200            0.0043949878   1.1598167e-37  0              0.013184964    0.00096664266  0              4667.5715      2.6109412e-16  0              3.2053233    
   1100000   127.27922      200            200            0.004397419    4.3957071e-40  0              0.013192257    5.5160205e-06  0              26.634889      2.6109412e-16  0              3.2053219    
   1200000   127.27922      200            200            0.0044044423   2.1972909e-38  0              0.013213327    1.004396e-05   0              48.498689      2.6109412e-16  0              3.2053169    
   1300000   127.27922      200            200            0.0044072231   3.3493161e-39  0              0.013221669    2.958392e-06   0              14.285016      2.6109412e-16  0              3.2053149    
   1400000   127.27922      200            200            0.0044075026   1.9920274e-39  0              0.013222508    1.102125e-07   0              0.5321767      2.6109412e-16  0              3.2053147    
   1500000   127.27922      200            200            0.0044072499   1.9902933e-41  0              0.01322175     7.3785098e-09  0              0.035628183    2.6109412e-16  0              3.2053149    
   1600000   127.27922      200            200            0.0044071003   6.8982321e-39  0              0.013221301    6.8763645e-09  0              0.033203503    2.6109412e-16  0              3.205315     
   1700000   127.27922      200            200            0.0044070683   2.9120626e-39  0              0.013221205    6.2796348e-10  0              0.0030322109   2.6109412e-16  0              3.205315     
   1800000   127.27922      200            200            0.0044070744   5.0465193e-39  0              0.013221223    1.8525466e-14  0              8.9452844e-08  2.6109412e-16  0              3.205315     
   1900000   127.27922      200            200            0.0044070814  -8.4508391e-39  0              0.013221244    1.191185e-11   0              5.7518063e-05  2.6109412e-16  0              3.205315     
   2000000   127.27922      200            200            0.0044070837  -9.120965e-39   0              0.013221251    2.2751082e-12  0              1.0985683e-05  2.6109412e-16  0              3.205315     
   2100000   127.27922      200            200            0.0044070837  -9.6689273e-39  0              0.013221251    4.0099917e-14  0              1.9362815e-07  2.6109412e-16  0              3.205315     
   2200000   127.27922      200            200            0.0044070835   4.4387162e-39  0              0.01322125     1.3348312e-14  0              6.4454223e-08  2.6109412e-16  0              3.205315     
   2300000   127.27922      200            200            0.0044070833   6.5789757e-39  0              0.01322125     6.1157573e-15  0              2.9530803e-08  2.6109412e-16  0              3.205315     
   2400000   127.27922      200            200            0.0044070833   3.9287385e-40  0              0.01322125     3.6274711e-16  0              1.751576e-09   2.6109412e-16  0              3.205315     
   2500000   127.27922      200            200            0.0044070833  -2.0041306e-39  0              0.01322125     4.4552133e-18  0              2.1512631e-11  2.6109412e-16  0              3.205315     
   2600000   127.27922      200            200            0.0044070833   4.240946e-39   0              0.01322125     1.2050763e-17  0              5.8188821e-11  2.6109412e-16  0              3.205315     
   2700000   127.27922      200            200            0.0044070833  -1.4754931e-38  0              0.01322125     1.2632498e-18  0              6.0997814e-12  2.6109412e-16  0              3.205315     
   2800000   127.27922      200            200            0.0044070833  -4.5058436e-39  0              0.01322125     9.2919267e-22  0              4.4867389e-15  2.6109412e-16  0              3.205315     
   2900000   127.27922      200            200            0.0044070833   4.7383949e-39  0              0.01322125     2.3084905e-20  0              1.1146874e-13  2.6109412e-16  0              3.205315     
   3000000   127.27922      200            200            0.0044070833   8.1498587e-39  0              0.01322125     4.5614857e-20  0              2.2025782e-13  2.6109412e-16  0              3.205315     
Loop time of 69.7058 on 4 procs for 3000000 steps with 51 atoms

Performance: 37184833.691 ns/day, 0.000 hours/ns, 43038.002 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24903    | 1.2239     | 4.0067     | 145.3 |  1.76
Neigh   | 0.065343   | 0.066695   | 0.069554   |   0.7 |  0.10
Comm    | 30.219     | 37.833     | 44.13      |  93.1 | 54.28
Output  | 0.060619   | 0.060921   | 0.061384   |   0.1 |  0.09
Modify  | 14.956     | 21.602     | 29.924     | 142.9 | 30.99
Other   |            | 8.919      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.43                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.4840182755848
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.53
  ghost atom cutoff = 3.53
  binsize = 1.765, bins = 73 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.83 | 17.3 | 18.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037778964   1.9248394e-45  0              0.011333689    14420.207      0              6.9630019e+10  2.6109412e-16  0              3.3249959    
    200000   127.27922      200            200           -0.00044815179  1.2591844e-37  0             -0.0013444554   3403.5163      0              1.6434362e+10  2.6109412e-16  0              3.2369177    
    300000   127.27922      200            200            0.047635057    0.019049115    0              0.12385606     282.21466      0              1.3627136e+09  2.6109412e-16  0              3.2005937    
    400000   127.27922      200            200            7.6782243e-06  6.5430089e-37  0              2.3034673e-05  0.25735759     0              1242687.7      2.6109412e-16  0              3.2208292    
    500000   127.27922      200            200            0.0038040139   2.6261712e-37  0              0.011412042    25.547979      0              1.2336205e+08  2.6109412e-16  0              3.2108194    
    600000   127.27922      200            200            0.0046737173   1.1109695e-36  0              0.014021152    3.4800534      0              16803932       2.6109412e-16  0              3.210155     
    700000   127.27922      200            200            0.0048888626   4.7134847e-37  0              0.014666588    0.11716684     0              565756.76      2.6109412e-16  0              3.2099903    
    800000   127.27922      200            200            0.0045931371  -1.9546912e-37  0              0.013779411    0.011481622    0              55440.641      2.6109412e-16  0              3.21019      
    900000   127.27922      200            200            0.0044271288  -1.7003592e-37  0              0.013281386    0.0085550609   0              41309.327      2.6109412e-16  0              3.2103068    
   1000000   127.27922      200            200            0.0043954815  -5.7777552e-38  0              0.013186445    0.00063725922  0              3077.0967      2.6109412e-16  0              3.21033      
   1100000   127.27922      200            200            0.0044042412  -1.9518055e-38  0              0.013212723    2.8352083e-06  0              13.690206      2.6109412e-16  0              3.2103241    
   1200000   127.27922      200            200            0.0044122933   1.1217367e-38  0              0.01323688     1.713673e-05   0              82.747136      2.6109412e-16  0              3.2103184    
   1300000   127.27922      200            200            0.0044145617   7.9418267e-40  0              0.013243685    2.3928358e-06  0              11.554148      2.6109412e-16  0              3.2103167    
   1400000   127.27922      200            200            0.0044144441   2.5499328e-40  0              0.013243332    1.0593222e-08  0              0.051150879    2.6109412e-16  0              3.2103168    
   1500000   127.27922      200            200            0.0044140867  -3.2204e-39     0              0.01324226     2.7292629e-08  0              0.13178634     2.6109412e-16  0              3.2103171    
   1600000   127.27922      200            200            0.0044139495  -1.2677896e-39  0              0.013241848    7.1827773e-09  0              0.034683061    2.6109412e-16  0              3.2103172    
   1700000   127.27922      200            200            0.004413939    9.1942752e-39  0              0.013241817    1.953558e-10   0              0.00094330324  2.6109412e-16  0              3.2103172    
   1800000   127.27922      200            200            0.004413953    9.6575254e-40  0              0.013241859    2.9997467e-11  0              0.00014484703  2.6109412e-16  0              3.2103172    
   1900000   127.27922      200            200            0.0044139605   6.1556337e-39  0              0.013241881    1.7972403e-11  0              8.6782301e-05  2.6109412e-16  0              3.2103172    
   2000000   127.27922      200            200            0.0044139618   1.7741856e-39  0              0.013241885    1.1583412e-12  0              5.5932149e-06  2.6109412e-16  0              3.2103172    
   2100000   127.27922      200            200            0.0044139613   2.351121e-39   0              0.013241884    1.2608053e-14  0              6.0879775e-08  2.6109412e-16  0              3.2103172    
   2200000   127.27922      200            200            0.004413961    6.2974102e-40  0              0.013241883    3.7551634e-14  0              1.813234e-07   2.6109412e-16  0              3.2103172    
   2300000   127.27922      200            200            0.0044139609   7.5131932e-39  0              0.013241883    4.6040137e-15  0              2.2231134e-08  2.6109412e-16  0              3.2103172    
   2400000   127.27922      200            200            0.0044139609   4.8527557e-39  0              0.013241883    7.9210346e-18  0              3.8247841e-11  2.6109412e-16  0              3.2103172    
   2500000   127.27922      200            200            0.0044139609  -2.4997593e-39  0              0.013241883    6.2535192e-17  0              3.0196006e-10  2.6109412e-16  0              3.2103172    
   2600000   127.27922      200            200            0.0044139609   6.0448839e-39  0              0.013241883    1.4289105e-17  0              6.8996975e-11  2.6109412e-16  0              3.2103172    
   2700000   127.27922      200            200            0.0044139609   2.3464024e-40  0              0.013241883    1.1656003e-19  0              5.6282667e-13  2.6109412e-16  0              3.2103172    
   2800000   127.27922      200            200            0.0044139609   4.2917447e-39  0              0.013241883    1.3813888e-19  0              6.6702322e-13  2.6109412e-16  0              3.2103172    
   2900000   127.27922      200            200            0.0044139609  -1.1395751e-39  0              0.013241883    5.8954505e-20  0              2.8467021e-13  2.6109412e-16  0              3.2103172    
   3000000   127.27922      200            200            0.0044139609  -2.7300996e-39  0              0.013241883    6.1573144e-20  0              2.9731468e-13  2.6109412e-16  0              3.2103172    
Loop time of 69.8372 on 4 procs for 3000000 steps with 51 atoms

Performance: 37114902.921 ns/day, 0.000 hours/ns, 42957.064 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25159    | 1.2087     | 3.9104     | 141.9 |  1.73
Neigh   | 0.062816   | 0.064796   | 0.068084   |   0.8 |  0.09
Comm    | 30.339     | 37.972     | 44.259     |  93.3 | 54.37
Output  | 0.060584   | 0.06093    | 0.061536   |   0.2 |  0.09
Modify  | 14.99      | 21.633     | 29.914     | 142.8 | 30.98
Other   |            | 8.897      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.44                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.8917705079228
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.54
  ghost atom cutoff = 3.54
  binsize = 1.77, bins = 72 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.78 | 17.25 | 18.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037877425   1.1348684e-40  0              0.011363228    14471.128      0              6.98759e+10    2.6109412e-16  0              3.3247229    
    200000   127.27922      200            200           -0.00045036264 -1.5488873e-37  0             -0.0013510879   3313.1929      0              1.5998223e+10  2.6109412e-16  0              3.2454412    
    300000   127.27922      200            200            0.05495481     0.020509117    0              0.14435531     99.453793      0              4.8022677e+08  2.6109412e-16  0              3.2046496    
    400000   127.27922      200            200            2.0511169e-05  3.3498322e-37  0              6.1533506e-05  1.7797063      0              8593564.8      2.6109412e-16  0              3.2257604    
    500000   127.27922      200            200            0.0044977083   4.9011343e-37  0              0.013493125    26.220703      0              1.2661039e+08  2.6109412e-16  0              3.2153224    
    600000   127.27922      200            200            0.0049718335  -2.0746208e-36  0              0.0149155      3.0978612      0              14958463       2.6109412e-16  0              3.2149561    
    700000   127.27922      200            200            0.0049435067  -3.2511018e-36  0              0.01483052     0.03843985     0              185612.28      2.6109412e-16  0              3.2149589    
    800000   127.27922      200            200            0.0045735545   4.3187096e-37  0              0.013720663    0.025935106    0              125231.35      2.6109412e-16  0              3.2152103    
    900000   127.27922      200            200            0.0044143899  -1.3343057e-38  0              0.01324317     0.0088004689   0              42494.315      2.6109412e-16  0              3.2153228    
   1000000   127.27922      200            200            0.0043975638   3.1228625e-37  0              0.013192691    0.00029762112  0              1437.1059      2.6109412e-16  0              3.2153355    
   1100000   127.27922      200            200            0.0044120333  -2.0274316e-38  0              0.0132361      3.0625662e-05  0              147.88036      2.6109412e-16  0              3.2153256    
   1200000   127.27922      200            200            0.0044203353  -1.3874532e-38  0              0.013261006    2.1459196e-05  0              103.61878      2.6109412e-16  0              3.2153197    
   1300000   127.27922      200            200            0.0044218216  -1.4903477e-39  0              0.013265465    1.3755197e-06  0              6.6418924      2.6109412e-16  0              3.2153186    
   1400000   127.27922      200            200            0.0044213144   3.9327716e-40  0              0.013263943    1.969473e-08   0              0.095098802    2.6109412e-16  0              3.2153189    
   1500000   127.27922      200            200            0.0044209028   9.4457371e-41  0              0.013262709    4.7057933e-08  0              0.22722592     2.6109412e-16  0              3.2153192    
   1600000   127.27922      200            200            0.0044208008   6.8463789e-39  0              0.013262402    5.0416125e-09  0              0.024344142    2.6109412e-16  0              3.2153193    
   1700000   127.27922      200            200            0.0044208141   3.3449659e-39  0              0.013262442    1.0274482e-14  0              4.9611798e-08  2.6109412e-16  0              3.2153193    
   1800000   127.27922      200            200            0.0044208335  -6.8044717e-40  0              0.0132625      9.1519418e-11  0              0.00044191452  2.6109412e-16  0              3.2153193    
   1900000   127.27922      200            200            0.0044208397   1.4518293e-39  0              0.013262519    1.5860534e-11  0              7.6584841e-05  2.6109412e-16  0              3.2153193    
   2000000   127.27922      200            200            0.0044208396  -7.8053643e-39  0              0.013262519    1.2789821e-13  0              6.1757467e-07  2.6109412e-16  0              3.2153193    
   2100000   127.27922      200            200            0.0044208388  -3.0284877e-39  0              0.013262516    1.5258018e-13  0              7.3675509e-07  2.6109412e-16  0              3.2153193    
   2200000   127.27922      200            200            0.0044208384   2.4733205e-39  0              0.013262515    4.4291011e-14  0              2.1386544e-07  2.6109412e-16  0              3.2153193    
   2300000   127.27922      200            200            0.0044208384   5.6822564e-39  0              0.013262515    1.1860284e-15  0              5.7269066e-09  2.6109412e-16  0              3.2153193    
   2400000   127.27922      200            200            0.0044208384   4.1862598e-39  0              0.013262515    2.0173122e-16  0              9.7408786e-10  2.6109412e-16  0              3.2153193    
   2500000   127.27922      200            200            0.0044208385  -3.2157121e-39  0              0.013262515    1.1092917e-16  0              5.3563724e-10  2.6109412e-16  0              3.2153193    
   2600000   127.27922      200            200            0.0044208385  -4.4083528e-39  0              0.013262515    5.9422804e-18  0              2.8693145e-11  2.6109412e-16  0              3.2153193    
   2700000   127.27922      200            200            0.0044208385  -5.9143577e-40  0              0.013262515    4.0168329e-19  0              1.9395848e-12  2.6109412e-16  0              3.2153193    
   2800000   127.27922      200            200            0.0044208385   1.3088625e-38  0              0.013262515    2.7420122e-19  0              1.3240196e-12  2.6109412e-16  0              3.2153193    
   2900000   127.27922      200            200            0.0044208385  -4.5136662e-39  0              0.013262515    1.5877811e-19  0              7.6668268e-13  2.6109412e-16  0              3.2153193    
   3000000   127.27922      200            200            0.0044208385  -2.54321e-39    0              0.013262515    1.4707646e-19  0              7.1017957e-13  2.6109412e-16  0              3.2153193    
Loop time of 69.8794 on 4 procs for 3000000 steps with 51 atoms

Performance: 37092492.188 ns/day, 0.000 hours/ns, 42931.125 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25082    | 1.2313     | 4.0136     | 144.8 |  1.76
Neigh   | 0.058508   | 0.060015   | 0.062618   |   0.7 |  0.09
Comm    | 30.317     | 38.014     | 44.358     |  93.5 | 54.40
Output  | 0.061577   | 0.062048   | 0.062965   |   0.2 |  0.09
Modify  | 14.922     | 21.592     | 29.946     | 143.3 | 30.90
Other   |            | 8.921      |            |       | 12.77

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.45                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.3019002975809
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.55
  ghost atom cutoff = 3.55
  binsize = 1.775, bins = 72 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.78 | 17.25 | 18.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0037975887   2.4210584e-39  0              0.011392766    14522.118      0              7.012211e+10   2.6109412e-16  0              3.3244377    
    200000   127.27922      200            200           -0.00045234018 -9.6816125e-38  0             -0.0013570205   3224.1657      0              1.5568342e+10  2.6109412e-16  0              3.2539209    
    300000   127.27922      200            200            0.058456664    0.020733915    0              0.15463608     5.0590761      0              24428468       2.6109412e-16  0              3.209223     
    400000   127.27922      200            200            3.35389e-05    1.270498e-36   0              0.0001006167   4.6630593      0              22516244       2.6109412e-16  0              3.2306261    
    500000   127.27922      200            200            0.0052276344   1.6208553e-36  0              0.015682903    25.22235       0              1.217897e+08   2.6109412e-16  0              3.2198264    
    600000   127.27922      200            200            0.0052524448   8.3856009e-36  0              0.015757334    2.4969         0              12056637       2.6109412e-16  0              3.2197728    
    700000   127.27922      200            200            0.0049708548  -1.4121532e-36  0              0.014912564    0.001590263    0              7678.8109      2.6109412e-16  0              3.2199462    
    800000   127.27922      200            200            0.0045445384   9.9097927e-37  0              0.013633615    0.041947772    0              202550.78      2.6109412e-16  0              3.2202372    
    900000   127.27922      200            200            0.0044021404  -7.7585796e-38  0              0.013206421    0.0077930038   0              37629.627      2.6109412e-16  0              3.2203385    
   1000000   127.27922      200            200            0.0044016422  -1.720885e-37   0              0.013204926    6.0983711e-05  0              294.46851      2.6109412e-16  0              3.2203397    
   1100000   127.27922      200            200            0.0044207027  -6.0089575e-38  0              0.013262108    7.7796335e-05  0              375.65066      2.6109412e-16  0              3.2203264    
   1200000   127.27922      200            200            0.0044284348   2.7863262e-40  0              0.013285304    2.1105595e-05  0              101.91136      2.6109412e-16  0              3.2203209    
   1300000   127.27922      200            200            0.0044289534  -1.2802211e-38  0              0.01328686     4.1964444e-07  0              2.0263128      2.6109412e-16  0              3.2203205    
   1400000   127.27922      200            200            0.0044281147   2.7745008e-40  0              0.013284344    1.3105323e-07  0              0.63280917     2.6109412e-16  0              3.2203211    
   1500000   127.27922      200            200            0.0044277084  -7.4354496e-39  0              0.013283125    5.4184894e-08  0              0.26163946     2.6109412e-16  0              3.2203214    
   1600000   127.27922      200            200            0.004427659    3.49338e-39    0              0.013282977    1.9645271e-09  0              0.0094859981   2.6109412e-16  0              3.2203214    
   1700000   127.27922      200            200            0.0044276942   6.6094181e-39  0              0.013283083    1.8858912e-10  0              0.00091062935  2.6109412e-16  0              3.2203214    
   1800000   127.27922      200            200            0.004427715    7.416934e-40   0              0.013283145    1.323177e-10   0              0.00063891482  2.6109412e-16  0              3.2203214    
   1900000   127.27922      200            200            0.0044277185   2.8464797e-39  0              0.013283156    7.5775123e-12  0              3.6589095e-05  2.6109412e-16  0              3.2203214    
   2000000   127.27922      200            200            0.0044277172  -1.0678225e-38  0              0.013283151    2.0534103e-13  0              9.9151833e-07  2.6109412e-16  0              3.2203214    
   2100000   127.27922      200            200            0.0044277161  -8.3559325e-39  0              0.013283148    3.0717127e-13  0              1.4832202e-06  2.6109412e-16  0              3.2203214    
   2200000   127.27922      200            200            0.0044277159   3.1621747e-39  0              0.013283148    2.5873487e-14  0              1.2493381e-07  2.6109412e-16  0              3.2203214    
   2300000   127.27922      200            200            0.0044277159  -5.7731277e-39  0              0.013283148    1.1049879e-16  0              5.335591e-10   2.6109412e-16  0              3.2203214    
   2400000   127.27922      200            200            0.004427716    6.0047977e-39  0              0.013283148    6.7606127e-16  0              3.2644579e-09  2.6109412e-16  0              3.2203214    
   2500000   127.27922      200            200            0.004427716   -9.9157384e-39  0              0.013283148    8.1807403e-17  0              3.9501867e-10  2.6109412e-16  0              3.2203214    
   2600000   127.27922      200            200            0.004427716   -7.5250449e-39  0              0.013283148    3.3547838e-21  0              1.619905e-14   2.6109412e-16  0              3.2203214    
   2700000   127.27922      200            200            0.004427716   -3.759937e-39   0              0.013283148    1.7271953e-18  0              8.3400082e-12  2.6109412e-16  0              3.2203214    
   2800000   127.27922      200            200            0.004427716   -4.6617945e-39  0              0.013283148    9.5645306e-20  0              4.6183695e-13  2.6109412e-16  0              3.2203214    
   2900000   127.27922      200            200            0.004427716    4.3076543e-39  0              0.013283148    6.667001e-20   0              3.2192562e-13  2.6109412e-16  0              3.2203214    
   3000000   127.27922      200            200            0.004427716    1.6131357e-40  0              0.013283148    8.0267036e-20  0              3.8758079e-13  2.6109412e-16  0              3.2203214    
Loop time of 69.6848 on 4 procs for 3000000 steps with 51 atoms

Performance: 37196056.096 ns/day, 0.000 hours/ns, 43050.991 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21779    | 1.2064     | 3.9605     | 144.8 |  1.73
Neigh   | 0.057253   | 0.05891    | 0.061672   |   0.7 |  0.08
Comm    | 30.407     | 37.941     | 44.239     |  92.5 | 54.45
Output  | 0.05834    | 0.058735   | 0.059512   |   0.2 |  0.08
Modify  | 14.924     | 21.531     | 29.71      | 141.6 | 30.90
Other   |            | 8.889      |            |       | 12.76

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.46                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.7144145560632
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.56
  ghost atom cutoff = 3.56
  binsize = 1.78, bins = 72 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.78 | 17.25 | 18.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038074348  -3.631431e-39   0              0.011422305    14573.175      0              7.0368649e+10  2.6109412e-16  0              3.3241404    
    200000   127.27922      200            200           -0.00045408539 -2.4207089e-38  0             -0.0013622562   3136.4325      0              1.514471e+10   2.6109412e-16  0              3.2623568    
    300000   127.27922      200            200            0.057437982    0.020679169    0              0.15163478     32.358149      0              1.5624592e+08  2.6109412e-16  0              3.2143561    
    400000   127.27922      200            200            4.6759488e-05  3.156998e-38   0              0.00014027846  8.90044        0              42977040       2.6109412e-16  0              3.2354264    
    500000   127.27922      200            200            0.0059661737   3.6494446e-36  0              0.017898521    22.599859      0              1.0912663e+08  2.6109412e-16  0              3.2243478    
    600000   127.27922      200            200            0.005502092   -3.213984e-37   0              0.016506276    1.774714       0              8569458.9      2.6109412e-16  0              3.224613     
    700000   127.27922      200            200            0.0049696543  -7.9630084e-37  0              0.014908963    0.013934258    0              67283.545      2.6109412e-16  0              3.2249529    
    800000   127.27922      200            200            0.0045083716  -9.1140094e-41  0              0.013525115    0.055603689    0              268490.32      2.6109412e-16  0              3.2252692    
    900000   127.27922      200            200            0.0043917719  -3.2229059e-37  0              0.013175316    0.0058269404   0              28136.21       2.6109412e-16  0              3.2253528    
   1000000   127.27922      200            200            0.0044079525  -5.7695428e-38  0              0.013223858    5.1489248e-06  0              24.862315      2.6109412e-16  0              3.2253423    
   1100000   127.27922      200            200            0.0044300697  -7.6928303e-38  0              0.013290209    0.00012586933  0              607.77796      2.6109412e-16  0              3.2253268    
   1200000   127.27922      200            200            0.004436452    3.5760349e-39  0              0.013309356    1.6259112e-05  0              78.509432      2.6109412e-16  0              3.2253222    
   1300000   127.27922      200            200            0.0044359244  -1.5019367e-38  0              0.013307773    1.670913e-09   0              0.008068241    2.6109412e-16  0              3.2253225    
   1400000   127.27922      200            200            0.0044348566   4.5881553e-40  0              0.01330457     2.8072407e-07  0              1.3555161      2.6109412e-16  0              3.2253233    
   1500000   127.27922      200            200            0.0044345152   2.9464631e-39  0              0.013303546    4.4278525e-08  0              0.21380515     2.6109412e-16  0              3.2253235    
   1600000   127.27922      200            200            0.0044345276  -6.2132708e-39  0              0.013303583    9.3618812e-11  0              0.00045205174  2.6109412e-16  0              3.2253235    
   1700000   127.27922      200            200            0.0044345786  -3.8014716e-39  0              0.013303736    6.1176569e-10  0              0.0029539976   2.6109412e-16  0              3.2253235    
   1800000   127.27922      200            200            0.0044345967   7.188337e-39   0              0.01330379     1.182514e-10   0              0.00057099368  2.6109412e-16  0              3.2253235    
   1900000   127.27922      200            200            0.0044345968   7.2274876e-40  0              0.01330379     7.3647791e-13  0              3.5561883e-06  2.6109412e-16  0              3.2253235    
   2000000   127.27922      200            200            0.0044345944  -3.2238228e-39  0              0.013303783    1.2988588e-12  0              6.2717244e-06  2.6109412e-16  0              3.2253235    
   2100000   127.27922      200            200            0.0044345934  -6.4629201e-39  0              0.01330378     3.1013274e-13  0              1.49752e-06    2.6109412e-16  0              3.2253235    
   2200000   127.27922      200            200            0.0044345934   7.3542179e-39  0              0.01330378     3.7310199e-15  0              1.801576e-08   2.6109412e-16  0              3.2253235    
   2300000   127.27922      200            200            0.0044345935   1.9199838e-39  0              0.01330378     2.6651643e-15  0              1.2869125e-08  2.6109412e-16  0              3.2253235    
   2400000   127.27922      200            200            0.0044345935  -2.1784718e-39  0              0.013303781    7.9958081e-16  0              3.8608896e-09  2.6109412e-16  0              3.2253235    
   2500000   127.27922      200            200            0.0044345935   2.3305275e-39  0              0.013303781    1.4612396e-17  0              7.055803e-11   2.6109412e-16  0              3.2253235    
   2600000   127.27922      200            200            0.0044345935  -1.3596445e-38  0              0.013303781    5.5438074e-18  0              2.6769062e-11  2.6109412e-16  0              3.2253235    
   2700000   127.27922      200            200            0.0044345935  -3.9497512e-39  0              0.013303781    1.754566e-18   0              8.4721712e-12  2.6109412e-16  0              3.2253235    
   2800000   127.27922      200            200            0.0044345935  -3.8240969e-39  0              0.013303781    1.3679233e-24  0              6.605212e-18   2.6109412e-16  0              3.2253235    
   2900000   127.27922      200            200            0.0044345935   4.9495226e-39  0              0.013303781    2.1074237e-21  0              1.0175995e-14  2.6109412e-16  0              3.2253235    
   3000000   127.27922      200            200            0.0044345935  -9.0905518e-39  0              0.013303781    1.1030286e-22  0              5.3261305e-16  2.6109412e-16  0              3.2253235    
Loop time of 70.2844 on 4 procs for 3000000 steps with 51 atoms

Performance: 36878746.899 ns/day, 0.000 hours/ns, 42683.735 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22072    | 1.2327     | 4.0345     | 145.8 |  1.75
Neigh   | 0.062569   | 0.064543   | 0.067697   |   0.8 |  0.09
Comm    | 30.496     | 38.228     | 44.652     |  94.1 | 54.39
Output  | 0.057501   | 0.057801   | 0.058234   |   0.1 |  0.08
Modify  | 15.042     | 21.756     | 30.183     | 144.0 | 30.95
Other   |            | 8.946      |            |       | 12.73

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.47                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.1293201948733
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.57
  ghost atom cutoff = 3.57
  binsize = 1.785, bins = 72 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.78 | 17.25 | 18.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038172809  -1.634195e-38   0              0.011451843    14624.302      0              7.0615518e+10  2.6109412e-16  0              3.3238307    
    200000   127.27922      200            200           -0.00045559927 -9.681932e-39   0             -0.0013667978   3049.9882      0              1.4727301e+10  2.6109412e-16  0              3.2707487    
    300000   127.27922      200            200            0.052806653    0.022400881    0              0.13601908     171.34692      0              8.2737298e+08  2.6109412e-16  0              3.2200393    
    400000   127.27922      200            200            6.0171713e-05 -2.4489203e-36  0              0.00018051514  14.485153      0              69943618       2.6109412e-16  0              3.2401611    
    500000   127.27922      200            200            0.0066813556  -2.0354898e-37  0              0.020044067    18.641025      0              90010840       2.6109412e-16  0              3.2289032    
    600000   127.27922      200            200            0.0057081555  -1.6090427e-36  0              0.017124466    1.0527085      0              5083152.4      2.6109412e-16  0              3.2294837    
    700000   127.27922      200            200            0.0049403098   1.6926317e-36  0              0.014820929    0.072578372    0              350454.99      2.6109412e-16  0              3.2299787    
    800000   127.27922      200            200            0.0044677639   2.5855384e-39  0              0.013403292    0.0635991      0              307097.29      2.6109412e-16  0              3.2303044    
    900000   127.27922      200            200            0.0043845305   1.8732757e-37  0              0.013153591    0.0034669425   0              16740.625      2.6109412e-16  0              3.230365     
   1000000   127.27922      200            200            0.0044165405  -1.8766519e-38  0              0.013249621    0.00014690124  0              709.33351      2.6109412e-16  0              3.2303432    
   1100000   127.27922      200            200            0.0044398863   4.3090867e-38  0              0.013319659    0.00015619619  0              754.21549      2.6109412e-16  0              3.2303268    
   1200000   127.27922      200            200            0.0044442573  -8.6702437e-39  0              0.013332772    9.084051e-06   0              43.863631      2.6109412e-16  0              3.2303236    
   1300000   127.27922      200            200            0.0044427229  -3.7654234e-39  0              0.013328169    3.2368916e-07  0              1.5629791      2.6109412e-16  0              3.2303247    
   1400000   127.27922      200            200            0.0044415602  -3.4793557e-40  0              0.013324681    3.8405111e-07  0              1.8544454      2.6109412e-16  0              3.2303255    
   1500000   127.27922      200            200            0.0044413349  -6.9677116e-39  0              0.013324005    2.3657798e-08  0              0.11423504     2.6109412e-16  0              3.2303257    
   1600000   127.27922      200            200            0.0044414083   4.4466243e-39  0              0.013324225    7.0644692e-10  0              0.0034111793   2.6109412e-16  0              3.2303256    
   1700000   127.27922      200            200            0.0044414661  -9.930493e-40   0              0.013324398    9.4330172e-10  0              0.0045548664   2.6109412e-16  0              3.2303256    
   1800000   127.27922      200            200            0.0044414777   3.9718335e-39  0              0.013324433    6.1492466e-11  0              0.00029692511  2.6109412e-16  0              3.2303256    
   1900000   127.27922      200            200            0.0044414742   1.3877271e-38  0              0.013324423    1.5272391e-12  0              7.3744909e-06  2.6109412e-16  0              3.2303256    
   2000000   127.27922      200            200            0.0044414713   3.3011875e-39  0              0.013324414    2.31473e-12    0              1.1177003e-05  2.6109412e-16  0              3.2303256    
   2100000   127.27922      200            200            0.0044414707  -4.7505543e-39  0              0.013324412    1.5950759e-13  0              7.7020504e-07  2.6109412e-16  0              3.2303256    
   2200000   127.27922      200            200            0.0044414709   4.2559316e-39  0              0.013324413    3.2714132e-15  0              1.5796483e-08  2.6109412e-16  0              3.2303256    
   2300000   127.27922      200            200            0.004441471   -1.1447655e-39  0              0.013324413    5.6747359e-15  0              2.7401269e-08  2.6109412e-16  0              3.2303256    
   2400000   127.27922      200            200            0.0044414711   4.476628e-39   0              0.013324413    4.1001778e-16  0              1.9798291e-09  2.6109412e-16  0              3.2303256    
   2500000   127.27922      200            200            0.0044414711   2.970906e-39   0              0.013324413    8.1391965e-18  0              3.9301267e-11  2.6109412e-16  0              3.2303256    
   2600000   127.27922      200            200            0.0044414711   3.9993135e-40  0              0.013324413    1.4002181e-17  0              6.7611521e-11  2.6109412e-16  0              3.2303256    
   2700000   127.27922      200            200            0.0044414711  -3.2263711e-39  0              0.013324413    5.6672164e-19  0              2.736496e-12   2.6109412e-16  0              3.2303256    
   2800000   127.27922      200            200            0.0044414711   5.762689e-40   0              0.013324413    5.9868555e-20  0              2.8908383e-13  2.6109412e-16  0              3.2303256    
   2900000   127.27922      200            200            0.0044414711   1.3029707e-38  0              0.013324413    1.7091202e-20  0              8.2527297e-14  2.6109412e-16  0              3.2303256    
   3000000   127.27922      200            200            0.0044414711  -5.8012076e-39  0              0.013324413    1.1371242e-20  0              5.4907658e-14  2.6109412e-16  0              3.2303256    
Loop time of 69.6273 on 4 procs for 3000000 steps with 51 atoms

Performance: 37226782.885 ns/day, 0.000 hours/ns, 43086.554 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21736    | 1.2306     | 4.0544     | 147.0 |  1.77
Neigh   | 0.057078   | 0.058515   | 0.061157   |   0.7 |  0.08
Comm    | 30.165     | 37.846     | 44.216     |  93.4 | 54.36
Output  | 0.061522   | 0.061899   | 0.062621   |   0.2 |  0.09
Modify  | 14.937     | 21.561     | 29.92      | 143.0 | 30.97
Other   |            | 8.869      |            |       | 12.74

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.48                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.5466241255151
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.58
  ghost atom cutoff = 3.58
  binsize = 1.79, bins = 72 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.78 | 17.25 | 18.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038271269   3.0263314e-39  0              0.011481381    14675.495      0              7.0862716e+10  2.6109412e-16  0              3.3235088    
    200000   127.27922      200            200           -0.00045688281 -4.840629e-38   0             -0.0013706484   2964.8298      0              1.4316102e+10  2.6109412e-16  0              3.2790967    
    300000   127.27922      200            200            0.04529698     0.02309581     0              0.11279513     374.60427      0              1.80883e+09    2.6109412e-16  0              3.2262131    
    400000   127.27922      200            200            7.3773828e-05 -1.8293615e-36  0              0.00022132148  21.410422      0              1.0338326e+08  2.6109412e-16  0              3.2448303    
    500000   127.27922      200            200            0.0073388029   9.5513301e-36  0              0.022016409    13.856374      0              66907471       2.6109412e-16  0              3.2335089    
    600000   127.27922      200            200            0.0058597768   4.5774446e-36  0              0.017579331    0.45509643     0              2197497.8      2.6109412e-16  0              3.2343909    
    700000   127.27922      200            200            0.0048848575  -1.5167787e-37  0              0.014654573    0.16506597     0              797044.48      2.6109412e-16  0              3.2350223    
    800000   127.27922      200            200            0.0044256704   6.3732386e-38  0              0.013277011    0.064033988    0              309197.21      2.6109412e-16  0              3.2353408    
    900000   127.27922      200            200            0.0043814303   5.0202934e-37  0              0.013144291    0.0013845852   0              6685.6662      2.6109412e-16  0              3.2353743    
   1000000   127.27922      200            200            0.004427258   -3.9443145e-38  0              0.013281774    0.00043704382  0              2110.3282      2.6109412e-16  0              3.2353427    
   1100000   127.27922      200            200            0.0044498604  -6.9282111e-39  0              0.013349581    0.00015714282  0              758.78643      2.6109412e-16  0              3.2353267    
   1200000   127.27922      200            200            0.0044517457   1.037001e-38   0              0.013355237    2.7473918e-06  0              13.266172      2.6109412e-16  0              3.2353253    
   1300000   127.27922      200            200            0.0044493598   2.3437087e-39  0              0.013348079    1.2165815e-06  0              5.8744366      2.6109412e-16  0              3.2353269    
   1400000   127.27922      200            200            0.0044482509  -2.1866222e-39  0              0.013344753    3.8335068e-07  0              1.8510632      2.6109412e-16  0              3.2353277    
   1500000   127.27922      200            200            0.0044481768  -3.4344748e-39  0              0.01334453     5.2426461e-09  0              0.025314862    2.6109412e-16  0              3.2353278    
   1600000   127.27922      200            200            0.0044483003  -6.5754692e-39  0              0.013344901    3.3482772e-09  0              0.016167632    2.6109412e-16  0              3.2353277    
   1700000   127.27922      200            200            0.0044483545   3.7107654e-39  0              0.013345064    9.3112806e-10  0              0.0044960842   2.6109412e-16  0              3.2353276    
   1800000   127.27922      200            200            0.0044483572   2.6164591e-39  0              0.013345072    9.5729127e-12  0              4.6224169e-05  2.6109412e-16  0              3.2353276    
   1900000   127.27922      200            200            0.0044483509   9.4858949e-39  0              0.013345053    9.1301828e-12  0              4.4086385e-05  2.6109412e-16  0              3.2353276    
   2000000   127.27922      200            200            0.0044483482  -4.9802846e-40  0              0.013345045    2.2514015e-12  0              1.0871212e-05  2.6109412e-16  0              3.2353276    
   2100000   127.27922      200            200            0.0044483481  -4.9326836e-39  0              0.013345044    1.6460871e-14  0              7.9483656e-08  2.6109412e-16  0              3.2353276    
   2200000   127.27922      200            200            0.0044483484   1.0111126e-38  0              0.013345045    2.4669596e-14  0              1.1912065e-07  2.6109412e-16  0              3.2353276    
   2300000   127.27922      200            200            0.0044483486  -1.4804106e-40  0              0.013345046    5.4231491e-15  0              2.6186446e-08  2.6109412e-16  0              3.2353276    
   2400000   127.27922      200            200            0.0044483486   7.8767024e-39  0              0.013345046    2.7184487e-17  0              1.3126416e-10  2.6109412e-16  0              3.2353276    
   2500000   127.27922      200            200            0.0044483486   2.7202797e-39  0              0.013345046    6.6082039e-17  0              3.1908652e-10  2.6109412e-16  0              3.2353276    
   2600000   127.27922      200            200            0.0044483486   7.3917672e-39  0              0.013345046    1.3101236e-17  0              6.3261181e-11  2.6109412e-16  0              3.2353276    
   2700000   127.27922      200            200            0.0044483486  -1.0989569e-39  0              0.013345046    1.6996031e-21  0              8.2067752e-15  2.6109412e-16  0              3.2353276    
   2800000   127.27922      200            200            0.0044483486   2.6795675e-39  0              0.013345046    2.4501257e-19  0              1.183078e-12   2.6109412e-16  0              3.2353276    
   2900000   127.27922      200            200            0.0044483486   1.3896446e-38  0              0.013345046    4.2101536e-20  0              2.0329325e-13  2.6109412e-16  0              3.2353276    
   3000000   127.27922      200            200            0.0044483486  -1.3310122e-39  0              0.013345046    2.5339439e-20  0              1.2235508e-13  2.6109412e-16  0              3.2353276    
Loop time of 69.1944 on 4 procs for 3000000 steps with 51 atoms

Performance: 37459662.783 ns/day, 0.000 hours/ns, 43356.091 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2516     | 1.2736     | 4.1749     | 148.5 |  1.84
Neigh   | 0.062068   | 0.064418   | 0.068243   |   1.0 |  0.09
Comm    | 29.938     | 37.516     | 43.807     |  92.5 | 54.22
Output  | 0.059405   | 0.059806   | 0.060651   |   0.2 |  0.09
Modify  | 14.978     | 21.476     | 29.699     | 141.1 | 31.04
Other   |            | 8.805      |            |       | 12.72

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.49                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.9663332594927
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.59
  ghost atom cutoff = 3.59
  binsize = 1.795, bins = 71 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.77 | 17.23 | 18.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038369727   3.0265563e-40  0              0.011510918    14726.758      0              7.1110242e+10  2.6109412e-16  0              3.3231746    
    200000   127.27922      200            200           -0.000457937   -5.8063426e-38  0             -0.001373811    2880.9538      0              1.3911095e+10  2.6109412e-16  0              3.2874007    
    300000   127.27922      200            200            0.034076946    0.015567028    0              0.08666381     586.86324      0              2.8337526e+09  2.6109412e-16  0              3.2327871    
    400000   127.27922      200            200            8.7563964e-05  2.198492e-36   0              0.00026269189  29.6694        0              1.4326292e+08  2.6109412e-16  0              3.2494338    
    500000   127.27922      200            200            0.007904251    6.9040061e-36  0              0.023712753    8.9167677      0              43055880       2.6109412e-16  0              3.2381797    
    600000   127.27922      200            200            0.0059487387  -1.6418411e-36  0              0.017846216    0.086093305    0              415713.76      2.6109412e-16  0              3.2393387    
    700000   127.27922      200            200            0.0048068188   1.7301281e-36  0              0.014420456    0.27206674     0              1313712.9      2.6109412e-16  0              3.2400815    
    800000   127.27922      200            200            0.0043850997   1.9348722e-37  0              0.013155299    0.05685047     0              274510.57      2.6109412e-16  0              3.2403763    
    900000   127.27922      200            200            0.0043831842  -7.3340852e-37  0              0.013149553    0.00016669872  0              804.92844      2.6109412e-16  0              3.2403801    
   1000000   127.27922      200            200            0.0044397767   1.7864976e-38  0              0.01331933     0.00077738893  0              3753.7329      2.6109412e-16  0              3.2403408    
   1100000   127.27922      200            200            0.0044596856   3.0979891e-38  0              0.013379057    0.00012848955  0              620.43005      2.6109412e-16  0              3.2403267    
   1200000   127.27922      200            200            0.0044588486   1.5648511e-38  0              0.013376546    1.4050633e-08  0              0.067845477    2.6109412e-16  0              3.2403272    
   1300000   127.27922      200            200            0.0044558665   1.1023937e-39  0              0.013367599    2.2293298e-06  0              10.764636      2.6109412e-16  0              3.2403292    
   1400000   127.27922      200            200            0.0044549558   3.4791537e-39  0              0.013364868    2.7969452e-07  0              1.3505447      2.6109412e-16  0              3.2403299    
   1500000   127.27922      200            200            0.0044550466  -2.6488182e-39  0              0.01336514     4.1609793e-10  0              0.002009188    2.6109412e-16  0              3.2403298    
   1600000   127.27922      200            200            0.004455201   -3.9367497e-39  0              0.013365603    6.1739669e-09  0              0.029811876    2.6109412e-16  0              3.2403297    
   1700000   127.27922      200            200            0.0044552417  -3.8795742e-39  0              0.013365725    5.8698368e-10  0              0.0028343341   2.6109412e-16  0              3.2403297    
   1800000   127.27922      200            200            0.0044552348   2.9578498e-39  0              0.013365704    5.3429856e-12  0              2.5799365e-05  2.6109412e-16  0              3.2403297    
   1900000   127.27922      200            200            0.0044552269  -1.1898331e-38  0              0.013365681    1.6585536e-11  0              8.0085617e-05  2.6109412e-16  0              3.2403297    
   2000000   127.27922      200            200            0.0044552252  -4.8689257e-39  0              0.013365676    1.1793236e-12  0              5.6945315e-06  2.6109412e-16  0              3.2403297    
   2100000   127.27922      200            200            0.0044552256  -2.5754089e-39  0              0.013365677    3.1726811e-14  0              1.5319742e-07  2.6109412e-16  0              3.2403297    
   2200000   127.27922      200            200            0.004455226    4.3849457e-40  0              0.013365678    4.3322451e-14  0              2.0918861e-07  2.6109412e-16  0              3.2403297    
   2300000   127.27922      200            200            0.0044552261  -4.8981776e-39  0              0.013365678    2.2418438e-15  0              1.0825062e-08  2.6109412e-16  0              3.2403297    
   2400000   127.27922      200            200            0.0044552261  -1.6298676e-39  0              0.013365678    1.3917142e-16  0              6.7200896e-10  2.6109412e-16  0              3.2403297    
   2500000   127.27922      200            200            0.004455226    6.6207151e-39  0              0.013365678    1.1015938e-16  0              5.3192021e-10  2.6109412e-16  0              3.2403297    
   2600000   127.27922      200            200            0.004455226    1.7052608e-39  0              0.013365678    3.7425649e-18  0              1.8071506e-11  2.6109412e-16  0              3.2403297    
   2700000   127.27922      200            200            0.004455226    5.8129835e-40  0              0.013365678    8.2857825e-19  0              4.0009079e-12  2.6109412e-16  0              3.2403297    
   2800000   127.27922      200            200            0.004455226    6.8912944e-39  0              0.013365678    1.9179503e-19  0              9.2610956e-13  2.6109412e-16  0              3.2403297    
   2900000   127.27922      200            200            0.004455226   -2.3530387e-39  0              0.013365678    1.5223458e-19  0              7.3508633e-13  2.6109412e-16  0              3.2403297    
   3000000   127.27922      200            200            0.004455226    4.3343106e-39  0              0.013365678    1.0779693e-19  0              5.205128e-13   2.6109412e-16  0              3.2403297    
Loop time of 69.3616 on 4 procs for 3000000 steps with 51 atoms

Performance: 37369383.113 ns/day, 0.000 hours/ns, 43251.601 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25029    | 1.2456     | 4.0736     | 146.3 |  1.80
Neigh   | 0.060792   | 0.063173   | 0.06676    |   1.0 |  0.09
Comm    | 29.888     | 37.547     | 43.918     |  93.9 | 54.13
Output  | 0.062482   | 0.062801   | 0.063271   |   0.1 |  0.09
Modify  | 14.98      | 21.564     | 29.84      | 141.7 | 31.09
Other   |            | 8.879      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 ${n1e1} -100 100 -100 100 units box
region box block -63.6396103067894 63.6396103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -63.6396103067894 63.6396103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-63.63961 -100 -100) to (63.63961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.5                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.3884545083096
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
51 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.6
  ghost atom cutoff = 3.6
  binsize = 1.8, bins = 71 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.77 | 17.23 | 18.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   127.27922      200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   127.27922      200            200            0.0038468183   2.4211221e-39  0              0.011540455    14778.088      0              7.1358098e+10  2.6109412e-16  0              3.3228281    
    200000   127.27922      200            200           -0.00045876282 -1.9352574e-37  0             -0.0013762885   2798.3578      0              1.3512268e+10  2.6109412e-16  0              3.2956606    
    300000   127.27922      200            200            0.022404091    0.0080203443   0              0.059191928    759.60271      0              3.6678496e+09  2.6109412e-16  0              3.2396572    
    400000   127.27922      200            200            0.00010154027 -1.8312379e-36  0              0.00030462081  39.25522       0              1.8954941e+08  2.6109412e-16  0              3.2539717    
    500000   127.27922      200            200            0.0083688213   1.7872732e-05  0              0.025088591    4.5507572      0              21973978       2.6109412e-16  0              3.2429285    
    600000   127.27922      200            200            0.0059701637   8.4147592e-37  0              0.017910491    0.010088471    0              48713.618      2.6109412e-16  0              3.2443296    
    700000   127.27922      200            200            0.004710934   -2.2722178e-36  0              0.014132802    0.37150521     0              1793865.7      2.6109412e-16  0              3.2451532    
    800000   127.27922      200            200            0.0043489238  -1.0227669e-37  0              0.013046771    0.043817916    0              211581.03      2.6109412e-16  0              3.2454089    
    900000   127.27922      200            200            0.0043901562   4.3050698e-37  0              0.013170469    0.00015002789  0              724.43097      2.6109412e-16  0              3.2453823    
   1000000   127.27922      200            200            0.0044536162   5.8647552e-39  0              0.013360849    0.0010538574   0              5088.7002      2.6109412e-16  0              3.245338     
   1100000   127.27922      200            200            0.0044690708   5.8983842e-38  0              0.013407212    8.1387366e-05  0              392.99046      2.6109412e-16  0              3.245327     
   1200000   127.27922      200            200            0.0044655416   2.3225325e-38  0              0.013396625    2.0395074e-06  0              9.8480511      2.6109412e-16  0              3.2453294    
   1300000   127.27922      200            200            0.0044622911   2.5227818e-39  0              0.013386873    2.8567102e-06  0              13.794031      2.6109412e-16  0              3.2453316    
   1400000   127.27922      200            200            0.0044617     -1.008346e-39   0              0.0133851      1.3141885e-07  0              0.63457459     2.6109412e-16  0              3.245332     
   1500000   127.27922      200            200            0.0044619455   8.538103e-39   0              0.013385836    1.199384e-08   0              0.057913962    2.6109412e-16  0              3.2453319    
   1600000   127.27922      200            200            0.0044621062  -3.6266566e-39  0              0.013386318    7.2367966e-09  0              0.034943901    2.6109412e-16  0              3.2453318    
   1700000   127.27922      200            200            0.0044621258  -4.7492251e-39  0              0.013386377    1.7298276e-10  0              0.00083527186  2.6109412e-16  0              3.2453318    
   1800000   127.27922      200            200            0.0044621105   1.0587857e-38  0              0.013386331    5.1654594e-11  0              0.00024942155  2.6109412e-16  0              3.2453318    
   1900000   127.27922      200            200            0.0044621028   2.4124251e-39  0              0.013386308    1.7164855e-11  0              8.2882941e-05  2.6109412e-16  0              3.2453318    
   2000000   127.27922      200            200            0.0044621023  -1.4297414e-39  0              0.013386307    1.5187559e-13  0              7.3335289e-07  2.6109412e-16  0              3.2453318    
   2100000   127.27922      200            200            0.0044621032   1.4940551e-39  0              0.01338631     1.8704674e-13  0              9.0318174e-07  2.6109412e-16  0              3.2453318    
   2200000   127.27922      200            200            0.0044621036  -3.0715475e-40  0              0.013386311    3.8006671e-14  0              1.8352061e-07  2.6109412e-16  0              3.2453318    
   2300000   127.27922      200            200            0.0044621036   4.3746337e-40  0              0.013386311    3.0405457e-17  0              1.4681707e-10  2.6109412e-16  0              3.2453318    
   2400000   127.27922      200            200            0.0044621035   6.157181e-39   0              0.013386311    6.0476107e-16  0              2.9201748e-09  2.6109412e-16  0              3.2453318    
   2500000   127.27922      200            200            0.0044621035  -4.9284201e-39  0              0.013386311    7.8872122e-17  0              3.8084525e-10  2.6109412e-16  0              3.2453318    
   2600000   127.27922      200            200            0.0044621035   4.7165339e-39  0              0.013386311    2.4256525e-19  0              1.1712608e-12  2.6109412e-16  0              3.2453318    
   2700000   127.27922      200            200            0.0044621035  -4.8448783e-39  0              0.013386311    1.967419e-18   0              9.4999623e-12  2.6109412e-16  0              3.2453318    
   2800000   127.27922      200            200            0.0044621035   9.977183e-39   0              0.013386311    1.8092297e-20  0              8.7361227e-14  2.6109412e-16  0              3.2453318    
   2900000   127.27922      200            200            0.0044621035   3.1946256e-39  0              0.013386311    1.120913e-19   0              5.4124877e-13  2.6109412e-16  0              3.2453318    
   3000000   127.27922      200            200            0.0044621035   1.4515126e-39  0              0.013386311    1.534281e-19   0              7.4084939e-13  2.6109412e-16  0              3.2453318    
Loop time of 68.988 on 4 procs for 3000000 steps with 51 atoms

Performance: 37571731.925 ns/day, 0.000 hours/ns, 43485.801 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21524    | 1.2266     | 4.0407     | 146.8 |  1.78
Neigh   | 0.05949    | 0.060956   | 0.063708   |   0.7 |  0.09
Comm    | 29.826     | 37.355     | 43.658     |  92.8 | 54.15
Output  | 0.062088   | 0.062383   | 0.062802   |   0.1 |  0.09
Modify  | 14.952     | 21.449     | 29.606     | 140.5 | 31.09
Other   |            | 8.834      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 0:59:40

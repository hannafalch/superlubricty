LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -225 ${n1e1} -100 100 -100 100 units box
region box block -225 225 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -225 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -225 225 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-225 -100 -100) to (225 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 150 atoms
  using lattice units in orthogonal box = (-225 -100 -100) to (225 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -150 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -150 150 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 101 atoms
  using lattice units in orthogonal box = (-225 -100 -100) to (225 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  150 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  150 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  101 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  101 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
150 atoms in group substrate
group slider1 region slider1
101 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 101 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 291 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 18.14 | 18.14 | 18.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   450            200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   450            200            200            0.0036397311  -1.3543416e-36  0              0.010919193    44189.452      0              4.267501e+10  -4.5            0              3.2460085    
    200000   450            200            200            0.00068601799 -1.3580551e-36  0              0.002058054    4161.2426      0              4.0186303e+09 -4.5            0              2.8092355    
    300000   450            200            200           -0.0001009163   1.698312e-38   0             -0.00030274889  192.24641      0              1.8565782e+08 -4.5            0              2.6517326    
    400000   450            200            200            0.00023717044 -8.1487879e-24  0              0.00071151132  751.43782      0              7.2568486e+08 -4.5            0              2.6025116    
    500000   450            200            200            0.022162918    0.016282991    0              0.050205763    110.09083      0              1.0631785e+08 -4.5            0              2.5969362    
    600000   450            200            200            0.0039853531   0.0029268075   0              0.0090292517   3.8164646      0              3685668.3     -4.5            0              2.5977131    
    700000   450            200            200            0.0063983781   0.00484752     0              0.014347614    0.00038108956  0              368.02902     -4.5            0              2.597577     
    800000   450            200            200            0.0064923638   0.0048600999   0              0.014616991    0.00038149233  0              368.41799     -4.5            0              2.5975722    
    900000   450            200            200            0.0064806936   0.0048585307   0              0.01458355     6.2137648e-05  0              60.008093     -4.5            0              2.5975728    
   1000000   450            200            200            0.0064742882   0.0048576921   0              0.014565173    2.5919158e-06  0              2.5030867     -4.5            0              2.5975731    
   1100000   450            200            200            0.0064793156   0.0048583564   0              0.01457959     3.8666124e-08  0              0.037340975   -4.5            0              2.5975728    
   1200000   450            200            200            0.0064774728   0.004858112    0              0.014574306    1.0443896e-07  0              0.10085968    -4.5            0              2.5975729    
   1300000   450            200            200            0.0064777868   0.004858154    0              0.014575206    2.1758092e-08  0              0.021012408   -4.5            0              2.5975729    
   1400000   450            200            200            0.0064778664   0.0048581643   0              0.014575435    1.2835279e-09  0              0.0012395394  -4.5            0              2.5975729    
   1500000   450            200            200            0.0064777811   0.0048581531   0              0.01457519     3.7455473e-13  0              3.6171815e-07 -4.5            0              2.5975729    
   1600000   450            200            200            0.0064778163   0.0048581578   0              0.014575291    2.6670512e-11  0              2.5756472e-05 -4.5            0              2.5975729    
   1700000   450            200            200            0.0064778089   0.0048581568   0              0.01457527     7.2825582e-12  0              7.0329734e-06 -4.5            0              2.5975729    
   1800000   450            200            200            0.0064778081   0.0048581567   0              0.014575268    5.7182485e-13  0              5.5222751e-07 -4.5            0              2.5975729    
   1900000   450            200            200            0.0064778095   0.0048581569   0              0.014575272    1.8520271e-15  0              1.7885553e-09 -4.5            0              2.5975729    
   2000000   450            200            200            0.0064778089   0.0048581568   0              0.01457527     6.2293927e-15  0              6.0159016e-09 -4.5            0              2.5975729    
   2100000   450            200            200            0.006477809    0.0048581568   0              0.01457527     2.3158019e-15  0              2.2364357e-09 -4.5            0              2.5975729    
   2200000   450            200            200            0.006477809    0.0048581568   0              0.01457527     2.3800192e-16  0              2.2984522e-10 -4.5            0              2.5975729    
   2300000   450            200            200            0.006477809    0.0048581568   0              0.01457527     1.3459105e-18  0              1.299784e-12  -4.5            0              2.5975729    
   2400000   450            200            200            0.006477809    0.0048581568   0              0.01457527     5.7367861e-20  0              5.5401774e-14 -4.5            0              2.5975729    
   2500000   450            200            200            0.006477809    0.0048581568   0              0.01457527     2.7763925e-19  0              2.6812411e-13 -4.5            0              2.5975729    
   2600000   450            200            200            0.006477809    0.0048581568   0              0.01457527     2.0557641e-19  0              1.9853098e-13 -4.5            0              2.5975729    
   2700000   450            200            200            0.006477809    0.0048581568   0              0.01457527     1.5314663e-20  0              1.4789805e-14 -4.5            0              2.5975729    
   2800000   450            200            200            0.006477809    0.0048581568   0              0.01457527     6.0187978e-22  0              5.8125241e-16 -4.5            0              2.5975729    
   2900000   450            200            200            0.006477809    0.0048581568   0              0.01457527     5.753131e-22   0              5.5559622e-16 -4.5            0              2.5975729    
   3000000   450            200            200            0.006477809    0.0048581568   0              0.01457527     1.4405877e-23  0              1.3912165e-17 -4.5            0              2.5975729    
Loop time of 81.4463 on 4 procs for 3000000 steps with 251 atoms

Performance: 31824664.904 ns/day, 0.000 hours/ns, 36834.103 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.6028     | 16.671     | 23.516     | 154.1 | 20.47
Neigh   | 0.30087    | 0.30331    | 0.30459    |   0.3 |  0.37
Comm    | 22.274     | 28.101     | 35.569     | 107.6 | 34.50
Output  | 0.079738   | 0.079792   | 0.079907   |   0.0 |  0.10
Modify  | 23.636     | 26.079     | 27.29      |  28.2 | 32.02
Other   |            | 10.21      |            |       | 12.54

Nlocal:          62.75 ave          75 max          49 min
Histogram: 1 1 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            113 ave         151 max          71 min
Histogram: 1 1 0 0 0 0 0 0 0 2

Total # of neighbors = 452
Ave neighs/atom = 1.8007968
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -450 ${n1e1} -100 100 -100 100 units box
region box block -450 450 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -450 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -450 450 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-450 -100 -100) to (450 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 300 atoms
  using lattice units in orthogonal box = (-450 -100 -100) to (450 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -300 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -300 300 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 201 atoms
  using lattice units in orthogonal box = (-450 -100 -100) to (450 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  300 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  300 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  201 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  201 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
300 atoms in group substrate
group slider1 region slider1
201 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 201 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 581 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 23.16 | 23.16 | 23.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   900            200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   900            200            200            0.0036217817  -6.3791176e-17  0              0.010865345    87945.644      0              4.2465804e+10 -4.5            0              3.2459139    
    200000   900            200            200            0.00068346392 -1.746569e-16   0              0.0020503918   8298.4647      0              4.0070316e+09 -4.5            0              2.8091035    
    300000   900            200            200           -9.8975323e-05 -3.4339515e-16  0             -0.00029692597  370.85157      0              1.7907095e+08 -4.5            0              2.6517736    
    400000   900            200            200            0.00023994331 -5.1414194e-16  0              0.00071982994  1540.6767      0              7.4393762e+08 -4.5            0              2.6022696    
    500000   900            200            200            0.026574865    0.019552904    0              0.06017169     133.21265      0              64323620      -4.5            0              2.596784     
    600000   900            200            200            0.0048104357   0.0035330985   0              0.010898208    10.692515      0              5163032.9     -4.5            0              2.5976632    
    700000   900            200            200            0.0063816247   0.0048254374   0              0.014319437    0.0029369912   0              1418.1679     -4.5            0              2.5975763    
    800000   900            200            200            0.0064495966   0.0048345621   0              0.014514228    0.00095450604  0              460.89681     -4.5            0              2.5975727    
    900000   900            200            200            0.0064522439   0.0048348839   0              0.014521848    8.6853904e-05  0              41.938642     -4.5            0              2.5975726    
   1000000   900            200            200            0.0064416764   0.0048334925   0              0.014491537    7.2970279e-07  0              0.35234736    -4.5            0              2.5975731    
   1100000   900            200            200            0.0064470068   0.0048341984   0              0.014506822    6.3132091e-07  0              0.30484227    -4.5            0              2.5975728    
   1200000   900            200            200            0.0064455622   0.0048340062   0              0.01450268     2.9406454e-07  0              0.14199324    -4.5            0              2.5975729    
   1300000   900            200            200            0.0064456218   0.0048340146   0              0.014502851    3.4122065e-08  0              0.016476324   -4.5            0              2.5975729    
   1400000   900            200            200            0.0064457841   0.0048340359   0              0.014503316    6.9536476e-10  0              0.00033576675 -4.5            0              2.5975729    
   1500000   900            200            200            0.0064456888   0.0048340233   0              0.014503043    1.1397663e-10  0              5.5035235e-05 -4.5            0              2.5975729    
   1600000   900            200            200            0.0064457182   0.0048340272   0              0.014503127    8.6316138e-11  0              4.1678974e-05 -4.5            0              2.5975729    
   1700000   900            200            200            0.0064457152   0.0048340268   0              0.014503119    1.2670217e-11  0              6.1179942e-06 -4.5            0              2.5975729    
   1800000   900            200            200            0.0064457129   0.0048340265   0              0.014503112    4.4220011e-13  0              2.1352261e-07 -4.5            0              2.5975729    
   1900000   900            200            200            0.0064457145   0.0048340267   0              0.014503117    1.4855557e-14  0              7.1732169e-09 -4.5            0              2.5975729    
   2000000   900            200            200            0.0064457139   0.0048340267   0              0.014503115    2.4006246e-14  0              1.1591757e-08 -4.5            0              2.5975729    
   2100000   900            200            200            0.006445714    0.0048340267   0              0.014503115    4.4569369e-15  0              2.1520953e-09 -4.5            0              2.5975729    
   2200000   900            200            200            0.0064457141   0.0048340267   0              0.014503116    2.3283469e-16  0              1.1242754e-10 -4.5            0              2.5975729    
   2300000   900            200            200            0.006445714    0.0048340267   0              0.014503115    4.8267232e-18  0              2.3306519e-12 -4.5            0              2.5975729    
   2400000   900            200            200            0.006445714    0.0048340267   0              0.014503115    1.2774649e-18  0              6.1684208e-13 -4.5            0              2.5975729    
   2500000   900            200            200            0.006445714    0.0048340267   0              0.014503115    2.8721784e-19  0              1.3868721e-13 -4.5            0              2.5975729    
   2600000   900            200            200            0.006445714    0.0048340267   0              0.014503115    1.9034865e-19  0              9.1912551e-14 -4.5            0              2.5975729    
   2700000   900            200            200            0.006445714    0.0048340267   0              0.014503115    5.2567278e-20  0              2.5382857e-14 -4.5            0              2.5975729    
   2800000   900            200            200            0.006445714    0.0048340267   0              0.014503115    8.2431268e-23  0              3.9803109e-17 -4.5            0              2.5975729    
   2900000   900            200            200            0.006445714    0.0048340267   0              0.014503115    7.9321803e-22  0              3.830166e-16  -4.5            0              2.5975729    
   3000000   900            200            200            0.006445714    0.0048340267   0              0.014503115    9.1681794e-23  0              4.4269857e-17 -4.5            0              2.5975729    
Loop time of 117.45 on 4 procs for 3000000 steps with 501 atoms

Performance: 22068874.101 ns/day, 0.000 hours/ns, 25542.678 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.436     | 31.21      | 43.468     | 210.6 | 26.57
Neigh   | 0.57287    | 0.57657    | 0.58077    |   0.4 |  0.49
Comm    | 23.029     | 34.382     | 45.461     | 186.2 | 29.27
Output  | 0.10223    | 0.10231    | 0.10246    |   0.0 |  0.09
Modify  | 35.068     | 38.165     | 41.226     |  45.7 | 32.49
Other   |            | 13.01      |            |       | 11.08

Nlocal:         125.25 ave         150 max          99 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          225.5 ave         300 max         147 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 902
Ave neighs/atom = 1.8003992
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -675 ${n1e1} -100 100 -100 100 units box
region box block -675 675 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -675 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -675 675 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-675 -100 -100) to (675 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 450 atoms
  using lattice units in orthogonal box = (-675 -100 -100) to (675 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -450 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -450 450 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 301 atoms
  using lattice units in orthogonal box = (-675 -100 -100) to (675 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  450 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  450 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  301 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  301 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
450 atoms in group substrate
group slider1 region slider1
301 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 301 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 871 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 28.24 | 28.24 | 28.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   1350           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   1350           200            200            0.0036158444   2.8331859e-18  0              0.010847533    131706.07      0              4.2397433e+10 -4.5            0              3.2458194    
    200000   1350           200            200            0.00068317102  7.7696802e-18  0              0.0020495131   12452.796      0              4.0086731e+09 -4.5            0              2.8089714    
    300000   1350           200            200           -9.7370682e-05  1.5235415e-17  0             -0.00029211205  538.07449      0              1.7321127e+08 -4.5            0              2.6518137    
    400000   1350           200            200            0.00024349203  2.2830126e-17  0              0.0007304761   2375.8468      0              7.6480759e+08 -4.5            0              2.6020243    
    500000   1350           200            200            0.029961456    0.022069002    0              0.067815365    85.599077      0              27555154      -4.5            0              2.5966739    
    600000   1350           200            200            0.005813771    0.0042717895   0              0.013169524    18.798274      0              6051342.5     -4.5            0              2.5976069    
    700000   1350           200            200            0.006394248    0.0048206425   0              0.014362102    0.008123458    0              2615.0181     -4.5            0              2.5975751    
    800000   1350           200            200            0.0064279456   0.0048252024   0              0.014458634    0.0013642772   0              439.17375     -4.5            0              2.5975733    
    900000   1350           200            200            0.0064443479   0.004827348    0              0.014505696    5.9912059e-05  0              19.286259     -4.5            0              2.5975724    
   1000000   1350           200            200            0.0064310293   0.0048255898   0              0.014467498    6.4239008e-07  0              0.20679145    -4.5            0              2.5975731    
   1100000   1350           200            200            0.006435983    0.0048262471   0              0.014481702    2.1579937e-06  0              0.69467862    -4.5            0              2.5975729    
   1200000   1350           200            200            0.0064351099   0.0048261303   0              0.014479199    4.6418989e-07  0              0.14942712    -4.5            0              2.5975729    
   1300000   1350           200            200            0.006434914    0.0048261049   0              0.014478637    2.8476469e-08  0              0.0091668451  -4.5            0              2.5975729    
   1400000   1350           200            200            0.0064351364   0.0048261342   0              0.014479275    6.499157e-13   0              2.0921402e-07 -4.5            0              2.5975729    
   1500000   1350           200            200            0.0064350432   0.0048261219   0              0.014479008    5.325993e-10   0              0.00017144876 -4.5            0              2.5975729    
   1600000   1350           200            200            0.0064350634   0.0048261246   0              0.014479066    1.5092668e-10  0              4.8584728e-05 -4.5            0              2.5975729    
   1700000   1350           200            200            0.0064350651   0.0048261248   0              0.01447907     1.2253896e-11  0              3.9446453e-06 -4.5            0              2.5975729    
   1800000   1350           200            200            0.0064350615   0.0048261243   0              0.01447906     5.3478435e-14  0              1.7215215e-08 -4.5            0              2.5975729    
   1900000   1350           200            200            0.0064350632   0.0048261245   0              0.014479065    1.1929252e-13  0              3.8401391e-08 -4.5            0              2.5975729    
   2000000   1350           200            200            0.0064350627   0.0048261245   0              0.014479064    4.6752923e-14  0              1.5050209e-08 -4.5            0              2.5975729    
   2100000   1350           200            200            0.0064350627   0.0048261245   0              0.014479064    4.8981759e-15  0              1.5767692e-09 -4.5            0              2.5975729    
   2200000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    7.4539429e-17  0              2.3994948e-11 -4.5            0              2.5975729    
   2300000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    4.1017197e-17  0              1.3203824e-11 -4.5            0              2.5975729    
   2400000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    2.1713618e-19  0              6.9898195e-14 -4.5            0              2.5975729    
   2500000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    1.0884115e-18  0              3.5036999e-13 -4.5            0              2.5975729    
   2600000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    8.2177491e-20  0              2.6453713e-14 -4.5            0              2.5975729    
   2700000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    8.3265978e-20  0              2.6804107e-14 -4.5            0              2.5975729    
   2800000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    2.1866227e-21  0              7.0389457e-16 -4.5            0              2.5975729    
   2900000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    6.20322e-22    0              1.9968753e-16 -4.5            0              2.5975729    
   3000000   1350           200            200            0.0064350628   0.0048261245   0              0.014479064    1.8669479e-22  0              6.0098823e-17 -4.5            0              2.5975729    
Loop time of 154.562 on 4 procs for 3000000 steps with 751 atoms

Performance: 16770002.415 ns/day, 0.000 hours/ns, 19409.725 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 28.357     | 47.163     | 65.524     | 263.5 | 30.51
Neigh   | 0.84831    | 0.8546     | 0.86078    |   0.5 |  0.55
Comm    | 23.678     | 41.359     | 60.453     | 272.3 | 26.76
Output  | 0.11629    | 0.11638    | 0.11651    |   0.0 |  0.08
Modify  | 43.422     | 49.14      | 53.926     |  68.3 | 31.79
Other   |            | 15.93      |            |       | 10.31

Nlocal:         187.75 ave         225 max         149 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            338 ave         451 max         221 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1352
Ave neighs/atom = 1.8002663
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -900 ${n1e1} -100 100 -100 100 units box
region box block -900 900 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -900 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -900 900 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-900 -100 -100) to (900 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 600 atoms
  using lattice units in orthogonal box = (-900 -100 -100) to (900 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -600 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -600 600 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 401 atoms
  using lattice units in orthogonal box = (-900 -100 -100) to (900 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  600 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  600 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  401 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  401 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
600 atoms in group substrate
group slider1 region slider1
401 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
1001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 401 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1162 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.32 | 33.35 | 33.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   1800           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   1800           200            200            0.0036129101  -2.764231e-17   0              0.01083873     175470.74      0              4.2364271e+10 -4.5            0              3.2457248    
    200000   1800           200            200            0.00068344472 -7.5664373e-17  0              0.0020503342   16624.309      0              4.013642e+09  -4.5            0              2.808839     
    300000   1800           200            200           -9.5844821e-05 -1.4853751e-16  0             -0.00028753446  694.14459      0              1.6758879e+08 -4.5            0              2.651853     
    400000   1800           200            200            0.00024724418 -2.2258957e-16  0              0.00074173253  3257.9705      0              7.8657867e+08 -4.5            0              2.6017753    
    500000   1800           200            200            0.031887311    0.023508708    0              0.072153225    19.079476      0              4606398.2     -4.5            0              2.5966127    
    600000   1800           200            200            0.0069206509   0.0050879754   0              0.015673977    25.015344      0              6039507.1     -4.5            0              2.5975486    
    700000   1800           200            200            0.0064172928   0.0048205353   0              0.014431343    0.013892963    0              3354.2074     -4.5            0              2.5975736    
    800000   1800           200            200            0.0064126951   0.0048199998   0              0.014418085    0.0013040149   0              314.83107     -4.5            0              2.5975738    
    900000   1800           200            200            0.0064405671   0.0048236733   0              0.014498028    1.2941216e-05  0              3.124425      -4.5            0              2.5975724    
   1000000   1800           200            200            0.0064262504   0.0048217798   0              0.014456971    8.4424449e-06  0              2.0382773     -4.5            0              2.5975731    
   1100000   1800           200            200            0.0064301984   0.0048223051   0              0.01446829     4.1596139e-06  0              1.0042643     -4.5            0              2.5975729    
   1200000   1800           200            200            0.006429997    0.0048222771   0              0.014467714    4.9672753e-07  0              0.11992597    -4.5            0              2.5975729    
   1300000   1800           200            200            0.0064295767   0.0048222219   0              0.014466508    1.1025311e-08  0              0.0026618639  -4.5            0              2.5975729    
   1400000   1800           200            200            0.006429829    0.0048222552   0              0.014467232    1.4447774e-09  0              0.00034881565 -4.5            0              2.5975729    
   1500000   1800           200            200            0.0064297499   0.0048222447   0              0.014467005    1.1856424e-09  0              0.00028625215 -4.5            0              2.5975729    
   1600000   1800           200            200            0.0064297586   0.0048222459   0              0.01446703     1.7897001e-10  0              4.3209107e-05 -4.5            0              2.5975729    
   1700000   1800           200            200            0.0064297645   0.0048222467   0              0.014467047    6.5803419e-12  0              1.5887058e-06 -4.5            0              2.5975729    
   1800000   1800           200            200            0.0064297602   0.0048222461   0              0.014467034    1.7132779e-13  0              4.1364028e-08 -4.5            0              2.5975729    
   1900000   1800           200            200            0.0064297617   0.0048222463   0              0.014467039    3.1957692e-13  0              7.7156129e-08 -4.5            0              2.5975729    
   2000000   1800           200            200            0.0064297615   0.0048222463   0              0.014467038    6.1601587e-14  0              1.4872601e-08 -4.5            0              2.5975729    
   2100000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    3.3335068e-15  0              8.0481556e-10 -4.5            0              2.5975729    
   2200000   1800           200            200            0.0064297615   0.0048222463   0              0.014467038    1.0194725e-17  0              2.4613339e-12 -4.5            0              2.5975729    
   2300000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    1.0901617e-16  0              2.6320003e-11 -4.5            0              2.5975729    
   2400000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    8.8935637e-19  0              2.1471918e-13 -4.5            0              2.5975729    
   2500000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    3.6295048e-18  0              8.7627899e-13 -4.5            0              2.5975729    
   2600000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    7.9212307e-19  0              1.9124394e-13 -4.5            0              2.5975729    
   2700000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    1.5422695e-20  0              3.7235337e-15 -4.5            0              2.5975729    
   2800000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    6.7990628e-21  0              1.641512e-15  -4.5            0              2.5975729    
   2900000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    1.6769601e-21  0              4.04872e-16   -4.5            0              2.5975729    
   3000000   1800           200            200            0.0064297614   0.0048222463   0              0.014467038    1.1023745e-24  0              2.661486e-19  -4.5            0              2.5975729    
Loop time of 196.571 on 4 procs for 3000000 steps with 1001 atoms

Performance: 13186046.701 ns/day, 0.000 hours/ns, 15261.628 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.821     | 64.359     | 90.81      | 312.3 | 32.74
Neigh   | 1.1184     | 1.1269     | 1.1348     |   0.7 |  0.57
Comm    | 24.394     | 49.462     | 73.443     | 340.2 | 25.16
Output  | 0.12884    | 0.12895    | 0.12912    |   0.0 |  0.07
Modify  | 55.47      | 62.408     | 69.478     |  79.9 | 31.75
Other   |            | 19.09      |            |       |  9.71

Nlocal:         250.25 ave         300 max         199 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          450.5 ave         600 max         297 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1802
Ave neighs/atom = 1.8001998
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1125 ${n1e1} -100 100 -100 100 units box
region box block -1125 1125 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1125 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1125 1125 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1125 -100 -100) to (1125 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1125 -100 -100) to (1125 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1125 -100 -100) to (1125 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
1251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1452 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.4 | 38.4 | 38.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2250           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   2250           200            200            0.0036111771   2.5494697e-17  0              0.010833531    219239.65      0              4.2345192e+10 -4.5            0              3.2456303    
    200000   2250           200            200            0.00068394467  6.9831804e-17  0              0.002051834    20813.003      0              4.0199417e+09 -4.5            0              2.8087065    
    300000   2250           200            200           -9.4349768e-05  1.37264e-16    0             -0.0002830493   839.362        0              1.6211915e+08 -4.5            0              2.6518913    
    400000   2250           200            200            0.00025108387  2.0544767e-16  0              0.00075325161  4188.0297      0              8.0889987e+08 -4.5            0              2.6015227    
    500000   2250           200            200            0.032115379    0.023756605    0              0.072589532    6.1758654      0              1192841.7     -4.5            0              2.5966045    
    600000   2250           200            200            0.0080375939   0.0059127907   0              0.018199991    26.332329      0              5085975.7     -4.5            0              2.5974928    
    700000   2250           200            200            0.0064439256   0.0048221975   0              0.014509579    0.016915482    0              3267.1523     -4.5            0              2.597572     
    800000   2250           200            200            0.0064018841   0.0048166944   0              0.014388958    0.00077918034  0              150.49532     -4.5            0              2.5975742    
    900000   2250           200            200            0.0064375074   0.0048214077   0              0.014491114    5.7456748e-06  0              1.1097523     -4.5            0              2.5975723    
   1000000   2250           200            200            0.0064240514   0.0048196247   0              0.01445253     2.5102886e-05  0              4.8485141     -4.5            0              2.597573     
   1100000   2250           200            200            0.0064265016   0.0048199525   0              0.014459552    5.5841087e-06  0              1.0785465     -4.5            0              2.5975729    
   1200000   2250           200            200            0.0064269852   0.0048200152   0              0.01446094     3.5600051e-07  0              0.068759961   -4.5            0              2.5975729    
   1300000   2250           200            200            0.0064263993   0.0048199379   0              0.01445926     1.7058123e-11  0              3.2947028e-06 -4.5            0              2.5975729    
   1400000   2250           200            200            0.0064266485   0.0048199709   0              0.014459975    5.9923469e-09  0              0.0011573959  -4.5            0              2.5975729    
   1500000   2250           200            200            0.0064265932   0.0048199635   0              0.014459816    1.763948e-09   0              0.00034069894 -4.5            0              2.5975729    
   1600000   2250           200            200            0.0064265896   0.0048199631   0              0.014459806    1.4782453e-10  0              2.8551669e-05 -4.5            0              2.5975729    
   1700000   2250           200            200            0.0064265989   0.0048199643   0              0.014459832    8.2014432e-13  0              1.5840734e-07 -4.5            0              2.5975729    
   1800000   2250           200            200            0.0064265944   0.0048199637   0              0.014459819    1.2944327e-12  0              2.500141e-07  -4.5            0              2.5975729    
   1900000   2250           200            200            0.0064265956   0.0048199639   0              0.014459823    5.3348119e-13  0              1.0303959e-07 -4.5            0              2.5975729    
   2000000   2250           200            200            0.0064265955   0.0048199639   0              0.014459823    5.7210452e-14  0              1.1049952e-08 -4.5            0              2.5975729    
   2100000   2250           200            200            0.0064265954   0.0048199638   0              0.014459822    9.4310544e-16  0              1.8215675e-10 -4.5            0              2.5975729    
   2200000   2250           200            200            0.0064265955   0.0048199639   0              0.014459823    2.2917995e-16  0              4.4265119e-11 -4.5            0              2.5975729    
   2300000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    1.5781997e-16  0              3.0482247e-11 -4.5            0              2.5975729    
   2400000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    5.098047e-18   0              9.8466578e-13 -4.5            0              2.5975729    
   2500000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    6.4632824e-19  0              1.2483551e-13 -4.5            0              2.5975729    
   2600000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    8.4110581e-19  0              1.6245596e-13 -4.5            0              2.5975729    
   2700000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    6.2834131e-21  0              1.2136141e-15 -4.5            0              2.5975729    
   2800000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    9.8051289e-21  0              1.8938183e-15 -4.5            0              2.5975729    
   2900000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    1.5816936e-21  0              3.054973e-16  -4.5            0              2.5975729    
   3000000   2250           200            200            0.0064265955   0.0048199638   0              0.014459823    2.2317334e-24  0              4.3104968e-19 -4.5            0              2.5975729    
Loop time of 229.386 on 4 procs for 3000000 steps with 1251 atoms

Performance: 11299750.632 ns/day, 0.000 hours/ns, 13078.415 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.257     | 78.757     | 110        | 339.9 | 34.33
Neigh   | 1.4136     | 1.4258     | 1.4377     |   0.8 |  0.62
Comm    | 24.482     | 54.724     | 86.294     | 398.9 | 23.86
Output  | 0.14271    | 0.14283    | 0.143      |   0.0 |  0.06
Modify  | 61.94      | 72.292     | 80.761     | 100.6 | 31.52
Other   |            | 22.04      |            |       |  9.61

Nlocal:         312.75 ave         375 max         249 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            563 ave         751 max         371 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2252
Ave neighs/atom = 1.8001599
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1350 ${n1e1} -100 100 -100 100 units box
region box block -1350 1350 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1350 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1350 1350 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1350 -100 -100) to (1350 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 900 atoms
  using lattice units in orthogonal box = (-1350 -100 -100) to (1350 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -900 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -900 900 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 601 atoms
  using lattice units in orthogonal box = (-1350 -100 -100) to (1350 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  900 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  900 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  601 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  601 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
900 atoms in group substrate
group slider1 region slider1
601 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
1501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 601 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1742 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.41 | 43.44 | 43.48 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2700           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   2700           200            200            0.0036100446  -6.7982105e-17  0              0.010830134    263012.79      0              4.2333155e+10 -4.5            0              3.2455358    
    200000   2700           200            200            0.00068455836 -1.8621825e-16  0              0.0020536751   25018.934      0              4.0269159e+09 -4.5            0              2.8085738    
    300000   2700           200            200           -9.2867812e-05 -3.6537171e-16  0             -0.00027860344  973.9862       0              1.5676769e+08 -4.5            0              2.6519288    
    400000   2700           200            200            0.00025497166 -5.4798522e-16  0              0.00076491497  5166.9759      0              8.3164924e+08 -4.5            0              2.6012666    
    500000   2700           200            200            0.030621133    0.02340678     0              0.068456618    110.79202      0              17832500      -4.5            0              2.5966495    
    600000   2700           200            200            0.0090527712   0.0066637069   0              0.020494607    21.541425      0              3467194.4     -4.5            0              2.5974443    
    700000   2700           200            200            0.0064692016   0.004824316    0              0.014583289    0.014922444    0              2401.838      -4.5            0              2.5975706    
    800000   2700           200            200            0.0063954063   0.0048146158   0              0.014371603    0.00017210914  0              27.701782     -4.5            0              2.5975744    
    900000   2700           200            200            0.0064341044   0.0048197503   0              0.014482563    8.5178856e-05  0              13.70994      -4.5            0              2.5975724    
   1000000   2700           200            200            0.0064232316   0.0048183059   0              0.014451389    4.4632525e-05  0              7.1838163     -4.5            0              2.597573     
   1100000   2700           200            200            0.0064238934   0.0048183971   0              0.014453283    5.4947122e-06  0              0.88439995    -4.5            0              2.5975729    
   1200000   2700           200            200            0.0064249865   0.0048185407   0              0.014456419    1.3267549e-07  0              0.021354749   -4.5            0              2.5975729    
   1300000   2700           200            200            0.006424314    0.0048184518   0              0.01445449     1.3734e-08     0              0.0022105523  -4.5            0              2.5975729    
   1400000   2700           200            200            0.0064245281   0.0048184802   0              0.014455104    1.2349683e-08  0              0.00198774    -4.5            0              2.5975729    
   1500000   2700           200            200            0.0064245031   0.0048184769   0              0.014455033    1.920191e-09   0              0.00030906384 -4.5            0              2.5975729    
   1600000   2700           200            200            0.006424488    0.0048184749   0              0.014454989    7.4665239e-11  0              1.2017724e-05 -4.5            0              2.5975729    
   1700000   2700           200            200            0.0064244994   0.0048184764   0              0.014455022    1.4662846e-12  0              2.3600545e-07 -4.5            0              2.5975729    
   1800000   2700           200            200            0.0064244953   0.0048184758   0              0.01445501     3.2304047e-12  0              5.1994895e-07 -4.5            0              2.5975729    
   1900000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    6.4048824e-13  0              1.0308962e-07 -4.5            0              2.5975729    
   2000000   2700           200            200            0.0064244962   0.004818476    0              0.014455013    3.5612403e-14  0              5.731985e-09  -4.5            0              2.5975729    
   2100000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    3.0159788e-17  0              4.8543608e-12 -4.5            0              2.5975729    
   2200000   2700           200            200            0.0064244961   0.0048184759   0              0.014455012    7.6118301e-16  0              1.2251601e-10 -4.5            0              2.5975729    
   2300000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    1.9441024e-16  0              3.1291248e-11 -4.5            0              2.5975729    
   2400000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    1.7756804e-18  0              2.8580418e-13 -4.5            0              2.5975729    
   2500000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    2.6172945e-18  0              4.2126596e-13 -4.5            0              2.5975729    
   2600000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    9.8150661e-19  0              1.5797814e-13 -4.5            0              2.5975729    
   2700000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    5.9105728e-20  0              9.513347e-15  -4.5            0              2.5975729    
   2800000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    3.6298598e-21  0              5.8424313e-16 -4.5            0              2.5975729    
   2900000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    2.5097031e-21  0              4.039486e-16  -4.5            0              2.5975729    
   3000000   2700           200            200            0.006424496    0.0048184759   0              0.014455012    4.5285651e-23  0              7.2889401e-18 -4.5            0              2.5975729    
Loop time of 268.395 on 4 procs for 3000000 steps with 1501 atoms

Performance: 9657400.566 ns/day, 0.000 hours/ns, 11177.547 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.221     | 96.489     | 134.4      | 379.4 | 35.95
Neigh   | 1.6652     | 1.6765     | 1.6878     |   0.7 |  0.62
Comm    | 25.319     | 62.453     | 101.41     | 465.0 | 23.27
Output  | 0.15759    | 0.15773    | 0.15793    |   0.0 |  0.06
Modify  | 71.399     | 82.925     | 92.86      | 109.3 | 30.90
Other   |            | 24.69      |            |       |  9.20

Nlocal:         375.25 ave         450 max         299 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          675.5 ave         900 max         447 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2702
Ave neighs/atom = 1.8001332
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1575 ${n1e1} -100 100 -100 100 units box
region box block -1575 1575 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1575 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1575 1575 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1575 -100 -100) to (1575 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1050 atoms
  using lattice units in orthogonal box = (-1575 -100 -100) to (1575 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1050 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1050 1050 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 701 atoms
  using lattice units in orthogonal box = (-1575 -100 -100) to (1575 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1050 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1050 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  701 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  701 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1050 atoms in group substrate
group slider1 region slider1
701 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
1751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 701 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2033 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 48.56 | 48.56 | 48.56 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3150           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   3150           200            200            0.0036092553   1.8219891e-17  0              0.010827766    306790.18      0              4.2325142e+10 -4.5            0              3.2454413    
    200000   3150           200            200            0.00068523518  4.9912688e-17  0              0.0020557055   29241.986      0              4.0342596e+09 -4.5            0              2.8084414    
    300000   3150           200            200           -9.139643e-05   9.7863232e-17  0             -0.00027418929  1098.4079      0              1.5153767e+08 -4.5            0              2.6519654    
    400000   3150           200            200            0.00025888031  1.4650286e-16  0              0.00077664094  6195.3179      0              8.5471351e+08 -4.5            0              2.6010076    
    500000   3150           200            200            0.027603852    0.021117338    0              0.061694217    359.40911      0              49584514      -4.5            0              2.5967438    
    600000   3150           200            200            0.0098546979   0.0072583131   0              0.022305781    12.386055      0              1708795.1     -4.5            0              2.5974071    
    700000   3150           200            200            0.0064891409   0.004826094    0              0.014641329    0.0086630178   0              1195.1604     -4.5            0              2.5975695    
    800000   3150           200            200            0.0063933242   0.004813493    0              0.01436648     4.0079689e-05  0              5.5294421     -4.5            0              2.5975745    
    900000   3150           200            200            0.0064300886   0.0048183823   0              0.014471884    0.00024736536  0              34.126823     -4.5            0              2.5975725    
   1000000   3150           200            200            0.0064231634   0.0048174578   0              0.014452033    5.7085695e-05  0              7.8756112     -4.5            0              2.5975729    
   1100000   3150           200            200            0.0064219806   0.0048173045   0              0.014448637    3.7902813e-06  0              0.52291177    -4.5            0              2.597573     
   1200000   3150           200            200            0.0064235313   0.0048175092   0              0.014453085    1.353301e-09   0              0.00018670303 -4.5            0              2.5975729    
   1300000   3150           200            200            0.0064228604   0.0048174203   0              0.014451161    5.6984736e-08  0              0.0078616827  -4.5            0              2.5975729    
   1400000   3150           200            200            0.0064230128   0.0048174406   0              0.014451598    1.7509949e-08  0              0.0024156937  -4.5            0              2.5975729    
   1500000   3150           200            200            0.0064230205   0.0048174415   0              0.01445162     1.518464e-09   0              0.00020948912 -4.5            0              2.5975729    
   1600000   3150           200            200            0.0064229961   0.0048174383   0              0.01445155     1.0526448e-11  0              1.4522414e-06 -4.5            0              2.5975729    
   1700000   3150           200            200            0.0064230081   0.0048174399   0              0.014451584    1.1824603e-11  0              1.6313364e-06 -4.5            0              2.5975729    
   1800000   3150           200            200            0.006423005    0.0048174395   0              0.014451575    5.1397407e-12  0              7.0908481e-07 -4.5            0              2.5975729    
   1900000   3150           200            200            0.0064230051   0.0048174395   0              0.014451576    5.6791776e-13  0              7.8350617e-08 -4.5            0              2.5975729    
   2000000   3150           200            200            0.0064230054   0.0048174396   0              0.014451577    1.0479393e-14  0              1.4457497e-09 -4.5            0              2.5975729    
   2100000   3150           200            200            0.0064230052   0.0048174395   0              0.014451576    2.1128563e-15  0              2.9149219e-10 -4.5            0              2.5975729    
   2200000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    1.4313616e-15  0              1.9747237e-10 -4.5            0              2.5975729    
   2300000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    2.2156563e-16  0              3.0567461e-11 -4.5            0              2.5975729    
   2400000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    6.7281603e-22  0              9.2822509e-17 -4.5            0              2.5975729    
   2500000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    1.0057452e-18  0              1.3875382e-13 -4.5            0              2.5975729    
   2600000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    1.0409191e-19  0              1.4360646e-14 -4.5            0              2.5975729    
   2700000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    1.5361188e-19  0              2.119248e-14  -4.5            0              2.5975729    
   2800000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    5.2520002e-21  0              7.2457227e-16 -4.5            0              2.5975729    
   2900000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    9.4191384e-22  0              1.2994757e-16 -4.5            0              2.5975729    
   3000000   3150           200            200            0.0064230053   0.0048174395   0              0.014451576    3.4694423e-22  0              4.7864843e-17 -4.5            0              2.5975729    
Loop time of 305.265 on 4 procs for 3000000 steps with 1751 atoms

Performance: 8490985.788 ns/day, 0.000 hours/ns, 9827.530 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.487     | 108.85     | 156.45     | 411.7 | 35.66
Neigh   | 1.9498     | 1.9659     | 1.9814     |   0.9 |  0.64
Comm    | 26.314     | 70.523     | 117.91     | 486.1 | 23.10
Output  | 0.16842    | 0.16855    | 0.16873    |   0.0 |  0.06
Modify  | 80.363     | 95.991     | 106.77     | 109.4 | 31.45
Other   |            | 27.77      |            |       |  9.10

Nlocal:         437.75 ave         525 max         349 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            788 ave        1051 max         521 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3152
Ave neighs/atom = 1.8001142
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1800 ${n1e1} -100 100 -100 100 units box
region box block -1800 1800 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1800 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1800 1800 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1800 -100 -100) to (1800 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1200 atoms
  using lattice units in orthogonal box = (-1800 -100 -100) to (1800 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1200 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1200 1200 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 801 atoms
  using lattice units in orthogonal box = (-1800 -100 -100) to (1800 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1200 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1200 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  801 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  801 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1200 atoms in group substrate
group slider1 region slider1
801 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 801 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2323 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 53.57 | 53.57 | 53.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3600           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   3600           200            200            0.0036086806  -1.276694e-17   0              0.010826042    350571.8       0              4.2319643e+10 -4.5            0              3.2453467    
    200000   3600           200            200            0.00068595263 -3.4977731e-17  0              0.0020578579   33482.276      0              4.0418482e+09 -4.5            0              2.8083088    
    300000   3600           200            200           -8.9926526e-05 -6.8516376e-17  0             -0.00026977958  1212.7829      0              1.4640237e+08 -4.5            0              2.652001     
    400000   3600           200            200            0.00026281849 -1.0258461e-16  0              0.00078845547  7274.642       0              8.7816607e+08 -4.5            0              2.6007447    
    500000   3600           200            200            0.023412485    0.017928385    0              0.052309069    733.17778      0              88506328      -4.5            0              2.5968814    
    600000   3600           200            200            0.010349899    0.0076273707   0              0.023422327    3.3673026      0              406487.48     -4.5            0              2.5973846    
    700000   3600           200            200            0.0065007877   0.004827016    0              0.014675347    0.0020528266   0              247.80913     -4.5            0              2.5975688    
    800000   3600           200            200            0.0063954439   0.0048131602   0              0.014373171    0.00076313697  0              92.122883     -4.5            0              2.5975743    
    900000   3600           200            200            0.0064255705   0.0048171767   0              0.014459535    0.0004299418   0              51.900877     -4.5            0              2.5975727    
   1000000   3600           200            200            0.0064234342   0.0048168846   0              0.014453418    5.4702989e-05  0              6.6035289     -4.5            0              2.5975728    
   1100000   3600           200            200            0.0064205863   0.0048165104   0              0.014445249    1.437729e-06   0              0.17355697    -4.5            0              2.597573     
   1200000   3600           200            200            0.0064223876   0.0048167486   0              0.014450414    1.1524049e-07  0              0.013911377   -4.5            0              2.5975729    
   1300000   3600           200            200            0.0064218042   0.0048166712   0              0.014448741    1.153555e-07   0              0.01392526    -4.5            0              2.5975729    
   1400000   3600           200            200            0.0064218768   0.004816681    0              0.01444895     1.8533702e-08  0              0.0022373153  -4.5            0              2.5975729    
   1500000   3600           200            200            0.0064219153   0.004816686    0              0.01444906     7.6344262e-10  0              9.215978e-05  -4.5            0              2.5975729    
   1600000   3600           200            200            0.0064218852   0.004816682    0              0.014448974    1.0791954e-11  0              1.3027621e-06 -4.5            0              2.5975729    
   1700000   3600           200            200            0.0064218962   0.0048166835   0              0.014449005    2.9244164e-11  0              3.5302401e-06 -4.5            0              2.5975729    
   1800000   3600           200            200            0.0064218943   0.0048166832   0              0.014449       5.9922554e-12  0              7.2336142e-07 -4.5            0              2.5975729    
   1900000   3600           200            200            0.0064218938   0.0048166832   0              0.014448998    3.4799564e-13  0              4.2008661e-08 -4.5            0              2.5975729    
   2000000   3600           200            200            0.0064218943   0.0048166832   0              0.014449       9.0668691e-17  0              1.0945166e-11 -4.5            0              2.5975729    
   2100000   3600           200            200            0.0064218941   0.0048166832   0              0.014448999    6.9237587e-15  0              8.3580882e-10 -4.5            0              2.5975729    
   2200000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    1.8538951e-15  0              2.237949e-10  -4.5            0              2.5975729    
   2300000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    1.9223196e-16  0              2.3205484e-11 -4.5            0              2.5975729    
   2400000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    4.7637126e-18  0              5.7505658e-13 -4.5            0              2.5975729    
   2500000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    2.192424e-19   0              2.6466077e-14 -4.5            0              2.5975729    
   2600000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    9.2061727e-19  0              1.1113328e-13 -4.5            0              2.5975729    
   2700000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    1.0899305e-19  0              1.3157211e-14 -4.5            0              2.5975729    
   2800000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    8.9793158e-22  0              1.0839476e-16 -4.5            0              2.5975729    
   2900000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    2.7548258e-21  0              3.3255169e-16 -4.5            0              2.5975729    
   3000000   3600           200            200            0.0064218942   0.0048166832   0              0.014448999    1.3100339e-22  0              1.5814212e-17 -4.5            0              2.5975729    
Loop time of 341.249 on 4 procs for 3000000 steps with 2001 atoms

Performance: 7595621.300 ns/day, 0.000 hours/ns, 8791.228 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.934     | 125.43     | 175.83     | 436.4 | 36.76
Neigh   | 2.2183     | 2.2382     | 2.257      |   1.0 |  0.66
Comm    | 26.078     | 75.328     | 127.51     | 556.0 | 22.07
Output  | 0.18332    | 0.18347    | 0.1837     |   0.0 |  0.05
Modify  | 90.091     | 106.4      | 121.23     | 134.5 | 31.18
Other   |            | 31.67      |            |       |  9.28

Nlocal:         500.25 ave         600 max         399 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          900.5 ave        1200 max         597 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3602
Ave neighs/atom = 1.8001
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -2025 ${n1e1} -100 100 -100 100 units box
region box block -2025 2025 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2025 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2025 2025 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-2025 -100 -100) to (2025 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1350 atoms
  using lattice units in orthogonal box = (-2025 -100 -100) to (2025 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1350 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1350 1350 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 901 atoms
  using lattice units in orthogonal box = (-2025 -100 -100) to (2025 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1350 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1350 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  901 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  901 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1350 atoms in group substrate
group slider1 region slider1
901 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 901 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2613 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 58.65 | 58.65 | 58.65 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4050           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   4050           200            200            0.0036082488  -1.1319344e-17  0              0.010824746    394357.65      0              4.2315822e+10 -4.5            0              3.2452522    
    200000   4050           200            200            0.00068669784 -3.1075701e-17  0              0.0020600935   37739.883      0              4.0496086e+09 -4.5            0              2.808176     
    300000   4050           200            200           -8.8458656e-05 -6.0840924e-17  0             -0.00026537597  1317.4542      0              1.41367e+08   -4.5            0              2.6520358    
    400000   4050           200            200            0.00026676993 -9.1074764e-17  0              0.00080030979  8405.3795      0              9.0192377e+08 -4.5            0              2.6004786    
    500000   4050           200            200            0.018514666    0.014197002    0              0.041346995    1169.2851      0              1.2546799e+08 -4.5            0              2.5970534    
    600000   4050           200            200            0.01047842     0.0077279005   0              0.023707361    0.068016054    0              7298.3374     -4.5            0              2.5973785    
    700000   4050           200            200            0.0065024061   0.0048267862   0              0.014680432    0.00023341326  0              25.045979     -4.5            0              2.5975687    
    800000   4050           200            200            0.0064011846   0.004813462    0              0.014390092    0.0022522254   0              241.6709      -4.5            0              2.5975739    
    900000   4050           200            200            0.0064208742   0.0048160978   0              0.014446525    0.00054173154  0              58.129505     -4.5            0              2.5975729    
   1000000   4050           200            200            0.0064237394   0.0048164679   0              0.01445475     3.7523148e-05  0              4.0263523     -4.5            0              2.5975728    
   1100000   4050           200            200            0.0064196173   0.0048159241   0              0.014442928    3.5800876e-08  0              0.0038415471  -4.5            0              2.597573     
   1200000   4050           200            200            0.0064214338   0.0048161649   0              0.014448137    5.0064562e-07  0              0.053720856   -4.5            0              2.5975729    
   1300000   4050           200            200            0.0064210108   0.0048161085   0              0.014446924    1.6129321e-07  0              0.017307271   -4.5            0              2.5975729    
   1400000   4050           200            200            0.0064209963   0.0048161068   0              0.014446882    1.4499973e-08  0              0.0015558929  -4.5            0              2.5975729    
   1500000   4050           200            200            0.0064210598   0.0048161151   0              0.014447064    1.2328861e-10  0              1.3229257e-05 -4.5            0              2.5975729    
   1600000   4050           200            200            0.0064210279   0.0048161109   0              0.014446973    9.9595539e-11  0              1.0686916e-05 -4.5            0              2.5975729    
   1700000   4050           200            200            0.0064210365   0.004816112    0              0.014446998    4.5939352e-11  0              4.9294376e-06 -4.5            0              2.5975729    
   1800000   4050           200            200            0.0064210362   0.004816112    0              0.014446997    5.2497076e-12  0              5.6331021e-07 -4.5            0              2.5975729    
   1900000   4050           200            200            0.0064210352   0.0048161119   0              0.014446994    1.0552769e-13  0              1.1323455e-08 -4.5            0              2.5975729    
   2000000   4050           200            200            0.0064210358   0.0048161119   0              0.014446995    1.6825317e-14  0              1.8054096e-09 -4.5            0              2.5975729    
   2100000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    1.2384282e-14  0              1.3288726e-09 -4.5            0              2.5975729    
   2200000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    1.7959308e-15  0              1.9270904e-10 -4.5            0              2.5975729    
   2300000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    1.1672028e-16  0              1.2524455e-11 -4.5            0              2.5975729    
   2400000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    1.2886988e-17  0              1.3828145e-12 -4.5            0              2.5975729    
   2500000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    2.1864017e-18  0              2.3460781e-13 -4.5            0              2.5975729    
   2600000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    1.6178335e-19  0              1.7359864e-14 -4.5            0              2.5975729    
   2700000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    8.986273e-20   0              9.6425547e-15 -4.5            0              2.5975729    
   2800000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    1.9897506e-20  0              2.1350652e-15 -4.5            0              2.5975729    
   2900000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    3.3931754e-24  0              3.6409844e-19 -4.5            0              2.5975729    
   3000000   4050           200            200            0.0064210356   0.0048161119   0              0.014446995    3.2598227e-22  0              3.4978927e-17 -4.5            0              2.5975729    
Loop time of 378.472 on 4 procs for 3000000 steps with 2251 atoms

Performance: 6848590.430 ns/day, 0.000 hours/ns, 7926.609 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.401     | 139.96     | 197.75     | 472.9 | 36.98
Neigh   | 2.5002     | 2.5203     | 2.5395     |   1.0 |  0.67
Comm    | 26.88      | 83.284     | 141.41     | 604.3 | 22.01
Output  | 0.19485    | 0.19501    | 0.19525    |   0.0 |  0.05
Modify  | 101.05     | 118.45     | 133.9      | 139.1 | 31.30
Other   |            | 34.06      |            |       |  9.00

Nlocal:         562.75 ave         675 max         449 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           1013 ave        1351 max         671 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 4052
Ave neighs/atom = 1.8000888
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -2250 ${n1e1} -100 100 -100 100 units box
region box block -2250 2250 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2250 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2250 2250 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-2250 -100 -100) to (2250 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -100 -100) to (2250 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -100 -100) to (2250 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 63.66 | 63.66 | 63.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   4500           200            200            0.0036079171   8.5194512e-19  0              0.010823751    438147.75      0              4.2313173e+10 -4.5            0              3.2451577    
    200000   4500           200            200            0.00068746207  2.3290992e-18  0              0.0020623862   42014.785      0              4.0574872e+09 -4.5            0              2.8080431    
    300000   4500           200            200           -8.6989308e-05  4.5690197e-18  0             -0.00026096793  1412.6258      0              1.3642129e+08 -4.5            0              2.6520697    
    400000   4500           200            200            0.00027073596  6.832734e-18   0              0.00081220788  9588.6353      0              9.2600177e+08 -4.5            0              2.600209     
    500000   4500           200            200            0.013416881    0.010310144    0              0.029940498    1583.7523      0              1.5294746e+08 -4.5            0              2.5972497    
    600000   4500           200            200            0.010227846    0.0076883901   0              0.022995148    6.4683454      0              624666.5      -4.5            0              2.5973894    
    700000   4500           200            200            0.0064936813   0.0048253164   0              0.014655728    0.0064591977   0              623.78308     -4.5            0              2.5975691    
    800000   4500           200            200            0.0064095903   0.004814223    0              0.014414548    0.0039157222   0              378.15242     -4.5            0              2.5975735    
    900000   4500           200            200            0.0064164213   0.0048151543   0              0.014434109    0.00051631743  0              49.862242     -4.5            0              2.5975731    
   1000000   4500           200            200            0.0064238573   0.0048161313   0              0.014455441    1.4772592e-05  0              1.4266312     -4.5            0              2.5975727    
   1100000   4500           200            200            0.0064190081   0.0048154901   0              0.014441534    8.9765297e-07  0              0.086688899   -4.5            0              2.597573     
   1200000   4500           200            200            0.0064206074   0.0048157025   0              0.01444612     1.0187977e-06  0              0.098388192   -4.5            0              2.5975729    
   1300000   4500           200            200            0.0064203954   0.004815674    0              0.014445512    1.6960738e-07  0              0.016379467   -4.5            0              2.5975729    
   1400000   4500           200            200            0.0064202976   0.0048156612   0              0.014445232    7.4111718e-09  0              0.00071571793 -4.5            0              2.5975729    
   1500000   4500           200            200            0.0064203775   0.0048156718   0              0.014445461    7.1128578e-11  0              6.869089e-06  -4.5            0              2.5975729    
   1600000   4500           200            200            0.0064203479   0.0048156679   0              0.014445376    2.4999193e-10  0              2.4142432e-05 -4.5            0              2.5975729    
   1700000   4500           200            200            0.0064203531   0.0048156685   0              0.014445391    5.3211761e-11  0              5.138811e-06  -4.5            0              2.5975729    
   1800000   4500           200            200            0.0064203542   0.0048156687   0              0.014445394    3.2258307e-12  0              3.1152764e-07 -4.5            0              2.5975729    
   1900000   4500           200            200            0.0064203529   0.0048156685   0              0.01444539     1.9032749e-17  0              1.8380466e-12 -4.5            0              2.5975729    
   2000000   4500           200            200            0.0064203535   0.0048156686   0              0.014445392    5.7436378e-14  0              5.5467943e-09 -4.5            0              2.5975729    
   2100000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    1.6079551e-14  0              1.5528479e-09 -4.5            0              2.5975729    
   2200000   4500           200            200            0.0064203534   0.0048156686   0              0.014445391    1.3087962e-15  0              1.2639417e-10 -4.5            0              2.5975729    
   2300000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    2.8404753e-17  0              2.7431278e-12 -4.5            0              2.5975729    
   2400000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    3.4054885e-17  0              3.288777e-12  -4.5            0              2.5975729    
   2500000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    5.2100293e-18  0              5.0314734e-13 -4.5            0              2.5975729    
   2600000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    1.0961751e-18  0              1.0586074e-13 -4.5            0              2.5975729    
   2700000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    1.9025178e-22  0              1.8373156e-17 -4.5            0              2.5975729    
   2800000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    2.0112079e-20  0              1.9422807e-15 -4.5            0              2.5975729    
   2900000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    1.5809391e-21  0              1.5267578e-16 -4.5            0              2.5975729    
   3000000   4500           200            200            0.0064203534   0.0048156686   0              0.014445392    4.8989722e-23  0              4.7310767e-18 -4.5            0              2.5975729    
Loop time of 421.241 on 4 procs for 3000000 steps with 2501 atoms

Performance: 6153250.172 ns/day, 0.000 hours/ns, 7121.817 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.076     | 158.38     | 222.56     | 503.0 | 37.60
Neigh   | 2.7833     | 2.8073     | 2.831      |   1.1 |  0.67
Comm    | 27.316     | 90.814     | 154.03     | 657.8 | 21.56
Output  | 0.20805    | 0.20823    | 0.20849    |   0.0 |  0.05
Modify  | 114.23     | 131.71     | 149.17     | 151.6 | 31.27
Other   |            | 37.32      |            |       |  8.86

Nlocal:         625.25 ave         750 max         499 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         1125.5 ave        1500 max         747 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 4502
Ave neighs/atom = 1.80008
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -2475 ${n1e1} -100 100 -100 100 units box
region box block -2475 2475 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2475 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2475 2475 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-2475 -100 -100) to (2475 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1650 atoms
  using lattice units in orthogonal box = (-2475 -100 -100) to (2475 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1650 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1650 1650 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1101 atoms
  using lattice units in orthogonal box = (-2475 -100 -100) to (2475 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1650 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1650 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1101 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1101 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1650 atoms in group substrate
group slider1 region slider1
1101 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1101 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3194 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.68 | 68.71 | 68.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4950           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   4950           200            200            0.0036076582   1.0058226e-17  0              0.010822975    481942.08      0              4.2311379e+10 -4.5            0              3.2450632    
    200000   4950           200            200            0.00068824086  2.7518283e-17  0              0.0020647226   46307.081      0              4.0654604e+09 -4.5            0              2.80791      
    300000   4950           200            200           -8.5516979e-05  5.3967175e-17  0             -0.00025655094  1498.5344      0              1.3156157e+08 -4.5            0              2.6521028    
    400000   4950           200            200            0.0002747238   8.0625206e-17  0              0.00082417141  10825.967      0              9.5044945e+08 -4.5            0              2.5999354    
    500000   4950           200            200            0.0085917168   0.0066289295   0              0.019146221    1899.4043      0              1.6675534e+08 -4.5            0              2.5974604    
    600000   4950           200            200            0.0096373106   0.0073641323   0              0.021547799    22.457301      0              1971604.9     -4.5            0              2.5974158    
    700000   4950           200            200            0.0064756627   0.0048227038   0              0.014604284    0.019740505    0              1733.0879     -4.5            0              2.59757      
    800000   4950           200            200            0.006419443    0.0048152506   0              0.014443079    0.0049381015   0              433.53318     -4.5            0              2.5975729    
    900000   4950           200            200            0.0064126398   0.0048143737   0              0.014423546    0.00035695257  0              31.338113     -4.5            0              2.5975733    
   1000000   4950           200            200            0.0064236434   0.0048158259   0              0.014455104    6.5361507e-07  0              0.05738315    -4.5            0              2.5975727    
   1100000   4950           200            200            0.0064186979   0.0048151709   0              0.014440923    4.2043851e-06  0              0.36911765    -4.5            0              2.597573     
   1200000   4950           200            200            0.0064198789   0.0048153282   0              0.014444309    1.4266635e-06  0              0.12525177    -4.5            0              2.5975729    
   1300000   4950           200            200            0.006419901    0.0048153307   0              0.014444372    1.3315165e-07  0              0.011689849   -4.5            0              2.5975729    
   1400000   4950           200            200            0.0064197343   0.0048153087   0              0.014443894    1.3649142e-09  0              0.00011983058 -4.5            0              2.5975729    
   1500000   4950           200            200            0.0064198199   0.0048153201   0              0.01444414     7.9939399e-10  0              7.0181591e-05 -4.5            0              2.5975729    
   1600000   4950           200            200            0.0064197963   0.0048153169   0              0.014444072    3.9423896e-10  0              3.4611615e-05 -4.5            0              2.5975729    
   1700000   4950           200            200            0.0064197976   0.0048153171   0              0.014444076    4.6618457e-11  0              4.0927972e-06 -4.5            0              2.5975729    
   1800000   4950           200            200            0.0064198      0.0048153174   0              0.014444083    1.035901e-12   0              9.0945365e-08 -4.5            0              2.5975729    
   1900000   4950           200            200            0.0064197986   0.0048153172   0              0.014444079    1.2624925e-13  0              1.1083863e-08 -4.5            0              2.5975729    
   2000000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     1.0386471e-13  0              9.1186453e-09 -4.5            0              2.5975729    
   2100000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     1.5461678e-14  0              1.3574348e-09 -4.5            0              2.5975729    
   2200000   4950           200            200            0.0064197989   0.0048153173   0              0.01444408     5.9112901e-16  0              5.189728e-11  -4.5            0              2.5975729    
   2300000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     6.4055033e-18  0              5.6236151e-13 -4.5            0              2.5975729    
   2400000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     3.7878704e-17  0              3.3255038e-12 -4.5            0              2.5975729    
   2500000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     1.5466932e-18  0              1.357896e-13  -4.5            0              2.5975729    
   2600000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     9.0049692e-19  0              7.905777e-14  -4.5            0              2.5975729    
   2700000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     1.5596742e-19  0              1.3692924e-14 -4.5            0              2.5975729    
   2800000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     7.8776057e-23  0              6.9160252e-18 -4.5            0              2.5975729    
   2900000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     2.9620537e-21  0              2.6004904e-16 -4.5            0              2.5975729    
   3000000   4950           200            200            0.006419799    0.0048153173   0              0.01444408     2.1795271e-22  0              1.913483e-17  -4.5            0              2.5975729    
Loop time of 454 on 4 procs for 3000000 steps with 2751 atoms

Performance: 5709245.107 ns/day, 0.000 hours/ns, 6607.923 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.18     | 170.22     | 240.59     | 496.7 | 37.49
Neigh   | 3.0678     | 3.0922     | 3.1161     |   1.1 |  0.68
Comm    | 27.617     | 94.741     | 164.97     | 645.3 | 20.87
Output  | 0.22165    | 0.22185    | 0.22211    |   0.0 |  0.05
Modify  | 119.32     | 143.68     | 163.47     | 155.6 | 31.65
Other   |            | 42.05      |            |       |  9.26

Nlocal:         687.75 ave         825 max         549 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           1238 ave        1651 max         821 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 4952
Ave neighs/atom = 1.8000727
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -2700 ${n1e1} -100 100 -100 100 units box
region box block -2700 2700 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2700 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2700 2700 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-2700 -100 -100) to (2700 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1800 atoms
  using lattice units in orthogonal box = (-2700 -100 -100) to (2700 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1800 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1800 1800 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1201 atoms
  using lattice units in orthogonal box = (-2700 -100 -100) to (2700 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1800 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1800 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1201 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1201 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1800 atoms in group substrate
group slider1 region slider1
1201 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
3001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1201 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3484 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 73.75 | 73.75 | 73.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   5400           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   5400           200            200            0.003607454    3.684313e-17   0              0.010822362    525740.65      0              4.2310224e+10 -4.5            0              3.2449687    
    200000   5400           200            200            0.00068902816  1.009757e-16   0              0.0020670845   50616.493      0              4.0734822e+09 -4.5            0              2.8077771    
    300000   5400           200            200           -8.404804e-05   1.9729119e-16  0             -0.00025214412  1575.7139      0              1.268093e+08  -4.5            0              2.6521349    
    400000   5400           200            200            0.00027871209  2.9530479e-16  0              0.00083613627  12116.935      0              9.7513904e+08 -4.5            0              2.5996591    
    500000   5400           200            200            0.0044758648   0.003487026    0              0.0099405684   2067.8663      0              1.6641644e+08 -4.5            0              2.5976749    
    600000   5400           200            200            0.0087871023   0.0067178362   0              0.019643471    44.163285      0              3554145       -4.5            0              2.597455     
    700000   5400           200            200            0.0064506479   0.0048190893   0              0.014532854    0.03463207     0              2787.0978     -4.5            0              2.5975712    
    800000   5400           200            200            0.0064292901   0.0048162083   0              0.014471662    0.0047297845   0              380.64061     -4.5            0              2.5975724    
    900000   5400           200            200            0.006409872    0.0048136584   0              0.014415958    0.00014679784  0              11.813904     -4.5            0              2.5975734    
   1000000   5400           200            200            0.0064229841   0.0048153934   0              0.014453559    6.6276838e-06  0              0.53337855    -4.5            0              2.5975727    
   1100000   5400           200            200            0.0064185762   0.0048148084   0              0.01444092     8.7036009e-06  0              0.70044289    -4.5            0              2.5975729    
   1200000   5400           200            200            0.0064191966   0.0048148917   0              0.014442698    1.5052888e-06  0              0.12114168    -4.5            0              2.5975729    
   1300000   5400           200            200            0.0064194445   0.0048149241   0              0.014443409    6.9835543e-08  0              0.0056201807  -4.5            0              2.5975729    
   1400000   5400           200            200            0.006419232    0.0048148961   0              0.0144428      4.19152e-10    0              3.373225e-05  -4.5            0              2.5975729    
   1500000   5400           200            200            0.0064193122   0.0048149067   0              0.01444303     2.0640469e-09  0              0.00016610906 -4.5            0              2.5975729    
   1600000   5400           200            200            0.0064192975   0.0048149047   0              0.014442988    4.5805214e-10  0              3.6862831e-05 -4.5            0              2.5975729    
   1700000   5400           200            200            0.0064192948   0.0048149044   0              0.01444298     2.9147244e-11  0              2.3456935e-06 -4.5            0              2.5975729    
   1800000   5400           200            200            0.0064192981   0.0048149048   0              0.01444299     3.7149653e-15  0              2.9897063e-10 -4.5            0              2.5975729    
   1900000   5400           200            200            0.0064192967   0.0048149046   0              0.014442985    4.5387461e-13  0              3.6526634e-08 -4.5            0              2.5975729    
   2000000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    1.3335328e-13  0              1.0731921e-08 -4.5            0              2.5975729    
   2100000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    1.1012081e-14  0              8.8622327e-10 -4.5            0              2.5975729    
   2200000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    5.6929455e-17  0              4.5815328e-12 -4.5            0              2.5975729    
   2300000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    1.0353814e-16  0              8.3324773e-12 -4.5            0              2.5975729    
   2400000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    1.8902759e-17  0              1.5212443e-12 -4.5            0              2.5975729    
   2500000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    1.0998313e-19  0              8.851153e-15  -4.5            0              2.5975729    
   2600000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    1.4253392e-18  0              1.1470755e-13 -4.5            0              2.5975729    
   2700000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    3.2009549e-20  0              2.5760443e-15 -4.5            0              2.5975729    
   2800000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    1.0798457e-20  0              8.6903137e-16 -4.5            0              2.5975729    
   2900000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    2.8940554e-21  0              2.3290596e-16 -4.5            0              2.5975729    
   3000000   5400           200            200            0.006419297    0.0048149047   0              0.014442986    4.5280561e-24  0              3.6440604e-19 -4.5            0              2.5975729    
Loop time of 493.733 on 4 procs for 3000000 steps with 3001 atoms

Performance: 5249802.295 ns/day, 0.000 hours/ns, 6076.160 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.43     | 188.65     | 266.63     | 516.5 | 38.21
Neigh   | 3.3417     | 3.3682     | 3.3942     |   1.1 |  0.68
Comm    | 28.348     | 102.17     | 180.17     | 675.6 | 20.69
Output  | 0.23479    | 0.23502    | 0.23532    |   0.0 |  0.05
Modify  | 128.14     | 154.94     | 174.31     | 157.7 | 31.38
Other   |            | 44.36      |            |       |  8.98

Nlocal:         750.25 ave         900 max         599 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         1350.5 ave        1800 max         897 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5402
Ave neighs/atom = 1.8000666
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -2925 ${n1e1} -100 100 -100 100 units box
region box block -2925 2925 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2925 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -2925 2925 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-2925 -100 -100) to (2925 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1950 atoms
  using lattice units in orthogonal box = (-2925 -100 -100) to (2925 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1950 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1950 1950 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1301 atoms
  using lattice units in orthogonal box = (-2925 -100 -100) to (2925 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1950 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1950 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1301 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1301 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1950 atoms in group substrate
group slider1 region slider1
1301 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
3251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1301 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3775 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.83 | 78.83 | 78.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   5850           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   5850           200            200            0.0036072917   8.4916922e-18  0              0.010821875    569543.46      0              4.2309562e+10 -4.5            0              3.2448742    
    200000   5850           200            200            0.00068982369  2.3295234e-17  0              0.0020694711   54943.265      0              4.0815595e+09 -4.5            0              2.8076441    
    300000   5850           200            200           -8.2575989e-05  4.5577391e-17  0             -0.00024772797  1644.2144      0              1.2214343e+08 -4.5            0              2.6521661    
    400000   5850           200            200            0.00028271315  6.8122491e-17  0              0.00084813945  13463.332      0              1.0001479e+09 -4.5            0              2.5993792    
    500000   5850           200            200            0.0014101766   0.0011449226   0              0.0030856071   2082.796       0              1.5472425e+08 -4.5            0              2.5978851    
    600000   5850           200            200            0.0077750813   0.0059470662   0              0.017378178    65.165303      0              4840921.9     -4.5            0              2.5975034    
    700000   5850           200            200            0.0064218459   0.0048149182   0              0.014450619    0.043901829    0              3261.3264     -4.5            0              2.5975727    
    800000   5850           200            200            0.0064378158   0.0048169602   0              0.014496487    0.0033235964   0              246.89935     -4.5            0              2.5975719    
    900000   5850           200            200            0.0064083829   0.004813082    0              0.014412067    1.0036609e-05  0              0.74558758    -4.5            0              2.5975735    
   1000000   5850           200            200            0.006421905    0.0048148748   0              0.01445084     3.4141946e-05  0              2.536296      -4.5            0              2.5975727    
   1100000   5850           200            200            0.0064185875   0.0048144333   0              0.014441329    1.2294287e-05  0              0.91330327    -4.5            0              2.5975729    
   1200000   5850           200            200            0.0064185789   0.0048144333   0              0.014441303    1.196067e-06   0              0.088851995   -4.5            0              2.5975729    
   1300000   5850           200            200            0.0064190163   0.004814491    0              0.014442558    1.4734637e-08  0              0.0010945891  -4.5            0              2.5975729    
   1400000   5850           200            200            0.0064187859   0.0048144604   0              0.014441897    6.1548528e-09  0              0.00045722433 -4.5            0              2.5975729    
   1500000   5850           200            200            0.0064188508   0.0048144691   0              0.014442083    3.2911208e-09  0              0.00024448684 -4.5            0              2.5975729    
   1600000   5850           200            200            0.0064188465   0.0048144685   0              0.014442071    4.052533e-10   0              3.0104971e-05 -4.5            0              2.5975729    
   1700000   5850           200            200            0.0064188403   0.0048144677   0              0.014442053    1.0050896e-11  0              7.4664892e-07 -4.5            0              2.5975729    
   1800000   5850           200            200            0.0064188442   0.0048144682   0              0.014442064    9.0007496e-13  0              6.686369e-08  -4.5            0              2.5975729    
   1900000   5850           200            200            0.0064188429   0.004814468    0              0.014442061    8.3745326e-13  0              6.2211724e-08 -4.5            0              2.5975729    
   2000000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    1.3000354e-13  0              9.6575471e-09 -4.5            0              2.5975729    
   2100000   5850           200            200            0.0064188432   0.0048144681   0              0.014442061    5.3481004e-15  0              3.9729327e-10 -4.5            0              2.5975729    
   2200000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    8.3671045e-17  0              6.2156543e-12 -4.5            0              2.5975729    
   2300000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    2.3866714e-16  0              1.7729819e-11 -4.5            0              2.5975729    
   2400000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    1.5687268e-19  0              1.165357e-14  -4.5            0              2.5975729    
   2500000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    1.0003149e-18  0              7.4310195e-14 -4.5            0              2.5975729    
   2600000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    6.9255656e-20  0              5.1447812e-15 -4.5            0              2.5975729    
   2700000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    1.7435049e-19  0              1.2951941e-14 -4.5            0              2.5975729    
   2800000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    7.6592383e-21  0              5.6898032e-16 -4.5            0              2.5975729    
   2900000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    8.3792979e-22  0              6.2247125e-17 -4.5            0              2.5975729    
   3000000   5850           200            200            0.0064188431   0.004814468    0              0.014442061    3.9424897e-22  0              2.9287495e-17 -4.5            0              2.5975729    
Loop time of 532.851 on 4 procs for 3000000 steps with 3251 atoms

Performance: 4864395.338 ns/day, 0.000 hours/ns, 5630.087 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 121.95     | 203.59     | 292.14     | 567.5 | 38.21
Neigh   | 3.6185     | 3.647      | 3.675      |   1.2 |  0.68
Comm    | 29.191     | 113.14     | 197.68     | 730.5 | 21.23
Output  | 0.24528    | 0.2455     | 0.24579    |   0.0 |  0.05
Modify  | 138.28     | 166.26     | 186.67     | 157.7 | 31.20
Other   |            | 45.98      |            |       |  8.63

Nlocal:         812.75 ave         975 max         649 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           1463 ave        1951 max         971 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 5852
Ave neighs/atom = 1.8000615
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3150 ${n1e1} -100 100 -100 100 units box
region box block -3150 3150 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3150 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3150 3150 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3150 -100 -100) to (3150 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2100 atoms
  using lattice units in orthogonal box = (-3150 -100 -100) to (3150 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2100 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2100 2100 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1401 atoms
  using lattice units in orthogonal box = (-3150 -100 -100) to (3150 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2100 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2100 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1401 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1401 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
2100 atoms in group substrate
group slider1 region slider1
1401 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
3501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1401 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4065 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.91 | 83.91 | 83.92 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6300           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   6300           200            200            0.0036071624  -1.8273426e-18  0              0.010821487    613350.5       0              4.2309287e+10 -4.5            0              3.2447797    
    200000   6300           200            200            0.00069062613 -5.001214e-18   0              0.0020718784   59287.482      0              4.0896862e+09 -4.5            0              2.807511     
    300000   6300           200            200           -8.1102052e-05 -9.7765328e-18  0             -0.00024330616  1704.3662      0              1.175682e+08  -4.5            0              2.6521964    
    400000   6300           200            200            0.00028672671 -1.4596025e-17  0              0.00086018014  14866.152      0              1.0254761e+09 -4.5            0              2.5990957    
    500000   6300           200            200           -8.5134696e-05 -2.4624942e-17  0             -0.00025540409  1979.4381      0              1.3654283e+08 -4.5            0              2.5980849    
    600000   6300           200            200            0.0067078816   0.0051331436   0              0.014990501    78.744093      0              5431814.9     -4.5            0              2.5975569    
    700000   6300           200            200            0.0063929511   0.0048107458   0              0.014368108    0.042423941    0              2926.4289     -4.5            0              2.5975742    
    800000   6300           200            200            0.0064438987   0.0048174331   0              0.014514263    0.0014338169   0              98.905552     -4.5            0              2.5975716    
    900000   6300           200            200            0.0064082987   0.0048127353   0              0.014412161    4.6391204e-05  0              3.2000932     -4.5            0              2.5975734    
   1000000   6300           200            200            0.0064205072   0.0048143571   0              0.014447164    7.2708699e-05  0              5.0154898     -4.5            0              2.5975728    
   1100000   6300           200            200            0.0064186842   0.0048141129   0              0.01444194     1.3112336e-05  0              0.90449683    -4.5            0              2.5975729    
   1200000   6300           200            200            0.0064180592   0.0048140312   0              0.014440146    6.4762279e-07  0              0.04467341    -4.5            0              2.5975729    
   1300000   6300           200            200            0.0064186268   0.0048141062   0              0.014441774    2.0935869e-09  0              0.00014441689 -4.5            0              2.5975729    
   1400000   6300           200            200            0.0064184081   0.0048140772   0              0.014441147    1.661632e-08   0              0.0011462038  -4.5            0              2.5975729    
   1500000   6300           200            200            0.0064184498   0.0048140828   0              0.014441267    3.8677221e-09  0              0.0002667978  -4.5            0              2.5975729    
   1600000   6300           200            200            0.0064184562   0.0048140836   0              0.014441285    2.5927593e-10  0              1.7885009e-05 -4.5            0              2.5975729    
   1700000   6300           200            200            0.0064184474   0.0048140824   0              0.01444126     1.7699193e-13  0              1.220901e-08  -4.5            0              2.5975729    
   1800000   6300           200            200            0.0064184512   0.0048140829   0              0.014441271    3.5093354e-12  0              2.4207607e-07 -4.5            0              2.5975729    
   1900000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    1.0911655e-12  0              7.5269249e-08 -4.5            0              2.5975729    
   2000000   6300           200            200            0.0064184503   0.0048140828   0              0.014441268    9.5373578e-14  0              6.5789268e-09 -4.5            0              2.5975729    
   2100000   6300           200            200            0.0064184505   0.0048140828   0              0.014441269    7.5814819e-16  0              5.2297518e-11 -4.5            0              2.5975729    
   2200000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    7.4672977e-16  0              5.1509869e-11 -4.5            0              2.5975729    
   2300000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    3.1477336e-16  0              2.1713256e-11 -4.5            0              2.5975729    
   2400000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    2.8772189e-17  0              1.9847229e-12 -4.5            0              2.5975729    
   2500000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    1.1727704e-22  0              8.0898408e-18 -4.5            0              2.5975729    
   2600000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    8.5886166e-19  0              5.9244794e-14 -4.5            0              2.5975729    
   2700000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    1.525258e-19   0              1.0521321e-14 -4.5            0              2.5975729    
   2800000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    4.6531928e-23  0              3.2098004e-18 -4.5            0              2.5975729    
   2900000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    2.7888395e-21  0              1.9237582e-16 -4.5            0              2.5975729    
   3000000   6300           200            200            0.0064184504   0.0048140828   0              0.014441268    2.099845e-22   0              1.4484857e-17 -4.5            0              2.5975729    
Loop time of 547.766 on 4 procs for 3000000 steps with 3501 atoms

Performance: 4731944.706 ns/day, 0.000 hours/ns, 5476.788 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 121.69     | 203.67     | 286.9      | 566.4 | 37.18
Neigh   | 3.8846     | 3.916      | 3.9457     |   1.2 |  0.71
Comm    | 31.021     | 112.4      | 194.51     | 741.3 | 20.52
Output  | 0.26131    | 0.26153    | 0.26181    |   0.0 |  0.05
Modify  | 154.63     | 178.46     | 200.62     | 164.4 | 32.58
Other   |            | 49.06      |            |       |  8.96

Nlocal:         875.25 ave        1050 max         699 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         1575.5 ave        2100 max        1047 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 6302
Ave neighs/atom = 1.8000571
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3375 ${n1e1} -100 100 -100 100 units box
region box block -3375 3375 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3375 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3375 3375 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3375 -100 -100) to (3375 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2250 atoms
  using lattice units in orthogonal box = (-3375 -100 -100) to (3375 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2250 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2250 2250 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1501 atoms
  using lattice units in orthogonal box = (-3375 -100 -100) to (3375 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2250 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2250 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
2250 atoms in group substrate
group slider1 region slider1
1501 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
3751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4355 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 88.92 | 88.93 | 88.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6750           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   6750           200            200            0.0036070595   1.3604792e-16  0              0.010821178    657161.78      0              4.2309321e+10 -4.5            0              3.2446852    
    200000   6750           200            200            0.00069143423  3.7250136e-16  0              0.0020743027   63649.178      0              4.0978547e+09 -4.5            0              2.8073776    
    300000   6750           200            200           -7.9625962e-05  7.2816102e-16  0             -0.00023887789  1756.4395      0              1.1308291e+08 -4.5            0              2.6522259    
    400000   6750           200            200            0.00029074765  1.087456e-15   0              0.00087224296  16325.898      0              1.0510922e+09 -4.5            0              2.598809     
    500000   6750           200            200           -7.9497752e-05  1.8333651e-15  0             -0.00023849326  1832.8737      0              1.1800388e+08 -4.5            0              2.5982712    
    600000   6750           200            200            0.0056830616   0.0043505489   0              0.012698636    80.491341      0              5182185.1     -4.5            0              2.5976111    
    700000   6750           200            200            0.0063675765   0.0048070485   0              0.014295681    0.030362108    0              1954.77       -4.5            0              2.5975755    
    800000   6750           200            200            0.0064467262   0.0048175133   0              0.014522665    0.00013624798  0              8.7719031     -4.5            0              2.5975714    
    900000   6750           200            200            0.0064095502   0.0048126016   0              0.014416049    0.00027166682  0              17.490425     -4.5            0              2.5975734    
   1000000   6750           200            200            0.0064189124   0.0048138486   0              0.014442889    0.00010440441  0              6.7217539     -4.5            0              2.5975729    
   1100000   6750           200            200            0.0064187919   0.0048138296   0              0.014442546    1.0596902e-05  0              0.6822486     -4.5            0              2.5975729    
   1200000   6750           200            200            0.0064176408   0.004813678    0              0.014439244    1.5424154e-07  0              0.0099303628  -4.5            0              2.5975729    
   1300000   6750           200            200            0.0064182642   0.0048137605   0              0.014441032    4.624804e-08   0              0.0029775364  -4.5            0              2.5975729    
   1400000   6750           200            200            0.0064180844   0.0048137366   0              0.014440517    2.7059008e-08  0              0.0017421102  -4.5            0              2.5975729    
   1500000   6750           200            200            0.0064180984   0.0048137385   0              0.014440557    3.4738433e-09  0              0.00022365261 -4.5            0              2.5975729    
   1600000   6750           200            200            0.0064181144   0.0048137406   0              0.014440603    9.5493198e-11  0              6.1480331e-06 -4.5            0              2.5975729    
   1700000   6750           200            200            0.0064181041   0.0048137393   0              0.014440573    6.1989023e-12  0              3.9909707e-07 -4.5            0              2.5975729    
   1800000   6750           200            200            0.0064181075   0.0048137397   0              0.014440583    6.6733427e-12  0              4.2964245e-07 -4.5            0              2.5975729    
   1900000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    1.0813026e-12  0              6.9616311e-08 -4.5            0              2.5975729    
   2000000   6750           200            200            0.0064181068   0.0048137396   0              0.014440581    4.6083565e-14  0              2.9669473e-09 -4.5            0              2.5975729    
   2100000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    4.5534997e-16  0              2.9316294e-11 -4.5            0              2.5975729    
   2200000   6750           200            200            0.0064181069   0.0048137396   0              0.014440581    1.5609113e-15  0              1.0049443e-10 -4.5            0              2.5975729    
   2300000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    2.6073686e-16  0              1.6786733e-11 -4.5            0              2.5975729    
   2400000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    3.7224018e-17  0              2.3965528e-12 -4.5            0              2.5975729    
   2500000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    1.8843598e-18  0              1.2131865e-13 -4.5            0              2.5975729    
   2600000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    6.4950799e-19  0              4.1816555e-14 -4.5            0              2.5975729    
   2700000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    1.7013532e-19  0              1.0953634e-14 -4.5            0              2.5975729    
   2800000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    2.3619724e-22  0              1.5206826e-17 -4.5            0              2.5975729    
   2900000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    2.406361e-21   0              1.5492608e-16 -4.5            0              2.5975729    
   3000000   6750           200            200            0.006418107    0.0048137396   0              0.014440581    2.6420029e-22  0              1.7009715e-17 -4.5            0              2.5975729    
Loop time of 561.239 on 4 procs for 3000000 steps with 3751 atoms

Performance: 4618349.485 ns/day, 0.000 hours/ns, 5345.312 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 127.17     | 209.12     | 291.16     | 561.5 | 37.26
Neigh   | 4.1537     | 4.1833     | 4.2117     |   1.1 |  0.75
Comm    | 29.36      | 110.81     | 193.57     | 769.4 | 19.74
Output  | 0.26811    | 0.26834    | 0.26861    |   0.0 |  0.05
Modify  | 158.67     | 185.29     | 211.1      | 187.6 | 33.02
Other   |            | 51.56      |            |       |  9.19

Nlocal:         937.75 ave        1125 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           1688 ave        2251 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 6752
Ave neighs/atom = 1.8000533
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3600 ${n1e1} -100 100 -100 100 units box
region box block -3600 3600 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3600 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3600 3600 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3600 -100 -100) to (3600 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2400 atoms
  using lattice units in orthogonal box = (-3600 -100 -100) to (3600 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2400 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2400 2400 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1601 atoms
  using lattice units in orthogonal box = (-3600 -100 -100) to (3600 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2400 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2400 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1601 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1601 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
2400 atoms in group substrate
group slider1 region slider1
1601 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
4001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1601 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4646 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.94 | 93.97 | 94 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7200           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   7200           200            200            0.003606978    7.9534817e-18  0              0.010820934    700977.3       0              4.2309607e+10 -4.5            0              3.2445907    
    200000   7200           200            200            0.00069224662  2.1819257e-17  0              0.0020767398   68028.324      0              4.1060554e+09 -4.5            0              2.8072441    
    300000   7200           200            200           -7.8145964e-05  4.2710091e-17  0             -0.00023443789  1800.6291      0              1.0868242e+08 -4.5            0              2.6522545    
    400000   7200           200            200            0.00029477945  6.3761985e-17  0              0.00088433835  17843.84       0              1.0770189e+09 -4.5            0              2.5985187    
    500000   7200           200            200           -7.3817471e-05  1.0723034e-16  0             -0.00022145241  1670.7604      0              1.008438e+08  -4.5            0              2.5984437    
    600000   7200           200            200            0.0047777193   0.0036582134   0              0.010674945    69.82786       0              4214671.8     -4.5            0              2.5976619    
    700000   7200           200            200            0.0063488456   0.0048042508   0              0.014242286    0.013718359    0              828.01306     -4.5            0              2.5975765    
    800000   7200           200            200            0.0064459194   0.0048171455   0              0.014520613    0.00031144637  0              18.798288     -4.5            0              2.5975714    
    900000   7200           200            200            0.0064119093   0.0048126451   0              0.014423083    0.00059969649  0              36.196496     -4.5            0              2.5975732    
   1000000   7200           200            200            0.0064172743   0.0048133638   0              0.014438459    0.00011302634  0              6.8220467     -4.5            0              2.5975729    
   1100000   7200           200            200            0.0064188455   0.0048135689   0              0.014442968    5.9353852e-06  0              0.35824814    -4.5            0              2.5975729    
   1200000   7200           200            200            0.0064173231   0.0048133679   0              0.014438601    8.3189292e-09  0              0.00050211415 -4.5            0              2.5975729    
   1300000   7200           200            200            0.0064179225   0.0048134474   0              0.01444032     1.3200294e-07  0              0.007967437   -4.5            0              2.5975729    
   1400000   7200           200            200            0.0064178035   0.0048134315   0              0.014439979    3.2311892e-08  0              0.001950282   -4.5            0              2.5975729    
   1500000   7200           200            200            0.0064177887   0.0048134296   0              0.014439936    2.2810372e-09  0              0.0001376789  -4.5            0              2.5975729    
   1600000   7200           200            200            0.0064178119   0.0048134326   0              0.014440003    3.6926603e-12  0              2.2288169e-07 -4.5            0              2.5975729    
   1700000   7200           200            200            0.0064178016   0.0048134313   0              0.014439973    2.6698842e-11  0              1.6114894e-06 -4.5            0              2.5975729    
   1800000   7200           200            200            0.006417804    0.0048134316   0              0.01443998     8.8443627e-12  0              5.3382828e-07 -4.5            0              2.5975729    
   1900000   7200           200            200            0.0064178041   0.0048134316   0              0.014439981    8.0782854e-13  0              4.8758936e-08 -4.5            0              2.5975729    
   2000000   7200           200            200            0.0064178037   0.0048134316   0              0.01443998     8.0764228e-15  0              4.8747694e-10 -4.5            0              2.5975729    
   2100000   7200           200            200            0.0064178039   0.0048134316   0              0.01443998     4.6353794e-15  0              2.7978235e-10 -4.5            0              2.5975729    
   2200000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     2.2565253e-15  0              1.3619942e-10 -4.5            0              2.5975729    
   2300000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     1.3524994e-16  0              8.1634194e-12 -4.5            0              2.5975729    
   2400000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     1.3493951e-17  0              8.1446825e-13 -4.5            0              2.5975729    
   2500000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     6.6695188e-18  0              4.0255899e-13 -4.5            0              2.5975729    
   2600000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     1.2416643e-18  0              7.4944406e-14 -4.5            0              2.5975729    
   2700000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     1.1472866e-22  0              6.9247955e-18 -4.5            0              2.5975729    
   2800000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     2.1695406e-20  0              1.3094919e-15 -4.5            0              2.5975729    
   2900000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     1.7112893e-21  0              1.0329005e-16 -4.5            0              2.5975729    
   3000000   7200           200            200            0.0064178038   0.0048134316   0              0.01443998     4.9694831e-23  0              2.9994819e-18 -4.5            0              2.5975729    
Loop time of 596.932 on 4 procs for 3000000 steps with 4001 atoms

Performance: 4342199.497 ns/day, 0.000 hours/ns, 5025.694 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 135.25     | 222.92     | 310.18     | 581.5 | 37.34
Neigh   | 4.4649     | 4.4972     | 4.5288     |   1.2 |  0.75
Comm    | 30.245     | 117.1      | 205.49     | 801.1 | 19.62
Output  | 0.27994    | 0.28021    | 0.2805     |   0.0 |  0.05
Modify  | 167.7      | 196.64     | 225.74     | 196.1 | 32.94
Other   |            | 55.49      |            |       |  9.30

Nlocal:        1000.25 ave        1200 max         799 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         1800.5 ave        2400 max        1197 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 7202
Ave neighs/atom = 1.80005
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3825 ${n1e1} -100 100 -100 100 units box
region box block -3825 3825 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3825 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3825 3825 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3825 -100 -100) to (3825 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2550 atoms
  using lattice units in orthogonal box = (-3825 -100 -100) to (3825 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2550 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2550 2550 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1701 atoms
  using lattice units in orthogonal box = (-3825 -100 -100) to (3825 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2550 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2550 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1701 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1701 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
2550 atoms in group substrate
group slider1 region slider1
1701 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
4251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1701 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4936 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 99.01 | 99.02 | 99.02 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7650           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   7650           200            200            0.0036069143   1.4919207e-18  0              0.010820743    744797.06      0              4.2310099e+10 -4.5            0              3.2444962    
    200000   7650           200            200            0.00069306171  4.0950842e-18  0              0.0020791851   72424.793      0              4.1142754e+09 -4.5            0              2.8071106    
    300000   7650           200            200           -7.6664397e-05  8.0299792e-18  0             -0.00022999319  1837.3224      0              1.0437379e+08 -4.5            0              2.6522822    
    400000   7650           200            200            0.00029882436  1.1989644e-17  0              0.00089647308  19421.212      0              1.1032715e+09 -4.5            0              2.5982247    
    500000   7650           200            200           -6.8086996e-05  2.0205857e-17  0             -0.00020426099  1496.9362      0              85037286      -4.5            0              2.5986026    
    600000   7650           200            200            0.0040429914   0.0030953001   0              0.0090336741   50.053944      0              2843442.1     -4.5            0              2.5977055    
    700000   7650           200            200            0.0063390092   0.0048026657   0              0.014214362    0.001679899    0              95.430953     -4.5            0              2.597577     
    800000   7650           200            200            0.0064415689   0.004816336    0              0.014508371    0.0021384023   0              121.4774      -4.5            0              2.5975717    
    900000   7650           200            200            0.0064150215   0.0048128141   0              0.014432251    0.00087914487  0              49.94207      -4.5            0              2.597573     
   1000000   7650           200            200            0.0064157551   0.0048129196   0              0.014434346    9.3106586e-05  0              5.2891574     -4.5            0              2.597573     
   1100000   7650           200            200            0.0064187949   0.0048133198   0              0.014443065    1.574353e-06   0              0.089435145   -4.5            0              2.5975728    
   1200000   7650           200            200            0.0064171      0.0048130956   0              0.014438204    3.4160652e-07  0              0.019405831   -4.5            0              2.5975729    
   1300000   7650           200            200            0.0064176002   0.004813162    0              0.014439638    2.2056292e-07  0              0.01252964    -4.5            0              2.5975729    
   1400000   7650           200            200            0.0064175555   0.004813156    0              0.014439511    2.9537378e-08  0              0.0016779462  -4.5            0              2.5975729    
   1500000   7650           200            200            0.0064175145   0.0048131506   0              0.014439393    8.9365841e-10  0              5.0766549e-05 -4.5            0              2.5975729    
   1600000   7650           200            200            0.0064175418   0.0048131542   0              0.014439471    4.1441984e-11  0              2.3542178e-06 -4.5            0              2.5975729    
   1700000   7650           200            200            0.0064175327   0.004813153    0              0.014439445    5.2509138e-11  0              2.9829157e-06 -4.5            0              2.5975729    
   1800000   7650           200            200            0.006417534    0.0048131532   0              0.014439449    8.9097406e-12  0              5.0614057e-07 -4.5            0              2.5975729    
   1900000   7650           200            200            0.0064175345   0.0048131532   0              0.01443945     4.0581572e-13  0              2.3053398e-08 -4.5            0              2.5975729    
   2000000   7650           200            200            0.0064175341   0.0048131532   0              0.014439449    2.4316099e-15  0              1.3813381e-10 -4.5            0              2.5975729    
   2100000   7650           200            200            0.0064175342   0.0048131532   0              0.01443945     1.1693372e-14  0              6.6427185e-10 -4.5            0              2.5975729    
   2200000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    2.5452645e-15  0              1.4459025e-10 -4.5            0              2.5975729    
   2300000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    9.3794689e-17  0              5.3282469e-12 -4.5            0              2.5975729    
   2400000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    1.4760476e-17  0              8.3850653e-13 -4.5            0              2.5975729    
   2500000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    7.3302543e-18  0              4.1641382e-13 -4.5            0              2.5975729    
   2600000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    9.0810025e-20  0              5.1586954e-15 -4.5            0              2.5975729    
   2700000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    1.9068227e-19  0              1.0832193e-14 -4.5            0              2.5975729    
   2800000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    7.6828728e-21  0              4.3644521e-16 -4.5            0              2.5975729    
   2900000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    9.5749303e-22  0              5.4392837e-17 -4.5            0              2.5975729    
   3000000   7650           200            200            0.0064175342   0.0048131532   0              0.014439449    4.1117156e-22  0              2.335765e-17  -4.5            0              2.5975729    
Loop time of 633.445 on 4 procs for 3000000 steps with 4251 atoms

Performance: 4091910.062 ns/day, 0.000 hours/ns, 4736.007 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 144.52     | 238.14     | 332.72     | 601.6 | 37.59
Neigh   | 4.7331     | 4.7707     | 4.8072     |   1.4 |  0.75
Comm    | 31.129     | 124.43     | 219.43     | 827.5 | 19.64
Output  | 0.29512    | 0.29539    | 0.2957     |   0.0 |  0.05
Modify  | 177.19     | 207.94     | 236.36     | 196.5 | 32.83
Other   |            | 57.87      |            |       |  9.14

Nlocal:        1062.75 ave        1275 max         849 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           1913 ave        2551 max        1271 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 7652
Ave neighs/atom = 1.800047
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4050 ${n1e1} -100 100 -100 100 units box
region box block -4050 4050 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4050 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4050 4050 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4050 -100 -100) to (4050 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2700 atoms
  using lattice units in orthogonal box = (-4050 -100 -100) to (4050 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2700 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2700 2700 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1801 atoms
  using lattice units in orthogonal box = (-4050 -100 -100) to (4050 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2700 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2700 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1801 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1801 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
2700 atoms in group substrate
group slider1 region slider1
1801 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
4501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1801 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5226 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 104 | 104.1 | 104.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   8100           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   8100           200            200            0.0036068652   1.2043123e-16  0              0.010820596    788621.05      0              4.2310765e+10 -4.5            0              3.2444017    
    200000   8100           200            200            0.00069387931  3.2987617e-16  0              0.0020816379   76838.649      0              4.1225149e+09 -4.5            0              2.8069772    
    300000   8100           200            200           -7.5182358e-05  6.4383157e-16  0             -0.00022554707  1866.859       0              1.0015993e+08 -4.5            0              2.652309     
    400000   8100           200            200            0.0013338563   0.00076000708  0              0.0032415617   21040.134      0              1.1288364e+09 -4.5            0              2.5979279    
    500000   8100           200            200           -6.2323418e-05  1.6214361e-15  0             -0.00018697025  1316.3288      0              70623118      -4.5            0              2.5987476    
    600000   8100           200            200            0.00350824     0.0026843939   0              0.0078403263   27.308357      0              1465136.5     -4.5            0              2.5977391    
    700000   8100           200            200            0.0063392059   0.0048024538   0              0.014215164    0.0019909867   0              106.81958     -4.5            0              2.597577     
    800000   8100           200            200            0.0064342361   0.0048151532   0              0.014487555    0.0049160997   0              263.75651     -4.5            0              2.597572     
    900000   8100           200            200            0.0064184374   0.0048130453   0              0.014442267    0.0009687336   0              51.974087     -4.5            0              2.5975729    
   1000000   8100           200            200            0.0064145084   0.0048125329   0              0.014430992    5.3980659e-05  0              2.8961476     -4.5            0              2.5975731    
   1100000   8100           200            200            0.0064186092   0.0048130745   0              0.014442753    1.9944645e-08  0              0.0010700617  -4.5            0              2.5975728    
   1200000   8100           200            200            0.0064169587   0.0048128558   0              0.01443802     1.0397504e-06  0              0.055784251   -4.5            0              2.5975729    
   1300000   8100           200            200            0.0064172989   0.0048129011   0              0.014438996    2.6832748e-07  0              0.014396193   -4.5            0              2.5975729    
   1400000   8100           200            200            0.0064173324   0.0048129054   0              0.014439092    1.9929937e-08  0              0.0010692726  -4.5            0              2.5975729    
   1500000   8100           200            200            0.006417271    0.0048128973   0              0.014438916    5.7459148e-11  0              3.082774e-06  -4.5            0              2.5975729    
   1600000   8100           200            200            0.006417299    0.004812901    0              0.014438996    2.0103707e-10  0              1.0785956e-05 -4.5            0              2.5975729    
   1700000   8100           200            200            0.0064172922   0.0048129001   0              0.014438976    7.1108089e-11  0              3.8150612e-06 -4.5            0              2.5975729    
   1800000   8100           200            200            0.0064172921   0.0048129001   0              0.014438976    6.8068217e-12  0              3.6519673e-07 -4.5            0              2.5975729    
   1900000   8100           200            200            0.006417293    0.0048129002   0              0.014438979    8.1566641e-14  0              4.3761791e-09 -4.5            0              2.5975729    
   2000000   8100           200            200            0.0064172926   0.0048129002   0              0.014438978    3.4313924e-14  0              1.8409962e-09 -4.5            0              2.5975729    
   2100000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    1.8032817e-14  0              9.6748911e-10 -4.5            0              2.5975729    
   2200000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    2.1612118e-15  0              1.1595242e-10 -4.5            0              2.5975729    
   2300000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    1.2702056e-17  0              6.8148536e-13 -4.5            0              2.5975729    
   2400000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    3.9966877e-17  0              2.1442861e-12 -4.5            0              2.5975729    
   2500000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    1.0566353e-17  0              5.6690152e-13 -4.5            0              2.5975729    
   2600000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    6.8826978e-20  0              3.692676e-15  -4.5            0              2.5975729    
   2700000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    1.1721698e-19  0              6.2888761e-15 -4.5            0              2.5975729    
   2800000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    1.7634891e-20  0              9.4613977e-16 -4.5            0              2.5975729    
   2900000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    3.1796153e-23  0              1.7059138e-18 -4.5            0              2.5975729    
   3000000   8100           200            200            0.0064172927   0.0048129002   0              0.014438978    3.5034986e-22  0              1.8796823e-17 -4.5            0              2.5975729    
Loop time of 666.656 on 4 procs for 3000000 steps with 4501 atoms

Performance: 3888064.932 ns/day, 0.000 hours/ns, 4500.075 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 153.51     | 251.71     | 349.67     | 617.2 | 37.76
Neigh   | 5.0058     | 5.0445     | 5.0814     |   1.4 |  0.76
Comm    | 31.92      | 129.77     | 227.88     | 857.4 | 19.47
Output  | 0.30655    | 0.30683    | 0.30714    |   0.0 |  0.05
Modify  | 188.42     | 219.21     | 250.03     | 204.9 | 32.88
Other   |            | 60.61      |            |       |  9.09

Nlocal:        1125.25 ave        1350 max         899 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         2025.5 ave        2700 max        1347 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 8102
Ave neighs/atom = 1.8000444
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4275 ${n1e1} -100 100 -100 100 units box
region box block -4275 4275 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4275 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4275 4275 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4275 -100 -100) to (4275 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2850 atoms
  using lattice units in orthogonal box = (-4275 -100 -100) to (4275 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2850 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2850 2850 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1901 atoms
  using lattice units in orthogonal box = (-4275 -100 -100) to (4275 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2850 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2850 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1901 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1901 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
2850 atoms in group substrate
group slider1 region slider1
1901 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
4751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1901 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5517 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 109.2 | 109.2 | 109.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   8550           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   8550           200            200            0.0036068285   2.7286422e-17  0              0.010820486    832449.28      0              4.2311575e+10 -4.5            0              3.2443072    
    200000   8550           200            200            0.00069469965  7.4748356e-17  0              0.0020840989   81270.036      0              4.1307781e+09 -4.5            0              2.8068436    
    300000   8550           200            200           -7.3696731e-05  1.4625203e-16  0             -0.00022109019  1889.356       0              96031831      -4.5            0              2.652335     
    400000   8550           200            200            0.0057000168   0.0039773937   0              0.013122657    22465.055      0              1.1418496e+09 -4.5            0              2.5976283    
    500000   8550           200            200           -5.6514965e-05  3.6678877e-16  0             -0.0001695449   1132.4847      0              57561721      -4.5            0              2.5988789    
    600000   8550           200            200            0.0031821336   0.0024322962   0              0.0071141045   8.5999355      0              437115.9      -4.5            0              2.5977606    
    700000   8550           200            200            0.0063492866   0.0048035943   0              0.014244265    0.016566388    0              842.03326     -4.5            0              2.5975765    
    800000   8550           200            200            0.0064248443   0.0048137139   0              0.014460819    0.007371059    0              374.6548      -4.5            0              2.5975725    
    900000   8550           200            200            0.0064216914   0.0048132744   0              0.0144518      0.00081559799  0              41.455061     -4.5            0              2.5975727    
   1000000   8550           200            200            0.0064136513   0.0048122166   0              0.014428737    1.5847101e-05  0              0.80547347    -4.5            0              2.5975731    
   1100000   8550           200            200            0.0064182805   0.0048128291   0              0.014442012    2.476086e-06   0              0.12585404    -4.5            0              2.5975729    
   1200000   8550           200            200            0.0064168814   0.0048126433   0              0.014438001    1.7878506e-06  0              0.090872535   -4.5            0              2.5975729    
   1300000   8550           200            200            0.0064170221   0.0048126623   0              0.014438404    2.5023694e-07  0              0.012718996   -4.5            0              2.5975729    
   1400000   8550           200            200            0.0064171277   0.0048126762   0              0.014438707    8.3019207e-09  0              0.00042196846 -4.5            0              2.5975729    
   1500000   8550           200            200            0.0064170542   0.0048126665   0              0.014438496    2.6702212e-10  0              1.357215e-05  -4.5            0              2.5975729    
   1600000   8550           200            200            0.0064170792   0.0048126698   0              0.014438568    4.1095316e-10  0              2.088785e-05  -4.5            0              2.5975729    
   1700000   8550           200            200            0.0064170755   0.0048126693   0              0.014438557    7.3044947e-11  0              3.7127148e-06 -4.5            0              2.5975729    
   1800000   8550           200            200            0.0064170743   0.0048126691   0              0.014438554    3.5635527e-12  0              1.8112759e-07 -4.5            0              2.5975729    
   1900000   8550           200            200            0.0064170754   0.0048126693   0              0.014438557    1.1505278e-14  0              5.8478809e-10 -4.5            0              2.5975729    
   2000000   8550           200            200            0.006417075    0.0048126692   0              0.014438556    8.855261e-14   0              4.5009354e-09 -4.5            0              2.5975729    
   2100000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    2.0356815e-14  0              1.0346924e-09 -4.5            0              2.5975729    
   2200000   8550           200            200            0.0064170751   0.0048126693   0              0.014438556    1.3126871e-15  0              6.6721014e-11 -4.5            0              2.5975729    
   2300000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    7.5249756e-18  0              3.8247804e-13 -4.5            0              2.5975729    
   2400000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    1.7985522e-17  0              9.1416471e-13 -4.5            0              2.5975729    
   2500000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    1.3217787e-18  0              6.718312e-14  -4.5            0              2.5975729    
   2600000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    1.4956485e-18  0              7.6020541e-14 -4.5            0              2.5975729    
   2700000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    4.2291878e-20  0              2.1496036e-15 -4.5            0              2.5975729    
   2800000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    9.5127268e-21  0              4.8351109e-16 -4.5            0              2.5975729    
   2900000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    2.9756643e-21  0              1.5124651e-16 -4.5            0              2.5975729    
   3000000   8550           200            200            0.006417075    0.0048126693   0              0.014438556    1.0494749e-23  0              5.3342511e-19 -4.5            0              2.5975729    
Loop time of 702.409 on 4 procs for 3000000 steps with 4751 atoms

Performance: 3690156.405 ns/day, 0.000 hours/ns, 4271.014 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.01     | 266.23     | 369.76     | 631.8 | 37.90
Neigh   | 5.2673     | 5.3058     | 5.3424     |   1.3 |  0.76
Comm    | 32.218     | 135.38     | 239.92     | 885.4 | 19.27
Output  | 0.31784    | 0.31813    | 0.31844    |   0.0 |  0.05
Modify  | 197.76     | 231.02     | 263.94     | 213.8 | 32.89
Other   |            | 64.16      |            |       |  9.13

Nlocal:        1187.75 ave        1425 max         949 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           2138 ave        2851 max        1421 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 8552
Ave neighs/atom = 1.8000421
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4500 ${n1e1} -100 100 -100 100 units box
region box block -4500 4500 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4500 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4500 4500 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4500 -100 -100) to (4500 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -100 -100) to (4500 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-4500 -100 -100) to (4500 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 114.2 | 114.2 | 114.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   9000           200            200            0.0036068024   5.1047585e-18  0              0.010820407    876281.75      0              4.231251e+10  -4.5            0              3.2442128    
    200000   9000           200            200            0.00069552301  1.3960982e-17  0              0.002086569    85719.116      0              4.1390693e+09 -4.5            0              2.8067097    
    300000   9000           200            200           -7.220771e-05   2.7294618e-17  0             -0.00021662313  1905.0937      0              91990158      -4.5            0              2.65236      
    400000   9000           200            200            0.011940143    0.0085803667   0              0.027240063    23412.931      0              1.1305266e+09 -4.5            0              2.5973282    
    500000   9000           200            200           -5.065627e-05   6.8430376e-17  0             -0.00015196881  949.28672      0              45837659      -4.5            0              2.5989968    
    600000   9000           200            200            0.0030650249   0.002339473    0              0.0068556018   0.11510449     0              5557.9839     -4.5            0              2.5977686    
    700000   9000           200            200            0.0063679162   0.0048058979   0              0.014297851    0.039991308    0              1931.0371     -4.5            0              2.5975755    
    800000   9000           200            200            0.0064145634   0.0048121684   0              0.014431522    0.0082796634   0              399.79531     -4.5            0              2.597573     
    900000   9000           200            200            0.0064243463   0.0048134411   0              0.014459598    0.00048943848  0              23.633233     -4.5            0              2.5975725    
   1000000   9000           200            200            0.0064132552   0.0048119776   0              0.014427788    1.8911679e-09  0              9.1317728e-05 -4.5            0              2.5975731    
   1100000   9000           200            200            0.0064178221   0.004812583    0              0.014440883    8.1406058e-06  0              0.39308072    -4.5            0              2.5975729    
   1200000   9000           200            200            0.0064168462   0.004812453    0              0.014438086    2.222001e-06   0              0.10729248    -4.5            0              2.5975729    
   1300000   9000           200            200            0.0064167736   0.0048124437   0              0.014437877    1.7358904e-07  0              0.0083819936  -4.5            0              2.5975729    
   1400000   9000           200            200            0.0064169366   0.0048124652   0              0.014438344    7.705265e-10   0              3.7205967e-05 -4.5            0              2.5975729    
   1500000   9000           200            200            0.0064168604   0.0048124551   0              0.014438126    1.5018236e-09  0              7.2517685e-05 -4.5            0              2.5975729    
   1600000   9000           200            200            0.0064168795   0.0048124577   0              0.014438181    5.6999106e-10  0              2.7522829e-05 -4.5            0              2.5975729    
   1700000   9000           200            200            0.0064168792   0.0048124576   0              0.01443818     5.7156446e-11  0              2.7598802e-06 -4.5            0              2.5975729    
   1800000   9000           200            200            0.0064168769   0.0048124573   0              0.014438173    8.2850523e-13  0              4.0005553e-08 -4.5            0              2.5975729    
   1900000   9000           200            200            0.0064168782   0.0048124575   0              0.014438177    2.3985421e-13  0              1.1581702e-08 -4.5            0              2.5975729    
   2000000   9000           200            200            0.0064168778   0.0048124574   0              0.014438176    1.401477e-13   0              6.7672307e-09 -4.5            0              2.5975729    
   2100000   9000           200            200            0.0064168778   0.0048124574   0              0.014438176    1.7943085e-14  0              8.6640735e-10 -4.5            0              2.5975729    
   2200000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    4.1123331e-16  0              1.9856985e-11 -4.5            0              2.5975729    
   2300000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    1.1768691e-18  0              5.6826795e-14 -4.5            0              2.5975729    
   2400000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    1.2946046e-18  0              6.2511823e-14 -4.5            0              2.5975729    
   2500000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    1.0652988e-17  0              5.1439464e-13 -4.5            0              2.5975729    
   2600000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    8.4255732e-19  0              4.0684077e-14 -4.5            0              2.5975729    
   2700000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    2.3408463e-20  0              1.1303109e-15 -4.5            0              2.5975729    
   2800000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    2.6101144e-20  0              1.2603308e-15 -4.5            0              2.5975729    
   2900000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    7.2893675e-22  0              3.5197747e-17 -4.5            0              2.5975729    
   3000000   9000           200            200            0.0064168779   0.0048124575   0              0.014438176    1.6620134e-22  0              8.0252679e-18 -4.5            0              2.5975729    
Loop time of 736.227 on 4 procs for 3000000 steps with 5001 atoms

Performance: 3520652.270 ns/day, 0.000 hours/ns, 4074.829 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 171.05     | 280.47     | 389.85     | 649.2 | 38.09
Neigh   | 5.4961     | 5.5388     | 5.5799     |   1.4 |  0.75
Comm    | 32.701     | 141.56     | 251.55     | 912.9 | 19.23
Output  | 0.34099    | 0.34129    | 0.34162    |   0.0 |  0.05
Modify  | 206.34     | 241.51     | 275.48     | 218.6 | 32.80
Other   |            | 66.81      |            |       |  9.08

Nlocal:        1250.25 ave        1500 max         999 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         2250.5 ave        3000 max        1497 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 9002
Ave neighs/atom = 1.80004
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4725 ${n1e1} -100 100 -100 100 units box
region box block -4725 4725 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4725 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4725 4725 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4725 -100 -100) to (4725 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3150 atoms
  using lattice units in orthogonal box = (-4725 -100 -100) to (4725 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3150 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3150 3150 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2101 atoms
  using lattice units in orthogonal box = (-4725 -100 -100) to (4725 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3150 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3150 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2101 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2101 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3150 atoms in group substrate
group slider1 region slider1
2101 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2101 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6097 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 119.3 | 119.3 | 119.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9450           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   9450           200            200            0.0036067853  -9.8376676e-17  0              0.010820356    920118.45      0              4.231355e+10  -4.5            0              3.2441183    
    200000   9450           200            200            0.00069634766 -2.6922153e-16  0              0.002089043    90185.625      0              4.1473724e+09 -4.5            0              2.8065759    
    300000   9450           200            200           -7.0717891e-05 -5.2620105e-16  0             -0.00021215367  1914.4905      0              88041803      -4.5            0              2.6523842    
    400000   9450           200            200            0.019475126    0.01414333     0              0.044282049    23666.796      0              1.0883665e+09 -4.5            0              2.5970323    
    500000   9450           200            200           -4.4763757e-05 -1.3172269e-15  0             -0.00013429127  771.44733      0              35476601      -4.5            0              2.5991008    
    600000   9450           200            200            0.0031547871   0.0023550956   0              0.0071092656   5.6653154      0              260531.24     -4.5            0              2.597763     
    700000   9450           200            200            0.0063926365   0.0048090214   0              0.014368888    0.061595149    0              2832.5803     -4.5            0              2.5975742    
    800000   9450           200            200            0.0064046954   0.0048106869   0              0.014403399    0.0071252969   0              327.67151     -4.5            0              2.5975735    
    900000   9450           200            200            0.0064260411   0.0048134957   0              0.014464627    0.00015739141  0              7.2379694     -4.5            0              2.5975724    
   1000000   9450           200            200            0.0064133361   0.0048118165   0              0.014428192    1.767667e-05   0              0.81289821    -4.5            0              2.5975731    
   1100000   9450           200            200            0.0064172673   0.0048123386   0              0.014439463    1.4458991e-05  0              0.66492661    -4.5            0              2.5975729    
   1200000   9450           200            200            0.0064168294   0.0048122796   0              0.014438209    2.1166283e-06  0              0.097337531   -4.5            0              2.5975729    
   1300000   9450           200            200            0.0064165571   0.0048122439   0              0.014437427    7.6583981e-08  0              0.0035218727  -4.5            0              2.5975729    
   1400000   9450           200            200            0.0064167556   0.0048122701   0              0.014437997    1.6568174e-09  0              7.6192173e-05 -4.5            0              2.5975729    
   1500000   9450           200            200            0.0064166864   0.004812261    0              0.014437798    3.206777e-09   0              0.00014747027 -4.5            0              2.5975729    
   1600000   9450           200            200            0.0064166973   0.0048122624   0              0.01443783     5.9841153e-10  0              2.7519192e-05 -4.5            0              2.5975729    
   1700000   9450           200            200            0.0064167004   0.0048122628   0              0.014437838    3.1189775e-11  0              1.4343263e-06 -4.5            0              2.5975729    
   1800000   9450           200            200            0.0064166974   0.0048122624   0              0.01443783     3.8518622e-14  0              1.7713585e-09 -4.5            0              2.5975729    
   1900000   9450           200            200            0.0064166986   0.0048122626   0              0.014437833    6.6400047e-13  0              3.0535435e-08 -4.5            0              2.5975729    
   2000000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    1.6152235e-13  0              7.4279392e-09 -4.5            0              2.5975729    
   2100000   9450           200            200            0.0064166983   0.0048122626   0              0.014437832    1.1354133e-14  0              5.2214328e-10 -4.5            0              2.5975729    
   2200000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    1.6896878e-17  0              7.7703788e-13 -4.5            0              2.5975729    
   2300000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    2.5187863e-17  0              1.1583159e-12 -4.5            0              2.5975729    
   2400000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    3.9535996e-17  0              1.8181445e-12 -4.5            0              2.5975729    
   2500000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    1.1755375e-17  0              5.4059522e-13 -4.5            0              2.5975729    
   2600000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    3.774514e-20   0              1.7357883e-15 -4.5            0              2.5975729    
   2700000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    1.4558679e-19  0              6.6951096e-15 -4.5            0              2.5975729    
   2800000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    1.8119017e-20  0              8.3324047e-16 -4.5            0              2.5975729    
   2900000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    9.8880673e-23  0              4.5472322e-18 -4.5            0              2.5975729    
   3000000   9450           200            200            0.0064166984   0.0048122626   0              0.014437833    4.0180862e-22  0              1.8478e-17    -4.5            0              2.5975729    
Loop time of 773.584 on 4 procs for 3000000 steps with 5251 atoms

Performance: 3350638.610 ns/day, 0.000 hours/ns, 3878.054 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.51     | 295.12     | 409.86     | 667.5 | 38.15
Neigh   | 5.7826     | 5.8267     | 5.8685     |   1.4 |  0.75
Comm    | 33.684     | 148.47     | 264.09     | 940.1 | 19.19
Output  | 0.36526    | 0.36559    | 0.36595    |   0.1 |  0.05
Modify  | 218.19     | 254.02     | 289.93     | 222.5 | 32.84
Other   |            | 69.79      |            |       |  9.02

Nlocal:        1312.75 ave        1575 max        1049 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           2363 ave        3151 max        1571 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 9452
Ave neighs/atom = 1.8000381
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4950 ${n1e1} -100 100 -100 100 units box
region box block -4950 4950 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4950 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4950 4950 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4950 -100 -100) to (4950 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3300 atoms
  using lattice units in orthogonal box = (-4950 -100 -100) to (4950 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3300 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3300 3300 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2201 atoms
  using lattice units in orthogonal box = (-4950 -100 -100) to (4950 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3300 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3300 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2201 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2201 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3300 atoms in group substrate
group slider1 region slider1
2201 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2201 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6388 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 124.3 | 124.3 | 124.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9900           200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   9900           200            200            0.0036067759  -2.4722896e-17  0              0.010820328    963959.39      0              4.2314681e+10 -4.5            0              3.2440238    
    200000   9900           200            200            0.0006971745  -6.7707783e-17  0              0.0020915235   94669.821      0              4.1556971e+09 -4.5            0              2.8064418    
    300000   9900           200            200           -6.9222708e-05 -1.3238193e-16  0             -0.00020766812  1917.5605      0              84174667      -4.5            0              2.6524075    
    400000   9900           200            200            0.027924613    0.020386677    0              0.063387162    23061.079      0              1.0123063e+09 -4.5            0              2.596744     
    500000   9900           200            200           -3.8825084e-05 -3.3030867e-16  0             -0.00011647525  602.51486      0              26448442      -4.5            0              2.5991913    
    600000   9900           200            200            0.0034481213   0.0025357862   0              0.0078085776   25.355721      0              1113033.6     -4.5            0              2.5977441    
    700000   9900           200            200            0.0064203723   0.0048127025   0              0.014448414    0.070707323    0              3103.8214     -4.5            0              2.5975727    
    800000   9900           200            200            0.006396499    0.0048095953   0              0.014379902    0.0044224285   0              194.13022     -4.5            0              2.597574     
    900000   9900           200            200            0.006426605    0.0048135738   0              0.014466241    9.2528748e-07  0              0.04061711    -4.5            0              2.5975724    
   1000000   9900           200            200            0.0064139093   0.0048118932   0              0.014429835    6.3398621e-05  0              2.7829932     -4.5            0              2.5975731    
   1100000   9900           200            200            0.0064167176   0.0048122673   0              0.014437886    1.8373767e-05  0              0.80654859    -4.5            0              2.5975729    
   1200000   9900           200            200            0.0064168642   0.0048122857   0              0.014438307    1.5089715e-06  0              0.066238939   -4.5            0              2.5975729    
   1300000   9900           200            200            0.0064164302   0.0048122285   0              0.014437062    9.4046132e-09  0              0.00041283192 -4.5            0              2.5975729    
   1400000   9900           200            200            0.0064166385   0.0048122561   0              0.01443766     1.1148342e-08  0              0.00048937592 -4.5            0              2.5975729    
   1500000   9900           200            200            0.0064165848   0.0048122489   0              0.014437506    4.5635877e-09  0              0.00020032665 -4.5            0              2.5975729    
   1600000   9900           200            200            0.0064165864   0.0048122492   0              0.01443751     4.7932203e-10  0              2.1040678e-05 -4.5            0              2.5975729    
   1700000   9900           200            200            0.0064165924   0.00481225     0              0.014437527    8.151781e-12   0              3.5783667e-07 -4.5            0              2.5975729    
   1800000   9900           200            200            0.0064165891   0.0048122495   0              0.014437518    1.664608e-12   0              7.3070874e-08 -4.5            0              2.5975729    
   1900000   9900           200            200            0.0064165901   0.0048122496   0              0.014437521    1.0844016e-12  0              4.7601703e-08 -4.5            0              2.5975729    
   2000000   9900           200            200            0.00641659     0.0048122496   0              0.01443752     1.4415472e-13  0              6.3279234e-09 -4.5            0              2.5975729    
   2100000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     4.3177816e-15  0              1.8953656e-10 -4.5            0              2.5975729    
   2200000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     1.5372227e-16  0              6.7479077e-12 -4.5            0              2.5975729    
   2300000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     6.8286533e-17  0              2.9975566e-12 -4.5            0              2.5975729    
   2400000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     8.9487847e-18  0              3.9282254e-13 -4.5            0              2.5975729    
   2500000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     2.5674421e-19  0              1.1270236e-14 -4.5            0              2.5975729    
   2600000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     1.1252944e-18  0              4.9396763e-14 -4.5            0              2.5975729    
   2700000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     1.3648319e-19  0              5.991168e-15  -4.5            0              2.5975729    
   2800000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     8.2749886e-22  0              3.6324508e-17 -4.5            0              2.5975729    
   2900000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     3.0555212e-21  0              1.3412744e-16 -4.5            0              2.5975729    
   3000000   9900           200            200            0.0064165899   0.0048122496   0              0.01443752     1.4974184e-22  0              6.5731795e-18 -4.5            0              2.5975729    
Loop time of 808.202 on 4 procs for 3000000 steps with 5501 atoms

Performance: 3207118.651 ns/day, 0.000 hours/ns, 3711.943 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 189.3      | 309.69     | 429.81     | 680.4 | 38.32
Neigh   | 6.0379     | 6.0794     | 6.1215     |   1.3 |  0.75
Comm    | 34.417     | 154.11     | 274.77     | 964.1 | 19.07
Output  | 0.35739    | 0.35771    | 0.35806    |   0.1 |  0.04
Modify  | 226.51     | 264.69     | 302.02     | 229.4 | 32.75
Other   |            | 73.27      |            |       |  9.07

Nlocal:        1375.25 ave        1650 max        1099 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         2475.5 ave        3300 max        1647 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 9902
Ave neighs/atom = 1.8000364
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5175 ${n1e1} -100 100 -100 100 units box
region box block -5175 5175 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5175 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5175 5175 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5175 -100 -100) to (5175 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3450 atoms
  using lattice units in orthogonal box = (-5175 -100 -100) to (5175 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3450 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3450 3450 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2301 atoms
  using lattice units in orthogonal box = (-5175 -100 -100) to (5175 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3450 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3450 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2301 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2301 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3450 atoms in group substrate
group slider1 region slider1
2301 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2301 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6678 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.3 | 129.3 | 129.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10350          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   10350          200            200            0.0036067734  -7.1328568e-17  0              0.01082032     1007804.6      0              4.2315892e+10 -4.5            0              3.2439293    
    200000   10350          200            200            0.00069800067 -1.952854e-16   0              0.002094002    99171.118      0              4.164016e+09  -4.5            0              2.806308     
    300000   10350          200            200           -6.7728439e-05 -3.8107943e-16  0             -0.00020318532  1914.9392      0              80404836      -4.5            0              2.6524299    
    400000   10350          200            200            0.036881759    0.027010679    0              0.083634599    21516.308      0              9.0343086e+08 -4.5            0              2.5964691    
    500000   10350          200            200           -3.2845171e-05 -9.5234713e-16  0             -9.8535513e-05  446.67894      0              18755241      -4.5            0              2.5992683    
    600000   10350          200            200            0.0039400017   0.0028956967   0              0.0089243083   55.601522      0              2334607.4     -4.5            0              2.5977134    
    700000   10350          200            200            0.0064475138   0.004816333    0              0.014526208    0.062302395    0              2615.9649     -4.5            0              2.5975713    
    800000   10350          200            200            0.0063909379   0.0048088973   0              0.014363916    0.0015419284   0              64.742784     -4.5            0              2.5975742    
    900000   10350          200            200            0.0064259228   0.0048135333   0              0.014464235    0.00012414488  0              5.2126192     -4.5            0              2.5975724    
   1000000   10350          200            200            0.0064148359   0.004812063    0              0.014432445    0.00011669042  0              4.8996198     -4.5            0              2.597573     
   1100000   10350          200            200            0.006416185    0.0048122443   0              0.014436311    1.7870807e-05  0              0.75036289    -4.5            0              2.5975729    
   1200000   10350          200            200            0.0064168872   0.0048123364   0              0.014438325    7.0016876e-07  0              0.02939882    -4.5            0              2.5975729    
   1300000   10350          200            200            0.0064163494   0.0048122653   0              0.014436783    9.8915449e-09  0              0.00041532809 -4.5            0              2.5975729    
   1400000   10350          200            200            0.0064165411   0.0048122907   0              0.014437333    2.4996011e-08  0              0.0010495373  -4.5            0              2.5975729    
   1500000   10350          200            200            0.0064165092   0.0048122864   0              0.014437241    4.8911988e-09  0              0.0002053726  -4.5            0              2.5975729    
   1600000   10350          200            200            0.0064165016   0.0048122854   0              0.014437219    2.7091936e-10  0              1.1375414e-05 -4.5            0              2.5975729    
   1700000   10350          200            200            0.0064165096   0.0048122865   0              0.014437242    7.8230416e-14  0              3.2847537e-09 -4.5            0              2.5975729    
   1800000   10350          200            200            0.0064165064   0.0048122861   0              0.014437233    4.9926597e-12  0              2.0963275e-07 -4.5            0              2.5975729    
   1900000   10350          200            200            0.0064165071   0.0048122862   0              0.014437235    1.2817065e-12  0              5.3816539e-08 -4.5            0              2.5975729    
   2000000   10350          200            200            0.0064165071   0.0048122862   0              0.014437235    9.476066e-14   0              3.9788288e-09 -4.5            0              2.5975729    
   2100000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    2.9192916e-16  0              1.2257578e-11 -4.5            0              2.5975729    
   2200000   10350          200            200            0.0064165071   0.0048122862   0              0.014437235    8.0898238e-16  0              3.3967708e-11 -4.5            0              2.5975729    
   2300000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    1.7236004e-16  0              7.2370865e-12 -4.5            0              2.5975729    
   2400000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    8.6267553e-20  0              3.6222186e-15 -4.5            0              2.5975729    
   2500000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    1.1913926e-17  0              5.0024421e-13 -4.5            0              2.5975729    
   2600000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    2.8890989e-19  0              1.2130804e-14 -4.5            0              2.5975729    
   2700000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    8.0418704e-20  0              3.376636e-15  -4.5            0              2.5975729    
   2800000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    2.2393432e-20  0              9.4025972e-16 -4.5            0              2.5975729    
   2900000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    4.8947293e-23  0              2.0552083e-18 -4.5            0              2.5975729    
   3000000   10350          200            200            0.006416507    0.0048122862   0              0.014437235    2.8850693e-22  0              1.2113885e-17 -4.5            0              2.5975729    
Loop time of 845.759 on 4 procs for 3000000 steps with 5751 atoms

Performance: 3064702.233 ns/day, 0.000 hours/ns, 3547.109 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.13     | 323.24     | 448.17     | 694.9 | 38.22
Neigh   | 6.3172     | 6.362      | 6.4081     |   1.4 |  0.75
Comm    | 34.781     | 159.95     | 285.33     | 988.4 | 18.91
Output  | 0.36861    | 0.36899    | 0.36934    |   0.1 |  0.04
Modify  | 237.68     | 278.02     | 319.82     | 240.9 | 32.87
Other   |            | 77.82      |            |       |  9.20

Nlocal:        1437.75 ave        1725 max        1149 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           2588 ave        3451 max        1721 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 10352
Ave neighs/atom = 1.8000348
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5400 ${n1e1} -100 100 -100 100 units box
region box block -5400 5400 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5400 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5400 5400 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5400 -100 -100) to (5400 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3600 atoms
  using lattice units in orthogonal box = (-5400 -100 -100) to (5400 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3600 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3600 3600 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2401 atoms
  using lattice units in orthogonal box = (-5400 -100 -100) to (5400 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3600 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3600 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2401 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2401 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3600 atoms in group substrate
group slider1 region slider1
2401 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
6001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2401 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6968 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 134.4 | 134.4 | 134.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10800          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   10800          200            200            0.0036067768  -8.9641569e-17  0              0.01082033     1051654        0              4.2317173e+10 -4.5            0              3.2438349    
    200000   10800          200            200            0.0006988291  -2.4524206e-16  0              0.0020964873   103690.24      0              4.1723587e+09 -4.5            0              2.806174     
    300000   10800          200            200           -6.6230302e-05 -4.7896447e-16  0             -0.00019869091  1906.621       0              76719919      -4.5            0              2.6524514    
    400000   10800          200            200            0.04595466     0.03372609     0              0.10413789     19055.019      0              7.6674888e+08 -4.5            0              2.5962127    
    500000   10800          200            200           -2.6825866e-05 -1.1947204e-15  0             -8.0477597e-05  307.95921      0              12391873      -4.5            0              2.5993316    
    600000   10800          200            200            0.0046176839   0.0033932044   0              0.010459847    89.309186      0              3593684.1     -4.5            0              2.5976729    
    700000   10800          200            200            0.0064705968   0.0048194147   0              0.014592376    0.040074569    0              1612.5479     -4.5            0              2.5975701    
    800000   10800          200            200            0.0063886525   0.0048086338   0              0.014357324    3.6071644e-05  0              1.4514755     -4.5            0              2.5975744    
    900000   10800          200            200            0.0064240714   0.0048133375   0              0.014458877    0.00049205132  0              19.799498     -4.5            0              2.5975725    
   1000000   10800          200            200            0.0064159654   0.0048122594   0              0.014435637    0.00015190876  0              6.1126086     -4.5            0              2.5975729    
   1100000   10800          200            200            0.006415709    0.0048122281   0              0.014434899    1.3105411e-05  0              0.52734448    -4.5            0              2.5975729    
   1200000   10800          200            200            0.0064168684   0.004812381    0              0.014438224    1.0764554e-07  0              0.0043315148  -4.5            0              2.5975729    
   1300000   10800          200            200            0.0064162964   0.0048123052   0              0.014436584    8.2360124e-08  0              0.003314063   -4.5            0              2.5975729    
   1400000   10800          200            200            0.0064164479   0.0048123254   0              0.014437018    3.6537046e-08  0              0.0014702027  -4.5            0              2.5975729    
   1500000   10800          200            200            0.0064164413   0.0048123245   0              0.014436999    4.0135031e-09  0              0.00016149809 -4.5            0              2.5975729    
   1600000   10800          200            200            0.0064164256   0.0048123224   0              0.014436954    7.8248035e-11  0              3.148598e-06  -4.5            0              2.5975729    
   1700000   10800          200            200            0.0064164346   0.0048123236   0              0.01443698     1.1582432e-11  0              4.6606182e-07 -4.5            0              2.5975729    
   1800000   10800          200            200            0.0064164319   0.0048123232   0              0.014436972    8.3702926e-12  0              3.3680956e-07 -4.5            0              2.5975729    
   1900000   10800          200            200            0.0064164322   0.0048123233   0              0.014436973    1.1601676e-12  0              4.6683617e-08 -4.5            0              2.5975729    
   2000000   10800          200            200            0.0064164324   0.0048123233   0              0.014436974    3.7511186e-14  0              1.5094008e-09 -4.5            0              2.5975729    
   2100000   10800          200            200            0.0064164322   0.0048123233   0              0.014436973    1.2586722e-15  0              5.0647314e-11 -4.5            0              2.5975729    
   2200000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    1.7723971e-15  0              7.1318926e-11 -4.5            0              2.5975729    
   2300000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    2.837076e-16   0              1.141602e-11  -4.5            0              2.5975729    
   2400000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    3.9704744e-17  0              1.5976667e-12 -4.5            0              2.5975729    
   2500000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    3.6719107e-18  0              1.4775286e-13 -4.5            0              2.5975729    
   2600000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    4.2533119e-19  0              1.7114768e-14 -4.5            0              2.5975729    
   2700000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    1.8452688e-19  0              7.4251187e-15 -4.5            0              2.5975729    
   2800000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    1.6587221e-21  0              6.6744794e-17 -4.5            0              2.5975729    
   2900000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    1.8204791e-21  0              7.3253683e-17 -4.5            0              2.5975729    
   3000000   10800          200            200            0.0064164323   0.0048123233   0              0.014436974    3.0284549e-22  0              1.2186104e-17 -4.5            0              2.5975729    
Loop time of 880.328 on 4 procs for 3000000 steps with 6001 atoms

Performance: 2944355.623 ns/day, 0.000 hours/ns, 3407.819 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 206.36     | 338.84     | 470.96     | 715.5 | 38.49
Neigh   | 6.5541     | 6.5999     | 6.643      |   1.3 |  0.75
Comm    | 35.304     | 167.51     | 299.52     |1016.0 | 19.03
Output  | 0.38329    | 0.38366    | 0.38405    |   0.1 |  0.04
Modify  | 247.13     | 287.68     | 328.66     | 239.0 | 32.68
Other   |            | 79.32      |            |       |  9.01

Nlocal:        1500.25 ave        1800 max        1199 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         2700.5 ave        3600 max        1797 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 10802
Ave neighs/atom = 1.8000333
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5625 ${n1e1} -100 100 -100 100 units box
region box block -5625 5625 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5625 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5625 5625 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5625 -100 -100) to (5625 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3750 atoms
  using lattice units in orthogonal box = (-5625 -100 -100) to (5625 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3750 3750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2501 atoms
  using lattice units in orthogonal box = (-5625 -100 -100) to (5625 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3750 atoms in group substrate
group slider1 region slider1
2501 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
6251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7259 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 139.4 | 139.5 | 139.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   11250          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   11250          200            200            0.0036067854  -8.2957542e-17  0              0.010820356    1095507.6      0              4.2318514e+10 -4.5            0              3.2437404    
    200000   11250          200            200            0.00069965896 -2.2699198e-16  0              0.0020989769   108227.05      0              4.1807177e+09 -4.5            0              2.8060398    
    300000   11250          200            200           -6.4728359e-05 -4.4369972e-16  0             -0.00019418508  1892.8769      0              73120201      -4.5            0              2.652472     
    400000   11250          200            200            0.05475089     0.040242791    0              0.12400988     15815.787      0              6.1095021e+08 -4.5            0              2.5959797    
    500000   11250          200            200           -2.0758711e-05 -1.1066527e-15  0             -6.2276133e-05  190.12687      0              7344436.8     -4.5            0              2.5993815    
    600000   11250          200            200            0.0054540192   0.0040084871   0              0.01235357     117.27753      0              4530329.9     -4.5            0              2.5976255    
    700000   11250          200            200            0.0064867327   0.0048215791   0              0.014638619    0.015105406    0              583.5088      -4.5            0              2.5975692    
    800000   11250          200            200            0.0063898829   0.0048088381   0              0.014360811    0.000849933    0              32.832178     -4.5            0              2.5975743    
    900000   11250          200            200            0.0064212866   0.0048130169   0              0.014450843    0.00094194546  0              36.38654      -4.5            0              2.5975726    
   1000000   11250          200            200            0.0064171436   0.0048124617   0              0.014438969    0.00015123708  0              5.842158      -4.5            0              2.5975729    
   1100000   11250          200            200            0.0064153376   0.0048122249   0              0.014433788    6.4035977e-06  0              0.24736545    -4.5            0              2.597573     
   1200000   11250          200            200            0.0064168008   0.0048124183   0              0.014437984    5.4814445e-08  0              0.0021174347  -4.5            0              2.5975729    
   1300000   11250          200            200            0.0064162669   0.0048123475   0              0.014436453    1.9464173e-07  0              0.007518842   -4.5            0              2.5975729    
   1400000   11250          200            200            0.0064163603   0.00481236     0              0.014436721    4.0061942e-08  0              0.0015475582  -4.5            0              2.5975729    
   1500000   11250          200            200            0.006416379    0.0048123624   0              0.014436775    2.3563911e-09  0              9.1025354e-05 -4.5            0              2.5975729    
   1600000   11250          200            200            0.0064163575   0.0048123596   0              0.014436713    3.3542595e-16  0              1.2957215e-11 -4.5            0              2.5975729    
   1700000   11250          200            200            0.0064163663   0.0048123608   0              0.014436738    3.7404916e-11  0              1.4449196e-06 -4.5            0              2.5975729    
   1800000   11250          200            200            0.0064163644   0.0048123605   0              0.014436733    1.0151923e-11  0              3.9216004e-07 -4.5            0              2.5975729    
   1900000   11250          200            200            0.0064163643   0.0048123605   0              0.014436732    7.8726641e-13  0              3.0411422e-08 -4.5            0              2.5975729    
   2000000   11250          200            200            0.0064163646   0.0048123605   0              0.014436733    3.3941928e-15  0              1.3111474e-10 -4.5            0              2.5975729    
   2100000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    6.6797221e-15  0              2.580319e-10  -4.5            0              2.5975729    
   2200000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    2.5101384e-15  0              9.6964481e-11 -4.5            0              2.5975729    
   2300000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    3.1906756e-16  0              1.2325304e-11 -4.5            0              2.5975729    
   2400000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    8.2630723e-19  0              3.1919535e-14 -4.5            0              2.5975729    
   2500000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    3.2614096e-18  0              1.2598544e-13 -4.5            0              2.5975729    
   2600000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    1.3406771e-18  0              5.1789198e-14 -4.5            0              2.5975729    
   2700000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    1.0814754e-20  0              4.1776461e-16 -4.5            0              2.5975729    
   2800000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    1.3522742e-20  0              5.2237184e-16 -4.5            0              2.5975729    
   2900000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    2.1575991e-21  0              8.3346189e-17 -4.5            0              2.5975729    
   3000000   11250          200            200            0.0064163645   0.0048123605   0              0.014436733    1.8504446e-24  0              7.1481076e-20 -4.5            0              2.5975729    
Loop time of 922.777 on 4 procs for 3000000 steps with 6251 atoms

Performance: 2808913.608 ns/day, 0.000 hours/ns, 3251.057 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 215.16     | 355.84     | 497.35     | 733.2 | 38.56
Neigh   | 6.8048     | 6.8557     | 6.9033     |   1.5 |  0.74
Comm    | 35.754     | 175.93     | 318.22     |1032.7 | 19.07
Output  | 0.39252    | 0.39294    | 0.39339    |   0.1 |  0.04
Modify  | 256.62     | 301.07     | 343.24     | 237.9 | 32.63
Other   |            | 82.68      |            |       |  8.96

Nlocal:        1562.75 ave        1875 max        1249 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           2813 ave        3751 max        1871 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 11252
Ave neighs/atom = 1.800032
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5850 ${n1e1} -100 100 -100 100 units box
region box block -5850 5850 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5850 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5850 5850 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5850 -100 -100) to (5850 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3900 atoms
  using lattice units in orthogonal box = (-5850 -100 -100) to (5850 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3900 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3900 3900 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2601 atoms
  using lattice units in orthogonal box = (-5850 -100 -100) to (5850 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3900 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3900 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2601 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2601 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3900 atoms in group substrate
group slider1 region slider1
2601 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
6501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2601 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7549 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 144.5 | 144.5 | 144.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   11700          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   11700          200            200            0.0036067986  -3.9233529e-18  0              0.010820396    1139365.5      0              4.231991e+10  -4.5            0              3.243646     
    200000   11700          200            200            0.00070048978 -1.0736028e-17  0              0.0021014693   112781.5       0              4.1890885e+09 -4.5            0              2.8059055    
    300000   11700          200            200           -6.3225826e-05 -2.0929168e-17  0             -0.00018967748  1874.1742      0              69613205      -4.5            0              2.6524918    
    400000   11700          200            200            0.062843203    0.046244373    0              0.14228523     12077.917      0              4.4861492e+08 -4.5            0              2.5957761    
    500000   11700          200            200           -1.4655784e-05 -5.2275963e-17  0             -4.3967353e-05  97.381642      0              3617085.4     -4.5            0              2.5994179    
    600000   11700          200            200            0.0063991012   0.0047049036   0              0.0144924      130.60841      0              4851240.6     -4.5            0              2.5975748    
    700000   11700          200            200            0.0064938907   0.0048225706   0              0.014659101    0.00073240027  0              27.203837     -4.5            0              2.5975689    
    800000   11700          200            200            0.0063944281   0.0048094832   0              0.014373801    0.0037992998   0              141.11892     -4.5            0              2.5975741    
    900000   11700          200            200            0.0064179241   0.0048126175   0              0.014441155    0.0012587849   0              46.755554     -4.5            0              2.5975728    
   1000000   11700          200            200            0.0064182112   0.0048126481   0              0.014441986    0.00011419792  0              4.241699      -4.5            0              2.5975728    
   1100000   11700          200            200            0.0064151062   0.0048122389   0              0.01443308     1.191178e-06   0              0.044244401   -4.5            0              2.597573     
   1200000   11700          200            200            0.0064166846   0.0048124479   0              0.014437606    6.0388098e-07  0              0.022430193   -4.5            0              2.5975729    
   1300000   11700          200            200            0.0064162547   0.0048123907   0              0.014436373    2.9301619e-07  0              0.010883618   -4.5            0              2.5975729    
   1400000   11700          200            200            0.0064162796   0.0048123941   0              0.014436445    3.3722764e-08  0              0.0012525781  -4.5            0              2.5975729    
   1500000   11700          200            200            0.0064163208   0.0048123996   0              0.014436563    7.4858723e-10  0              2.7805076e-05 -4.5            0              2.5975729    
   1600000   11700          200            200            0.0064162962   0.0048123963   0              0.014436492    7.8862599e-11  0              2.9292251e-06 -4.5            0              2.5975729    
   1700000   11700          200            200            0.0064163038   0.0048123973   0              0.014436514    6.4950569e-11  0              2.412485e-06  -4.5            0              2.5975729    
   1800000   11700          200            200            0.006416303    0.0048123972   0              0.014436512    9.4473203e-12  0              3.5090561e-07 -4.5            0              2.5975729    
   1900000   11700          200            200            0.0064163024   0.0048123971   0              0.01443651     3.3936233e-13  0              1.2605071e-08 -4.5            0              2.5975729    
   2000000   11700          200            200            0.0064163028   0.0048123972   0              0.014436511    7.1635455e-15  0              2.6607844e-10 -4.5            0              2.5975729    
   2100000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    1.3760522e-14  0              5.1111259e-10 -4.5            0              2.5975729    
   2200000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    2.5130229e-15  0              9.3342219e-11 -4.5            0              2.5975729    
   2300000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    2.5844651e-16  0              9.5995822e-12 -4.5            0              2.5975729    
   2400000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    1.8245152e-17  0              6.7768699e-13 -4.5            0              2.5975729    
   2500000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    1.1473824e-17  0              4.2617684e-13 -4.5            0              2.5975729    
   2600000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    2.5132143e-19  0              9.3349327e-15 -4.5            0              2.5975729    
   2700000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    7.9896491e-20  0              2.9676274e-15 -4.5            0              2.5975729    
   2800000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    2.0736168e-20  0              7.702118e-16  -4.5            0              2.5975729    
   2900000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    3.2081318e-23  0              1.1916092e-18 -4.5            0              2.5975729    
   3000000   11700          200            200            0.0064163027   0.0048123972   0              0.014436511    2.724434e-22   0              1.0119475e-17 -4.5            0              2.5975729    
Loop time of 957.127 on 4 procs for 3000000 steps with 6501 atoms

Performance: 2708104.768 ns/day, 0.000 hours/ns, 3134.381 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 224.72     | 369.77     | 516.21     | 742.3 | 38.63
Neigh   | 7.1209     | 7.1723     | 7.2232     |   1.5 |  0.75
Comm    | 36.551     | 181.59     | 328.81     |1046.0 | 18.97
Output  | 0.40486    | 0.4053     | 0.40576    |   0.1 |  0.04
Modify  | 266.44     | 312.54     | 354.99     | 240.1 | 32.65
Other   |            | 85.65      |            |       |  8.95

Nlocal:        1625.25 ave        1950 max        1299 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         2925.5 ave        3900 max        1947 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 11702
Ave neighs/atom = 1.8000308
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6075 ${n1e1} -100 100 -100 100 units box
region box block -6075 6075 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6075 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6075 6075 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6075 -100 -100) to (6075 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 4050 atoms
  using lattice units in orthogonal box = (-6075 -100 -100) to (6075 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4050 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4050 4050 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2701 atoms
  using lattice units in orthogonal box = (-6075 -100 -100) to (6075 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  4050 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  4050 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2701 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2701 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
4050 atoms in group substrate
group slider1 region slider1
2701 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
6751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2701 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7839 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 149.5 | 149.5 | 149.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12150          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   12150          200            200            0.003606816   -6.5177477e-17  0              0.010820448    1183227.6      0              4.2321354e+10 -4.5            0              3.2435515    
    200000   12150          200            200            0.000701322   -1.7835958e-16  0              0.002103966    117353.76      0              4.1974762e+09 -4.5            0              2.8057711    
    300000   12150          200            200           -6.171882e-05  -3.4811628e-16  0             -0.00018515646  1850.5439      0              66189736      -4.5            0              2.6525107    
    400000   12150          200            200            0.069866085    0.051459734    0              0.15813852     8208.3348      0              2.9359341e+08 -4.5            0              2.5956062    
    500000   12150          200            200           -8.5133349e-06 -8.6723881e-16  0             -2.5540005e-05  33.52649       0              1199166.1     -4.5            0              2.5994408    
    600000   12150          200            200            0.0073831508   0.0054310832   0              0.016718369    123.95083      0              4433438.7     -4.5            0              2.5975244    
    700000   12150          200            200            0.006491232    0.0048222842   0              0.014651412    0.0056869331   0              203.40863     -4.5            0              2.597569     
    800000   12150          200            200            0.0064016771   0.004810487    0              0.014394544    0.0075983675   0              271.77628     -4.5            0              2.5975737    
    900000   12150          200            200            0.0064144038   0.0048121947   0              0.014431017    0.001284233    0              45.934087     -4.5            0              2.597573     
   1000000   12150          200            200            0.0064190288   0.0048128003   0              0.014444286    5.8744167e-05  0              2.1011449     -4.5            0              2.5975728    
   1100000   12150          200            200            0.0064150327   0.0048122723   0              0.014432826    2.6830178e-07  0              0.0095965427  -4.5            0              2.597573     
   1200000   12150          200            200            0.006416527    0.0048124705   0              0.014437111    1.5140977e-06  0              0.05415582    -4.5            0              2.5975729    
   1300000   12150          200            200            0.0064162526   0.0048124339   0              0.014436324    3.2920289e-07  0              0.011774837   -4.5            0              2.5975729    
   1400000   12150          200            200            0.0064162076   0.004812428    0              0.014436195    2.0580316e-08  0              0.00073611097 -4.5            0              2.5975729    
   1500000   12150          200            200            0.0064162654   0.0048124357   0              0.014436361    6.1675837e-12  0              2.206004e-07  -4.5            0              2.5975729    
   1600000   12150          200            200            0.006416241    0.0048124325   0              0.014436291    2.7927729e-10  0              9.9891118e-06 -4.5            0              2.5975729    
   1700000   12150          200            200            0.0064162464   0.0048124332   0              0.014436306    8.0776683e-11  0              2.8891977e-06 -4.5            0              2.5975729    
   1800000   12150          200            200            0.0064162467   0.0048124332   0              0.014436307    6.6025948e-12  0              2.3615976e-07 -4.5            0              2.5975729    
   1900000   12150          200            200            0.0064162459   0.0048124331   0              0.014436305    4.229327e-14   0              1.5127338e-09 -4.5            0              2.5975729    
   2000000   12150          200            200            0.0064162463   0.0048124331   0              0.014436306    4.6713148e-14  0              1.6708228e-09 -4.5            0              2.5975729    
   2100000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    1.9103423e-14  0              6.8328586e-10 -4.5            0              2.5975729    
   2200000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    1.828341e-15   0              6.5395586e-11 -4.5            0              2.5975729    
   2300000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    8.7744029e-17  0              3.1384038e-12 -4.5            0              2.5975729    
   2400000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    3.9844878e-17  0              1.4251604e-12 -4.5            0              2.5975729    
   2500000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    6.4412968e-18  0              2.303905e-13  -4.5            0              2.5975729    
   2600000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    1.4043077e-19  0              5.0228883e-15 -4.5            0              2.5975729    
   2700000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    1.811375e-19   0              6.4788752e-15 -4.5            0              2.5975729    
   2800000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    5.5800626e-21  0              1.9958611e-16 -4.5            0              2.5975729    
   2900000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    1.0263808e-21  0              3.6711301e-17 -4.5            0              2.5975729    
   3000000   12150          200            200            0.0064162462   0.0048124331   0              0.014436305    3.4393037e-22  0              1.2301605e-17 -4.5            0              2.5975729    
Loop time of 999.345 on 4 procs for 3000000 steps with 6751 atoms

Performance: 2593697.885 ns/day, 0.000 hours/ns, 3001.965 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 234.16     | 385.82     | 539.9      | 753.1 | 38.61
Neigh   | 7.3879     | 7.444      | 7.4999     |   1.6 |  0.74
Comm    | 37.167     | 188.56     | 343.62     |1057.9 | 18.87
Output  | 0.43686    | 0.43727    | 0.43769    |   0.1 |  0.04
Modify  | 278.5      | 328        | 371.67     | 241.1 | 32.82
Other   |            | 89.09      |            |       |  8.91

Nlocal:        1687.75 ave        2025 max        1349 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           3038 ave        4051 max        2021 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 12152
Ave neighs/atom = 1.8000296
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6300 ${n1e1} -100 100 -100 100 units box
region box block -6300 6300 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6300 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6300 6300 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6300 -100 -100) to (6300 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 4200 atoms
  using lattice units in orthogonal box = (-6300 -100 -100) to (6300 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4200 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4200 4200 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2801 atoms
  using lattice units in orthogonal box = (-6300 -100 -100) to (6300 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  4200 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  4200 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2801 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2801 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
4200 atoms in group substrate
group slider1 region slider1
2801 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
7001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2801 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8130 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 154.6 | 154.6 | 154.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12600          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   12600          200            200            0.003606837   -9.176627e-19   0              0.010820511    1227094        0              4.2322841e+10 -4.5            0              3.243457     
    200000   12600          200            200            0.00070215396 -2.4955013e-18  0              0.0021064619   121943.39      0              4.2058643e+09 -4.5            0              2.8056367    
    300000   12600          200            200           -6.0209838e-05 -4.8502735e-18  0             -0.00018062951  1822.4099      0              62855467      -4.5            0              2.6525287    
    400000   12600          200            200            0.075482584    0.05563861     0              0.17080914     4648.1718      0              1.6031684e+08 -4.5            0              2.5954741    
    500000   12600          200            200           -2.3262867e-06 -1.2098097e-17  0             -6.97886e-06    2.4209243      0              83498.409     -4.5            0              2.5994502    
    600000   12600          200            200            0.00832019     0.0061236163   0              0.018836954    98.020778      0              3380766.1     -4.5            0              2.5974784    
    700000   12600          200            200            0.0064791549   0.0048207674   0              0.014616697    0.029382385    0              1013.4073     -4.5            0              2.5975696    
    800000   12600          200            200            0.0064106959   0.0048117242   0              0.014420364    0.010455754    0              360.62211     -4.5            0              2.5975732    
    900000   12600          200            200            0.006411158    0.0048118056   0              0.014421668    0.00099896003  0              34.454432     -4.5            0              2.5975732    
   1000000   12600          200            200            0.0064194907   0.004812904    0              0.014445568    1.2891262e-05  0              0.44462351    -4.5            0              2.5975727    
   1100000   12600          200            200            0.0064151155   0.004812325    0              0.014433022    4.3843204e-06  0              0.15121653    -4.5            0              2.597573     
   1200000   12600          200            200            0.0064163409   0.0048124878   0              0.014436535    2.3549565e-06  0              0.081223159   -4.5            0              2.5975729    
   1300000   12600          200            200            0.0064162531   0.0048124759   0              0.014436284    2.8459031e-07  0              0.0098156054  -4.5            0              2.5975729    
   1400000   12600          200            200            0.0064161453   0.0048124617   0              0.014435974    7.1444826e-09  0              0.00024641535 -4.5            0              2.5975729    
   1500000   12600          200            200            0.0064162122   0.0048124705   0              0.014436166    5.2586636e-10  0              1.8137289e-05 -4.5            0              2.5975729    
   1600000   12600          200            200            0.006416191    0.0048124677   0              0.014436105    5.0450541e-10  0              1.7400544e-05 -4.5            0              2.5975729    
   1700000   12600          200            200            0.0064161936   0.0048124681   0              0.014436113    7.6966494e-11  0              2.6545975e-06 -4.5            0              2.5975729    
   1800000   12600          200            200            0.0064161949   0.0048124683   0              0.014436117    3.0093111e-12  0              1.0379205e-07 -4.5            0              2.5975729    
   1900000   12600          200            200            0.0064161939   0.0048124681   0              0.014436114    3.9126879e-14  0              1.3494978e-09 -4.5            0              2.5975729    
   2000000   12600          200            200            0.0064161943   0.0048124682   0              0.014436115    1.0200404e-13  0              3.51815e-09   -4.5            0              2.5975729    
   2100000   12600          200            200            0.0064161942   0.0048124682   0              0.014436115    1.9965377e-14  0              6.8861184e-10 -4.5            0              2.5975729    
   2200000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    1.1071465e-15  0              3.8185814e-11 -4.5            0              2.5975729    
   2300000   12600          200            200            0.0064161942   0.0048124682   0              0.014436115    7.00058e-19    0              2.4145211e-14 -4.5            0              2.5975729    
   2400000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    1.4684888e-20  0              5.064862e-16  -4.5            0              2.5975729    
   2500000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    7.0680059e-18  0              2.4377765e-13 -4.5            0              2.5975729    
   2600000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    5.2561533e-20  0              1.8128631e-15 -4.5            0              2.5975729    
   2700000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    1.5850575e-19  0              5.4669109e-15 -4.5            0              2.5975729    
   2800000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    7.2336155e-21  0              2.4948958e-16 -4.5            0              2.5975729    
   2900000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    6.5106463e-22  0              2.2455415e-17 -4.5            0              2.5975729    
   3000000   12600          200            200            0.0064161942   0.0048124682   0              0.014436114    3.2184898e-22  0              1.1100668e-17 -4.5            0              2.5975729    
Loop time of 1032.34 on 4 procs for 3000000 steps with 7001 atoms

Performance: 2510789.471 ns/day, 0.000 hours/ns, 2906.006 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 242.34     | 400.5      | 559.44     | 763.7 | 38.80
Neigh   | 7.6376     | 7.6922     | 7.7453     |   1.6 |  0.75
Comm    | 37.774     | 194.04     | 355.5      |1078.5 | 18.80
Output  | 0.43251    | 0.43295    | 0.43342    |   0.1 |  0.04
Modify  | 285.94     | 337.33     | 382.81     | 247.1 | 32.68
Other   |            | 92.35      |            |       |  8.95

Nlocal:        1750.25 ave        2100 max        1399 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         3150.5 ave        4200 max        2097 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 12602
Ave neighs/atom = 1.8000286
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6525 ${n1e1} -100 100 -100 100 units box
region box block -6525 6525 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6525 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6525 6525 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6525 -100 -100) to (6525 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 4350 atoms
  using lattice units in orthogonal box = (-6525 -100 -100) to (6525 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4350 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4350 4350 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2901 atoms
  using lattice units in orthogonal box = (-6525 -100 -100) to (6525 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  4350 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  4350 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2901 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2901 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
4350 atoms in group substrate
group slider1 region slider1
2901 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
7251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2901 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8420 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 159.6 | 159.6 | 159.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   13050          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   13050          200            200            0.0036068613   7.4755141e-17  0              0.010820584    1270964.6      0              4.2324367e+10 -4.5            0              3.2433626    
    200000   13050          200            200            0.00070298694  2.0451849e-16  0              0.0021089608   126550.81      0              4.2142661e+09 -4.5            0              2.8055022    
    300000   13050          200            200           -5.8699461e-05  3.9828598e-16  0             -0.00017609838  1790.0791      0              59611389      -4.5            0              2.6525458    
    400000   13050          200            200            0.079409771    0.058570502    0              0.17965881     1861.8663      0              62001973      -4.5            0              2.5953834    
    500000   13050          200            200            3.894491e-06   9.9200079e-16  0              1.1683473e-05  7.9668136      0              265302.7      -4.5            0              2.5994463    
    600000   13050          200            200            0.0091160505   0.006712942    0              0.02063521     60.518563      0              2015327.5     -4.5            0              2.5974406    
    700000   13050          200            200            0.0064592717   0.0048182189   0              0.014559596    0.0615965      0              2051.2238     -4.5            0              2.5975706    
    800000   13050          200            200            0.0064203238   0.0048130397   0              0.014447932    0.01095284     0              364.74032     -4.5            0              2.5975727    
    900000   13050          200            200            0.0064085845   0.0048115032   0              0.01441425     0.0005400058   0              17.982722     -4.5            0              2.5975733    
   1000000   13050          200            200            0.0064195376   0.0048129511   0              0.014445662    1.0538689e-06  0              0.035094867   -4.5            0              2.5975727    
   1100000   13050          200            200            0.0064153345   0.004812394    0              0.014433609    1.177229e-05   0              0.39202879    -4.5            0              2.5975729    
   1200000   13050          200            200            0.0064161433   0.0048125019   0              0.014435928    2.7154914e-06  0              0.090428524   -4.5            0              2.5975729    
   1300000   13050          200            200            0.0064162491   0.0048125156   0              0.014436232    1.8049494e-07  0              0.0060106583  -4.5            0              2.5975729    
   1400000   13050          200            200            0.0064160934   0.0048124951   0              0.014435785    2.0449179e-10  0              6.809777e-06  -4.5            0              2.5975729    
   1500000   13050          200            200            0.0064161608   0.004812504    0              0.014435978    2.0797793e-09  0              6.9258691e-05 -4.5            0              2.5975729    
   1600000   13050          200            200            0.0064161453   0.0048125019   0              0.014435934    6.445847e-10   0              2.1465302e-05 -4.5            0              2.5975729    
   1700000   13050          200            200            0.0064161449   0.0048125019   0              0.014435933    5.5488602e-11  0              1.8478248e-06 -4.5            0              2.5975729    
   1800000   13050          200            200            0.0064161471   0.0048125022   0              0.014435939    4.7403931e-13  0              1.5785974e-08 -4.5            0              2.5975729    
   1900000   13050          200            200            0.006416146    0.004812502    0              0.014435936    3.2806009e-13  0              1.0924722e-08 -4.5            0              2.5975729    
   2000000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    1.4560244e-13  0              4.8487039e-09 -4.5            0              2.5975729    
   2100000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    1.5886989e-14  0              5.2905232e-10 -4.5            0              2.5975729    
   2200000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    4.1411756e-16  0              1.3790521e-11 -4.5            0              2.5975729    
   2300000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    7.088593e-17   0              2.3605709e-12 -4.5            0              2.5975729    
   2400000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    3.3130798e-17  0              1.103288e-12  -4.5            0              2.5975729    
   2500000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    7.5201144e-18  0              2.5042718e-13 -4.5            0              2.5975729    
   2600000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    9.0640735e-19  0              3.0184253e-14 -4.5            0              2.5975729    
   2700000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    4.966414e-21   0              1.6538645e-16 -4.5            0              2.5975729    
   2800000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    1.9291675e-20  0              6.4243167e-16 -4.5            0              2.5975729    
   2900000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    9.5124117e-22  0              3.1677263e-17 -4.5            0              2.5975729    
   3000000   13050          200            200            0.0064161463   0.004812502    0              0.014435937    7.280744e-23   0              2.4245591e-18 -4.5            0              2.5975729    
Loop time of 1075.72 on 4 procs for 3000000 steps with 7251 atoms

Performance: 2409553.933 ns/day, 0.000 hours/ns, 2788.836 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 251.9      | 417.44     | 585.01     | 782.8 | 38.81
Neigh   | 7.9333     | 7.9905     | 8.047      |   1.6 |  0.74
Comm    | 39.189     | 203.22     | 372.89     |1098.2 | 18.89
Output  | 0.44486    | 0.44533    | 0.44581    |   0.1 |  0.04
Modify  | 297.92     | 351.57     | 397.87     | 245.5 | 32.68
Other   |            | 95.06      |            |       |  8.84

Nlocal:        1812.75 ave        2175 max        1449 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           3263 ave        4351 max        2171 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 13052
Ave neighs/atom = 1.8000276
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6750 ${n1e1} -100 100 -100 100 units box
region box block -6750 6750 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6750 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6750 6750 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6750 -100 -100) to (6750 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 4500 atoms
  using lattice units in orthogonal box = (-6750 -100 -100) to (6750 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3001 atoms
  using lattice units in orthogonal box = (-6750 -100 -100) to (6750 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  4500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  4500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  3001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
4500 atoms in group substrate
group slider1 region slider1
3001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
7501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8710 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 164.7 | 164.7 | 164.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   13500          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   13500          200            200            0.0036068885  -5.4679402e-17  0              0.010820665    1314839.4      0              4.2325927e+10 -4.5            0              3.2432682    
    200000   13500          200            200            0.00070382074 -1.4952062e-16  0              0.0021114622   131176         0              4.2226797e+09 -4.5            0              2.8053676    
    300000   13500          200            200           -5.7184357e-05 -2.918635e-16   0             -0.00017155307  1753.6083      0              56450311      -4.5            0              2.6525621    
    400000   13500          200            200            0.081461996    0.060116997    0              0.18426899     257.69114      0              8295322       -4.5            0              2.5953361    
    500000   13500          200            200            1.0165263e-05 -7.249844e-16   0              3.0495788e-05  54.059961      0              1740241.4     -4.5            0              2.5994289    
    600000   13500          200            200            0.0096868344   0.0071369805   0              0.021923523    24.080764      0              775182.62     -4.5            0              2.5974141    
    700000   13500          200            200            0.0064341023   0.0048149551   0              0.014487352    0.087269547    0              2809.2894     -4.5            0              2.5975719    
    800000   13500          200            200            0.006429365    0.0048142749   0              0.01447382     0.0087864407   0              282.84385     -4.5            0              2.5975722    
    900000   13500          200            200            0.0064069845   0.0048113276   0              0.014409626    0.00013685276  0              4.4054199     -4.5            0              2.5975734    
   1000000   13500          200            200            0.0064191637   0.0048129408   0              0.01444455     3.1498333e-05  0              1.0139612     -4.5            0              2.5975727    
   1100000   13500          200            200            0.0064156539   0.0048124747   0              0.014434487    1.8977298e-05  0              0.6108972     -4.5            0              2.5975729    
   1200000   13500          200            200            0.0064159524   0.0048125151   0              0.014435342    2.4128257e-06  0              0.077671145   -4.5            0              2.5975729    
   1300000   13500          200            200            0.0064162348   0.0048125522   0              0.014436152    6.8033036e-08  0              0.0021900479  -4.5            0              2.5975729    
   1400000   13500          200            200            0.0064160517   0.004812528    0              0.014435627    3.416519e-09   0              0.00010998099 -4.5            0              2.5975729    
   1500000   13500          200            200            0.0064161112   0.0048125359   0              0.014435798    3.9266131e-09  0              0.0001264014  -4.5            0              2.5975729    
   1600000   13500          200            200            0.0064161032   0.0048125348   0              0.014435775    6.3079961e-10  0              2.0306037e-05 -4.5            0              2.5975729    
   1700000   13500          200            200            0.0064161      0.0048125344   0              0.014435765    2.6886397e-11  0              8.654986e-07  -4.5            0              2.5975729    
   1800000   13500          200            200            0.0064161026   0.0048125348   0              0.014435773    1.9840248e-13  0              6.3867637e-09 -4.5            0              2.5975729    
   1900000   13500          200            200            0.0064161017   0.0048125346   0              0.01443577     7.6680118e-13  0              2.4684057e-08 -4.5            0              2.5975729    
   2000000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    1.5706576e-13  0              5.0560957e-09 -4.5            0              2.5975729    
   2100000   13500          200            200            0.0064161019   0.0048125347   0              0.014435771    9.1677901e-15  0              2.9511985e-10 -4.5            0              2.5975729    
   2200000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    1.6390727e-17  0              5.2763303e-13 -4.5            0              2.5975729    
   2300000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    2.4008434e-16  0              7.7285425e-12 -4.5            0              2.5975729    
   2400000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    3.5565657e-17  0              1.1448922e-12 -4.5            0              2.5975729    
   2500000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    9.9604871e-18  0              3.2063752e-13 -4.5            0              2.5975729    
   2600000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    8.7214779e-20  0              2.8075264e-15 -4.5            0              2.5975729    
   2700000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    9.5165033e-20  0              3.0634526e-15 -4.5            0              2.5975729    
   2800000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    1.5543069e-20  0              5.0034613e-16 -4.5            0              2.5975729    
   2900000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    8.1027892e-24  0              2.6083646e-19 -4.5            0              2.5975729    
   3000000   13500          200            200            0.0064161018   0.0048125347   0              0.014435771    2.6675256e-22  0              8.5870175e-18 -4.5            0              2.5975729    
Loop time of 1112.55 on 4 procs for 3000000 steps with 7501 atoms

Performance: 2329787.871 ns/day, 0.000 hours/ns, 2696.514 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 260.5      | 432.18     | 606.96     | 798.5 | 38.85
Neigh   | 8.1802     | 8.2367     | 8.291      |   1.5 |  0.74
Comm    | 39.67      | 210.44     | 386.93     |1117.2 | 18.91
Output  | 0.45317    | 0.45366    | 0.45415    |   0.1 |  0.04
Modify  | 306.87     | 362.69     | 409.83     | 248.6 | 32.60
Other   |            | 98.55      |            |       |  8.86

Nlocal:        1875.25 ave        2250 max        1499 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         3375.5 ave        4500 max        2247 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 13502
Ave neighs/atom = 1.8000267
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6975 ${n1e1} -100 100 -100 100 units box
region box block -6975 6975 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6975 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6975 6975 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6975 -100 -100) to (6975 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 4650 atoms
  using lattice units in orthogonal box = (-6975 -100 -100) to (6975 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4650 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4650 4650 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3101 atoms
  using lattice units in orthogonal box = (-6975 -100 -100) to (6975 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  4650 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  4650 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  3101 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3101 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
4650 atoms in group substrate
group slider1 region slider1
3101 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
7751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3101 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 9000 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 169.8 | 169.8 | 169.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   13950          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   13950          200            200            0.0036069184  -4.1213699e-18  0              0.010820755    1358718.5      0              4.2327518e+10 -4.5            0              3.2431737    
    200000   13950          200            200            0.00070465612 -1.1259724e-17  0              0.0021139684   135819.24      0              4.231113e+09  -4.5            0              2.8052328    
    300000   13950          200            200           -5.5666805e-05 -2.1909534e-17  0             -0.00016700041  1713.4097      0              53377048      -4.5            0              2.6525775    
    400000   13950          200            200            0.081531391    0.060310569    0              0.1842836      152.26895      0              4743562.9     -4.5            0              2.5953336    
    500000   13950          200            200            1.646785e-05  -5.4500592e-17  0              4.9403549e-05  144.41576      0              4498916.2     -4.5            0              2.5993982    
    600000   13950          200            200            0.0099671579   0.0073472165   0              0.022554257    2.3186543      0              72231.946     -4.5            0              2.5974012    
    700000   13950          200            200            0.0064068792   0.0048113303   0              0.014409307    0.093711244    0              2919.3423     -4.5            0              2.5975734    
    800000   13950          200            200            0.0064366436   0.004815214    0              0.014494717    0.0049840208   0              155.26486     -4.5            0              2.5975718    
    900000   13950          200            200            0.0064065224   0.00481124     0              0.014408327    2.4534431e-06  0              0.07643096    -4.5            0              2.5975734    
   1000000   13950          200            200            0.0064183955   0.0048128153   0              0.014442371    9.1485309e-05  0              2.8499988     -4.5            0              2.5975728    
   1100000   13950          200            200            0.006416004    0.0048124966   0              0.014435515    2.2486415e-05  0              0.70050871    -4.5            0              2.5975729    
   1200000   13950          200            200            0.0064157651   0.0048124658   0              0.014434829    1.5895779e-06  0              0.049519374   -4.5            0              2.5975729    
   1300000   13950          200            200            0.0064161851   0.0048125213   0              0.014436034    3.8916881e-09  0              0.00012123593 -4.5            0              2.5975729    
   1400000   13950          200            200            0.006415998    0.0048124965   0              0.014435497    1.5432789e-08  0              0.00048077043 -4.5            0              2.5975729    
   1500000   13950          200            200            0.0064160424   0.0048125024   0              0.014435625    5.1633378e-09  0              0.00016085103 -4.5            0              2.5975729    
   1600000   13950          200            200            0.0064160427   0.0048125024   0              0.014435626    4.6985528e-10  0              1.4637181e-05 -4.5            0              2.5975729    
   1700000   13950          200            200            0.006416037    0.0048125017   0              0.014435609    5.1516738e-12  0              1.6048767e-07 -4.5            0              2.5975729    
   1800000   13950          200            200            0.0064160399   0.0048125021   0              0.014435618    2.2953452e-12  0              7.1505809e-08 -4.5            0              2.5975729    
   1900000   13950          200            200            0.0064160391   0.004812502    0              0.014435615    1.1352286e-12  0              3.5365244e-08 -4.5            0              2.5975729    
   2000000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    1.3084366e-13  0              4.076111e-09  -4.5            0              2.5975729    
   2100000   13950          200            200            0.0064160393   0.004812502    0              0.014435616    3.1829807e-15  0              9.9157902e-11 -4.5            0              2.5975729    
   2200000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    1.9741624e-16  0              6.1500154e-12 -4.5            0              2.5975729    
   2300000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    2.9349525e-16  0              9.1431194e-12 -4.5            0              2.5975729    
   2400000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    2.9045735e-18  0              9.0484813e-14 -4.5            0              2.5975729    
   2500000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    9.3224024e-18  0              2.9041642e-13 -4.5            0              2.5975729    
   2600000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    5.3407331e-19  0              1.6637735e-14 -4.5            0              2.5975729    
   2700000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    2.9171731e-20  0              9.0877321e-16 -4.5            0              2.5975729    
   2800000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    1.9400218e-20  0              6.0436586e-16 -4.5            0              2.5975729    
   2900000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    3.4063719e-22  0              1.061171e-17  -4.5            0              2.5975729    
   3000000   13950          200            200            0.0064160392   0.004812502    0              0.014435616    1.4484354e-22  0              4.5122425e-18 -4.5            0              2.5975729    
Loop time of 1152.11 on 4 procs for 3000000 steps with 7751 atoms

Performance: 2249787.974 ns/day, 0.000 hours/ns, 2603.921 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 270.72     | 448.51     | 627.97     | 814.7 | 38.93
Neigh   | 8.4734     | 8.5355     | 8.5942     |   1.6 |  0.74
Comm    | 40.135     | 216.59     | 398.73     |1152.3 | 18.80
Output  | 0.46649    | 0.467      | 0.4675     |   0.1 |  0.04
Modify  | 315.89     | 373.54     | 426.91     | 264.3 | 32.42
Other   |            | 104.5      |            |       |  9.07

Nlocal:        1937.75 ave        2325 max        1549 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           3488 ave        4651 max        2321 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 13952
Ave neighs/atom = 1.8000258
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -7200 ${n1e1} -100 100 -100 100 units box
region box block -7200 7200 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7200 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7200 7200 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-7200 -100 -100) to (7200 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 4800 atoms
  using lattice units in orthogonal box = (-7200 -100 -100) to (7200 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4800 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4800 4800 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3201 atoms
  using lattice units in orthogonal box = (-7200 -100 -100) to (7200 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  4800 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  4800 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  3201 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3201 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
4800 atoms in group substrate
group slider1 region slider1
3201 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
8001 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3201 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 9291 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 174.8 | 174.8 | 174.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   14400          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   14400          200            200            0.0036069507  -3.4547769e-18  0              0.010820852    1402601.8      0              4.2329138e+10 -4.5            0              3.2430793    
    200000   14400          200            200            0.00070549103 -9.4452764e-18  0              0.0021164731   140479.93      0              4.2395456e+09 -4.5            0              2.805098     
    300000   14400          200            200           -5.414858e-05  -1.8404432e-17  0             -0.00016244574  1669.8651      0              50394881      -4.5            0              2.652592     
    400000   14400          200            200            0.079624859    0.060046571    0              0.17882801     1693.5248      0              51108908      -4.5            0              2.5953755    
    500000   14400          200            200            2.2807532e-05 -4.5585075e-17  0              6.8422596e-05  282.80821      0              8534872.8     -4.5            0              2.5993542    
    600000   14400          200            200            0.0099272055   0.0073538802   0              0.022427736    4.3223188      0              130443.31     -4.5            0              2.5974027    
    700000   14400          200            200            0.0063809687   0.0048077108   0              0.014335195    0.077344287    0              2334.1743     -4.5            0              2.5975747    
    800000   14400          200            200            0.0064412371   0.0048156579   0              0.014508053    0.0014393571   0              43.438378     -4.5            0              2.5975716    
    900000   14400          200            200            0.0064072027   0.0048111631   0              0.014410445    0.00022182091  0              6.6943362     -4.5            0              2.5975734    
   1000000   14400          200            200            0.0064173      0.0048125051   0              0.014439395    0.00015303244  0              4.618368      -4.5            0              2.5975728    
   1100000   14400          200            200            0.0064163049   0.004812371    0              0.014436544    2.0549582e-05  0              0.62016611    -4.5            0              2.5975729    
   1200000   14400          200            200            0.0064155685   0.0048122742   0              0.014434431    6.4974372e-07  0              0.019608624   -4.5            0              2.5975729    
   1300000   14400          200            200            0.0064160712   0.0048123407   0              0.014435873    2.113166e-08   0              0.00063773264 -4.5            0              2.5975729    
   1400000   14400          200            200            0.0064159032   0.0048123184   0              0.014435391    3.0504483e-08  0              0.00092059521 -4.5            0              2.5975729    
   1500000   14400          200            200            0.0064159276   0.0048123217   0              0.014435461    5.1895871e-09  0              0.00015661662 -4.5            0              2.5975729    
   1600000   14400          200            200            0.0064159358   0.0048123228   0              0.014435485    2.4097927e-10  0              7.2725165e-06 -4.5            0              2.5975729    
   1700000   14400          200            200            0.0064159286   0.0048123218   0              0.014435464    8.3236133e-13  0              2.5119844e-08 -4.5            0              2.5975729    
   1800000   14400          200            200            0.0064159313   0.0048123222   0              0.014435472    5.7127235e-12  0              1.7240436e-07 -4.5            0              2.5975729    
   1900000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     1.2544778e-12  0              3.7858902e-08 -4.5            0              2.5975729    
   2000000   14400          200            200            0.0064159307   0.0048123221   0              0.01443547     7.8672968e-14  0              2.3742726e-09 -4.5            0              2.5975729    
   2100000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     2.8729692e-17  0              8.6703377e-13 -4.5            0              2.5975729    
   2200000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     9.8546858e-16  0              2.9740469e-11 -4.5            0              2.5975729    
   2300000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     1.6024226e-16  0              4.8359532e-12 -4.5            0              2.5975729    
   2400000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     3.3035596e-18  0              9.9698169e-14 -4.5            0              2.5975729    
   2500000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     6.4147406e-18  0              1.9359054e-13 -4.5            0              2.5975729    
   2600000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     8.8249496e-19  0              2.6632827e-14 -4.5            0              2.5975729    
   2700000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     2.1575768e-21  0              6.5113538e-17 -4.5            0              2.5975729    
   2800000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     1.6750732e-20  0              5.0552055e-16 -4.5            0              2.5975729    
   2900000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     9.6257131e-22  0              2.9049452e-17 -4.5            0              2.5975729    
   3000000   14400          200            200            0.0064159308   0.0048123221   0              0.01443547     5.1856855e-23  0              1.5649887e-18 -4.5            0              2.5975729    
Loop time of 1190.46 on 4 procs for 3000000 steps with 8001 atoms

Performance: 2177311.221 ns/day, 0.000 hours/ns, 2520.036 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 287.9      | 470.6      | 654.18     | 826.7 | 39.53
Neigh   | 8.7371     | 8.801      | 8.8632     |   1.7 |  0.74
Comm    | 41.302     | 223.2      | 408.22     |1188.7 | 18.75
Output  | 0.4779     | 0.47841    | 0.47892    |   0.1 |  0.04
Modify  | 325.07     | 382.29     | 435.55     | 271.4 | 32.11
Other   |            | 105.1      |            |       |  8.83

Nlocal:        2000.25 ave        2400 max        1599 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         3600.5 ave        4800 max        2397 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 14402
Ave neighs/atom = 1.800025
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -7425 ${n1e1} -100 100 -100 100 units box
region box block -7425 7425 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7425 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7425 7425 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-7425 -100 -100) to (7425 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 4950 atoms
  using lattice units in orthogonal box = (-7425 -100 -100) to (7425 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4950 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4950 4950 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3301 atoms
  using lattice units in orthogonal box = (-7425 -100 -100) to (7425 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  4950 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  4950 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  3301 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3301 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
4950 atoms in group substrate
group slider1 region slider1
3301 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
8251 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3301 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 9581 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 179.9 | 179.9 | 179.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   14850          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   14850          200            200            0.0036069853  -6.260174e-17   0              0.010820956    1446489.3      0              4.2330784e+10 -4.5            0              3.2429848    
    200000   14850          200            200            0.00070632745 -1.7118887e-16  0              0.0021189823   145158.74      0              4.2479976e+09 -4.5            0              2.804963     
    300000   14850          200            200           -5.2624957e-05 -3.3396473e-16  0             -0.00015787487  1622.9386      0              47494482      -4.5            0              2.6526056    
    400000   14850          200            200            0.075845698    0.05802122     0              0.16951587     4835.7916      0              1.4151701e+08 -4.5            0              2.5954608    
    500000   14850          200            200            2.9193915e-05 -8.2529728e-16  0              8.7581746e-05  473.27591      0              13850182      -4.5            0              2.5992968    
    600000   14850          200            200            0.0095761513   0.0073012553   0              0.021427199    30.559899      0              894320.09     -4.5            0              2.5974185    
    700000   14850          200            200            0.006359585    0.0048046828   0              0.014274072    0.045856379    0              1341.9639     -4.5            0              2.5975758    
    800000   14850          200            200            0.0064426504   0.0048156927   0              0.014512259    7.8099589e-08  0              0.0022855452  -4.5            0              2.5975715    
    900000   14850          200            200            0.0064089618   0.004811239    0              0.014415646    0.00070785922  0              20.715145     -4.5            0              2.5975733    
   1000000   14850          200            200            0.0064160554   0.0048121844   0              0.014435982    0.00018669965  0              5.4636716     -4.5            0              2.5975729    
   1100000   14850          200            200            0.0064165591   0.0048122487   0              0.014437428    1.4067062e-05  0              0.41166551    -4.5            0              2.5975729    
   1200000   14850          200            200            0.0064154248   0.0048120991   0              0.014434175    5.9945705e-08  0              0.0017542809  -4.5            0              2.5975729    
   1300000   14850          200            200            0.0064159465   0.0048121682   0              0.014435671    1.1336102e-07  0              0.0033174532  -4.5            0              2.5975729    
   1400000   14850          200            200            0.0064158179   0.0048121511   0              0.014435303    4.1420794e-08  0              0.0012121587  -4.5            0              2.5975729    
   1500000   14850          200            200            0.0064158197   0.0048121514   0              0.014435308    3.9972198e-09  0              0.00011697663 -4.5            0              2.5975729    
   1600000   14850          200            200            0.0064158347   0.0048121533   0              0.014435351    5.5295046e-11  0              1.6181818e-06 -4.5            0              2.5975729    
   1700000   14850          200            200            0.0064158268   0.0048121523   0              0.014435328    1.5781651e-11  0              4.618421e-07  -4.5            0              2.5975729    
   1800000   14850          200            200            0.006415829    0.0048121526   0              0.014435334    8.7756854e-12  0              2.5681602e-07 -4.5            0              2.5975729    
   1900000   14850          200            200            0.0064158288   0.0048121525   0              0.014435334    1.0678658e-12  0              3.1250557e-08 -4.5            0              2.5975729    
   2000000   14850          200            200            0.0064158286   0.0048121525   0              0.014435333    2.7532575e-14  0              8.0572697e-10 -4.5            0              2.5975729    
   2100000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    1.9067754e-15  0              5.5800825e-11 -4.5            0              2.5975729    
   2200000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    1.8217027e-15  0              5.3311214e-11 -4.5            0              2.5975729    
   2300000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    2.2068098e-17  0              6.4581179e-13 -4.5            0              2.5975729    
   2400000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    3.6099681e-17  0              1.056439e-12  -4.5            0              2.5975729    
   2500000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    7.8716925e-18  0              2.3036113e-13 -4.5            0              2.5975729    
   2600000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    5.70759e-19    0              1.6702975e-14 -4.5            0              2.5975729    
   2700000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    1.7395037e-20  0              5.0905702e-16 -4.5            0              2.5975729    
   2800000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    1.7059974e-20  0              4.9925156e-16 -4.5            0              2.5975729    
   2900000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    4.3139815e-22  0              1.262465e-17  -4.5            0              2.5975729    
   3000000   14850          200            200            0.0064158287   0.0048121525   0              0.014435334    1.0462659e-22  0              3.0618445e-18 -4.5            0              2.5975729    
Loop time of 1223.36 on 4 procs for 3000000 steps with 8251 atoms

Performance: 2118762.415 ns/day, 0.000 hours/ns, 2452.271 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 295.72     | 482.66     | 670.82     | 836.3 | 39.45
Neigh   | 9.0445     | 9.1106     | 9.1741     |   1.7 |  0.74
Comm    | 42.615     | 228.8      | 418.18     |1201.3 | 18.70
Output  | 0.49279    | 0.49332    | 0.49385    |   0.1 |  0.04
Modify  | 334.71     | 393.99     | 448.96     | 275.5 | 32.21
Other   |            | 108.3      |            |       |  8.85

Nlocal:        2062.75 ave        2475 max        1649 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:           3713 ave        4951 max        2471 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 14852
Ave neighs/atom = 1.8000242
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -7650 ${n1e1} -100 100 -100 100 units box
region box block -7650 7650 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7650 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7650 7650 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-7650 -100 -100) to (7650 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 5100 atoms
  using lattice units in orthogonal box = (-7650 -100 -100) to (7650 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -5100 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -5100 5100 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3401 atoms
  using lattice units in orthogonal box = (-7650 -100 -100) to (7650 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  5100 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  5100 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  3401 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3401 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
5100 atoms in group substrate
group slider1 region slider1
3401 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
8501 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3401 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 9871 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 184.9 | 184.9 | 184.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   15300          200            200            0              0              0              0              0              0              0             -4.5            0              6            
    100000   15300          200            200            0.0036070218   6.0755522e-17  0              0.010821065    1490381.1      0              4.2332453e+10 -4.5            0              3.2428904    
    200000   15300          200            200            0.00070716185  1.6611784e-16  0              0.0021214856   149854.5       0              4.2564337e+09 -4.5            0              2.8048283    
    300000   15300          200            200           -5.1102759e-05  3.2347916e-16  0             -0.00015330828  1573.3333      0              44688608      -4.5            0              2.6526183    
    400000   15300          200            200            0.070405872    0.053883098    0              0.15733452     9374.9937      0              2.6628523e+08 -4.5            0              2.5955865    
    500000   15300          200            200            3.5610268e-05  8.0090483e-16  0              0.0001068308   719.09606      0              20425044      -4.5            0              2.5992262    
    600000   15300          200            200            0.0089644683   0.0068506172   0              0.020042788    72.265479      0              2052612.6     -4.5            0              2.5974466    
    700000   15300          200            200            0.0063453397   0.0048026078   0              0.014233411    0.01480689     0              420.5716      -4.5            0              2.5975766    
    800000   15300          200            200            0.0064407262   0.004815297    0              0.014506882    0.0015396409   0              43.731616     -4.5            0              2.5975716    
    900000   15300          200            200            0.0064115519   0.0048114341   0              0.014423222    0.0012369456   0              35.133927     -4.5            0              2.5975731    
   1000000   15300          200            200            0.0064148067   0.0048118716   0              0.014432549    0.0001757542   0              4.9920832     -4.5            0              2.597573     
   1100000   15300          200            200            0.0064167225   0.0048121233   0              0.014438044    6.1900417e-06  0              0.17582057    -4.5            0              2.5975729    
   1200000   15300          200            200            0.0064153374   0.0048119401   0              0.014434072    1.239726e-07   0              0.0035212902  -4.5            0              2.5975729    
   1300000   15300          200            200            0.0064158138   0.0048120033   0              0.014435438    2.3726243e-07  0              0.0067391491  -4.5            0              2.5975729    
   1400000   15300          200            200            0.0064157393   0.0048119934   0              0.014435225    4.2882877e-08  0              0.0012180357  -4.5            0              2.5975729    
   1500000   15300          200            200            0.006415719    0.0048119907   0              0.014435166    2.164836e-09   0              6.1489521e-05 -4.5            0              2.5975729    
   1600000   15300          200            200            0.0064157386   0.0048119933   0              0.014435222    2.4301664e-12  0              6.9025904e-08 -4.5            0              2.5975729    
   1700000   15300          200            200            0.006415731    0.0048119923   0              0.014435201    4.2586024e-11  0              1.2096039e-06 -4.5            0              2.5975729    
   1800000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    1.0016698e-11  0              2.8451205e-07 -4.5            0              2.5975729    
   1900000   15300          200            200            0.0064157327   0.0048119925   0              0.014435206    6.7486564e-13  0              1.9168733e-08 -4.5            0              2.5975729    
   2000000   15300          200            200            0.0064157324   0.0048119925   0              0.014435205    9.7230107e-16  0              2.7617023e-11 -4.5            0              2.5975729    
   2100000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    6.9550626e-15  0              1.9755005e-10 -4.5            0              2.5975729    
   2200000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    2.2261236e-15  0              6.3230318e-11 -4.5            0              2.5975729    
   2300000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    2.5172029e-17  0              7.1498071e-13 -4.5            0              2.5975729    
   2400000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    2.7014279e-17  0              7.6730756e-13 -4.5            0              2.5975729    
   2500000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    1.6092186e-18  0              4.5707888e-14 -4.5            0              2.5975729    
   2600000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    1.1040333e-18  0              3.1358717e-14 -4.5            0              2.5975729    
   2700000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    1.9990437e-20  0              5.6780392e-16 -4.5            0              2.5975729    
   2800000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    7.9648427e-21  0              2.2623162e-16 -4.5            0              2.5975729    
   2900000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    1.8199136e-21  0              5.169242e-17  -4.5            0              2.5975729    
   3000000   15300          200            200            0.0064157325   0.0048119925   0              0.014435205    1.20439e-24    0              3.4209225e-20 -4.5            0              2.5975729    
Loop time of 1261.93 on 4 procs for 3000000 steps with 8501 atoms

Performance: 2053992.884 ns/day, 0.000 hours/ns, 2377.307 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 309.95     | 500.99     | 691.89     | 847.9 | 39.70
Neigh   | 9.3717     | 9.4416     | 9.5097     |   1.8 |  0.75
Comm    | 43.515     | 234.07     | 425.24     |1237.0 | 18.55
Output  | 0.50448    | 0.50501    | 0.50555    |   0.1 |  0.04
Modify  | 347.47     | 405.82     | 463.24     | 284.8 | 32.16
Other   |            | 111.1      |            |       |  8.80

Nlocal:        2125.25 ave        2550 max        1699 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            4.5 ave           5 max           4 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         3825.5 ave        5100 max        2547 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 15302
Ave neighs/atom = 1.8000235
Neighbor list builds = 184
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3 #+(v_ind*0.01)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal (50+v_ind*50)*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider

variable x_shift equal -v_lat1/2

################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -7875 ${n1e1} -100 100 -100 100 units box
region box block -7875 7875 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7875 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -7875 7875 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-7875 -100 -100) to (7875 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 5250 atoms
  using lattice units in orthogonal box = (-7875 -100 -100) to (7875 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -5250 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -5250 5250 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3501 atoms
  using lattice units in orthogonal box = (-7875 -100 -100) to (7875 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  5250 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  5250 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  3501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
5250 atoms in group substrate
group slider1 region slider1
3501 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
8751 atoms in group substrate_slider

displace_atoms slider1 move ${x_shift} 0.0 0.0
displace_atoms slider1 move -1.5 0.0 0.0
Displacing atoms ...

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
ERROR: Fix rigid: Bad principal moments (src/RIGID/fix_rigid.cpp:2138)
Last command: run 3000000
